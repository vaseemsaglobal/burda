OBJECT Page 1 Company Information
{
  OBJECT-PROPERTIES
  {
    Date=12/08/11;
    Time=[ 9:48:29 PM];
    Version List=NAVW16.00.10,NAVAP4.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Company Information;
               THA=รายละเอียดของบริษัท];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table79;
    PageType=Card;
    OnInit=BEGIN
             "System Indicator TextEditable" := TRUE;
             MapPointVisible := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;

                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 66      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Company;
                                 THA=&บริษัท] }
      { 70      ;2   ;Action    ;
                      CaptionML=[ENU=Responsibility Centers;
                                 THA=ศูนย์ความรับผิดชอบ];
                      RunObject=Page 5715 }
      { 91      ;2   ;Separator  }
      { 92      ;2   ;Action    ;
                      CaptionML=[ENU=Online Map;
                                 THA=Online Map];
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr=Name }

    { 4   ;2   ;Field     ;
                SourceExpr=Address }

    { 6   ;2   ;Field     ;
                SourceExpr="Address 2" }

    { 1000000000;2;Field  ;
                SourceExpr="Address 3" }

    { 34  ;2   ;Field     ;
                SourceExpr="Post Code" }

    { 8   ;2   ;Field     ;
                SourceExpr=City }

    { 1500005;2;Field     ;
                SourceExpr=County }

    { 42  ;2   ;Field     ;
                CaptionML=[ENU=County/Country Code;
                           THA=เขต/รหัสประเทศ];
                SourceExpr="Country/Region Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 14  ;2   ;Field     ;
                SourceExpr="VAT Registration No." }

    { 76  ;2   ;Field     ;
                SourceExpr="Industrial Classification" }

    { 1000000002;2;Field  ;
                SourceExpr="Company Name (Thai)" }

    { 1000000004;2;Field  ;
                SourceExpr="Company Address (Thai)" }

    { 33  ;2   ;Field     ;
                SourceExpr=Picture }

    { 1902768601;1;Group  ;
                CaptionML=[ENU=Communication;
                           THA=การสื่อสาร] }

    { 50  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 54  ;2   ;Field     ;
                SourceExpr="Fax No." }

    { 56  ;2   ;Field     ;
                SourceExpr="E-Mail" }

    { 58  ;2   ;Field     ;
                SourceExpr="Home Page" }

    { 78  ;2   ;Field     ;
                SourceExpr="IC Partner Code" }

    { 80  ;2   ;Field     ;
                SourceExpr="IC Inbox Type" }

    { 82  ;2   ;Field     ;
                SourceExpr="IC Inbox Details" }

    { 1901677601;1;Group  ;
                CaptionML=[ENU=Payments;
                           THA=การชำระเงิน] }

    { 16  ;2   ;Field     ;
                SourceExpr="Bank Name" }

    { 18  ;2   ;Field     ;
                SourceExpr="Bank Branch No." }

    { 20  ;2   ;Field     ;
                SourceExpr="Bank Account No." }

    { 22  ;2   ;Field     ;
                SourceExpr="Payment Routing No." }

    { 24  ;2   ;Field     ;
                SourceExpr="Giro No." }

    { 72  ;2   ;Field     ;
                SourceExpr="SWIFT Code" }

    { 74  ;2   ;Field     ;
                SourceExpr=IBAN }

    { 1000000008;2;Field  ;
                SourceExpr="Order Party Account" }

    { 1000000007;2;Field  ;
                SourceExpr="Order Party Account Currency";
                MultiLine=Yes }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 35  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 37  ;2   ;Field     ;
                SourceExpr="Ship-to Address" }

    { 39  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2" }

    { 1000000010;2;Field  ;
                SourceExpr="Ship-to Address 3" }

    { 51  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code" }

    { 49  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1500006;2;Field     ;
                SourceExpr="Ship-to County" }

    { 60  ;2   ;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code" }

    { 43  ;2   ;Field     ;
                SourceExpr="Ship-to Contact" }

    { 47  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 13  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 62  ;2   ;Field     ;
                SourceExpr="Check-Avail. Period Calc." }

    { 64  ;2   ;Field     ;
                SourceExpr="Check-Avail. Time Bucket" }

    { 67  ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="Base Calendar Code" }

    { 69  ;2   ;Field     ;
                Name=Customized Calendar;
                DrillDown=Yes;
                CaptionML=[ENU=Customized Calendar;
                           THA=ปฎิทินแบบกำหนดเอง];
                SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Company,'','',"Base Calendar Code");
                Editable=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              TESTFIELD("Base Calendar Code");
                              CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Company,'','',"Base Calendar Code");
                            END;
                             }

    { 84  ;2   ;Field     ;
                SourceExpr="Cal. Convergence Time Frame" }

    { 1904604101;1;Group  ;
                CaptionML=[ENU=System Indicator;
                           THA=ตัวบ่งชี้ระบบ] }

    { 100 ;2   ;Field     ;
                SourceExpr="System Indicator";
                OnValidate=BEGIN
                             SystemIndicatorOnAfterValidate;
                           END;
                            }

    { 104 ;2   ;Field     ;
                SourceExpr="System Indicator Style" }

    { 102 ;2   ;Field     ;
                Name=System Indicator Text;
                CaptionML=[ENU=System Indicator Text;
                           THA=ข้อความตัวบ่งชี้ระบบ];
                SourceExpr=SystemIndicatorText;
                Editable="System Indicator TextEditable";
                OnValidate=BEGIN
                             "Custom System Indicator Text" := SystemIndicatorText;
                               SystemIndicatorTextOnAfterValidate;
                           END;
                            }

    { 1902813501;1;Group  ;
                CaptionML=[ENU=Registration;
                           THA=การลงทะเบียน] }

    { 1500001;2;Field     ;
                SourceExpr=ABN }

    { 1500002;2;Field     ;
                SourceExpr="ABN Division Part No." }

    { 1500003;2;Field     ;
                CaptionML=[ENU=Tax Period;
                           THA=รอบเวลาภาษี];
                SourceExpr="Tax Period" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=Do you want to replace the existing picture?;THA=คุณต้องการแทนที่รูปภาพที่มีอยู่หรือไม่';
      Text002@1001 : TextConst 'ENU=Do you want to delete the picture?;THA=คุณต้องการลบรูปภาพหรือไม่';
      CustomizedCalEntry@1007 : Record 7603;
      CustomizedCalendar@1005 : Record 7602;
      CalendarMgmt@1004 : Codeunit 7600;
      Mail@1002 : Codeunit 397;
      PictureExists@1003 : Boolean;
      SystemIndicatorText@1006 : Text[250];
      MapPointVisible@19022708 : Boolean INDATASET;
      "System Indicator TextEditable"@19043996 : Boolean INDATASET;

    PROCEDURE UpdateSystemIndicator@1008();
    VAR
      IndicatorStyle@1000 : Option;
    BEGIN
      GetSystemIndicator(SystemIndicatorText,IndicatorStyle); // IndicatorStyle is not used
      "System Indicator TextEditable" := "System Indicator" = "System Indicator"::"Custom Text"
    END;

    LOCAL PROCEDURE SystemIndicatorTextOnAfterVali@19070270();
    BEGIN
      UpdateSystemIndicator
    END;

    LOCAL PROCEDURE SystemIndicatorOnAfterValidate@19079461();
    BEGIN
      UpdateSystemIndicator
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      UpdateSystemIndicator
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 16 Chart of Accounts
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW14.00.03,LIQEM6.00,CACEM6.00,AVATHA4.04;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Chart of Accounts;
               THA=ผังบัญชี];
    SourceTable=Table15;
    PageType=List;
    CardFormID=Page17;
    OnOpenPage=BEGIN
                 SETRANGE("G/L Entry Type Filter","G/L Entry Type Filter"::Definitive);
               END;

    OnAfterGetRecord=BEGIN
                       NameIndent := 0;
                       NoOnFormat;
                       NameOnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetupNewGLAcc(xRec,BelowxRec);
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 22      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 THA=&บัญชี] }
      { 28      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 20;
                      RunFormView=SORTING(G/L Account No.);
                      RunFormLink=G/L Account No.=FIELD(No.);
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 25      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(G/L Account),No.=FIELD(No.);
                      Image=ViewComments }
      { 34      ;2   ;ActionGroup;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ] }
      { 84      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions-Single;
                                 THA=มิติ-เดียว];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(15),No.=FIELD(No.) }
      { 33      ;3   ;Action    ;
                      CaptionML=[ENU=Dimensions-&Multiple;
                                 THA=มิติ-&หลายมิติ];
                      OnAction=VAR
                                 GLAcc@1000000001 : Record 15;
                                 DefaultDimMultiple@1000000002 : Form 542;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(GLAcc);
                                 DefaultDimMultiple.SetMultiGLAcc(GLAcc);
                                 DefaultDimMultiple.RUNMODAL;
                               END;
                                }
      { 23      ;2   ;Action    ;
                      CaptionML=[ENU=E&xtended Texts;
                                 THA=ข้&อความที่ขยายเพิ่มเติม];
                      RunObject=Page 391;
                      RunFormView=SORTING(Table Name,No.,Language Code,All Language Codes,Starting Date,Ending Date);
                      RunFormLink=Table Name=CONST(G/L Account),No.=FIELD(No.) }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=Receivables-Payables;
                                 THA=ลูกหนี้-เจ้าหนี้];
                      RunObject=Page 159;
                      Image=ReceivablesPayables }
      { 54      ;2   ;Action    ;
                      CaptionML=[ENU=Where-Used List;
                                 THA=รายการผลิตภัณฑ์ที่ใช้วัตถุดิบและส่วนประกอบย่อย];
                      OnAction=VAR
                                 CalcGLAccWhereUsed@1000000001 : Codeunit 100;
                               BEGIN
                                 CalcGLAccWhereUsed.CheckGLAcc("No.");
                               END;
                                }
      { 123     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Balance;
                                 THA=ยอ&ดคงเหลือ] }
      { 36      ;2   ;Action    ;
                      CaptionML=[ENU=G/L &Account Balance;
                                 THA=ดุล&บัญชี G/L];
                      RunObject=Page 415;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Business Unit Filter=FIELD(Business Unit Filter);
                      Image=GLAccountBalance }
      { 132     ;2   ;Action    ;
                      CaptionML=[ENU=G/L &Balance;
                                 THA=&ดุล G/L];
                      RunObject=Page 414;
                      RunFormOnRec=Yes;
                      Image=GLBalance }
      { 126     ;2   ;Action    ;
                      CaptionML=[ENU=G/L Balance by &Dimension;
                                 THA=ดุล G/L ตาม&มิติ];
                      RunObject=Page 408;
                      Image=GLBalanceDimension }
      { 52      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=G/L Account Balance/Bud&get;
                                 THA=ยอดคงเหลือ/&งบประมาณของบัญชี G/L];
                      RunObject=Page 154;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Business Unit Filter=FIELD(Business Unit Filter),Budget Filter=FIELD(Budget Filter) }
      { 35      ;2   ;Action    ;
                      CaptionML=[ENU=G/L Balance/B&udget;
                                 THA=ยอดคงเหลือ/&งบประมาณ G/L];
                      RunObject=Page 422;
                      RunFormOnRec=Yes }
      { 55      ;2   ;Separator  }
      { 56      ;2   ;Action    ;
                      CaptionML=[ENU=Chart of Accounts &Overview;
                                 THA=แผนภูมิภาพรวม&บัญชี];
                      RunObject=Page 634 }
      { 1900210203;1 ;Action    ;
                      CaptionML=ENU=G/L Register;
                      RunObject=Page 116;
                      Promoted=Yes;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 122     ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 30      ;2   ;Action    ;
                      CaptionML=[ENU=Indent Chart of Accounts;
                                 THA=ย่อหน้าผังบัญชี];
                      RunObject=Codeunit 3;
                      Promoted=Yes;
                      Image=IndentChartofAccounts;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1900670506;1 ;Action    ;
                      CaptionML=ENU=Detail Trial Balance;
                      RunObject=Report 4;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1904082706;1 ;Action    ;
                      CaptionML=ENU=Trial Balance;
                      RunObject=Report 6;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1902174606;1 ;Action    ;
                      CaptionML=ENU=Trial Balance by Period;
                      RunObject=Report 38;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900210206;1 ;Action    ;
                      CaptionML=ENU=G/L Register;
                      RunObject=Report 3;
                      Promoted=Yes;
                      Image=GLRegisters;
                      PromotedCategory=Report }
      { 1907000606;1 ;Action    ;
                      CaptionML=ENU=Ledgers;
                      RunObject=Report 16563;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=NameIndent;
                IndentationControls=Name;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 1000000012;2;Field  ;
                SourceExpr="Debit Amount" }

    { 1000000014;2;Field  ;
                SourceExpr="Credit Amount" }

    { 1000000000;2;Field  ;
                SourceExpr="Full Name (Thai)";
                Visible=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Full Name (Eng)";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Income/Balance" }

    { 8   ;2   ;Field     ;
                SourceExpr="Account Type" }

    { 26  ;2   ;Field     ;
                SourceExpr="Direct Posting";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr=Totaling;
                OnLookup=VAR
                           GLaccList@1000000002 : Form 18;
                         BEGIN
                           GLaccList.LOOKUPMODE(TRUE);
                           IF NOT (GLaccList.RUNMODAL = ACTION::LookupOK) THEN
                             EXIT(FALSE)
                           ELSE
                             Text := GLaccList.GetSelectionFilter;
                           EXIT(TRUE);
                         END;
                          }

    { 1000000008;2;Field  ;
                SourceExpr="Petty Cash Account" }

    { 1000000010;2;Field  ;
                SourceExpr="Cash Advance Account" }

    { 12  ;2   ;Field     ;
                SourceExpr="Gen. Posting Type" }

    { 37  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 14  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 32  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="WHT Business Posting Group" }

    { 1000000006;2;Field  ;
                SourceExpr="WHT Product Posting Group" }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Net Change" }

    { 1460000;2;Field     ;
                SourceExpr="Cost Type No." }

    { 59  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Balance at Date";
                Visible=FALSE }

    { 1461000;2;Field     ;
                SourceExpr="Liquid Account No.";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Balance }

    { 61  ;2   ;Field     ;
                SourceExpr="Consol. Translation Method";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Additional-Currency Net Change";
                Visible=FALSE }

    { 57  ;2   ;Field     ;
                SourceExpr="Default IC Partner G/L Acc. No";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Add.-Currency Balance at Date";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Additional-Currency Balance";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Consol. Debit Acc.";
                Visible=FALSE }

    { 41  ;2   ;Field     ;
                SourceExpr="Consol. Credit Acc.";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1905532107;1;Part   ;
                SubFormLink=Table ID=CONST(15),No.=FIELD(No.);
                PagePartID=Page9083;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      "No.Emphasize"@19074284 : Boolean INDATASET;
      NameEmphasize@19018670 : Boolean INDATASET;
      NameIndent@19079073 : Integer INDATASET;

    LOCAL PROCEDURE NoOnFormat@19031395();
    BEGIN
      "No.Emphasize" := "Account Type" <> "Account Type"::Posting;
    END;

    LOCAL PROCEDURE NameOnFormat@19039177();
    BEGIN
      NameIndent := Indentation;
      NameEmphasize := "Account Type" <> "Account Type"::Posting;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
      002   17.11.2006   KKE  -Petty Cash, Cash Advance
    }
    END.
  }
}

OBJECT Page 17 G/L Account Card
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=11:52:47 AM;
    Version List=NAVW15.00,NAVAP4.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=G/L Account Card;
               THA=บัตรบัญชี G/L];
    SourceTable=Table15;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnNewRecord=BEGIN
                  SetupNewGLAcc(xRec,BelowxRec);
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 36      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 THA=&บัญชี] }
      { 41      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 20;
                      RunFormView=SORTING(G/L Account No.);
                      RunFormLink=G/L Account No.=FIELD(No.);
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 38      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(G/L Account),No.=FIELD(No.);
                      Image=ViewComments }
      { 84      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(15),No.=FIELD(No.);
                      Image=Dimensions }
      { 166     ;2   ;Action    ;
                      CaptionML=[ENU=E&xtended Texts;
                                 THA=ข้&อความที่ขยายเพิ่มเติม];
                      RunObject=Page 391;
                      RunFormView=SORTING(Table Name,No.,Language Code,All Language Codes,Starting Date,Ending Date);
                      RunFormLink=Table Name=CONST(G/L Account),No.=FIELD(No.) }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Receivables-Payables;
                                 THA=ลูกหนี้-เจ้าหนี้];
                      RunObject=Page 159;
                      Image=ReceivablesPayables }
      { 47      ;2   ;Action    ;
                      CaptionML=[ENU=Where-Used List;
                                 THA=รายการผลิตภัณฑ์ที่ใช้วัตถุดิบและส่วนประกอบย่อย];
                      OnAction=VAR
                                 CalcGLAccWhereUsed@1000000001 : Codeunit 100;
                               BEGIN
                                 CalcGLAccWhereUsed.CheckGLAcc("No.");
                               END;
                                }
      { 136     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Balance;
                                 THA=ยอ&ดคงเหลือ] }
      { 46      ;2   ;Action    ;
                      CaptionML=[ENU=G/L &Account Balance;
                                 THA=ดุล&บัญชี G/L];
                      RunObject=Page 415;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Business Unit Filter=FIELD(Business Unit Filter);
                      Image=GLAccountBalance }
      { 154     ;2   ;Action    ;
                      CaptionML=[ENU=G/L &Balance;
                                 THA=&ดุล G/L];
                      RunObject=Page 414;
                      RunFormOnRec=Yes;
                      Image=GLBalance }
      { 138     ;2   ;Action    ;
                      CaptionML=[ENU=G/L Balance by &Dimension;
                                 THA=ดุล G/L ตาม&มิติ];
                      RunObject=Page 408;
                      Image=GLBalanceDimension }
      { 1906497203;1 ;Action    ;
                      CaptionML=ENU=General Posting Setup;
                      RunObject=Page 314;
                      Promoted=Yes;
                      Image=GeneralPostingSetup;
                      PromotedCategory=Process }
      { 1900660103;1 ;Action    ;
                      CaptionML=ENU=VAT Posting Setup;
                      RunObject=Page 472;
                      Promoted=Yes;
                      Image=VATPostingSetup;
                      PromotedCategory=Process }
      { 1900210203;1 ;Action    ;
                      CaptionML=ENU=G/L Register;
                      RunObject=Page 116;
                      Promoted=Yes;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1900670506;1 ;Action    ;
                      CaptionML=ENU=Detail Trial Balance;
                      RunObject=Report 4;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1904082706;1 ;Action    ;
                      CaptionML=ENU=Trial Balance;
                      RunObject=Report 6;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1902174606;1 ;Action    ;
                      CaptionML=ENU=Trial Balance by Period;
                      RunObject=Report 38;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900210206;1 ;Action    ;
                      CaptionML=ENU=G/L Register;
                      RunObject=Report 3;
                      Promoted=Yes;
                      Image=GLRegisters;
                      PromotedCategory=Report }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 61      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 62      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Template;
                                 THA=ใช้ต้นแบบ];
                      Image=ApplyTemplate;
                      OnAction=VAR
                                 TemplateMgt@1000000001 : Codeunit 8612;
                                 RecRef@1000000002 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 TemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted }

    { 4   ;2   ;Field     ;
                SourceExpr=Name;
                Importance=Promoted }

    { 6   ;2   ;Field     ;
                SourceExpr="Income/Balance";
                Importance=Promoted }

    { 8   ;2   ;Field     ;
                SourceExpr="Debit/Credit" }

    { 10  ;2   ;Field     ;
                SourceExpr="Account Type" }

    { 16  ;2   ;Field     ;
                SourceExpr=Totaling }

    { 18  ;2   ;Field     ;
                SourceExpr="No. of Blank Lines" }

    { 20  ;2   ;Field     ;
                SourceExpr="New Page" }

    { 1000000000;2;Field  ;
                SourceExpr="Full Name (Thai)" }

    { 1000000002;2;Field  ;
                SourceExpr="Full Name (Eng)" }

    { 22  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 24  ;2   ;Field     ;
                SourceExpr=Balance;
                Importance=Promoted }

    { 12  ;2   ;Field     ;
                SourceExpr="Reconciliation Account" }

    { 57  ;2   ;Field     ;
                SourceExpr="Automatic Ext. Texts" }

    { 14  ;2   ;Field     ;
                SourceExpr="Direct Posting" }

    { 30  ;2   ;Field     ;
                SourceExpr=Blocked }

    { 32  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 1904784501;1;Group  ;
                CaptionML=[ENU=Posting;
                           THA=การลงรายการบัญชี] }

    { 26  ;2   ;Field     ;
                SourceExpr="Gen. Posting Type" }

    { 55  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Importance=Promoted }

    { 28  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group";
                Importance=Promoted }

    { 39  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Importance=Promoted }

    { 54  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Importance=Promoted }

    { 59  ;2   ;Field     ;
                SourceExpr="Default IC Partner G/L Acc. No" }

    { 1500000;2;Field     ;
                SourceExpr="WHT Business Posting Group" }

    { 1500002;2;Field     ;
                SourceExpr="WHT Product Posting Group" }

    { 1904602201;1;Group  ;
                CaptionML=[ENU=Consolidation;
                           THA=การรวมบัญชี] }

    { 50  ;2   ;Field     ;
                SourceExpr="Consol. Debit Acc.";
                Importance=Promoted }

    { 52  ;2   ;Field     ;
                SourceExpr="Consol. Credit Acc.";
                Importance=Promoted }

    { 48  ;2   ;Field     ;
                SourceExpr="Consol. Translation Method";
                Importance=Promoted }

    { 1904488501;1;Group  ;
                CaptionML=[ENU=Reporting;
                           THA=การรายงาน] }

    { 64  ;2   ;Field     ;
                SourceExpr="Exchange Rate Adjustment";
                Importance=Promoted }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1905532107;1;Part   ;
                SubFormLink=Table ID=CONST(15),No.=FIELD(No.);
                PagePartID=Page9083;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 18 G/L Account List
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW13.70,NAVAP6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=G/L Account List;
               THA=รายการบัญชี G/L];
    SourceTable=Table15;
    DataCaptionFields=Search Name;
    PageType=List;
    CardFormID=Page17;
    OnOpenPage=BEGIN
                 SETRANGE("G/L Entry Type Filter","G/L Entry Type Filter"::Definitive);
               END;

    OnAfterGetRecord=BEGIN
                       NameIndent := 0;
                       NoOnFormat;
                       NameOnFormat;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 18      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 THA=&บัญชี] }
      { 23      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 20;
                      RunFormView=SORTING(G/L Account No.);
                      RunFormLink=G/L Account No.=FIELD(No.) }
      { 20      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(G/L Account),No.=FIELD(No.);
                      Image=ViewComments }
      { 84      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(15),No.=FIELD(No.);
                      Image=Dimensions }
      { 132     ;2   ;Action    ;
                      CaptionML=[ENU=E&xtended Texts;
                                 THA=ข้&อความที่ขยายเพิ่มเติม];
                      RunObject=Page 391;
                      RunFormView=SORTING(Table Name,No.,Language Code,All Language Codes,Starting Date,Ending Date);
                      RunFormLink=Table Name=CONST(G/L Account),No.=FIELD(No.) }
      { 22      ;2   ;Action    ;
                      CaptionML=[ENU=Receivables-Payables;
                                 THA=ลูกหนี้-เจ้าหนี้];
                      RunObject=Page 159;
                      Image=ReceivablesPayables }
      { 33      ;2   ;Action    ;
                      CaptionML=[ENU=Where-Used List;
                                 THA=รายการผลิตภัณฑ์ที่ใช้วัตถุดิบและส่วนประกอบย่อย];
                      OnAction=VAR
                                 CalcGLAccWhereUsed@1000000001 : Codeunit 100;
                               BEGIN
                                 CalcGLAccWhereUsed.CheckGLAcc("No.");
                               END;
                                }
      { 118     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Balance;
                                 THA=ยอ&ดคงเหลือ] }
      { 32      ;2   ;Action    ;
                      CaptionML=[ENU=G/L &Account Balance;
                                 THA=ดุล&บัญชี G/L];
                      RunObject=Page 415;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Business Unit Filter=FIELD(Business Unit Filter);
                      Promoted=Yes;
                      Image=GLAccountBalance;
                      PromotedCategory=Process }
      { 126     ;2   ;Action    ;
                      CaptionML=[ENU=G/L &Balance;
                                 THA=&ดุล G/L];
                      RunObject=Page 414;
                      RunFormOnRec=Yes;
                      Promoted=Yes;
                      Image=GLBalance;
                      PromotedCategory=Process }
      { 120     ;2   ;Action    ;
                      CaptionML=[ENU=G/L Balance by &Dimension;
                                 THA=ดุล G/L ตาม&มิติ];
                      RunObject=Page 408;
                      Promoted=Yes;
                      Image=GLBalanceDimension;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1904082706;1 ;Action    ;
                      CaptionML=ENU=Trial Balance;
                      RunObject=Report 6;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1902174606;1 ;Action    ;
                      CaptionML=ENU=Trial Balance by Period;
                      RunObject=Report 38;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900670506;1 ;Action    ;
                      CaptionML=ENU=Detail Trial Balance;
                      RunObject=Report 4;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=NameIndent;
                IndentationControls=Name;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 1500002;2;Field     ;
                SourceExpr="Credit Amount" }

    { 1000000010;2;Field  ;
                SourceExpr=Balance }

    { 1500000;2;Field     ;
                SourceExpr="Debit Amount" }

    { 1000000002;2;Field  ;
                SourceExpr="Full Name (Eng)";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Income/Balance" }

    { 1000000008;2;Field  ;
                SourceExpr="Debit/Credit" }

    { 8   ;2   ;Field     ;
                SourceExpr="Account Type" }

    { 1000000000;2;Field  ;
                SourceExpr="Consol. Translation Method" }

    { 10  ;2   ;Field     ;
                SourceExpr="Gen. Posting Type" }

    { 25  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 12  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 21  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Direct Posting" }

    { 14  ;2   ;Field     ;
                SourceExpr="Reconciliation Account" }

    { 1000000004;2;Field  ;
                SourceExpr="WHT Business Posting Group" }

    { 1000000006;2;Field  ;
                SourceExpr="WHT Product Posting Group" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1905532107;1;Part   ;
                SubFormLink=Table ID=CONST(15),No.=FIELD(No.);
                PagePartID=Page9083;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      "No.Emphasize"@19074284 : Boolean INDATASET;
      NameEmphasize@19018670 : Boolean INDATASET;
      NameIndent@19079073 : Integer INDATASET;

    PROCEDURE SetSelection@1(VAR GLAcc@1000000000 : Record 15);
    BEGIN
      CurrPage.SETSELECTIONFILTER(GLAcc);
    END;

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      GLAcc@1000000000 : Record 15;
      FirstAcc@1000000001 : Text[20];
      LastAcc@1000000002 : Text[20];
      SelectionFilter@1000000003 : Code[80];
      GLAccCount@1000000004 : Integer;
      More@1000000005 : Boolean;
    BEGIN
      CurrPage.SETSELECTIONFILTER(GLAcc);
      GLAcc.SETCURRENTKEY("No.");
      GLAccCount := GLAcc.COUNT;
      IF GLAccCount > 0 THEN BEGIN
        GLAcc.FIND('-');
        WHILE GLAccCount > 0 DO BEGIN
          GLAccCount := GLAccCount - 1;
          GLAcc.MARKEDONLY(FALSE);
          FirstAcc := GLAcc."No.";
          LastAcc := FirstAcc;
          More := (GLAccCount > 0);
          WHILE More DO
            IF GLAcc.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT GLAcc.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastAcc := GLAcc."No.";
                GLAccCount := GLAccCount - 1;
                IF GLAccCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstAcc = LastAcc THEN
            SelectionFilter := SelectionFilter + FirstAcc
          ELSE
            SelectionFilter := SelectionFilter + FirstAcc + '..' + LastAcc;
          IF GLAccCount > 0 THEN BEGIN
            GLAcc.MARKEDONLY(TRUE);
            GLAcc.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    LOCAL PROCEDURE NoOnFormat@19031395();
    BEGIN
      "No.Emphasize" := "Account Type" <> "Account Type"::Posting;
    END;

    LOCAL PROCEDURE NameOnFormat@19039177();
    BEGIN
      NameIndent := Indentation;
      NameEmphasize := "Account Type" <> "Account Type"::Posting;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 20 General Ledger Entries
{
  OBJECT-PROPERTIES
  {
    Date=12/26/11;
    Time=11:40:25 AM;
    Modified=Yes;
    Version List=NAVW16.00,CACEM6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=General Ledger Entries;
               THA=รายการบัญชีแยกประเภททั่วไป];
    SourceTable=Table17;
    DataCaptionExpr=GetCaption;
    SourceTableView=SORTING(G/L Account No.,Posting Date);
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 48      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 544;
                      RunFormLink=Table ID=CONST(17),Entry No.=FIELD(Entry No.);
                      Image=Dimensions }
      { 50      ;2   ;Action    ;
                      CaptionML=[ENU=G/L Dimension Overview;
                                 THA=ภาพรวมของมิติ G/L];
                      OnAction=BEGIN
                                 FORM.RUN(FORM::"G/L Entries Dimension Overview",Rec);
                               END;
                                }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Value Entries;
                                 THA=รายการบัญชีแสดงมูลค่า];
                      Image=ValueLedger;
                      OnAction=BEGIN
                                 ShowValueEntries;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 63      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reverse Transaction;
                                 THA=กลับรายการ];
                      OnAction=VAR
                                 ReversalEntry@1000000001 : Record 179;
                               BEGIN
                                 CLEAR(ReversalEntry);
                                 IF Reversed THEN
                                   ReversalEntry.AlreadyReversedEntry(TABLECAPTION,"Entry No.");
                                 IF "Journal Batch Name" = '' THEN
                                   ReversalEntry.TestFieldError;
                                 TESTFIELD("Transaction No.");
                                 ReversalEntry.ReverseTransaction("Transaction No.")
                               END;
                                }
      { 24      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 1000000002;2;Field  ;
                SourceExpr="External Document No." }

    { 40  ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="G/L Account Name";
                Visible=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="System-Created Entry" }

    { 10  ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000010;2;Field  ;
                SourceExpr="Source No." }

    { 8   ;2   ;Field     ;
                SourceExpr="G/L Account No." }

    { 26  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code";
                Visible=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Description 2" }

    { 51  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Credit Amount" }

    { 1000000004;2;Field  ;
                SourceExpr="Debit Amount" }

    { 12  ;2   ;Field     ;
                SourceExpr="Gen. Posting Type" }

    { 32  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 14  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 16  ;2   ;Field     ;
                SourceExpr=Amount }

    { 54  ;2   ;Field     ;
                SourceExpr="Additional-Currency Amount";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="VAT Amount";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Bal. Account Type" }

    { 18  ;2   ;Field     ;
                SourceExpr="Bal. Account No." }

    { 46  ;2   ;Field     ;
                SourceExpr="User ID";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Source Code";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr=Reversed;
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Reversed by Entry No.";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Reversed Entry No.";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="FA Entry Type";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="FA Entry No.";
                Visible=FALSE }

    { 1460000;2;Field     ;
                SourceExpr="Cost Entry No." }

    { 1000000000;2;Field  ;
                SourceExpr="Transaction No.";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Entry No." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      GLAcc@1000000000 : Record 15;
      Navigate@1000000001 : Form 344;

    LOCAL PROCEDURE GetCaption@2() : Text[250];
    BEGIN
      IF GLAcc."No." <> "G/L Account No." THEN
        IF NOT GLAcc.GET("G/L Account No.") THEN
          IF GETFILTER("G/L Account No.") <> '' THEN
            IF GLAcc.GET(GETRANGEMIN("G/L Account No.")) THEN;
      EXIT(STRSUBSTNO('%1 %2',GLAcc."No.",GLAcc.Name))
    END;

    BEGIN
    END.
  }
}

OBJECT Page 21 Customer Card
{
  OBJECT-PROPERTIES
  {
    Date=12/23/11;
    Time=10:15:54 AM;
    Modified=Yes;
    Version List=NAVW16.00.10,KITNA6.00,NAVAP6.00.01,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Customer Card;
               THA=บัตรลูกค้า];
    SourceTable=Table18;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             ContactEditable := TRUE;
             MapPointVisible := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 ActivateFields;
                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := FALSE;
               END;

    OnFindRecord=VAR
                   RecordFound@1000 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   IF NOT RecordFound AND (GETFILTER("No.") <> '') THEN BEGIN
                   MESSAGE(Text003,GETFILTER("No."));
                   SETRANGE("No.");
                   RecordFound := FIND(Which);
                   END;
                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       ActivateFields;

                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 74      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Customer;
                                 THA=&ลูกค้า] }
      { 80      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 25;
                      RunFormView=SORTING(Customer No.);
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CustomerLedger;
                      PromotedCategory=Process }
      { 151     ;2   ;ActionGroup;
                      CaptionML=[ENU=Issued Documents;
                                 THA=เอกสารที่นำออกใช้] }
      { 152     ;3   ;Action    ;
                      CaptionML=[ENU=Issued &Reminders;
                                 THA=จดหมายเ&ตือนที่ออกใช้];
                      RunObject=Page 440;
                      RunFormView=SORTING(Customer No.,Posting Date);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 153     ;3   ;Action    ;
                      CaptionML=[ENU=Issued &Finance Charge Memos;
                                 THA=บัน&ทึกค่าธรรมเนียมทางการเงินที่ออกใช้];
                      RunObject=Page 452;
                      RunFormView=SORTING(Customer No.,Posting Date);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 78      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Customer),No.=FIELD(No.);
                      Image=ViewComments }
      { 84      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(18),No.=FIELD(No.);
                      Image=Dimensions }
      { 99      ;2   ;Action    ;
                      CaptionML=[ENU=Bank Accounts;
                                 THA=บัญชีธนาคาร];
                      RunObject=Page 424;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 1000000000;2 ;Action    ;
                      CaptionML=ENU=Subscriber;
                      RunObject=Page 50002;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 81      ;2   ;Action    ;
                      CaptionML=[ENU=Ship-&to Addresses;
                                 THA=จัดส่ง&ที่ที่อยู่];
                      RunObject=Page 301;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 14      ;2   ;Action    ;
                      CaptionML=[ENU=C&ontact;
                                 THA=ผู้ติ&ดต่อ];
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 1000000001;2 ;Action    ;
                      CaptionML=ENU=Subscriber;
                      RunObject=Page 50002;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 100     ;2   ;Separator  }
      { 76      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 151;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 112     ;2   ;Action    ;
                      CaptionML=[ENU=Statistics by C&urrencies;
                                 THA=สถิติตามส&กุลเงิน];
                      RunObject=Page 481;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Date Filter=FIELD(Date Filter) }
      { 77      ;2   ;Action    ;
                      CaptionML=[ENU=Entry Statistics;
                                 THA=สถิติเกี่ยวกับรายการ];
                      RunObject=Page 302;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 79      ;2   ;Action    ;
                      CaptionML=[ENU=S&ales;
                                 THA=ก&ารขาย];
                      RunObject=Page 155;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 115     ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 94      ;2   ;Action    ;
                      CaptionML=[ENU=Cross Re&ferences;
                                 THA=การ&อ้างอิงไขว้];
                      RunObject=Page 5723;
                      RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunFormLink=Cross-Reference Type=CONST(Customer),Cross-Reference Type No.=FIELD(No.) }
      { 125     ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 126     ;2   ;Action    ;
                      CaptionML=[ENU=Ser&vice Contracts;
                                 THA=สัญญากา&รบริการ];
                      RunObject=Page 6065;
                      RunFormView=SORTING(Customer No.,Ship-to Code);
                      RunFormLink=Customer No.=FIELD(No.);
                      Image=ServiceAgreement }
      { 127     ;2   ;Action    ;
                      CaptionML=[ENU=Service &Items;
                                 THA=สินค้าบ&ริการ];
                      RunObject=Page 5988;
                      RunFormView=SORTING(Customer No.,Ship-to Code,Item No.,Serial No.);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 138     ;2   ;Separator  }
      { 147     ;2   ;Action    ;
                      CaptionML=[ENU=&Jobs;
                                 THA=&งาน];
                      RunObject=Page 89;
                      RunFormView=SORTING(Bill-to Customer No.);
                      RunFormLink=Bill-to Customer No.=FIELD(No.) }
      { 117     ;2   ;Separator  }
      { 118     ;2   ;Action    ;
                      CaptionML=[ENU=Online Map;
                                 THA=Online Map];
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 140     ;2   ;Separator  }
      { 149     ;2   ;Action    ;
                      CaptionML=[ENU=C&redit Cards;
                                 THA=บั&ตรเครดิต];
                      RunObject=Page 828;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 165     ;2   ;Action    ;
                      CaptionML=[ENU=Credit Cards Transaction Lo&g Entries;
                                 THA=รายการบัน&ทึกธุรกรรมบัตรเครดิต];
                      RunObject=Page 829;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 82      ;1   ;ActionGroup;
                      CaptionML=[ENU=S&ales;
                                 THA=ก&ารขาย] }
      { 83      ;2   ;Action    ;
                      CaptionML=[ENU=Invoice &Discounts;
                                 THA=ส่วน&ลดในใบแจ้งหนี้];
                      RunObject=Page 23;
                      RunFormLink=Code=FIELD(Invoice Disc. Code) }
      { 113     ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 THA=ราคา];
                      RunObject=Page 7002;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),Sales Code=FIELD(No.);
                      Image=ResourcePrice }
      { 136     ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 THA=ส่วนลดในบรรทัด];
                      RunObject=Page 7004;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),Sales Code=FIELD(No.) }
      { 162     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 THA=เปอร์เซ็นต์&การชำระเงินล่วงหน้า];
                      RunObject=Page 664;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),Sales Code=FIELD(No.) }
      { 148     ;2   ;Action    ;
                      CaptionML=;
                      RunObject=Page 173;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 137     ;2   ;Separator  }
      { 85      ;2   ;Action    ;
                      CaptionML=[ENU=Quotes;
                                 THA=ใบเสนอราคา];
                      RunObject=Page 9300;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.,No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=Quote }
      { 114     ;2   ;Action    ;
                      CaptionML=[ENU=Blanket Orders;
                                 THA=ใบสั่งแบบรวม];
                      RunObject=Page 9303;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=BlanketOrder }
      { 86      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 THA=ใบสั่ง];
                      RunObject=Page 9305;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.,No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=Document }
      { 121     ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 THA=ใบสั่งส่งคืนสินค้า];
                      RunObject=Page 9304;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.,No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=ReturnOrder }
      { 128     ;2   ;Action    ;
                      CaptionML=[ENU=Service Orders;
                                 THA=ใบสั่งบริการ];
                      RunObject=Page 9318;
                      RunFormView=SORTING(Document Type,Customer No.);
                      RunFormLink=Customer No.=FIELD(No.);
                      Image=Document }
      { 6500    ;2   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1000 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(1,"No.",'','','','','');
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1902575205;1 ;Action    ;
                      CaptionML=ENU=Blanket Sales Order;
                      RunObject=Page 507;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900246505;1 ;Action    ;
                      CaptionML=ENU=Sales Quote;
                      RunObject=Page 41;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1906384905;1 ;Action    ;
                      CaptionML=ENU=Sales Invoice;
                      RunObject=Page 43;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1904747105;1 ;Action    ;
                      CaptionML=ENU=Sales Order;
                      RunObject=Page 42;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1902583505;1 ;Action    ;
                      CaptionML=ENU=Sales Credit Memo;
                      RunObject=Page 44;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905163705;1 ;Action    ;
                      CaptionML=ENU=Sales Return Order;
                      RunObject=Page 6630;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905185205;1 ;Action    ;
                      CaptionML=ENU=Service Quote;
                      RunObject=Page 5964;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1902079405;1 ;Action    ;
                      CaptionML=ENU=Service Invoice;
                      RunObject=Page 5933;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907102005;1 ;Action    ;
                      CaptionML=ENU=Service Order;
                      RunObject=Page 5900;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901662105;1 ;Action    ;
                      CaptionML=ENU=Service Credit Memo;
                      RunObject=Page 5935;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1903839805;1 ;Action    ;
                      CaptionML=ENU=Reminder;
                      RunObject=Page 434;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Reminder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901102005;1 ;Action    ;
                      CaptionML=ENU=Financial Charge Memo;
                      RunObject=Page 446;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=FinChargeMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 163     ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 167     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Template;
                                 THA=ใช้ต้นแบบ];
                      Promoted=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TemplateMgt@1000 : Codeunit 8612;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 TemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
      { 1900839804;1 ;Action    ;
                      CaptionML=ENU=Cash Receipt Journal;
                      RunObject=Page 255;
                      Promoted=Yes;
                      Image=CashReceiptJournal;
                      PromotedCategory=Process }
      { 1905171704;1 ;Action    ;
                      CaptionML=ENU=Sales Journal;
                      RunObject=Page 253;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1906813206;1 ;Action    ;
                      CaptionML=ENU=Customer Detailed Aging;
                      RunObject=Report 106;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907586706;1 ;Action    ;
                      CaptionML=ENU=Customer - Labels;
                      RunObject=Report 110;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1902299006;1 ;Action    ;
                      CaptionML=ENU=Customer - Balance to Date;
                      RunObject=Report 121;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Name;
                Importance=Promoted }

    { 1000000017;2;Field  ;
                SourceExpr="Name 2" }

    { 6   ;2   ;Field     ;
                SourceExpr=Address }

    { 8   ;2   ;Field     ;
                SourceExpr="Address 2" }

    { 1000000019;2;Field  ;
                SourceExpr="Address 3" }

    { 90  ;2   ;Field     ;
                SourceExpr="Post Code";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                SourceExpr=City }

    { 1500013;2;Field     ;
                SourceExpr=County }

    { 91  ;2   ;Field     ;
                CaptionML=[ENU=County/Country Code;
                           THA=เขต/รหัสประเทศ];
                SourceExpr="Country/Region Code" }

    { 12  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 122 ;2   ;Field     ;
                SourceExpr="Primary Contact No." }

    { 16  ;2   ;Field     ;
                SourceExpr=Contact;
                Importance=Promoted;
                Editable=ContactEditable;
                OnValidate=BEGIN
                             ContactOnAfterValidate;
                           END;
                            }

    { 1000000021;2;Field  ;
                SourceExpr="Name (Thai)" }

    { 1000000022;2;Field  ;
                SourceExpr="Address (Thai)";
                MultiLine=Yes }

    { 1000000032;2;Field  ;
                SourceExpr="VAT Registration No." }

    { 18  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 20  ;2   ;Field     ;
                SourceExpr="Balance (LCY)";
                OnDrillDown=VAR
                              DtldCustLedgEntry@1001 : Record 379;
                              CustLedgEntry@1002 : Record 21;
                            BEGIN
                              DtldCustLedgEntry.SETRANGE("Customer No.","No.");
                              COPYFILTER("Global Dimension 1 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 1");
                              COPYFILTER("Global Dimension 2 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 2");
                              COPYFILTER("Currency Filter",DtldCustLedgEntry."Currency Code");
                              CustLedgEntry.DrillDownOnEntries(DtldCustLedgEntry);
                            END;
                             }

    { 22  ;2   ;Field     ;
                SourceExpr="Credit Limit (LCY)" }

    { 1500001;2;Field     ;
                SourceExpr="Post Dated Checks (LCY)";
                OnDrillDown=VAR
                              DtldCustLedgEntry@1001 : Record 379;
                              CustLedgEntry@1002 : Record 21;
                            BEGIN
                              PostDatedCheck.RESET;
                              PostDatedCheck.SETCURRENTKEY("Account Type","Account No.");
                              PostDatedCheck.SETRANGE("Account Type",PostDatedCheck."Account Type"::Customer);
                              PostDatedCheck.SETRANGE("Account No.","No.");
                              FORM.RUNMODAL(FORM::"Post Dated Checks List",PostDatedCheck);
                            END;
                             }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Provisional Balance (LCY);
                           THA=ดุลสำรอง (LCY)];
                SourceExpr="Balance (LCY)"- ABS("Post Dated Checks (LCY)") }

    { 24  ;2   ;Field     ;
                SourceExpr="Salesperson Code" }

    { 64  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 93  ;2   ;Field     ;
                SourceExpr="Service Zone Code" }

    { 26  ;2   ;Field     ;
                SourceExpr=Blocked }

    { 28  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 1000000027;2;Field  ;
                SourceExpr="Shipping Agent" }

    { 1000000028;2;Field  ;
                SourceExpr="Customer Type" }

    { 1000000029;2;Field  ;
                SourceExpr="Zone Area" }

    { 1000000030;2;Field  ;
                SourceExpr="Have Credit Problem" }

    { 1902768601;1;Group  ;
                CaptionML=[ENU=Communication;
                           THA=การสื่อสาร] }

    { 103 ;2   ;Field     ;
                SourceExpr="Phone No.";
                Importance=Promoted }

    { 104 ;2   ;Field     ;
                SourceExpr="Fax No." }

    { 107 ;2   ;Field     ;
                SourceExpr="E-Mail";
                Importance=Promoted }

    { 109 ;2   ;Field     ;
                SourceExpr="Home Page" }

    { 154 ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                OnValidate=BEGIN
                             ICPartnerCodeOnAfterValidate;
                           END;
                            }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 34  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No." }

    { 36  ;2   ;Field     ;
                SourceExpr="Invoice Copies" }

    { 42  ;2   ;Field     ;
                SourceExpr="Invoice Disc. Code" }

    { 156 ;2   ;Field     ;
                SourceExpr="Copy Sell-to Addr. to Qte From" }

    { 1500011;2;Field     ;
                SourceExpr="Tax Document Type" }

    { 70  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Importance=Promoted }

    { 58  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1500004;2;Field     ;
                SourceExpr="WHT Business Posting Group" }

    { 38  ;2   ;Field     ;
                SourceExpr="Customer Posting Group";
                Importance=Promoted }

    { 40  ;2   ;Field     ;
                SourceExpr="Customer Price Group";
                Importance=Promoted }

    { 44  ;2   ;Field     ;
                SourceExpr="Customer Disc. Group";
                Importance=Promoted }

    { 46  ;2   ;Field     ;
                SourceExpr="Allow Line Disc." }

    { 129 ;2   ;Field     ;
                SourceExpr="Prices Including VAT" }

    { 160 ;2   ;Field     ;
                SourceExpr="Prepayment %" }

    { 1901677601;1;Group  ;
                CaptionML=[ENU=Payments;
                           THA=การชำระเงิน] }

    { 48  ;2   ;Field     ;
                SourceExpr="Application Method" }

    { 50  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 11  ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Importance=Promoted }

    { 15  ;2   ;Field     ;
                SourceExpr="Reminder Terms Code";
                Importance=Promoted }

    { 52  ;2   ;Field     ;
                SourceExpr="Fin. Charge Terms Code";
                Importance=Promoted }

    { 1461000;2;Field     ;
                SourceExpr="Liq. Payment Terms Code" }

    { 54  ;2   ;Field     ;
                SourceExpr="Print Statements" }

    { 60  ;2   ;Field     ;
                SourceExpr="Last Statement No." }

    { 143 ;2   ;Field     ;
                SourceExpr="Block Payment Tolerance";
                OnValidate=BEGIN
                             IF "Block Payment Tolerance" THEN BEGIN
                               IF CONFIRM(Text002,FALSE) THEN
                                 PaymentToleranceMgt.DelTolCustLedgEntry(Rec);
                             END ELSE BEGIN
                               IF CONFIRM(Text001,FALSE) THEN
                                 PaymentToleranceMgt.CalcTolCustLedgEntry(Rec);
                             END;
                           END;
                            }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 95  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 32  ;2   ;Field     ;
                SourceExpr="Combine Shipments" }

    { 158 ;2   ;Field     ;
                SourceExpr=Reserve }

    { 123 ;2   ;Field     ;
                SourceExpr="Shipping Advice";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Importance=Promoted }

    { 101 ;2   ;Field     ;
                SourceExpr="Shipping Agent Code";
                Importance=Promoted }

    { 131 ;2   ;Field     ;
                SourceExpr="Shipping Agent Service Code" }

    { 119 ;2   ;Field     ;
                SourceExpr="Shipping Time" }

    { 141 ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="Base Calendar Code" }

    { 146 ;2   ;Field     ;
                Name=Customized Calendar;
                CaptionML=[ENU=Customized Calendar;
                           THA=ปฎิทินแบบกำหนดเอง];
                SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Customer,"No.",'',"Base Calendar Code");
                Editable=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              TESTFIELD("Base Calendar Code");
                              CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Customer,"No.",'',"Base Calendar Code");
                            END;
                             }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 67  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted }

    { 66  ;2   ;Field     ;
                SourceExpr="Language Code" }

    { 1905108901;1;Group  ;
                CaptionML=[ENU=Kitting;
                           THA=Kitting] }

    { 1462000;2;Field     ;
                SourceExpr="Components on Sales Orders" }

    { 1462002;2;Field     ;
                SourceExpr="Components on Shipments" }

    { 1462004;2;Field     ;
                SourceExpr="Components on Invoices" }

    { 1902813501;1;Group  ;
                CaptionML=[ENU=Registration;
                           THA=การลงทะเบียน] }

    { 1500019;2;Field     ;
                SourceExpr="IRD No." }

    { 1500008;2;Field     ;
                SourceExpr=ABN }

    { 1500010;2;Field     ;
                SourceExpr="ABN Division Part No." }

    { 1500017;2;Group     ;
                CaptionML=[ENU=APAC Requirements;
                           THA=ข้อกำหนด APAC] }

    { 1500014;3;Field     ;
                SourceExpr="VAT Registration No." }

    { 1500006;2;Field     ;
                SourceExpr=Registered }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903720907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9080;
                Visible=TRUE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9082;
                Visible=TRUE;
                PartType=Page }

    { 1905532107;1;Part   ;
                SubFormLink=Table ID=CONST(18),No.=FIELD(No.);
                PagePartID=Page9083;
                Visible=FALSE;
                PartType=Page }

    { 1907829707;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9085;
                Visible=FALSE;
                PartType=Page }

    { 1902613707;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9086;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CustomizedCalEntry@1001 : Record 7603;
      Text001@1003 : TextConst 'ENU=Do you want to allow payment tolerance for entries that are currently open?;THA=คุณต้องการให้สามารถใช้ค่าเผื่อในการชำระเงินสำหรับรายการ ที่เปิดในปัจจุบันได้หรือไม่';
      CustomizedCalendar@1005 : Record 7602;
      Text002@1006 : TextConst 'ENU=Do you want to remove payment tolerance from entries that are currently open?;THA=คุณต้องการลบค่าเผื่อในการชำระเงินออกจากรายการ ที่เปิดอยู่ในปัจจุบันหรือไม่';
      CalendarMgmt@1002 : Codeunit 7600;
      PaymentToleranceMgt@1000 : Codeunit 426;
      SalesInfoPaneMgt@1004 : Codeunit 7171;
      Text003@1102601000 : TextConst 'ENU=The customer %1 does not exist.;THA=ไม่มีลูกค้า %1';
      PostDatedCheck@1500000 : Record 28090;
      GLSetup@1500001 : Record 98;
      MapPointVisible@19022708 : Boolean INDATASET;
      ContactEditable@19051436 : Boolean INDATASET;

    PROCEDURE ActivateFields@3();
    BEGIN
      ContactEditable := "Primary Contact No." = '';
    END;

    LOCAL PROCEDURE ContactOnAfterValidate@19013243();
    BEGIN
      ActivateFields;
    END;

    LOCAL PROCEDURE ICPartnerCodeOnAfterValidate@19032922();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      ActivateFields;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 22 Customer List
{
  OBJECT-PROPERTIES
  {
    Date=12/08/11;
    Time=10:08:50 PM;
    Version List=NAVW16.00.10,NAVAP6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Customer List;
               THA=รายชื่อลูกค้า];
    SourceTable=Table18;
    PageType=List;
    CardFormID=Page21;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 16      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Customer;
                                 THA=&ลูกค้า] }
      { 22      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 25;
                      RunFormView=SORTING(Customer No.);
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=CustomerLedger;
                      PromotedCategory=Process }
      { 76      ;2   ;ActionGroup;
                      CaptionML=[ENU=Issued Documents;
                                 THA=เอกสารที่นำออกใช้] }
      { 77      ;3   ;Action    ;
                      CaptionML=[ENU=Issued &Reminders;
                                 THA=จดหมายเ&ตือนที่ออกใช้];
                      RunObject=Page 440;
                      RunFormView=SORTING(Customer No.,Posting Date);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 78      ;3   ;Action    ;
                      CaptionML=[ENU=Issued &Finance Charge Memos;
                                 THA=บัน&ทึกค่าธรรมเนียมทางการเงินที่ออกใช้];
                      RunObject=Page 452;
                      RunFormView=SORTING(Customer No.,Posting Date);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 20      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Customer),No.=FIELD(No.);
                      Image=ViewComments }
      { 66      ;2   ;ActionGroup;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ] }
      { 84      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions-Single;
                                 THA=มิติ-เดียว];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(18),No.=FIELD(No.) }
      { 42      ;3   ;Action    ;
                      CaptionML=[ENU=Dimensions-&Multiple;
                                 THA=มิติ-&หลายมิติ];
                      OnAction=VAR
                                 Cust@1001 : Record 18;
                                 DefaultDimMultiple@1002 : Form 542;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Cust);
                                 DefaultDimMultiple.SetMultiCust(Cust);
                                 DefaultDimMultiple.RUNMODAL;
                               END;
                                }
      { 58      ;2   ;Action    ;
                      CaptionML=[ENU=Bank Accounts;
                                 THA=บัญชีธนาคาร];
                      RunObject=Page 424;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 23      ;2   ;Action    ;
                      CaptionML=[ENU=Ship-&to Addresses;
                                 THA=จัดส่ง&ที่ที่อยู่];
                      RunObject=Page 301;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 60      ;2   ;Action    ;
                      CaptionML=[ENU=C&ontact;
                                 THA=ผู้ติ&ดต่อ];
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 59      ;2   ;Separator  }
      { 18      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 151;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Statistics by C&urrencies;
                                 THA=สถิติตามส&กุลเงิน];
                      RunObject=Page 481;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Date Filter=FIELD(Date Filter) }
      { 19      ;2   ;Action    ;
                      CaptionML=[ENU=Entry Statistics;
                                 THA=สถิติเกี่ยวกับรายการ];
                      RunObject=Page 302;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 21      ;2   ;Action    ;
                      CaptionML=[ENU=S&ales;
                                 THA=ก&ารขาย];
                      RunObject=Page 155;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 44      ;2   ;Separator  }
      { 45      ;2   ;Action    ;
                      CaptionML=[ENU=Cross Re&ferences;
                                 THA=การ&อ้างอิงไขว้];
                      RunObject=Page 5723;
                      RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunFormLink=Cross-Reference Type=CONST(Customer),Cross-Reference Type No.=FIELD(No.) }
      { 67      ;2   ;Separator  }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Ser&vice Contracts;
                                 THA=สัญญากา&รบริการ];
                      RunObject=Page 6065;
                      RunFormView=SORTING(Customer No.,Ship-to Code);
                      RunFormLink=Customer No.=FIELD(No.);
                      Image=ServiceAgreement }
      { 69      ;2   ;Action    ;
                      CaptionML=[ENU=Service &Items;
                                 THA=สินค้าบ&ริการ];
                      RunObject=Page 5988;
                      RunFormView=SORTING(Customer No.,Ship-to Code,Item No.,Serial No.);
                      RunFormLink=Customer No.=FIELD(No.) }
      { 83      ;2   ;Separator  }
      { 85      ;2   ;Action    ;
                      CaptionML=[ENU=C&redit Cards;
                                 THA=บั&ตรเครดิต];
                      RunObject=Page 828;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 86      ;2   ;Action    ;
                      CaptionML=[ENU=Credit Cards Transaction Lo&g Entries;
                                 THA=รายการบัน&ทึกธุรกรรมบัตรเครดิต];
                      RunObject=Page 829;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 24      ;1   ;ActionGroup;
                      CaptionML=[ENU=S&ales;
                                 THA=ก&ารขาย] }
      { 25      ;2   ;Action    ;
                      CaptionML=[ENU=Invoice &Discounts;
                                 THA=ส่วน&ลดในใบแจ้งหนี้];
                      RunObject=Page 23;
                      RunFormLink=Code=FIELD(Invoice Disc. Code) }
      { 26      ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 THA=ราคา];
                      RunObject=Page 7002;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),Sales Code=FIELD(No.);
                      Image=ResourcePrice }
      { 71      ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 THA=ส่วนลดในบรรทัด];
                      RunObject=Page 7004;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),Sales Code=FIELD(No.) }
      { 82      ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 THA=เปอร์เซ็นต์&การชำระเงินล่วงหน้า];
                      RunObject=Page 664;
                      RunFormView=SORTING(Sales Type,Sales Code);
                      RunFormLink=Sales Type=CONST(Customer),Sales Code=FIELD(No.) }
      { 75      ;2   ;Action    ;
                      CaptionML=;
                      RunObject=Page 173;
                      RunFormLink=Customer No.=FIELD(No.) }
      { 74      ;2   ;Separator  }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=Quotes;
                                 THA=ใบเสนอราคา];
                      RunObject=Page 9300;
                      RunFormView=SORTING(Sell-to Customer No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=Quote }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Blanket Orders;
                                 THA=ใบสั่งแบบรวม];
                      RunObject=Page 9303;
                      RunFormView=SORTING(Document Type,Sell-to Customer No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=BlanketOrder }
      { 28      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 THA=ใบสั่ง];
                      RunObject=Page 9305;
                      RunFormView=SORTING(Sell-to Customer No.);
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Image=Document }
      { 70      ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 THA=ใบสั่งส่งคืนสินค้า];
                      RunObject=Page 9304;
                      Image=ReturnOrder }
      { 81      ;2   ;Action    ;
                      CaptionML=[ENU=Service Orders;
                                 THA=ใบสั่งบริการ];
                      RunObject=Page 9318;
                      RunFormView=SORTING(Document Type,Customer No.);
                      RunFormLink=Customer No.=FIELD(No.);
                      Image=Document }
      { 6500    ;2   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1001 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(1,"No.",'','','','','');
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1902575205;1 ;Action    ;
                      CaptionML=ENU=Blanket Sales Order;
                      RunObject=Page 507;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900246505;1 ;Action    ;
                      CaptionML=ENU=Sales Quote;
                      RunObject=Page 41;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1906384905;1 ;Action    ;
                      CaptionML=ENU=Sales Invoice;
                      RunObject=Page 43;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1904747105;1 ;Action    ;
                      CaptionML=ENU=Sales Order;
                      RunObject=Page 42;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1902583505;1 ;Action    ;
                      CaptionML=ENU=Sales Credit Memo;
                      RunObject=Page 44;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905163705;1 ;Action    ;
                      CaptionML=ENU=Sales Return Order;
                      RunObject=Page 6630;
                      RunFormLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905185205;1 ;Action    ;
                      CaptionML=ENU=Service Quote;
                      RunObject=Page 5964;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1902079405;1 ;Action    ;
                      CaptionML=ENU=Service Invoice;
                      RunObject=Page 5933;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907102005;1 ;Action    ;
                      CaptionML=ENU=Service Order;
                      RunObject=Page 5900;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901662105;1 ;Action    ;
                      CaptionML=ENU=Service Credit Memo;
                      RunObject=Page 5935;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1903839805;1 ;Action    ;
                      CaptionML=ENU=Reminder;
                      RunObject=Page 434;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Reminder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901102005;1 ;Action    ;
                      CaptionML=ENU=Financial Charge Memo;
                      RunObject=Page 446;
                      RunFormLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=FinChargeMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1900839804;1 ;Action    ;
                      CaptionML=ENU=Cash Receipt Journal;
                      RunObject=Page 255;
                      Promoted=Yes;
                      Image=CashReceiptJournal;
                      PromotedCategory=Process }
      { 1900941704;1 ;Action    ;
                      CaptionML=ENU=Cash Receipt Voucher;
                      RunObject=Page 16579;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1904284804;1 ;Action    ;
                      CaptionML=ENU=Bank Receipt Voucher;
                      RunObject=Page 16569;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1905562606;1 ;Action    ;
                      CaptionML=ENU=Customer List;
                      RunObject=Report 101;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1901007206;1 ;Action    ;
                      CaptionML=ENU=Customer Register;
                      RunObject=Report 103;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906871306;1 ;Action    ;
                      CaptionML=ENU=Customer - Detail Trial Bal.;
                      RunObject=Report 104;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907944606;1 ;Action    ;
                      CaptionML=ENU=Customer - Summary Aging;
                      RunObject=Report 105;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906813206;1 ;Action    ;
                      CaptionML=ENU=Customer Detailed Aging;
                      RunObject=Report 106;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905727106;1 ;Action    ;
                      CaptionML=ENU=Customer - Order Summary;
                      RunObject=Report 107;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900172506;1 ;Action    ;
                      CaptionML=ENU=Customer - Order Detail;
                      RunObject=Report 108;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907152806;1 ;Action    ;
                      CaptionML=ENU=Customer - Top 10 List;
                      RunObject=Report 111;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1904190506;1 ;Action    ;
                      CaptionML=ENU=Sales Statistics;
                      RunObject=Report 112;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900760706;1 ;Action    ;
                      CaptionML=ENU=Customer/Item Sales;
                      RunObject=Report 113;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906768606;1 ;Action    ;
                      CaptionML=ENU=Statement;
                      RunObject=Report 116;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1903839806;1 ;Action    ;
                      CaptionML=ENU=Reminder;
                      RunObject=Report 117;
                      Promoted=No;
                      Image=Reminder;
                      PromotedCategory=Report }
      { 1906073506;1 ;Action    ;
                      CaptionML=ENU=Customer - Sales List;
                      RunObject=Report 119;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900711606;1 ;Action    ;
                      CaptionML=ENU=Aged Accounts Receivable;
                      RunObject=Report 120;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1902299006;1 ;Action    ;
                      CaptionML=ENU=Customer - Balance to Date;
                      RunObject=Report 121;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1906359306;1 ;Action    ;
                      CaptionML=ENU=Customer - Trial Balance;
                      RunObject=Report 129;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904039606;1 ;Action    ;
                      CaptionML=ENU=Customer - Payment Receipt;
                      RunObject=Report 211;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 1000000000;2;Field  ;
                SourceExpr=Balance }

    { 1000000002;2;Field  ;
                SourceExpr="Name 2" }

    { 1000000004;2;Field  ;
                SourceExpr="Name (Thai)" }

    { 40  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 43  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 54  ;2   ;Field     ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 32  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 79  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr=Contact }

    { 36  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Customer Posting Group";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Customer Price Group";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Customer Disc. Group";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Reminder Terms Code";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Fin. Charge Terms Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 1500000;2;Field     ;
                SourceExpr=County }

    { 12  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 1102601000;2;Field  ;
                SourceExpr="Credit Limit (LCY)";
                Visible=FALSE }

    { 1102601002;2;Field  ;
                SourceExpr=Blocked;
                Visible=FALSE }

    { 1102601004;2;Field  ;
                SourceExpr="Last Date Modified";
                Visible=FALSE }

    { 1102601006;2;Field  ;
                SourceExpr="Application Method";
                Visible=FALSE }

    { 1102601008;2;Field  ;
                SourceExpr="Combine Shipments";
                Visible=FALSE }

    { 1102601010;2;Field  ;
                SourceExpr=Reserve;
                Visible=FALSE }

    { 1102601012;2;Field  ;
                SourceExpr="Shipping Advice";
                Visible=FALSE }

    { 1102601014;2;Field  ;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 1102601016;2;Field  ;
                SourceExpr="Base Calendar Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903720907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9080;
                Visible=TRUE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9082;
                Visible=TRUE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9084;
                Visible=FALSE;
                PartType=Page }

    { 1907829707;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9085;
                Visible=FALSE;
                PartType=Page }

    { 1902613707;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9086;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      Cust@1000 : Record 18;
      FirstCust@1001 : Code[30];
      LastCust@1002 : Code[30];
      SelectionFilter@1003 : Code[250];
      CustCount@1004 : Integer;
      More@1005 : Boolean;
    BEGIN
      CurrPage.SETSELECTIONFILTER(Cust);
      CustCount := Cust.COUNT;
      IF CustCount > 0 THEN BEGIN
        Cust.FIND('-');
        WHILE CustCount > 0 DO BEGIN
          CustCount := CustCount - 1;
          Cust.MARKEDONLY(FALSE);
          FirstCust := Cust."No.";
          LastCust := FirstCust;
          More := (CustCount > 0);
          WHILE More DO
            IF Cust.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT Cust.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastCust := Cust."No.";
                CustCount := CustCount - 1;
                IF CustCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstCust = LastCust THEN
            SelectionFilter := SelectionFilter + FirstCust
          ELSE
            SelectionFilter := SelectionFilter + FirstCust + '..' + LastCust;
          IF CustCount > 0 THEN BEGIN
            Cust.MARKEDONLY(TRUE);
            Cust.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE SetSelection@1(VAR Cust@1000 : Record 18);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Cust);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 25 Customer Ledger Entries
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Customer Ledger Entries;
               THA=รายการบัญชีแยกประเภทลูกค้า];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table21;
    DataCaptionFields=Customer No.;
    PageType=List;
    OnModifyRecord=BEGIN
                     CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",Rec);
                     EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 24      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 25      ;2   ;Action    ;
                      CaptionML=[ENU=Reminder/Fin. Charge Entries;
                                 THA=รายการจดหมายเตือน/ค่าธรรมเนียมทางการเงิน];
                      RunObject=Page 444;
                      RunFormView=SORTING(Customer Entry No.);
                      RunFormLink=Customer Entry No.=FIELD(Entry No.) }
      { 69      ;2   ;Action    ;
                      CaptionML=[ENU=Applied E&ntries;
                                 THA=รายกา&รที่ใช้];
                      RunObject=Page 61;
                      RunFormOnRec=Yes }
      { 51      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 544;
                      RunFormLink=Table ID=CONST(21),Entry No.=FIELD(Entry No.);
                      Image=Dimensions }
      { 52      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Detailed &Ledger Entries;
                                 THA=รายการบัญชี&แยกประเภทโดยละเอียด];
                      RunObject=Page 573;
                      RunFormView=SORTING(Cust. Ledger Entry No.,Posting Date);
                      RunFormLink=Cust. Ledger Entry No.=FIELD(Entry No.),Customer No.=FIELD(Customer No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 34      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 36      ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      Image=ApplyEntries;
                      OnAction=VAR
                                 CustEntryApplyPostEntries@1000000001 : Codeunit 226;
                               BEGIN
                                 CustEntryApplyPostEntries.ApplyCustEntryformEntry(Rec);
                               END;
                                }
      { 63      ;2   ;Separator  }
      { 64      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Unapply Entries;
                                 THA=รายการที่ยังไม่แอพพลาย];
                      OnAction=VAR
                                 CustEntryApplyPostedEntries@1000000001 : Codeunit 226;
                               BEGIN
                                 CustEntryApplyPostedEntries.UnApplyCustLedgEntry("Entry No.");
                               END;
                                }
      { 65      ;2   ;Separator  }
      { 66      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reverse Transaction;
                                 THA=กลับรายการ];
                      OnAction=VAR
                                 ReversalEntry@1000000001 : Record 179;
                               BEGIN
                                 CLEAR(ReversalEntry);
                                 IF Reversed THEN
                                   ReversalEntry.AlreadyReversedEntry(TABLECAPTION,"Entry No.");
                                 IF "Journal Batch Name" = '' THEN
                                   ReversalEntry.TestFieldError;
                                 TESTFIELD("Transaction No.");
                                 ReversalEntry.ReverseTransaction("Transaction No.");
                               END;
                                }
      { 37      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No.";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Customer No.";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Closed by Entry No.";
                Visible=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Closed by Amount";
                Visible=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Closed at Date";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE;
                Editable=FALSE }

    { 41  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code";
                Visible=FALSE;
                Editable=FALSE }

    { 67  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE;
                Editable=FALSE }

    { 43  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Visible=FALSE;
                Editable=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Editable=FALSE }

    { 55  ;2   ;Field     ;
                SourceExpr="Original Amount";
                Editable=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Original Amt. (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr=Amount;
                Editable=FALSE }

    { 47  ;2   ;Field     ;
                SourceExpr="Amount (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Remaining Amount";
                Editable=FALSE }

    { 49  ;2   ;Field     ;
                SourceExpr="Remaining Amt. (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Bal. Account Type";
                Visible=FALSE;
                Editable=FALSE }

    { 73  ;2   ;Field     ;
                SourceExpr="Bal. Account No.";
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 18  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date" }

    { 59  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Tolerance Date" }

    { 20  ;2   ;Field     ;
                SourceExpr="Original Pmt. Disc. Possible" }

    { 57  ;2   ;Field     ;
                SourceExpr="Remaining Pmt. Disc. Possible" }

    { 61  ;2   ;Field     ;
                SourceExpr="Max. Payment Tolerance" }

    { 28  ;2   ;Field     ;
                SourceExpr=Open;
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="On Hold" }

    { 83  ;2   ;Field     ;
                SourceExpr="User ID";
                Visible=FALSE;
                Editable=FALSE }

    { 85  ;2   ;Field     ;
                SourceExpr="Source Code";
                Visible=FALSE;
                Editable=FALSE }

    { 87  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE;
                Editable=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr=Reversed;
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                SourceExpr="Reversed by Entry No.";
                Visible=FALSE }

    { 75  ;2   ;Field     ;
                SourceExpr="Reversed Entry No.";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Entry No.";
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903096107;1;Part   ;
                SubFormLink=Entry No.=FIELD(Entry No.);
                PagePartID=Page9106;
                Visible=TRUE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Navigate@1000000000 : Form 344;

    BEGIN
    END.
  }
}

OBJECT Page 26 Vendor Card
{
  OBJECT-PROPERTIES
  {
    Date=12/23/11;
    Time=10:19:12 AM;
    Modified=Yes;
    Version List=NAVW16.00.01,LIQEM6.00,NAVAP6.00,AVATHA4.40;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Vendor Card;
               THA=บัตรผู้ขาย];
    SourceTable=Table23;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             ContactEditable := TRUE;
             MapPointVisible := TRUE;
             "Petty Cash AmountEditable" := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000000000 : Codeunit 802;
               BEGIN
                 ActivateFields;
                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := FALSE;
               END;

    OnFindRecord=VAR
                   RecordFound@1000000001 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   IF NOT RecordFound AND (GETFILTER("No.") <> '') THEN
                   BEGIN
                     MESSAGE(Text003,GETFILTER("No."));
                     SETRANGE("No.");
                     RecordFound := FIND(Which);
                   END;
                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       ActivateFields;

                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 64      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ven&dor;
                                 THA=ผู้&ขาย] }
      { 70      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 29;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=VendorLedger;
                      PromotedCategory=Process }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Vendor),No.=FIELD(No.);
                      Image=ViewComments }
      { 184     ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(23),No.=FIELD(No.);
                      Image=Dimensions }
      { 87      ;2   ;Action    ;
                      CaptionML=[ENU=Bank Accounts;
                                 THA=บัญชีธนาคาร];
                      RunObject=Page 426;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 54      ;2   ;Action    ;
                      CaptionML=[ENU=Order &Addresses;
                                 THA=ที่อยู่&ในใบสั่ง];
                      RunObject=Page 369;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 14      ;2   ;Action    ;
                      CaptionML=[ENU=C&ontact;
                                 THA=ผู้ติ&ดต่อ];
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 11      ;2   ;Separator  }
      { 66      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 152;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 20      ;2   ;Action    ;
                      CaptionML=[ENU=Statistics by C&urrencies;
                                 THA=สถิติตามส&กุลเงิน];
                      RunObject=Page 482;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Date Filter=FIELD(Date Filter) }
      { 67      ;2   ;Action    ;
                      CaptionML=[ENU=Entry Statistics;
                                 THA=สถิติเกี่ยวกับรายการ];
                      RunObject=Page 303;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 69      ;2   ;Action    ;
                      CaptionML=[ENU=Purchases;
                                 THA=การซื้อ];
                      RunObject=Page 156;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 83      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 84      ;2   ;Action    ;
                      CaptionML=[ENU=Cross References;
                                 THA=การอ้างอิงไขว้];
                      RunObject=Page 5723;
                      RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunFormLink=Cross-Reference Type=CONST(Vendor),Cross-Reference Type No.=FIELD(No.) }
      { 108     ;2   ;Separator  }
      { 102     ;2   ;Action    ;
                      CaptionML=[ENU=Online Map;
                                 THA=Online Map];
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 71      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Purchases;
                                 THA=&การซื้อ] }
      { 118     ;2   ;Action    ;
                      CaptionML=[ENU=Items;
                                 THA=สินค้า];
                      RunObject=Page 297;
                      RunFormView=SORTING(Vendor No.,Item No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 73      ;2   ;Action    ;
                      CaptionML=[ENU=Invoice &Discounts;
                                 THA=ส่วน&ลดในใบแจ้งหนี้];
                      RunObject=Page 28;
                      RunFormLink=Code=FIELD(Invoice Disc. Code) }
      { 72      ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 THA=ราคา];
                      RunObject=Page 7012;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.);
                      Image=ResourcePrice }
      { 116     ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 THA=ส่วนลดในบรรทัด];
                      RunObject=Page 7014;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 129     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 THA=เปอร์เซ็นต์&การชำระเงินล่วงหน้า];
                      RunObject=Page 665;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 123     ;2   ;Action    ;
                      CaptionML=;
                      RunObject=Page 178;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 117     ;2   ;Separator  }
      { 74      ;2   ;Action    ;
                      CaptionML=[ENU=Quotes;
                                 THA=ใบเสนอราคา];
                      RunObject=Page 9306;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Quote }
      { 21      ;2   ;Action    ;
                      CaptionML=[ENU=Blanket Orders;
                                 THA=ใบสั่งแบบรวม];
                      RunObject=Page 9310;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=BlanketOrder }
      { 75      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 THA=ใบสั่ง];
                      RunObject=Page 9307;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.,No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Document }
      { 99      ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 THA=ใบสั่งส่งคืนสินค้า];
                      RunObject=Page 9311;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.,No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=ReturnOrder }
      { 6500    ;2   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1000000001 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(2,"No.",'','','','','');
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1903213705;1 ;Action    ;
                      CaptionML=ENU=Blanket Purchase Order;
                      RunObject=Page 509;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901469405;1 ;Action    ;
                      CaptionML=ENU=Purchase Quote;
                      RunObject=Page 49;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907709505;1 ;Action    ;
                      CaptionML=ENU=Purchase Invoice;
                      RunObject=Page 51;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907375405;1 ;Action    ;
                      CaptionML=ENU=Purchase Order;
                      RunObject=Page 50;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905024805;1 ;Action    ;
                      CaptionML=ENU=Purchase Credit Memo;
                      RunObject=Page 52;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1904749705;1 ;Action    ;
                      CaptionML=ENU=Purchase Return Order;
                      RunObject=Page 6640;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 130     ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 131     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Template;
                                 THA=ใช้ต้นแบบ];
                      Promoted=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TemplateMgt@1000000001 : Codeunit 8612;
                                 RecRef@1000000002 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 TemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
      { 1902327104;1 ;Action    ;
                      CaptionML=ENU=Payment Journal;
                      RunObject=Page 256;
                      Promoted=Yes;
                      Image=PaymentJournal;
                      PromotedCategory=Process }
      { 1906371704;1 ;Action    ;
                      CaptionML=ENU=Purchase Journal;
                      RunObject=Page 254;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1905916106;1 ;Action    ;
                      CaptionML=ENU=Vendor - Labels;
                      RunObject=Report 310;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904504206;1 ;Action    ;
                      CaptionML=ENU=Vendor - Balance to Date;
                      RunObject=Report 321;
                      Promoted=No;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Name;
                Importance=Promoted }

    { 6   ;2   ;Field     ;
                SourceExpr=Address }

    { 8   ;2   ;Field     ;
                SourceExpr="Address 2" }

    { 1000000004;2;Field  ;
                SourceExpr="Address 3" }

    { 79  ;2   ;Field     ;
                SourceExpr="Post Code";
                Importance=Promoted }

    { 1500015;2;Field     ;
                SourceExpr=County }

    { 12  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 114 ;2   ;Field     ;
                SourceExpr="Primary Contact No." }

    { 16  ;2   ;Field     ;
                SourceExpr=Contact;
                Importance=Promoted;
                Editable=ContactEditable;
                OnValidate=BEGIN
                             ContactOnAfterValidate;
                           END;
                            }

    { 1000000000;2;Field  ;
                SourceExpr="Name (Thai)" }

    { 1000000002;2;Field  ;
                SourceExpr="Address (Thai)";
                MultiLine=Yes }

    { 10  ;2   ;Field     ;
                SourceExpr=City }

    { 81  ;2   ;Field     ;
                CaptionML=[ENU=County/Country Code;
                           THA=เขต/รหัสประเทศ];
                SourceExpr="Country/Region Code" }

    { 18  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 92  ;2   ;Field     ;
                SourceExpr="Balance (LCY)";
                OnDrillDown=VAR
                              VendLedgEntry@1000000001 : Record 25;
                              DtldVendLedgEntry@1000000002 : Record 380;
                            BEGIN
                              DtldVendLedgEntry.SETRANGE("Vendor No.","No.");
                              COPYFILTER("Global Dimension 1 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 1");
                              COPYFILTER("Global Dimension 2 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 2");
                              COPYFILTER("Currency Filter",DtldVendLedgEntry."Currency Code");
                              VendLedgEntry.DrillDownOnEntries(DtldVendLedgEntry);
                            END;
                             }

    { 1500003;2;Field     ;
                SourceExpr="Post Dated Checks (LCY)";
                OnDrillDown=VAR
                              DtldCustLedgEntry@1000000001 : Record 379;
                              CustLedgEntry@1000000002 : Record 21;
                            BEGIN
                              PostDatedCheck.RESET;
                              PostDatedCheck.SETCURRENTKEY("Account Type","Account No.");
                              PostDatedCheck.SETRANGE("Account Type",PostDatedCheck."Account Type"::Vendor);
                              PostDatedCheck.SETRANGE("Account No.","No.");
                              FORM.RUNMODAL(FORM::"Post Dated Checks List-Purch.",PostDatedCheck);
                            END;
                             }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Provisional Balance (LCY);
                           THA=ดุลสำรอง (LCY)];
                SourceExpr="Balance (LCY)"-ABS("Post Dated Checks (LCY)") }

    { 22  ;2   ;Field     ;
                SourceExpr="Purchaser Code" }

    { 55  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 24  ;2   ;Field     ;
                SourceExpr=Blocked }

    { 26  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 1000000006;2;Field  ;
                SourceExpr="Dummy Vendor" }

    { 1000000010;2;Field  ;
                SourceExpr="Petty Cash";
                OnValidate=BEGIN
                             PettyCashOnAfterValidate;
                           END;
                            }

    { 1000000008;2;Field  ;
                SourceExpr="Petty Cash Amount";
                Editable="Petty Cash AmountEditable" }

    { 1000000012;2;Field  ;
                SourceExpr="Cash Advance" }

    { 1000000014;2;Field  ;
                SourceExpr="Vendor for WHT only" }

    { 1902768601;1;Group  ;
                CaptionML=[ENU=Communication;
                           THA=การสื่อสาร] }

    { 44  ;2   ;Field     ;
                SourceExpr="Phone No.";
                Importance=Promoted }

    { 45  ;2   ;Field     ;
                SourceExpr="Fax No." }

    { 48  ;2   ;Field     ;
                SourceExpr="E-Mail";
                Importance=Promoted }

    { 86  ;2   ;Field     ;
                SourceExpr="Home Page" }

    { 125 ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                OnValidate=BEGIN
                             ICPartnerCodeOnAfterValidate;
                           END;
                            }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 30  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No." }

    { 60  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Importance=Promoted }

    { 90  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1500004;2;Field     ;
                SourceExpr="WHT Business Posting Group";
                Importance=Promoted }

    { 32  ;2   ;Field     ;
                SourceExpr="Vendor Posting Group";
                Importance=Promoted }

    { 34  ;2   ;Field     ;
                SourceExpr="Invoice Disc. Code" }

    { 94  ;2   ;Field     ;
                SourceExpr="Prices Including VAT" }

    { 127 ;2   ;Field     ;
                SourceExpr="Prepayment %" }

    { 1901677601;1;Group  ;
                CaptionML=[ENU=Payments;
                           THA=การชำระเงิน] }

    { 36  ;2   ;Field     ;
                SourceExpr="Application Method" }

    { 1000000018;2;Group  ;
                CaptionML=ENU=Bank Cheque }

    { 1000000016;3;Field  ;
                CaptionML=ENU=Documents Require (Distribution Code);
                SourceExpr="Documents Require";
                MultiLine=Yes }

    { 1000000020;3;Field  ;
                SourceExpr="Fax No." }

    { 38  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 40  ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Importance=Promoted }

    { 42  ;2   ;Field     ;
                SourceExpr=Priority }

    { 1461000;2;Field     ;
                SourceExpr="Liq. Payment Terms Code" }

    { 50  ;2   ;Field     ;
                SourceExpr="Our Account No." }

    { 119 ;2   ;Field     ;
                SourceExpr="Block Payment Tolerance";
                OnValidate=BEGIN
                             IF "Block Payment Tolerance" THEN BEGIN
                               IF CONFIRM(Text002,FALSE) THEN
                                 PaymentToleranceMgt.DelTolVendLedgEntry(Rec);
                             END ELSE BEGIN
                               IF CONFIRM(Text001,FALSE) THEN
                                 PaymentToleranceMgt.CalcTolVendLedgEntry(Rec);
                             END;
                           END;
                            }

    { 1901075901;1;Group  ;
                CaptionML=[ENU=Receiving;
                           THA=การรับ] }

    { 100 ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 28  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Importance=Promoted }

    { 96  ;2   ;Field     ;
                SourceExpr="Lead Time Calculation";
                Importance=Promoted }

    { 112 ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="Base Calendar Code" }

    { 121 ;2   ;Field     ;
                Name=Customized Calendar;
                CaptionML=[ENU=Customized Calendar;
                           THA=ปฎิทินแบบกำหนดเอง];
                SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                Editable=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              TESTFIELD("Base Calendar Code");
                              CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                            END;
                             }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 52  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted }

    { 56  ;2   ;Field     ;
                SourceExpr="Language Code" }

    { 1902813501;1;Group  ;
                CaptionML=[ENU=Registration;
                           THA=การลงทะเบียน] }

    { 1500021;2;Group     ;
                CaptionML=[ENU=APAC Requirements;
                           THA=ข้อกำหนด APAC] }

    { 1500016;3;Field     ;
                SourceExpr="VAT Registration No." }

    { 1500007;3;Field     ;
                SourceExpr="ID No." }

    { 1500023;2;Field     ;
                SourceExpr="IRD No." }

    { 1500011;2;Field     ;
                SourceExpr=ABN }

    { 1500012;2;Field     ;
                SourceExpr="ABN Division Part No." }

    { 1500018;2;Field     ;
                SourceExpr=Registered }

    { 1500014;2;Field     ;
                SourceExpr="Foreign Vend" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1904651607;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9094;
                Visible=TRUE;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CalendarMgmt@1000000000 : Codeunit 7600;
      PaymentToleranceMgt@1000000001 : Codeunit 426;
      CustomizedCalEntry@1000000002 : Record 7603;
      CustomizedCalendar@1000000003 : Record 7602;
      Text001@1000000004 : TextConst 'ENU=Do you want to allow payment tolerance for entries that are currently open?;THA=คุณต้องการให้สามารถใช้ค่าเผื่อในการชำระเงินสำหรับรายการ ที่เปิดในปัจจุบันได้หรือไม่';
      Text002@1000000005 : TextConst 'ENU=Do you want to remove payment tolerance from entries that are currently open?;THA=คุณต้องการลบค่าเผื่อในการชำระเงินออกจากรายการ ที่เปิดอยู่ในปัจจุบันหรือไม่';
      PostDatedCheck@1000000006 : Record 28090;
      PurchInfoPaneMgt@1000000007 : Codeunit 7181;
      Text003@1000000008 : TextConst 'ENU=The vendor %1 does not exist.;THA=ไม่มีผู้ขาย %1';
      "Petty Cash AmountEditable"@19079847 : Boolean INDATASET;
      MapPointVisible@19022708 : Boolean INDATASET;
      ContactEditable@19051436 : Boolean INDATASET;

    PROCEDURE ActivateFields@3();
    BEGIN
      ContactEditable := "Primary Contact No." = '';
      "Petty Cash AmountEditable" := "Petty Cash";  //KKE : #002
    END;

    LOCAL PROCEDURE ContactOnAfterValidate@19013243();
    BEGIN
      ActivateFields;
    END;

    LOCAL PROCEDURE PettyCashOnAfterValidate@19061379();
    BEGIN
      //KKE : #002 +
      IF NOT "Petty Cash" THEN
        "Petty Cash Amount" := 0;
      "Petty Cash AmountEditable" := "Petty Cash";
      //KKE : #002 -
    END;

    LOCAL PROCEDURE ICPartnerCodeOnAfterValidate@19032922();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      ActivateFields;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
      002   18.08.2006   KKE   Petty Cash
      003   30.08.2006   KKE   Cash Advance
    }
    END.
  }
}

OBJECT Page 27 Vendor List
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,NAVAP6.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Vendor List;
               THA=รายชื่อผู้ขาย];
    SourceTable=Table23;
    PageType=List;
    CardFormID=Page26;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 16      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ven&dor;
                                 THA=ผู้&ขาย] }
      { 22      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 29;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=VendorLedger;
                      PromotedCategory=Process }
      { 20      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Vendor),No.=FIELD(No.);
                      Image=ViewComments }
      { 44      ;2   ;ActionGroup;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ] }
      { 84      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions-Single;
                                 THA=มิติ-เดียว];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(23),No.=FIELD(No.) }
      { 43      ;3   ;Action    ;
                      CaptionML=[ENU=Dimensions-&Multiple;
                                 THA=มิติ-&หลายมิติ];
                      OnAction=VAR
                                 Vend@1000000001 : Record 23;
                                 DefaultDimMultiple@1000000002 : Form 542;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Vend);
                                 DefaultDimMultiple.SetMultiVendor(Vend);
                                 DefaultDimMultiple.RUNMODAL;
                               END;
                                }
      { 54      ;2   ;Action    ;
                      CaptionML=[ENU=Bank Accounts;
                                 THA=บัญชีธนาคาร];
                      RunObject=Page 426;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=Order &Addresses;
                                 THA=ที่อยู่&ในใบสั่ง];
                      RunObject=Page 369;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 56      ;2   ;Action    ;
                      CaptionML=[ENU=C&ontact;
                                 THA=ผู้ติ&ดต่อ];
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 55      ;2   ;Separator  }
      { 18      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 152;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 57      ;2   ;Action    ;
                      CaptionML=[ENU=Statistics by C&urrencies;
                                 THA=สถิติตามส&กุลเงิน];
                      RunObject=Page 482;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Date Filter=FIELD(Date Filter) }
      { 19      ;2   ;Action    ;
                      CaptionML=[ENU=Entry Statistics;
                                 THA=สถิติเกี่ยวกับรายการ];
                      RunObject=Page 303;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 21      ;2   ;Action    ;
                      CaptionML=[ENU=Purchases;
                                 THA=การซื้อ];
                      RunObject=Page 156;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter) }
      { 61      ;2   ;Separator  }
      { 62      ;2   ;Action    ;
                      CaptionML=[ENU=Cross Re&ferences;
                                 THA=การ&อ้างอิงไขว้];
                      RunObject=Page 5723;
                      RunFormView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunFormLink=Cross-Reference Type=CONST(Vendor),Cross-Reference Type No.=FIELD(No.) }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Purchases;
                                 THA=&การซื้อ] }
      { 66      ;2   ;Action    ;
                      CaptionML=[ENU=Items;
                                 THA=สินค้า];
                      RunObject=Page 297;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 25      ;2   ;Action    ;
                      CaptionML=[ENU=Invoice &Discounts;
                                 THA=ส่วน&ลดในใบแจ้งหนี้];
                      RunObject=Page 28;
                      RunFormLink=Code=FIELD(Invoice Disc. Code) }
      { 24      ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 THA=ราคา];
                      RunObject=Page 7012;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.);
                      Image=ResourcePrice }
      { 64      ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 THA=ส่วนลดในบรรทัด];
                      RunObject=Page 7014;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 70      ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 THA=เปอร์เซ็นต์&การชำระเงินล่วงหน้า];
                      RunObject=Page 665;
                      RunFormView=SORTING(Vendor No.);
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 67      ;2   ;Action    ;
                      CaptionML=;
                      RunObject=Page 178;
                      RunFormLink=Vendor No.=FIELD(No.) }
      { 65      ;2   ;Separator  }
      { 26      ;2   ;Action    ;
                      CaptionML=[ENU=Quotes;
                                 THA=ใบเสนอราคา];
                      RunObject=Page 9306;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Quote }
      { 58      ;2   ;Action    ;
                      CaptionML=[ENU=Blanket Orders;
                                 THA=ใบสั่งแบบรวม];
                      RunObject=Page 9310;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=BlanketOrder }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 THA=ใบสั่ง];
                      RunObject=Page 9307;
                      RunFormView=SORTING(Document Type,Buy-from Vendor No.,No.);
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Document }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 THA=ใบสั่งส่งคืนสินค้า];
                      RunObject=Page 9311;
                      Image=ReturnOrder }
      { 6500    ;2   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1000000001 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(2,"No.",'','','','','');
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1903213705;1 ;Action    ;
                      CaptionML=ENU=Blanket Purchase Order;
                      RunObject=Page 509;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1901469405;1 ;Action    ;
                      CaptionML=ENU=Purchase Quote;
                      RunObject=Page 49;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907709505;1 ;Action    ;
                      CaptionML=ENU=Purchase Invoice;
                      RunObject=Page 51;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1907375405;1 ;Action    ;
                      CaptionML=ENU=Purchase Order;
                      RunObject=Page 50;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1905024805;1 ;Action    ;
                      CaptionML=ENU=Purchase Credit Memo;
                      RunObject=Page 52;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1904749705;1 ;Action    ;
                      CaptionML=ENU=Purchase Return Order;
                      RunObject=Page 6640;
                      RunFormLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1902327104;1 ;Action    ;
                      CaptionML=ENU=Payment Journal;
                      RunObject=Page 256;
                      Promoted=Yes;
                      Image=PaymentJournal;
                      PromotedCategory=Process }
      { 1904813504;1 ;Action    ;
                      CaptionML=ENU=Bank Payment Voucher;
                      RunObject=Page 16577;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1903290704;1 ;Action    ;
                      CaptionML=ENU=Cash Payment Voucher;
                      RunObject=Page 16576;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1906371704;1 ;Action    ;
                      CaptionML=ENU=Purchase Journal;
                      RunObject=Page 254;
                      Promoted=No;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1900518506;1 ;Action    ;
                      CaptionML=ENU=Vendor - List;
                      RunObject=Report 301;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906328906;1 ;Action    ;
                      CaptionML=ENU=Vendor Register;
                      RunObject=Report 303;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900639206;1 ;Action    ;
                      CaptionML=ENU=Vendor - Detail Trial Balance;
                      RunObject=Report 304;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905685906;1 ;Action    ;
                      CaptionML=ENU=Vendor - Summary Aging;
                      RunObject=Report 305;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906294906;1 ;Action    ;
                      CaptionML=ENU=Vendor - Order Summary;
                      RunObject=Report 307;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1904076306;1 ;Action    ;
                      CaptionML=ENU=Vendor - Order Detail;
                      RunObject=Report 308;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907303206;1 ;Action    ;
                      CaptionML=ENU=Vendor - Purchase List;
                      RunObject=Report 309;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1905916106;1 ;Action    ;
                      CaptionML=ENU=Vendor - Labels;
                      RunObject=Report 310;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900497106;1 ;Action    ;
                      CaptionML=ENU=Vendor - Top 10 List;
                      RunObject=Report 311;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1905448306;1 ;Action    ;
                      CaptionML=ENU=Purchase Statistics;
                      RunObject=Report 312;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904498706;1 ;Action    ;
                      CaptionML=ENU=Vendor/Item Purchases;
                      RunObject=Report 313;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905766406;1 ;Action    ;
                      CaptionML=ENU=Payments on Hold;
                      RunObject=Report 319;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1906643406;1 ;Action    ;
                      CaptionML=ENU=Vendor Item Catalog;
                      RunObject=Report 320;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904504206;1 ;Action    ;
                      CaptionML=ENU=Vendor - Balance to Date;
                      RunObject=Report 321;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1905388206;1 ;Action    ;
                      CaptionML=ENU=Aged Accounts Payable;
                      RunObject=Report 322;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1906387606;1 ;Action    ;
                      CaptionML=ENU=Vendor - Trial Balance;
                      RunObject=Report 329;
                      Promoted=No;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 1000000000;2;Field  ;
                SourceExpr=Balance }

    { 41  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 59  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 29  ;2   ;Field     ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 31  ;2   ;Field     ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 33  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr=Contact }

    { 37  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Vendor Posting Group";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 49  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Fin. Charge Terms Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 47  ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 1500000;2;Field     ;
                SourceExpr=County }

    { 12  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 1102601000;2;Field  ;
                SourceExpr=Blocked;
                Visible=FALSE }

    { 1102601002;2;Field  ;
                SourceExpr="Last Date Modified";
                Visible=FALSE }

    { 1102601004;2;Field  ;
                SourceExpr="Application Method";
                Visible=FALSE }

    { 1102601006;2;Field  ;
                SourceExpr="Location Code";
                Visible=FALSE }

    { 1102601008;2;Field  ;
                SourceExpr="Shipment Method Code";
                Visible=FALSE }

    { 1102601010;2;Field  ;
                SourceExpr="Lead Time Calculation";
                Visible=FALSE }

    { 1102601012;2;Field  ;
                SourceExpr="Base Calendar Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1901138007;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1904651607;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9094;
                Visible=TRUE;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      Vend@1000000000 : Record 23;
      FirstVend@1000000001 : Code[30];
      LastVend@1000000002 : Code[30];
      SelectionFilter@1000000003 : Code[250];
      VendCount@1000000004 : Integer;
      More@1000000005 : Boolean;
    BEGIN
      CurrPage.SETSELECTIONFILTER(Vend);
      VendCount := Vend.COUNT;
      IF VendCount > 0 THEN BEGIN
        Vend.FIND('-');
        WHILE VendCount > 0 DO BEGIN
          VendCount := VendCount - 1;
          Vend.MARKEDONLY(FALSE);
          FirstVend := Vend."No.";
          LastVend := FirstVend;
          More := (VendCount > 0);
          WHILE More DO
            IF Vend.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT Vend.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastVend := Vend."No.";
                VendCount := VendCount - 1;
                IF VendCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstVend = LastVend THEN
            SelectionFilter := SelectionFilter + FirstVend
          ELSE
            SelectionFilter := SelectionFilter + FirstVend + '..' + LastVend;
          IF VendCount > 0 THEN BEGIN
            Vend.MARKEDONLY(TRUE);
            Vend.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE SetSelection@1(VAR Vend@1000000000 : Record 23);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Vend);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 29 Vendor Ledger Entries
{
  OBJECT-PROPERTIES
  {
    Date=12/26/11;
    Time=[ 9:34:11 AM];
    Modified=Yes;
    Version List=NAVW16.00,NAVAP4.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Vendor Ledger Entries;
               THA=รายการบัญชีแยกประเภทผู้ขาย];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table25;
    DataCaptionFields=Vendor No.;
    PageType=List;
    OnModifyRecord=BEGIN
                     CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",Rec);
                     EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 53      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 72      ;2   ;Action    ;
                      CaptionML=[ENU=Applied E&ntries;
                                 THA=รายกา&รที่ใช้];
                      RunObject=Page 62;
                      RunFormOnRec=Yes }
      { 55      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 544;
                      RunFormLink=Table ID=CONST(25),Entry No.=FIELD(Entry No.);
                      Image=Dimensions }
      { 54      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Detailed &Ledger Entries;
                                 THA=รายการบัญชี&แยกประเภทโดยละเอียด];
                      RunObject=Page 574;
                      RunFormView=SORTING(Vendor Ledger Entry No.,Posting Date);
                      RunFormLink=Vendor Ledger Entry No.=FIELD(Entry No.),Vendor No.=FIELD(Vendor No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 34      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 36      ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      Image=ApplyEntries;
                      OnAction=VAR
                                 VendEntryApplyPostEntries@1000000001 : Codeunit 227;
                               BEGIN
                                 VendEntryApplyPostEntries.ApplyVendEntryformEntry(Rec);
                               END;
                                }
      { 66      ;2   ;Separator  }
      { 67      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Unapply Entries;
                                 THA=รายการที่ยังไม่แอพพลาย];
                      OnAction=VAR
                                 VendEntryApplyPostedEntries@1000000001 : Codeunit 227;
                               BEGIN
                                 VendEntryApplyPostedEntries.UnApplyVendLedgEntry("Entry No.");
                               END;
                                }
      { 68      ;2   ;Separator  }
      { 69      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reverse Transaction;
                                 THA=กลับรายการ];
                      OnAction=VAR
                                 ReversalEntry@1000000001 : Record 179;
                                 Vendor@1000000002 : Record 23;
                               BEGIN
                                 CLEAR(ReversalEntry);
                                 IF Reversed THEN
                                   ReversalEntry.AlreadyReversedEntry(TABLECAPTION,"Entry No.");
                                 IF "Journal Batch Name" = '' THEN BEGIN
                                   //KKE : #001 +
                                   Vendor.GET("Vendor No.");
                                   IF NOT (Vendor."Cash Advance" OR Vendor."Petty Cash") THEN
                                   //KKE : #001 -
                                     ReversalEntry.TestFieldError;
                                 END;
                                 TESTFIELD("Transaction No.");
                                 ReversalEntry.ReverseTransaction("Transaction No.");
                               END;
                                }
      { 1000000004;2 ;Separator  }
      { 1000000005;2 ;Action    ;
                      CaptionML=ENU=Reset Applies to ID On Closed Entry;
                      OnAction=BEGIN
                                 VendEntryEdit.ResetAppliestoIDOnCloseEntry;
                                 CLEAR(VendEntryEdit);
                               END;
                                }
      { 37      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No.";
                Editable=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Editable=TRUE }

    { 8   ;2   ;Field     ;
                SourceExpr="Vendor No.";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE;
                Editable=FALSE }

    { 41  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code";
                Visible=FALSE;
                Editable=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE;
                Editable=FALSE }

    { 43  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Visible=FALSE;
                Editable=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Editable=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Original Amount";
                Editable=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Original Amt. (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr=Amount;
                Editable=FALSE }

    { 47  ;2   ;Field     ;
                SourceExpr="Amount (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="WHT Amount" }

    { 1500002;2;Field     ;
                SourceExpr="WHT Amount (LCY)" }

    { 1000000000;2;Field  ;
                SourceExpr="Rem. Amt for WHT";
                Visible=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Rem. Amt";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Remaining Amount";
                Editable=FALSE }

    { 49  ;2   ;Field     ;
                SourceExpr="Remaining Amt. (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Bal. Account Type";
                Visible=FALSE;
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Bal. Account No.";
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 18  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date" }

    { 62  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Tolerance Date" }

    { 20  ;2   ;Field     ;
                SourceExpr="Original Pmt. Disc. Possible" }

    { 60  ;2   ;Field     ;
                SourceExpr="Remaining Pmt. Disc. Possible" }

    { 64  ;2   ;Field     ;
                SourceExpr="Max. Payment Tolerance" }

    { 28  ;2   ;Field     ;
                SourceExpr=Open;
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="On Hold" }

    { 77  ;2   ;Field     ;
                SourceExpr="User ID";
                Visible=FALSE;
                Editable=FALSE }

    { 79  ;2   ;Field     ;
                SourceExpr="Source Code";
                Visible=FALSE;
                Editable=FALSE }

    { 81  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE;
                Editable=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr=Reversed;
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="Reversed by Entry No.";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                SourceExpr="Reversed Entry No.";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Entry No.";
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Navigate@1000000000 : Form 344;
      VendEntryEdit@1000000001 : Codeunit 113;

    BEGIN
    {
      Project : Burda
      001  03.01.2008  KKE  -Allow reverse transaction for Cash Advance Invoice,Petty Cash Invoice
    }
    END.
  }
}

OBJECT Page 30 Item Card
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=11:54:04 AM;
    Version List=NAVW16.00.01,KITNA6.00,NAVAP6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Item Card;
               THA=บัตรสินค้า];
    SourceTable=Table27;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             "Unit CostEnable" := TRUE;
             "Standard CostEnable" := TRUE;
             "Include InventoryEnable" := TRUE;
             "Order MultipleEnable" := TRUE;
             "Maximum Order QuantityEnable" := TRUE;
             "Minimum Order QuantityEnable" := TRUE;
             "Maximum InventoryEnable" := TRUE;
             "Reorder QuantityEnable" := TRUE;
             "Reorder PointEnable" := TRUE;
             "Safety Stock QuantityEnable" := TRUE;
             "Safety Lead TimeEnable" := TRUE;
             "Reorder CycleEnable" := TRUE;
             "Item TypeEditable" := TRUE;
             "Production BOM No.Enable" := TRUE;
           END;

    OnOpenPage=BEGIN
                 //KKE : #003 +
                 IF UserMgt.GetMagazineItemFilter() <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETFILTER("Magazine Code",UserMgt.GetMagazineItemFilter());
                   FILTERGROUP(0);
                 END;
                 //KKE : #003 -
               END;

    OnAfterGetRecord=BEGIN
                       EnablePlanningControls;
                       EnableCostingControls;
                       "Production BOM No.Enable" := ("Kit BOM No." = '');
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  EnableCostingControls;
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 103     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Item;
                                 THA=&สินค้า] }
      { 157     ;2   ;Action    ;
                      CaptionML=[ENU=Stockkeepin&g Units;
                                 THA=หน่วยจัดเก็บ&สต็อก];
                      RunObject=Page 5701;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.) }
      { 101     ;2   ;ActionGroup;
                      CaptionML=[ENU=E&ntries;
                                 THA=ร&ายการ] }
      { 105     ;3   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 38;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Promoted=No;
                      Image=ItemLedger;
                      PromotedCategory=Process }
      { 75      ;3   ;Action    ;
                      CaptionML=[ENU=&Reservation Entries;
                                 THA=&รายการจอง];
                      RunObject=Page 497;
                      RunFormView=SORTING(Item No.,Variant Code,Location Code,Reservation Status);
                      RunFormLink=Reservation Status=CONST(Reservation),Item No.=FIELD(No.);
                      Image=ReservationLedger }
      { 112     ;3   ;Action    ;
                      CaptionML=[ENU=&Phys. Inventory Ledger Entries;
                                 THA=&รายการในสมุดบัญชีแยกประเภทของสินค้าคงคลังที่มีอยู่จริง];
                      RunObject=Page 390;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=PhysicalInventoryLedger }
      { 5800    ;3   ;Action    ;
                      CaptionML=[ENU=&Value Entries;
                                 THA=&รายการบัญชีแสดงมูลค่า];
                      RunObject=Page 5802;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=ValueLedger }
      { 6500    ;3   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1000000001 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(3,'',"No.",'','','','');
                               END;
                                }
      { 237     ;3   ;Action    ;
                      CaptionML=[ENU=Application Worksheet;
                                 THA=แผ่นงานแอพพลิเคชัน];
                      RunObject=Page 521;
                      RunFormLink=Item No.=FIELD(No.) }
      { 102     ;2   ;ActionGroup;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ] }
      { 107     ;3   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ItemStatistics@1000000001 : Form 5827;
                               BEGIN
                                 ItemStatistics.SetItem(Rec);
                                 ItemStatistics.RUNMODAL;
                               END;
                                }
      { 108     ;3   ;Action    ;
                      CaptionML=[ENU=Entry Statistics;
                                 THA=สถิติเกี่ยวกับรายการ];
                      RunObject=Page 304;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 111     ;3   ;Action    ;
                      CaptionML=[ENU=T&urnover;
                                 THA=อั&ตราหมุนเวียน];
                      RunObject=Page 158;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Items b&y Location;
                                 THA=สินค้าต&ามที่ตั้ง];
                      Image=ItemAvailbyLoc;
                      OnAction=VAR
                                 ItemsByLocation@1000000001 : Form 491;
                               BEGIN
                                 ItemsByLocation.SETRECORD(Rec);
                                 ItemsByLocation.RUN;
                               END;
                                }
      { 76      ;2   ;ActionGroup;
                      CaptionML=[ENU=&Item Availability by;
                                 THA=&การมีอยู่ของสินค้าตาม] }
      { 110     ;3   ;Action    ;
                      CaptionML=[ENU=Period;
                                 THA=รอบระยะเวลา];
                      RunObject=Page 157;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 77      ;3   ;Action    ;
                      CaptionML=[ENU=Variant;
                                 THA=ตัวแปร];
                      RunObject=Page 5414;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 69      ;3   ;Action    ;
                      CaptionML=[ENU=Location;
                                 THA=ที่ตั้ง];
                      RunObject=Page 492;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 212     ;2   ;Action    ;
                      CaptionML=[ENU=&Bin Contents;
                                 THA=&กำหนดช่องเก็บ];
                      RunObject=Page 7379;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=BinContent }
      { 106     ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Item),No.=FIELD(No.);
                      Image=ViewComments }
      { 184     ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(27),No.=FIELD(No.);
                      Image=Dimensions }
      { 109     ;2   ;Action    ;
                      CaptionML=[ENU=&Picture;
                                 THA=&รูปภาพ];
                      RunObject=Page 346;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 113     ;2   ;Separator  }
      { 114     ;2   ;Action    ;
                      CaptionML=[ENU=&Units of Measure;
                                 THA=&หน่วยวัด];
                      RunObject=Page 5404;
                      RunFormLink=Item No.=FIELD(No.) }
      { 119     ;2   ;Action    ;
                      CaptionML=[ENU=Va&riants;
                                 THA=ตั&วแปร];
                      RunObject=Page 5401;
                      RunFormLink=Item No.=FIELD(No.) }
      { 161     ;2   ;Action    ;
                      CaptionML=[ENU=Cross Re&ferences;
                                 THA=การ&อ้างอิงไขว้];
                      RunObject=Page 5721;
                      RunFormLink=Item No.=FIELD(No.) }
      { 158     ;2   ;Action    ;
                      CaptionML=[ENU=Substituti&ons;
                                 THA=สิ่ง&ทดแทน];
                      RunObject=Page 5716;
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.) }
      { 70      ;2   ;Action    ;
                      CaptionML=[ENU=Nonstoc&k Items;
                                 THA=สินค้าที่&ไม่มีในสต็อก];
                      RunObject=Page 5726 }
      { 115     ;2   ;Separator  }
      { 116     ;2   ;Action    ;
                      CaptionML=[ENU=Translations;
                                 THA=การแปล];
                      RunObject=Page 35;
                      RunFormLink=Item No.=FIELD(No.) }
      { 117     ;2   ;Action    ;
                      CaptionML=[ENU=E&xtended Texts;
                                 THA=ข้&อความที่ขยายเพิ่มเติม];
                      RunObject=Page 391;
                      RunFormView=SORTING(Table Name,No.,Language Code,All Language Codes,Starting Date,Ending Date);
                      RunFormLink=Table Name=CONST(Item),No.=FIELD(No.) }
      { 120     ;2   ;Separator  }
      { 147     ;2   ;ActionGroup;
                      CaptionML=[ENU=Kitting;
                                 THA=Kitting] }
      { 122     ;3   ;Action    ;
                      CaptionML=[ENU=Where-Used;
                                 THA=ผลิตภัณฑ์ที่ใช้วัตถุดิบและส่วนประกอบย่อย];
                      OnAction=VAR
                                 ProdBOMWhereUsed@1000000001 : Form 99000811;
                               BEGIN
                                 ProdBOMWhereUsed.SetItem(Rec,WORKDATE);
                                 ProdBOMWhereUsed.RUNMODAL;
                               END;
                                }
      { 150     ;3   ;Action    ;
                      CaptionML=;
                      OnAction=BEGIN
                                 CLEAR(CalculateStdCost);
                                 CalculateStdCost.CalcItem("No.",TRUE);
                               END;
                                }
      { 148     ;2   ;ActionGroup;
                      CaptionML=[ENU=Manufa&cturing;
                                 THA=การ&ผลิต] }
      { 149     ;3   ;Action    ;
                      CaptionML=[ENU=Where-Used;
                                 THA=ผลิตภัณฑ์ที่ใช้วัตถุดิบและส่วนประกอบย่อย];
                      OnAction=VAR
                                 ProdBOMWhereUsed@1000000001 : Form 99000811;
                               BEGIN
                                 ProdBOMWhereUsed.SetItem(Rec,WORKDATE);
                                 ProdBOMWhereUsed.RUNMODAL;
                               END;
                                }
      { 123     ;3   ;Action    ;
                      CaptionML=;
                      OnAction=BEGIN
                                 CLEAR(CalculateStdCost);
                                 CalculateStdCost.CalcItem("No.",FALSE);
                               END;
                                }
      { 182     ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 183     ;2   ;Action    ;
                      CaptionML=[ENU=Ser&vice Items;
                                 THA=สินค้า&บริการ];
                      RunObject=Page 5988;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.) }
      { 185     ;2   ;Action    ;
                      CaptionML=[ENU=Troubleshooting;
                                 THA=การแก้ไขปัญหาเบื้องต้น];
                      RunObject=Page 5993;
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.) }
      { 151     ;2   ;ActionGroup;
                      CaptionML=[ENU=R&esource;
                                 THA=ทรั&พยากร] }
      { 187     ;3   ;Action    ;
                      CaptionML=[ENU=Resource Skills;
                                 THA=ทักษะของทรัพยากร];
                      RunObject=Page 6019;
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.) }
      { 188     ;3   ;Action    ;
                      CaptionML=[ENU=Skilled Resources;
                                 THA=ทรัพยากรที่มีทักษะ];
                      OnAction=VAR
                                 ResourceSkill@1000000001 : Record 5956;
                               BEGIN
                                 CLEAR(SkilledResourceList);
                                 SkilledResourceList.Initialize(ResourceSkill.Type::Item,"No.",Description);
                                 SkilledResourceList.RUNMODAL;
                               END;
                                }
      { 217     ;2   ;Separator  }
      { 218     ;2   ;Action    ;
                      CaptionML=[ENU=Identifiers;
                                 THA=ตัวบ่งชี้];
                      RunObject=Page 7706;
                      RunFormView=SORTING(Item No.,Variant Code,Unit of Measure Code);
                      RunFormLink=Item No.=FIELD(No.) }
      { 1000000000;2 ;Separator  }
      { 1000000001;2 ;Action    ;
                      CaptionML=ENU=VAT Announce Price;
                      RunObject=Page 50090;
                      RunFormLink=No.=FIELD(No.) }
      { 79      ;1   ;ActionGroup;
                      CaptionML=[ENU=S&ales;
                                 THA=ก&ารขาย] }
      { 82      ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 THA=ราคา];
                      RunObject=Page 7002;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=ResourcePrice }
      { 80      ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 THA=ส่วนลดในบรรทัด];
                      RunObject=Page 7004;
                      RunFormView=SORTING(Type,Code);
                      RunFormLink=Type=CONST(Item),Code=FIELD(No.) }
      { 300     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 THA=เปอร์เซ็นต์&การชำระเงินล่วงหน้า];
                      RunObject=Page 664;
                      RunFormLink=Item No.=FIELD(No.) }
      { 46      ;2   ;Separator  }
      { 83      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 THA=ใบสั่ง];
                      RunObject=Page 48;
                      RunFormView=SORTING(Document Type,Type,No.);
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.);
                      Image=Document }
      { 163     ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 THA=ใบสั่งส่งคืนสินค้า];
                      RunObject=Page 6633;
                      RunFormView=SORTING(Document Type,Type,No.);
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.);
                      Image=ReturnOrder }
      { 84      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Purchases;
                                 THA=&การซื้อ] }
      { 81      ;2   ;Action    ;
                      CaptionML=[ENU=Ven&dors;
                                 THA=ผู้&ขาย];
                      RunObject=Page 114;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.) }
      { 85      ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 THA=ราคา];
                      RunObject=Page 7012;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=ResourcePrice }
      { 86      ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 THA=ส่วนลดในบรรทัด];
                      RunObject=Page 7014;
                      RunFormLink=Item No.=FIELD(No.) }
      { 240     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 THA=เปอร์เซ็นต์&การชำระเงินล่วงหน้า];
                      RunObject=Page 665;
                      RunFormLink=Item No.=FIELD(No.) }
      { 47      ;2   ;Separator  }
      { 87      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 THA=ใบสั่ง];
                      RunObject=Page 56;
                      RunFormView=SORTING(Document Type,Type,No.);
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.);
                      Image=Document }
      { 191     ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 THA=ใบสั่งส่งคืนสินค้า];
                      RunObject=Page 6643;
                      RunFormView=SORTING(Document Type,Type,No.);
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.);
                      Image=ReturnOrder }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 91      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 92      ;2   ;Action    ;
                      CaptionML=[ENU=&Create Stockkeeping Unit;
                                 THA=&สร้างหน่วยจัดเก็บสต็อก];
                      OnAction=VAR
                                 Item@1000000001 : Record 27;
                               BEGIN
                                 Item.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Create Stockkeeping Unit",TRUE,FALSE,Item);
                               END;
                                }
      { 7380    ;2   ;Action    ;
                      CaptionML=[ENU=C&alculate Counting Period;
                                 THA=คำ&นวณรอบระยะเวลาการตรวจนับ];
                      OnAction=VAR
                                 PhysInvtCountMgt@1000000001 : Codeunit 7380;
                               BEGIN
                                 PhysInvtCountMgt.UpdateItemPhysInvtCount(Rec);
                               END;
                                }
      { 241     ;2   ;Separator  }
      { 242     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Template;
                                 THA=ใช้ต้นแบบ];
                      Promoted=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TemplateMgt@1000000001 : Codeunit 8612;
                                 RecRef@1000000002 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 TemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
      { 1905370404;1 ;Action    ;
                      CaptionML=ENU=Requisition Worksheet;
                      RunObject=Page 291;
                      Promoted=Yes;
                      Image=Worksheet;
                      PromotedCategory=Process }
      { 1904344904;1 ;Action    ;
                      CaptionML=ENU=Item Journal;
                      RunObject=Page 40;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1906716204;1 ;Action    ;
                      CaptionML=ENU=Item Reclassification Journal;
                      RunObject=Page 393;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1902532604;1 ;Action    ;
                      CaptionML=ENU=Item Tracing;
                      RunObject=Page 6520;
                      Promoted=Yes;
                      Image=ItemTracing;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 6   ;2   ;Field     ;
                SourceExpr="Base Unit of Measure";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                SourceExpr="Shelf No." }

    { 97  ;2   ;Field     ;
                SourceExpr="Automatic Ext. Texts" }

    { 164 ;2   ;Field     ;
                SourceExpr="Created From Nonstock Item" }

    { 170 ;2   ;Field     ;
                SourceExpr="Item Category Code";
                OnValidate=BEGIN
                             EnableCostingControls;
                           END;
                            }

    { 168 ;2   ;Field     ;
                SourceExpr="Product Group Code" }

    { 1000000016;2;Field  ;
                SourceExpr="Item Type";
                Editable="Item TypeEditable" }

    { 1000000002;2;Field  ;
                SourceExpr="Magazine Code" }

    { 1000000004;2;Field  ;
                SourceExpr="Volume No." }

    { 1000000006;2;Field  ;
                SourceExpr="Issue No." }

    { 1000000008;2;Field  ;
                SourceExpr="Issue Date" }

    { 1000000012;2;Field  ;
                SourceExpr="Last Pick-up Date" }

    { 12  ;2   ;Field     ;
                SourceExpr="Search Description" }

    { 14  ;2   ;Field     ;
                SourceExpr=Inventory;
                Importance=Promoted }

    { 16  ;2   ;Field     ;
                SourceExpr="Qty. on Purch. Order" }

    { 172 ;2   ;Field     ;
                SourceExpr="Qty. on Prod. Order" }

    { 174 ;2   ;Field     ;
                SourceExpr="Qty. on Component Lines" }

    { 18  ;2   ;Field     ;
                SourceExpr="Qty. on Sales Order" }

    { 1462000;2;Field     ;
                SourceExpr="Qty. on Kit Sales Lines" }

    { 189 ;2   ;Field     ;
                SourceExpr="Qty. on Service Order" }

    { 180 ;2   ;Field     ;
                SourceExpr="Service Item Group" }

    { 20  ;2   ;Field     ;
                SourceExpr=Blocked }

    { 22  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 1000000010;2;Field  ;
                SourceExpr=Closed }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 24  ;2   ;Field     ;
                SourceExpr="Costing Method";
                Importance=Promoted;
                OnValidate=BEGIN
                             EnableCostingControls;
                           END;
                            }

    { 238 ;2   ;Field     ;
                SourceExpr="Cost is Adjusted" }

    { 26  ;2   ;Field     ;
                SourceExpr="Cost is Posted to G/L" }

    { 28  ;2   ;Field     ;
                SourceExpr="Standard Cost";
                Enabled="Standard CostEnable";
                OnDrillDown=VAR
                              ShowAvgCalcItem@1000000001 : Codeunit 5803;
                            BEGIN
                              ShowAvgCalcItem.DrillDownAvgCostAdjmtPoint(Rec)
                            END;
                             }

    { 30  ;2   ;Field     ;
                SourceExpr="Unit Cost";
                Enabled="Unit CostEnable";
                OnDrillDown=VAR
                              ShowAvgCalcItem@1000000001 : Codeunit 5803;
                            BEGIN
                              ShowAvgCalcItem.DrillDownAvgCostAdjmtPoint(Rec)
                            END;
                             }

    { 153 ;2   ;Field     ;
                SourceExpr="Overhead Rate" }

    { 155 ;2   ;Field     ;
                SourceExpr="Indirect Cost %" }

    { 32  ;2   ;Field     ;
                SourceExpr="Last Direct Cost" }

    { 34  ;2   ;Field     ;
                SourceExpr="Price/Profit Calculation" }

    { 36  ;2   ;Field     ;
                SourceExpr="Profit %" }

    { 38  ;2   ;Field     ;
                SourceExpr="Unit Price";
                Importance=Promoted }

    { 95  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group";
                Importance=Promoted }

    { 66  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group" }

    { 1500001;2;Field     ;
                SourceExpr="WHT Product Posting Group" }

    { 40  ;2   ;Field     ;
                SourceExpr="Inventory Posting Group";
                Importance=Promoted }

    { 42  ;2   ;Field     ;
                SourceExpr="Net Invoiced Qty." }

    { 44  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc." }

    { 48  ;2   ;Field     ;
                SourceExpr="Item Disc. Group" }

    { 73  ;2   ;Field     ;
                SourceExpr="Sales Unit of Measure" }

    { 1904731401;1;Group  ;
                CaptionML=[ENU=Replenishment;
                           THA=การเพิ่มเติมสินค้า] }

    { 133 ;2   ;Field     ;
                OptionCaptionML=[ENU=Purchase,Prod. Order;
                                 THA=การซื้อ,ใบสั่งผลิต];
                SourceExpr="Replenishment System";
                Importance=Promoted }

    { 229 ;2   ;Group     ;
                CaptionML=[ENU=Purchase;
                           THA=การซื้อ] }

    { 50  ;3   ;Field     ;
                SourceExpr="Vendor No." }

    { 52  ;3   ;Field     ;
                SourceExpr="Vendor Item No." }

    { 99  ;3   ;Field     ;
                SourceExpr="Purch. Unit of Measure" }

    { 54  ;3   ;Field     ;
                SourceExpr="Lead Time Calculation" }

    { 230 ;2   ;Group     ;
                CaptionML=[ENU=Production;
                           THA=การผลิต] }

    { 227 ;3   ;Field     ;
                SourceExpr="Manufacturing Policy" }

    { 137 ;3   ;Field     ;
                SourceExpr="Routing No." }

    { 139 ;3   ;Field     ;
                SourceExpr="Production BOM No.";
                Enabled="Production BOM No.Enable" }

    { 141 ;3   ;Field     ;
                SourceExpr="Rounding Precision" }

    { 143 ;3   ;Field     ;
                SourceExpr="Flushing Method" }

    { 118 ;3   ;Field     ;
                SourceExpr="Scrap %" }

    { 145 ;3   ;Field     ;
                SourceExpr="Lot Size" }

    { 1901343701;1;Group  ;
                CaptionML=[ENU=Planning;
                           THA=การวางแผน] }

    { 125 ;2   ;Field     ;
                SourceExpr="Reordering Policy";
                Importance=Promoted;
                OnValidate=BEGIN
                             EnablePlanningControls
                           END;
                            }

    { 166 ;2   ;Field     ;
                SourceExpr="Include Inventory";
                Enabled="Include InventoryEnable";
                OnValidate=BEGIN
                             EnablePlanningControls
                           END;
                            }

    { 214 ;2   ;Field     ;
                SourceExpr=Reserve;
                Importance=Promoted }

    { 176 ;2   ;Field     ;
                SourceExpr="Order Tracking Policy" }

    { 159 ;2   ;Field     ;
                SourceExpr="Stockkeeping Unit Exists" }

    { 64  ;2   ;Field     ;
                SourceExpr=Critical }

    { 135 ;2   ;Field     ;
                SourceExpr="Reorder Cycle";
                Enabled="Reorder CycleEnable" }

    { 78  ;2   ;Field     ;
                SourceExpr="Safety Lead Time";
                Enabled="Safety Lead TimeEnable" }

    { 178 ;2   ;Field     ;
                SourceExpr="Safety Stock Quantity";
                Enabled="Safety Stock QuantityEnable" }

    { 58  ;2   ;Field     ;
                SourceExpr="Reorder Point";
                Enabled="Reorder PointEnable" }

    { 60  ;2   ;Field     ;
                SourceExpr="Reorder Quantity";
                Enabled="Reorder QuantityEnable" }

    { 56  ;2   ;Field     ;
                SourceExpr="Maximum Inventory";
                Enabled="Maximum InventoryEnable" }

    { 127 ;2   ;Field     ;
                SourceExpr="Minimum Order Quantity";
                Enabled="Minimum Order QuantityEnable" }

    { 129 ;2   ;Field     ;
                SourceExpr="Maximum Order Quantity";
                Enabled="Maximum Order QuantityEnable" }

    { 131 ;2   ;Field     ;
                SourceExpr="Order Multiple";
                Enabled="Order MultipleEnable" }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 62  ;2   ;Field     ;
                SourceExpr="Tariff No." }

    { 93  ;2   ;Field     ;
                SourceExpr="Country/Region of Origin Code" }

    { 196 ;2   ;Field     ;
                SourceExpr="Net Weight" }

    { 235 ;2   ;Field     ;
                SourceExpr="Gross Weight" }

    { 1904830201;1;Group  ;
                CaptionML=[ENU=Item Tracking;
                           THA=การติดตามสินค้า] }

    { 225 ;2   ;Field     ;
                SourceExpr="Item Tracking Code";
                Importance=Promoted }

    { 210 ;2   ;Field     ;
                SourceExpr="Serial Nos." }

    { 72  ;2   ;Field     ;
                SourceExpr="Lot Nos." }

    { 71  ;2   ;Field     ;
                SourceExpr="Expiration Calculation" }

    { 1904111701;1;Group  ;
                CaptionML=[ENU=E-Commerce;
                           THA=อีคอมเมิร์ซ] }

    { 234 ;2   ;Group     ;
                CaptionML=[ENU=BizTalk;
                           THA=BizTalk] }

    { 232 ;3   ;Field     ;
                SourceExpr="Common Item No." }

    { 1907509201;1;Group  ;
                CaptionML=[ENU=Warehouse;
                           THA=คลังสินค้า] }

    { 213 ;2   ;Field     ;
                SourceExpr="Special Equipment Code" }

    { 206 ;2   ;Field     ;
                SourceExpr="Put-away Template Code" }

    { 204 ;2   ;Field     ;
                SourceExpr="Put-away Unit of Measure Code";
                Importance=Promoted }

    { 202 ;2   ;Field     ;
                SourceExpr="Phys Invt Counting Period Code";
                Importance=Promoted }

    { 200 ;2   ;Field     ;
                SourceExpr="Last Phys. Invt. Date" }

    { 198 ;2   ;Field     ;
                SourceExpr="Last Counting Period Update" }

    { 194 ;2   ;Field     ;
                SourceExpr="Next Counting Period" }

    { 192 ;2   ;Field     ;
                SourceExpr="Identifier Code" }

    { 208 ;2   ;Field     ;
                SourceExpr="Use Cross-Docking" }

    { 1905108901;1;Group  ;
                CaptionML=[ENU=Kitting;
                           THA=Kitting] }

    { 1462002;2;Field     ;
                SourceExpr="Kit BOM No.";
                OnValidate=BEGIN
                             "Production BOM No.Enable" := ("Kit BOM No." = '');
                           END;
                            }

    { 1462004;2;Field     ;
                SourceExpr="Kit Disassembly BOM No." }

    { 1462006;2;Field     ;
                SourceExpr="Components on Sales Orders" }

    { 1462008;2;Field     ;
                SourceExpr="Components on Shipments" }

    { 1462010;2;Field     ;
                SourceExpr="Components on Invoices" }

    { 1462012;2;Field     ;
                SourceExpr="Components on Pick Tickets" }

    { 1462016;2;Field     ;
                SourceExpr="Automatic Build Kit BOM" }

    { 1462014;2;Field     ;
                SourceExpr="Roll-up Kit Pricing" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      TroubleshHeader@1000000000 : Record 5943;
      SkilledResourceList@1000000001 : Form 6023;
      CalculateStdCost@1000000002 : Codeunit 5812;
      UserMgt@1000000003 : Codeunit 5700;
      "Production BOM No.Enable"@19047033 : Boolean INDATASET;
      "Item TypeEditable"@19041764 : Boolean INDATASET;
      "Reorder CycleEnable"@19029774 : Boolean INDATASET;
      "Safety Lead TimeEnable"@19079647 : Boolean INDATASET;
      "Safety Stock QuantityEnable"@19036196 : Boolean INDATASET;
      "Reorder PointEnable"@19067744 : Boolean INDATASET;
      "Reorder QuantityEnable"@19013534 : Boolean INDATASET;
      "Maximum InventoryEnable"@19059424 : Boolean INDATASET;
      "Minimum Order QuantityEnable"@19021857 : Boolean INDATASET;
      "Maximum Order QuantityEnable"@19007977 : Boolean INDATASET;
      "Order MultipleEnable"@19004365 : Boolean INDATASET;
      "Include InventoryEnable"@19061544 : Boolean INDATASET;
      "Standard CostEnable"@19016419 : Boolean INDATASET;
      "Unit CostEnable"@19054429 : Boolean INDATASET;

    PROCEDURE EnablePlanningControls@1();
    VAR
      PlanningGetParam@1000000000 : Codeunit 99000855;
      ReorderCycleEnabled@1000000001 : Boolean;
      SafetyLeadTimeEnabled@1000000002 : Boolean;
      SafetyStockQtyEnabled@1000000003 : Boolean;
      ReorderPointEnabled@1000000004 : Boolean;
      ReorderQuantityEnabled@1000000005 : Boolean;
      MaximumInventoryEnabled@1000000006 : Boolean;
      MinimumOrderQtyEnabled@1000000007 : Boolean;
      MaximumOrderQtyEnabled@1000000008 : Boolean;
      OrderMultipleEnabled@1000000009 : Boolean;
      IncludeInventoryEnabled@1000000010 : Boolean;
    BEGIN
      PlanningGetParam.SetUpPlanningControls("Reordering Policy","Include Inventory",
        ReorderCycleEnabled,SafetyLeadTimeEnabled,SafetyStockQtyEnabled,
        ReorderPointEnabled,ReorderQuantityEnabled,MaximumInventoryEnabled,
        MinimumOrderQtyEnabled,MaximumOrderQtyEnabled,OrderMultipleEnabled,IncludeInventoryEnabled);
      "Reorder CycleEnable" := ReorderCycleEnabled;
      "Safety Lead TimeEnable" := SafetyLeadTimeEnabled;
      "Safety Stock QuantityEnable" := SafetyStockQtyEnabled;
      "Reorder PointEnable" := ReorderPointEnabled;
      "Reorder QuantityEnable" := ReorderQuantityEnabled;
      "Maximum InventoryEnable" := MaximumInventoryEnabled;
      "Minimum Order QuantityEnable" := MinimumOrderQtyEnabled;
      "Maximum Order QuantityEnable" := MaximumOrderQtyEnabled;
      "Order MultipleEnable" := OrderMultipleEnabled;
      "Include InventoryEnable" := IncludeInventoryEnabled;
    END;

    PROCEDURE EnableCostingControls@3();
    BEGIN
      "Standard CostEnable" := "Costing Method" = "Costing Method"::Standard;
      "Unit CostEnable" := "Costing Method" <> "Costing Method"::Standard;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      "Item TypeEditable" := "Magazine Code" = '';  //KKE : #002
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new menu button VAT Announce Price.
      Burda
      002   27.03.2007   KKE   Add new fields for Subscription Module.
      003   07.08.2007   KKE   Permission Filter by Magazine Code.
    }
    END.
  }
}

OBJECT Page 31 Item List
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=10:52:02 AM;
    Version List=NAVW16.00.01,KITNA6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Item List;
               THA=รายการสินค้า];
    SourceTable=Table27;
    SourceTableView=SORTING(No.);
    PageType=List;
    CardFormID=Page30;
    OnOpenPage=BEGIN
                 //KKE : #002 +
                 IF UserMgt.GetMagazineItemFilter() <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETFILTER("Magazine Code",UserMgt.GetMagazineItemFilter());
                   FILTERGROUP(0);
                 END;
                 //KKE : #002 -
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 10      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Item;
                                 THA=&สินค้า] }
      { 81      ;2   ;Action    ;
                      CaptionML=[ENU=Stockkeepin&g Units;
                                 THA=หน่วยจัดเก็บ&สต็อก];
                      RunObject=Page 5701;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.) }
      { 84      ;2   ;ActionGroup;
                      CaptionML=[ENU=E&ntries;
                                 THA=ร&ายการ] }
      { 14      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 38;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Promoted=No;
                      Image=ItemLedger;
                      PromotedCategory=Process }
      { 77      ;3   ;Action    ;
                      CaptionML=[ENU=&Reservation Entries;
                                 THA=&รายการจอง];
                      RunObject=Page 497;
                      RunFormView=SORTING(Item No.,Variant Code,Location Code,Reservation Status);
                      RunFormLink=Reservation Status=CONST(Reservation),Item No.=FIELD(No.);
                      Image=ReservationLedger }
      { 23      ;3   ;Action    ;
                      CaptionML=[ENU=&Phys. Inventory Ledger Entries;
                                 THA=&รายการในสมุดบัญชีแยกประเภทของสินค้าคงคลังที่มีอยู่จริง];
                      RunObject=Page 390;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=PhysicalInventoryLedger }
      { 5800    ;3   ;Action    ;
                      CaptionML=[ENU=&Value Entries;
                                 THA=&รายการบัญชีแสดงมูลค่า];
                      RunObject=Page 5802;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=ValueLedger }
      { 6500    ;3   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingMgt@1000000001 : Codeunit 6500;
                               BEGIN
                                 ItemTrackingMgt.CallItemTrackingEntryForm(3,'',"No.",'','','','');
                               END;
                                }
      { 85      ;2   ;ActionGroup;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ] }
      { 16      ;3   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ItemStatistics@1000000001 : Form 5827;
                               BEGIN
                                 ItemStatistics.SetItem(Rec);
                                 ItemStatistics.RUNMODAL;
                               END;
                                }
      { 17      ;3   ;Action    ;
                      CaptionML=[ENU=Entry Statistics;
                                 THA=สถิติเกี่ยวกับรายการ];
                      RunObject=Page 304;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 22      ;3   ;Action    ;
                      CaptionML=[ENU=T&urnover;
                                 THA=อั&ตราหมุนเวียน];
                      RunObject=Page 158;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 73      ;2   ;Action    ;
                      CaptionML=[ENU=Items b&y Location;
                                 THA=สินค้าต&ามที่ตั้ง];
                      Image=ItemAvailbyLoc;
                      OnAction=VAR
                                 ItemsByLocation@1000000001 : Form 491;
                               BEGIN
                                 ItemsByLocation.SETRECORD(Rec);
                                 ItemsByLocation.RUN;
                               END;
                                }
      { 79      ;2   ;ActionGroup;
                      CaptionML=[ENU=&Item Availability by;
                                 THA=&การมีอยู่ของสินค้าตาม] }
      { 21      ;3   ;Action    ;
                      CaptionML=[ENU=Period;
                                 THA=รอบระยะเวลา];
                      RunObject=Page 157;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 80      ;3   ;Action    ;
                      CaptionML=[ENU=Variant;
                                 THA=ตัวแปร];
                      RunObject=Page 5414;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 78      ;3   ;Action    ;
                      CaptionML=[ENU=Location;
                                 THA=ที่ตั้ง];
                      RunObject=Page 492;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 116     ;2   ;Action    ;
                      CaptionML=[ENU=&Bin Contents;
                                 THA=&กำหนดช่องเก็บ];
                      RunObject=Page 7379;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=BinContent }
      { 15      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Item),No.=FIELD(No.);
                      Image=ViewComments }
      { 94      ;2   ;ActionGroup;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ] }
      { 184     ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions-Single;
                                 THA=มิติ-เดียว];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(27),No.=FIELD(No.) }
      { 93      ;3   ;Action    ;
                      CaptionML=[ENU=Dimensions-&Multiple;
                                 THA=มิติ-&หลายมิติ];
                      OnAction=VAR
                                 Item@1000000001 : Record 27;
                                 DefaultDimMultiple@1000000002 : Form 542;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Item);
                                 DefaultDimMultiple.SetMultiItem(Item);
                                 DefaultDimMultiple.RUNMODAL;
                               END;
                                }
      { 20      ;2   ;Action    ;
                      CaptionML=[ENU=&Picture;
                                 THA=&รูปภาพ];
                      RunObject=Page 346;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),Location Filter=FIELD(Location Filter),Drop Shipment Filter=FIELD(Drop Shipment Filter),Variant Filter=FIELD(Variant Filter) }
      { 24      ;2   ;Separator  }
      { 25      ;2   ;Action    ;
                      CaptionML=[ENU=&Units of Measure;
                                 THA=&หน่วยวัด];
                      RunObject=Page 5404;
                      RunFormLink=Item No.=FIELD(No.) }
      { 30      ;2   ;Action    ;
                      CaptionML=[ENU=Va&riants;
                                 THA=ตั&วแปร];
                      RunObject=Page 5401;
                      RunFormLink=Item No.=FIELD(No.) }
      { 82      ;2   ;Action    ;
                      CaptionML=[ENU=Cross Re&ferences;
                                 THA=การ&อ้างอิงไขว้];
                      RunObject=Page 5721;
                      RunFormLink=Item No.=FIELD(No.) }
      { 500     ;2   ;Action    ;
                      CaptionML=[ENU=Substituti&ons;
                                 THA=สิ่ง&ทดแทน];
                      RunObject=Page 5716;
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.) }
      { 76      ;2   ;Action    ;
                      CaptionML=[ENU=Nonstoc&k Items;
                                 THA=สินค้าที่&ไม่มีในสต็อก];
                      RunObject=Page 5726 }
      { 26      ;2   ;Separator  }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=Translations;
                                 THA=การแปล];
                      RunObject=Page 35;
                      RunFormLink=Item No.=FIELD(No.),Variant Code=CONST() }
      { 28      ;2   ;Action    ;
                      CaptionML=[ENU=E&xtended Texts;
                                 THA=ข้&อความที่ขยายเพิ่มเติม];
                      RunObject=Page 391;
                      RunFormView=SORTING(Table Name,No.,Language Code,All Language Codes,Starting Date,Ending Date);
                      RunFormLink=Table Name=CONST(Item),No.=FIELD(No.) }
      { 31      ;2   ;Separator  }
      { 29      ;2   ;ActionGroup;
                      CaptionML=[ENU=Kitting;
                                 THA=Kitting] }
      { 49      ;3   ;Action    ;
                      CaptionML=[ENU=Where-Used;
                                 THA=ผลิตภัณฑ์ที่ใช้วัตถุดิบและส่วนประกอบย่อย];
                      OnAction=VAR
                                 ProdBOMWhereUsed@1000000001 : Form 99000811;
                               BEGIN
                                 ProdBOMWhereUsed.SetItem(Rec,WORKDATE);
                                 ProdBOMWhereUsed.RUNMODAL;
                               END;
                                }
      { 50      ;3   ;Action    ;
                      CaptionML=;
                      OnAction=BEGIN
                                 CalculateStdCost.CalcItem("No.",TRUE);
                               END;
                                }
      { 86      ;2   ;ActionGroup;
                      CaptionML=[ENU=Manuf&acturing;
                                 THA=การ&ผลิต] }
      { 87      ;3   ;Action    ;
                      CaptionML=[ENU=Where-Used;
                                 THA=ผลิตภัณฑ์ที่ใช้วัตถุดิบและส่วนประกอบย่อย];
                      OnAction=VAR
                                 ProdBOMWhereUsed@1000000001 : Form 99000811;
                               BEGIN
                                 ProdBOMWhereUsed.SetItem(Rec,WORKDATE);
                                 ProdBOMWhereUsed.RUNMODAL;
                               END;
                                }
      { 88      ;3   ;Action    ;
                      CaptionML=;
                      OnAction=BEGIN
                                 CalculateStdCost.CalcItem("No.",FALSE);
                               END;
                                }
      { 83      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 103     ;2   ;Action    ;
                      CaptionML=[ENU=Ser&vice Items;
                                 THA=สินค้า&บริการ];
                      RunObject=Page 5988;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.) }
      { 105     ;2   ;Action    ;
                      CaptionML=[ENU=Troubleshooting;
                                 THA=การแก้ไขปัญหาเบื้องต้น];
                      RunObject=Page 5993;
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.) }
      { 107     ;2   ;ActionGroup;
                      CaptionML=[ENU=R&esource;
                                 THA=ทรั&พยากร] }
      { 108     ;3   ;Action    ;
                      CaptionML=[ENU=Resource &Skills;
                                 THA=ทั&กษะของทรัพยากร];
                      RunObject=Page 6019;
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.) }
      { 109     ;3   ;Action    ;
                      CaptionML=[ENU=Skilled R&esources;
                                 THA=ทรั&พยากรที่มีทักษะ];
                      OnAction=VAR
                                 ResourceSkill@1000000001 : Record 5956;
                               BEGIN
                                 CLEAR(SkilledResourceList);
                                 SkilledResourceList.Initialize(ResourceSkill.Type::Item,"No.",Description);
                                 SkilledResourceList.RUNMODAL;
                               END;
                                }
      { 120     ;2   ;Separator  }
      { 121     ;2   ;Action    ;
                      CaptionML=[ENU=Identifiers;
                                 THA=ตัวบ่งชี้];
                      RunObject=Page 7706;
                      RunFormView=SORTING(Item No.,Variant Code,Unit of Measure Code);
                      RunFormLink=Item No.=FIELD(No.) }
      { 1000000000;2 ;Separator  }
      { 1000000001;2 ;Action    ;
                      CaptionML=ENU=VAT Announce Price;
                      RunObject=Page 50090;
                      RunFormLink=No.=FIELD(No.) }
      { 33      ;1   ;ActionGroup;
                      CaptionML=[ENU=S&ales;
                                 THA=ก&ารขาย] }
      { 36      ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 THA=ราคา];
                      RunObject=Page 7002;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=ResourcePrice }
      { 34      ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 THA=ส่วนลดในบรรทัด];
                      RunObject=Page 7004;
                      RunFormView=SORTING(Type,Code);
                      RunFormLink=Type=CONST(Item),Code=FIELD(No.) }
      { 124     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 THA=เปอร์เซ็นต์&การชำระเงินล่วงหน้า];
                      RunObject=Page 664;
                      RunFormLink=Item No.=FIELD(No.) }
      { 37      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 THA=ใบสั่ง];
                      RunObject=Page 48;
                      RunFormView=SORTING(Document Type,Type,No.);
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.);
                      Image=Document }
      { 114     ;2   ;Action    ;
                      CaptionML=[ENU=Returns Orders;
                                 THA=ใบสั่งส่งคืนสินค้า];
                      RunObject=Page 6633;
                      RunFormView=SORTING(Document Type,Type,No.);
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.) }
      { 38      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Purchases;
                                 THA=&การซื้อ] }
      { 118     ;2   ;Action    ;
                      CaptionML=[ENU=Ven&dors;
                                 THA=ผู้&ขาย];
                      RunObject=Page 114;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.) }
      { 39      ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 THA=ราคา];
                      RunObject=Page 7012;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Image=ResourcePrice }
      { 42      ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 THA=ส่วนลดในบรรทัด];
                      RunObject=Page 7014;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.) }
      { 125     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 THA=เปอร์เซ็นต์&การชำระเงินล่วงหน้า];
                      RunObject=Page 665;
                      RunFormLink=Item No.=FIELD(No.) }
      { 117     ;2   ;Separator  }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 THA=ใบสั่ง];
                      RunObject=Page 56;
                      RunFormView=SORTING(Document Type,Type,No.);
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.);
                      Image=Document }
      { 115     ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 THA=ใบสั่งส่งคืนสินค้า];
                      RunObject=Page 6643;
                      RunFormView=SORTING(Document Type,Type,No.);
                      RunFormLink=Type=CONST(Item),No.=FIELD(No.);
                      Image=ReturnOrder }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 110     ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 111     ;2   ;Action    ;
                      CaptionML=[ENU=&Create Stockkeeping Unit;
                                 THA=&สร้างหน่วยจัดเก็บสต็อก];
                      OnAction=VAR
                                 Item@1000000001 : Record 27;
                               BEGIN
                                 Item.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Create Stockkeeping Unit",TRUE,FALSE,Item);
                               END;
                                }
      { 7380    ;2   ;Action    ;
                      CaptionML=[ENU=C&alculate Counting Period;
                                 THA=คำ&นวณรอบระยะเวลาการตรวจนับ];
                      OnAction=VAR
                                 PhysInvtCountMgt@1000000001 : Codeunit 7380;
                               BEGIN
                                 PhysInvtCountMgt.UpdateItemPhysInvtCount(Rec);
                               END;
                                }
      { 1901240604;1 ;Action    ;
                      CaptionML=ENU=Sales Prices;
                      RunObject=Page 7002;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Promoted=Yes;
                      Image=SalesPrices;
                      PromotedCategory=Process }
      { 1905178304;1 ;Action    ;
                      CaptionML=ENU=Purchase Prices;
                      RunObject=Page 7012;
                      RunFormView=SORTING(Item No.);
                      RunFormLink=Item No.=FIELD(No.);
                      Promoted=Yes;
                      Image=SalesPrices;
                      PromotedCategory=Process }
      { 1900869004;1 ;Action    ;
                      CaptionML=ENU=Sales Line Discounts;
                      RunObject=Page 7004;
                      RunFormView=SORTING(Type,Code);
                      RunFormLink=Type=CONST(Item),Code=FIELD(No.);
                      Promoted=No;
                      Image=SalesLineDisc;
                      PromotedCategory=Process }
      { 1905370404;1 ;Action    ;
                      CaptionML=ENU=Requisition Worksheet;
                      RunObject=Page 291;
                      Promoted=Yes;
                      Image=Worksheet;
                      PromotedCategory=Process }
      { 1904922604;1 ;Action    ;
                      CaptionML=ENU=Planning Worksheet;
                      RunObject=Page 99000852;
                      Promoted=Yes;
                      PromotedCategory=Process }
      { 1904344904;1 ;Action    ;
                      CaptionML=ENU=Item Journal;
                      RunObject=Page 40;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1906716204;1 ;Action    ;
                      CaptionML=ENU=Item Reclassification Journal;
                      RunObject=Page 393;
                      Promoted=No;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1902532604;1 ;Action    ;
                      CaptionML=ENU=Item Tracing;
                      RunObject=Page 6520;
                      Promoted=No;
                      Image=ItemTracing;
                      PromotedCategory=Process }
      { 1900805004;1 ;Action    ;
                      CaptionML=ENU=Adjust Item Cost/Price;
                      RunObject=Report 794;
                      Promoted=No;
                      Image=AdjustItemCost;
                      PromotedCategory=Process }
      { 1907108104;1 ;Action    ;
                      CaptionML=ENU=Adjust Cost - Item Entries;
                      RunObject=Report 795;
                      Promoted=Yes;
                      Image=AdjustEntries;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1900907306;1 ;Action    ;
                      CaptionML=ENU=Inventory - List;
                      RunObject=Report 701;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907629906;1 ;Action    ;
                      CaptionML=ENU=Item Register - Quantity;
                      RunObject=Report 703;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904068306;1 ;Action    ;
                      CaptionML=ENU=Inventory - Transaction Detail;
                      RunObject=Report 704;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1901091106;1 ;Action    ;
                      CaptionML=ENU=Inventory Availability;
                      RunObject=Report 705;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1901254106;1 ;Action    ;
                      CaptionML=ENU=Status;
                      RunObject=Report 706;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906212206;1 ;Action    ;
                      CaptionML=ENU=Inventory - Availability Plan;
                      RunObject=Report 707;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1903262806;1 ;Action    ;
                      CaptionML=ENU=Inventory Order Details;
                      RunObject=Report 708;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904739806;1 ;Action    ;
                      CaptionML=ENU=Inventory Purchase Orders;
                      RunObject=Report 709;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907930606;1 ;Action    ;
                      CaptionML=ENU=Inventory - Top 10 List;
                      RunObject=Report 711;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900762706;1 ;Action    ;
                      CaptionML=ENU=Inventory - Sales Statistics;
                      RunObject=Report 712;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904034006;1 ;Action    ;
                      CaptionML=ENU=Inventory - Customer Sales;
                      RunObject=Report 713;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906231806;1 ;Action    ;
                      CaptionML=ENU=Inventory - Vendor Purchases;
                      RunObject=Report 714;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905572506;1 ;Action    ;
                      CaptionML=ENU=Price List;
                      RunObject=Report 715;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900128906;1 ;Action    ;
                      CaptionML=ENU=Inventory Cost and Price List;
                      RunObject=Report 716;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1906101206;1 ;Action    ;
                      CaptionML=ENU=Inventory - Reorders;
                      RunObject=Report 717;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900210306;1 ;Action    ;
                      CaptionML=ENU=Inventory - Sales Back Orders;
                      RunObject=Report 718;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900430206;1 ;Action    ;
                      CaptionML=ENU=Item/Vendor Catalog;
                      RunObject=Report 720;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900730006;1 ;Action    ;
                      CaptionML=ENU=Inventory - Cost Variance;
                      RunObject=Report 721;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907644006;1 ;Action    ;
                      CaptionML=ENU=Phys. Inventory List;
                      RunObject=Report 722;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906316306;1 ;Action    ;
                      CaptionML=ENU=Inventory Valuation;
                      RunObject=Report 1001;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1907253406;1 ;Action    ;
                      CaptionML=ENU=Nonstock Item Sales;
                      RunObject=Report 5700;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905753506;1 ;Action    ;
                      CaptionML=ENU=Item Substitutions;
                      RunObject=Report 5701;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1904299906;1 ;Action    ;
                      CaptionML=ENU=Invt. Valuation - Cost Spec.;
                      RunObject=Report 5801;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907928706;1 ;Action    ;
                      CaptionML=ENU=Inventory Valuation - WIP;
                      RunObject=Report 5802;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1902962906;1 ;Action    ;
                      CaptionML=ENU=Item Register - Value;
                      RunObject=Report 5805;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900461506;1 ;Action    ;
                      CaptionML=ENU=Item Charges - Specification;
                      RunObject=Report 5806;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900111206;1 ;Action    ;
                      CaptionML=ENU=Item Age Composition - Qty.;
                      RunObject=Report 5807;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1903496006;1 ;Action    ;
                      CaptionML=ENU=Item Age Composition - Value;
                      RunObject=Report 5808;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1906747006;1 ;Action    ;
                      CaptionML=ENU=Item Expiration - Quantity;
                      RunObject=Report 5809;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905889606;1 ;Action    ;
                      CaptionML=ENU=Cost Shares Breakdown;
                      RunObject=Report 5848;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1901374406;1 ;Action    ;
                      CaptionML=ENU=Detailed Calculation;
                      RunObject=Report 99000756;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900812706;1 ;Action    ;
                      CaptionML=ENU=Rolled-up Cost Shares;
                      RunObject=Report 99000754;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1901316306;1 ;Action    ;
                      CaptionML=ENU=Single-Level Cost Shares;
                      RunObject=Report 99000755;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1902353206;1 ;Action    ;
                      CaptionML=ENU=Where Used (Top Level);
                      RunObject=Report 99000757;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907778006;1 ;Action    ;
                      CaptionML=ENU=Quantity Explosion of BOM;
                      RunObject=Report 99000753;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907846806;1 ;Action    ;
                      CaptionML=ENU=Compare List;
                      RunObject=Report 99000758;
                      Promoted=No;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000012;2;Field  ;
                SourceExpr=Inventory }

    { 1000000010;2;Field  ;
                SourceExpr="Item Type" }

    { 95  ;2   ;Field     ;
                SourceExpr="Created From Nonstock Item";
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                SourceExpr="Substitutes Exist" }

    { 99  ;2   ;Field     ;
                SourceExpr="Production BOM No." }

    { 101 ;2   ;Field     ;
                SourceExpr="Routing No." }

    { 1000000002;2;Field  ;
                SourceExpr="Magazine Code" }

    { 6   ;2   ;Field     ;
                SourceExpr="Base Unit of Measure" }

    { 1000000004;2;Field  ;
                SourceExpr="Volume No." }

    { 43  ;2   ;Field     ;
                SourceExpr="Shelf No.";
                Visible=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Issue No." }

    { 45  ;2   ;Field     ;
                SourceExpr="Costing Method";
                Visible=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Issue Date" }

    { 112 ;2   ;Field     ;
                SourceExpr="Stockkeeping Unit Exists";
                Visible=FALSE }

    { 122 ;2   ;Field     ;
                SourceExpr="Cost is Adjusted" }

    { 51  ;2   ;Field     ;
                SourceExpr="Standard Cost";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Unit Cost" }

    { 55  ;2   ;Field     ;
                SourceExpr="Last Direct Cost";
                Visible=FALSE }

    { 57  ;2   ;Field     ;
                SourceExpr="Price/Profit Calculation";
                Visible=FALSE }

    { 59  ;2   ;Field     ;
                SourceExpr="Profit %";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Unit Price" }

    { 63  ;2   ;Field     ;
                SourceExpr="Inventory Posting Group";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr="Item Disc. Group";
                Visible=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Vendor No." }

    { 67  ;2   ;Field     ;
                SourceExpr="Vendor Item No.";
                Visible=FALSE }

    { 69  ;2   ;Field     ;
                SourceExpr="Tariff No.";
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                SourceExpr="Search Description" }

    { 91  ;2   ;Field     ;
                SourceExpr="Overhead Rate";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Indirect Cost %";
                Visible=FALSE }

    { 1102601000;2;Field  ;
                SourceExpr="Item Category Code";
                Visible=FALSE }

    { 1102601002;2;Field  ;
                SourceExpr="Product Group Code";
                Visible=FALSE }

    { 1102601004;2;Field  ;
                SourceExpr=Blocked;
                Visible=FALSE }

    { 1102601006;2;Field  ;
                SourceExpr="Last Date Modified";
                Visible=FALSE }

    { 1102601010;2;Field  ;
                SourceExpr="Sales Unit of Measure";
                Visible=FALSE }

    { 1102601012;2;Field  ;
                SourceExpr="Replenishment System";
                Visible=FALSE }

    { 1102601016;2;Field  ;
                SourceExpr="Purch. Unit of Measure";
                Visible=FALSE }

    { 1102601018;2;Field  ;
                SourceExpr="Lead Time Calculation";
                Visible=FALSE }

    { 1102601020;2;Field  ;
                SourceExpr="Manufacturing Policy";
                Visible=FALSE }

    { 1102601024;2;Field  ;
                SourceExpr="Flushing Method";
                Visible=FALSE }

    { 1102601026;2;Field  ;
                SourceExpr="Item Tracking Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1901314507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9089;
                Visible=TRUE;
                PartType=Page }

    { 1903326807;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9090;
                Visible=FALSE;
                PartType=Page }

    { 1906840407;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9091;
                Visible=TRUE;
                PartType=Page }

    { 1901796907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9109;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      TblshtgHeader@1000000000 : Record 5943;
      SkilledResourceList@1000000001 : Form 6023;
      CalculateStdCost@1000000002 : Codeunit 5812;
      UserMgt@1000000003 : Codeunit 5700;

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      Item@1000000000 : Record 27;
      FirstItem@1000000001 : Code[30];
      LastItem@1000000002 : Code[30];
      SelectionFilter@1000000003 : Code[250];
      ItemCount@1000000004 : Integer;
      More@1000000005 : Boolean;
    BEGIN
      CurrPage.SETSELECTIONFILTER(Item);
      ItemCount := Item.COUNT;
      IF ItemCount > 0 THEN BEGIN
        Item.FIND('-');
        WHILE ItemCount > 0 DO BEGIN
          ItemCount := ItemCount - 1;
          Item.MARKEDONLY(FALSE);
          FirstItem := Item."No.";
          LastItem := FirstItem;
          More := (ItemCount > 0);
          WHILE More DO
            IF Item.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT Item.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastItem := Item."No.";
                ItemCount := ItemCount - 1;
                IF ItemCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstItem = LastItem THEN
            SelectionFilter := SelectionFilter + FirstItem
          ELSE
            SelectionFilter := SelectionFilter + FirstItem + '..' + LastItem;
          IF ItemCount > 0 THEN BEGIN
            Item.MARKEDONLY(TRUE);
            Item.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE SetSelection@1(VAR Item@1000000000 : Record 27);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Item);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new menu button VAT Announce Price.
      Burda
      002   07.08.2007   KKE   Permission Filter by Magazine Code.
    }
    END.
  }
}

OBJECT Page 38 Item Ledger Entries
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Item Ledger Entries;
               THA=รายการบัญชีแยกประเภทสินค้า];
    SourceTable=Table32;
    DataCaptionExpr=GetCaption;
    DataCaptionFields=Item No.;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 60      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 61      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 544;
                      RunFormLink=Table ID=CONST(32),Entry No.=FIELD(Entry No.);
                      Image=Dimensions }
      { 64      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=&Value Entries;
                                 THA=&รายการบัญชีแสดงมูลค่า];
                      RunObject=Page 5802;
                      RunFormView=SORTING(Item Ledger Entry No.);
                      RunFormLink=Item Ledger Entry No.=FIELD(Entry No.);
                      Image=ValueLedger }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Application;
                                 THA=&แอพพลิเคชัน] }
      { 58      ;2   ;Action    ;
                      CaptionML=[ENU=Applied E&ntries;
                                 THA=รายกา&รที่ใช้];
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Show Applied Entries",Rec);
                               END;
                                }
      { 56      ;2   ;Action    ;
                      CaptionML=[ENU=Reservation Entries;
                                 THA=รายการจอง];
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 ShowReservationEntries(TRUE);
                               END;
                                }
      { 86      ;2   ;Action    ;
                      CaptionML=[ENU=Application Worksheet;
                                 THA=แผ่นงานแอพพลิเคชัน];
                      OnAction=VAR
                                 Worksheet@1000000001 : Form 521;
                               BEGIN
                                 CLEAR(Worksheet);
                                 Worksheet.SetRecordToShow(Rec);
                                 Worksheet.RUN();
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 59      ;2   ;Action    ;
                      CaptionML=[ENU=Order &Tracking;
                                 THA=การ&ติดตามใบสั่ง];
                      OnAction=VAR
                                 TrackingForm@1000000001 : Form 99000822;
                               BEGIN
                                 TrackingForm.SetItemLedgEntry(Rec);
                                 TrackingForm.RUNMODAL;
                               END;
                                }
      { 32      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 4   ;2   ;Field     ;
                SourceExpr="Entry Type" }

    { 76  ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 78  ;2   ;Field     ;
                SourceExpr="Document Line No.";
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Serial No." }

    { 8   ;2   ;Field     ;
                SourceExpr="Item No." }

    { 16  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr=Description }

    { 20  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code";
                Visible=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr="Expiration Date";
                Visible=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="Serial No.";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Lot No.";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 12  ;2   ;Field     ;
                SourceExpr=Quantity }

    { 42  ;2   ;Field     ;
                SourceExpr="Invoiced Quantity";
                Visible=TRUE }

    { 44  ;2   ;Field     ;
                SourceExpr="Remaining Quantity";
                Visible=TRUE }

    { 84  ;2   ;Field     ;
                SourceExpr="Shipped Qty. Not Returned";
                Visible=FALSE }

    { 117 ;2   ;Field     ;
                SourceExpr="Reserved Quantity";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Qty. per Unit of Measure";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Sales Amount (Expected)";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Sales Amount (Actual)" }

    { 31  ;2   ;Field     ;
                SourceExpr="Cost Amount (Expected)";
                Visible=FALSE }

    { 41  ;2   ;Field     ;
                SourceExpr="Cost Amount (Actual)" }

    { 47  ;2   ;Field     ;
                SourceExpr="Cost Amount (Non-Invtbl.)" }

    { 49  ;2   ;Field     ;
                SourceExpr="Cost Amount (Expected) (ACY)";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Cost Amount (Actual) (ACY)";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="Cost Amount (Non-Invtbl.)(ACY)";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Completely Invoiced";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr=Open }

    { 80  ;2   ;Field     ;
                SourceExpr="Drop Shipment";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Applied Entry to Adjust";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Prod. Order No.";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="Prod. Order Line No.";
                Visible=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Prod. Order Comp. Line No.";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Entry No." }

    { 1000;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 1002;2   ;Field     ;
                SourceExpr="Job Task No.";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Navigate@1000000000 : Form 344;

    PROCEDURE GetCaption@3() : Text[250];
    VAR
      GLSetup@1000000000 : Record 98;
      ObjTransl@1000000001 : Record 377;
      Item@1000000002 : Record 27;
      ProdOrder@1000000003 : Record 5405;
      Cust@1000000004 : Record 18;
      Vend@1000000005 : Record 23;
      Dimension@1000000006 : Record 348;
      DimValue@1000000007 : Record 349;
      SourceTableName@1000000008 : Text[100];
      SourceFilter@1000000009 : Text[200];
      Description@1000000010 : Text[100];
    BEGIN
      Description := '';

      CASE TRUE OF
        GETFILTER("Item No.") <> '':
          BEGIN
            SourceTableName := ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,27);
            SourceFilter := GETFILTER("Item No.");
            IF MAXSTRLEN(Item."No.") >= STRLEN(SourceFilter) THEN
              IF Item.GET(SourceFilter) THEN
                Description := Item.Description;
          END;
        GETFILTER("Prod. Order No.") <> '':
          BEGIN
            SourceTableName := ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,5405);
            SourceFilter := GETFILTER("Prod. Order No.");
            IF MAXSTRLEN(ProdOrder."No.") >= STRLEN(SourceFilter) THEN
              IF ProdOrder.GET(ProdOrder.Status::Released,SourceFilter) OR
                 ProdOrder.GET(ProdOrder.Status::Finished,SourceFilter)
              THEN BEGIN
                SourceTableName := STRSUBSTNO('%1 %2',ProdOrder.Status,SourceTableName);
                Description := ProdOrder.Description;
              END;
          END;
        GETFILTER("Source No.") <> '':
          BEGIN
            CASE "Source Type" OF
              "Source Type"::Customer:
                BEGIN
                  SourceTableName :=
                    ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,18);
                  SourceFilter := GETFILTER("Source No.");
                  IF MAXSTRLEN(Cust."No.") >= STRLEN(SourceFilter) THEN
                    IF Cust.GET(SourceFilter) THEN
                      Description := Cust.Name;
                END;
              "Source Type"::Vendor:
                BEGIN
                  SourceTableName :=
                    ObjTransl.TranslateObject(ObjTransl."Object Type"::Table,23);
                  SourceFilter := GETFILTER("Source No.");
                  IF MAXSTRLEN(Vend."No.") >= STRLEN(SourceFilter) THEN
                    IF Vend.GET(SourceFilter) THEN
                      Description := Vend.Name;
                END;
            END;
          END;
        GETFILTER("Global Dimension 1 Code") <> '':
          BEGIN
            GLSetup.GET;
            Dimension.Code := GLSetup."Global Dimension 1 Code";
            SourceFilter := GETFILTER("Global Dimension 1 Code");
            SourceTableName := Dimension.GetMLName(GLOBALLANGUAGE);
            IF MAXSTRLEN(DimValue.Code) >= STRLEN(SourceFilter) THEN
              IF DimValue.GET(GLSetup."Global Dimension 1 Code",SourceFilter) THEN
                Description := DimValue.Name;
          END;
        GETFILTER("Global Dimension 2 Code") <> '':
          BEGIN
            GLSetup.GET;
            Dimension.Code := GLSetup."Global Dimension 2 Code";
            SourceFilter := GETFILTER("Global Dimension 2 Code");
            SourceTableName := Dimension.GetMLName(GLOBALLANGUAGE);
            IF MAXSTRLEN(DimValue.Code) >= STRLEN(SourceFilter) THEN
              IF DimValue.GET(GLSetup."Global Dimension 2 Code",SourceFilter) THEN
                Description := DimValue.Name;
          END;
        GETFILTER("Document Type") <> '':
          BEGIN
            SourceTableName := GETFILTER("Document Type");
            SourceFilter := GETFILTER("Document No.");
            Description := GETFILTER("Document Line No.");
          END;
      END;
      EXIT(STRSUBSTNO('%1 %2 %3',SourceTableName,SourceFilter,Description));
    END;

    BEGIN
    END.
  }
}

OBJECT Page 39 General Journal
{
  OBJECT-PROPERTIES
  {
    Date=11/05/08;
    Time=12:00:00 PM;
    Version List=NAVW16.00,NAVAP4.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=General Journal;
               THA=สมุดรายวันทั่วไป];
    SaveValues=Yes;
    SourceTable=Table81;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             TotalBalanceVisible := TRUE;
             BalanceVisible := TRUE;
           END;

    OnOpenPage=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 BalAccName := '';
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Journal Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 GenJnlManagement.TemplateSelection(FORM::"General Journal",0,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  UpdateBalance;
                  SetUpNewLine(xRec,Balance,BelowxRec);
                  CLEAR(ShortcutDimCode);
                  CLEAR(AccName);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 75      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 76      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 545;
                      RunFormLink=Table ID=CONST(81),
                                  Journal Template Name=FIELD(Journal Template Name),
                                  Journal Batch Name=FIELD(Journal Batch Name),
                                  Journal Line No.=FIELD(Line No.);
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process }
      { 43      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 THA=&บัญชี] }
      { 44      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Codeunit 15;
                      Image=EditLines }
      { 45      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Codeunit 14;
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 46      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 91      ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      RunObject=Codeunit 225;
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process }
      { 92      ;2   ;Action    ;
                      CaptionML=[ENU=Insert Conv. LCY Rndg. Lines;
                                 THA=แทรกบรรทัดการปัดเศษจากการแปลง LCY];
                      RunObject=Codeunit 407 }
      { 107     ;2   ;Separator ;
                      CaptionML=[ENU=-;
                                 THA=-] }
      { 109     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Get Standard Journals;
                                 THA=&รับสมุดรายวันมาตรฐาน];
                      Promoted=Yes;
                      Image=GetStandardJournal;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 StdGenJnl@1000 : Record 750;
                               BEGIN
                                 StdGenJnl.FILTERGROUP := 2;
                                 StdGenJnl.SETRANGE("Journal Template Name","Journal Template Name");
                                 StdGenJnl.FILTERGROUP := 0;

                                 IF FORM.RUNMODAL(FORM::"Standard General Journals",StdGenJnl) = ACTION::LookupOK THEN BEGIN
                                   StdGenJnl.CreateGenJnlFromStdJnl(StdGenJnl,CurrentJnlBatchName);
                                   MESSAGE(Text000,StdGenJnl.Code);
                                 END;

                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 108     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Save as Standard Journal;
                                 THA=&บันทึกเป็นสมุดรายวันมาตรฐาน];
                      Promoted=Yes;
                      Image=SaveasStandardJournal;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 GenJnlBatch@1001 : Record 232;
                                 GeneralJnlLines@1004 : Record 81;
                                 StdGenJnl@1002 : Record 750;
                                 SaveAsStdGenJnl@1003 : Report 750;
                               BEGIN
                                 GeneralJnlLines.SETFILTER("Journal Template Name","Journal Template Name");
                                 GeneralJnlLines.SETFILTER("Journal Batch Name",CurrentJnlBatchName);
                                 CurrPage.SETSELECTIONFILTER(GeneralJnlLines);
                                 GeneralJnlLines.COPYFILTERS(Rec);

                                 GenJnlBatch.GET("Journal Template Name",CurrentJnlBatchName);
                                 SaveAsStdGenJnl.Initialise(GeneralJnlLines,GenJnlBatch);
                                 SaveAsStdGenJnl.RUNMODAL;
                                 IF NOT SaveAsStdGenJnl.GetStdGeneralJournal(StdGenJnl) THEN
                                   EXIT;

                                 MESSAGE(Text001,StdGenJnl.Code);
                               END;
                                }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การล&งรายการบัญชี] }
      { 48      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Reconcile;
                                 THA=กระทบยอด];
                      Image=Reconcile;
                      OnAction=BEGIN
                                 GLReconcile.SetGenJnlLine(Rec);
                                 GLReconcile.RUN;
                               END;
                                }
      { 49      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintGenJnlLine(Rec);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ล&งรายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 51      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 39  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           THA=ชื่อชุดงาน];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             GenJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                               CurrentJnlBatchNameOnAfterVali;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           GenJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 83  ;2   ;Field     ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 81  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Account Type";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr="Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 12  ;2   ;Field     ;
                SourceExpr=Description }

    { 71  ;2   ;Field     ;
                SourceExpr="Business Unit Code";
                Visible=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Salespers./Purch. Code";
                Visible=FALSE }

    { 93  ;2   ;Field     ;
                SourceExpr="Campaign No.";
                Visible=FALSE }

    { 67  ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr="Currency Code";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 14  ;2   ;Field     ;
                SourceExpr="Gen. Posting Type" }

    { 77  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 16  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 41  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 85  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr=Amount }

    { 101 ;2   ;Field     ;
                SourceExpr="VAT Amount";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                SourceExpr="VAT Difference";
                Visible=FALSE }

    { 103 ;2   ;Field     ;
                SourceExpr="Bal. VAT Amount";
                Visible=FALSE }

    { 105 ;2   ;Field     ;
                SourceExpr="Bal. VAT Difference";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Bal. Account Type" }

    { 55  ;2   ;Field     ;
                SourceExpr="Bal. Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 57  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Posting Type" }

    { 79  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Bus. Posting Group" }

    { 59  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Prod. Posting Group" }

    { 87  ;2   ;Field     ;
                SourceExpr="Bal. VAT Bus. Posting Group";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Bal. VAT Prod. Posting Group";
                Visible=FALSE }

    { 95  ;2   ;Field     ;
                SourceExpr="Bill-to/Pay-to No.";
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                SourceExpr="Ship-to/Order Address Code";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 69  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No.";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Applies-to ID";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="On Hold";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Bank Payment Type";
                Visible=FALSE }

    { 73  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 30  ;1   ;Group      }

    { 1901776101;2;Group  ;
                GroupType=FixedLayout }

    { 1900545301;3;Group  ;
                CaptionML=[ENU=Account Name;
                           THA=ชื่อบัญชี] }

    { 35  ;4   ;Field     ;
                SourceExpr=AccName;
                Editable=FALSE }

    { 1900295701;3;Group  ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล] }

    { 37  ;4   ;Field     ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล];
                SourceExpr=BalAccName;
                Editable=FALSE }

    { 1902759701;3;Group  ;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ] }

    { 31  ;4   ;Field     ;
                Name=Balance;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ];
                SourceExpr=Balance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=BalanceVisible;
                Editable=FALSE }

    { 1901652501;3;Group  ;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล] }

    { 33  ;4   ;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล];
                SourceExpr=TotalBalance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=TotalBalanceVisible;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900919607;1;Part   ;
                SubFormLink=Table ID=CONST(81),
                            Journal Template Name=FIELD(Journal Template Name),
                            Journal Batch Name=FIELD(Journal Batch Name),
                            Journal Line No.=FIELD(Line No.);
                PagePartID=Page545;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ChangeExchangeRate@1000 : Form 511;
      GLReconcile@1001 : Form 345;
      GenJnlManagement@1002 : Codeunit 230;
      ReportPrint@1003 : Codeunit 228;
      CurrentJnlBatchName@1004 : Code[10];
      AccName@1005 : Text[50];
      BalAccName@1006 : Text[50];
      Balance@1007 : Decimal;
      TotalBalance@1008 : Decimal;
      ShowBalance@1009 : Boolean;
      ShowTotalBalance@1010 : Boolean;
      ShortcutDimCode@1011 : ARRAY [8] OF Code[20];
      Text000@1012 : TextConst 'ENU=General Journal lines have been successfully inserted from Standard General Journal %1.;THA=แทรกบรรทัดสมุดรายวันทั่วไปจากสมุดรายวันทั่วไปมาตรฐาน %1 เสร็จเรียบร้อยแล้ว';
      Text001@1013 : TextConst 'ENU=Standard General Journal %1 has been successfully created.;THA=สร้างสมุดรายวันทั่วไปมาตรฐาน %1 เสร็จเรียบร้อยแล้ว';
      OpenedFromBatch@1014 : Boolean;
      BalanceVisible@19073040 : Boolean INDATASET;
      TotalBalanceVisible@19063333 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateBalance@1();
    BEGIN
      GenJnlManagement.CalcBalance(Rec,xRec,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      BalanceVisible := ShowBalance;
      TotalBalanceVisible := ShowTotalBalance;
    END;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      GenJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
      UpdateBalance;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 41 Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=11:36:20 AM;
    Version List=NAVW16.00.01,KITNA6.00,NAVAP5.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Quote;
               THA=ใบเสนอราคาขาย];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=FILTER(Quote));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             "Bill-to Customer No.Enable" := TRUE;
             "Sell-to Customer No.Enable" := TRUE;
             SelltoCustomerTemplateCodeEnab := TRUE;
             BilltoCustomerTemplateCodeEnab := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF UserMgt.GetSalesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter);
                   FILTERGROUP(0);
                 END;

                 ActivateFields;
               END;

    OnAfterGetRecord=BEGIN
                       ActivateFields;

                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetSalesFilter;
                  OnAfterGetCurrRecord;
                END;

    OnInsertRecord=BEGIN
                     CheckCreditMaxBeforeInsert;
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Quote;
                                 THA=&ใบเสนอราคา] }
      { 61      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Sales Statistics",Rec);
                               END;
                                }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Customer Card;
                                 THA=บัตรลูกค้า];
                      RunObject=Page 21;
                      RunFormLink=No.=FIELD(Sell-to Customer No.) }
      { 146     ;2   ;Action    ;
                      CaptionML=[ENU=C&ontact Card;
                                 THA=บัตร&ผู้ติดต่อ];
                      RunObject=Page 5052;
                      RunFormLink=No.=FIELD(Sell-to Contact No.) }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=FIELD(Document Type),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 104     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 189     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1000000001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 64      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 168     ;2   ;Separator  }
      { 124     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=;
                      OnAction=VAR
                                 StdCustSalesCode@1000000001 : Record 172;
                               BEGIN
                                 StdCustSalesCode.InsertSalesLines(Rec);
                               END;
                                }
      { 139     ;2   ;Separator  }
      { 66      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopySalesDoc.SetSalesHeader(Rec);
                                 CopySalesDoc.RUNMODAL;
                                 CLEAR(CopySalesDoc);
                               END;
                                }
      { 165     ;2   ;Action    ;
                      CaptionML=[ENU=Archi&ve Document;
                                 THA=เก็&บถาวรเอกสาร];
                      OnAction=BEGIN
                                 ArchiveManagement.ArchiveSalesDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 141     ;2   ;Separator  }
      { 126     ;2   ;Action    ;
                      CaptionML=[ENU=C&reate Customer;
                                 THA=ส&ร้างลูกค้า];
                      OnAction=BEGIN
                                 IF CheckCustomerCreated(FALSE) THEN
                                   CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 143     ;2   ;Separator  }
      { 190     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1000000001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.SendSalesApprovalRequest(Rec) THEN;
                               END;
                                }
      { 191     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1000000001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.CancelSalesApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 142     ;2   ;Separator  }
      { 115     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Image=ReleaseDoc;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000000001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 116     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000000001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 161     ;2   ;Separator  }
      { 162     ;2   ;Action    ;
                      CaptionML=[ENU=&Send BizTalk Sales Quote;
                                 THA=&ส่งใบเสนอราคาขาย BizTalk];
                      OnAction=VAR
                                 BizTalkManagement@1000000001 : Codeunit 99008508;
                                 ApprovalMgt@1000000002 : Codeunit 439;
                                 PurchaseHeader@1000000003 : Record 38;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   BizTalkManagement.SendSalesQuote(Rec);
                               END;
                                }
      { 137     ;2   ;Separator  }
      { 169     ;2   ;Action    ;
                      CaptionML=[ENU=Create &To-do;
                                 THA=สร้างสิ่งที่ต้อง&ปฏิบัติ];
                      OnAction=BEGIN
                                 CreateTodo;
                               END;
                                }
      { 68      ;1   ;Action    ;
                      CaptionML=[ENU=Make &Order;
                                 THA=จัดทำ&ใบสั่งซื้อ];
                      Promoted=Yes;
                      Image=MakeOrder;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseHeader@1000000001 : Record 38;
                                 ApprovalMgt@1000000002 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Sales-Quote to Order (Yes/No)",Rec);
                               END;
                                }
      { 69      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesHeader(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                Enabled="Sell-to Customer No.Enable";
                OnValidate=BEGIN
                             SelltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 120 ;2   ;Field     ;
                SourceExpr="Sell-to Contact No.";
                OnValidate=BEGIN
                             SelltoContactNoOnAfterValidate;
                           END;
                            }

    { 127 ;2   ;Field     ;
                SourceExpr="Sell-to Customer Template Code";
                Importance=Additional;
                Enabled=SelltoCustomerTemplateCodeEnab;
                OnValidate=BEGIN
                             SelltoCustomerTemplateCodeOnAfterValidate;
                           END;
                            }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name" }

    { 71  ;2   ;Field     ;
                SourceExpr="Sell-to Address";
                Importance=Additional }

    { 73  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2";
                Importance=Additional }

    { 77  ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Importance=Additional }

    { 74  ;2   ;Field     ;
                SourceExpr="Sell-to City" }

    { 1500004;2;Field     ;
                SourceExpr="Sell-to County";
                Importance=Promoted }

    { 1500000;2;Field     ;
                CaptionML=[ENU=Sell-to County/Country Code;
                           THA=ขายไปที่เขต/รหัสประเทศ];
                SourceExpr="Sell-to Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Importance=Additional }

    { 12  ;2   ;Field     ;
                SourceExpr="Order Date";
                Importance=Promoted }

    { 15  ;2   ;Field     ;
                SourceExpr="Document Date" }

    { 118 ;2   ;Field     ;
                SourceExpr="Requested Delivery Date" }

    { 10  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 103 ;2   ;Field     ;
                SourceExpr="Campaign No." }

    { 170 ;2   ;Field     ;
                SourceExpr="Opportunity No." }

    { 108 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 192 ;2   ;Field     ;
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 106 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 58  ;1   ;Part      ;
                Name=SalesLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page95 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 16  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                Enabled="Bill-to Customer No.Enable";
                OnValidate=BEGIN
                             BilltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 122 ;2   ;Field     ;
                SourceExpr="Bill-to Contact No." }

    { 166 ;2   ;Field     ;
                SourceExpr="Bill-to Customer Template Code";
                Importance=Additional;
                Enabled=BilltoCustomerTemplateCodeEnab;
                OnValidate=BEGIN
                             BilltoCustomerTemplateCodeOnAfterValidate;
                           END;
                            }

    { 18  ;2   ;Field     ;
                SourceExpr="Bill-to Name" }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Address";
                Importance=Additional }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2";
                Importance=Additional }

    { 91  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Importance=Additional }

    { 89  ;2   ;Field     ;
                SourceExpr="Bill-to City" }

    { 1500007;2;Field     ;
                SourceExpr="Bill-to County" }

    { 1500009;2;Field     ;
                CaptionML=[ENU=Bill-to County/Country Code;
                           THA=เรียกเก็บเงินที่เขต/รหัสประเทศ];
                SourceExpr="Bill-to Country/Region Code" }

    { 26  ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Importance=Additional }

    { 80  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 84  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 28  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 32  ;2   ;Field     ;
                SourceExpr="Payment Discount %" }

    { 34  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 90  ;2   ;Field     ;
                SourceExpr="Payment Method Code" }

    { 113 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 187 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Importance=Promoted }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Importance=Additional }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Importance=Additional }

    { 95  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Importance=Additional }

    { 93  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1500002;2;Field     ;
                SourceExpr="Ship-to County" }

    { 1500005;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code" }

    { 46  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Importance=Additional }

    { 86  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 48  ;2   ;Field     ;
                SourceExpr="Shipment Method Code" }

    { 50  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Importance=Promoted }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 97  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 52  ;2   ;Field     ;
                SourceExpr="EU 3-Party Trade" }

    { 54  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 81  ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 56  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 25  ;2   ;Field     ;
                SourceExpr="Exit Point" }

    { 45  ;2   ;Field     ;
                SourceExpr=Area }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903720907;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9080;
                Visible=TRUE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubFormLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubFormLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9082;
                Visible=FALSE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9084;
                Visible=FALSE;
                PartType=Page }

    { 1906127307;1;Part   ;
                SubFormLink=Document Type=FIELD(Document Type),Document No.=FIELD(Document No.),Line No.=FIELD(Line No.);
                PagePartID=Page9087;
                ProviderID=58;
                Visible=TRUE;
                PartType=Page }

    { 1901314507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9089;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(36),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1907012907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9108;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=Unable to execute this function while in view only mode.;THA=ไม่สามารถใช้ฟังก์ชันนี้ขณะที่อยู่ในโหมดดูอย่างเดียว';
      SalesSetup@1000000001 : Record 311;
      ChangeExchangeRate@1000000002 : Form 511;
      CopySalesDoc@1000000003 : Report 292;
      DocPrint@1000000004 : Codeunit 229;
      UserMgt@1000000005 : Codeunit 5700;
      ArchiveManagement@1000000006 : Codeunit 5063;
      SalesInfoPaneMgt@1000000007 : Codeunit 7171;
      SalesHeaderArchive@1000000008 : Record 5107;
      SalesHistoryBtnVisible@19034839 : Boolean INDATASET;
      BillToCommentPictVisible@19001287 : Boolean INDATASET;
      BillToCommentBtnVisible@19078935 : Boolean INDATASET;
      SalesHistoryStnVisible@19031688 : Boolean INDATASET;
      BilltoCustomerTemplateCodeEnab@19078724 : Boolean INDATASET;
      SelltoCustomerTemplateCodeEnab@19001802 : Boolean INDATASET;
      "Sell-to Customer No.Enable"@19037337 : Boolean INDATASET;
      "Bill-to Customer No.Enable"@19072970 : Boolean INDATASET;

    PROCEDURE UpdateAllowed@1() : Boolean;
    BEGIN
      IF CurrPage.EDITABLE = FALSE THEN BEGIN
        MESSAGE(Text000);
        EXIT(FALSE);
      END ELSE
        EXIT(TRUE);
    END;

    PROCEDURE ActivateFields@2();
    BEGIN
      BilltoCustomerTemplateCodeEnab := "Bill-to Customer No." = '';
      SelltoCustomerTemplateCodeEnab := "Sell-to Customer No." = '';
      "Sell-to Customer No.Enable" := "Sell-to Customer Template Code" = '';
      "Bill-to Customer No.Enable" := "Bill-to Customer Template Code" = '';
    END;

    LOCAL PROCEDURE UpdateInfoPanel@4();
    VAR
      DifferSellToBillTo@1000000000 : Boolean;
    BEGIN
      DifferSellToBillTo := "Sell-to Customer No." <> "Bill-to Customer No.";
      SalesHistoryBtnVisible := DifferSellToBillTo;
      BillToCommentPictVisible := DifferSellToBillTo;
      BillToCommentBtnVisible := DifferSellToBillTo;
      SalesHistoryStnVisible := SalesInfoPaneMgt.DocExist(Rec,"Sell-to Customer No.");
      IF DifferSellToBillTo THEN
        SalesHistoryBtnVisible := SalesInfoPaneMgt.DocExist(Rec,"Bill-to Customer No.")
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@3();
    BEGIN
      CurrPage.SalesLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SelltoCustomerNoOnAfterValidat@19034782();
    BEGIN
      ActivateFields;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE SelltoContactNoOnAfterValidate@19015826();
    BEGIN
      ActivateFields;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SelltoCustomerTemplateCodeOnAf@19025930();
    BEGIN
      ActivateFields;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE BilltoCustomerNoOnAfterValidat@19044114();
    BEGIN
      ActivateFields;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE BilltoCustomerTemplateCodeOnAf@19070097();
    BEGIN
      ActivateFields;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      ActivateFields;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 42 Sales Order
{
  OBJECT-PROPERTIES
  {
    Date=12/19/11;
    Time=[ 2:55:32 PM];
    Version List=NAVW16.00.10,KITNA6.00,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Order;
               THA=ใบสั่งขาย];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 IF UserMgt.GetSalesFilter() <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter());
                   FILTERGROUP(0);
                 END;

                 SETRANGE("Date Filter",0D,WORKDATE - 1);
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetSalesFilter();
                END;

    OnInsertRecord=BEGIN
                     CheckCreditMaxBeforeInsert;
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 THA=ใบ&สั่ง] }
      { 61      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Sales Order Statistics",Rec);
                               END;
                                }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 21;
                      RunFormLink=No.=FIELD(Sell-to Customer No.);
                      Image=EditLines }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=FIELD(Document Type),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 64      ;2   ;Action    ;
                      CaptionML=[ENU=S&hipments;
                                 THA=การ&จัดส่ง];
                      RunObject=Page 142;
                      RunFormView=SORTING(Order No.);
                      RunFormLink=Order No.=FIELD(No.) }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 THA=ใบแจ้งหนี้];
                      RunObject=Page 143;
                      RunFormView=SORTING(Order No.);
                      RunFormLink=Order No.=FIELD(No.);
                      Image=Invoice }
      { 234     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 THA=&ใบแจ้งหนี้สำหรับการชำระเงินล่วงหน้า];
                      RunObject=Page 143;
                      RunFormView=SORTING(Prepayment Order No.);
                      RunFormLink=Prepayment Order No.=FIELD(No.) }
      { 235     ;2   ;Action    ;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 THA=ใ&บลดหนี้การชำระเงินล่วงหน้า];
                      RunObject=Page 144;
                      RunFormView=SORTING(Prepayment Order No.);
                      RunFormLink=Prepayment Order No.=FIELD(No.) }
      { 122     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 78      ;2   ;Action    ;
                      CaptionML=[ENU=A&pprovals;
                                 THA=&อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 173     ;2   ;Separator  }
      { 168     ;2   ;Action    ;
                      CaptionML=[ENU=Whse. Shipment Lines;
                                 THA=บรรทัดการจัดส่งของคลังสินค้า];
                      RunObject=Page 7341;
                      RunFormView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunFormLink=Source Type=CONST(37),Source Subtype=FIELD(Document Type),Source No.=FIELD(No.) }
      { 150     ;2   ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 THA=&บรรทัดการย้ายเก็บ/การรับสินค้าคงคลัง];
                      RunObject=Page 5774;
                      RunFormView=SORTING(Source Document,Source No.,Location Code);
                      RunFormLink=Source Document=CONST(Sales Order),Source No.=FIELD(No.) }
      { 120     ;2   ;Separator  }
      { 121     ;2   ;Action    ;
                      CaptionML=[ENU=Pla&nning;
                                 THA=การ&วางแผน];
                      OnAction=VAR
                                 SalesPlanForm@1001 : Form 99000883;
                               BEGIN
                                 SalesPlanForm.SetSalesOrder("No.");
                                 SalesPlanForm.RUNMODAL;
                               END;
                                }
      { 197     ;2   ;Action    ;
                      CaptionML=[ENU=Order &Promising;
                                 THA=การสัญญา&ว่าจะออกใบสั่ง];
                      OnAction=VAR
                                 OrderPromisingLine@1000 : TEMPORARY Record 99000880;
                               BEGIN
                                 OrderPromisingLine.SETRANGE("Source Type","Document Type");
                                 OrderPromisingLine.SETRANGE("Source ID","No.");
                                 FORM.RUNMODAL(FORM::"Order Promising Lines",OrderPromisingLine);
                               END;
                                }
      { 258     ;2   ;Separator  }
      { 259     ;2   ;Action    ;
                      CaptionML=[ENU=Credit Cards Transaction Lo&g Entries;
                                 THA=รายการบัน&ทึกธุรกรรมบัตรเครดิต];
                      RunObject=Page 829;
                      RunFormLink=Document Type=FIELD(Document Type),Document No.=FIELD(No.),Customer No.=FIELD(Bill-to Customer No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 66      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 67      ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 172     ;2   ;Separator  }
      { 167     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=;
                      OnAction=VAR
                                 StdCustSalesCode@1000 : Record 172;
                               BEGIN
                                 StdCustSalesCode.InsertSalesLines(Rec);
                               END;
                                }
      { 171     ;2   ;Separator  }
      { 68      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopySalesDoc.SetSalesHeader(Rec);
                                 CopySalesDoc.RUNMODAL;
                                 CLEAR(CopySalesDoc);
                               END;
                                }
      { 196     ;2   ;Action    ;
                      CaptionML=[ENU=Archi&ve Document;
                                 THA=เก็&บถาวรเอกสาร];
                      OnAction=BEGIN
                                 ArchiveManagement.ArchiveSalesDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 154     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 THA=ย้ายบรรทัดที่มีค่าลบ];
                      OnAction=BEGIN
                                 CLEAR(MoveNegSalesLines);
                                 MoveNegSalesLines.SetSalesHeader(Rec);
                                 MoveNegSalesLines.RUNMODAL;
                                 MoveNegSalesLines.ShowDocument;
                               END;
                                }
      { 195     ;2   ;Separator  }
      { 149     ;2   ;Action    ;
                      CaptionML=[ENU=Create &Whse. Shipment;
                                 THA=สร้างใบจัดส่งสินค้าของค&ลังสินค้า];
                      OnAction=VAR
                                 GetSourceDocOutbound@1001 : Codeunit 5752;
                               BEGIN
                                 GetSourceDocOutbound.CreateFromSalesOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 148     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away / Pick;
                                 THA=สร้างการย้ายเก็บ / การรับสินค้าคง&คลัง];
                      Promoted=Yes;
                      Image=CreateInventoryPickup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 174     ;2   ;Separator  }
      { 250     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                                 "Release Sales Document"@1002 : Codeunit 414;
                               BEGIN
                                 IF ApprovalMgt.SendSalesApprovalRequest(Rec) THEN;
                               END;
                                }
      { 251     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                                 "Release Sales Document"@1002 : Codeunit 414;
                               BEGIN
                                 IF ApprovalMgt.CancelSalesApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 175     ;2   ;Separator  }
      { 133     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 134     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Promoted=Yes;
                      Image=ReOpen;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 608     ;2   ;Separator  }
      { 193     ;2   ;Action    ;
                      CaptionML=[ENU=&Send BizTalk Sales Order Cnfmn.;
                                 THA=&ส่งการยืนยันใบสั่งขาย BizTalk];
                      OnAction=VAR
                                 BizTalkManagement@1000 : Codeunit 99008508;
                                 ApprovalMgt@1003 : Codeunit 439;
                                 PurchaseHeader@1002 : Record 38;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   BizTalkManagement.SendSalesOrderConf(Rec);
                               END;
                                }
      { 204     ;2   ;Action    ;
                      CaptionML=[ENU=Send IC Sales Order Cnfmn.;
                                 THA=ส่งการยืนยันใบสั่งขาย IC];
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 ApprovalMgt@1003 : Codeunit 439;
                                 PurchaseHeader@1002 : Record 38;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   ICInOutboxMgt.SendSalesDoc(Rec,FALSE);
                               END;
                                }
      { 255     ;2   ;Separator  }
      { 256     ;2   ;Action    ;
                      CaptionML=[ENU=Authorize;
                                 THA=อนุมัติ];
                      OnAction=BEGIN
                                 Authorize;
                               END;
                                }
      { 257     ;2   ;Action    ;
                      CaptionML=[ENU=Void A&uthorize;
                                 THA=ยกเลิกการ&อนุมัติ];
                      OnAction=BEGIN
                                 Void;
                               END;
                                }
      { 73      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การล&งรายการบัญชี] }
      { 74      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeader(Rec);
                               END;
                                }
      { 75      ;2   ;Action    ;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 THA=ล&งรายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseHeader@1002 : Record 38;
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN BEGIN
                                   IF ApprovalMgt.TestSalesPrepayment(Rec) THEN
                                     ERROR(STRSUBSTNO(Text001,"Document Type","No."))
                                   ELSE BEGIN
                                     IF ApprovalMgt.TestSalesPayment(Rec) THEN
                                       ERROR(STRSUBSTNO(Text002,"Document Type","No."))
                                     ELSE
                                       CODEUNIT.RUN(CODEUNIT::"Sales-Post (Yes/No)",Rec);
                                   END;
                                 END;
                               END;
                                }
      { 76      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseHeader@1001 : Record 38;
                                 ApprovalMgt@1002 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN BEGIN
                                   IF ApprovalMgt.TestSalesPrepayment(Rec) THEN
                                     ERROR(STRSUBSTNO(Text001,"Document Type","No."))
                                   ELSE BEGIN
                                     IF ApprovalMgt.TestSalesPayment(Rec) THEN
                                       ERROR(STRSUBSTNO(Text002,"Document Type","No."))
                                     ELSE
                                       CODEUNIT.RUN(CODEUNIT::"Sales-Post + Print",Rec);
                                   END;
                                 END;
                               END;
                                }
      { 77      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 THA=ลงรายการบัญชี&ชุดงาน];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Sales Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 230     ;2   ;Separator  }
      { 236     ;2   ;ActionGroup;
                      CaptionML=[ENU=Prepa&yment;
                                 THA=&การชำระเงินล่วงหน้า] }
      { 231     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Prepayment &Test Report;
                                 THA=รายงาน&ทดสอบการชำระเงินล่วงหน้า];
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeaderPrepmt(Rec);
                               END;
                                }
      { 232     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Invoice;
                                 THA=ล&งรายการบัญชีสำหรับใบแจ้งหนี้การชำระเงินล่วงหน้า];
                      OnAction=VAR
                                 PurchaseHeader@1002 : Record 38;
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   SalesPostYNPrepmt.PostPrepmtInvoiceYN(Rec,FALSE);
                               END;
                                }
      { 237     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Invoic&e;
                                 THA=ลงรายการบัญชีและ&พิมพ์ใบแจ้งหนี้ชำระเงินล่วงหน้า];
                      OnAction=VAR
                                 PurchaseHeader@1002 : Record 38;
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   SalesPostYNPrepmt.PostPrepmtInvoiceYN(Rec,TRUE);
                               END;
                                }
      { 233     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Credit Memo;
                                 THA=ลง&รายการบัญชีใบลดหนี้การชำระเงินล่วงหน้า];
                      OnAction=VAR
                                 PurchaseHeader@1002 : Record 38;
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   SalesPostYNPrepmt.PostPrepmtCrMemoYN(Rec,FALSE);
                               END;
                                }
      { 238     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Cr. Mem&o;
                                 THA=ลงรายการบัญชีและ&พิมพ์ใบลดหนี้การชำระเงินล่วงหน้า];
                      OnAction=VAR
                                 PurchaseHeader@1002 : Record 38;
                                 SalesPostYNPrepmt@1000 : Codeunit 443;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   SalesPostYNPrepmt.PostPrepmtCrMemoYN(Rec,TRUE);
                               END;
                                }
      { 223     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์] }
      { 224     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Order Confirmation;
                                 THA=การยืนยันใบสั่ง];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Order Confirmation");
                               END;
                                }
      { 225     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Work Order;
                                 THA=ลำดับงาน];
                      Image=Print;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Work Order");
                               END;
                                }
      { 1462002 ;2   ;Action    ;
                      CaptionML=[ENU=Pick Ticket;
                                 THA=ใบเบิกจ่าย];
                      Visible=No;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesOrder(Rec,Usage::"Pick Ticket");
                               END;
                                }
      { 1000000026;2 ;Action    ;
                      CaptionML=ENU=Subscriber Label;
                      OnAction=BEGIN
                                 //#002 : PTH +
                                 SalesLine.SETCURRENTKEY("Document Type","Document No.","Line No.");
                                 SalesLine.SETRANGE("Document Type", SalesLine."Document Type"::Order);
                                 SalesLine.SETRANGE("Document No.", "No.");
                                 REPORT.RUNMODAL(REPORT::"Subscriber Contract - Labels",TRUE,FALSE, SalesLine)  ;
                                 //#002 : PTH -
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             SelltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 157 ;2   ;Field     ;
                SourceExpr="Sell-to Contact No.";
                Importance=Additional }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name" }

    { 81  ;2   ;Field     ;
                SourceExpr="Sell-to Address";
                Importance=Additional }

    { 83  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2";
                Importance=Additional }

    { 1000000005;2;Field  ;
                SourceExpr="Sell-to Address 3" }

    { 72  ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Importance=Additional }

    { 86  ;2   ;Field     ;
                SourceExpr="Sell-to City" }

    { 1500000;2;Field     ;
                SourceExpr="Sell-to County" }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Sell-to County/Country Code;
                           THA=ขายไปที่เขต/รหัสประเทศ];
                SourceExpr="Sell-to Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Importance=Additional }

    { 198 ;2   ;Field     ;
                SourceExpr="No. of Archived Versions";
                Importance=Additional }

    { 1000000000;2;Field  ;
                SourceExpr="PO No." }

    { 1000000003;2;Field  ;
                SourceExpr="Posting No. Series" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 14  ;2   ;Field     ;
                SourceExpr="Order Date";
                Importance=Promoted }

    { 45  ;2   ;Field     ;
                SourceExpr="Document Date" }

    { 135 ;2   ;Field     ;
                SourceExpr="Requested Delivery Date" }

    { 137 ;2   ;Field     ;
                SourceExpr="Promised Delivery Date";
                Importance=Additional }

    { 243 ;2   ;Field     ;
                SourceExpr="Quote No.";
                Importance=Additional }

    { 155 ;2   ;Field     ;
                SourceExpr="External Document No.";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 1148;2   ;Field     ;
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 245 ;2   ;Field     ;
                SourceExpr="Opportunity No.";
                Importance=Additional }

    { 124 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 241 ;2   ;Field     ;
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 129 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 58  ;1   ;Part      ;
                Name=SalesLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page46 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 16  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             BilltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 159 ;2   ;Field     ;
                SourceExpr="Bill-to Contact No.";
                Importance=Additional }

    { 18  ;2   ;Field     ;
                SourceExpr="Bill-to Name" }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Address";
                Importance=Additional }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2";
                Importance=Additional }

    { 1000000007;2;Field  ;
                SourceExpr="Bill-to Address 3" }

    { 89  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Importance=Additional }

    { 24  ;2   ;Field     ;
                SourceExpr="Bill-to City" }

    { 1500004;2;Field     ;
                SourceExpr="Bill-to County" }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Bill-to County/Country Code;
                           THA=เรียกเก็บเงินที่เขต/รหัสประเทศ];
                SourceExpr="Bill-to Country/Region Code" }

    { 26  ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Importance=Additional }

    { 84  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 92  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 28  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 32  ;2   ;Field     ;
                SourceExpr="Payment Discount %" }

    { 34  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date" }

    { 105 ;2   ;Field     ;
                SourceExpr="Payment Method Code" }

    { 131 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 221 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 247 ;2   ;Field     ;
                SourceExpr="Credit Card No." }

    { 253 ;2   ;Field     ;
                CaptionML=[ENU=Cr. Card Number (Last 4 Digits);
                           THA=หมายเลขบัตรเครดิต (4 ตัวหลังสุด)];
                SourceExpr=GetCreditcardNumber }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Importance=Promoted }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Importance=Additional }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Importance=Additional }

    { 1000000009;2;Field  ;
                SourceExpr="Ship-to Address 3" }

    { 97  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Importance=Promoted }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County" }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code" }

    { 46  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Importance=Additional }

    { 94  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 141 ;2   ;Field     ;
                SourceExpr="Outbound Whse. Handling Time";
                Importance=Additional }

    { 48  ;2   ;Field     ;
                SourceExpr="Shipment Method Code" }

    { 107 ;2   ;Field     ;
                SourceExpr="Shipping Agent Code";
                Importance=Additional }

    { 139 ;2   ;Field     ;
                SourceExpr="Shipping Agent Service Code";
                Importance=Additional }

    { 143 ;2   ;Field     ;
                SourceExpr="Shipping Time" }

    { 145 ;2   ;Field     ;
                SourceExpr="Late Order Shipping";
                Importance=Additional }

    { 109 ;2   ;Field     ;
                SourceExpr="Package Tracking No.";
                Importance=Additional }

    { 50  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Importance=Promoted }

    { 119 ;2   ;Field     ;
                SourceExpr="Shipping Advice";
                Importance=Promoted }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 111 ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 52  ;2   ;Field     ;
                SourceExpr="EU 3-Party Trade" }

    { 54  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 103 ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 56  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 99  ;2   ;Field     ;
                SourceExpr="Exit Point" }

    { 101 ;2   ;Field     ;
                SourceExpr=Area }

    { 1900201301;1;Group  ;
                CaptionML=[ENU=Prepayment;
                           THA=การชำระเงินล่วงหน้า] }

    { 228 ;2   ;Field     ;
                SourceExpr="Prepayment %";
                Importance=Promoted;
                OnValidate=BEGIN
                             Prepayment37OnAfterValidate;
                           END;
                            }

    { 229 ;2   ;Field     ;
                SourceExpr="Compress Prepayment" }

    { 162 ;2   ;Field     ;
                SourceExpr="Prepmt. Payment Terms Code" }

    { 239 ;2   ;Field     ;
                SourceExpr="Prepayment Due Date";
                Importance=Promoted }

    { 164 ;2   ;Field     ;
                SourceExpr="Prepmt. Payment Discount %" }

    { 70  ;2   ;Field     ;
                SourceExpr="Prepmt. Pmt. Discount Date" }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000010;2;Field  ;
                SourceExpr="Sell-to Name (Thai)" }

    { 1000000011;2;Field  ;
                SourceExpr="Sell-to Address (Thai)";
                MultiLine=Yes }

    { 1000000012;2;Field  ;
                SourceExpr="Bill-to Name (Thai)" }

    { 1000000013;2;Field  ;
                SourceExpr="Bill-to Address (Thai)";
                MultiLine=Yes }

    { 1000000014;2;Field  ;
                SourceExpr="Ship-to Name (Thai)" }

    { 1000000015;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                MultiLine=Yes }

    { 1901533901;1;Group  ;
                CaptionML=[ENU=Remark;
                           THA=หมายเหตุ] }

    { 1000000024;2;Field  ;
                SourceExpr="Remark 1";
                MultiLine=Yes }

    { 1000000022;2;Field  ;
                SourceExpr="Remark 2";
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903720907;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9080;
                Visible=TRUE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubFormLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9082;
                Visible=FALSE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9084;
                Visible=FALSE;
                PartType=Page }

    { 1906127307;1;Part   ;
                SubFormLink=Document Type=FIELD(Document Type),Document No.=FIELD(Document No.),Line No.=FIELD(Line No.);
                PagePartID=Page9087;
                ProviderID=58;
                Visible=TRUE;
                PartType=Page }

    { 1901314507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9089;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(36),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1907012907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9108;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1901796907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9109;
                ProviderID=58;
                Visible=FALSE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubFormLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Unable to execute this function while in view only mode.;THA=ไม่สามารถใช้ฟังก์ชันนี้ขณะที่อยู่ในโหมดดูอย่างเดียว';
      CopySalesDoc@1001 : Report 292;
      MoveNegSalesLines@1007 : Report 6699;
      ApprovalMgt@1012 : Codeunit 439;
      ReportPrint@1002 : Codeunit 228;
      DocPrint@1003 : Codeunit 229;
      ArchiveManagement@1008 : Codeunit 5063;
      SalesInfoPaneMgt@1009 : Codeunit 7171;
      SalesSetup@1004 : Record 311;
      ChangeExchangeRate@1005 : Form 511;
      UserMgt@1006 : Codeunit 5700;
      Usage@1010 : 'Order Confirmation,Work Order,Pick Ticket';
      Text001@1011 : TextConst 'ENU=There are non posted Prepayment Amounts on %1 %2.;THA=ไม่มียอดการชำระเงินล่วงหน้าที่ลงรายการบัญชีใน %1 %2';
      Text002@1013 : TextConst 'ENU=There are unpaid Prepayment Invoices related to %1 %2.;THA=มีใบแจ้งหนี้ที่ยังไม่ได้ชำระเงินเกี่ยวข้องกับ %1 %2';
      SalesLine@1000000001 : Record 37;
      SalesHistoryBtnVisible@19034839 : Boolean INDATASET;
      BillToCommentPictVisible@19001287 : Boolean INDATASET;
      BillToCommentBtnVisible@19078935 : Boolean INDATASET;
      SalesHistoryStnVisible@19031688 : Boolean INDATASET;

    PROCEDURE UpdateAllowed@1() : Boolean;
    BEGIN
      IF CurrPage.EDITABLE = FALSE THEN
        ERROR(Text000);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE UpdateInfoPanel@2();
    VAR
      DifferSellToBillTo@1000 : Boolean;
    BEGIN
      DifferSellToBillTo := "Sell-to Customer No." <> "Bill-to Customer No.";
      SalesHistoryBtnVisible := DifferSellToBillTo;
      BillToCommentPictVisible := DifferSellToBillTo;
      BillToCommentBtnVisible := DifferSellToBillTo;
      SalesHistoryStnVisible := SalesInfoPaneMgt.DocExist(Rec,"Sell-to Customer No.");
      IF DifferSellToBillTo THEN
        SalesHistoryBtnVisible := SalesInfoPaneMgt.DocExist(Rec,"Bill-to Customer No.")
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@3();
    BEGIN
      CurrPage.SalesLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SelltoCustomerNoOnAfterValidat@19034782();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE BilltoCustomerNoOnAfterValidat@19044114();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE Prepayment37OnAfterValidate@19040510();
    BEGIN
      CurrPage.UPDATE;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
      002   30.11.2007   PTH   Add new MenuItem 'Subscriber Label' for subscriber report.
    }
    END.
  }
}

OBJECT Page 43 Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=12/21/11;
    Time=[ 4:59:37 PM];
    Modified=Yes;
    Version List=NAVW16.00.10,KITNA6.00,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Invoice;
               THA=ใบแจ้งหนี้การขาย];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=FILTER(Invoice));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 IF UserMgt.GetSalesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetSalesFilter;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 THA=&ใบแจ้งหนี้] }
      { 59      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Sales Statistics",Rec);
                               END;
                                }
      { 60      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 21;
                      RunFormLink=No.=FIELD(Sell-to Customer No.);
                      Image=EditLines }
      { 61      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=FIELD(Document Type),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 116     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 162     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 171     ;2   ;Separator  }
      { 172     ;2   ;Action    ;
                      CaptionML=[ENU=Credit Cards Transaction Lo&g Entries;
                                 THA=รายการบัน&ทึกธุรกรรมบัตรเครดิต];
                      RunObject=Page 829;
                      RunFormLink=Document Type=FIELD(Document Type),Document No.=FIELD(No.),Customer No.=FIELD(Bill-to Customer No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 62      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 142     ;2   ;Separator  }
      { 134     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=;
                      OnAction=VAR
                                 StdCustSalesCode@1000 : Record 172;
                               BEGIN
                                 StdCustSalesCode.InsertSalesLines(Rec);
                               END;
                                }
      { 139     ;2   ;Separator  }
      { 64      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopySalesDoc.SetSalesHeader(Rec);
                                 CopySalesDoc.RUNMODAL;
                                 CLEAR(CopySalesDoc);
                               END;
                                }
      { 115     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 THA=ย้ายบรรทัดที่มีค่าลบ];
                      OnAction=BEGIN
                                 CLEAR(MoveNegSalesLines);
                                 MoveNegSalesLines.SetSalesHeader(Rec);
                                 MoveNegSalesLines.RUNMODAL;
                                 MoveNegSalesLines.ShowDocument;
                               END;
                                }
      { 141     ;2   ;Separator  }
      { 159     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.SendSalesApprovalRequest(Rec) THEN;
                               END;
                                }
      { 160     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.CancelSalesApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 161     ;2   ;Separator  }
      { 123     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 124     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleaseSalesDoc@1001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 168     ;2   ;Separator  }
      { 169     ;2   ;Action    ;
                      CaptionML=[ENU=Authorize;
                                 THA=อนุมัติ];
                      OnAction=BEGIN
                                 Authorize;
                               END;
                                }
      { 170     ;2   ;Action    ;
                      CaptionML=[ENU=Void A&uthorize;
                                 THA=ยกเลิกการ&อนุมัติ];
                      OnAction=BEGIN
                                 Void;
                               END;
                                }
      { 69      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การล&งรายการบัญชี] }
      { 70      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeader(Rec);
                               END;
                                }
      { 71      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ล&งรายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ApprovalMgt@1000 : Codeunit 439;
                                 PurchaseHeader@1001 : Record 38;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Sales-Post (Yes/No)",Rec);
                               END;
                                }
      { 72      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseHeader@1000 : Record 38;
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Sales-Post + Print",Rec);
                               END;
                                }
      { 73      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 THA=ลงรายการบัญชี&ชุดงาน];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Sales Invoices",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             SelltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 128 ;2   ;Field     ;
                SourceExpr="Sell-to Contact No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name" }

    { 75  ;2   ;Field     ;
                SourceExpr="Sell-to Address";
                Importance=Additional }

    { 77  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2";
                Importance=Additional }

    { 1000000020;2;Field  ;
                SourceExpr="Sell-to Address 3" }

    { 80  ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Importance=Additional }

    { 79  ;2   ;Field     ;
                SourceExpr="Sell-to City" }

    { 1500000;2;Field     ;
                SourceExpr="Sell-to County" }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Sell-to County/Country Code;
                           THA=ขายไปที่เขต/รหัสประเทศ];
                SourceExpr="Sell-to Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Sell-to Contact" }

    { 1000000016;2;Field  ;
                SourceExpr="Posting Description" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted }

    { 43  ;2   ;Field     ;
                SourceExpr="Document Date" }

    { 126 ;2   ;Field     ;
                SourceExpr="External Document No.";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 129 ;2   ;Field     ;
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 118 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 67  ;2   ;Field     ;
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 1000000018;2;Field  ;
                SourceExpr="PO No." }

    { 112 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 56  ;1   ;Part      ;
                Name=SalesLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page47 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 14  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             BilltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 132 ;2   ;Field     ;
                SourceExpr="Bill-to Contact No." }

    { 16  ;2   ;Field     ;
                SourceExpr="Bill-to Name" }

    { 18  ;2   ;Field     ;
                SourceExpr="Bill-to Address";
                Importance=Additional }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2";
                Importance=Additional }

    { 85  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Importance=Additional }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to City" }

    { 1500008;2;Field     ;
                SourceExpr="Bill-to County" }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Bill-to County/Country Code;
                           THA=เรียกเก็บเงินที่เขต/รหัสประเทศ];
                SourceExpr="Bill-to Country/Region Code" }

    { 24  ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Importance=Additional }

    { 1000000022;2;Field  ;
                SourceExpr="Posting No. Series" }

    { 84  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 88  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 26  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 28  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 30  ;2   ;Field     ;
                SourceExpr="Payment Discount %" }

    { 32  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 101 ;2   ;Field     ;
                SourceExpr="Payment Method Code" }

    { 121 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 156 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 166 ;2   ;Field     ;
                SourceExpr="Credit Card No." }

    { 164 ;2   ;Field     ;
                CaptionML=[ENU=Cr. Card Number (Last 4 Digits);
                           THA=หมายเลขบัตรเครดิต (4 ตัวหลังสุด)];
                SourceExpr=GetCreditcardNumber }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Importance=Promoted }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Importance=Additional }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Importance=Additional }

    { 93  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Importance=Promoted }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1500004;2;Field     ;
                SourceExpr="Ship-to County" }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code";
                Importance=Promoted }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Importance=Additional }

    { 90  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 46  ;2   ;Field     ;
                SourceExpr="Shipment Method Code" }

    { 103 ;2   ;Field     ;
                SourceExpr="Shipping Agent Code" }

    { 105 ;2   ;Field     ;
                SourceExpr="Package Tracking No.";
                Importance=Additional }

    { 48  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Importance=Promoted }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 107 ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 50  ;2   ;Field     ;
                SourceExpr="EU 3-Party Trade" }

    { 52  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 99  ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 54  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 95  ;2   ;Field     ;
                SourceExpr="Exit Point" }

    { 97  ;2   ;Field     ;
                SourceExpr=Area }

    { 1904409301;1;Group  ;
                CaptionML=[ENU=Application;
                           THA=การใช้] }

    { 1500013;2;Field     ;
                SourceExpr="Applies-to Doc. Type" }

    { 1500015;2;Field     ;
                SourceExpr="Applies-to Doc. No." }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000000;2;Field  ;
                SourceExpr="Sell-to Name (Thai)" }

    { 1000000001;2;Field  ;
                SourceExpr="Sell-to Address (Thai)";
                MultiLine=Yes }

    { 1000000002;2;Field  ;
                SourceExpr="Bill-to Name (Thai)" }

    { 1000000003;2;Field  ;
                SourceExpr="Bill-to Address (Thai)";
                MultiLine=Yes }

    { 1000000004;2;Field  ;
                SourceExpr="Ship-to Name (Thai)" }

    { 1000000005;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                MultiLine=Yes }

    { 1901533901;1;Group  ;
                CaptionML=[ENU=Remark;
                           THA=หมายเหตุ] }

    { 1000000012;2;Field  ;
                SourceExpr="Remark 1";
                MultiLine=Yes }

    { 1000000014;2;Field  ;
                SourceExpr="Remark 2";
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903720907;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9080;
                Visible=FALSE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubFormLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubFormLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9082;
                Visible=TRUE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9084;
                Visible=TRUE;
                PartType=Page }

    { 1906127307;1;Part   ;
                SubFormLink=Document Type=FIELD(Document Type),Document No.=FIELD(Document No.),Line No.=FIELD(Line No.);
                PagePartID=Page9087;
                ProviderID=56;
                Visible=FALSE;
                PartType=Page }

    { 1901314507;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9089;
                ProviderID=56;
                Visible=TRUE;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(36),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1907012907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9108;
                ProviderID=56;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesSetup@1000 : Record 311;
      ChangeExchangeRate@1001 : Form 511;
      CopySalesDoc@1002 : Report 292;
      MoveNegSalesLines@1006 : Report 6699;
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1004 : Codeunit 5700;
      SalesInfoPaneMgt@1005 : Codeunit 7171;
      SalesHistoryBtnVisible@19034839 : Boolean INDATASET;
      BillToCommentPictVisible@19001287 : Boolean INDATASET;
      BillToCommentBtnVisible@19078935 : Boolean INDATASET;
      SalesHistoryStnVisible@19031688 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateInfoPanel@2();
    VAR
      DifferSellToBillTo@1000 : Boolean;
    BEGIN
      DifferSellToBillTo := "Sell-to Customer No." <> "Bill-to Customer No.";
      SalesHistoryBtnVisible := DifferSellToBillTo;
      BillToCommentPictVisible := DifferSellToBillTo;
      BillToCommentBtnVisible := DifferSellToBillTo;
      SalesHistoryStnVisible := SalesInfoPaneMgt.DocExist(Rec,"Sell-to Customer No.");
      IF DifferSellToBillTo THEN
        SalesHistoryBtnVisible := SalesInfoPaneMgt.DocExist(Rec,"Bill-to Customer No.")
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.SalesLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SelltoCustomerNoOnAfterValidat@19034782();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE BilltoCustomerNoOnAfterValidat@19044114();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 44 Sales Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=12/21/11;
    Time=[ 5:03:35 PM];
    Modified=Yes;
    Version List=NAVW16.00.10,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Credit Memo;
               THA=ใบลดหนี้การขาย];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=FILTER(Credit Memo));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 IF UserMgt.GetSalesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetSalesFilter;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 49      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 THA=&ใบลดหนี้] }
      { 51      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Sales Statistics",Rec);
                               END;
                                }
      { 52      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 21;
                      RunFormLink=No.=FIELD(Sell-to Customer No.);
                      Image=EditLines }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=FIELD(Document Type),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 105     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 121     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 171     ;2   ;Separator  }
      { 172     ;2   ;Action    ;
                      CaptionML=[ENU=Credit Cards Transaction Lo&g Entries;
                                 THA=รายการบัน&ทึกธุรกรรมบัตรเครดิต];
                      RunObject=Page 829;
                      RunFormLink=Document Type=FIELD(Document Type),Document No.=FIELD(No.),Customer No.=FIELD(Bill-to Customer No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 58      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 114     ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 113     ;2   ;Separator  }
      { 150     ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Sales Header Apply",Rec);
                               END;
                                }
      { 126     ;2   ;Separator  }
      { 112     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=;
                      OnAction=VAR
                                 StdCustSalesCode@1000 : Record 172;
                               BEGIN
                                 StdCustSalesCode.InsertSalesLines(Rec);
                               END;
                                }
      { 128     ;2   ;Separator  }
      { 115     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopySalesDoc.SetSalesHeader(Rec);
                                 CopySalesDoc.RUNMODAL;
                                 CLEAR(CopySalesDoc);
                               END;
                                }
      { 56      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 THA=ย้ายบรรทัดที่มีค่าลบ];
                      OnAction=BEGIN
                                 CLEAR(MoveNegSalesLines);
                                 MoveNegSalesLines.SetSalesHeader(Rec);
                                 MoveNegSalesLines.RUNMODAL;
                                 MoveNegSalesLines.ShowDocument;
                               END;
                                }
      { 120     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Posted Doc&ument Lines to Reverse;
                                 THA=เรียกบรรทัดเอกสารที่ลงรายการบัญชี&ที่จะกลับรายการ];
                      Image=ReverseLines;
                      OnAction=BEGIN
                                 GetPstdDocLinesToRevere;
                               END;
                                }
      { 141     ;2   ;Separator  }
      { 139     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.SendSalesApprovalRequest(Rec) THEN;
                               END;
                                }
      { 140     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.CancelSalesApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 130     ;2   ;Separator  }
      { 122     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 123     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleaseSalesDoc@1001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การล&งรายการบัญชี] }
      { 60      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeader(Rec);
                               END;
                                }
      { 61      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ล&งรายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseHeader@1001 : Record 38;
                                 ApprovalMgt@1000 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Sales-Post (Yes/No)",Rec);
                               END;
                                }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseHeader@1001 : Record 38;
                                 ApprovalMgt@1000 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Sales-Post + Print",Rec);
                               END;
                                }
      { 63      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 THA=ลงรายการบัญชี&ชุดงาน];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Sales Credit Memos",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             SelltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 57  ;2   ;Field     ;
                SourceExpr="Sell-to Contact No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name" }

    { 65  ;2   ;Field     ;
                SourceExpr="Sell-to Address";
                Importance=Additional }

    { 67  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2";
                Importance=Additional }

    { 1000000012;2;Field  ;
                SourceExpr="Sell-to Address 3" }

    { 70  ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Importance=Additional }

    { 69  ;2   ;Field     ;
                SourceExpr="Sell-to City" }

    { 1500000;2;Field     ;
                SourceExpr="Sell-to County" }

    { 1500004;2;Field     ;
                SourceExpr="Sell-to Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Sell-to Contact" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted }

    { 39  ;2   ;Field     ;
                SourceExpr="Document Date" }

    { 54  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 104 ;2   ;Field     ;
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 107 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 119 ;2   ;Field     ;
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 110 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 1000000014;2;Field  ;
                SourceExpr="Applied-to Tax Invoice" }

    { 1000000016;2;Field  ;
                SourceExpr="Posting No. Series" }

    { 48  ;1   ;Part      ;
                Name=SalesLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page96 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 18  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             BilltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 124 ;2   ;Field     ;
                SourceExpr="Bill-to Contact No." }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Name" }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to Address";
                Importance=Additional }

    { 24  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2";
                Importance=Additional }

    { 75  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Importance=Additional }

    { 26  ;2   ;Field     ;
                SourceExpr="Bill-to City" }

    { 1500006;2;Field     ;
                SourceExpr="Bill-to County" }

    { 1500008;2;Field     ;
                CaptionML=[ENU=Bill-to County/Country Code;
                           THA=เรียกเก็บเงินที่เขต/รหัสประเทศ];
                SourceExpr="Bill-to Country/Region Code";
                Importance=Promoted }

    { 28  ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Importance=Additional }

    { 1500002;2;Field     ;
                SourceExpr="Tax Document Type";
                Importance=Promoted }

    { 74  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 78  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 131 ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 133 ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 135 ;2   ;Field     ;
                SourceExpr="Payment Discount %" }

    { 137 ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 142 ;2   ;Field     ;
                SourceExpr="Payment Method Code" }

    { 100 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 30  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 146 ;2   ;Field     ;
                SourceExpr="Credit Card No." }

    { 148 ;2   ;Field     ;
                CaptionML=[ENU=Cr. Card Number (Last 4 Digits);
                           THA=หมายเลขบัตรเครดิต (4 ตัวหลังสุด)];
                SourceExpr=GetCreditcardNumber }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Importance=Promoted }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Importance=Additional }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Importance=Additional }

    { 83  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Importance=Promoted }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1500010;2;Field     ;
                SourceExpr="Ship-to County" }

    { 1500012;2;Field     ;
                SourceExpr="Ship-to Country/Region Code" }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Importance=Additional }

    { 80  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 96  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Importance=Promoted }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 91  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 42  ;2   ;Field     ;
                SourceExpr="EU 3-Party Trade" }

    { 44  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 89  ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 46  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 85  ;2   ;Field     ;
                SourceExpr="Exit Point" }

    { 87  ;2   ;Field     ;
                SourceExpr=Area }

    { 1904409301;1;Group  ;
                CaptionML=[ENU=Application;
                           THA=การใช้] }

    { 14  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type" }

    { 16  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No." }

    { 94  ;2   ;Field     ;
                SourceExpr="Applies-to ID" }

    { 1902492201;1;Group  ;
                CaptionML=[ENU=Adjustment Details;
                           THA=รายละเอียดการปรับปรุง] }

    { 1500017;2;Field     ;
                SourceExpr=Adjustment }

    { 1500015;2;Field     ;
                SourceExpr="BAS Adjustment" }

    { 1500011;2;Field     ;
                SourceExpr="Adjustment Applies-to" }

    { 1500001;2;Field     ;
                SourceExpr="Reason Code" }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000000;2;Field  ;
                SourceExpr="Sell-to Name (Thai)" }

    { 1000000001;2;Field  ;
                SourceExpr="Sell-to Address (Thai)";
                MultiLine=Yes }

    { 1000000002;2;Field  ;
                SourceExpr="Bill-to Name (Thai)" }

    { 1000000003;2;Field  ;
                SourceExpr="Bill-to Address (Thai)";
                MultiLine=Yes }

    { 1000000004;2;Field  ;
                SourceExpr="Ship-to Name (Thai)" }

    { 1000000005;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                MultiLine=Yes }

    { 1901533901;1;Group  ;
                CaptionML=[ENU=Remark;
                           THA=หมายเหตุ] }

    { 1000000018;2;Field  ;
                SourceExpr="Remark 1";
                MultiLine=Yes }

    { 1000000019;2;Field  ;
                SourceExpr="Remark 2";
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903720907;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9080;
                Visible=FALSE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubFormLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9082;
                Visible=TRUE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9084;
                Visible=TRUE;
                PartType=Page }

    { 1906127307;1;Part   ;
                SubFormLink=Document Type=FIELD(Document Type),Document No.=FIELD(Document No.),Line No.=FIELD(Line No.);
                PagePartID=Page9087;
                ProviderID=48;
                Visible=FALSE;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(36),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1907012907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9108;
                ProviderID=48;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Salessetup@1001 : Record 311;
      ChangeExchangeRate@1002 : Form 511;
      CopySalesDoc@1003 : Report 292;
      MoveNegSalesLines@1008 : Report 6699;
      ReportPrint@1004 : Codeunit 228;
      UserMgt@1005 : Codeunit 5700;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.SalesLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SelltoCustomerNoOnAfterValidat@19034782();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE BilltoCustomerNoOnAfterValidat@19044114();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 45 Sales List
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW15.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Sales List;
               THA=รายการขาย];
    SourceTable=Table36;
    DataCaptionFields=Document Type;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 20      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      Image=EditLines;
                      OnAction=BEGIN
                                 CASE "Document Type" OF
                                   "Document Type"::Quote:
                                     FORM.RUN(FORM::"Sales Quote",Rec);
                                   "Document Type"::Order:
                                     FORM.RUN(FORM::"Sales Order",Rec);
                                   "Document Type"::Invoice:
                                     FORM.RUN(FORM::"Sales Invoice",Rec);
                                   "Document Type"::"Return Order":
                                     FORM.RUN(FORM::"Sales Return Order",Rec);
                                   "Document Type"::"Credit Memo":
                                     FORM.RUN(FORM::"Sales Credit Memo",Rec);
                                   "Document Type"::"Blanket Order":
                                     FORM.RUN(FORM::"Blanket Sales Order",Rec);
                                 END;
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1904702706;1 ;Action    ;
                      CaptionML=ENU=Sales Reservation Avail.;
                      RunObject=Report 209;
                      Promoted=No;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name" }

    { 17  ;2   ;Field     ;
                SourceExpr="External Document No." }

    { 33  ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                SourceExpr="Sell-to Country/Region Code";
                Visible=FALSE }

    { 41  ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr=Amount }

    { 1000000002;2;Field  ;
                SourceExpr="Amount Including VAT" }

    { 13  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Visible=FALSE }

    { 15  ;2   ;Field     ;
                SourceExpr="Bill-to Name";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr="Bill-to Country/Region Code";
                Visible=FALSE }

    { 159 ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Visible=FALSE }

    { 155 ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 153 ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 143 ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 139 ;2   ;Field     ;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 121 ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 119 ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Assigned User ID" }

    { 123 ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 11  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 46 Sales Order Subform
{
  OBJECT-PROPERTIES
  {
    Date=12/19/11;
    Time=10:34:14 AM;
    Version List=NAVW16.00.10,KITNA6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  Type := xRec.Type;
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveSalesLine@1000 : Codeunit 99000832;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReserveSalesLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReserveSalesLine.DeleteLine(Rec);
                     END;
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1900580804;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 THA=การมีอยู่ของสินค้าตาม] }
      { 1904522204;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 THA=รอบระยะเวลา];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(0);
                               END;
                                }
      { 1902056104;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 THA=ตัวแปร];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(1);
                               END;
                                }
      { 1900639404;3 ;Action    ;
                      CaptionML=[ENU=Location;
                                 THA=ที่ตั้ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(2);
                               END;
                                }
      { 1900186704;2 ;Action    ;
                      CaptionML=[ENU=Reservation Entries;
                                 THA=รายการจอง];
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowReservationEntries;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 THA=บรรทัด&การติดตามสินค้า];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _OpenItemTrackingLines;
                               END;
                                }
      { 1905617004;2 ;Action    ;
                      CaptionML=[ENU=Kit Lines;
                                 THA=บรรทัด Kit];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowKitLines;
                               END;
                                }
      { 1901633104;2 ;Action    ;
                      CaptionML=[ENU=Select Item Substitution;
                                 THA=เลือกสินค้าทดแทน];
                      Image=SelectItemSubstitution;
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowItemSub;
                               END;
                                }
      { 1902085804;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1903418704;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1907184504;2 ;Action    ;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 THA=การกำหนด&ค่าธรรมเนียมสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905403704;2 ;Action    ;
                      CaptionML=[ENU=Order &Promising;
                                 THA=การสัญญา&ว่าจะออกใบสั่ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _OrderPromisingLine;
                               END;
                                }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 1905623604;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Price;
                                 THA=ขอราคา];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ShowPrices
                               END;
                                }
      { 1901770504;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Li&ne Discount;
                                 THA=เรียกส่วนลด&ในบรรทัด];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ShowLineDisc
                               END;
                                }
      { 1901281504;2 ;Action    ;
                      CaptionML=[ENU=Re&fresh Kit BOM;
                                 THA=รีเ&ฟรช Kit BOM];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 RefreshKitLines;
                               END;
                                }
      { 1901741804;2 ;Action    ;
                      CaptionML=[ENU=E&xplode BOM;
                                 THA=ข&ยาย BOM];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ExplodeBOM;
                               END;
                                }
      { 1903099004;2 ;Action    ;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 THA=แทรกข้อความที่&ขยายเพิ่มเติม];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _InsertExtendedText(TRUE);
                               END;
                                }
      { 1905427504;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Reserve;
                                 THA=&สำรอง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowReservation;
                               END;
                                }
      { 1903502504;2 ;Action    ;
                      CaptionML=[ENU=Order &Tracking;
                                 THA=การ&ติดตามใบสั่ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ShowTracking;
                               END;
                                }
      { 1905968604;2 ;Action    ;
                      CaptionML=[ENU=Nonstoc&k Items;
                                 THA=สินค้าที่&ไม่มีในสต็อก];
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ShowNonstockItems;
                               END;
                                }
      { 1905926804;1 ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 THA=ใบ&สั่ง] }
      { 1903645604;2 ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 THA=กา&รฝากส่ง] }
      { 1907981104;3 ;Action    ;
                      CaptionML=[ENU=Purchase &Order;
                                 THA=ใบสั่งซื้&อ];
                      Image=Document;
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 OpenPurchOrderForm;
                               END;
                                }
      { 1903587004;2 ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 THA=ใบ&สั่งพิเศษ] }
      { 1903192904;3 ;Action    ;
                      CaptionML=[ENU=Purchase &Order;
                                 THA=ใบสั่งซื้&อ];
                      Image=Document;
                      OnAction=BEGIN
                                 //This functionality was copied from page #42. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 OpenSpecialPurchOrderForm;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 4   ;2   ;Field     ;
                SourceExpr="No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                               NoOnAfterValidate;
                           END;
                            }

    { 68  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             CrossReferenceNoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           InsertExtendedText(FALSE);
                         END;
                          }

    { 1136;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 130 ;2   ;Field     ;
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 132 ;2   ;Field     ;
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 104 ;2   ;Field     ;
                SourceExpr="Substitution Available";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="Purchasing Code";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 1000000006;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000008;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 78  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group" }

    { 1000000010;2;Field  ;
                SourceExpr="WHT Business Posting Group" }

    { 1000000012;2;Field  ;
                SourceExpr="WHT Product Posting Group" }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 1462000;2;Field     ;
                SourceExpr="Build Kit";
                Visible=FALSE;
                OnValidate=BEGIN
                             BuildKitOnAfterValidate;
                           END;
                            }

    { 26  ;2   ;Field     ;
                SourceExpr="Drop Shipment";
                Visible=FALSE }

    { 106 ;2   ;Field     ;
                SourceExpr="Special Order";
                Visible=FALSE }

    { 110 ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Location Code";
                OnValidate=BEGIN
                             LocationCodeOnAfterValidate;
                           END;
                            }

    { 114 ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Subscriber Contract No." }

    { 1000000002;2;Field  ;
                SourceExpr="Agent Customer No." }

    { 50  ;2   ;Field     ;
                SourceExpr=Reserve;
                Visible=FALSE;
                OnValidate=BEGIN
                             ReserveOnAfterValidate;
                           END;
                            }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                           END;
                            }

    { 48  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Reserved Quantity" }

    { 44  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code";
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValidate;
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 112 ;2   ;Field     ;
                Name=SalesPriceExist;
                CaptionML=[ENU=Sales Price Exists;
                           THA=มีราคาขายอยู่];
                SourceExpr=PriceExists;
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Unit Price" }

    { 76  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 116 ;2   ;Field     ;
                Name=SalesLineDiscExists;
                CaptionML=[ENU=Sales Line Disc. Exists;
                           THA=มีส่วนลดในบรรทัดการขาย];
                SourceExpr=LineDiscExists;
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 52  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 136 ;2   ;Field     ;
                SourceExpr="Prepayment %";
                Visible=FALSE }

    { 138 ;2   ;Field     ;
                SourceExpr="Prepmt. Line Amount";
                Visible=FALSE }

    { 140 ;2   ;Field     ;
                SourceExpr="Prepmt. Amt. Inv.";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 90  ;2   ;Field     ;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Ship" }

    { 20  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Quantity Shipped" }

    { 22  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Invoice" }

    { 24  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Quantity Invoiced" }

    { 142 ;2   ;Field     ;
                SourceExpr="Prepmt Amt to Deduct";
                Visible=FALSE }

    { 144 ;2   ;Field     ;
                SourceExpr="Prepmt Amt Deducted";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 5800;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 102 ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 82  ;2   ;Field     ;
                SourceExpr="Requested Delivery Date";
                Visible=FALSE }

    { 84  ;2   ;Field     ;
                SourceExpr="Promised Delivery Date";
                Visible=FALSE }

    { 86  ;2   ;Field     ;
                SourceExpr="Planned Delivery Date" }

    { 88  ;2   ;Field     ;
                SourceExpr="Planned Shipment Date" }

    { 100 ;2   ;Field     ;
                SourceExpr="Shipment Date";
                OnValidate=BEGIN
                             ShipmentDateOnAfterValidate;
                           END;
                            }

    { 92  ;2   ;Field     ;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 94  ;2   ;Field     ;
                SourceExpr="Shipping Agent Service Code";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                SourceExpr="Shipping Time";
                Visible=FALSE }

    { 134 ;2   ;Field     ;
                SourceExpr="Work Type Code";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Whse. Outstanding Qty. (Base)";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                SourceExpr="Outbound Whse. Handling Time";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="FA Posting Date";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Use Duplication List";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Duplicate in Depreciation Book";
                Visible=FALSE }

    { 108 ;2   ;Field     ;
                SourceExpr="Appl.-from Item Entry";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 146 ;2   ;Field     ;
                SourceExpr="Document No.";
                Visible=FALSE;
                Editable=FALSE }

    { 148 ;2   ;Field     ;
                SourceExpr="Line No.";
                Visible=FALSE;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      SalesHeader@1000 : Record 36;
      SalesPriceCalcMgt@1006 : Codeunit 7000;
      TransferExtendedText@1002 : Codeunit 378;
      SalesInfoPaneMgt@1001 : Codeunit 7171;
      KitManagement@1462000 : Codeunit 25000;
      ShortcutDimCode@1003 : ARRAY [8] OF Code[20];
      Text001@1004 : TextConst 'ENU=You can not use the Explode BOM function because a prepayment of the sales order has been invoiced.;THA=คุณไม่สามารถใช้ฟังก์ชัน Explode BOM ได้ เนื่องจากมีการออกใบแจ้งหนี้สำหรับการชำระเงินล่วงหน้าของใบสั่งขาย';
      ItemPanelVisible@19014573 : Boolean INDATASET;

    PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
    END;

    PROCEDURE CalcInvDisc@6();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      IF "Prepmt. Amt. Inv." <> 0 THEN
        ERROR(Text001);
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
    END;

    PROCEDURE OpenPurchOrderForm@4();
    VAR
      PurchHeader@1000 : Record 38;
      PurchOrder@1001 : Form 50;
    BEGIN
      TESTFIELD("Purchase Order No.");
      PurchHeader.SETRANGE("No.","Purchase Order No.");
      PurchOrder.SETTABLEVIEW(PurchHeader);
      PurchOrder.EDITABLE := FALSE;
      PurchOrder.RUN;
    END;

    PROCEDURE OpenSpecialPurchOrderForm@14();
    VAR
      PurchHeader@1001 : Record 38;
      PurchOrder@1000 : Form 50;
    BEGIN
      TESTFIELD("Special Order Purchase No.");
      PurchHeader.SETRANGE("No.","Special Order Purchase No.");
      PurchOrder.SETTABLEVIEW(PurchHeader);
      PurchOrder.EDITABLE := FALSE;
      PurchOrder.RUN;
    END;

    PROCEDURE _InsertExtendedText@19065029(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE InsertExtendedText@5(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE _ShowReservation@19004172();
    BEGIN
      FIND;
      Rec.ShowReservation;
    END;

    PROCEDURE ShowReservation@2();
    BEGIN
      FIND;
      Rec.ShowReservation;
    END;

    PROCEDURE _ItemAvailability@19008035(AvailabilityType@1000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE ItemAvailability@7(AvailabilityType@1000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE _ShowReservationEntries@19040018();
    BEGIN
      Rec.ShowReservationEntries(TRUE);
    END;

    PROCEDURE ShowReservationEntries@9();
    BEGIN
      Rec.ShowReservationEntries(TRUE);
    END;

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@8();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE _ShowItemSub@19058753();
    BEGIN
      Rec.ShowItemSub;
    END;

    PROCEDURE ShowItemSub@10();
    BEGIN
      Rec.ShowItemSub;
    END;

    PROCEDURE ShowNonstockItems@11();
    BEGIN
      Rec.ShowNonstock;
    END;

    PROCEDURE _OpenItemTrackingLines@19054693();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE ShowTracking@13();
    VAR
      TrackingForm@1000 : Form 99000822;
    BEGIN
      TrackingForm.SetSalesLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      Rec.ShowItemChargeAssgnt;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE ShowPrices@15();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLinePrice(SalesHeader,Rec);
    END;

    PROCEDURE ShowLineDisc@16();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLineLineDisc(SalesHeader,Rec);
    END;

    PROCEDURE _OrderPromisingLine@19045687();
    VAR
      OrderPromisingLine@1000 : TEMPORARY Record 99000880;
    BEGIN
      OrderPromisingLine.SETRANGE("Source Type","Document Type");
      OrderPromisingLine.SETRANGE("Source ID","Document No.");
      OrderPromisingLine.SETRANGE("Source Line No.","Line No.");
      FORM.RUNMODAL(FORM::"Order Promising Lines",OrderPromisingLine);
    END;

    PROCEDURE OrderPromisingLine@17();
    VAR
      OrderPromisingLine@1000 : TEMPORARY Record 99000880;
    BEGIN
      OrderPromisingLine.SETRANGE("Source Type","Document Type");
      OrderPromisingLine.SETRANGE("Source ID","Document No.");
      OrderPromisingLine.SETRANGE("Source Line No.","Line No.");
      FORM.RUNMODAL(FORM::"Order Promising Lines",OrderPromisingLine);
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@18();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE _ShowKitLines@19071122();
    BEGIN
      Rec.ShowKitLines;
    END;

    PROCEDURE ShowKitLines@1462000();
    BEGIN
      Rec.ShowKitLines;
    END;

    PROCEDURE RefreshKitLines@1462001();
    BEGIN
      Rec.RefreshKitSalesLines;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      ItemPanelVisible := Type = Type::Item;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;

      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("No." <> xRec."No.")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE CrossReferenceNoOnAfterValidat@19048248();
    BEGIN
      InsertExtendedText(FALSE);
    END;

    LOCAL PROCEDURE BuildKitOnAfterValidate@19045154();
    BEGIN
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE LocationCodeOnAfterValidate@19034787();
    BEGIN
      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("Location Code" <> xRec."Location Code")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE ReserveOnAfterValidate@19004502();
    BEGIN
      IF (Reserve = Reserve::Always) AND ("Outstanding Qty. (Base)" <> 0) THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    VAR
      UpdateIsDone@1001 : Boolean;
    BEGIN
      IF Type = Type::Item THEN
        CASE Reserve OF
          Reserve::Always:
            BEGIN
              CurrPage.SAVERECORD;
              AutoReserve;
              CurrPage.UPDATE(FALSE);
              UpdateIsDone := TRUE;
            END;
          Reserve::Optional:
            IF (Quantity < xRec.Quantity) AND (xRec.Quantity > 0) THEN BEGIN
              CurrPage.SAVERECORD;
              CurrPage.UPDATE(FALSE);
              UpdateIsDone := TRUE;
            END;
        END;

      IF (Type = Type::Item) AND
         ((Quantity <> xRec.Quantity) OR ("Build Kit")) AND
         NOT UpdateIsDone
      THEN
        CurrPage.UPDATE(TRUE);

      IF "Build Kit" THEN
        KitManagement.KitAutoReserve(Rec);
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;

      IF "Build Kit" THEN BEGIN
        CurrPage.SAVERECORD;
        KitManagement.KitAutoReserve(Rec);
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE ShipmentDateOnAfterValidate@19068710();
    BEGIN
      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("Shipment Date" <> xRec."Shipment Date")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;

      IF "Build Kit" THEN BEGIN
        CurrPage.SAVERECORD;
        KitManagement.KitAutoReserve(Rec);
        CurrPage.UPDATE(FALSE);
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 47 Sales Invoice Subform
{
  OBJECT-PROPERTIES
  {
    Date=12/19/11;
    Time=11:30:36 AM;
    Version List=NAVW16.00.10,KITNA6.00,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Invoice));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  Type := xRec.Type;
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveSalesLine@1000 : Codeunit 99000832;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReserveSalesLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReserveSalesLine.DeleteLine(Rec);
                     END;
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 1903079504;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get &Price;
                                 THA=&ขอราคา];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ShowPrices
                               END;
                                }
      { 1907415004;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Li&ne Discount;
                                 THA=เรียกส่วนลด&ในบรรทัด];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ShowLineDisc
                               END;
                                }
      { 1901281504;2 ;Action    ;
                      CaptionML=[ENU=Re&fresh Kit BOM;
                                 THA=รีเ&ฟรช Kit BOM];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 RefreshKitLines;
                               END;
                                }
      { 1903098604;2 ;Action    ;
                      CaptionML=[ENU=E&xplode BOM;
                                 THA=ข&ยาย BOM];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ExplodeBOM;
                               END;
                                }
      { 1900206204;2 ;Action    ;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 THA=แทรกข้อความที่&ขยายเพิ่มเติม];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _InsertExtendedText(TRUE);
                               END;
                                }
      { 1900545004;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get &Shipment Lines;
                                 THA=เรียก&บรรทัดการจัดส่ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 GetShipment;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1905427604;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 THA=การมีอยู่ของสินค้าตาม] }
      { 1900639404;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 THA=รอบระยะเวลา];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(0);
                               END;
                                }
      { 1904974904;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 THA=ตัวแปร];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(1);
                               END;
                                }
      { 1904945204;3 ;Action    ;
                      CaptionML=[ENU=Location;
                                 THA=ที่ตั้ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(2);
                               END;
                                }
      { 1904522204;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1900948904;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1907184504;2 ;Action    ;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 THA=การกำหนด&ค่าธรรมเนียมสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 THA=บรรทัด&การติดตามสินค้า];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _OpenItemTrackingLines;
                               END;
                                }
      { 1905617004;2 ;Action    ;
                      CaptionML=[ENU=Kit Lines;
                                 THA=บรรทัด Kit];
                      OnAction=BEGIN
                                 //This functionality was copied from page #43. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowKitLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 4   ;2   ;Field     ;
                SourceExpr="No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                               NoOnAfterValidate;
                           END;
                            }

    { 58  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             CrossReferenceNoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           InsertExtendedText(FALSE);
                         END;
                          }

    { 74  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 1000000006;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000008;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 14  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="WHT Business Posting Group";
                Visible=FALSE }

    { 1500002;2;Field     ;
                SourceExpr="WHT Product Posting Group";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 1462000;2;Field     ;
                SourceExpr="Build Kit";
                Visible=FALSE;
                OnValidate=BEGIN
                             BuildKitOnAfterValidate;
                           END;
                            }

    { 50  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 76  ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                           END;
                            }

    { 34  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code";
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValidate;
                           END;
                            }

    { 1000000000;2;Field  ;
                SourceExpr="Ads. Booking No." }

    { 1000000002;2;Field  ;
                SourceExpr="Ads. Booking Line No." }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 88  ;2   ;Field     ;
                CaptionML=[ENU=Sales Price Exists;
                           THA=มีราคาขายอยู่];
                SourceExpr=PriceExists;
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Unit Price" }

    { 64  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 90  ;2   ;Field     ;
                CaptionML=[ENU=Sales Line Disc. Exists;
                           THA=มีส่วนลดในบรรทัดการขาย];
                SourceExpr=LineDiscExists;
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 40  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 84  ;2   ;Field     ;
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 82  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 52  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 18  ;2   ;Field     ;
                SourceExpr="Job Task No.";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Job Contract Entry No.";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Work Type Code";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="FA Posting Date";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="Use Duplication List";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Duplicate in Depreciation Book";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Appl.-from Item Entry";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 104 ;2   ;Field     ;
                SourceExpr="Document No.";
                Visible=FALSE;
                Editable=FALSE }

    { 106 ;2   ;Field     ;
                SourceExpr="Line No.";
                Visible=FALSE;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      SalesHeader@1000 : Record 36;
      TransferExtendedText@1003 : Codeunit 378;
      SalesPriceCalcMgt@1005 : Codeunit 7000;
      SalesInfoPaneMgt@1001 : Codeunit 7171;
      ShortcutDimCode@1004 : ARRAY [8] OF Code[20];
      UpdateAllowedVar@1002 : Boolean;
      Text000@1006 : TextConst 'ENU=Unable to execute this function while in view only mode.;THA=ไม่สามารถใช้ฟังก์ชันนี้ขณะที่อยู่ในโหมดดูอย่างเดียว';
      ItemPanelVisible@19014573 : Boolean INDATASET;

    PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
    END;

    PROCEDURE CalcInvDisc@8();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
    END;

    PROCEDURE GetShipment@4();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Get Shipment",Rec);
    END;

    PROCEDURE _InsertExtendedText@19065029(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE InsertExtendedText@7(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE _ItemAvailability@19008035(AvailabilityType@1000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE ItemAvailability@9(AvailabilityType@1000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@11();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE _OpenItemTrackingLines@19054693();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      Rec.ShowItemChargeAssgnt;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE ShowPrices@15();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLinePrice(SalesHeader,Rec);
    END;

    PROCEDURE ShowLineDisc@16();
    BEGIN
      SalesHeader.GET("Document Type","Document No.");
      CLEAR(SalesPriceCalcMgt);
      SalesPriceCalcMgt.GetSalesLineLineDisc(SalesHeader,Rec);
    END;

    PROCEDURE SetUpdateAllowed@5(UpdateAllowed@1000 : Boolean);
    BEGIN
      UpdateAllowedVar:=UpdateAllowed;
    END;

    PROCEDURE UpdateAllowed@20() : Boolean;
    BEGIN
      IF UpdateAllowedVar = FALSE THEN BEGIN
        MESSAGE(Text000);
        EXIT(FALSE);
      END ELSE
        EXIT(TRUE);
    END;

    PROCEDURE _ShowKitLines@19071122();
    BEGIN
      Rec.ShowKitLines;
    END;

    PROCEDURE ShowKitLines@1462000();
    BEGIN
      Rec.ShowKitLines;
    END;

    PROCEDURE RefreshKitLines@1462001();
    BEGIN
      Rec.RefreshKitSalesLines;
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@2();
    BEGIN
      Rec.ShowLineComments;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      ItemPanelVisible := Type = Type::Item;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE CrossReferenceNoOnAfterValidat@19048248();
    BEGIN
      InsertExtendedText(FALSE);
    END;

    LOCAL PROCEDURE BuildKitOnAfterValidate@19045154();
    BEGIN
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 49 Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=11:34:29 AM;
    Version List=NAVW16.00.01,NAVAP5.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Quote;
               THA=ใบเสนอราคาซื้อ];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Quote));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 IF UserMgt.GetPurchasesFilter() <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter());
                   FILTERGROUP(0);
                 END;
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetPurchasesFilter();
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Quote;
                                 THA=เ&สนอราคา] }
      { 61      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Purchase Statistics",Rec);
                               END;
                                }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 26;
                      RunFormLink=No.=FIELD(Buy-from Vendor No.);
                      Image=EditLines }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=FIELD(Document Type),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 111     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 152     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1000000001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 64      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 144     ;2   ;Separator  }
      { 143     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=;
                      OnAction=VAR
                                 StdVendPurchCode@1000000001 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 146     ;2   ;Separator  }
      { 66      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                               END;
                                }
      { 138     ;2   ;Action    ;
                      CaptionML=[ENU=Archi&ve Document;
                                 THA=เก็&บถาวรเอกสาร];
                      OnAction=BEGIN
                                 ArchiveManagement.ArchivePurchDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 147     ;2   ;Separator  }
      { 153     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1000000001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.SendPurchaseApprovalRequest(Rec) THEN;
                               END;
                                }
      { 154     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1000000001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.CancelPurchaseApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 148     ;2   ;Separator  }
      { 118     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Image=ReleaseDoc;
                      OnAction=VAR
                                 ReleasePurchDoc@1000000001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 119     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleasePurchDoc@1000000001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 610     ;2   ;Separator  }
      { 135     ;2   ;Action    ;
                      CaptionML=[ENU=&Send BizTalk Rqst. for Purch. Quote;
                                 THA=&ส่งคำขอใบเสนอราคาซื้อ BizTalk];
                      OnAction=VAR
                                 BizTalkManagement@1000000001 : Codeunit 99008508;
                                 SalesHeader@1000000002 : Record 36;
                                 ApprovalMgt@1000000003 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   BizTalkManagement.SendReqforPurchQuote(Rec);
                               END;
                                }
      { 69      ;1   ;Action    ;
                      CaptionML=[ENU=Make &Order;
                                 THA=จัดทำ&ใบสั่งซื้อ];
                      Promoted=Yes;
                      Image=MakeOrder;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesHeader@1000000001 : Record 36;
                                 ApprovalMgt@1000000002 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Purch.-Quote to Order (Yes/No)",Rec);
                               END;
                                }
      { 70      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintPurchHeader(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             BuyfromVendorNoOnAfterValidate;
                           END;
                            }

    { 139 ;2   ;Field     ;
                SourceExpr="Buy-from Contact No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name" }

    { 72  ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Importance=Additional }

    { 74  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Importance=Additional }

    { 77  ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Importance=Additional }

    { 76  ;2   ;Field     ;
                SourceExpr="Buy-from City" }

    { 1500000;2;Field     ;
                SourceExpr="Buy-from County" }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Buy-from County/Country Code;
                           THA=ซื้อจากเขต/รหัสประเทศ];
                SourceExpr="Buy-from Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Buy-from Contact" }

    { 136 ;2   ;Field     ;
                SourceExpr="No. of Archived Versions";
                Importance=Additional }

    { 1000000000;2;Field  ;
                SourceExpr="PO Type" }

    { 12  ;2   ;Field     ;
                SourceExpr="Order Date";
                Importance=Promoted }

    { 19  ;2   ;Field     ;
                SourceExpr="Document Date" }

    { 110 ;2   ;Field     ;
                SourceExpr="Requested Receipt Date" }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor Order No." }

    { 16  ;2   ;Field     ;
                SourceExpr="Vendor Shipment No." }

    { 81  ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Importance=Additional }

    { 10  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 1102601000;2;Field  ;
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 113 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 68  ;2   ;Field     ;
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 107 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 58  ;1   ;Part      ;
                Name=PurchLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page97 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 20  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             PaytoVendorNoOnAfterValidate;
                           END;
                            }

    { 141 ;2   ;Field     ;
                SourceExpr="Pay-to Contact No." }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Name" }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to Address";
                Importance=Additional }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2";
                Importance=Additional }

    { 82  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Importance=Additional }

    { 28  ;2   ;Field     ;
                SourceExpr="Pay-to City" }

    { 1500012;2;Field     ;
                SourceExpr="Pay-to County" }

    { 1500014;2;Field     ;
                CaptionML=[ENU=Pay-to County/Country Code;
                           THA=เขต/รหัสประเทศที่ทำจ่าย];
                SourceExpr="Pay-to Country/Region Code" }

    { 30  ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Importance=Additional }

    { 85  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 87  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 32  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 34  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 36  ;2   ;Field     ;
                SourceExpr="Payment Discount %" }

    { 38  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 100 ;2   ;Field     ;
                SourceExpr="Payment Method Code" }

    { 91  ;2   ;Field     ;
                SourceExpr="On Hold" }

    { 116 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 150 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Address" }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2" }

    { 94  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code" }

    { 46  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1500004;2;Field     ;
                SourceExpr="Ship-to County" }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code" }

    { 48  ;2   ;Field     ;
                SourceExpr="Ship-to Contact" }

    { 89  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 50  ;2   ;Field     ;
                SourceExpr="Shipment Method Code" }

    { 52  ;2   ;Field     ;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 102 ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 54  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 98  ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 56  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 47  ;2   ;Field     ;
                SourceExpr="Entry Point" }

    { 96  ;2   ;Field     ;
                SourceExpr=Area }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1901138007;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1904651607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9094;
                Visible=TRUE;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubFormLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(38),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchSetup@1000000000 : Record 312;
      ChangeExchangeRate@1000000001 : Form 511;
      CopyPurchDoc@1000000002 : Report 492;
      DocPrint@1000000003 : Codeunit 229;
      UserMgt@1000000004 : Codeunit 5700;
      ArchiveManagement@1000000005 : Codeunit 5063;
      PurchInfoPaneMgmt@1000000006 : Codeunit 7181;
      PurchHistoryBtnVisible@19036652 : Boolean INDATASET;
      PayToCommentPictVisible@19020250 : Boolean INDATASET;
      PayToCommentBtnVisible@19034709 : Boolean INDATASET;
      PurchHistoryBtn1Visible@19028975 : Boolean INDATASET;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE UpdateInfoPanel@2();
    VAR
      DifferBuyFromPayTo@1000000000 : Boolean;
    BEGIN
      DifferBuyFromPayTo := "Buy-from Vendor No." <> "Pay-to Vendor No.";
      PurchHistoryBtnVisible := DifferBuyFromPayTo;
      PayToCommentPictVisible := DifferBuyFromPayTo;
      PayToCommentBtnVisible := DifferBuyFromPayTo;
      PurchHistoryBtn1Visible := PurchInfoPaneMgmt.DocExist(Rec,"Buy-from Vendor No.");
      IF DifferBuyFromPayTo THEN
        PurchHistoryBtnVisible := PurchInfoPaneMgmt.DocExist(Rec,"Pay-to Vendor No.")
    END;

    LOCAL PROCEDURE BuyfromVendorNoOnAfterValidate@19032492();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PaytoVendorNoOnAfterValidate@19048314();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 50 Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=12/12/11;
    Time=[ 2:50:39 PM];
    Version List=NAVW16.00.01,NAVAP5.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Order;
               THA=ใบสั่งซื้อ];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             "Ship-to Address (Thai)Editable" := TRUE;
             "Ship-to Name (Thai)Editable" := TRUE;
             "Pay-to Address (Thai)Editable" := TRUE;
             "Pay-to Name (Thai)Editable" := TRUE;
             BuyfromAddressThaiEditable := TRUE;
             "Buy-from Name (Thai)Editable" := TRUE;
             "Currency CodeEditable" := TRUE;
             TransactionSpecificationEditab := TRUE;
             AreaEditable := TRUE;
             "Entry PointEditable" := TRUE;
             "Transport MethodEditable" := TRUE;
             "Transaction TypeEditable" := TRUE;
             "Ship-to Address 3Editable" := TRUE;
             "Ship-to CountyEditable" := TRUE;
             "Promised Receipt DateEditable" := TRUE;
             "Requested Receipt DateEditable" := TRUE;
             "Lead Time CalculationEditable" := TRUE;
             InboundWhseHandlingTimeEditabl := TRUE;
             "Ship-to Post CodeEditable" := TRUE;
             "Location CodeEditable" := TRUE;
             "Sell-to Customer No.Editable" := TRUE;
             "Expected Receipt DateEditable" := TRUE;
             "Shipment Method CodeEditable" := TRUE;
             "Ship-to ContactEditable" := TRUE;
             "Ship-to CityEditable" := TRUE;
             "Ship-to Address 2Editable" := TRUE;
             "Ship-to AddressEditable" := TRUE;
             "Ship-to NameEditable" := TRUE;
             "Ship-to CodeEditable" := TRUE;
             "Invoice DescriptionEditable" := TRUE;
             "Pay-to Address 3Editable" := TRUE;
             "VAT Bus. Posting GroupEditable" := TRUE;
             "Pay-to CountyEditable" := TRUE;
             "Pay-to Contact No.Editable" := TRUE;
             "Prices Including VATEditable" := TRUE;
             "Payment Method CodeEditable" := TRUE;
             "Pay-to Post CodeEditable" := TRUE;
             "On HoldEditable" := TRUE;
             ShortcutDimension2CodeEditable := TRUE;
             ShortcutDimension1CodeEditable := TRUE;
             "Pmt. Discount DateEditable" := TRUE;
             "Payment Discount %Editable" := TRUE;
             "Due DateEditable" := TRUE;
             "Payment Terms CodeEditable" := TRUE;
             "Pay-to ContactEditable" := TRUE;
             "Pay-to CityEditable" := TRUE;
             "Pay-to Address 2Editable" := TRUE;
             "Pay-to AddressEditable" := TRUE;
             "Pay-to NameEditable" := TRUE;
             "Pay-to Vendor No.Editable" := TRUE;
             CalWHTforanyInvAmountEditable := TRUE;
             "Buy-from Address 3Editable" := TRUE;
             "Buy-from CountyEditable" := TRUE;
             "Buy-from Contact No.Editable" := TRUE;
             "Responsibility CenterEditable" := TRUE;
             "Purchaser CodeEditable" := TRUE;
             "Order Address CodeEditable" := TRUE;
             "Vendor Invoice No.Editable" := TRUE;
             "Vendor Shipment No.Editable" := TRUE;
             "Vendor Order No.Editable" := TRUE;
             "Document DateEditable" := TRUE;
             "Buy-from Post CodeEditable" := TRUE;
             "Order DateEditable" := TRUE;
             "Posting DateEditable" := TRUE;
             "Buy-from ContactEditable" := TRUE;
             "Buy-from CityEditable" := TRUE;
             "Buy-from Address 2Editable" := TRUE;
             "Buy-from AddressEditable" := TRUE;
             "Buy-from Vendor NameEditable" := TRUE;
             "Buy-from Vendor No.Editable" := TRUE;
             "No.Editable" := TRUE;
             VendorExchangeRateACYEditable := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF UserMgt.GetPurchasesFilter() <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter());
                   FILTERGROUP(0);
                 END;
                 PurchSetup.GET;
                 VendorExchangeRateACYEditable := PurchSetup."Enable Vendor GST Amount (ACY)";
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetPurchasesFilter();
                  OnAfterGetCurrRecord;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 61      ;1   ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 THA=ใบ&สั่ง] }
      { 63      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Purchase Order Statistics",Rec);
                               END;
                                }
      { 64      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 26;
                      RunFormLink=No.=FIELD(Buy-from Vendor No.);
                      Image=EditLines }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=FIELD(Document Type),No.=FIELD(No.);
                      Image=ViewComments }
      { 66      ;2   ;Action    ;
                      CaptionML=[ENU=Receipts;
                                 THA=ใบรับ];
                      RunObject=Page 145;
                      RunFormView=SORTING(Order No.);
                      RunFormLink=Order No.=FIELD(No.);
                      Image=PostedReceipts }
      { 67      ;2   ;Action    ;
                      CaptionML=[ENU=Invoices;
                                 THA=ใบแจ้งหนี้];
                      RunObject=Page 146;
                      RunFormView=SORTING(Order No.);
                      RunFormLink=Order No.=FIELD(No.);
                      Image=Invoice }
      { 205     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Invoices;
                                 THA=&ใบแจ้งหนี้สำหรับการชำระเงินล่วงหน้า];
                      RunObject=Page 146;
                      RunFormView=SORTING(Prepayment Order No.);
                      RunFormLink=Prepayment Order No.=FIELD(No.) }
      { 206     ;2   ;Action    ;
                      CaptionML=[ENU=Prepayment Credi&t Memos;
                                 THA=ใ&บลดหนี้การชำระเงินล่วงหน้า];
                      RunObject=Page 147;
                      RunFormView=SORTING(Prepayment Order No.);
                      RunFormLink=Prepayment Order No.=FIELD(No.) }
      { 129     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 220     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 181     ;2   ;Separator  }
      { 148     ;2   ;Action    ;
                      CaptionML=[ENU=Whse. Receipt Lines;
                                 THA=บรรทัดใบรับของคลังสินค้า];
                      RunObject=Page 7342;
                      RunFormView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunFormLink=Source Type=CONST(39),Source Subtype=FIELD(Document Type),Source No.=FIELD(No.) }
      { 180     ;2   ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 THA=&บรรทัดการย้ายเก็บ/การรับสินค้าคงคลัง];
                      RunObject=Page 5774;
                      RunFormView=SORTING(Source Document,Source No.,Location Code);
                      RunFormLink=Source Document=CONST(Purchase Order),Source No.=FIELD(No.) }
      { 182     ;2   ;Separator  }
      { 183     ;2   ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 THA=กา&รฝากส่ง] }
      { 184     ;3   ;Action    ;
                      CaptionML=[ENU=Get &Sales Order;
                                 THA=เรียกใบสั่ง&ขาย];
                      RunObject=Codeunit 76 }
      { 186     ;2   ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 THA=ใบ&สั่งพิเศษ] }
      { 187     ;3   ;Action    ;
                      CaptionML=[ENU=Get &Sales Order;
                                 THA=เรียกใบสั่ง&ขาย];
                      OnAction=VAR
                                 DistIntegration@1001 : Codeunit 5702;
                                 PurchHeader@1000 : Record 38;
                               BEGIN
                                 PurchHeader.COPY(Rec);
                                 DistIntegration.GetSpecialOrders(PurchHeader);
                                 Rec := PurchHeader;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 68      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 69      ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 190     ;2   ;Separator  }
      { 179     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 75      ;2   ;Separator  }
      { 70      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                               END;
                                }
      { 173     ;2   ;Action    ;
                      CaptionML=[ENU=Archi&ve Document;
                                 THA=เก็&บถาวรเอกสาร];
                      OnAction=BEGIN
                                 ArchiveManagement.ArchivePurchDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 142     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 THA=ย้ายบรรทัดที่มีค่าลบ];
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 189     ;2   ;Separator  }
      { 149     ;2   ;Action    ;
                      CaptionML=[ENU=Create &Whse. Receipt;
                                 THA=สร้างใบรับสินค้าของ&คลังสินค้า];
                      OnAction=VAR
                                 GetSourceDocInbound@1001 : Codeunit 5751;
                               BEGIN
                                 GetSourceDocInbound.CreateFromPurchOrder(Rec);

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 150     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away / Pick;
                                 THA=สร้างการย้ายเก็บ / การรับสินค้าคง&คลัง];
                      Promoted=Yes;
                      Image=CreateInventoryPickup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;

                                 IF NOT FIND('=><') THEN
                                   INIT;
                               END;
                                }
      { 74      ;2   ;Separator  }
      { 221     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.SendPurchaseApprovalRequest(Rec) THEN;
                               END;
                                }
      { 222     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.CancelPurchaseApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 73      ;2   ;Separator  }
      { 137     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 138     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 611     ;2   ;Separator  }
      { 170     ;2   ;Action    ;
                      CaptionML=[ENU=&Send BizTalk Purchase Order;
                                 THA=&ส่งใบสั่งซื้อ BizTalk];
                      OnAction=VAR
                                 BizTalkManagement@1000 : Codeunit 99008508;
                                 SalesHeader@1002 : Record 36;
                                 ApprovalMgt@1003 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   BizTalkManagement.SendPurchaseOrder(Rec);
                               END;
                                }
      { 195     ;2   ;Action    ;
                      CaptionML=[ENU=Send IC Purchase Order;
                                 THA=ส่งใบสั่งซื้อ IC];
                      OnAction=VAR
                                 ICInOutboxMgt@1000 : Codeunit 427;
                                 SalesHeader@1002 : Record 36;
                                 ApprovalMgt@1003 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   ICInOutboxMgt.SendPurchDoc(Rec,FALSE);
                               END;
                                }
      { 77      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การล&งรายการบัญชี] }
      { 78      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 79      ;2   ;Action    ;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 THA=ล&งรายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesHeader@1000 : Record 36;
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN BEGIN
                                   IF ApprovalMgt.TestPurchasePrepayment(Rec) THEN
                                     ERROR(STRSUBSTNO(Text001,"Document Type","No."))
                                   ELSE BEGIN
                                     IF ApprovalMgt.TestPurchasePayment(Rec) THEN BEGIN
                                       IF NOT CONFIRM(STRSUBSTNO(Text002,"Document Type","No."),TRUE) THEN
                                         EXIT
                                       ELSE
                                         CODEUNIT.RUN(CODEUNIT::"Purch.-Post (Yes/No)",Rec);
                                     END ELSE
                                       CODEUNIT.RUN(CODEUNIT::"Purch.-Post (Yes/No)",Rec);
                                   END;
                                 END;
                               END;
                                }
      { 80      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesHeader@1000 : Record 36;
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN BEGIN
                                   IF ApprovalMgt.TestPurchasePrepayment(Rec) THEN
                                     ERROR(STRSUBSTNO(Text001,"Document Type","No."))
                                   ELSE BEGIN
                                     IF ApprovalMgt.TestPurchasePayment(Rec) THEN BEGIN
                                       IF NOT CONFIRM(STRSUBSTNO(Text002,"Document Type","No."),TRUE) THEN
                                         EXIT
                                       ELSE
                                         CODEUNIT.RUN(CODEUNIT::"Purch.-Post + Print",Rec);
                                     END ELSE
                                       CODEUNIT.RUN(CODEUNIT::"Purch.-Post + Print",Rec);
                                   END;
                                 END;
                               END;
                                }
      { 81      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 THA=ลงรายการบัญชี&ชุดงาน];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purchase Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 201     ;2   ;Separator  }
      { 209     ;2   ;ActionGroup;
                      CaptionML=[ENU=Prepa&yment;
                                 THA=&การชำระเงินล่วงหน้า] }
      { 202     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Prepayment Test &Report;
                                 THA=รายงาน&ทดสอบการชำระเงินล่วงหน้า];
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeaderPrepmt(Rec);
                               END;
                                }
      { 203     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Invoice;
                                 THA=ล&งรายการบัญชีสำหรับใบแจ้งหนี้การชำระเงินล่วงหน้า];
                      OnAction=VAR
                                 SalesHeader@1003 : Record 36;
                                 ApprovalMgt@1002 : Codeunit 439;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtInvoiceYN(Rec,FALSE);
                               END;
                                }
      { 210     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Invoic&e;
                                 THA=ลงรายการบัญชีและ&พิมพ์ใบแจ้งหนี้ชำระเงินล่วงหน้า];
                      OnAction=VAR
                                 SalesHeader@1003 : Record 36;
                                 ApprovalMgt@1002 : Codeunit 439;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtInvoiceYN(Rec,TRUE);
                               END;
                                }
      { 204     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Prepayment &Credit Memo;
                                 THA=ลง&รายการบัญชีใบลดหนี้การชำระเงินล่วงหน้า];
                      OnAction=VAR
                                 SalesHeader@1003 : Record 36;
                                 ApprovalMgt@1002 : Codeunit 439;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtCrMemoYN(Rec,FALSE);
                               END;
                                }
      { 211     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and Print Prepmt. Cr. Mem&o;
                                 THA=ลงรายการบัญชีและ&พิมพ์ใบลดหนี้การชำระเงินล่วงหน้า];
                      OnAction=VAR
                                 SalesHeader@1003 : Record 36;
                                 ApprovalMgt@1002 : Codeunit 439;
                                 PurchPostYNPrepmt@1000 : Codeunit 445;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   PurchPostYNPrepmt.PostPrepmtCrMemoYN(Rec,TRUE);
                               END;
                                }
      { 1000000012;1 ;ActionGroup;
                      CaptionML=ENU=P&rint }
      { 1000000015;2 ;Action    ;
                      CaptionML=ENU=Purchase Order;
                      Image=Document;
                      OnAction=BEGIN
                                 TESTFIELD(Status,Status::Released);
                                 DocPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 1000000013;2 ;Action    ;
                      CaptionML=ENU=Account Payable Voucher;
                      OnAction=VAR
                                 PurchHeader@1000000000 : Record 38;
                               BEGIN
                                 //KKE : #002 +
                                 TESTFIELD(Status,Status::Released);
                                 PurchHeader.RESET;
                                 PurchHeader.SETRANGE("Document Type","Document Type");
                                 PurchHeader.SETRANGE("No.","No.");
                                 REPORT.RUN(REPORT::"Account Payable Voucher -Pre.",TRUE,FALSE,PurchHeader);
                                 //KKE : #002 -
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable="No.Editable";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                Editable="Buy-from Vendor No.Editable";
                OnValidate=BEGIN
                             BuyfromVendorNoOnAfterValidate;
                           END;
                            }

    { 174 ;2   ;Field     ;
                SourceExpr="Buy-from Contact No.";
                Editable="Buy-from Contact No.Editable" }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name";
                Editable="Buy-from Vendor NameEditable" }

    { 89  ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                Editable="Buy-from AddressEditable" }

    { 91  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Editable="Buy-from Address 2Editable" }

    { 1000000021;2;Field  ;
                SourceExpr="Buy-from Address 3";
                Editable="Buy-from Address 3Editable" }

    { 76  ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                Editable="Buy-from Post CodeEditable" }

    { 93  ;2   ;Field     ;
                SourceExpr="Buy-from City";
                Editable="Buy-from CityEditable" }

    { 1500000;2;Field     ;
                SourceExpr="Buy-from County";
                Editable="Buy-from CountyEditable" }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Buy-from County/Country Code;
                           THA=ซื้อจากเขต/รหัสประเทศ];
                SourceExpr="Buy-from Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Importance=Additional;
                Editable="Buy-from ContactEditable" }

    { 171 ;2   ;Field     ;
                SourceExpr="No. of Archived Versions";
                Importance=Additional }

    { 1000000014;2;Field  ;
                SourceExpr="Cal. WHT for any Inv. Amount";
                Editable=CalWHTforanyInvAmountEditable }

    { 1000000017;2;Field  ;
                SourceExpr="PO Type" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Editable="Posting DateEditable" }

    { 14  ;2   ;Field     ;
                SourceExpr="Order Date";
                Importance=Promoted;
                Editable="Order DateEditable" }

    { 49  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable="Document DateEditable" }

    { 237 ;2   ;Field     ;
                SourceExpr="Quote No.";
                Importance=Additional }

    { 16  ;2   ;Field     ;
                SourceExpr="Vendor Order No.";
                Editable="Vendor Order No.Editable" }

    { 18  ;2   ;Field     ;
                SourceExpr="Vendor Shipment No.";
                Editable="Vendor Shipment No.Editable" }

    { 20  ;2   ;Field     ;
                SourceExpr="Vendor Invoice No.";
                Editable="Vendor Invoice No.Editable" }

    { 96  ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Importance=Additional;
                Editable="Order Address CodeEditable" }

    { 10  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                Editable="Purchaser CodeEditable";
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 131 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable="Responsibility CenterEditable" }

    { 72  ;2   ;Field     ;
                SourceExpr="Assigned User ID";
                Importance=Additional }

    { 133 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 60  ;1   ;Part      ;
                Name=PurchLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page54 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                Editable="Pay-to Vendor No.Editable";
                OnValidate=BEGIN
                             PaytoVendorNoOnAfterValidate;
                           END;
                            }

    { 176 ;2   ;Field     ;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Editable="Pay-to Contact No.Editable" }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Editable="Pay-to NameEditable" }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Editable="Pay-to AddressEditable" }

    { 28  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Editable="Pay-to Address 2Editable" }

    { 1000000023;2;Field  ;
                SourceExpr="Pay-to Address 3";
                Editable="Pay-to Address 3Editable" }

    { 97  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Editable="Pay-to Post CodeEditable" }

    { 30  ;2   ;Field     ;
                SourceExpr="Pay-to City";
                Editable="Pay-to CityEditable" }

    { 1500004;2;Field     ;
                SourceExpr="Pay-to County";
                Editable="Pay-to CountyEditable" }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Pay-to County/Country Code;
                           THA=เขต/รหัสประเทศที่ทำจ่าย];
                SourceExpr="Pay-to Country/Region Code" }

    { 32  ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Importance=Additional;
                Editable="Pay-to ContactEditable" }

    { 1500012;2;Field     ;
                SourceExpr="Vendor Exchange Rate (ACY)";
                Editable=VendorExchangeRateACYEditable }

    { 1000000019;2;Field  ;
                SourceExpr="Invoice Description";
                Editable="Invoice DescriptionEditable" }

    { 100 ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=ShortcutDimension1CodeEditable;
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 102 ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=ShortcutDimension2CodeEditable;
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 34  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                Editable="Payment Terms CodeEditable" }

    { 36  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted;
                Editable="Due DateEditable" }

    { 38  ;2   ;Field     ;
                SourceExpr="Payment Discount %";
                Editable="Payment Discount %Editable" }

    { 40  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Editable="Pmt. Discount DateEditable" }

    { 117 ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Importance=Additional;
                Editable="Payment Method CodeEditable" }

    { 106 ;2   ;Field     ;
                SourceExpr="On Hold";
                Editable="On HoldEditable" }

    { 135 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                Editable="Prices Including VATEditable";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 191 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Editable="VAT Bus. Posting GroupEditable" }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable="Ship-to NameEditable" }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Importance=Additional;
                Editable="Ship-to AddressEditable" }

    { 46  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Importance=Additional;
                Editable="Ship-to Address 2Editable" }

    { 1000000025;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable="Ship-to Address 3Editable" }

    { 109 ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Importance=Additional;
                Editable="Ship-to Post CodeEditable" }

    { 48  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable="Ship-to CityEditable" }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County";
                Editable="Ship-to CountyEditable" }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code" }

    { 50  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable="Ship-to ContactEditable" }

    { 104 ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable="Location CodeEditable" }

    { 144 ;2   ;Field     ;
                SourceExpr="Inbound Whse. Handling Time";
                Importance=Additional;
                Editable=InboundWhseHandlingTimeEditabl }

    { 52  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Editable="Shipment Method CodeEditable" }

    { 146 ;2   ;Field     ;
                SourceExpr="Lead Time Calculation";
                Importance=Additional;
                Editable="Lead Time CalculationEditable" }

    { 127 ;2   ;Field     ;
                SourceExpr="Requested Receipt Date";
                Editable="Requested Receipt DateEditable" }

    { 139 ;2   ;Field     ;
                SourceExpr="Promised Receipt Date";
                Editable="Promised Receipt DateEditable" }

    { 54  ;2   ;Field     ;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted;
                Editable="Expected Receipt DateEditable" }

    { 87  ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Editable="Sell-to Customer No.Editable" }

    { 85  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Editable="Ship-to CodeEditable" }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 119 ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                Editable="Currency CodeEditable";
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 56  ;2   ;Field     ;
                SourceExpr="Transaction Type";
                Editable="Transaction TypeEditable" }

    { 115 ;2   ;Field     ;
                SourceExpr="Transaction Specification";
                Editable=TransactionSpecificationEditab }

    { 58  ;2   ;Field     ;
                SourceExpr="Transport Method";
                Editable="Transport MethodEditable" }

    { 111 ;2   ;Field     ;
                SourceExpr="Entry Point";
                Editable="Entry PointEditable" }

    { 113 ;2   ;Field     ;
                SourceExpr=Area;
                Editable=AreaEditable }

    { 1900201301;1;Group  ;
                CaptionML=[ENU=Prepayment;
                           THA=การชำระเงินล่วงหน้า] }

    { 197 ;2   ;Field     ;
                SourceExpr="Prepayment %";
                Importance=Promoted;
                OnValidate=BEGIN
                             Prepayment37OnAfterValidate;
                           END;
                            }

    { 199 ;2   ;Field     ;
                SourceExpr="Compress Prepayment" }

    { 215 ;2   ;Field     ;
                SourceExpr="Prepmt. Payment Terms Code" }

    { 212 ;2   ;Field     ;
                SourceExpr="Prepayment Due Date";
                Importance=Promoted }

    { 217 ;2   ;Field     ;
                SourceExpr="Prepmt. Payment Discount %" }

    { 196 ;2   ;Field     ;
                SourceExpr="Prepmt. Pmt. Discount Date" }

    { 207 ;2   ;Field     ;
                SourceExpr="Vendor Cr. Memo No." }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000000;2;Field  ;
                SourceExpr="Buy-from Name (Thai)";
                Editable="Buy-from Name (Thai)Editable" }

    { 1000000001;2;Field  ;
                SourceExpr="Buy-from Address (Thai)";
                Editable=BuyfromAddressThaiEditable;
                MultiLine=Yes }

    { 1000000004;2;Field  ;
                SourceExpr="Pay-to Name (Thai)";
                Editable="Pay-to Name (Thai)Editable" }

    { 1000000006;2;Field  ;
                SourceExpr="Pay-to Address (Thai)";
                Editable="Pay-to Address (Thai)Editable";
                MultiLine=Yes }

    { 1000000008;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable="Ship-to Name (Thai)Editable" }

    { 1000000010;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable="Ship-to Address (Thai)Editable";
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903326807;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9090;
                ProviderID=60;
                Visible=FALSE;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(38),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1904651607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9094;
                Visible=TRUE;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubFormLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchSetup@1000 : Record 312;
      ChangeExchangeRate@1001 : Form 511;
      CopyPurchDoc@1002 : Report 492;
      MoveNegPurchLines@1006 : Report 6698;
      ReportPrint@1003 : Codeunit 228;
      DocPrint@1004 : Codeunit 229;
      UserMgt@1005 : Codeunit 5700;
      ArchiveManagement@1007 : Codeunit 5063;
      Text001@1008 : TextConst 'ENU=There are non posted Prepayment Amounts on %1 %2.;THA=ไม่มียอดการชำระเงินล่วงหน้าที่ลงรายการบัญชีใน %1 %2';
      Text002@1010 : TextConst 'ENU=There are unpaid Prepayment Invoices related to %1 %2. Do you wish to continue?;THA=มีใบแจ้งหนี้สำหรับการชำระเงินล่วงหน้าที่ยังไม่ได้ชำระเงินเกี่ยวข้องกับ %1 %2 คุณต้องการทำต่อหรือไม่';
      PurchInfoPaneMgmt@1009 : Codeunit 7181;
      VendorExchangeRateACYEditable@19072589 : Boolean INDATASET;
      PurchHistoryBtnVisible@19036652 : Boolean INDATASET;
      PayToCommentPictVisible@19020250 : Boolean INDATASET;
      PayToCommentBtnVisible@19034709 : Boolean INDATASET;
      PurchHistoryBtn1Visible@19028975 : Boolean INDATASET;
      "No.Editable"@19005397 : Boolean INDATASET;
      "Buy-from Vendor No.Editable"@19007824 : Boolean INDATASET;
      "Buy-from Vendor NameEditable"@19076155 : Boolean INDATASET;
      "Buy-from AddressEditable"@19044866 : Boolean INDATASET;
      "Buy-from Address 2Editable"@19028049 : Boolean INDATASET;
      "Buy-from CityEditable"@19041989 : Boolean INDATASET;
      "Buy-from ContactEditable"@19013025 : Boolean INDATASET;
      "Posting DateEditable"@19008133 : Boolean INDATASET;
      "Order DateEditable"@19041498 : Boolean INDATASET;
      "Buy-from Post CodeEditable"@19077225 : Boolean INDATASET;
      "Document DateEditable"@19066404 : Boolean INDATASET;
      "Vendor Order No.Editable"@19014842 : Boolean INDATASET;
      "Vendor Shipment No.Editable"@19069116 : Boolean INDATASET;
      "Vendor Invoice No.Editable"@19046210 : Boolean INDATASET;
      "Order Address CodeEditable"@19065347 : Boolean INDATASET;
      "Purchaser CodeEditable"@19049936 : Boolean INDATASET;
      "Responsibility CenterEditable"@19002769 : Boolean INDATASET;
      "Buy-from Contact No.Editable"@19070061 : Boolean INDATASET;
      "Buy-from CountyEditable"@19051102 : Boolean INDATASET;
      "Buy-from Address 3Editable"@19068066 : Boolean INDATASET;
      CalWHTforanyInvAmountEditable@19016915 : Boolean INDATASET;
      "Pay-to Vendor No.Editable"@19039100 : Boolean INDATASET;
      "Pay-to NameEditable"@19001878 : Boolean INDATASET;
      "Pay-to AddressEditable"@19006358 : Boolean INDATASET;
      "Pay-to Address 2Editable"@19019610 : Boolean INDATASET;
      "Pay-to CityEditable"@19032691 : Boolean INDATASET;
      "Pay-to ContactEditable"@19048124 : Boolean INDATASET;
      "Payment Terms CodeEditable"@19002263 : Boolean INDATASET;
      "Due DateEditable"@19054989 : Boolean INDATASET;
      "Payment Discount %Editable"@19033662 : Boolean INDATASET;
      "Pmt. Discount DateEditable"@19031613 : Boolean INDATASET;
      ShortcutDimension1CodeEditable@19042831 : Boolean INDATASET;
      ShortcutDimension2CodeEditable@19012750 : Boolean INDATASET;
      "On HoldEditable"@19058110 : Boolean INDATASET;
      "Pay-to Post CodeEditable"@19068826 : Boolean INDATASET;
      "Payment Method CodeEditable"@19074465 : Boolean INDATASET;
      "Prices Including VATEditable"@19056436 : Boolean INDATASET;
      "Pay-to Contact No.Editable"@19024497 : Boolean INDATASET;
      "Pay-to CountyEditable"@19030690 : Boolean INDATASET;
      "VAT Bus. Posting GroupEditable"@19045290 : Boolean INDATASET;
      "Pay-to Address 3Editable"@19018597 : Boolean INDATASET;
      "Invoice DescriptionEditable"@19036852 : Boolean INDATASET;
      "Ship-to CodeEditable"@19068609 : Boolean INDATASET;
      "Ship-to NameEditable"@19016985 : Boolean INDATASET;
      "Ship-to AddressEditable"@19079345 : Boolean INDATASET;
      "Ship-to Address 2Editable"@19047538 : Boolean INDATASET;
      "Ship-to CityEditable"@19063178 : Boolean INDATASET;
      "Ship-to ContactEditable"@19023233 : Boolean INDATASET;
      "Shipment Method CodeEditable"@19044334 : Boolean INDATASET;
      "Expected Receipt DateEditable"@19051435 : Boolean INDATASET;
      "Sell-to Customer No.Editable"@19059229 : Boolean INDATASET;
      "Location CodeEditable"@19048234 : Boolean INDATASET;
      "Ship-to Post CodeEditable"@19021188 : Boolean INDATASET;
      InboundWhseHandlingTimeEditabl@19026196 : Boolean INDATASET;
      "Lead Time CalculationEditable"@19076952 : Boolean INDATASET;
      "Requested Receipt DateEditable"@19072782 : Boolean INDATASET;
      "Promised Receipt DateEditable"@19013884 : Boolean INDATASET;
      "Ship-to CountyEditable"@19069973 : Boolean INDATASET;
      "Ship-to Address 3Editable"@19050994 : Boolean INDATASET;
      "Transaction TypeEditable"@19058279 : Boolean INDATASET;
      "Transport MethodEditable"@19034103 : Boolean INDATASET;
      "Entry PointEditable"@19022103 : Boolean INDATASET;
      AreaEditable@19031616 : Boolean INDATASET;
      TransactionSpecificationEditab@19010997 : Boolean INDATASET;
      "Currency CodeEditable"@19053147 : Boolean INDATASET;
      "Buy-from Name (Thai)Editable"@19058255 : Boolean INDATASET;
      BuyfromAddressThaiEditable@19019751 : Boolean INDATASET;
      "Pay-to Name (Thai)Editable"@19078287 : Boolean INDATASET;
      "Pay-to Address (Thai)Editable"@19041915 : Boolean INDATASET;
      "Ship-to Name (Thai)Editable"@19076485 : Boolean INDATASET;
      "Ship-to Address (Thai)Editable"@19048789 : Boolean INDATASET;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE UpdateInfoPanel@2();
    VAR
      DifferBuyFromPayTo@1000 : Boolean;
    BEGIN
      DifferBuyFromPayTo := "Buy-from Vendor No." <> "Pay-to Vendor No.";
      PurchHistoryBtnVisible := DifferBuyFromPayTo;
      PayToCommentPictVisible := DifferBuyFromPayTo;
      PayToCommentBtnVisible := DifferBuyFromPayTo;
      PurchHistoryBtn1Visible := PurchInfoPaneMgmt.DocExist(Rec,"Buy-from Vendor No.");
      IF DifferBuyFromPayTo THEN
        PurchHistoryBtnVisible := PurchInfoPaneMgmt.DocExist(Rec,"Pay-to Vendor No.")
    END;

    PROCEDURE SetEditableForm@1000000001(AllowEdit@1000000000 : Boolean);
    BEGIN
      "No.Editable" := AllowEdit;
      "Buy-from Vendor No.Editable" := AllowEdit;
      "Buy-from Vendor NameEditable" := AllowEdit;
      "Buy-from AddressEditable" := AllowEdit;
      "Buy-from Address 2Editable" := AllowEdit;
      "Buy-from CityEditable" := AllowEdit;
      "Buy-from ContactEditable" := AllowEdit;
      "Posting DateEditable" := AllowEdit;
      "Order DateEditable" := AllowEdit;
      "Buy-from Post CodeEditable" := AllowEdit;
      "Document DateEditable" := AllowEdit;
      "Vendor Order No.Editable" := AllowEdit;
      "Vendor Shipment No.Editable" := AllowEdit;
      "Vendor Invoice No.Editable" := AllowEdit;
      "Order Address CodeEditable" := AllowEdit;
      "Purchaser CodeEditable" := AllowEdit;
      "Responsibility CenterEditable" := AllowEdit;
      "Buy-from Contact No.Editable" := AllowEdit;
      "Buy-from CountyEditable" := AllowEdit;
      //CurrForm."Buy-from Country Code".EDITABLE := AllowEdit;
      "Buy-from Address 3Editable" := AllowEdit;
      CalWHTforanyInvAmountEditable := AllowEdit;
      "Pay-to Vendor No.Editable" := AllowEdit;
      "Pay-to NameEditable" := AllowEdit;
      "Pay-to AddressEditable" := AllowEdit;
      "Pay-to Address 2Editable" := AllowEdit;
      "Pay-to CityEditable" := AllowEdit;
      "Pay-to ContactEditable" := AllowEdit;
      "Payment Terms CodeEditable" := AllowEdit;
      "Due DateEditable" := AllowEdit;
      "Payment Discount %Editable" := AllowEdit;
      "Pmt. Discount DateEditable" := AllowEdit;
      ShortcutDimension1CodeEditable := AllowEdit;
      ShortcutDimension2CodeEditable := AllowEdit;
      "On HoldEditable" := AllowEdit;
      "Pay-to Post CodeEditable" := AllowEdit;
      "Payment Method CodeEditable" := AllowEdit;
      "Prices Including VATEditable" := AllowEdit;
      "Pay-to Contact No.Editable" := AllowEdit;
      "Pay-to CountyEditable" := AllowEdit;
      //CurrForm."Pay-to Country Code".EDITABLE := AllowEdit;
      "VAT Bus. Posting GroupEditable" := AllowEdit;
      VendorExchangeRateACYEditable := AllowEdit;
      "Pay-to Address 3Editable" := AllowEdit;
      "Invoice DescriptionEditable" := AllowEdit;
      "Ship-to CodeEditable" := AllowEdit;
      "Ship-to NameEditable" := AllowEdit;
      "Ship-to AddressEditable" := AllowEdit;
      "Ship-to Address 2Editable" := AllowEdit;
      "Ship-to CityEditable" := AllowEdit;
      "Ship-to ContactEditable" := AllowEdit;
      "Shipment Method CodeEditable" := AllowEdit;
      "Expected Receipt DateEditable" := AllowEdit;
      "Sell-to Customer No.Editable" := AllowEdit;
      "Location CodeEditable" := AllowEdit;
      "Ship-to Post CodeEditable" := AllowEdit;
      InboundWhseHandlingTimeEditabl := AllowEdit;
      "Lead Time CalculationEditable" := AllowEdit;
      "Requested Receipt DateEditable" := AllowEdit;
      "Promised Receipt DateEditable" := AllowEdit;
      "Ship-to CountyEditable" := AllowEdit;
      //CurrForm."Ship-to Country Code".EDITABLE := AllowEdit;
      "Ship-to Address 3Editable" := AllowEdit;
      "Transaction TypeEditable" := AllowEdit;
      "Transport MethodEditable" := AllowEdit;
      "Entry PointEditable" := AllowEdit;
      AreaEditable := AllowEdit;
      TransactionSpecificationEditab := AllowEdit;
      "Currency CodeEditable" := AllowEdit;
      "Buy-from Name (Thai)Editable" := AllowEdit;
      BuyfromAddressThaiEditable := AllowEdit;
      "Pay-to Name (Thai)Editable" := AllowEdit;
      "Pay-to Address (Thai)Editable" := AllowEdit;
      "Ship-to Name (Thai)Editable" := AllowEdit;
      "Ship-to Address (Thai)Editable" := AllowEdit;
    END;

    LOCAL PROCEDURE BuyfromVendorNoOnAfterValidate@19032492();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PaytoVendorNoOnAfterValidate@19048314();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE Prepayment37OnAfterValidate@19040510();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditableForm(Status = Status::Open);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
      Burda
      002   08.06.2007   KKE   Add Print "Account Payable Voucher"
      003   29.08.2007   TSA   -Not allow user to editable when status is released.
    }
    END.
  }
}

OBJECT Page 51 Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=01/25/12;
    Time=[ 2:47:00 PM];
    Modified=Yes;
    Version List=NAVW16.00.01,NAVAP5.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Invoice;
               THA=ใบแจ้งหนี้การซื้อ];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Invoice));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             "Ship-to Address (Thai)Editable" := TRUE;
             "Ship-to Name (Thai)Editable" := TRUE;
             "Pay-to Address (Thai)Editable" := TRUE;
             "Pay-to Name (Thai)Editable" := TRUE;
             BuyfromAddressThaiEditable := TRUE;
             "Buy-from Name (Thai)Editable" := TRUE;
             "Applies-to Doc. No.Editable" := TRUE;
             "Applies-to Doc. TypeEditable" := TRUE;
             "Currency CodeEditable" := TRUE;
             TransactionSpecificationEditab := TRUE;
             AreaEditable := TRUE;
             "Entry PointEditable" := TRUE;
             "Transport MethodEditable" := TRUE;
             "Transaction TypeEditable" := TRUE;
             "Ship-to Address 3Editable" := TRUE;
             ShiptoCountryRegionCodeEditabl := TRUE;
             "Ship-to CountyEditable" := TRUE;
             "Ship-to Post CodeEditable" := TRUE;
             "Location CodeEditable" := TRUE;
             "Expected Receipt DateEditable" := TRUE;
             "Shipment Method CodeEditable" := TRUE;
             "Ship-to ContactEditable" := TRUE;
             "Ship-to CityEditable" := TRUE;
             "Ship-to Address 2Editable" := TRUE;
             "Ship-to AddressEditable" := TRUE;
             "Ship-to NameEditable" := TRUE;
             "Invoice DescriptionEditable" := TRUE;
             "Pay-to Address 3Editable" := TRUE;
             "VAT Bus. Posting GroupEditable" := TRUE;
             PaytoCountryRegionCodeEditable := TRUE;
             "Pay-to CountyEditable" := TRUE;
             "Pay-to Contact No.Editable" := TRUE;
             "Prices Including VATEditable" := TRUE;
             "Payment Method CodeEditable" := TRUE;
             "Pay-to Post CodeEditable" := TRUE;
             "On HoldEditable" := TRUE;
             ShortcutDimension2CodeEditable := TRUE;
             ShortcutDimension1CodeEditable := TRUE;
             "Pmt. Discount DateEditable" := TRUE;
             "Payment Discount %Editable" := TRUE;
             "Due DateEditable" := TRUE;
             "Payment Terms CodeEditable" := TRUE;
             "Pay-to ContactEditable" := TRUE;
             "Pay-to CityEditable" := TRUE;
             "Pay-to Address 2Editable" := TRUE;
             "Pay-to AddressEditable" := TRUE;
             "Pay-to NameEditable" := TRUE;
             "Pay-to Vendor No.Editable" := TRUE;
             CalWHTforanyInvAmountEditable := TRUE;
             "Buy-from Address 3Editable" := TRUE;
             BuyfromCountryRegionCodeEditab := TRUE;
             "Buy-from CountyEditable" := TRUE;
             "Buy-from Contact No.Editable" := TRUE;
             "Assigned User IDEditable" := TRUE;
             "Responsibility CenterEditable" := TRUE;
             "Purchaser CodeEditable" := TRUE;
             "Campaign No.Editable" := TRUE;
             "Order Address CodeEditable" := TRUE;
             "Vendor Invoice No.Editable" := TRUE;
             "Document DateEditable" := TRUE;
             "Buy-from Post CodeEditable" := TRUE;
             "Posting DateEditable" := TRUE;
             "Buy-from ContactEditable" := TRUE;
             "Buy-from CityEditable" := TRUE;
             "Buy-from Address 2Editable" := TRUE;
             "Buy-from AddressEditable" := TRUE;
             "Buy-from Vendor NameEditable" := TRUE;
             "Buy-from Vendor No.Editable" := TRUE;
             "No.Editable" := TRUE;
             VendorExchangeRateACYEditable := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
                   FILTERGROUP(0);
                 END;
                 PurchSetup.GET;
                 VendorExchangeRateACYEditable := PurchSetup."Enable Vendor GST Amount (ACY)";
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetPurchasesFilter;
                  OnAfterGetCurrRecord;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 55      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 THA=&ใบแจ้งหนี้] }
      { 57      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Purchase Statistics",Rec);
                               END;
                                }
      { 58      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 26;
                      RunFormLink=No.=FIELD(Buy-from Vendor No.);
                      Image=EditLines }
      { 59      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=FIELD(Document Type),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 113     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 141     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 60      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 61      ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 133     ;2   ;Separator  }
      { 132     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 136     ;2   ;Separator  }
      { 62      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                               END;
                                }
      { 112     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 THA=ย้ายบรรทัดที่มีค่าลบ];
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 137     ;2   ;Separator  }
      { 142     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.SendPurchaseApprovalRequest(Rec) THEN;
                               END;
                                }
      { 143     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.CancelPurchaseApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 144     ;2   ;Separator  }
      { 120     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 121     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 66      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การล&งรายการบัญชี] }
      { 67      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 68      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ล&งรายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesHeader@1000 : Record 36;
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Purch.-Post (Yes/No)",Rec);
                               END;
                                }
      { 69      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesHeader@1000 : Record 36;
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Purch.-Post + Print",Rec);
                               END;
                                }
      { 70      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 THA=ลงรายการบัญชี&ชุดงาน];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purchase Invoices",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000012;1 ;ActionGroup;
                      CaptionML=ENU=P&rint }
      { 1000000014;2 ;Action    ;
                      CaptionML=ENU=Account Payable Voucher;
                      OnAction=VAR
                                 PurchHeader@1000000000 : Record 38;
                               BEGIN
                                 //KKE : #002 +
                                 TESTFIELD(Status,Status::Released);
                                 PurchHeader.RESET;
                                 PurchHeader.SETRANGE("Document Type","Document Type");
                                 PurchHeader.SETRANGE("No.","No.");
                                 REPORT.RUN(REPORT::"Account Payable Voucher -Pre.",TRUE,FALSE,PurchHeader);
                                 //KKE : #002 -
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่งไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable="No.Editable";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                Editable="Buy-from Vendor No.Editable";
                OnValidate=BEGIN
                             BuyfromVendorNoOnAfterValidate;
                           END;
                            }

    { 128 ;2   ;Field     ;
                SourceExpr="Buy-from Contact No.";
                Editable="Buy-from Contact No.Editable" }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name";
                Editable="Buy-from Vendor NameEditable" }

    { 72  ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                Editable="Buy-from AddressEditable" }

    { 74  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Editable="Buy-from Address 2Editable" }

    { 1000000018;2;Field  ;
                SourceExpr="Buy-from Address 3";
                Editable="Buy-from Address 3Editable" }

    { 77  ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                Editable="Buy-from Post CodeEditable" }

    { 76  ;2   ;Field     ;
                SourceExpr="Buy-from City";
                Editable="Buy-from CityEditable" }

    { 1500000;2;Field     ;
                SourceExpr="Buy-from County";
                Editable="Buy-from CountyEditable" }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Buy-from County/Country Code;
                           THA=ซื้อจากเขต/รหัสประเทศ];
                SourceExpr="Buy-from Country/Region Code";
                Editable=BuyfromCountryRegionCodeEditab }

    { 8   ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Importance=Additional;
                Editable="Buy-from ContactEditable" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable="Posting DateEditable" }

    { 43  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable="Document DateEditable" }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor Invoice No.";
                Editable="Vendor Invoice No.Editable" }

    { 81  ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Editable="Order Address CodeEditable" }

    { 10  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                Editable="Purchaser CodeEditable";
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 1102601000;2;Field  ;
                SourceExpr="Campaign No.";
                Importance=Additional;
                Editable="Campaign No.Editable" }

    { 115 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable="Responsibility CenterEditable" }

    { 65  ;2   ;Field     ;
                SourceExpr="Assigned User ID";
                Editable="Assigned User IDEditable" }

    { 118 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 1000000013;2;Field  ;
                SourceExpr="Cal. WHT for any Inv. Amount";
                Editable=CalWHTforanyInvAmountEditable }

    { 54  ;1   ;Part      ;
                Name=PurchLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page55 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 16  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                Editable="Pay-to Vendor No.Editable";
                OnValidate=BEGIN
                             PaytoVendorNoOnAfterValidate;
                           END;
                            }

    { 130 ;2   ;Field     ;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Editable="Pay-to Contact No.Editable" }

    { 18  ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Editable="Pay-to NameEditable" }

    { 20  ;2   ;Field     ;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Editable="Pay-to AddressEditable" }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Editable="Pay-to Address 2Editable" }

    { 1000000020;2;Field  ;
                SourceExpr="Pay-to Address 3";
                Editable="Pay-to Address 3Editable" }

    { 82  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Editable="Pay-to Post CodeEditable" }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to City";
                Editable="Pay-to CityEditable" }

    { 1500008;2;Field     ;
                SourceExpr="Pay-to County";
                Editable="Pay-to CountyEditable" }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Pay-to County/Country Code;
                           THA=เขต/รหัสประเทศที่ทำจ่าย];
                SourceExpr="Pay-to Country/Region Code";
                Editable=PaytoCountryRegionCodeEditable }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Importance=Additional;
                Editable="Pay-to ContactEditable" }

    { 1500001;2;Field     ;
                SourceExpr="Vendor Exchange Rate (ACY)";
                Editable=VendorExchangeRateACYEditable }

    { 1000000016;2;Field  ;
                SourceExpr="Invoice Description";
                Editable="Invoice DescriptionEditable" }

    { 85  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=ShortcutDimension1CodeEditable;
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 87  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=ShortcutDimension2CodeEditable;
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 28  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                Editable="Payment Terms CodeEditable" }

    { 30  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted;
                Editable="Due DateEditable" }

    { 32  ;2   ;Field     ;
                SourceExpr="Payment Discount %";
                Editable="Payment Discount %Editable" }

    { 34  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Editable="Pmt. Discount DateEditable" }

    { 102 ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Editable="Payment Method CodeEditable" }

    { 91  ;2   ;Field     ;
                SourceExpr="On Hold";
                Editable="On HoldEditable" }

    { 108 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                Editable="Prices Including VATEditable";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 138 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Editable="VAT Bus. Posting GroupEditable" }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable="Ship-to NameEditable" }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable="Ship-to AddressEditable" }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable="Ship-to Address 2Editable" }

    { 1000000022;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable="Ship-to Address 3Editable" }

    { 94  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Editable="Ship-to Post CodeEditable" }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable="Ship-to CityEditable" }

    { 1500012;2;Field     ;
                SourceExpr="Ship-to County";
                Editable="Ship-to CountyEditable" }

    { 1500014;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code";
                Editable=ShiptoCountryRegionCodeEditabl }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable="Ship-to ContactEditable" }

    { 89  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable="Location CodeEditable" }

    { 46  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Editable="Shipment Method CodeEditable" }

    { 48  ;2   ;Field     ;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted;
                Editable="Expected Receipt DateEditable" }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 104 ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                Editable="Currency CodeEditable";
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 50  ;2   ;Field     ;
                SourceExpr="Transaction Type";
                Editable="Transaction TypeEditable" }

    { 100 ;2   ;Field     ;
                SourceExpr="Transaction Specification";
                Editable=TransactionSpecificationEditab }

    { 52  ;2   ;Field     ;
                SourceExpr="Transport Method";
                Editable="Transport MethodEditable" }

    { 96  ;2   ;Field     ;
                SourceExpr="Entry Point";
                Editable="Entry PointEditable" }

    { 98  ;2   ;Field     ;
                SourceExpr=Area;
                Editable=AreaEditable }

    { 1904409301;1;Group  ;
                CaptionML=[ENU=Application;
                           THA=การใช้] }

    { 1500009;2;Field     ;
                SourceExpr="Applies-to Doc. Type";
                Editable="Applies-to Doc. TypeEditable" }

    { 1500007;2;Field     ;
                SourceExpr="Applies-to Doc. No.";
                Editable="Applies-to Doc. No.Editable" }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000000;2;Field  ;
                SourceExpr="Buy-from Name (Thai)";
                Editable="Buy-from Name (Thai)Editable" }

    { 1000000001;2;Field  ;
                SourceExpr="Buy-from Address (Thai)";
                Editable=BuyfromAddressThaiEditable;
                MultiLine=Yes }

    { 1000000002;2;Field  ;
                SourceExpr="Pay-to Name (Thai)";
                Editable="Pay-to Name (Thai)Editable" }

    { 1000000003;2;Field  ;
                SourceExpr="Pay-to Address (Thai)";
                Editable="Pay-to Address (Thai)Editable";
                MultiLine=Yes }

    { 1000000008;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable="Ship-to Name (Thai)Editable" }

    { 1000000010;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable="Ship-to Address (Thai)Editable";
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(38),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1904651607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9094;
                Visible=TRUE;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubFormLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchSetup@1000 : Record 312;
      ChangeExchangeRate@1001 : Form 511;
      CopyPurchDoc@1002 : Report 492;
      MoveNegPurchLines@1005 : Report 6698;
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1004 : Codeunit 5700;
      PurchInfoPaneMgmt@1006 : Codeunit 7181;
      VendorExchangeRateACYEditable@19072589 : Boolean INDATASET;
      PurchHistoryBtnVisible@19036652 : Boolean INDATASET;
      PayToCommentPictVisible@19020250 : Boolean INDATASET;
      PayToCommentBtnVisible@19034709 : Boolean INDATASET;
      PurchHistoryBtn1Visible@19028975 : Boolean INDATASET;
      "No.Editable"@19005397 : Boolean INDATASET;
      "Buy-from Vendor No.Editable"@19007824 : Boolean INDATASET;
      "Buy-from Vendor NameEditable"@19076155 : Boolean INDATASET;
      "Buy-from AddressEditable"@19044866 : Boolean INDATASET;
      "Buy-from Address 2Editable"@19028049 : Boolean INDATASET;
      "Buy-from CityEditable"@19041989 : Boolean INDATASET;
      "Buy-from ContactEditable"@19013025 : Boolean INDATASET;
      "Posting DateEditable"@19008133 : Boolean INDATASET;
      "Buy-from Post CodeEditable"@19077225 : Boolean INDATASET;
      "Document DateEditable"@19066404 : Boolean INDATASET;
      "Vendor Invoice No.Editable"@19046210 : Boolean INDATASET;
      "Order Address CodeEditable"@19065347 : Boolean INDATASET;
      "Campaign No.Editable"@19055339 : Boolean INDATASET;
      "Purchaser CodeEditable"@19049936 : Boolean INDATASET;
      "Responsibility CenterEditable"@19002769 : Boolean INDATASET;
      "Assigned User IDEditable"@19001328 : Boolean INDATASET;
      "Buy-from Contact No.Editable"@19070061 : Boolean INDATASET;
      "Buy-from CountyEditable"@19051102 : Boolean INDATASET;
      BuyfromCountryRegionCodeEditab@19052130 : Boolean INDATASET;
      "Buy-from Address 3Editable"@19068066 : Boolean INDATASET;
      CalWHTforanyInvAmountEditable@19016915 : Boolean INDATASET;
      "Pay-to Vendor No.Editable"@19039100 : Boolean INDATASET;
      "Pay-to NameEditable"@19001878 : Boolean INDATASET;
      "Pay-to AddressEditable"@19006358 : Boolean INDATASET;
      "Pay-to Address 2Editable"@19019610 : Boolean INDATASET;
      "Pay-to CityEditable"@19032691 : Boolean INDATASET;
      "Pay-to ContactEditable"@19048124 : Boolean INDATASET;
      "Payment Terms CodeEditable"@19002263 : Boolean INDATASET;
      "Due DateEditable"@19054989 : Boolean INDATASET;
      "Payment Discount %Editable"@19033662 : Boolean INDATASET;
      "Pmt. Discount DateEditable"@19031613 : Boolean INDATASET;
      ShortcutDimension1CodeEditable@19042831 : Boolean INDATASET;
      ShortcutDimension2CodeEditable@19012750 : Boolean INDATASET;
      "On HoldEditable"@19058110 : Boolean INDATASET;
      "Pay-to Post CodeEditable"@19068826 : Boolean INDATASET;
      "Payment Method CodeEditable"@19074465 : Boolean INDATASET;
      "Prices Including VATEditable"@19056436 : Boolean INDATASET;
      "Pay-to Contact No.Editable"@19024497 : Boolean INDATASET;
      "Pay-to CountyEditable"@19030690 : Boolean INDATASET;
      PaytoCountryRegionCodeEditable@19031464 : Boolean INDATASET;
      "VAT Bus. Posting GroupEditable"@19045290 : Boolean INDATASET;
      "Pay-to Address 3Editable"@19018597 : Boolean INDATASET;
      "Invoice DescriptionEditable"@19036852 : Boolean INDATASET;
      "Ship-to NameEditable"@19016985 : Boolean INDATASET;
      "Ship-to AddressEditable"@19079345 : Boolean INDATASET;
      "Ship-to Address 2Editable"@19047538 : Boolean INDATASET;
      "Ship-to CityEditable"@19063178 : Boolean INDATASET;
      "Ship-to ContactEditable"@19023233 : Boolean INDATASET;
      "Shipment Method CodeEditable"@19044334 : Boolean INDATASET;
      "Expected Receipt DateEditable"@19051435 : Boolean INDATASET;
      "Location CodeEditable"@19048234 : Boolean INDATASET;
      "Ship-to Post CodeEditable"@19021188 : Boolean INDATASET;
      "Ship-to CountyEditable"@19069973 : Boolean INDATASET;
      ShiptoCountryRegionCodeEditabl@19011659 : Boolean INDATASET;
      "Ship-to Address 3Editable"@19050994 : Boolean INDATASET;
      "Transaction TypeEditable"@19058279 : Boolean INDATASET;
      "Transport MethodEditable"@19034103 : Boolean INDATASET;
      "Entry PointEditable"@19022103 : Boolean INDATASET;
      AreaEditable@19031616 : Boolean INDATASET;
      TransactionSpecificationEditab@19010997 : Boolean INDATASET;
      "Currency CodeEditable"@19053147 : Boolean INDATASET;
      "Applies-to Doc. TypeEditable"@19011431 : Boolean INDATASET;
      "Applies-to Doc. No.Editable"@19013011 : Boolean INDATASET;
      "Buy-from Name (Thai)Editable"@19058255 : Boolean INDATASET;
      BuyfromAddressThaiEditable@19019751 : Boolean INDATASET;
      "Pay-to Name (Thai)Editable"@19078287 : Boolean INDATASET;
      "Pay-to Address (Thai)Editable"@19041915 : Boolean INDATASET;
      "Ship-to Name (Thai)Editable"@19076485 : Boolean INDATASET;
      "Ship-to Address (Thai)Editable"@19048789 : Boolean INDATASET;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE UpdateInfoPanel@2();
    VAR
      DifferBuyFromPayTo@1000 : Boolean;
    BEGIN
      DifferBuyFromPayTo := "Buy-from Vendor No." <> "Pay-to Vendor No.";
      PurchHistoryBtnVisible := DifferBuyFromPayTo;
      PayToCommentPictVisible := DifferBuyFromPayTo;
      PayToCommentBtnVisible := DifferBuyFromPayTo;
      PurchHistoryBtn1Visible := PurchInfoPaneMgmt.DocExist(Rec,"Buy-from Vendor No.");
      IF DifferBuyFromPayTo THEN
        PurchHistoryBtnVisible := PurchInfoPaneMgmt.DocExist(Rec,"Pay-to Vendor No.")
    END;

    PROCEDURE SetEditableForm@1000000000(AllowEdit@1000000000 : Boolean);
    BEGIN
      "No.Editable" := AllowEdit;
      "Buy-from Vendor No.Editable" := AllowEdit;
      "Buy-from Vendor NameEditable" := AllowEdit;
      "Buy-from AddressEditable" := AllowEdit;
      "Buy-from Address 2Editable" := AllowEdit;
      "Buy-from CityEditable" := AllowEdit;
      "Buy-from ContactEditable" := AllowEdit;
      "Posting DateEditable" := AllowEdit;
      "Buy-from Post CodeEditable" := AllowEdit;
      "Document DateEditable" := AllowEdit;
      "Vendor Invoice No.Editable" := AllowEdit;
      "Order Address CodeEditable" := AllowEdit;
      "Campaign No.Editable" := AllowEdit;
      "Purchaser CodeEditable" := AllowEdit;
      "Responsibility CenterEditable" := AllowEdit;
      "Assigned User IDEditable" := AllowEdit;
      "Buy-from Contact No.Editable" := AllowEdit;
      "Buy-from CountyEditable" := AllowEdit;
      BuyfromCountryRegionCodeEditab := AllowEdit;
      "Buy-from Address 3Editable" := AllowEdit;
      CalWHTforanyInvAmountEditable := AllowEdit;
      "Pay-to Vendor No.Editable" := AllowEdit;
      "Pay-to NameEditable" := AllowEdit;
      "Pay-to AddressEditable" := AllowEdit;
      "Pay-to Address 2Editable" := AllowEdit;
      "Pay-to CityEditable" := AllowEdit;
      "Pay-to ContactEditable" := AllowEdit;
      "Payment Terms CodeEditable" := AllowEdit;
      "Due DateEditable" := AllowEdit;
      "Payment Discount %Editable" := AllowEdit;
      "Pmt. Discount DateEditable" := AllowEdit;
      ShortcutDimension1CodeEditable := AllowEdit;
      ShortcutDimension2CodeEditable := AllowEdit;
      "On HoldEditable" := AllowEdit;
      "Pay-to Post CodeEditable" := AllowEdit;
      "Payment Method CodeEditable" := AllowEdit;
      "Prices Including VATEditable" := AllowEdit;
      "Pay-to Contact No.Editable" := AllowEdit;
      "Pay-to CountyEditable" := AllowEdit;
      PaytoCountryRegionCodeEditable := AllowEdit;
      "VAT Bus. Posting GroupEditable" := AllowEdit;
      VendorExchangeRateACYEditable := AllowEdit;
      "Pay-to Address 3Editable" := AllowEdit;
      "Invoice DescriptionEditable" := AllowEdit;
      "Ship-to NameEditable" := AllowEdit;
      "Ship-to AddressEditable" := AllowEdit;
      "Ship-to Address 2Editable" := AllowEdit;
      "Ship-to CityEditable" := AllowEdit;
      "Ship-to ContactEditable" := AllowEdit;
      "Shipment Method CodeEditable" := AllowEdit;
      "Expected Receipt DateEditable" := AllowEdit;
      "Location CodeEditable" := AllowEdit;
      "Ship-to Post CodeEditable" := AllowEdit;
      "Ship-to CountyEditable" := AllowEdit;
      ShiptoCountryRegionCodeEditabl := AllowEdit;
      "Ship-to Address 3Editable" := AllowEdit;
      "Transaction TypeEditable" := AllowEdit;
      "Transport MethodEditable" := AllowEdit;
      "Entry PointEditable" := AllowEdit;
      AreaEditable := AllowEdit;
      TransactionSpecificationEditab := AllowEdit;
      "Currency CodeEditable" := AllowEdit;
      "Applies-to Doc. TypeEditable" := AllowEdit;
      "Applies-to Doc. No.Editable" := AllowEdit;
      "Buy-from Name (Thai)Editable" := AllowEdit;
      BuyfromAddressThaiEditable := AllowEdit;
      "Pay-to Name (Thai)Editable" := AllowEdit;
      "Pay-to Address (Thai)Editable" := AllowEdit;
      "Ship-to Name (Thai)Editable" := AllowEdit;
      "Ship-to Address (Thai)Editable" := AllowEdit;
    END;

    LOCAL PROCEDURE BuyfromVendorNoOnAfterValidate@19032492();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PaytoVendorNoOnAfterValidate@19048314();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      SetEditableForm(Status = Status::Open);  //KKE : #003
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
      Burda
      002   08.06.2007   KKE   Add Print "Account Payable Voucher"
      003   29.08.2007   TSA   -Not allow user to editable when status is released.
    }
    END.
  }
}

OBJECT Page 52 Purchase Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=12/23/11;
    Time=10:00:55 AM;
    Modified=Yes;
    Version List=NAVW16.00.01,NAVAP5.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Credit Memo;
               THA=ใบลดหนี้การซื้อ];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Credit Memo));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnInit=BEGIN
             VendorExchangeRateACYEditable := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
                   FILTERGROUP(0);
                 END;
                 PurchSetup.GET;
                 VendorExchangeRateACYEditable := PurchSetup."Enable Vendor GST Amount (ACY)";
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetPurchasesFilter;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 THA=&ใบลดหนี้] }
      { 49      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Purchase Statistics",Rec);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 26;
                      RunFormLink=No.=FIELD(Buy-from Vendor No.);
                      Image=EditLines }
      { 51      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=FIELD(Document Type),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 105     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 145     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 52      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 128     ;2   ;Separator  }
      { 93      ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Purchase Header Apply",Rec);
                               END;
                                }
      { 129     ;2   ;Separator  }
      { 127     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 131     ;2   ;Separator  }
      { 54      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                               END;
                                }
      { 114     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 THA=ย้ายบรรทัดที่มีค่าลบ];
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 143     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Posted Doc&ument Lines to Reverse;
                                 THA=เรียกบรรทัดเอกสารที่ลงรายการบัญชี&ที่จะกลับรายการ];
                      Image=ReverseLines;
                      OnAction=BEGIN
                                 GetPstdDocLinesToRevere;
                               END;
                                }
      { 132     ;2   ;Separator  }
      { 146     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.SendPurchaseApprovalRequest(Rec) THEN;
                               END;
                                }
      { 147     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.CancelPurchaseApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 144     ;2   ;Separator  }
      { 112     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 113     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การล&งรายการบัญชี] }
      { 58      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 59      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ล&งรายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesHeader@1000 : Record 36;
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Purch.-Post (Yes/No)",Rec);
                               END;
                                }
      { 60      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesHeader@1000 : Record 36;
                                 ApprovalMgt@1001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Purch.-Post + Print",Rec);
                               END;
                                }
      { 61      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 THA=ลงรายการบัญชี&ชุดงาน];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purch. Credit Memos",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000016;1 ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์] }
      { 1000000017;2 ;Action    ;
                      CaptionML=ENU=Account Payable Voucher;
                      OnAction=VAR
                                 PurchHeader@1000000000 : Record 38;
                               BEGIN
                                 //KKE : #002 +
                                 PurchHeader.RESET;
                                 PurchHeader.SETRANGE("Document Type","Document Type");
                                 PurchHeader.SETRANGE("No.","No.");
                                 REPORT.RUN(REPORT::"Account Payable Voucher -Pre.",TRUE,FALSE,PurchHeader);
                                 //KKE : #002 -
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             BuyfromVendorNoOnAfterValidate;
                           END;
                            }

    { 123 ;2   ;Field     ;
                SourceExpr="Buy-from Contact No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name" }

    { 63  ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Importance=Additional }

    { 65  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Importance=Additional }

    { 68  ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Importance=Additional }

    { 67  ;2   ;Field     ;
                SourceExpr="Buy-from City" }

    { 1500000;2;Field     ;
                SourceExpr="Buy-from County" }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Buy-from County/Country Code;
                           THA=ซื้อจากเขต/รหัสประเทศ];
                SourceExpr="Buy-from Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Importance=Additional }

    { 1000000002;2;Field  ;
                SourceExpr="Cal. WHT for any Inv. Amount" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted }

    { 39  ;2   ;Field     ;
                SourceExpr="Document Date" }

    { 115 ;2   ;Field     ;
                SourceExpr="Vendor Authorization No.";
                Importance=Promoted }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor Cr. Memo No." }

    { 72  ;2   ;Field     ;
                SourceExpr="Order Address Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Importance=Additional;
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 1102601000;2;Field  ;
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 107 ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 56  ;2   ;Field     ;
                SourceExpr="Assigned User ID" }

    { 101 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 46  ;1   ;Part      ;
                Name=PurchLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page98 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 20  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             PaytoVendorNoOnAfterValidate;
                           END;
                            }

    { 125 ;2   ;Field     ;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Name" }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to Address";
                Importance=Additional }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2";
                Importance=Additional }

    { 73  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Importance=Additional }

    { 28  ;2   ;Field     ;
                SourceExpr="Pay-to City" }

    { 1500004;2;Field     ;
                SourceExpr="Pay-to County" }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Pay-to County/Country Code;
                           THA=เขต/รหัสประเทศที่ทำจ่าย];
                SourceExpr="Pay-to Country/Region Code" }

    { 30  ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Importance=Additional }

    { 1500001;2;Field     ;
                SourceExpr="Vendor Exchange Rate (ACY)";
                Editable=VendorExchangeRateACYEditable }

    { 1000000014;2;Field  ;
                SourceExpr="Invoice Description" }

    { 76  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 78  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 16  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 18  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted }

    { 94  ;2   ;Field     ;
                SourceExpr="Payment Discount %" }

    { 139 ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional }

    { 110 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 141 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Address" }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2" }

    { 83  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code" }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code" }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Contact" }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County" }

    { 80  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 96  ;2   ;Field     ;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 91  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 42  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 89  ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 44  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 85  ;2   ;Field     ;
                SourceExpr="Entry Point" }

    { 87  ;2   ;Field     ;
                SourceExpr=Area }

    { 1904409301;1;Group  ;
                CaptionML=[ENU=Application;
                           THA=การใช้] }

    { 135 ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type" }

    { 137 ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No." }

    { 133 ;2   ;Field     ;
                SourceExpr="Applies-to ID" }

    { 1902492201;1;Group  ;
                CaptionML=[ENU=Adjustment Details;
                           THA=รายละเอียดการปรับปรุง] }

    { 1500018;2;Field     ;
                SourceExpr=Adjustment }

    { 1500016;2;Field     ;
                SourceExpr="BAS Adjustment" }

    { 1500014;2;Field     ;
                SourceExpr="Adjustment Applies-to" }

    { 1500011;2;Field     ;
                SourceExpr="Reason Code" }

    { 1903041301;1;Group  ;
                CaptionML=ENU=Address (Thai) }

    { 1000000000;2;Field  ;
                SourceExpr="Buy-from Name (Thai)" }

    { 1000000001;2;Field  ;
                SourceExpr="Buy-from Address (Thai)";
                MultiLine=Yes }

    { 1000000004;2;Field  ;
                SourceExpr="Pay-to Name (Thai)" }

    { 1000000005;2;Field  ;
                SourceExpr="Pay-to Address (Thai)";
                MultiLine=Yes }

    { 1000000010;2;Field  ;
                SourceExpr="Ship-to Name (Thai)" }

    { 1000000012;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(38),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 1904651607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9094;
                Visible=TRUE;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubFormLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchSetup@1000 : Record 312;
      ChangeExchangeRate@1001 : Form 511;
      CopyPurchDoc@1002 : Report 492;
      MoveNegPurchLines@1005 : Report 6698;
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1004 : Codeunit 5700;
      VendorExchangeRateACYEditable@19072589 : Boolean INDATASET;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE BuyfromVendorNoOnAfterValidate@19032492();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PaytoVendorNoOnAfterValidate@19048314();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
      Burda
      002   08.06.2007   KKE   Add Print "Account Payable Voucher"
    }
    END.
  }
}

OBJECT Page 53 Purchase List
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW15.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Purchase List;
               THA=รายการซื้อ];
    SourceTable=Table38;
    DataCaptionFields=Document Type;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 25      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      Image=EditLines;
                      OnAction=BEGIN
                                 CASE "Document Type" OF
                                   "Document Type"::Quote:
                                     FORM.RUN(FORM::"Purchase Quote",Rec);
                                   "Document Type"::"Blanket Order":
                                     FORM.RUN(FORM::"Blanket Purchase Order",Rec);
                                   "Document Type"::Order:
                                     FORM.RUN(FORM::"Purchase Order",Rec);
                                   "Document Type"::Invoice:
                                     FORM.RUN(FORM::"Purchase Invoice",Rec);
                                   "Document Type"::"Return Order":
                                     FORM.RUN(FORM::"Purchase Return Order",Rec);
                                   "Document Type"::"Credit Memo":
                                     FORM.RUN(FORM::"Purchase Credit Memo",Rec);
                                 END;
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1905111706;1 ;Action    ;
                      CaptionML=ENU=Purchase Reservation Avail.;
                      RunObject=Report 409;
                      Promoted=No;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No." }

    { 13  ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name" }

    { 15  ;2   ;Field     ;
                SourceExpr="Vendor Authorization No." }

    { 27  ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                SourceExpr="Buy-from Country/Region Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Visible=FALSE }

    { 163 ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Visible=FALSE }

    { 161 ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                SourceExpr="Pay-to Country/Region Code";
                Visible=FALSE }

    { 151 ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Visible=FALSE }

    { 147 ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 145 ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 135 ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 131 ;2   ;Field     ;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 113 ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE;
                OnLookup=BEGIN
                           DimMgt.LookupDimValueCodeNoUpdate(1);
                         END;
                          }

    { 111 ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE;
                OnLookup=BEGIN
                           DimMgt.LookupDimValueCodeNoUpdate(2);
                         END;
                          }

    { 115 ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 99  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 31  ;2   ;Field     ;
                SourceExpr="Assigned User ID" }

    { 11  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      DimMgt@1000000000 : Codeunit 408;

    BEGIN
    END.
  }
}

OBJECT Page 54 Purchase Order Subform
{
  OBJECT-PROPERTIES
  {
    Date=12/19/11;
    Time=11:27:18 AM;
    Version List=NAVW16.00.01,NAVAP6.00.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table39;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Order));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  Type := xRec.Type;
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReservePurchLine@1000 : Codeunit 99000834;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReservePurchLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReservePurchLine.DeleteLine(Rec);
                     END;
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1906421304;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 THA=การมีอยู่ของสินค้าตาม] }
      { 1902027204;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 THA=รอบระยะเวลา];
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ItemAvailability(0);
                               END;
                                }
      { 1901633104;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 THA=ตัวแปร];
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ItemAvailability(1);
                               END;
                                }
      { 1902479904;3 ;Action    ;
                      CaptionML=[ENU=Location;
                                 THA=ที่ตั้ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ItemAvailability(2);
                               END;
                                }
      { 1902085804;2 ;Action    ;
                      CaptionML=[ENU=Reservation Entries;
                                 THA=รายการจอง];
                      Image=ReservationLedger;
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ShowReservationEntries;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 THA=บรรทัด&การติดตามสินค้า];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _OpenItemTrackingLines;
                               END;
                                }
      { 1903984904;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1903079404;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1907184504;2 ;Action    ;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 THA=การกำหนด&ค่าธรรมเนียมสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 1901312904;2 ;Action    ;
                      CaptionML=[ENU=E&xplode BOM;
                                 THA=ข&ยาย BOM];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 ExplodeBOM;
                               END;
                                }
      { 1901313304;2 ;Action    ;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 THA=แทรกข้อความที่&ขยายเพิ่มเติม];
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _InsertExtendedText(TRUE);
                               END;
                                }
      { 1906391504;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Reserve;
                                 THA=&สำรอง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ShowReservation;
                               END;
                                }
      { 1903502504;2 ;Action    ;
                      CaptionML=[ENU=Order &Tracking;
                                 THA=การ&ติดตามใบสั่ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 ShowTracking;
                               END;
                                }
      { 1905926804;1 ;ActionGroup;
                      CaptionML=[ENU=O&rder;
                                 THA=ใบ&สั่ง] }
      { 1903621804;2 ;ActionGroup;
                      CaptionML=[ENU=Dr&op Shipment;
                                 THA=กา&รฝากส่ง] }
      { 1903563204;3 ;Action    ;
                      CaptionML=[ENU=Sales &Order;
                                 THA=ใบสั่ง&ขาย];
                      Image=Document;
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 OpenSalesOrderForm;
                               END;
                                }
      { 1903169104;2 ;ActionGroup;
                      CaptionML=[ENU=Speci&al Order;
                                 THA=ใบ&สั่งพิเศษ] }
      { 1901038504;3 ;Action    ;
                      CaptionML=[ENU=Sales &Order;
                                 THA=ใบสั่ง&ขาย];
                      Image=Document;
                      OnAction=BEGIN
                                 //This functionality was copied from page #50. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 OpenSpecOrderSalesOrderForm;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr="No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                               NoOnAfterValidate;
                           END;
                            }

    { 62  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             CrossReferenceNoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           InsertExtendedText(FALSE);
                         END;
                          }

    { 1108;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 104 ;2   ;Field     ;
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 106 ;2   ;Field     ;
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 1000000002;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000004;2;Field  ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="WHT Business Posting Group";
                Visible=FALSE }

    { 1500002;2;Field     ;
                SourceExpr="WHT Product Posting Group";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 80  ;2   ;Field     ;
                SourceExpr="Drop Shipment";
                Visible=FALSE }

    { 88  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 102 ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity }

    { 42  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Reserved Quantity" }

    { 36  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Direct Unit Cost" }

    { 28  ;2   ;Field     ;
                SourceExpr="Indirect Cost %";
                Visible=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Unit Price (LCY)";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 60  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 108 ;2   ;Field     ;
                SourceExpr="Prepayment %";
                Visible=FALSE }

    { 110 ;2   ;Field     ;
                SourceExpr="Prepmt. Line Amount";
                Visible=FALSE }

    { 112 ;2   ;Field     ;
                SourceExpr="Prepmt. Amt. Inv.";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Receive" }

    { 20  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Quantity Received" }

    { 22  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Invoice" }

    { 24  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Quantity Invoiced" }

    { 114 ;2   ;Field     ;
                SourceExpr="Prepmt Amt to Deduct";
                Visible=FALSE }

    { 116 ;2   ;Field     ;
                SourceExpr="Prepmt Amt Deducted";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 54  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 126 ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 128 ;2   ;Field     ;
                SourceExpr="Job Task No.";
                Visible=FALSE }

    { 130 ;2   ;Field     ;
                SourceExpr="Job Line Type";
                Visible=FALSE }

    { 132 ;2   ;Field     ;
                SourceExpr="Job Unit Price";
                Visible=FALSE }

    { 134 ;2   ;Field     ;
                SourceExpr="Job Line Amount";
                Visible=FALSE }

    { 136 ;2   ;Field     ;
                SourceExpr="Job Line Discount Amount";
                Visible=FALSE }

    { 138 ;2   ;Field     ;
                SourceExpr="Job Line Discount %";
                Visible=FALSE }

    { 140 ;2   ;Field     ;
                SourceExpr="Job Total Price";
                Visible=FALSE }

    { 142 ;2   ;Field     ;
                SourceExpr="Job Unit Price (LCY)";
                Visible=FALSE }

    { 144 ;2   ;Field     ;
                SourceExpr="Job Total Price (LCY)";
                Visible=FALSE }

    { 146 ;2   ;Field     ;
                SourceExpr="Job Line Amount (LCY)";
                Visible=FALSE }

    { 148 ;2   ;Field     ;
                SourceExpr="Job Line Disc. Amount (LCY)";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Requested Receipt Date";
                Visible=FALSE }

    { 90  ;2   ;Field     ;
                SourceExpr="Promised Receipt Date";
                Visible=FALSE }

    { 92  ;2   ;Field     ;
                SourceExpr="Planned Receipt Date" }

    { 100 ;2   ;Field     ;
                SourceExpr="Expected Receipt Date" }

    { 94  ;2   ;Field     ;
                SourceExpr="Order Date" }

    { 96  ;2   ;Field     ;
                SourceExpr="Lead Time Calculation";
                Visible=FALSE }

    { 84  ;2   ;Field     ;
                SourceExpr="Planning Flexibility";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Prod. Order No.";
                Visible=FALSE }

    { 86  ;2   ;Field     ;
                SourceExpr="Prod. Order Line No.";
                Visible=FALSE }

    { 64  ;2   ;Field     ;
                SourceExpr="Operation No.";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Work Center No.";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr=Finished;
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Whse. Outstanding Qty. (Base)";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                SourceExpr="Inbound Whse. Handling Time";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 78  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

  }
  CODE
  {
    VAR
      TransferExtendedText@1002 : Codeunit 378;
      ShortcutDimCode@1003 : ARRAY [8] OF Code[20];
      UpdateAllowedVar@1000 : Boolean;
      Text000@1001 : TextConst 'ENU=Unable to execute this function while in view only mode.;THA=ไม่สามารถใช้ฟังก์ชันนี้ขณะที่อยู่ในโหมดดูอย่างเดียว';
      PurchInfoPaneMgt@1006 : Codeunit 7181;
      PurchHeader@1005 : Record 38;
      PurchPriceCalcMgt@1004 : Codeunit 7010;
      Text001@1007 : TextConst 'ENU=You can not use the Explode BOM function because a prepayment of the purchase order has been invoiced.;THA=คุณไม่สามารถใช้ฟังก์ชัน Explode BOM ได้ เนื่องจากมีการออกใบแจ้งหนี้สำหรับการชำระเงินล่วงหน้าของใบสั่งซื้อ';

    PROCEDURE ApproveCalcInvDisc@7();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Disc. (Yes/No)",Rec);
    END;

    PROCEDURE CalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Calc.Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      IF "Prepmt. Amt. Inv." <> 0 THEN
        ERROR(Text001);
      CODEUNIT.RUN(CODEUNIT::"Purch.-Explode BOM",Rec);
    END;

    PROCEDURE OpenSalesOrderForm@5();
    VAR
      SalesHeader@1000 : Record 36;
      SalesOrder@1001 : Form 42;
    BEGIN
      TESTFIELD("Sales Order No.");
      SalesHeader.SETRANGE("No.","Sales Order No.");
      SalesOrder.SETTABLEVIEW(SalesHeader);
      SalesOrder.EDITABLE := FALSE;
      SalesOrder.RUN;
    END;

    PROCEDURE _InsertExtendedText@19065029(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.PurchCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertPurchExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE InsertExtendedText@6(Unconditionally@1000 : Boolean);
    BEGIN
      IF TransferExtendedText.PurchCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertPurchExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE _ShowReservation@19004172();
    BEGIN
      FIND;
      Rec.ShowReservation;
    END;

    PROCEDURE ShowReservation@2();
    BEGIN
      FIND;
      Rec.ShowReservation;
    END;

    PROCEDURE _ItemAvailability@19008035(AvailabilityType@1000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE ItemAvailability@8(AvailabilityType@1000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE _ShowReservationEntries@19040018();
    BEGIN
      Rec.ShowReservationEntries(TRUE);
    END;

    PROCEDURE ShowReservationEntries@9();
    BEGIN
      Rec.ShowReservationEntries(TRUE);
    END;

    PROCEDURE ShowTracking@10();
    VAR
      TrackingForm@1000 : Form 99000822;
    BEGIN
      TrackingForm.SetPurchLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@11();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      Rec.ShowItemChargeAssgnt;
    END;

    PROCEDURE _OpenItemTrackingLines@19054693();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE OpenSpecOrderSalesOrderForm@12();
    VAR
      SalesHeader@1000 : Record 36;
      SalesOrder@1001 : Form 42;
    BEGIN
      TESTFIELD("Special Order Sales No.");
      SalesHeader.SETRANGE("No.","Special Order Sales No.");
      SalesOrder.SETTABLEVIEW(SalesHeader);
      SalesOrder.EDITABLE := FALSE;
      SalesOrder.RUN;
    END;

    PROCEDURE UpdateForm@13(SetSaveRecord@1000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE SetUpdateAllowed@14(UpdateAllowed@1000 : Boolean);
    BEGIN
      UpdateAllowedVar:=UpdateAllowed;
    END;

    PROCEDURE UpdateAllowed@4() : Boolean;
    BEGIN
      IF UpdateAllowedVar = FALSE THEN BEGIN
        MESSAGE(Text000);
        EXIT(FALSE);
      END ELSE
        EXIT(TRUE);
    END;

    PROCEDURE ShowPrices@17();
    BEGIN
      PurchHeader.GET("Document Type","Document No.");
      CLEAR(PurchPriceCalcMgt);
      PurchPriceCalcMgt.GetPurchLinePrice(PurchHeader,Rec);
    END;

    PROCEDURE ShowLineDisc@16();
    BEGIN
      PurchHeader.GET("Document Type","Document No.");
      CLEAR(PurchPriceCalcMgt);
      PurchPriceCalcMgt.GetPurchLineLineDisc(PurchHeader,Rec);
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@15();
    BEGIN
      Rec.ShowLineComments;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE CrossReferenceNoOnAfterValidat@19048248();
    BEGIN
      InsertExtendedText(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 55 Purch. Invoice Subform
{
  OBJECT-PROPERTIES
  {
    Date=12/24/11;
    Time=[ 7:35:57 PM];
    Modified=Yes;
    Version List=NAVW16.00,NAVAP4.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table39;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Invoice));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  Type := xRec.Type;
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReservePurchLine@1000000000 : Codeunit 99000834;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReservePurchLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReservePurchLine.DeleteLine(Rec);
                     END;
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 1900205804;2 ;Action    ;
                      CaptionML=[ENU=E&xplode BOM;
                                 THA=ข&ยาย BOM];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 ExplodeBOM;
                               END;
                                }
      { 1903099004;2 ;Action    ;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 THA=แทรกข้อความที่&ขยายเพิ่มเติม];
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _InsertExtendedText(TRUE);
                               END;
                                }
      { 1901652204;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Get Receipt Lines;
                                 THA=&เรียกบรรทัดการรับ];
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 GetReceipt;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1904945204;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 THA=การมีอยู่ของสินค้าตาม] }
      { 1901092104;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 THA=รอบระยะเวลา];
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ItemAvailability(0);
                               END;
                                }
      { 1905427604;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 THA=ตัวแปร];
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ItemAvailability(1);
                               END;
                                }
      { 1907075804;3 ;Action    ;
                      CaptionML=[ENU=Location;
                                 THA=ที่ตั้ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ItemAvailability(2);
                               END;
                                }
      { 1904974904;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1901431304;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1907184504;2 ;Action    ;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 THA=การกำหนด&ค่าธรรมเนียมสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 THA=บรรทัด&การติดตามสินค้า];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 //This functionality was copied from page #51. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _OpenItemTrackingLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr="No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                               NoOnAfterValidate;
                           END;
                            }

    { 72  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             CrossReferenceNoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           InsertExtendedText(FALSE);
                         END;
                          }

    { 186 ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 84  ;2   ;Field     ;
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="WHT Absorb Base" }

    { 1000000000;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 1000000002;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000004;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 14  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group" }

    { 1500002;2;Field     ;
                SourceExpr="WHT Business Posting Group";
                Visible=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="WHT Product Posting Group";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 78  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 80  ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity }

    { 34  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Direct Unit Cost" }

    { 68  ;2   ;Field     ;
                SourceExpr="Indirect Cost %";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Unit Price (LCY)";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 48  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 42  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 38  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 90  ;2   ;Field     ;
                SourceExpr="Job Task No.";
                Visible=FALSE }

    { 86  ;2   ;Field     ;
                SourceExpr="Job Line Type";
                Visible=FALSE }

    { 92  ;2   ;Field     ;
                SourceExpr="Job Unit Price";
                Visible=FALSE }

    { 104 ;2   ;Field     ;
                SourceExpr="Job Line Amount";
                Visible=FALSE }

    { 108 ;2   ;Field     ;
                SourceExpr="Job Line Discount Amount";
                Visible=FALSE }

    { 106 ;2   ;Field     ;
                SourceExpr="Job Line Discount %";
                Visible=FALSE }

    { 94  ;2   ;Field     ;
                SourceExpr="Job Total Price";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                SourceExpr="Job Unit Price (LCY)";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                SourceExpr="Job Total Price (LCY)";
                Visible=FALSE }

    { 100 ;2   ;Field     ;
                SourceExpr="Job Line Amount (LCY)";
                Visible=FALSE }

    { 102 ;2   ;Field     ;
                SourceExpr="Job Line Disc. Amount (LCY)";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Prod. Order No.";
                Visible=FALSE }

    { 64  ;2   ;Field     ;
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Insurance No.";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Budgeted FA No.";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="FA Posting Type";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Depr. Acquisition Cost";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Duplicate in Depreciation Book";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                SourceExpr="Use Duplication List";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

  }
  CODE
  {
    VAR
      TransferExtendedText@1000000000 : Codeunit 378;
      ShortcutDimCode@1000000001 : ARRAY [8] OF Code[20];
      UpdateAllowedVar@1000000002 : Boolean;
      Text000@1000000003 : TextConst 'ENU=Unable to execute this function while in view only mode.;THA=ไม่สามารถใช้ฟังก์ชันนี้ขณะที่อยู่ในโหมดดูอย่างเดียว';
      PurchInfoPaneMgt@1000000004 : Codeunit 7181;
      PurchHeader@1000000005 : Record 38;
      PurchPriceCalcMgt@1000000006 : Codeunit 7010;

    PROCEDURE ApproveCalcInvDisc@7();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Disc. (Yes/No)",Rec);
    END;

    PROCEDURE CalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Calc.Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Explode BOM",Rec);
    END;

    PROCEDURE GetReceipt@4();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Get Receipt",Rec);
    END;

    PROCEDURE _InsertExtendedText@19065029(Unconditionally@1000000000 : Boolean);
    BEGIN
      IF TransferExtendedText.PurchCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertPurchExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE InsertExtendedText@6(Unconditionally@1000000000 : Boolean);
    BEGIN
      IF TransferExtendedText.PurchCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertPurchExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE _ItemAvailability@19008035(AvailabilityType@1000000000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE ItemAvailability@8(AvailabilityType@1000000000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@10();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      Rec.ShowItemChargeAssgnt;
    END;

    PROCEDURE _OpenItemTrackingLines@19054693();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000000000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE SetUpdateAllowed@2(UpdateAllowed@1000000000 : Boolean);
    BEGIN
      UpdateAllowedVar:=UpdateAllowed;
    END;

    PROCEDURE UpdateAllowed@5() : Boolean;
    BEGIN
      IF UpdateAllowedVar = FALSE THEN BEGIN
        MESSAGE(Text000);
        EXIT(FALSE);
      END ELSE
        EXIT(TRUE);
    END;

    PROCEDURE ShowPrices@15();
    BEGIN
      PurchHeader.GET("Document Type","Document No.");
      CLEAR(PurchPriceCalcMgt);
      PurchPriceCalcMgt.GetPurchLinePrice(PurchHeader,Rec);
    END;

    PROCEDURE ShowLineDisc@16();
    BEGIN
      PurchHeader.GET("Document Type","Document No.");
      CLEAR(PurchPriceCalcMgt);
      PurchPriceCalcMgt.GetPurchLineLineDisc(PurchHeader,Rec);
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@9();
    BEGIN
      Rec.ShowLineComments;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE CrossReferenceNoOnAfterValidat@19048248();
    BEGIN
      InsertExtendedText(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 61 Applied Customer Entries
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Applied Customer Entries;
               THA=รายการลูกค้าที่ใช้];
    SourceTable=Table21;
    DataCaptionExpr=Heading;
    PageType=List;
    OnOpenPage=BEGIN
                 RESET;

                 IF Rec."Entry No." <> 0 THEN BEGIN
                   CreateCustLedgEntry := Rec;
                   IF CreateCustLedgEntry."Document Type" = 0 THEN
                     Heading := Text000
                   ELSE
                     Heading := FORMAT(CreateCustLedgEntry."Document Type");
                   Heading := Heading + ' ' + CreateCustLedgEntry."Document No.";

                   FindApplnEntriesDtldtLedgEntry;
                   SETCURRENTKEY("Entry No.");
                   SETRANGE("Entry No.");

                   IF CreateCustLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                     "Entry No." := CreateCustLedgEntry."Closed by Entry No.";
                     MARK(TRUE);
                   END;

                   SETCURRENTKEY("Closed by Entry No.");
                   SETRANGE("Closed by Entry No.",CreateCustLedgEntry."Entry No.");
                   IF FIND('-') THEN
                     REPEAT
                       MARK(TRUE);
                     UNTIL NEXT = 0;

                   SETCURRENTKEY("Entry No.");
                   SETRANGE("Closed by Entry No.");
                 END;

                 MARKEDONLY(TRUE);
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=Reminder/Fin. Charge Entries;
                                 THA=รายการจดหมายเตือน/ค่าธรรมเนียมทางการเงิน];
                      RunObject=Page 444;
                      RunFormView=SORTING(Customer Entry No.);
                      RunFormLink=Customer Entry No.=FIELD(Entry No.) }
      { 32      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 544;
                      RunFormLink=Table ID=CONST(21),Entry No.=FIELD(Entry No.);
                      Image=Dimensions }
      { 35      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Detailed &Ledger Entries;
                                 THA=รายการบัญชี&แยกประเภทโดยละเอียด];
                      RunObject=Page 573;
                      RunFormView=SORTING(Cust. Ledger Entry No.,Posting Date);
                      RunFormLink=Cust. Ledger Entry No.=FIELD(Entry No.),Customer No.=FIELD(Customer No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 19      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 8   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000004;2;Field  ;
                SourceExpr="External Document No." }

    { 77  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE }

    { 75  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code";
                Visible=FALSE }

    { 73  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                SourceExpr="Currency Code" }

    { 33  ;2   ;Field     ;
                SourceExpr="Original Amount" }

    { 10  ;2   ;Field     ;
                SourceExpr=Amount }

    { 12  ;2   ;Field     ;
                SourceExpr="Closed by Amount" }

    { 28  ;2   ;Field     ;
                SourceExpr="Closed by Currency Code";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Closed by Currency Amount";
                AutoFormatType=1;
                AutoFormatExpr="Closed by Currency Code";
                Visible=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Transaction No." }

    { 1000000000;2;Field  ;
                SourceExpr="Applies-to ID" }

    { 25  ;2   ;Field     ;
                SourceExpr="User ID";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                SourceExpr="Source Code";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Entry No." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=Document;THA=เอกสาร';
      CreateCustLedgEntry@1000000001 : Record 21;
      Navigate@1000000002 : Form 344;
      Heading@1000000003 : Text[50];

    PROCEDURE FindApplnEntriesDtldtLedgEntry@1();
    VAR
      DtldCustLedgEntry1@1000000000 : Record 379;
      DtldCustLedgEntry2@1000000001 : Record 379;
    BEGIN
      DtldCustLedgEntry1.SETCURRENTKEY("Cust. Ledger Entry No.");
      DtldCustLedgEntry1.SETRANGE("Cust. Ledger Entry No.",CreateCustLedgEntry."Entry No.");
      DtldCustLedgEntry1.SETRANGE(Unapplied,FALSE);
      IF DtldCustLedgEntry1.FIND('-') THEN BEGIN
        REPEAT
          IF DtldCustLedgEntry1."Cust. Ledger Entry No." =
            DtldCustLedgEntry1."Applied Cust. Ledger Entry No."
          THEN BEGIN
            DtldCustLedgEntry2.INIT;
            DtldCustLedgEntry2.SETCURRENTKEY("Applied Cust. Ledger Entry No.","Entry Type");
            DtldCustLedgEntry2.SETRANGE(
              "Applied Cust. Ledger Entry No.",DtldCustLedgEntry1."Applied Cust. Ledger Entry No.");
            DtldCustLedgEntry2.SETRANGE("Entry Type",DtldCustLedgEntry2."Entry Type"::Application);
            DtldCustLedgEntry2.SETRANGE(Unapplied,FALSE);
            IF DtldCustLedgEntry2.FIND('-') THEN BEGIN
              REPEAT
                IF DtldCustLedgEntry2."Cust. Ledger Entry No." <>
                  DtldCustLedgEntry2."Applied Cust. Ledger Entry No."
                THEN BEGIN
                  SETCURRENTKEY("Entry No.");
                  SETRANGE("Entry No.",DtldCustLedgEntry2."Cust. Ledger Entry No.");
                  IF FIND('-') THEN
                    MARK(TRUE);
                END;
              UNTIL DtldCustLedgEntry2.NEXT = 0;
            END;
          END ELSE BEGIN
            SETCURRENTKEY("Entry No.");
            SETRANGE("Entry No.",DtldCustLedgEntry1."Applied Cust. Ledger Entry No.");
            IF FIND('-') THEN
              MARK(TRUE);
          END;
        UNTIL DtldCustLedgEntry1.NEXT = 0;
      END;
    END;

    PROCEDURE SetTempCustLedgEntry@2(NewTempCustLedgEntryNo@1000000000 : Integer);
    BEGIN
      IF NewTempCustLedgEntryNo <> 0 THEN BEGIN
        SETRANGE("Entry No.",NewTempCustLedgEntryNo);
        FIND('-');
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 96 Sales Cr. Memo Subform
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,NAVAP4.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Credit Memo));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  Type := xRec.Type;
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveSalesLine@1000000000 : Codeunit 99000832;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReserveSalesLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReserveSalesLine.DeleteLine(Rec);
                     END;
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 1904522204;2 ;Action    ;
                      CaptionML=[ENU=E&xplode BOM;
                                 THA=ข&ยาย BOM];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ExplodeBOM;
                               END;
                                }
      { 1902056104;2 ;Action    ;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 THA=แทรกข้อความที่&ขยายเพิ่มเติม];
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _InsertExtendedText(TRUE);
                               END;
                                }
      { 1901991804;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Return &Receipt Lines;
                                 THA=เรียกบรรทัด&การรับสินค้าส่งคืน];
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 GetReturnReceipt;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1907981204;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 THA=การมีอยู่ของสินค้าตาม] }
      { 1903587104;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 THA=รอบระยะเวลา];
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(0);
                               END;
                                }
      { 1903193004;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 THA=ตัวแปร];
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(1);
                               END;
                                }
      { 1901743104;3 ;Action    ;
                      CaptionML=[ENU=Location;
                                 THA=ที่ตั้ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(2);
                               END;
                                }
      { 1902740304;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1907838004;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1907184504;2 ;Action    ;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 THA=การกำหนด&ค่าธรรมเนียมสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 THA=บรรทัด&การติดตามสินค้า];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 //This functionality was copied from page #44. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _OpenItemTrackingLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr="No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                               NoOnAfterValidate;
                           END;
                            }

    { 34  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             CrossReferenceNoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           InsertExtendedText(FALSE);
                         END;
                          }

    { 46  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 1500000;2;Field     ;
                SourceExpr="WHT Business Posting Group";
                Visible=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1500002;2;Field     ;
                SourceExpr="WHT Product Posting Group";
                Visible=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 58  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="VAT Prod. Posting Group" }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 24  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 50  ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr=Reserve;
                Visible=FALSE;
                OnValidate=BEGIN
                             ReserveOnAfterValidate;
                           END;
                            }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                           END;
                            }

    { 26  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Reserved Quantity";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ShowReservationEntries(TRUE);
                              UpdateForm(TRUE);
                            END;
                             }

    { 22  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code";
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValidate;
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Unit Price" }

    { 92  ;2   ;Field     ;
                SourceExpr="Line Amount" }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 56  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 60  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 44  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 62  ;2   ;Field     ;
                SourceExpr="Work Type Code";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 5810;2   ;Field     ;
                SourceExpr="Appl.-from Item Entry";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

  }
  CODE
  {
    VAR
      TransferExtendedText@1000000000 : Codeunit 378;
      ShortcutDimCode@1000000001 : ARRAY [8] OF Code[20];
      UpdateAllowedVar@1000000002 : Boolean;
      Text000@1000000003 : TextConst 'ENU=Unable to execute this function while in view only mode.;THA=ไม่สามารถใช้ฟังก์ชันนี้ขณะที่อยู่ในโหมดดูอย่างเดียว';

    PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
    END;

    PROCEDURE CalcInvDisc@6();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
    END;

    PROCEDURE GetReturnReceipt@2();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Get Return Receipts",Rec);
    END;

    PROCEDURE _InsertExtendedText@19065029(Unconditionally@1000000000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE InsertExtendedText@5(Unconditionally@1000000000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE _ItemAvailability@19008035(AvailabilityType@1000000000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE ItemAvailability@7(AvailabilityType@1000000000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@8();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE _OpenItemTrackingLines@19054693();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      Rec.ShowItemChargeAssgnt;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000000000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE SetUpdateAllowed@4(UpdateAllowed@1000000000 : Boolean);
    BEGIN
      UpdateAllowedVar:=UpdateAllowed;
    END;

    PROCEDURE UpdateAllowed@9() : Boolean;
    BEGIN
      IF UpdateAllowedVar = FALSE THEN BEGIN
        MESSAGE(Text000);
        EXIT(FALSE);
      END ELSE
        EXIT(TRUE);
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@10();
    BEGIN
      Rec.ShowLineComments;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE CrossReferenceNoOnAfterValidat@19048248();
    BEGIN
      InsertExtendedText(FALSE);
    END;

    LOCAL PROCEDURE ReserveOnAfterValidate@19004502();
    BEGIN
      IF (Reserve = Reserve::Always) AND ("Outstanding Qty. (Base)" <> 0) THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 98 Purch. Cr. Memo Subform
{
  OBJECT-PROPERTIES
  {
    Date=12/25/11;
    Time=[ 7:41:40 AM];
    Modified=Yes;
    Version List=NAVW16.00,NAVAP4.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table39;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Credit Memo));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  Type := xRec.Type;
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReservePurchLine@1000000000 : Codeunit 99000834;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReservePurchLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReservePurchLine.DeleteLine(Rec);
                     END;
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 1903098704;2 ;Action    ;
                      CaptionML=[ENU=E&xplode BOM;
                                 THA=ข&ยาย BOM];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 ExplodeBOM;
                               END;
                                }
      { 1901742204;2 ;Action    ;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 THA=แทรกข้อความที่&ขยายเพิ่มเติม];
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _InsertExtendedText(TRUE);
                               END;
                                }
      { 1907528504;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Return &Shipment Lines;
                                 THA=เรียกบรร&ทัดการจัดส่งคืนสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 GetReturnShipment;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1903645704;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 THA=การมีอยู่ของสินค้าตาม] }
      { 1903587104;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 THA=รอบระยะเวลา];
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ItemAvailability(0);
                               END;
                                }
      { 1903193004;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 THA=ตัวแปร];
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ItemAvailability(1);
                               END;
                                }
      { 1900296704;3 ;Action    ;
                      CaptionML=[ENU=Location;
                                 THA=ที่ตั้ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ItemAvailability(2);
                               END;
                                }
      { 1902740304;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1902395304;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1907184504;2 ;Action    ;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 THA=การกำหนด&ค่าธรรมเนียมสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 THA=บรรทัด&การติดตามสินค้า];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 //This functionality was copied from page #52. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchLines.FORM.}
                                 _OpenItemTrackingLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr="No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                               NoOnAfterValidate;
                           END;
                            }

    { 72  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             CrossReferenceNoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           InsertExtendedText(FALSE);
                         END;
                          }

    { 82  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 78  ;2   ;Field     ;
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="WHT Absorb Base" }

    { 1000000000;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 1000000002;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000004;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 14  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group" }

    { 1500000;2;Field     ;
                SourceExpr="WHT Business Posting Group";
                Visible=FALSE }

    { 1500002;2;Field     ;
                SourceExpr="WHT Product Posting Group";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 56  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 38  ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity }

    { 36  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Direct Unit Cost" }

    { 24  ;2   ;Field     ;
                SourceExpr="Indirect Cost %";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="Unit Price (LCY)";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 52  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 54  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 42  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 88  ;2   ;Field     ;
                SourceExpr="Job Line Type" }

    { 86  ;2   ;Field     ;
                SourceExpr="Job Task No." }

    { 90  ;2   ;Field     ;
                SourceExpr="Job Unit Price" }

    { 92  ;2   ;Field     ;
                SourceExpr="Job Total Price" }

    { 94  ;2   ;Field     ;
                SourceExpr="Job Line Amount" }

    { 96  ;2   ;Field     ;
                SourceExpr="Job Line Discount Amount" }

    { 98  ;2   ;Field     ;
                SourceExpr="Job Line Discount %" }

    { 100 ;2   ;Field     ;
                SourceExpr="Job Unit Price (LCY)" }

    { 102 ;2   ;Field     ;
                SourceExpr="Job Total Price (LCY)" }

    { 104 ;2   ;Field     ;
                SourceExpr="Job Line Amount (LCY)" }

    { 106 ;2   ;Field     ;
                SourceExpr="Job Line Disc. Amount (LCY)" }

    { 40  ;2   ;Field     ;
                SourceExpr="Prod. Order No.";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Insurance No.";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Budgeted FA No.";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="FA Posting Type";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Depr. Acquisition Cost";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 64  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

  }
  CODE
  {
    VAR
      TransferExtendedText@1000000000 : Codeunit 378;
      ShortcutDimCode@1000000001 : ARRAY [8] OF Code[20];
      UpdateAllowedVar@1000000002 : Boolean;
      Text000@1000000003 : TextConst 'ENU=Unable to execute this function while in view only mode.;THA=ไม่สามารถใช้ฟังก์ชันนี้ขณะที่อยู่ในโหมดดูอย่างเดียว';

    PROCEDURE ApproveCalcInvDisc@6();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Disc. (Yes/No)",Rec);
    END;

    PROCEDURE CalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Calc.Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Explode BOM",Rec);
    END;

    PROCEDURE GetReturnShipment@2();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Purch.-Get Return Shipments",Rec);
    END;

    PROCEDURE _InsertExtendedText@19065029(Unconditionally@1000000000 : Boolean);
    BEGIN
      IF TransferExtendedText.PurchCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertPurchExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE InsertExtendedText@5(Unconditionally@1000000000 : Boolean);
    BEGIN
      IF TransferExtendedText.PurchCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertPurchExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE _ItemAvailability@19008035(AvailabilityType@1000000000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE ItemAvailability@7(AvailabilityType@1000000000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@8();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      Rec.ShowItemChargeAssgnt;
    END;

    PROCEDURE _OpenItemTrackingLines@19054693();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000000000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE SetUpdateAllowed@4(UpdateAllowed@1000000000 : Boolean);
    BEGIN
      UpdateAllowedVar:=UpdateAllowed;
    END;

    PROCEDURE UpdateAllowed@9() : Boolean;
    BEGIN
      IF UpdateAllowedVar = FALSE THEN BEGIN
        MESSAGE(Text000);
        EXIT(FALSE);
      END ELSE
        EXIT(TRUE);
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@10();
    BEGIN
      Rec.ShowLineComments;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE CrossReferenceNoOnAfterValidat@19048248();
    BEGIN
      InsertExtendedText(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 118 General Ledger Setup
{
  OBJECT-PROPERTIES
  {
    Date=12/23/11;
    Time=10:26:15 AM;
    Modified=Yes;
    Version List=NAVW15.00.01,NAVAP6.00.01,AVATHA4.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=General Ledger Setup;
               THA=การตั้งค่าบัญชีแยกประเภททั่วไป];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table98;
    PageType=Card;
    OnInit=BEGIN
             "BAS GST Division FactorEnable" := TRUE;
             "BAS Group CompanyEnable" := TRUE;
             BAStobeLodgedasaGroupEnable := TRUE;
             "AMAS SoftwareEnable" := TRUE;
           END;

    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
                 UpdateControls;
               END;

    OnAfterGetRecord=BEGIN
                       "AMAS SoftwareHideValue" := FALSE;
                       AMASSoftwareOnFormat;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 42      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 44      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change Global Dimensions;
                                 THA=เปลี่ยนมิติสากล];
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Change Global Dimensions");
                               END;
                                }
      { 2       ;2   ;Action    ;
                      CaptionML=[ENU=Change Payment &Tolerance;
                                 THA=เปลี่ยนแปลงค่าเ&ผื่อการชำระเงิน];
                      Image=ChangePaymentTolerance;
                      OnAction=VAR
                                 ChangePmtTol@1000000001 : Report 34;
                                 Currency@1000000002 : Record 4;
                               BEGIN
                                 Currency.INIT;
                                 ChangePmtTol.SetCurrency(Currency);
                                 ChangePmtTol.RUNMODAL;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 6   ;2   ;Field     ;
                SourceExpr="Allow Posting From" }

    { 8   ;2   ;Field     ;
                SourceExpr="Allow Posting To" }

    { 43  ;2   ;Field     ;
                SourceExpr="Register Time" }

    { 67  ;2   ;Field     ;
                SourceExpr="Local Address Format" }

    { 73  ;2   ;Field     ;
                SourceExpr="Local Cont. Addr. Format" }

    { 77  ;2   ;Field     ;
                SourceExpr="Inv. Rounding Precision (LCY)" }

    { 75  ;2   ;Field     ;
                SourceExpr="Inv. Rounding Type (LCY)" }

    { 55  ;2   ;Field     ;
                SourceExpr="Allow G/L Acc. Deletion Before" }

    { 60  ;2   ;Field     ;
                SourceExpr="Check G/L Account Usage" }

    { 14  ;2   ;Field     ;
                SourceExpr="EMU Currency" }

    { 18  ;2   ;Field     ;
                SourceExpr="LCY Code" }

    { 49  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Excl. VAT" }

    { 47  ;2   ;Field     ;
                SourceExpr="Adjust for Payment Disc." }

    { 21  ;2   ;Field     ;
                SourceExpr="Unrealized VAT" }

    { 86  ;2   ;Field     ;
                SourceExpr="Prepayment Unrealized VAT" }

    { 5   ;2   ;Field     ;
                SourceExpr="Max. VAT Difference Allowed" }

    { 3   ;2   ;Field     ;
                SourceExpr="VAT Rounding Type" }

    { 82  ;2   ;Field     ;
                SourceExpr="Bill-to/Sell-to VAT Calc." }

    { 84  ;2   ;Field     ;
                SourceExpr="Print VAT specification in LCY" }

    { 1904569201;1;Group  ;
                CaptionML=[ENU=Numbering;
                           THA=การกำหนดหมายเลข] }

    { 10  ;2   ;Field     ;
                SourceExpr="Bank Account Nos." }

    { 1900309501;1;Group  ;
                CaptionML=[ENU=Dimensions;
                           THA=มิติ] }

    { 40  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code" }

    { 38  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code" }

    { 36  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code" }

    { 34  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code" }

    { 32  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 3 Code" }

    { 30  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 4 Code" }

    { 28  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 5 Code" }

    { 26  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 6 Code" }

    { 23  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 7 Code" }

    { 22  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 8 Code" }

    { 1904488501;1;Group  ;
                CaptionML=[ENU=Reporting;
                           THA=การรายงาน] }

    { 12  ;2   ;Field     ;
                SourceExpr="Additional Reporting Currency" }

    { 16  ;2   ;Field     ;
                SourceExpr="VAT Exchange Rate Adjustment" }

    { 1904409301;1;Group  ;
                CaptionML=[ENU=Application;
                           THA=การใช้] }

    { 65  ;2   ;Field     ;
                SourceExpr="Appln. Rounding Precision" }

    { 72  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Tolerance Warning" }

    { 51  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Tolerance Posting" }

    { 62  ;2   ;Field     ;
                SourceExpr="Payment Discount Grace Period";
                OnValidate=VAR
                             PaymentToleranceMgt@1000000001 : Codeunit 426;
                           BEGIN
                             IF CONFIRM(Text001,TRUE) THEN
                               PaymentToleranceMgt.CalcGracePeriodCVLedgEntry("Payment Discount Grace Period");
                           END;
                            }

    { 80  ;2   ;Field     ;
                SourceExpr="Payment Tolerance Warning" }

    { 70  ;2   ;Field     ;
                SourceExpr="Payment Tolerance Posting" }

    { 63  ;2   ;Field     ;
                SourceExpr="Payment Tolerance %" }

    { 64  ;2   ;Field     ;
                SourceExpr="Max. Payment Tolerance Amount" }

    { 1500006;2;Field     ;
                SourceExpr="VAT Tolerance %" }

    { 1900857901;1;Group  ;
                CaptionML=[ENU=Local Functionalities;
                           THA=ฟังก์ชันเบื้องต้น] }

    { 1500002;2;Group     ;
                CaptionML=[ENU=AU Local Functionality;
                           THA=ฟังก์ชันเบื้องต้น AU] }

    { 1500022;3;Field     ;
                SourceExpr="BAS to be Lodged as a Group";
                Enabled=BAStobeLodgedasaGroupEnable }

    { 1500020;3;Field     ;
                SourceExpr="BAS Group Company";
                Enabled="BAS Group CompanyEnable" }

    { 1500015;3;Field     ;
                SourceExpr="Enable GST (Australia)";
                OnValidate=BEGIN
                             IF "Enable GST (Australia)" = FALSE THEN
                               IF NOT CONFIRM(Text1500000) THEN
                                 "Enable GST (Australia)" := xRec."Enable GST (Australia)";
                             "Adjustment Mandatory" := "Enable GST (Australia)";
                               EnableGSTAustraliaOnAfterValidate;
                           END;
                            }

    { 1500005;3;Field     ;
                SourceExpr="Adjustment Mandatory" }

    { 1500018;3;Field     ;
                SourceExpr="BAS GST Division Factor";
                Enabled="BAS GST Division FactorEnable" }

    { 1500003;3;Field     ;
                SourceExpr="BarCode Custom Information" }

    { 1500000;3;Field     ;
                SourceExpr="Address Validation";
                OnValidate=BEGIN
                             AddressValidationOnAfterValidate;
                           END;
                            }

    { 1500008;3;Field     ;
                SourceExpr="AMAS Software";
                Enabled="AMAS SoftwareEnable";
                HideValue="AMAS SoftwareHideValue";
                OnLookup=BEGIN
                           Object.SETRANGE(Type,Object.Type::Codeunit);
                           Object.FIND('-');
                           IF "AMAS SoftwareEditable" THEN
                             IF FORM.RUNMODAL(28001,Object)=ACTION::LookupOK THEN
                               "AMAS Software":=Object.ID;
                         END;
                          }

    { 1500012;2;Group     ;
                CaptionML=[ENU=APAC Local Functionality;
                           THA=ฟังก์ชันเบื้องต้น APAC] }

    { 1500025;3;Field     ;
                SourceExpr="Manual Sales WHT Calc." }

    { 1500016;3;Field     ;
                SourceExpr="Post Dated Journal Template" }

    { 1500024;3;Field     ;
                SourceExpr="Post Dated Journal Batch" }

    { 1500036;3;Field     ;
                SourceExpr="GST Report" }

    { 1500038;3;Field     ;
                SourceExpr="Round Amount for WHT Calc" }

    { 1000000000;3;Field  ;
                SourceExpr="Max. WHT Difference Allowed" }

    { 1000000002;3;Field  ;
                SourceExpr="Min. WHT Calc only on Inv. Amt" }

    { 1500034;3;Field     ;
                SourceExpr="Full GST on Prepayment" }

    { 1500032;3;Field     ;
                SourceExpr="Interest Cal Excl. VAT" }

    { 1000000004;3;Field  ;
                SourceExpr="Enable VAT Average" }

    { 150000;2 ;Field     ;
                SourceExpr="Enable WHT" }

    { 1500027;2;Field     ;
                SourceExpr="Enable Tax Invoices" }

    { 1500011;2;Field     ;
                SourceExpr="Print Tax Invoices on Posting" }

    { 1500030;2;Field     ;
                SourceExpr="Force Payment With Invoice" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Do you want to change all open entries for every customer and vendor that are not blocked;THA=คุณต้องการเปลี่ยนรายการเปิดทั้งหมดสำหรับลูกค้าและผู้ขายทุกรายที่ไม่ได้ถูกบล็อค';
      Text1500000@1000000001 : TextConst 'ENU=Are you sure you want to disable this functionality?;THA=แน่ใจหรือไม่ว่าคุณต้องการปิดการทำงานของฟังก์ชันนี้?';
      Object@1000000002 : Record 2000000001;
      "AMAS SoftwareEditable"@19043703 : Boolean INDATASET;
      "AMAS SoftwareHideValue"@19074966 : Boolean INDATASET;
      "AMAS SoftwareEnable"@19057435 : Boolean INDATASET;
      BAStobeLodgedasaGroupEnable@19074317 : Boolean INDATASET;
      "BAS Group CompanyEnable"@19000934 : Boolean INDATASET;
      "BAS GST Division FactorEnable"@19008899 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateControls@1500000();
    BEGIN
      "AMAS SoftwareEnable" :=
        ("Address Validation" = "Address Validation"::"Entire Address") OR
        ("Address Validation" = "Address Validation"::"Address ID");
      IF "AMAS SoftwareEnable" = FALSE THEN
        "AMAS Software" := 0;
      BAStobeLodgedasaGroupEnable := "Enable GST (Australia)";
      IF BAStobeLodgedasaGroupEnable = FALSE THEN
        "BAS to be Lodged as a Group" := FALSE;
      "BAS Group CompanyEnable" := "Enable GST (Australia)";
      IF "BAS Group CompanyEnable" = FALSE THEN
        "BAS Group Company" := FALSE;
      "BAS GST Division FactorEnable" := "Enable GST (Australia)";
      IF "BAS GST Division FactorEnable" = FALSE THEN
        "BAS GST Division Factor" := 0;
    END;

    PROCEDURE UpdateSetups@1500001();
    VAR
      SalesReceivablesSetup@1000000000 : Record 311;
      PurchasesPayablesSetup@1000000001 : Record 312;
    BEGIN
      IF "Enable GST (Australia)" = FALSE THEN BEGIN
        IF SalesReceivablesSetup.GET THEN BEGIN
          SalesReceivablesSetup."Pre-GST Prod. Posting Group" := '';
          SalesReceivablesSetup."Payment Discount Reason Code" := '';
          SalesReceivablesSetup.MODIFY;
        END;
        IF PurchasesPayablesSetup.GET THEN BEGIN
          PurchasesPayablesSetup."Pre-GST Prod. Posting Group" := '';
          PurchasesPayablesSetup."GST Prod. Posting Group" := '';
          PurchasesPayablesSetup."Vendor Registration Warning" := FALSE;
          PurchasesPayablesSetup."Payment Discount Reason Code" := '';
          PurchasesPayablesSetup.MODIFY;
        END;
      END;
    END;

    LOCAL PROCEDURE EnableGSTAustraliaOnAfterValid@19016467();
    BEGIN
      UpdateControls;
      UpdateSetups;
    END;

    LOCAL PROCEDURE AddressValidationOnAfterValida@19079782();
    BEGIN
      UpdateControls;
    END;

    LOCAL PROCEDURE AMASSoftwareOnFormat@19025632();
    BEGIN
      IF "AMAS Software" = 0 THEN
        "AMAS SoftwareHideValue" := TRUE;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 119 User Setup
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW14.00,AVATHA4.40;
  }
  PROPERTIES
  {
    CaptionML=[ENU=User Setup;
               THA=เซ็ตอัพผู้ใช้];
    SourceTable=Table91;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="User ID" }

    { 4   ;2   ;Field     ;
                SourceExpr="Allow Posting From" }

    { 6   ;2   ;Field     ;
                SourceExpr="Allow Posting To" }

    { 8   ;2   ;Field     ;
                SourceExpr="Register Time";
                Visible=FALSE }

    { 15  ;2   ;Field     ;
                SourceExpr="Sales Resp. Ctr. Filter";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                SourceExpr="Purchase Resp. Ctr. Filter";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Service Resp. Ctr. Filter";
                Visible=FALSE }

    { 1000000022;2;Field  ;
                SourceExpr="Magazine Filter";
                OnLookup=VAR
                           Magazine@1000000002 : Record 50011;
                         BEGIN
                           IF FORM.RUNMODAL(0,Magazine) = ACTION::LookupOK THEN BEGIN
                             Text := Magazine.Code;
                             EXIT(TRUE);
                           END;
                         END;
                          }

    { 1000000014;2;Field  ;
                SourceExpr="Ads. Booking Filter" }

    { 1000000016;2;Field  ;
                SourceExpr="Salesperson Code" }

    { 1000000004;2;Field  ;
                SourceExpr="Allow Confirm Ads. Booking" }

    { 1000000006;2;Field  ;
                SourceExpr="Allow Cancel Ads. Booking" }

    { 1000000008;2;Field  ;
                SourceExpr="Allow Approve Ads. Booking" }

    { 1000000010;2;Field  ;
                SourceExpr="Allow Hold Ads. Booking" }

    { 1000000012;2;Field  ;
                SourceExpr="Allow Close Ads. Booking" }

    { 1000000018;2;Field  ;
                SourceExpr="Allow Create Ads. Invoice" }

    { 1000000020;2;Field  ;
                SourceExpr="Sales Posting Option" }

    { 1000000026;2;Field  ;
                SourceExpr="Purchase Posting Option" }

    { 1000000024;2;Field  ;
                SourceExpr="Allow Change Issue Date";
                Visible=FALSE }

    { 1000000028;2;Field  ;
                SourceExpr="Allow Unblock Bank Cheque" }

    { 1000000000;2;Field  ;
                SourceExpr="Allow Post Petty Cash Invoice" }

    { 1000000002;2;Field  ;
                SourceExpr="Allow Post Cash Adv. Invoice" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   02.03.2007   KKE   Petty Cash and Cash Advance.
      Burda
      002   08.05.2007   KKE   Ads Sales Module - Add fields
    }
    END.
  }
}

OBJECT Page 130 Posted Sales Shipment
{
  OBJECT-PROPERTIES
  {
    Date=12/12/11;
    Time=[ 2:08:02 PM];
    Version List=NAVW16.00,KITNA6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Sales Shipment;
               THA=การจัดส่งสินค้าขายที่ลงรายการบัญชี];
    InsertAllowed=No;
    SourceTable=Table110;
    PageType=Document;
    OnModifyRecord=BEGIN
                     CODEUNIT.RUN(CODEUNIT::"Shipment Header - Edit",Rec);
                     EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Shipment;
                                 THA=&การจัดส่ง] }
      { 10      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 396;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 78      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=CONST(Shipment),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 80      ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(110),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 107     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 PostedApprovalEntries@1000000001 : Form 659;
                               BEGIN
                                 PostedApprovalEntries.Setfilters(DATABASE::"Sales Shipment Header","No.");
                                 PostedApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 74      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 79      ;2   ;Action    ;
                      CaptionML=[ENU=&Track Package;
                                 THA=&ติดตามบรรจุภัณฑ์];
                      OnAction=BEGIN
                                 StartTrackingSite;
                               END;
                                }
      { 105     ;2   ;Action    ;
                      CaptionML=[ENU=&Send BizTalk Shipment Notification;
                                 THA=&ส่งการแจ้งเตือนการจัดส่ง BizTalk];
                      OnAction=VAR
                                 BizTalkManagement@1000000001 : Codeunit 99008508;
                               BEGIN
                                 BizTalkManagement.SendShipmentNotification(Rec);
                               END;
                                }
      { 49      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesShptHeader);
                                 SalesShptHeader.PrintRecords(TRUE);
                               END;
                                }
      { 50      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                Editable=FALSE }

    { 112 ;2   ;Field     ;
                SourceExpr="Sell-to Contact No.";
                Editable=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name";
                Editable=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Sell-to Address";
                Editable=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Sell-to Address 3";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Editable=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Sell-to City";
                Editable=FALSE }

    { 150000;2 ;Field     ;
                SourceExpr="Sell-to County" }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Sell-to County/Country Code;
                           THA=ขายไปที่เขต/รหัสประเทศ];
                SourceExpr="Sell-to Country/Region Code";
                Editable=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 27  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 84  ;2   ;Field     ;
                SourceExpr="Requested Delivery Date";
                Editable=FALSE }

    { 87  ;2   ;Field     ;
                SourceExpr="Promised Delivery Date";
                Editable=FALSE }

    { 111 ;2   ;Field     ;
                SourceExpr="Quote No.";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Order No.";
                Importance=Promoted;
                Editable=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Importance=Promoted;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Editable=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="No. Printed";
                Editable=FALSE }

    { 46  ;1   ;Part      ;
                Name=SalesShipmLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page131 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 18  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                Editable=FALSE }

    { 114 ;2   ;Field     ;
                SourceExpr="Bill-to Contact No.";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Name";
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to Address";
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Bill-to Address 3";
                Editable=FALSE }

    { 67  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Bill-to City";
                Editable=FALSE }

    { 1500001;2;Field     ;
                SourceExpr="Bill-to County";
                Editable=FALSE }

    { 1500005;2;Field     ;
                CaptionML=[ENU=Bill-to County/Country Code;
                           THA=เรียกเก็บเงินที่เขต/รหัสประเทศ];
                SourceExpr="Bill-to Country/Region Code";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Editable=FALSE }

    { 9   ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 30  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Importance=Promoted;
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable=FALSE }

    { 69  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Importance=Promoted;
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 1500007;2;Field     ;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 1500009;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable=FALSE }

    { 91  ;2   ;Field     ;
                SourceExpr="Outbound Whse. Handling Time";
                Editable=FALSE }

    { 95  ;2   ;Field     ;
                SourceExpr="Shipping Time";
                Editable=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Editable=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Shipping Agent Code" }

    { 93  ;2   ;Field     ;
                SourceExpr="Shipping Agent Service Code" }

    { 72  ;2   ;Field     ;
                SourceExpr="Package Tracking No." }

    { 44  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Importance=Promoted;
                Editable=FALSE }

    { 1902171401;1;Group  ;
                CaptionML=[ENU=BizTalk;
                           THA=BizTalk] }

    { 103 ;2   ;Field     ;
                SourceExpr="BizTalk Shipment Notification";
                Editable=FALSE }

    { 101 ;2   ;Field     ;
                SourceExpr="Date Sent";
                Editable=FALSE }

    { 99  ;2   ;Field     ;
                SourceExpr="Time Sent";
                Editable=FALSE }

    { 97  ;2   ;Field     ;
                SourceExpr="Customer Order No.";
                Editable=FALSE }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000006;2;Field  ;
                SourceExpr="Sell-to Name (Thai)";
                Editable=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr="Sell-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000008;2;Field  ;
                SourceExpr="Bill-to Name (Thai)";
                Editable=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="Bill-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000014;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable=FALSE }

    { 1000000016;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesShptHeader@1000000000 : Record 110;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 131 Posted Sales Shpt. Subform
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,KITNA6.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Lines;
    LinksAllowed=No;
    SourceTable=Table111;
    PageType=ListPart;
    AutoSplitKey=Yes;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 1903098504;2 ;Action    ;
                      CaptionML=[ENU=Order Tra&cking;
                                 THA=การ&ติดตามใบสั่ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #130. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesShipmLines.FORM.}
                                 ShowTracking;
                               END;
                                }
      { 1902740304;2 ;Action    ;
                      CaptionML=[ENU=&Undo Shipment;
                                 THA=&ยกเลิกการขนส่งสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #130. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesShipmLines.FORM.}
                                 UndoShipmentPosting;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1903100004;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #130. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesShipmLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1901092104;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #130. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesShipmLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 //This functionality was copied from page #130. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesShipmLines.FORM.}
                                 _ShowItemTrackingLines;
                               END;
                                }
      { 1901281504;2 ;Action    ;
                      CaptionML=[ENU=Kit Lines;
                                 THA=บรรทัด Kit];
                      OnAction=BEGIN
                                 //This functionality was copied from page #130. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesShipmLines.FORM.}
                                 _ShowKitLines;
                               END;
                                }
      { 1900609704;2 ;Action    ;
                      CaptionML=[ENU=Item Invoice &Lines;
                                 THA=&บรรทัดใบแจ้งหนี้สินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #130. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesShipmLines.FORM.}
                                 _ShowItemSalesInvLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr="No." }

    { 24  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000000;2;Field  ;
                SourceExpr="Subscriber Contract No." }

    { 20  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 54  ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity }

    { 22  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Quantity Invoiced" }

    { 44  ;2   ;Field     ;
                SourceExpr="Qty. Shipped Not Invoiced";
                Visible=FALSE;
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Requested Delivery Date";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Promised Delivery Date";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Planned Delivery Date" }

    { 40  ;2   ;Field     ;
                SourceExpr="Planned Shipment Date" }

    { 16  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Visible=TRUE }

    { 32  ;2   ;Field     ;
                SourceExpr="Shipping Time";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Outbound Whse. Handling Time";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr=Correction;
                Visible=FALSE;
                Editable=FALSE }

  }
  CODE
  {

    PROCEDURE ShowTracking@1();
    VAR
      ItemLedgEntry@1000000000 : Record 32;
      TempItemLedgEntry@1000000001 : TEMPORARY Record 32;
      TrackingForm@1000000002 : Form 99000822;
    BEGIN
      TESTFIELD(Type,Type::Item);
      IF "Item Shpt. Entry No." <> 0 THEN BEGIN
        ItemLedgEntry.GET("Item Shpt. Entry No.");
        TrackingForm.SetItemLedgEntry(ItemLedgEntry);
      END ELSE
        TrackingForm.SetMultipleItemLedgEntries(TempItemLedgEntry,
          DATABASE::"Sales Shipment Line",0,"Document No.",'',0,"Line No.");

      TrackingForm.RUNMODAL;
    END;

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@8();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE _ShowItemTrackingLines@19066222();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE ShowItemTrackingLines@6500();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE UndoShipmentPosting@2();
    VAR
      SalesShptLine@1000000000 : Record 111;
      SalesLine@1000000001 : Record 37;
      KitSalesLine@1000000002 : Record 25000;
      KitManagement@1000000003 : Codeunit 25000;
    BEGIN
      SalesShptLine.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(SalesShptLine);
      CODEUNIT.RUN(CODEUNIT::"Undo Sales Shipment Line",SalesShptLine);

      SalesLine.GET(SalesLine."Document Type"::Order,"Order No.","Order Line No.");
      KitSalesLine.SETRANGE("Document Type",SalesLine."Document Type");
      KitSalesLine.SETRANGE("Document No.",SalesLine."Document No.");
      KitSalesLine.SETRANGE("Document Line No.",SalesLine."Line No.");
      IF KitSalesLine.FINDSET THEN
        KitManagement.KitAutoReserve(SalesLine); //Has commit
    END;

    PROCEDURE _ShowItemSalesInvLines@19017442();
    BEGIN
      TESTFIELD(Type,Type::Item);
      Rec.ShowItemSalesInvLines;
    END;

    PROCEDURE ShowItemSalesInvLines@4();
    BEGIN
      TESTFIELD(Type,Type::Item);
      Rec.ShowItemSalesInvLines;
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@3();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE _ShowKitLines@19071122();
    BEGIN
      Rec.ShowKitLines;
    END;

    PROCEDURE ShowKitLines@1462000();
    BEGIN
      Rec.ShowKitLines;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 132 Posted Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=02/07/12;
    Time=11:37:04 AM;
    Modified=Yes;
    Version List=NAVW16.00.10,KITNA6.00,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Sales Invoice;
               THA=ใบแจ้งหนี้การขายที่ลงรายการบัญชี];
    InsertAllowed=No;
    SourceTable=Table112;
    PageType=Document;
    RefreshOnActivate=Yes;
    OnModifyRecord=VAR
                     SalesPost@1000000000 : Codeunit 80;
                   BEGIN
                     //KKE : #001 +
                     IF ("Bill-to Name (Thai)" <> xRec."Bill-to Name (Thai)") OR
                        ("Bill-to Address (Thai)" <> xRec."Bill-to Address (Thai)")
                     THEN BEGIN
                       SalesPost.UpdateBilltoOnSalesInvHdr(Rec);
                     END;
                     //KKE : #001 -
                     //KKE : #003 +
                     IF ("PO No." <> xRec."PO No.") OR
                        ("Remark 1" <> xRec."Remark 1") OR
                        ("Remark 2" <> xRec."Remark 2") OR
                        ("Product (Ads. Invoice)" <> xRec."Product (Ads. Invoice)")
                     THEN
                       SalesPost.SalesInvHdrEdit(Rec);

                     EXIT(FALSE);
                     //KKE : #003 -
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 55      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 THA=&ใบแจ้งหนี้] }
      { 8       ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 397;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 57      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=CONST(Posted Invoice),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 89      ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(112),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 112     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 PostedApprovalEntries@1001 : Form 659;
                               BEGIN
                                 PostedApprovalEntries.Setfilters(DATABASE::"Sales Invoice Header","No.");
                                 PostedApprovalEntries.RUN;
                               END;
                                }
      { 171     ;2   ;Separator  }
      { 172     ;2   ;Action    ;
                      CaptionML=[ENU=Credit Cards Transaction Lo&g Entries;
                                 THA=รายการบัน&ทึกธุรกรรมบัตรเครดิต];
                      RunObject=Page 829;
                      RunFormLink=Document Type=CONST(Payment),Document No.=FIELD(No.),Customer No.=FIELD(Bill-to Customer No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 108     ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 109     ;2   ;Action    ;
                      CaptionML=[ENU=&Send BizTalk Sales Invoice;
                                 THA=&ส่งใบแจ้งหนี้การขาย BizTalk];
                      OnAction=VAR
                                 BizTalkManagement@1001 : Codeunit 99008508;
                               BEGIN
                                 BizTalkManagement.SendSalesInvoice(Rec);
                               END;
                                }
      { 1000000026;1 ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์] }
      { 1000000027;2 ;Action    ;
                      CaptionML=ENU=Sales Invoice -STD;
                      Visible=No;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.PrintRecords(TRUE);
                               END;
                                }
      { 1000000028;2 ;Action    ;
                      CaptionML=ENU=Invoice - &Combine Ads. Sales;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 REPORT.RUN(REPORT::"Sales - Invoice Combine",TRUE,FALSE,SalesInvHeader);
                               END;
                                }
      { 1000000029;2 ;Action    ;
                      CaptionML=ENU=Invoice - &Ads. Sales;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.PrintRecords(TRUE);
                               END;
                                }
      { 1000000030;2 ;Action    ;
                      CaptionML=ENU=Invoice - &Circulation;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 REPORT.RUN(REPORT::"Sales - Invoice Circulation",TRUE,FALSE,SalesInvHeader);
                               END;
                                }
      { 1000000031;2 ;Action    ;
                      CaptionML=ENU=&Receipt - Subscription;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 REPORT.RUN(REPORT::"Receipt - Subscription",TRUE,FALSE,SalesInvHeader);
                               END;
                                }
      { 1000000032;2 ;Separator  }
      { 1000000033;2 ;Action    ;
                      CaptionML=ENU=Receipt - &Other Sales;
                      OnAction=VAR
                                 ReceiptOtherSales@1000000001 : Report 50062;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 //REPORT.RUN(REPORT::"Receipt - Other Sales",TRUE,FALSE,SalesInvHeader);
                                 CLEAR(ReceiptOtherSales);
                                 ReceiptOtherSales.InitRequest(Rec);
                                 ReceiptOtherSales.RUNMODAL;
                               END;
                                }
      { 1000000034;2 ;Action    ;
                      CaptionML=ENU=Receipt/Tax Invoice - Other Sales;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 REPORT.RUN(REPORT::"Receipt/Tax Inv. - Other Sales",TRUE,FALSE,SalesInvHeader);
                               END;
                                }
      { 1000000035;2 ;Action    ;
                      CaptionML=ENU=Invoice/Tax Invoice for Other Sales;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 REPORT.RUN(REPORT::"Inv./Tax Inv. for Other Sales",TRUE,FALSE,SalesInvHeader);
                               END;
                                }
      { 59      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                Editable=FALSE }

    { 96  ;2   ;Field     ;
                SourceExpr="Sell-to Contact No.";
                Editable=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Sell-to Address";
                Editable=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Sell-to Address 3";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Editable=FALSE }

    { 67  ;2   ;Field     ;
                SourceExpr="Sell-to City";
                Editable=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="Sell-to County";
                Importance=Promoted;
                Editable=FALSE }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Sell-to County/Country Code;
                           THA=ขายไปที่เขต/รหัสประเทศ];
                SourceExpr="Sell-to Country/Region Code";
                Editable=FALSE }

    { 69  ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Editable=FALSE }

    { 1000000036;2;Field  ;
                SourceExpr="Posting Description" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 25  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 114 ;2   ;Field     ;
                SourceExpr="Quote No." }

    { 86  ;2   ;Field     ;
                SourceExpr="Order No.";
                Importance=Promoted;
                Editable=FALSE }

    { 73  ;2   ;Field     ;
                SourceExpr="Pre-Assigned No.";
                Editable=FALSE }

    { 94  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Importance=Promoted;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Editable=FALSE }

    { 92  ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="No. Printed";
                Editable=FALSE }

    { 1000000001;2;Field  ;
                SourceExpr="PO No." }

    { 54  ;1   ;Part      ;
                Name=SalesInvLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page133 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 16  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                Editable=FALSE }

    { 98  ;2   ;Field     ;
                SourceExpr="Bill-to Contact No.";
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Bill-to Name";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Address";
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2";
                Editable=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Bill-to Address 3";
                Editable=FALSE }

    { 78  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Bill-to City";
                Editable=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="Bill-to County";
                Editable=FALSE }

    { 1500006;2;Field     ;
                SourceExpr="Bill-to Country/Region Code";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted;
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Payment Discount %";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Editable=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Editable=FALSE }

    { 127 ;2   ;Field     ;
                SourceExpr="Credit Card No.";
                Editable=FALSE }

    { 126 ;2   ;Field     ;
                CaptionML=[ENU=Cr. Card Number (Last 4 Digits);
                           THA=หมายเลขบัตรเครดิต (4 ตัวหลังสุด)];
                SourceExpr=GetCreditcardNumber;
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Importance=Promoted;
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Importance=Promoted;
                Editable=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 1500010;2;Field     ;
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 76  ;2   ;Field     ;
                SourceExpr="Location Code";
                Editable=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Importance=Promoted;
                Editable=FALSE }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 87  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 52  ;2   ;Field     ;
                SourceExpr="EU 3-Party Trade";
                Editable=FALSE }

    { 1902171401;1;Group  ;
                CaptionML=[ENU=BizTalk;
                           THA=BizTalk] }

    { 106 ;2   ;Field     ;
                SourceExpr="BizTalk Sales Invoice";
                Editable=FALSE }

    { 104 ;2   ;Field     ;
                SourceExpr="Date Sent";
                Editable=FALSE }

    { 102 ;2   ;Field     ;
                SourceExpr="Time Sent";
                Editable=FALSE }

    { 100 ;2   ;Field     ;
                SourceExpr="Customer Order No.";
                Editable=FALSE }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000008;2;Field  ;
                SourceExpr="Sell-to Name (Thai)";
                Editable=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr="Sell-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000010;2;Field  ;
                SourceExpr="Bill-to Name (Thai)" }

    { 1000000011;2;Field  ;
                SourceExpr="Bill-to Address (Thai)";
                MultiLine=Yes }

    { 1000000012;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable=FALSE }

    { 1000000018;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1901533901;1;Group  ;
                CaptionML=[ENU=Remark;
                           THA=หมายเหตุ] }

    { 1000000020;2;Field  ;
                SourceExpr="Product (Ads. Invoice)" }

    { 1000000021;2;Field  ;
                SourceExpr="Remark 1";
                MultiLine=Yes }

    { 1000000022;2;Field  ;
                SourceExpr="Remark 2";
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesInvHeader@1000 : Record 112;
      ChangeExchangeRate@1001 : Form 511;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
      Burda
      002   19.10.2007   KKE   Update Bill-to Name (thai)
      003   03.12.2007   KKE   Allow user to edit "PO No."
    }
    END.
  }
}

OBJECT Page 133 Posted Sales Invoice Subform
{
  OBJECT-PROPERTIES
  {
    Date=12/19/11;
    Time=11:48:19 AM;
    Version List=NAVW16.00,KITNA6.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table113;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnModifyRecord=BEGIN
                     //KKE : #001 +
                     IF (Description <> xRec.Description) OR
                        ("Description 2" <> xRec."Description 2") OR
                        ("Report Issuedate" <> xRec."Report Issuedate")
                     THEN BEGIN
                       SalesPost.SalesInvLineEdit(Rec);
                       EXIT(FALSE);
                     END;
                     //KKE : #001 -
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1901314304;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #132. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesInvLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1900639404;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #132. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesInvLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 //This functionality was copied from page #132. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesInvLines.FORM.}
                                 _ShowItemTrackingLines;
                               END;
                                }
      { 1901281504;2 ;Action    ;
                      CaptionML=[ENU=Kit Lines;
                                 THA=บรรทัด Kit];
                      OnAction=BEGIN
                                 //This functionality was copied from page #132. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesInvLines.FORM.}
                                 _ShowKitLines;
                               END;
                                }
      { 1905427604;2 ;Action    ;
                      CaptionML=[ENU=Item Shipment &Lines;
                                 THA=&บรรทัดการจัดส่งสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #132. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesInvLines.FORM.}
                                 _ShowItemShipmentLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="No.";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="VAT Prod. Posting Group";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000012;2;Field  ;
                SourceExpr="Description 2" }

    { 14  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000010;2;Field  ;
                CaptionML=ENU=Report Issue Date;
                SourceExpr="Report Issuedate" }

    { 1000000004;2;Field  ;
                SourceExpr="Subscriber Contract No." }

    { 1000000006;2;Field  ;
                SourceExpr="Agent Customer No." }

    { 1000000008;2;Field  ;
                SourceExpr="Circulation Receipt No.";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity;
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE;
                Editable=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Unit Price";
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %";
                Editable=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE;
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE;
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE;
                Editable=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE;
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE;
                Editable=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      SalesPost@1000000000 : Codeunit 80;
      AdsBookingLine@1000000001 : Record 50038;

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@8();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE _ShowItemTrackingLines@19066222();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE ShowItemTrackingLines@6500();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE _ShowItemShipmentLines@19067738();
    BEGIN
      IF NOT (Type IN [Type::Item,Type::"Charge (Item)"]) THEN
        TESTFIELD(Type);
      Rec.ShowItemShipmentLines;
    END;

    PROCEDURE ShowItemShipmentLines@1();
    BEGIN
      IF NOT (Type IN [Type::Item,Type::"Charge (Item)"]) THEN
        TESTFIELD(Type);
      Rec.ShowItemShipmentLines;
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@2();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE _ShowKitLines@19071122();
    BEGIN
      Rec.ShowKitLines;
    END;

    PROCEDURE ShowKitLines@1462000();
    BEGIN
      Rec.ShowKitLines;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co.,Ltd.
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   03.12.2007   KKE   Allow user to edit Description
      001   07.12.2007   GKU   Allow user to edit Issuedate
    }
    END.
  }
}

OBJECT Page 134 Posted Sales Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=12/08/11;
    Time=10:47:20 PM;
    Version List=NAVW16.00.10,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Sales Credit Memo;
               THA=ใบลดหนี้การขายที่ลงรายการบัญชี];
    InsertAllowed=No;
    SourceTable=Table114;
    PageType=Document;
    RefreshOnActivate=Yes;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 THA=&ใบลดหนี้] }
      { 8       ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 398;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 49      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=CONST(Posted Credit Memo),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 77      ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(114),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 92      ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 PostedApprovalEntries@1001 : Form 659;
                               BEGIN
                                 PostedApprovalEntries.Setfilters(DATABASE::"Sales Cr.Memo Header","No.");
                                 PostedApprovalEntries.RUN;
                               END;
                                }
      { 100     ;2   ;Separator  }
      { 101     ;2   ;Action    ;
                      CaptionML=[ENU=Credit Cards Transaction Lo&g Entries;
                                 THA=รายการบัน&ทึกธุรกรรมบัตรเครดิต];
                      RunObject=Page 829;
                      RunFormLink=Transaction Description=CONST(Credit Memo),Document No.=FIELD(No.),Customer No.=FIELD(Bill-to Customer No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 90      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 91      ;2   ;Action    ;
                      CaptionML=[ENU=&Send BizTalk Sales Credit Memo;
                                 THA=&ส่งใบลดหนี้การขาย BizTalk];
                      OnAction=VAR
                                 BizTalkManagement@1001 : Codeunit 99008508;
                               BEGIN
                                 BizTalkManagement.SendSalesCreditMemo(Rec);
                               END;
                                }
      { 1000000005;1 ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์] }
      { 1000000006;2 ;Action    ;
                      CaptionML=ENU=&Credit Note;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader);
                                 SalesCrMemoHeader.PrintRecords(TRUE);
                               END;
                                }
      { 1000000027;2 ;Action    ;
                      CaptionML=ENU=Credit Note/&Invoice;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader);
                                 REPORT.RUN(REPORT::"Sales - Credit Note / Invoice",TRUE,FALSE,SalesCrMemoHeader);
                               END;
                                }
      { 51      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                Editable=FALSE }

    { 95  ;2   ;Field     ;
                SourceExpr="Sell-to Contact No.";
                Editable=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name";
                Editable=FALSE }

    { 55  ;2   ;Field     ;
                SourceExpr="Sell-to Address";
                Editable=FALSE }

    { 57  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Sell-to Address 3";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Editable=FALSE }

    { 59  ;2   ;Field     ;
                SourceExpr="Sell-to City";
                Editable=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="Sell-to County";
                Importance=Promoted;
                Editable=FALSE }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Sell-to County/Country Code;
                           THA=ขายไปที่เขต/รหัสประเทศ];
                SourceExpr="Sell-to Country/Region Code";
                Editable=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 29  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Pre-Assigned No.";
                Editable=FALSE }

    { 84  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Importance=Promoted;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="No. Printed";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Applied-to Tax Invoice";
                Editable=FALSE }

    { 46  ;1   ;Part      ;
                Name=SalesCrMemoLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page135 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกอินวอยซ์] }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                Editable=FALSE }

    { 97  ;2   ;Field     ;
                SourceExpr="Bill-to Contact No.";
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to Name";
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Bill-to Address";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2";
                Editable=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr="Bill-to Address 3";
                Editable=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Bill-to City";
                Editable=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="Bill-to County";
                Editable=FALSE }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Bill-to County/Country Code;
                           THA=เรียกเก็บเงินที่เขต/รหัสประเทศ];
                SourceExpr="Bill-to Country/Region Code";
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type";
                Importance=Promoted;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No.";
                Importance=Promoted;
                Editable=FALSE }

    { 282 ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Editable=FALSE }

    { 127 ;2   ;Field     ;
                SourceExpr="Credit Card No.";
                Editable=FALSE }

    { 126 ;2   ;Field     ;
                CaptionML=[ENU=Cr. Card Number (Last 4 Digits);
                           THA=หมายเลขบัตรเครดิต (4 ตัวหลังสุด)];
                SourceExpr=GetCreditcardNumber;
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable=FALSE }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 75  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 44  ;2   ;Field     ;
                SourceExpr="EU 3-Party Trade";
                Editable=FALSE }

    { 1902171401;1;Group  ;
                CaptionML=[ENU=BizTalk;
                           THA=BizTalk] }

    { 88  ;2   ;Field     ;
                SourceExpr="BizTalk Sales Credit Memo";
                Editable=FALSE }

    { 86  ;2   ;Field     ;
                SourceExpr="Date Sent";
                Editable=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr="Time Sent";
                Editable=FALSE }

    { 1902492201;1;Group  ;
                CaptionML=[ENU=Adjustment Details;
                           THA=รายละเอียดการปรับปรุง] }

    { 1500001;2;Field     ;
                SourceExpr=Adjustment }

    { 1500009;2;Field     ;
                SourceExpr="BAS Adjustment" }

    { 1500013;2;Field     ;
                SourceExpr="Adjustment Applies-to" }

    { 1500015;2;Field     ;
                SourceExpr="Reason Code" }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000011;2;Field  ;
                SourceExpr="Sell-to Name (Thai)";
                Editable=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="Sell-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000013;2;Field  ;
                SourceExpr="Bill-to Name (Thai)";
                Editable=FALSE }

    { 1000000017;2;Field  ;
                SourceExpr="Bill-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000019;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable=FALSE }

    { 1000000021;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1901533901;1;Group  ;
                CaptionML=[ENU=Remark;
                           THA=หมายเหตุ] }

    { 1000000023;2;Field  ;
                SourceExpr="Remark 1";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000024;2;Field  ;
                SourceExpr="Remark 2";
                Editable=FALSE;
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesCrMemoHeader@1000 : Record 114;
      ChangeExchangeRate@1001 : Form 511;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 135 Posted Sales Cr. Memo Subform
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Lines;
    LinksAllowed=No;
    SourceTable=Table115;
    PageType=ListPart;
    AutoSplitKey=Yes;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1901741704;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #134. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesCrMemoLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1901743104;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #134. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesCrMemoLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 //This functionality was copied from page #134. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesCrMemoLines.FORM.}
                                 _ShowItemTrackingLines;
                               END;
                                }
      { 1900207104;2 ;Action    ;
                      CaptionML=[ENU=Item Return Receipt &Lines;
                                 THA=บ&รรทัดการรับสินค้าส่งคืน];
                      OnAction=BEGIN
                                 //This functionality was copied from page #134. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesCrMemoLines.FORM.}
                                 _ShowItemReturnRcptLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr="No." }

    { 26  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000000;2;Field  ;
                SourceExpr="Circulation Receipt No." }

    { 20  ;2   ;Field     ;
                SourceExpr="Return Reason Code" }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity;
                Visible=TRUE }

    { 24  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Unit Price" }

    { 34  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 52  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Appl.-from Item Entry";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

  }
  CODE
  {

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@8();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE _ShowItemTrackingLines@19066222();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE ShowItemTrackingLines@6500();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE _ShowItemReturnRcptLines@19050374();
    BEGIN
      IF NOT (Type IN [Type::Item,Type::"Charge (Item)"]) THEN
        TESTFIELD(Type);
      Rec.ShowItemReturnRcptLines;
    END;

    PROCEDURE ShowItemReturnRcptLines@1();
    BEGIN
      IF NOT (Type IN [Type::Item,Type::"Charge (Item)"]) THEN
        TESTFIELD(Type);
      Rec.ShowItemReturnRcptLines;
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@2();
    BEGIN
      Rec.ShowLineComments;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 136 Posted Purchase Receipt
{
  OBJECT-PROPERTIES
  {
    Date=12/12/11;
    Time=[ 2:49:50 PM];
    Version List=NAVW16.00,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Purchase Receipt;
               THA=รับสินค้าซื้อที่ลงรายการ];
    InsertAllowed=No;
    SourceTable=Table120;
    PageType=Document;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Receipt;
                                 THA=&ใบรับ] }
      { 8       ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 399;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 72      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=CONST(Receipt),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 77      ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(120),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 99      ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 PostedApprovalEntries@1000000001 : Form 659;
                               BEGIN
                                 PostedApprovalEntries.Setfilters(DATABASE::"Purch. Rcpt. Header","No.");
                                 PostedApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 47      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchRcptHeader);
                                 PurchRcptHeader.PrintRecords(TRUE);
                               END;
                                }
      { 48      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 102 ;2   ;Field     ;
                SourceExpr="Buy-from Contact No.";
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name";
                Editable=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Editable=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Buy-from Address 3";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Editable=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Buy-from City";
                Editable=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="Buy-from County";
                Editable=FALSE }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Buy-from County/Country Code;
                           THA=ซื้อจากเขต/รหัสประเทศ];
                SourceExpr="Buy-from Country/Region Code";
                Editable=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="No. Printed";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 27  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr="Requested Receipt Date" }

    { 84  ;2   ;Field     ;
                SourceExpr="Promised Receipt Date" }

    { 107 ;2   ;Field     ;
                SourceExpr="Quote No." }

    { 73  ;2   ;Field     ;
                SourceExpr="Order No.";
                Editable=FALSE }

    { 97  ;2   ;Field     ;
                SourceExpr="Vendor Order No.";
                Importance=Promoted;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor Shipment No.";
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Editable=FALSE }

    { 44  ;1   ;Part      ;
                Name=PurchReceiptLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page137 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 18  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 104 ;2   ;Field     ;
                SourceExpr="Pay-to Contact no.";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Address";
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Pay-to Address 3";
                Editable=FALSE }

    { 67  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to City";
                Editable=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="Pay-to County";
                Editable=FALSE }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Pay-to County/Country Code;
                           THA=เขต/รหัสประเทศที่ทำจ่าย];
                SourceExpr="Pay-to Country/Region Code";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Editable=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 30  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable=FALSE }

    { 69  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable=FALSE }

    { 88  ;2   ;Field     ;
                SourceExpr="Inbound Whse. Handling Time" }

    { 40  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Editable=FALSE }

    { 90  ;2   ;Field     ;
                SourceExpr="Lead Time Calculation" }

    { 42  ;2   ;Field     ;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted;
                Editable=FALSE }

    { 1902171401;1;Group  ;
                CaptionML=[ENU=BizTalk;
                           THA=BizTalk] }

    { 94  ;2   ;Field     ;
                SourceExpr="BizTalk Purchase Receipt";
                Editable=FALSE }

    { 92  ;2   ;Field     ;
                SourceExpr="Date Received";
                Editable=FALSE }

    { 86  ;2   ;Field     ;
                SourceExpr="Time Received";
                Editable=FALSE }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000006;2;Field  ;
                SourceExpr="Buy-from Name (Thai)";
                Editable=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr="Buy-from Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000008;2;Field  ;
                SourceExpr="Pay-to Name (Thai)";
                Editable=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr="Pay-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000010;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable=FALSE }

    { 1000000016;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchRcptHeader@1000000000 : Record 120;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 138 Posted Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=12/12/11;
    Time=[ 2:48:16 PM];
    Version List=NAVW16.00,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Purchase Invoice;
               THA=ใบแจ้งหนี้การซื้อที่ลงรายการบัญชี];
    InsertAllowed=No;
    SourceTable=Table122;
    PageType=Document;
    RefreshOnActivate=Yes;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 53      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 THA=&ใบแจ้งหนี้] }
      { 45      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 400;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 55      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=CONST(Posted Invoice),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 89      ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(122),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 106     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 PostedApprovalEntries@1000000001 : Form 659;
                               BEGIN
                                 PostedApprovalEntries.Setfilters(DATABASE::"Purch. Inv. Header","No.");
                                 PostedApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 56      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchInvHeader);
                                 PurchInvHeader.PrintRecords(TRUE);
                               END;
                                }
      { 57      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 100 ;2   ;Field     ;
                SourceExpr="Buy-from Contact No.";
                Editable=FALSE }

    { 59  ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name";
                Editable=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Buy-from Address 3";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Editable=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Buy-from City";
                Editable=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="Buy-from County";
                Importance=Promoted;
                Editable=FALSE }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Buy-from County/Country Code;
                           THA=ซื้อจากเขต/รหัสประเทศ];
                SourceExpr="Buy-from Country/Region Code";
                Editable=FALSE }

    { 67  ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="No. Printed";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 71  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 110 ;2   ;Field     ;
                SourceExpr="Quote No." }

    { 81  ;2   ;Field     ;
                SourceExpr="Order No.";
                Editable=FALSE }

    { 83  ;2   ;Field     ;
                SourceExpr="Pre-Assigned No.";
                Editable=FALSE }

    { 104 ;2   ;Field     ;
                SourceExpr="Vendor Order No.";
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor Invoice No.";
                Importance=Promoted;
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Editable=FALSE }

    { 92  ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Editable=FALSE }

    { 52  ;1   ;Part      ;
                Name=PurchInvLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page139 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 18  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 102 ;2   ;Field     ;
                SourceExpr="Pay-to Contact No.";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Address";
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2";
                Editable=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Pay-to Address 3";
                Editable=FALSE }

    { 78  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to City";
                Editable=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="Pay-to County";
                Editable=FALSE }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Pay-to County/Country Code;
                           THA=เขต/รหัสประเทศที่ทำจ่าย];
                SourceExpr="Pay-to Country/Region Code";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Promoted;
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Payment Discount %";
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Editable=FALSE }

    { 84  ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Editable=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Dummy Vendor";
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 1000000014;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 76  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted;
                Editable=FALSE }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 87  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1902171401;1;Group  ;
                CaptionML=[ENU=BizTalk;
                           THA=BizTalk] }

    { 98  ;2   ;Field     ;
                SourceExpr="BizTalk Purchase Invoice";
                Editable=FALSE }

    { 94  ;2   ;Field     ;
                SourceExpr="Date Received";
                Editable=FALSE }

    { 95  ;2   ;Field     ;
                SourceExpr="Time Received";
                Editable=FALSE }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000018;2;Field  ;
                SourceExpr="Buy-from Name (Thai)";
                Editable=FALSE }

    { 1000000019;2;Field  ;
                SourceExpr="Buy-from Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000022;2;Field  ;
                SourceExpr="Pay-to Name (Thai)";
                Editable=FALSE }

    { 1000000024;2;Field  ;
                SourceExpr="Pay-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000026;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable=FALSE }

    { 1000000028;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchInvHeader@1000000000 : Record 122;
      ChangeExchangeRate@1000000001 : Form 511;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 139 Posted Purch. Invoice Subform
{
  OBJECT-PROPERTIES
  {
    Date=12/19/11;
    Time=11:34:50 AM;
    Version List=NAVW16.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Lines;
    LinksAllowed=No;
    SourceTable=Table123;
    PageType=ListPart;
    AutoSplitKey=Yes;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1901314304;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #138. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchInvLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1904945204;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #138. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchInvLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 //This functionality was copied from page #138. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchInvLines.FORM.}
                                 _ShowItemTrackingLines;
                               END;
                                }
      { 1907075804;2 ;Action    ;
                      CaptionML=[ENU=Item Receipt &Lines;
                                 THA=บรร&ทัดใบรับสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #138. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchInvLines.FORM.}
                                 _ShowItemReceiptLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr="No." }

    { 14  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="WHT Absorb Base" }

    { 1000000004;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000000;2;Field  ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="VAT Prod. Posting Group" }

    { 1000000008;2;Field  ;
                SourceExpr="WHT Business Posting Group";
                Visible=FALSE }

    { 1000000010;2;Field  ;
                SourceExpr="WHT Product Posting Group" }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 38  ;2   ;Field     ;
                SourceExpr="Return Reason Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity }

    { 30  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Direct Unit Cost" }

    { 54  ;2   ;Field     ;
                SourceExpr="Indirect Cost %";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Unit Price (LCY)" }

    { 64  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 44  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Insurance No.";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Budgeted FA No.";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="FA Posting Type";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Depr. Acquisition Cost";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

  }
  CODE
  {

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@8();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE _ShowItemTrackingLines@19066222();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE ShowItemTrackingLines@6500();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE _ShowItemReceiptLines@19009389();
    BEGIN
      IF NOT (Type IN [Type::Item,Type::"Charge (Item)"]) THEN
        TESTFIELD(Type);
      Rec.ShowItemReceiptLines;
    END;

    PROCEDURE ShowItemReceiptLines@1();
    BEGIN
      IF NOT (Type IN [Type::Item,Type::"Charge (Item)"]) THEN
        TESTFIELD(Type);
      Rec.ShowItemReceiptLines;
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@2();
    BEGIN
      Rec.ShowLineComments;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 140 Posted Purchase Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=12/12/11;
    Time=[ 2:49:03 PM];
    Version List=NAVW16.00,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Purchase Credit Memo;
               THA=ใบลดหนี้การซื้อที่ลงรายการบัญชี];
    InsertAllowed=No;
    SourceTable=Table124;
    PageType=Document;
    RefreshOnActivate=Yes;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 THA=&ใบลดหนี้] }
      { 8       ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 401;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 47      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=CONST(Posted Credit Memo),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 79      ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(124),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 88      ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 PostedApprovalEntries@1000000001 : Form 659;
                               BEGIN
                                 PostedApprovalEntries.Setfilters(DATABASE::"Purch. Cr. Memo Hdr.","No.");
                                 PostedApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 48      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchCrMemoHeader);
                                 PurchCrMemoHeader.PrintRecords(TRUE);
                               END;
                                }
      { 49      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 91  ;2   ;Field     ;
                SourceExpr="Buy-from Contact No.";
                Editable=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name";
                Editable=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Editable=FALSE }

    { 55  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Buy-from Address 3";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Editable=FALSE }

    { 57  ;2   ;Field     ;
                SourceExpr="Buy-from City";
                Editable=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="Buy-from County";
                Editable=FALSE }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Buy-from County/Country Code;
                           THA=ซื้อจากเขต/รหัสประเทศ];
                SourceExpr="Buy-from Country/Region Code";
                Editable=FALSE }

    { 59  ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 31  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Pre-Assigned No.";
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor Cr. Memo No.";
                Importance=Promoted;
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="No. Printed";
                Editable=FALSE }

    { 44  ;1   ;Part      ;
                Name=PurchCrMemoLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page141 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกอินวอยซ์] }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Editable=FALSE }

    { 93  ;2   ;Field     ;
                SourceExpr="Pay-to Contact No.";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to Address";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2";
                Editable=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="Pay-to Address 3";
                Editable=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Pay-to City";
                Editable=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="Pay-to County";
                Editable=FALSE }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Pay-to County/Country Code;
                           THA=เขต/รหัสประเทศที่ทำจ่าย];
                SourceExpr="Pay-to Country/Region Code";
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Editable=FALSE }

    { 64  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type";
                Importance=Promoted;
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No.";
                Importance=Promoted;
                Editable=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Dummy Vendor";
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 1000000014;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable=FALSE }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 75  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1902171401;1;Group  ;
                CaptionML=[ENU=BizTalk;
                           THA=BizTalk] }

    { 86  ;2   ;Field     ;
                SourceExpr="BizTalk Purchase Credit Memo";
                Editable=FALSE }

    { 84  ;2   ;Field     ;
                SourceExpr="Date Received";
                Editable=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr="Time Received";
                Editable=FALSE }

    { 1902492201;1;Group  ;
                CaptionML=[ENU=Adjustment Details;
                           THA=รายละเอียดการปรับปรุง] }

    { 1500001;2;Field     ;
                SourceExpr=Adjustment }

    { 1500009;2;Field     ;
                SourceExpr="BAS Adjustment" }

    { 1500013;2;Field     ;
                SourceExpr="Adjustment Applies-to" }

    { 1500015;2;Field     ;
                SourceExpr="Reason Code";
                Importance=Promoted }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่(ไทย)] }

    { 1000000018;2;Field  ;
                SourceExpr="Buy-from Name (Thai)";
                Editable=FALSE }

    { 1000000019;2;Field  ;
                SourceExpr="Buy-from Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000020;2;Field  ;
                SourceExpr="Pay-to Name (Thai)";
                Editable=FALSE }

    { 1000000024;2;Field  ;
                SourceExpr="Pay-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000026;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable=FALSE }

    { 1000000028;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchCrMemoHeader@1000000000 : Record 124;
      ChangeExchangeRate@1000000001 : Form 511;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 141 Posted Purch. Cr. Memo Subform
{
  OBJECT-PROPERTIES
  {
    Date=12/19/11;
    Time=11:35:26 AM;
    Version List=NAVW16.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Lines;
    LinksAllowed=No;
    SourceTable=Table125;
    PageType=ListPart;
    AutoSplitKey=Yes;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1900295304;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #140. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchCrMemoLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1903099904;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #140. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchCrMemoLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 THA=รายการการติดตาม&สินค้า];
                      Image=ItemTrackingLedger;
                      OnAction=BEGIN
                                 //This functionality was copied from page #140. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchCrMemoLines.FORM.}
                                 _ShowItemTrackingLines;
                               END;
                                }
      { 1901743204;2 ;Action    ;
                      CaptionML=[ENU=Item Return Shipment &Lines;
                                 THA=บรรทัดการ&จัดส่งคืนสินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #140. Unsupported part was commented. Please check it.
                                 {CurrPage.PurchCrMemoLines.FORM.}
                                 _ShowItemReturnShptLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr="No." }

    { 14  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="WHT Absorb Base" }

    { 1000000006;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000004;2;Field  ;
                SourceExpr="VAT Prod. Posting Group" }

    { 1000000002;2;Field  ;
                SourceExpr="WHT Product Posting Group" }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 38  ;2   ;Field     ;
                SourceExpr="Return Reason Code" }

    { 66  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity }

    { 64  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Direct Unit Cost" }

    { 18  ;2   ;Field     ;
                SourceExpr="Indirect Cost %";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Unit Price (LCY)" }

    { 70  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 44  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Job No.";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Prod. Order No.";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Insurance No.";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Budgeted FA No.";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="FA Posting Type";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Depr. until FA Posting Date";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Depreciation Book Code";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Depr. Acquisition Cost";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

  }
  CODE
  {

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@8();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE _ShowItemTrackingLines@19066222();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE ShowItemTrackingLines@6500();
    BEGIN
      Rec.ShowItemTrackingLines;
    END;

    PROCEDURE _ShowItemReturnShptLines@19079773();
    BEGIN
      IF NOT (Type IN [Type::Item,Type::"Charge (Item)"]) THEN
        TESTFIELD(Type);
      Rec.ShowItemReturnShptLines;
    END;

    PROCEDURE ShowItemReturnShptLines@1();
    BEGIN
      IF NOT (Type IN [Type::Item,Type::"Charge (Item)"]) THEN
        TESTFIELD(Type);
      Rec.ShowItemReturnShptLines;
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@3();
    BEGIN
      Rec.ShowLineComments;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 143 Posted Sales Invoices
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Posted Sales Invoices;
               THA=ใบแจ้งหนี้การขายที่ลงรายการบัญชี];
    SourceTable=Table112;
    PageType=List;
    CardFormID=Page132;
    OnAfterGetRecord=BEGIN
                       //KKE : #001
                       RemainingAmt := 0;
                       CustLedgEntry.RESET;
                       CustLedgEntry.SETCURRENTKEY("Document No.","Document Type","Customer No.");
                       CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                       CustLedgEntry.SETRANGE("Document No.","No.");
                       CustLedgEntry.SETRANGE("Posting Date","Posting Date");
                       IF CustLedgEntry.FIND('-') THEN BEGIN
                         CustLedgEntry.CALCFIELDS("Remaining Amount");
                         RemainingAmt := CustLedgEntry."Remaining Amount";
                       END;
                     END;

    OnQueryClosePage=BEGIN
                       IF CloseAction = Action::LookupOK THEN
                           LookupOKOnPush;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 THA=&ใบแจ้งหนี้] }
      { 26      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      Image=EditLines;
                      OnAction=BEGIN
                                 FORM.RUN(FORM::"Posted Sales Invoice",Rec)
                               END;
                                }
      { 31      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 397;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 32      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=CONST(Posted Invoice),No.=FIELD(No.);
                      Image=ViewComments }
      { 1102601000;2 ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(112),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1102601004;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 1102601005;2 ;Action    ;
                      CaptionML=[ENU=&Send BizTalk Sales Invoice;
                                 THA=&ส่งใบแจ้งหนี้การขาย BizTalk];
                      OnAction=VAR
                                 BizTalkManagement@1000000001 : Codeunit 99008508;
                               BEGIN
                                 BizTalkManagement.SendSalesInvoice(Rec);
                               END;
                                }
      { 20      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.PrintRecords(TRUE);
                               END;
                                }
      { 25      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name" }

    { 1000000002;2;Field  ;
                SourceExpr="No. Series";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 37  ;2   ;Field     ;
                SourceExpr="Currency Code" }

    { 13  ;2   ;Field     ;
                SourceExpr=Amount;
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              FORM.RUNMODAL(FORM::"Posted Sales Invoice",Rec)
                            END;
                             }

    { 15  ;2   ;Field     ;
                SourceExpr="Amount Including VAT";
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              FORM.RUNMODAL(FORM::"Posted Sales Invoice",Rec)
                            END;
                             }

    { 1000000000;2;Field  ;
                CaptionML=[ENU=Remaining Amount;
                           THA=จำนวนที่เหลือ];
                SourceExpr=RemainingAmt }

    { 27  ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                SourceExpr="Sell-to Country/Region Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Visible=FALSE }

    { 147 ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Visible=FALSE }

    { 145 ;2   ;Field     ;
                SourceExpr="Bill-to Name";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                SourceExpr="Bill-to Country/Region Code";
                Visible=FALSE }

    { 129 ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Visible=FALSE }

    { 125 ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 123 ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 113 ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 69  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 93  ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 1102601001;2;Field  ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="No. Printed" }

    { 1102601003;2;Field  ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 1102601007;2;Field  ;
                SourceExpr="Due Date";
                Visible=FALSE }

    { 1102601009;2;Field  ;
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 1102601011;2;Field  ;
                SourceExpr="Shipment Method Code";
                Visible=FALSE }

    { 1102601013;2;Field  ;
                SourceExpr="Shipment Date";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesInvHeader@1000000000 : Record 112;
      CirReceiptHeader@1000000001 : Record 50043;
      CustLedgEntry@1000000002 : Record 21;
      SalesPost@1000000003 : Codeunit 80;
      GetValueFromCirReceipt@1000000004 : Boolean;
      RemainingAmt@1000000005 : Decimal;
      CustLedgEntry2@1000000006 : Record 21;

    PROCEDURE GetFromCirReceipt@1000000000(_CirReceiptHeader@1000000000 : Record 50043);
    BEGIN
      //KKE : #001
      GetValueFromCirReceipt := TRUE;
      CirReceiptHeader := _CirReceiptHeader;
    END;

    PROCEDURE InsertCirReceiptLine@1000000002(VAR _SalesInvHeader@1000000000 : Record 112);
    VAR
      SalesInvLine@1000000001 : Record 113;
      CirReceiptLine@1000000002 : Record 50044;
      DetailCustLedgEntry@1000000003 : Record 379;
      CloseByCustLedgEntry@1000000004 : Record 21;
      SalesCrMemoLine@1000000005 : Record 115;
      SalesCrMemoHeader@1000000006 : Record 114;
      LineNo@1000000007 : Integer;
    BEGIN
      //KKE : #001
      IF _SalesInvHeader.FIND('-') THEN BEGIN
        CirReceiptLine.SETRANGE("Circulation Receipt No.",CirReceiptHeader."No.");
        IF CirReceiptLine.FINDLAST THEN
          LineNo := CirReceiptLine."Line No.";
        REPEAT
          SalesInvLine.SETRANGE("Document No.",_SalesInvHeader."No.");
        //  SalesInvLine.SETRANGE("Circulation Receipt No.",'');
          IF SalesInvLine.FIND('-') THEN
            REPEAT
              LineNo += 10000;
              CirReceiptLine.INIT;
              CirReceiptLine."Circulation Receipt No." := CirReceiptHeader."No.";
              CirReceiptLine."Line No." := LineNo;
              CirReceiptLine."Document Type" := CirReceiptLine."Document Type"::Invoice;
              CirReceiptLine."Document No." := SalesInvLine."Document No.";
              CirReceiptLine."Document Line No." := SalesInvLine."Line No.";
              CirReceiptLine."Posting Date" := _SalesInvHeader."Posting Date";
              CirReceiptLine.Type := SalesInvLine.Type;
              CirReceiptLine."No." := SalesInvLine."No.";
              CirReceiptLine.Description := SalesInvLine.Description;
              CirReceiptLine."Description 2" := SalesInvLine."Description 2";
              CirReceiptLine.Quantity := SalesInvLine.Quantity;
              CirReceiptLine."Unit Price" := SalesInvLine."Unit Price";
              CirReceiptLine.Discount := SalesInvLine."Line Discount Amount" + SalesInvLine."Inv. Discount Amount";
              //CirReceiptLine."Line Amount" := SalesInvLine."Line Amount";
              //TSA
              CustLedgEntry2.RESET;
              CustLedgEntry2.SETRANGE("Document Type",CustLedgEntry2."Document Type"::Invoice);
              CustLedgEntry2.SETRANGE("Document No.",SalesInvLine."Document No.");
              CustLedgEntry2.SETRANGE("Customer No.","Bill-to Customer No.");
              IF CustLedgEntry2.FIND('-') THEN
                BEGIN
                  //CustLedgEntry2.CALCFIELDS("Remaining Amt. (LCY)","Amount (LCY)");
                  //CirReceiptLine."Line Amount Incl. VAT" := CustLedgEntry2."Remaining Amt. (LCY)";
                  //KKE : #002 +
                  CustLedgEntry2.CALCFIELDS("Remaining Amt. (LCY)","Amount (LCY)");
                  CirReceiptLine."Line Amount Incl. VAT" :=
                    ROUND(SalesInvLine."Amount Including VAT" * CustLedgEntry2."Remaining Amt. (LCY)" /
                    CustLedgEntry2."Amount (LCY)");
                  //KKE : #002 -
                END;
              //CirReceiptLine."Line Amount Incl. VAT" := SalesInvLine."Amount Including VAT";
              //TSA
              CirReceiptLine.INSERT;

              SalesPost.UpdateSalesInvLineCirReceipt(
                SalesInvLine."Document No.",
                SalesInvLine."Line No.",
                CirReceiptHeader."No.");
              CLEAR(SalesPost);
            UNTIL SalesInvLine.NEXT=0;

          //Get CN which it closed by this invoice
          CustLedgEntry.RESET;
          CustLedgEntry.SETCURRENTKEY("Document No.","Document Type","Customer No.");
          CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
          CustLedgEntry.SETRANGE("Document No.","No.");
          CustLedgEntry.SETRANGE("Posting Date","Posting Date");
          IF CustLedgEntry.FIND('-') THEN BEGIN
            CloseByCustLedgEntry.RESET;
            CloseByCustLedgEntry.SETCURRENTKEY("Closed by Entry No.");
            CloseByCustLedgEntry.SETRANGE("Closed by Entry No.",CustLedgEntry."Entry No.");
            CloseByCustLedgEntry.SETRANGE("Document Type",CloseByCustLedgEntry."Document Type"::"Credit Memo");
            IF CloseByCustLedgEntry.FIND('-') THEN
              REPEAT
                SalesCrMemoLine.SETRANGE("Document No.",CloseByCustLedgEntry."Document No.");
                SalesCrMemoLine.SETRANGE("Circulation Receipt No.",'');
                IF SalesCrMemoLine.FIND('-') THEN
                  REPEAT
                    LineNo += 10000;
                    SalesCrMemoHeader.GET(SalesCrMemoLine."Document No.");
                    CirReceiptLine.INIT;
                    CirReceiptLine."Circulation Receipt No." := CirReceiptHeader."No.";
                    CirReceiptLine."Line No." := LineNo;
                    CirReceiptLine."Document Type" := CirReceiptLine."Document Type"::"Credit Memo";
                    CirReceiptLine."Document No." := SalesCrMemoLine."Document No.";
                    CirReceiptLine."Document Line No." := SalesCrMemoLine."Line No.";
                    CirReceiptLine."Posting Date" := SalesCrMemoHeader."Posting Date";
                    CirReceiptLine.Type := SalesCrMemoLine.Type;
                    CirReceiptLine."No." := SalesCrMemoLine."No.";
                    CirReceiptLine.Description := SalesCrMemoLine.Description;
                    CirReceiptLine."Description 2" := SalesCrMemoLine."Description 2";
                    CirReceiptLine.Quantity := -SalesCrMemoLine.Quantity;
                    CirReceiptLine."Unit Price" := SalesCrMemoLine."Unit Price";
                    CirReceiptLine.Discount := -(SalesCrMemoLine."Line Discount Amount" + SalesCrMemoLine."Inv. Discount Amount");
                    //CirReceiptLine."Line Amount" := -SalesCrMemoLine."Line Amount";
                    //TSA
                    CustLedgEntry2.RESET;
                    CustLedgEntry2.SETRANGE("Document Type",CustLedgEntry2."Document Type"::"Credit Memo");
                    CustLedgEntry2.SETRANGE("Document No.",SalesCrMemoLine."Document No.");
                    CustLedgEntry2.SETRANGE("Customer No.","Bill-to Customer No.");
                    IF CustLedgEntry2.FIND('-') THEN
                      BEGIN
                        //CustLedgEntry2.CALCFIELDS("Remaining Amt. (LCY)");
                        //CirReceiptLine."Line Amount Incl. VAT" := CustLedgEntry2."Remaining Amt. (LCY)";
                        //KKE : #002 +
                        CustLedgEntry2.CALCFIELDS("Remaining Amt. (LCY)","Amount (LCY)");
                        CirReceiptLine."Line Amount Incl. VAT" :=
                          ROUND(SalesCrMemoLine."Amount Including VAT" * CustLedgEntry2."Remaining Amt. (LCY)" /
                          CustLedgEntry2."Amount (LCY)");
                        //KKE : #002 -
                      END;
                    //TSA
                    //CirReceiptLine."Line Amount Incl. VAT" := -SalesCrMemoLine."Amount Including VAT";
                    CirReceiptLine.INSERT;

                    SalesPost.UpdateSalesCrMemoCirReceipt(
                      SalesCrMemoLine."Document No.",
                      SalesCrMemoLine."Line No.",
                      CirReceiptHeader."No.");
                    CLEAR(SalesPost);
                  UNTIL SalesCrMemoLine.NEXT=0;

              UNTIL CloseByCustLedgEntry.NEXT=0;
          END;
        UNTIL _SalesInvHeader.NEXT=0;
      END;
    END;

    LOCAL PROCEDURE LookupOKOnPush@19031339();
    BEGIN
      //KKE : #001
      IF GetValueFromCirReceipt THEN BEGIN
        CurrPage.SETSELECTIONFILTER(Rec);
        InsertCirReceiptLine(Rec);
        COMMIT;
        CurrPage.CLOSE;
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.04.2007   KKE   Get Sales Invoice Line from Circulation Receipt - Circulation Module
                               1CN : 1Invoice
      002   01.01.2008   KKE   Fix bug incase Sales Invoice has more than one line.
    }
    END.
  }
}

OBJECT Page 144 Posted Sales Credit Memos
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Posted Sales Credit Memos;
               THA=ใบลดหนี้การขายที่ลงรายการบัญชี];
    SourceTable=Table114;
    PageType=List;
    CardFormID=Page134;
    OnOpenPage=BEGIN
                 //KKE : #001
                 IF GetValueFromCirReceipt THEN BEGIN
                   SETRANGE("Get by Circulation Receipt",FALSE);
                   SETRANGE(Open,TRUE);
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       //KKE : #001
                       RemainingAmt := 0;
                       CustLedgEntry.RESET;
                       CustLedgEntry.SETCURRENTKEY("Document No.","Document Type","Customer No.");
                       CustLedgEntry.SETRANGE("Customer No.","Bill-to Customer No.");
                       CustLedgEntry.SETRANGE("Document No.","No.");
                       CustLedgEntry.SETRANGE("Posting Date","Posting Date");
                       IF CustLedgEntry.FIND('-') THEN BEGIN
                         CustLedgEntry.CALCFIELDS("Remaining Amount");
                         RemainingAmt := CustLedgEntry."Remaining Amount";
                       END;
                     END;

    OnQueryClosePage=BEGIN
                       IF CloseAction = Action::LookupOK THEN
                           LookupOKOnPush;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 THA=&ใบลดหนี้] }
      { 26      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      Image=EditLines;
                      OnAction=BEGIN
                                 FORM.RUN(FORM::"Posted Sales Credit Memo",Rec)
                               END;
                                }
      { 31      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 398;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 32      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=CONST(Posted Credit Memo),No.=FIELD(No.);
                      Image=ViewComments }
      { 1102601000;2 ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(114),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1102601001;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 1102601002;2 ;Action    ;
                      CaptionML=[ENU=&Send BizTalk Sales Credit Memo;
                                 THA=&ส่งใบลดหนี้การขาย BizTalk];
                      OnAction=VAR
                                 BizTalkManagement@1000000001 : Codeunit 99008508;
                               BEGIN
                                 BizTalkManagement.SendSalesCreditMemo(Rec);
                               END;
                                }
      { 20      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(SalesCrMemoHeader);
                                 SalesCrMemoHeader.PrintRecords(TRUE);
                               END;
                                }
      { 25      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name" }

    { 37  ;2   ;Field     ;
                SourceExpr="Currency Code" }

    { 13  ;2   ;Field     ;
                SourceExpr=Amount;
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              FORM.RUNMODAL(FORM::"Posted Sales Credit Memo",Rec)
                            END;
                             }

    { 15  ;2   ;Field     ;
                SourceExpr="Amount Including VAT";
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              FORM.RUNMODAL(FORM::"Posted Sales Credit Memo",Rec)
                            END;
                             }

    { 1000000000;2;Field  ;
                CaptionML=[ENU=Remaining Amount;
                           THA=จำนวนคงเหลือ];
                SourceExpr=RemainingAmt }

    { 27  ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                SourceExpr="Sell-to Country/Region Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Visible=FALSE }

    { 127 ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Visible=FALSE }

    { 125 ;2   ;Field     ;
                SourceExpr="Bill-to Name";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Visible=FALSE }

    { 29  ;2   ;Field     ;
                SourceExpr="Bill-to Country/Region Code";
                Visible=FALSE }

    { 115 ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 87  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 8   ;2   ;Field     ;
                SourceExpr="No. Printed" }

    { 1102601003;2;Field  ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 1102601005;2;Field  ;
                SourceExpr="Applies-to Doc. Type";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesCrMemoHeader@1000000000 : Record 114;
      CirReceiptHeader@1000000001 : Record 50043;
      CustLedgEntry@1000000002 : Record 21;
      GetValueFromCirReceipt@1000000003 : Boolean;
      RemainingAmt@1000000004 : Decimal;

    PROCEDURE GetFromCirReceipt@1000000000(_CirReceiptHeader@1000000000 : Record 50043);
    BEGIN
      //KKE : #001
      GetValueFromCirReceipt := TRUE;
      CirReceiptHeader := _CirReceiptHeader;
    END;

    PROCEDURE InsertCirReceiptLine@1000000002(VAR _SalesCrMemoHeader@1000000000 : Record 114);
    VAR
      SalesCrMemoLine@1000000001 : Record 115;
      CirReceiptLine@1000000002 : Record 50044;
      SalesPost@1000000003 : Codeunit 80;
      LineNo@1000000004 : Integer;
    BEGIN
      //KKE : #001
      IF _SalesCrMemoHeader.FIND('-') THEN BEGIN
        CirReceiptLine.SETRANGE("Circulation Receipt No.",CirReceiptHeader."No.");
        IF CirReceiptLine.FINDLAST THEN
          LineNo := CirReceiptLine."Line No.";
        REPEAT
          SalesCrMemoLine.SETRANGE("Document No.",_SalesCrMemoHeader."No.");
          SalesCrMemoLine.SETRANGE("Circulation Receipt No.",'');
          IF SalesCrMemoLine.FIND('-') THEN
            REPEAT
              LineNo += 10000;
              CirReceiptLine.INIT;
              CirReceiptLine."Circulation Receipt No." := CirReceiptHeader."No.";
              CirReceiptLine."Line No." := LineNo;
              CirReceiptLine."Document Type" := CirReceiptLine."Document Type"::"Credit Memo";
              CirReceiptLine."Document No." := SalesCrMemoLine."Document No.";
              CirReceiptLine."Document Line No." := SalesCrMemoLine."Line No.";
              CirReceiptLine."Posting Date" := _SalesCrMemoHeader."Posting Date";
              CirReceiptLine.Type := SalesCrMemoLine.Type;
              CirReceiptLine."No." := SalesCrMemoLine."No.";
              CirReceiptLine.Description := SalesCrMemoLine.Description;
              CirReceiptLine."Description 2" := SalesCrMemoLine."Description 2";
              CirReceiptLine.Quantity := -SalesCrMemoLine.Quantity;
              CirReceiptLine."Unit Price" := SalesCrMemoLine."Unit Price";
              CirReceiptLine.Discount := -(SalesCrMemoLine."Line Discount Amount" + SalesCrMemoLine."Inv. Discount Amount");
              //CirReceiptLine."Line Amount Incl. VAT" := -SalesCrMemoLine."Line Amount";
              CirReceiptLine."Line Amount Incl. VAT" := -SalesCrMemoLine."Amount Including VAT";  //11.10.07
              CirReceiptLine.INSERT;

              SalesPost.UpdateSalesCrMemoCirReceipt(
                SalesCrMemoLine."Document No.",
                SalesCrMemoLine."Line No.",
                CirReceiptHeader."No.");
              CLEAR(SalesPost);
            UNTIL SalesCrMemoLine.NEXT=0;
        UNTIL _SalesCrMemoHeader.NEXT=0;
      END;
    END;

    LOCAL PROCEDURE LookupOKOnPush@19031339();
    BEGIN
      //KKE : #001 +
      IF GetValueFromCirReceipt THEN BEGIN
        CurrPage.SETSELECTIONFILTER(Rec);
        InsertCirReceiptLine(Rec);
        COMMIT;
        CurrPage.CLOSE;
      END;
      //KKE : #001 -
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.04.2007   KKE   Get Sales Credit Memo Line from Circulation Receipt - Circulation Module
    }
    END.
  }
}

OBJECT Page 146 Posted Purchase Invoices
{
  OBJECT-PROPERTIES
  {
    Date=12/24/11;
    Time=10:09:52 PM;
    Modified=Yes;
    Version List=NAVW16.00.01,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Posted Purchase Invoices;
               THA=ใบแจ้งหนี้การซื้อที่ลงรายการบัญชี];
    SourceTable=Table122;
    PageType=List;
    CardFormID=Page138;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 21      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 THA=&ใบแจ้งหนี้] }
      { 29      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 400;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 30      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=CONST(Posted Invoice),No.=FIELD(No.);
                      Image=ViewComments }
      { 1102601000;2 ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(122),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 22      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchInvHeader);
                                 PurchInvHeader.PrintRecords(TRUE);
                               END;
                                }
      { 27      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 4   ;2   ;Field     ;
                SourceExpr="No." }

    { 1000000000;2;Field  ;
                SourceExpr="Vendor Invoice No." }

    { 2   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No." }

    { 15  ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name" }

    { 35  ;2   ;Field     ;
                SourceExpr="Currency Code" }

    { 13  ;2   ;Field     ;
                SourceExpr=Amount;
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              FORM.RUNMODAL(FORM::"Posted Purchase Invoice",Rec)
                            END;
                             }

    { 17  ;2   ;Field     ;
                SourceExpr="Amount Including VAT";
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              FORM.RUNMODAL(FORM::"Posted Purchase Invoice",Rec)
                            END;
                             }

    { 31  ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Visible=FALSE }

    { 25  ;2   ;Field     ;
                SourceExpr="Buy-from Country/Region Code";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Visible=FALSE }

    { 137 ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Visible=FALSE }

    { 135 ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Visible=FALSE }

    { 37  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                SourceExpr="Pay-to Country/Region Code";
                Visible=FALSE }

    { 125 ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Visible=FALSE }

    { 121 ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 119 ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 105 ;2   ;Field     ;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 73  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 87  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 85  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 8   ;2   ;Field     ;
                SourceExpr="No. Printed" }

    { 1102601001;2;Field  ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 1102601003;2;Field  ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 1102601005;2;Field  ;
                SourceExpr="Due Date";
                Visible=FALSE }

    { 1102601007;2;Field  ;
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 1102601009;2;Field  ;
                SourceExpr="Payment Method Code";
                Visible=FALSE }

    { 1102601011;2;Field  ;
                SourceExpr="Shipment Method Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchInvHeader@1000000000 : Record 122;

    BEGIN
    END.
  }
}

OBJECT Page 147 Posted Purchase Credit Memos
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Posted Purchase Credit Memos;
               THA=ใบลดหนี้การซื้อที่ลงรายการบัญชี];
    SourceTable=Table124;
    PageType=List;
    CardFormID=Page140;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 23      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Cr. Memo;
                                 THA=ใบ&ลดหนี้] }
      { 29      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 401;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 30      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=CONST(Posted Credit Memo),No.=FIELD(No.);
                      Image=ViewComments }
      { 1102601000;2 ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(124),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 21      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(PurchCrMemoHeader);
                                 PurchCrMemoHeader.PrintRecords(TRUE);
                               END;
                                }
      { 22      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No." }

    { 15  ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name" }

    { 1000000000;2;Field  ;
                CaptionML=ENU=<Vendor Cr. Memo No.>;
                SourceExpr=PurchCrMemoHeader."Vendor Cr. Memo No." }

    { 35  ;2   ;Field     ;
                SourceExpr="Currency Code" }

    { 13  ;2   ;Field     ;
                SourceExpr=Amount;
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              FORM.RUNMODAL(FORM::"Posted Purchase Credit Memo",Rec)
                            END;
                             }

    { 17  ;2   ;Field     ;
                SourceExpr="Amount Including VAT";
                OnDrillDown=BEGIN
                              SETRANGE("No.");
                              FORM.RUNMODAL(FORM::"Posted Purchase Credit Memo",Rec)
                            END;
                             }

    { 31  ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                SourceExpr="Buy-from Country/Region Code";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Visible=FALSE }

    { 127 ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Visible=FALSE }

    { 125 ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Visible=FALSE }

    { 37  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                SourceExpr="Pay-to Country/Region Code";
                Visible=FALSE }

    { 115 ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Visible=FALSE }

    { 25  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                SourceExpr="Ship-to Country/Region Code";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 87  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 85  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 8   ;2   ;Field     ;
                SourceExpr="No. Printed" }

    { 1102601001;2;Field  ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 1102601003;2;Field  ;
                SourceExpr="Applies-to Doc. Type";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchCrMemoHeader@1000000000 : Record 124;

    BEGIN
    END.
  }
}

OBJECT Page 232 Apply Customer Entries
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Apply Customer Entries;
               THA=ใช้รายการบัญชีที่แสดงข้อมูลลูกค้า];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table21;
    DataCaptionFields=Customer No.;
    PageType=Worksheet;
    OnInit=BEGIN
             "Applies-to IDVisible" := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF CalcType = CalcType::Direct THEN BEGIN
                   Cust.GET("Customer No.");
                   ApplnCurrencyCode := Cust."Currency Code";
                   FindApplyingEntry;
                 END;

                 IF ApplnType = ApplnType::"Applies-to Doc. No." THEN
                   "Applies-to IDVisible" := FALSE
                 ELSE
                   "Applies-to IDVisible" := TRUE;

                 GLSetup.GET;

                 IF ApplnType = ApplnType::"Applies-to Doc. No." THEN
                   CalcApplnAmount;
                 PostingDone := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",Rec);
                     EXIT(FALSE);
                   END;

    OnQueryClosePage=BEGIN
                       IF CloseAction = Action::LookupOK THEN
                         LookupOKOnPush;
                       IF ApplnType = ApplnType::"Applies-to Doc. No." THEN BEGIN
                         IF OK AND (ApplyingCustLedgEntry."Posting Date" < "Posting Date") THEN BEGIN
                           OK := FALSE;
                           ERROR(
                             Text006,ApplyingCustLedgEntry."Document Type",ApplyingCustLedgEntry."Document No.",
                             "Document Type","Document No.");
                         END;
                         IF OK THEN BEGIN
                           IF "Amount to Apply" = 0 THEN
                             "Amount to Apply" := "Remaining Amount";
                           CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",Rec);
                         END;
                       END;
                       IF (CalcType = CalcType::Direct) AND NOT OK AND NOT PostingDone THEN BEGIN
                         Rec := ApplyingCustLedgEntry;
                         "Applying Entry" := FALSE;
                         "Applies-to ID" := '';
                         "Amount to Apply" := 0;
                         CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",Rec);
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 37      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 38      ;2   ;Action    ;
                      CaptionML=[ENU=Reminder/Fin. Charge Entries;
                                 THA=รายการจดหมายเตือน/ค่าธรรมเนียมทางการเงิน];
                      RunObject=Page 444;
                      RunFormView=SORTING(Customer Entry No.);
                      RunFormLink=Customer Entry No.=FIELD(Entry No.) }
      { 95      ;2   ;Action    ;
                      CaptionML=[ENU=Applied E&ntries;
                                 THA=รายกา&รที่ใช้];
                      RunObject=Page 61;
                      RunFormOnRec=Yes }
      { 53      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 544;
                      RunFormLink=Table ID=CONST(21),Entry No.=FIELD(Entry No.);
                      Image=Dimensions }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Detailed &Ledger Entries;
                                 THA=รายการบัญชี&แยกประเภทโดยละเอียด];
                      RunObject=Page 573;
                      RunFormView=SORTING(Cust. Ledger Entry No.,Posting Date);
                      RunFormLink=Cust. Ledger Entry No.=FIELD(Entry No.) }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Application;
                                 THA=&แอพพลิเคชัน] }
      { 32      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Set Applies-to ID;
                                 THA=เซ็ต ID การใช้];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SelectLineToApply;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF (CalcType = CalcType::GenJnlLine) AND (ApplnType = ApplnType::"Applies-to Doc. No.") THEN
                                   ERROR(Text004);

                                 SetCustApplId;
                               END;
                                }
      { 34      ;2   ;Action    ;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Application;
                                 THA=ลงแอพลิเคชันในรายการบัญชี];
                      Promoted=Yes;
                      Image=PostApplication;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CustEntryApplyPostedEntries@1000000001 : Codeunit 226;
                               BEGIN
                                 IF CalcType = CalcType::Direct THEN BEGIN
                                   IF ApplyingCustLedgEntry."Entry No." <> 0 THEN BEGIN
                                     Rec := ApplyingCustLedgEntry;
                                     // Post Application
                                     CustEntryApplyPostedEntries.RUN(Rec);
                                     PostingDone := TRUE;
                                     CurrPage.CLOSE;
                                   END ELSE
                                     ERROR(Text002);
                                 END ELSE
                                   ERROR(Text003);
                               END;
                                }
      { 87      ;2   ;Separator ;
                      CaptionML=[ENU=-;
                                 THA=-] }
      { 88      ;2   ;Action    ;
                      CaptionML=;
                      OnAction=BEGIN
                                 ShowAppliedEntries := NOT ShowAppliedEntries;
                                 IF ShowAppliedEntries THEN BEGIN
                                   IF CalcType = CalcType::GenJnlLine THEN
                                     SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID")
                                   ELSE BEGIN
                                     CustEntryApplID := USERID;
                                     IF CustEntryApplID = '' THEN
                                       CustEntryApplID := '***';
                                     SETRANGE("Applies-to ID",CustEntryApplID);
                                   END;
                                 END ELSE
                                   SETRANGE("Applies-to ID");
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 36      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 70  ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 73  ;2   ;Field     ;
                CaptionML=[ENU=Posting Date;
                           THA=วันที่ลงรายการบัญชี];
                SourceExpr=ApplyingCustLedgEntry."Posting Date";
                Editable=FALSE }

    { 75  ;2   ;Field     ;
                CaptionML=[ENU=Document Type;
                           THA=ชนิดเอกสาร];
                OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                 THA=" ,การชำระเงิน,ใบแจ้งหนี้,ใบลดหนี้,บันทึกค่าธรรมเนียมทางการเงิน,จดหมายเตือน,คืนเงิน"];
                SourceExpr=ApplyingCustLedgEntry."Document Type";
                Editable=FALSE }

    { 77  ;2   ;Field     ;
                CaptionML=[ENU=Document No.;
                           THA=หมายเลขเอกสาร];
                SourceExpr=ApplyingCustLedgEntry."Document No.";
                Editable=FALSE }

    { 71  ;2   ;Field     ;
                CaptionML=[ENU=Customer No.;
                           THA=หมายเลขลูกค้า];
                SourceExpr=ApplyingCustLedgEntry."Customer No.";
                Editable=FALSE }

    { 85  ;2   ;Field     ;
                CaptionML=[ENU=Description;
                           THA=คำอธิบาย];
                SourceExpr=ApplyingCustLedgEntry.Description;
                Editable=FALSE }

    { 79  ;2   ;Field     ;
                CaptionML=[ENU=Currency Code;
                           THA=รหัสสกุลเงิน];
                SourceExpr=ApplyingCustLedgEntry."Currency Code";
                Editable=FALSE }

    { 81  ;2   ;Field     ;
                CaptionML=[ENU=Amount;
                           THA=จำนวน];
                SourceExpr=ApplyingCustLedgEntry.Amount;
                Editable=FALSE }

    { 83  ;2   ;Field     ;
                CaptionML=[ENU=Remaining Amount;
                           THA=จำนวนที่เหลือ];
                SourceExpr=ApplyingCustLedgEntry."Remaining Amount";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Applying Entry" }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 1000000000;2;Field  ;
                SourceExpr="Applying Entry" }

    { 22  ;2   ;Field     ;
                SourceExpr="Applies-to ID";
                Visible="Applies-to IDVisible" }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No.";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Customer No.";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Currency Code" }

    { 60  ;2   ;Field     ;
                SourceExpr="Original Amount";
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr=Amount;
                Visible=FALSE;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Remaining Amount";
                Editable=FALSE }

    { 33  ;2   ;Field     ;
                CaptionML=[ENU=Appln. Remaining Amount;
                           THA=จำนวนที่เหลือหลังการประยุกต์ใช้];
                SourceExpr=CalcApplnRemainingAmount("Remaining Amount");
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode }

    { 89  ;2   ;Field     ;
                SourceExpr="Amount to Apply";
                OnValidate=BEGIN
                             CODEUNIT.RUN(CODEUNIT::"Cust. Entry-Edit",Rec);

                             IF (xRec."Amount to Apply" = 0) OR (Rec."Amount to Apply" = 0) AND
                                (ApplnType = ApplnType::"Applies-to ID")
                             THEN
                               SetCustApplId;
                               AmounttoApplyOnAfterValidate;
                           END;
                            }

    { 93  ;2   ;Field     ;
                CaptionML=[ENU=Appln. Amount to Apply;
                           THA=มูลค่ารอแอพพลาย];
                SourceExpr=CalcApplnAmounttoApply("Amount to Apply");
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode }

    { 16  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 18  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                OnValidate=BEGIN
                             PmtDiscountDateOnAfterValidate;
                           END;
                            }

    { 65  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Tolerance Date" }

    { 20  ;2   ;Field     ;
                SourceExpr="Original Pmt. Disc. Possible";
                Visible=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Remaining Pmt. Disc. Possible";
                OnValidate=BEGIN
                             RemainingPmtDiscPossibleOnAfterValidate;
                           END;
                            }

    { 51  ;2   ;Field     ;
                CaptionML=[ENU=Appln. Pmt. Disc. Possible;
                           THA=การใช้ส่วนลดในการชำระเงินที่ใช้ได้];
                SourceExpr=CalcApplnRemainingAmount("Remaining Pmt. Disc. Possible");
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode }

    { 67  ;2   ;Field     ;
                SourceExpr="Max. Payment Tolerance" }

    { 24  ;2   ;Field     ;
                SourceExpr=Open;
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr=Positive;
                Editable=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code" }

    { 56  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code" }

    { 41  ;1   ;Group      }

    { 1903222401;2;Group  ;
                GroupType=FixedLayout }

    { 1901742001;3;Group  ;
                CaptionML=[ENU=Appln. Currency;
                           THA=สกุลเงินในแอพพลิเคชัน] }

    { 48  ;4   ;Field     ;
                SourceExpr=ApplnCurrencyCode;
                TableRelation=Currency;
                Editable=FALSE }

    { 1903098801;3;Group  ;
                CaptionML=[ENU=Amount to Apply;
                           THA=จำนวนที่ใช้] }

    { 44  ;4   ;Field     ;
                CaptionML=[ENU=Amount to Apply;
                           THA=จำนวนที่ใช้];
                SourceExpr=AppliedAmount;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1902760701;3;Group  ;
                CaptionML=[ENU=Pmt. Disc. Amount;
                           THA=จำนวนเงินส่วนลดในการชำระเงิน] }

    { 91  ;4   ;Field     ;
                CaptionML=[ENU=Pmt. Disc. Amount;
                           THA=จำนวนเงินส่วนลดในการชำระเงิน];
                SourceExpr=-PmtDiscAmount;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1901741901;3;Group  ;
                CaptionML=[ENU=Rounding;
                           THA=การปัดเศษ] }

    { 58  ;4   ;Field     ;
                CaptionML=[ENU=Rounding;
                           THA=การปัดเศษ];
                SourceExpr=ApplnRounding;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1900546301;3;Group  ;
                CaptionML=[ENU=Applied Amount;
                           THA=จำนวนที่ใช้] }

    { 97  ;4   ;Field     ;
                CaptionML=[ENU=Applied Amount;
                           THA=จำนวนที่ใช้];
                SourceExpr=AppliedAmount + (-PmtDiscAmount) + ApplnRounding;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1901991601;3;Group  ;
                CaptionML=[ENU=Available Amount;
                           THA=จำนวนที่ใช้ได้] }

    { 46  ;4   ;Field     ;
                CaptionML=[ENU=Available Amount;
                           THA=จำนวนที่ใช้ได้];
                SourceExpr=ApplyingAmount;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1900206001;3;Group  ;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ] }

    { 42  ;4   ;Field     ;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ];
                SourceExpr=AppliedAmount + (-PmtDiscAmount) + ApplyingAmount + ApplnRounding;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903096107;1;Part   ;
                SubFormLink=Entry No.=FIELD(Entry No.);
                PagePartID=Page9106;
                Visible=TRUE;
                PartType=Page }

  }
  CODE
  {
    VAR
      ApplyingCustLedgEntry@1000000000 : TEMPORARY Record 21;
      AppliedCustLedgEntry@1000000001 : Record 21;
      Currency@1000000002 : Record 4;
      CurrExchRate@1000000003 : Record 330;
      GenJnlLine@1000000004 : Record 81;
      GenJnlLine2@1000000005 : Record 81;
      SalesHeader@1000000006 : Record 36;
      ServHeader@1000000007 : Record 5900;
      Cust@1000000008 : Record 18;
      CustLedgEntry@1000000009 : Record 21;
      GLSetup@1000000010 : Record 98;
      TotalSalesLine@1000000011 : Record 37;
      TotalSalesLineLCY@1000000012 : Record 37;
      TotalServLine@1000000013 : Record 5902;
      TotalServLineLCY@1000000014 : Record 5902;
      Navigate@1000000015 : Form 344;
      GenJnlPostLine@1000000016 : Codeunit 12;
      CustEntrySetApplID@1000000017 : Codeunit 101;
      GenJnlApply@1000000018 : Codeunit 225;
      SalesPost@1000000019 : Codeunit 80;
      GenJnlLineApply@1000000020 : Boolean;
      AppliedAmount@1000000021 : Decimal;
      ApplyingAmount@1000000022 : Decimal;
      PmtDiscAmount@1000000023 : Decimal;
      ApplnDate@1000000024 : Date;
      ApplnCurrencyCode@1000000025 : Code[10];
      ApplnRoundingPrecision@1000000026 : Decimal;
      ApplnRounding@1000000027 : Decimal;
      ApplnType@1000000028 : ' ,Applies-to Doc. No.,Applies-to ID';
      AmountRoundingPrecision@1000000029 : Decimal;
      VATAmount@1000000030 : Decimal;
      VATAmountText@1000000031 : Text[30];
      ProfitLCY@1000000032 : Decimal;
      ProfitPct@1000000033 : Decimal;
      CalcType@1000000034 : 'Direct,GenJnlLine,SalesHeader,ServHeader';
      CustEntryApplID@1000000035 : Code[20];
      ValidExchRate@1000000036 : Boolean;
      DifferentCurrenciesInAppln@1000000037 : Boolean;
      Text002@1000000038 : TextConst 'ENU=You must select an applying entry before you can post the application.;THA=คุณต้องเลือกรายการที่ใช้ก่อนที่คุณจะสามารถลงรายการบัญชีการใช้ได้';
      ShowAppliedEntries@1000000039 : Boolean;
      Text003@1000000040 : TextConst 'ENU=You must post the application from the window where you entered the applying entry.;THA=คุณต้องลงรายการบัญชีการใช้จากหน้าต่างที่คุณเข้าสู่รายการที่ใช้';
      Text004@1000000041 : TextConst 'ENU=You are not allowed to set Applies-to ID while selecting Applies-to Doc. No.;THA=คุณไม่ได้รับอนุญาตให้ตั้ง ID การใช้ในขณะที่เลือก ใช้กับหมายเลขเอกสาร';
      OK@1000000042 : Boolean;
      Text006@1000000043 : TextConst 'ENU=You are not allowed to apply and post an entry to an entry with an earlier posting date.\\Instead, post %1 %2 and then apply it to %3 %4.;THA=คุณไม่สามารถปรับใช้และลงรายการในรายการที่มีวันที่ลงรายการบัญชีที่ผ่านไปแล้ว\\ให้ลงรายการบัญชี %1 %2 และนำมาใช้กับ %3 %4 แทน';
      PostingDone@1000000044 : Boolean;
      "Applies-to IDVisible"@19043506 : Boolean INDATASET;

    PROCEDURE SetGenJnlLine@1(NewGenJnlLine@1000000000 : Record 81;ApplnTypeSelect@1000000001 : Integer);
    BEGIN
      GenJnlLine := NewGenJnlLine;
      GenJnlLineApply := TRUE;

      IF GenJnlLine."Account Type" = GenJnlLine."Account Type"::Customer THEN
        ApplyingAmount := GenJnlLine.Amount;
      IF GenJnlLine."Bal. Account Type" = GenJnlLine."Bal. Account Type"::Customer THEN
        ApplyingAmount := -GenJnlLine.Amount;
      ApplnDate := GenJnlLine."Posting Date";
      ApplnCurrencyCode := GenJnlLine."Currency Code";
      CalcType := CalcType::GenJnlLine;

      CASE ApplnTypeSelect OF
        GenJnlLine.FIELDNO("Applies-to Doc. No."):
          ApplnType := ApplnType::"Applies-to Doc. No.";
        GenJnlLine.FIELDNO("Applies-to ID"):
          ApplnType := ApplnType::"Applies-to ID";
      END;

      SetApplyingCustLedgEntry;
    END;

    PROCEDURE SetSales@2(NewSalesHeader@1000000000 : Record 36;VAR NewCustLedgEntry@1000000001 : Record 21;ApplnTypeSelect@1000000002 : Integer);
    VAR
      TotalAdjCostLCY@1000000003 : Decimal;
    BEGIN
      SalesHeader := NewSalesHeader;
      Rec.COPYFILTERS(NewCustLedgEntry);

      SalesPost.SumSalesLines(
        SalesHeader,0,TotalSalesLine,TotalSalesLineLCY,
        VATAmount,VATAmountText,ProfitLCY,ProfitPct,TotalAdjCostLCY);

      CASE SalesHeader."Document Type" OF
        SalesHeader."Document Type"::"Return Order",
        SalesHeader."Document Type"::"Credit Memo":
          ApplyingAmount := -TotalSalesLine."Amount Including VAT"
        ELSE
          ApplyingAmount := TotalSalesLine."Amount Including VAT";
      END;

      ApplnDate := SalesHeader."Posting Date";
      ApplnCurrencyCode := SalesHeader."Currency Code";
      CalcType := CalcType::SalesHeader;

      CASE ApplnTypeSelect OF
        SalesHeader.FIELDNO("Applies-to Doc. No."):
          ApplnType := ApplnType::"Applies-to Doc. No.";
        SalesHeader.FIELDNO("Applies-to ID"):
          ApplnType := ApplnType::"Applies-to ID";
      END;

      SetApplyingCustLedgEntry;
    END;

    PROCEDURE SetService@8(NewServHeader@1000000000 : Record 5900;VAR NewCustLedgEntry@1000000001 : Record 21;ApplnTypeSelect@1000000002 : Integer);
    VAR
      ServAmountsMgt@1000000003 : Codeunit 5986;
      TotalAdjCostLCY@1000000004 : Decimal;
    BEGIN
      ServHeader := NewServHeader;
      Rec.COPYFILTERS(NewCustLedgEntry);

      ServAmountsMgt.SumServiceLines(
        ServHeader,0,TotalServLine,TotalServLineLCY,
        VATAmount,VATAmountText,ProfitLCY,ProfitPct,TotalAdjCostLCY);

      CASE ServHeader."Document Type" OF
        ServHeader."Document Type"::"Credit Memo":
          ApplyingAmount := -TotalServLine."Amount Including VAT"
        ELSE
          ApplyingAmount := TotalServLine."Amount Including VAT";
      END;

      ApplnDate := ServHeader."Posting Date";
      ApplnCurrencyCode := ServHeader."Currency Code";
      CalcType := CalcType::ServHeader;

      CASE ApplnTypeSelect OF
        ServHeader.FIELDNO("Applies-to Doc. No."):
          ApplnType := ApplnType::"Applies-to Doc. No.";
        ServHeader.FIELDNO("Applies-to ID"):
          ApplnType := ApplnType::"Applies-to ID";
      END;

      SetApplyingCustLedgEntry;
    END;

    PROCEDURE SetCustLedgEntry@13(NewCustLedgEntry@1000000000 : Record 21);
    BEGIN
      Rec := NewCustLedgEntry;
    END;

    PROCEDURE SetApplyingCustLedgEntry@9();
    VAR
      "CustEntry-Edit"@1000000000 : Codeunit 103;
    BEGIN
      CASE CalcType OF
        CalcType::SalesHeader:
          BEGIN
            ApplyingCustLedgEntry."Entry No." := 1;
            ApplyingCustLedgEntry."Posting Date" := SalesHeader."Posting Date";
            IF SalesHeader."Document Type" = SalesHeader."Document Type"::"Return Order" THEN
              ApplyingCustLedgEntry."Document Type" := SalesHeader."Document Type"::"Credit Memo"
            ELSE
              ApplyingCustLedgEntry."Document Type" := SalesHeader."Document Type";
            ApplyingCustLedgEntry."Document No." := SalesHeader."No.";
            ApplyingCustLedgEntry."Customer No." := SalesHeader."Bill-to Customer No.";
            ApplyingCustLedgEntry.Description := SalesHeader."Posting Description";
            ApplyingCustLedgEntry."Currency Code" := SalesHeader."Currency Code";
            IF ApplyingCustLedgEntry."Document Type" = ApplyingCustLedgEntry."Document Type"::"Credit Memo" THEN  BEGIN
              ApplyingCustLedgEntry.Amount := -TotalSalesLine."Amount Including VAT";
              ApplyingCustLedgEntry."Remaining Amount" := -TotalSalesLine."Amount Including VAT";
            END ELSE BEGIN
              ApplyingCustLedgEntry.Amount := TotalSalesLine."Amount Including VAT";
              ApplyingCustLedgEntry."Remaining Amount" := TotalSalesLine."Amount Including VAT";
            END;
            CalcApplnAmount;
          END;
        CalcType::ServHeader:
          BEGIN
            ApplyingCustLedgEntry."Entry No." := 1;
            ApplyingCustLedgEntry."Posting Date" := ServHeader."Posting Date";
            ApplyingCustLedgEntry."Document Type" := ServHeader."Document Type";
            ApplyingCustLedgEntry."Document No." := ServHeader."No.";
            ApplyingCustLedgEntry."Customer No." := ServHeader."Bill-to Customer No.";
            ApplyingCustLedgEntry.Description := ServHeader."Posting Description";
            ApplyingCustLedgEntry."Currency Code" := ServHeader."Currency Code";
            IF ApplyingCustLedgEntry."Document Type" = ApplyingCustLedgEntry."Document Type"::"Credit Memo" THEN  BEGIN
              ApplyingCustLedgEntry.Amount := -TotalServLine."Amount Including VAT";
              ApplyingCustLedgEntry."Remaining Amount" := -TotalServLine."Amount Including VAT";
            END ELSE BEGIN
              ApplyingCustLedgEntry.Amount := TotalServLine."Amount Including VAT";
              ApplyingCustLedgEntry."Remaining Amount" := TotalServLine."Amount Including VAT";
            END;
            CalcApplnAmount;
          END;
        CalcType::Direct:
          BEGIN
            IF "Applying Entry" THEN BEGIN
              IF ApplyingCustLedgEntry."Entry No." <> 0 THEN
                CustLedgEntry := ApplyingCustLedgEntry;
              "CustEntry-Edit".RUN(Rec);
              IF "Applies-to ID" = '' THEN
                SetCustApplId;
              CALCFIELDS(Amount);
              ApplyingCustLedgEntry := Rec;
              IF CustLedgEntry."Entry No." <> 0 THEN BEGIN
                Rec := CustLedgEntry;
                "Applying Entry" := FALSE;
                SetCustApplId;
              END;
              SETCURRENTKEY("Entry No.");
              SETFILTER("Entry No.",'<> %1',ApplyingCustLedgEntry."Entry No.");
              ApplyingAmount := ApplyingCustLedgEntry."Remaining Amount";
              ApplnDate := ApplyingCustLedgEntry."Posting Date";
              ApplnCurrencyCode := ApplyingCustLedgEntry."Currency Code";
            END;
            CalcApplnAmount;
          END;
        CalcType::GenJnlLine:
          BEGIN
            ApplyingCustLedgEntry."Entry No." := 1;
            ApplyingCustLedgEntry."Posting Date" := GenJnlLine."Posting Date";
            ApplyingCustLedgEntry."Document Type" := GenJnlLine."Document Type";
            ApplyingCustLedgEntry."Document No." := GenJnlLine."Document No.";
            ApplyingCustLedgEntry."Customer No." := GenJnlLine."Account No.";
            ApplyingCustLedgEntry.Description := GenJnlLine.Description;
            ApplyingCustLedgEntry."Currency Code" := GenJnlLine."Currency Code";
            ApplyingCustLedgEntry.Amount := GenJnlLine.Amount;
            ApplyingCustLedgEntry."Remaining Amount" := GenJnlLine.Amount;
            CalcApplnAmount;
          END;
      END;
    END;

    PROCEDURE SetCustApplId@11();
    BEGIN
      IF (CalcType = CalcType::GenJnlLine) AND (ApplyingCustLedgEntry."Posting Date" < "Posting Date") THEN
        ERROR(
          Text006,ApplyingCustLedgEntry."Document Type",ApplyingCustLedgEntry."Document No.",
          "Document Type","Document No.");

      IF ApplyingCustLedgEntry."Entry No." <> 0 THEN
        GenJnlApply.CheckAgainstApplnCurrency(
          ApplnCurrencyCode,"Currency Code",GenJnlLine."Account Type"::Customer,TRUE);

      CustLedgEntry.COPY(Rec);
      CurrPage.SETSELECTIONFILTER(CustLedgEntry);

      IF GenJnlLineApply THEN
        CustEntrySetApplID.SetApplId(
          CustLedgEntry,ApplyingCustLedgEntry,AppliedAmount,PmtDiscAmount,GenJnlLine."Applies-to ID")
      ELSE
        IF CalcType = CalcType::SalesHeader THEN
          CustEntrySetApplID.SetApplId(
            CustLedgEntry,ApplyingCustLedgEntry,AppliedAmount,PmtDiscAmount,SalesHeader."Applies-to ID")
        ELSE
          CustEntrySetApplID.SetApplId(
            CustLedgEntry,ApplyingCustLedgEntry,AppliedAmount,PmtDiscAmount,ServHeader."Applies-to ID");

      CalcApplnAmount;
    END;

    PROCEDURE CalcApplnAmount@4();
    VAR
      ExchAccGLJnlLine@1000000000 : Codeunit 366;
      I@1000000001 : Integer;
    BEGIN
      AppliedAmount := 0;
      PmtDiscAmount := 0;
      DifferentCurrenciesInAppln := FALSE;

      CASE CalcType OF
        CalcType::Direct:
          BEGIN
            FindAmountRounding;
            CustEntryApplID := USERID;
            IF CustEntryApplID = '' THEN
              CustEntryApplID := '***';

            CustLedgEntry := ApplyingCustLedgEntry;

            AppliedCustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive);
            AppliedCustLedgEntry.SETRANGE("Customer No.","Customer No.");
            AppliedCustLedgEntry.SETRANGE(Open,TRUE);
            AppliedCustLedgEntry.SETRANGE("Applies-to ID",CustEntryApplID);

            IF ApplyingCustLedgEntry."Entry No." <> 0 THEN BEGIN
              CustLedgEntry.CALCFIELDS("Remaining Amount");
              AppliedCustLedgEntry.SETFILTER("Entry No.",'<>%1',ApplyingCustLedgEntry."Entry No.");
            END;

            HandlChosenEntries(0,
              CustLedgEntry."Remaining Amount",
              CustLedgEntry."Currency Code",
              CustLedgEntry."Posting Date");
          END;

        CalcType::GenJnlLine:
          BEGIN
            FindAmountRounding;
            IF GenJnlLine."Bal. Account Type" = GenJnlLine."Bal. Account Type"::Customer THEN
              ExchAccGLJnlLine.RUN(GenJnlLine);

            CASE ApplnType OF
              ApplnType::"Applies-to Doc. No.":
                BEGIN
                  AppliedCustLedgEntry := Rec;
                  WITH AppliedCustLedgEntry DO BEGIN
                    CALCFIELDS("Remaining Amount");
                    IF "Currency Code" <> ApplnCurrencyCode THEN BEGIN
                      "Remaining Amount" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Remaining Amount");
                      "Remaining Pmt. Disc. Possible" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Remaining Pmt. Disc. Possible");
                      "Amount to Apply" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Amount to Apply");
                    END;

                    IF "Amount to Apply" <> 0 THEN
                      AppliedAmount := ROUND("Amount to Apply",AmountRoundingPrecision)
                    ELSE
                      AppliedAmount := ROUND("Remaining Amount",AmountRoundingPrecision);

                    IF GenJnlPostLine.CheckCalcPmtDiscGenJnlCust(
                         GenJnlLine,AppliedCustLedgEntry,0,FALSE) AND
                       ((ABS(GenJnlLine.Amount) + ApplnRoundingPrecision >=
                         ABS(AppliedAmount - "Remaining Pmt. Disc. Possible")) OR
                        (GenJnlLine.Amount = 0))
                    THEN
                      PmtDiscAmount := "Remaining Pmt. Disc. Possible";

                    IF NOT DifferentCurrenciesInAppln THEN
                      DifferentCurrenciesInAppln := ApplnCurrencyCode <> "Currency Code";

                  END;
                  CheckRounding;
                END;

              ApplnType::"Applies-to ID":
                BEGIN
                  GenJnlLine2 := GenJnlLine;
                  AppliedCustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive);
                  AppliedCustLedgEntry.SETRANGE("Customer No.",GenJnlLine."Account No.");
                  AppliedCustLedgEntry.SETRANGE(Open,TRUE);
                  AppliedCustLedgEntry.SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID");

                  HandlChosenEntries(1,
                    GenJnlLine2.Amount,
                    GenJnlLine2."Currency Code",
                    GenJnlLine2."Posting Date");
                END;
              END;
          END;

        CalcType::SalesHeader,CalcType::ServHeader:
          BEGIN
            FindAmountRounding;

            CASE ApplnType OF
              ApplnType::"Applies-to Doc. No.":
                BEGIN
                  AppliedCustLedgEntry := Rec;
                  WITH AppliedCustLedgEntry DO BEGIN
                    CALCFIELDS("Remaining Amount");

                    IF "Currency Code" <> ApplnCurrencyCode THEN
                      "Remaining Amount" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Remaining Amount");

                    AppliedAmount := ROUND("Remaining Amount",AmountRoundingPrecision);

                    IF NOT DifferentCurrenciesInAppln THEN
                      DifferentCurrenciesInAppln := ApplnCurrencyCode <> "Currency Code";

                  END;
                  CheckRounding;
                END;

              ApplnType::"Applies-to ID":
                BEGIN
                  AppliedCustLedgEntry.SETCURRENTKEY("Customer No.",Open,Positive);
                  IF CalcType = CalcType::SalesHeader THEN
                    AppliedCustLedgEntry.SETRANGE("Customer No.",SalesHeader."Bill-to Customer No.")
                  ELSE
                    AppliedCustLedgEntry.SETRANGE("Customer No.",ServHeader."Bill-to Customer No.");
                  AppliedCustLedgEntry.SETRANGE(Open,TRUE);
                  IF CalcType = CalcType::SalesHeader THEN
                    AppliedCustLedgEntry.SETRANGE("Applies-to ID",SalesHeader."Applies-to ID")
                  ELSE
                    AppliedCustLedgEntry.SETRANGE("Applies-to ID",ServHeader."Applies-to ID");

                  HandlChosenEntries(2,
                    GenJnlLine.Amount,
                    GenJnlLine."Currency Code",
                    GenJnlLine."Posting Date");

                END;
            END;
          END;
      END;
    END;

    PROCEDURE CalcApplnRemainingAmount@6(Amount@1000000000 : Decimal) : Decimal;
    VAR
      ApplnRemainingAmount@1000000001 : Decimal;
    BEGIN
      ValidExchRate := TRUE;
      IF ApplnCurrencyCode = "Currency Code" THEN
        EXIT(Amount);

      IF ApplnDate = 0D THEN
        ApplnDate := "Posting Date";
      ApplnRemainingAmount :=
        CurrExchRate.ApplnExchangeAmtFCYToFCY(
          ApplnDate,"Currency Code",ApplnCurrencyCode,Amount,ValidExchRate);
      EXIT(ApplnRemainingAmount);
    END;

    PROCEDURE CalcApplnAmounttoApply@10(AmounttoApply@1000000000 : Decimal) : Decimal;
    VAR
      ApplnAmounttoApply@1000000001 : Decimal;
    BEGIN
      ValidExchRate := TRUE;

      IF ApplnCurrencyCode = "Currency Code" THEN
        EXIT(AmounttoApply);

      IF ApplnDate = 0D THEN
        ApplnDate := "Posting Date";
      ApplnAmounttoApply :=
        CurrExchRate.ApplnExchangeAmtFCYToFCY(
          ApplnDate,"Currency Code",ApplnCurrencyCode,AmounttoApply,ValidExchRate);
      EXIT(ApplnAmounttoApply);
    END;

    PROCEDURE FindAmountRounding@7();
    BEGIN
      IF ApplnCurrencyCode = '' THEN BEGIN
        Currency.INIT;
        Currency.Code := '';
        Currency.InitRoundingPrecision;
      END ELSE
        IF ApplnCurrencyCode <> Currency.Code THEN
          Currency.GET(ApplnCurrencyCode);

      AmountRoundingPrecision := Currency."Amount Rounding Precision";
    END;

    PROCEDURE CheckRounding@3();
    BEGIN
      ApplnRounding := 0;

      CASE CalcType OF
        CalcType::SalesHeader,CalcType::ServHeader:
          EXIT;
        CalcType::GenJnlLine:
          IF ("Document Type" <> "Document Type"::Payment) AND
             ("Document Type" <> "Document Type"::Refund)
          THEN
            EXIT;
      END;

      IF ApplnCurrencyCode = '' THEN
        ApplnRoundingPrecision := GLSetup."Appln. Rounding Precision"
      ELSE BEGIN
        IF ApplnCurrencyCode <> "Currency Code" THEN
          Currency.GET(ApplnCurrencyCode);
        ApplnRoundingPrecision := Currency."Appln. Rounding Precision";
      END;

      IF (ABS((AppliedAmount - PmtDiscAmount) + ApplyingAmount) <= ApplnRoundingPrecision) AND DifferentCurrenciesInAppln THEN
        ApplnRounding := -((AppliedAmount - PmtDiscAmount) + ApplyingAmount);
    END;

    PROCEDURE GetCustLedgEntry@5(VAR CustLedgEntry@1000000000 : Record 21);
    BEGIN
      CustLedgEntry := Rec;
    END;

    PROCEDURE FindApplyingEntry@12();
    BEGIN
      IF CalcType = CalcType::Direct THEN BEGIN
        CustEntryApplID := USERID;
        IF CustEntryApplID = '' THEN
          CustEntryApplID := '***';

        CustLedgEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open);
        CustLedgEntry.SETRANGE("Customer No.","Customer No.");
        CustLedgEntry.SETRANGE("Applies-to ID",CustEntryApplID);
        CustLedgEntry.SETRANGE(Open,TRUE);
        CustLedgEntry.SETRANGE("Applying Entry",TRUE);
        IF CustLedgEntry.FIND('-') THEN BEGIN
          CustLedgEntry.CALCFIELDS(Amount,"Remaining Amount");
          ApplyingCustLedgEntry := CustLedgEntry;
          SETCURRENTKEY("Entry No.");
          SETFILTER("Entry No.",'<> %1',CustLedgEntry."Entry No.");
          ApplyingAmount := CustLedgEntry."Remaining Amount";
          ApplnDate := CustLedgEntry."Posting Date";
          ApplnCurrencyCode := CustLedgEntry."Currency Code";
        END;
        CalcApplnAmount;
      END;
    END;

    PROCEDURE HandlChosenEntries@14(Type@1000000000 : 'Direct,GenJnlLine,SalesHeader';CurrentAmount@1000000001 : Decimal;CurrencyCode@1000000002 : Code[10];"Posting Date"@1000000003 : Date);
    VAR
      AppliedCustLedgEntryTemp@1000000004 : TEMPORARY Record 21;
      PossiblePmtDisc@1000000005 : Decimal;
      OldPmtDisc@1000000006 : Decimal;
      CorrectionAmount@1000000007 : Decimal;
      CalculateCurrency@1000000008 : Boolean;
      CanUseDisc@1000000009 : Boolean;
      FromZeroGenJnl@1000000010 : Boolean;
    BEGIN
      IF AppliedCustLedgEntry.FINDSET(FALSE,FALSE) THEN BEGIN
        REPEAT
          AppliedCustLedgEntryTemp := AppliedCustLedgEntry;
          AppliedCustLedgEntryTemp.INSERT;
        UNTIL AppliedCustLedgEntry.NEXT = 0;
      END ELSE
        EXIT;

      FromZeroGenJnl := (CurrentAmount = 0) AND (Type = Type::GenJnlLine);

      REPEAT
        IF NOT FromZeroGenJnl THEN
          AppliedCustLedgEntryTemp.SETRANGE(Positive,CurrentAmount < 0);
        IF AppliedCustLedgEntryTemp.FINDFIRST THEN BEGIN
          AppliedCustLedgEntryTemp.CALCFIELDS("Remaining Amount");

          IF Type = Type::Direct THEN
            CalculateCurrency := ApplyingCustLedgEntry."Entry No." <> 0
          ELSE
            CalculateCurrency := TRUE;


          IF (CurrencyCode <> AppliedCustLedgEntryTemp."Currency Code") AND CalculateCurrency THEN BEGIN
            AppliedCustLedgEntryTemp."Remaining Amount" :=
              GenJnlPostLine.ExchAmount(
                AppliedCustLedgEntryTemp."Remaining Amount",
                AppliedCustLedgEntryTemp."Currency Code",
                CurrencyCode,"Posting Date");
            AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible" :=
              GenJnlPostLine.ExchAmount(
                AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible",
                AppliedCustLedgEntryTemp."Currency Code",
                CurrencyCode,"Posting Date");
            AppliedCustLedgEntryTemp."Amount to Apply" :=
              GenJnlPostLine.ExchAmount(
                AppliedCustLedgEntryTemp."Amount to Apply",
                AppliedCustLedgEntryTemp."Currency Code",
                CurrencyCode,"Posting Date");
          END;

          CASE Type OF
            Type::Direct:
              CanUseDisc := GenJnlPostLine.CheckCalcPmtDiscCust(CustLedgEntry,AppliedCustLedgEntryTemp,0,FALSE,FALSE);
            Type::GenJnlLine:
              CanUseDisc := GenJnlPostLine.CheckCalcPmtDiscGenJnlCust(GenJnlLine2,AppliedCustLedgEntryTemp,0,FALSE)
            ELSE
              CanUseDisc := FALSE;
          END;

          IF CanUseDisc AND
            (ABS(AppliedCustLedgEntryTemp."Amount to Apply") >= ABS(AppliedCustLedgEntryTemp."Remaining Amount" -
            AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible")) THEN BEGIN

            IF (ABS(CurrentAmount - PossiblePmtDisc) > ABS(AppliedCustLedgEntryTemp."Remaining Amount" -
              AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible"))
            THEN BEGIN
              PmtDiscAmount := PmtDiscAmount + AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible";
              CurrentAmount := CurrentAmount + AppliedCustLedgEntryTemp."Remaining Amount" -
                AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible";
            END ELSE IF (ABS(CurrentAmount - PossiblePmtDisc) = ABS(AppliedCustLedgEntryTemp."Remaining Amount" -
              AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible"))
            THEN BEGIN
              PmtDiscAmount := PmtDiscAmount + AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible" + PossiblePmtDisc;
              CurrentAmount := CurrentAmount + AppliedCustLedgEntryTemp."Remaining Amount" -
                AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible" - PossiblePmtDisc;
              PossiblePmtDisc := 0;
              AppliedAmount := AppliedAmount + CorrectionAmount;
            END ELSE IF (FromZeroGenJnl) THEN BEGIN
              PmtDiscAmount := PmtDiscAmount + AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible";
              CurrentAmount := CurrentAmount +
                AppliedCustLedgEntryTemp."Remaining Amount" - AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible";
            END ELSE BEGIN
              IF (CurrentAmount + AppliedCustLedgEntryTemp."Remaining Amount" >= 0) <> (CurrentAmount >= 0) THEN BEGIN
                PmtDiscAmount := PmtDiscAmount + PossiblePmtDisc;
                CurrentAmount := CurrentAmount - PossiblePmtDisc;
                AppliedAmount := AppliedAmount + CorrectionAmount;
              END;
              CurrentAmount := CurrentAmount + AppliedCustLedgEntryTemp."Remaining Amount";
              PossiblePmtDisc := AppliedCustLedgEntryTemp."Remaining Pmt. Disc. Possible";
            END;
          END ELSE BEGIN
            IF (((CurrentAmount - PossiblePmtDisc + AppliedCustLedgEntryTemp."Amount to Apply") * CurrentAmount) <= 0) THEN BEGIN
              PmtDiscAmount := PmtDiscAmount + PossiblePmtDisc;
              CurrentAmount := CurrentAmount - PossiblePmtDisc;
              PossiblePmtDisc := 0;
              AppliedAmount := AppliedAmount + CorrectionAmount;
            END;
            CurrentAmount := CurrentAmount + AppliedCustLedgEntryTemp."Amount to Apply";
          END;
        END ELSE BEGIN
          AppliedCustLedgEntryTemp.SETRANGE(Positive);
          AppliedCustLedgEntryTemp.FINDFIRST;
        END;

        IF (OldPmtDisc <> PmtDiscAmount) THEN
          AppliedAmount := AppliedAmount + AppliedCustLedgEntryTemp."Remaining Amount"
        ELSE
          AppliedAmount := AppliedAmount + AppliedCustLedgEntryTemp."Amount to Apply";
        OldPmtDisc := PmtDiscAmount;

        IF PossiblePmtDisc <> 0 THEN
          CorrectionAmount := AppliedCustLedgEntryTemp."Remaining Amount" - AppliedCustLedgEntryTemp."Amount to Apply"
        ELSE
          CorrectionAmount := 0;

        IF NOT DifferentCurrenciesInAppln THEN
          DifferentCurrenciesInAppln:= ApplnCurrencyCode <> AppliedCustLedgEntryTemp."Currency Code";

        AppliedCustLedgEntryTemp.DELETE;
        AppliedCustLedgEntryTemp.SETRANGE(Positive);

      UNTIL NOT AppliedCustLedgEntryTemp.FINDFIRST;
      CheckRounding;
    END;

    LOCAL PROCEDURE AmounttoApplyOnAfterValidate@19038179();
    BEGIN
      IF ApplnType <> ApplnType::"Applies-to Doc. No." THEN BEGIN
        CalcApplnAmount;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE PmtDiscountDateOnAfterValidate@19051222();
    BEGIN
      CurrPage.UPDATE(TRUE);
      CalcApplnAmount;
    END;

    LOCAL PROCEDURE RemainingPmtDiscPossibleOnAfte@19061040();
    BEGIN
      CurrPage.UPDATE(TRUE);
      CalcApplnAmount;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      IF ApplnType = ApplnType::"Applies-to Doc. No." THEN
        CalcApplnAmount;
    END;

    LOCAL PROCEDURE LookupOKOnPush@19031339();
    BEGIN
      OK := TRUE;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 233 Apply Vendor Entries
{
  OBJECT-PROPERTIES
  {
    Date=12/27/11;
    Time=10:33:04 AM;
    Modified=Yes;
    Version List=NAVW16.00.01,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Apply Vendor Entries;
               THA=ใช้รายการบัญชีที่แสดงข้อมูลผู้ขาย];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table25;
    DataCaptionFields=Vendor No.;
    PageType=Worksheet;
    OnInit=BEGIN
             "Applies-to IDVisible" := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF CalcType = CalcType::Direct THEN BEGIN
                   Vend.GET("Vendor No.");
                   ApplnCurrencyCode := Vend."Currency Code";
                   FindApplyingEntry;
                 END;

                 IF ApplnType = ApplnType::"Applies-to Doc. No." THEN
                   "Applies-to IDVisible" := FALSE
                 ELSE
                   "Applies-to IDVisible" := TRUE;

                 GLSetup.GET;

                 IF CalcType = CalcType::GenJnlLine THEN
                   CalcApplnAmount;
                 PostingDone := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    OnModifyRecord=BEGIN
                     CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",Rec);
                     EXIT(FALSE);
                   END;

    OnQueryClosePage=BEGIN
                       IF CloseAction = Action::LookupOK THEN
                         LookupOKOnPush;
                       IF ApplnType = ApplnType::"Applies-to Doc. No." THEN BEGIN
                         IF OK AND (ApplyingVendLedgEntry."Posting Date" < "Posting Date") THEN BEGIN
                           OK := FALSE;
                           ERROR(
                             Text006,ApplyingVendLedgEntry."Document Type",ApplyingVendLedgEntry."Document No.",
                             "Document Type","Document No.");
                         END;
                         IF OK THEN BEGIN
                           IF "Amount to Apply" = 0 THEN
                             "Amount to Apply" := "Remaining Amount";
                           CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",Rec);
                         END;
                       END;

                       IF (CalcType = CalcType::Direct) AND NOT OK AND NOT PostingDone THEN BEGIN
                         Rec := ApplyingVendLedgEntry;
                         "Applying Entry" := FALSE;
                         "Applies-to ID" := '';
                         "Amount to Apply" := 0;
                         CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",Rec);
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 37      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 31      ;2   ;Action    ;
                      CaptionML=[ENU=Applied E&ntries;
                                 THA=รายกา&รที่ใช้];
                      RunObject=Page 62;
                      RunFormOnRec=Yes }
      { 57      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 544;
                      RunFormLink=Table ID=CONST(25),Entry No.=FIELD(Entry No.);
                      Image=Dimensions }
      { 63      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Detailed &Ledger Entries;
                                 THA=รายการบัญชี&แยกประเภทโดยละเอียด];
                      RunObject=Page 574;
                      RunFormView=SORTING(Vendor Ledger Entry No.,Posting Date);
                      RunFormLink=Vendor Ledger Entry No.=FIELD(Entry No.) }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Application;
                                 THA=&แอพพลิเคชัน] }
      { 32      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Set Applies-to ID;
                                 THA=เซ็ต ID การใช้];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SelectLineToApply;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF (CalcType = CalcType::GenJnlLine) AND (ApplnType = ApplnType::"Applies-to Doc. No.") THEN
                                   ERROR(Text004);

                                 SetVendApplId;
                               END;
                                }
      { 34      ;2   ;Action    ;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Application;
                                 THA=ลงแอพลิเคชันในรายการบัญชี];
                      Promoted=Yes;
                      Image=PostApplication;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 VendEntryApplyPostedEntries@1000000001 : Codeunit 227;
                               BEGIN
                                 IF CalcType = CalcType::Direct THEN BEGIN
                                   IF ApplyingVendLedgEntry."Entry No." <> 0 THEN BEGIN
                                     Rec := ApplyingVendLedgEntry;
                                     // Post Application
                                     VendEntryApplyPostedEntries.RUN(Rec);
                                     PostingDone := TRUE;
                                     CurrPage.CLOSE;
                                   END ELSE
                                     ERROR(Text002);
                                 END ELSE
                                   ERROR(Text003);
                               END;
                                }
      { 99      ;2   ;Separator ;
                      CaptionML=[ENU=-;
                                 THA=-] }
      { 100     ;2   ;Action    ;
                      CaptionML=;
                      OnAction=BEGIN
                                 ShowAppliedEntries := NOT ShowAppliedEntries;
                                 IF ShowAppliedEntries THEN BEGIN
                                   IF CalcType = CalcType::GenJnlLine THEN
                                     SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID")
                                   ELSE BEGIN
                                     VendEntryApplID := USERID;
                                     IF VendEntryApplID = '' THEN
                                       VendEntryApplID := '***';
                                     SETRANGE("Applies-to ID",VendEntryApplID);
                                   END;
                                 END ELSE
                                   SETRANGE("Applies-to ID");
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000002;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชั่น] }
      { 1000000004;2 ;Action    ;
                      CaptionML=[ENU=Reset Applies-to ID on Close Entry;
                                 THA=ยกเลิก ID การใช้ในรายการที่ปิด];
                      OnAction=VAR
                                 VendEntryEdit@1000000001 : Codeunit 113;
                               BEGIN
                                 //KKE : #002 +
                                 IF NOT CONFIRM(Text50000,FALSE) THEN
                                   EXIT;

                                 VendEntryEdit.ResetAppliestoIDOnCloseEntry;
                                 CLEAR(VendEntryEdit);
                                 //KKE : #002 -
                               END;
                                }
      { 36      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 70  ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 73  ;2   ;Field     ;
                CaptionML=[ENU=Posting Date;
                           THA=วันที่ลงรายการบัญชี];
                SourceExpr=ApplyingVendLedgEntry."Posting Date";
                Editable=FALSE }

    { 75  ;2   ;Field     ;
                CaptionML=[ENU=Document Type;
                           THA=ชนิดเอกสาร];
                OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                 THA=" ,การชำระเงิน,ใบแจ้งหนี้,ใบลดหนี้,บันทึกค่าธรรมเนียมทางการเงิน,จดหมายเตือน,คืนเงิน"];
                SourceExpr=ApplyingVendLedgEntry."Document Type";
                Editable=FALSE }

    { 77  ;2   ;Field     ;
                CaptionML=[ENU=Document No.;
                           THA=หมายเลขเอกสาร];
                SourceExpr=ApplyingVendLedgEntry."Document No.";
                Editable=FALSE }

    { 71  ;2   ;Field     ;
                CaptionML=[ENU=Vendor No.;
                           THA=หมายเลขผู้ขาย];
                SourceExpr=ApplyingVendLedgEntry."Vendor No.";
                Editable=FALSE }

    { 85  ;2   ;Field     ;
                CaptionML=[ENU=Description;
                           THA=คำอธิบาย];
                SourceExpr=ApplyingVendLedgEntry.Description;
                Editable=FALSE }

    { 79  ;2   ;Field     ;
                CaptionML=[ENU=Currency Code;
                           THA=รหัสสกุลเงิน];
                SourceExpr=ApplyingVendLedgEntry."Currency Code";
                Editable=FALSE }

    { 81  ;2   ;Field     ;
                CaptionML=[ENU=Amount;
                           THA=จำนวน];
                SourceExpr=ApplyingVendLedgEntry.Amount;
                Editable=FALSE }

    { 83  ;2   ;Field     ;
                CaptionML=[ENU=Remaining Amount;
                           THA=จำนวนที่เหลือ];
                SourceExpr=ApplyingVendLedgEntry."Remaining Amount";
                Editable=FALSE }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 22  ;2   ;Field     ;
                SourceExpr="Applies-to ID";
                Visible="Applies-to IDVisible" }

    { 1000000000;2;Field  ;
                SourceExpr="Applying Entry" }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No.";
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="External Document No." }

    { 8   ;2   ;Field     ;
                SourceExpr="Vendor No.";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Currency Code" }

    { 61  ;2   ;Field     ;
                SourceExpr="Original Amount";
                Visible=FALSE;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr=Amount;
                Visible=FALSE;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Remaining Amount";
                Editable=FALSE }

    { 33  ;2   ;Field     ;
                CaptionML=[ENU=Appln. Remaining Amount;
                           THA=จำนวนที่เหลือหลังการประยุกต์ใช้];
                SourceExpr=CalcApplnRemainingAmount("Remaining Amount");
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode }

    { 90  ;2   ;Field     ;
                SourceExpr="Amount to Apply";
                OnValidate=BEGIN
                             CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",Rec);

                             IF (xRec."Amount to Apply" = 0) OR (Rec."Amount to Apply" = 0) AND
                               (ApplnType = ApplnType::"Applies-to ID")
                             THEN
                               SetVendApplId;
                               AmounttoApplyOnAfterValidate;
                           END;
                            }

    { 92  ;2   ;Field     ;
                CaptionML=[ENU=Appln. Amount to Apply;
                           THA=มูลค่ารอแอพพลาย];
                SourceExpr=CalcApplnAmounttoApply("Amount to Apply");
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode }

    { 16  ;2   ;Field     ;
                SourceExpr="Due Date" }

    { 18  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                OnValidate=BEGIN
                             PmtDiscountDateOnAfterValidate;
                           END;
                            }

    { 66  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Tolerance Date" }

    { 20  ;2   ;Field     ;
                SourceExpr="Original Pmt. Disc. Possible";
                Visible=FALSE }

    { 64  ;2   ;Field     ;
                SourceExpr="Remaining Pmt. Disc. Possible";
                OnValidate=BEGIN
                             RemainingPmtDiscPossibleOnAfterValidate;
                           END;
                            }

    { 51  ;2   ;Field     ;
                CaptionML=[ENU=Appln. Pmt. Disc. Possible;
                           THA=การใช้ส่วนลดในการชำระเงินที่ใช้ได้];
                SourceExpr=CalcApplnRemainingAmount("Remaining Pmt. Disc. Possible");
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode }

    { 68  ;2   ;Field     ;
                SourceExpr="Max. Payment Tolerance" }

    { 24  ;2   ;Field     ;
                SourceExpr=Open;
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr=Positive;
                Editable=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code" }

    { 59  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code" }

    { 41  ;1   ;Group      }

    { 1903222401;2;Group  ;
                GroupType=FixedLayout }

    { 1903866701;3;Group  ;
                CaptionML=[ENU=Appln. Currency;
                           THA=สกุลเงินในแอพพลิเคชัน] }

    { 49  ;4   ;Field     ;
                SourceExpr=ApplnCurrencyCode;
                TableRelation=Currency;
                Editable=FALSE }

    { 1900545201;3;Group  ;
                CaptionML=[ENU=Amount to Apply;
                           THA=จำนวนที่ใช้] }

    { 45  ;4   ;Field     ;
                CaptionML=[ENU=Amount to Apply;
                           THA=จำนวนที่ใช้];
                SourceExpr=AppliedAmount;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1903099901;3;Group  ;
                CaptionML=[ENU=Pmt. Disc. Amount;
                           THA=จำนวนเงินส่วนลดในการชำระเงิน] }

    { 94  ;4   ;Field     ;
                CaptionML=[ENU=Pmt. Disc. Amount;
                           THA=จำนวนเงินส่วนลดในการชำระเงิน];
                SourceExpr=-PmtDiscAmount;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1901652301;3;Group  ;
                CaptionML=[ENU=Rounding;
                           THA=การปัดเศษ] }

    { 53  ;4   ;Field     ;
                CaptionML=[ENU=Rounding;
                           THA=การปัดเศษ];
                SourceExpr=ApplnRounding;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1901992701;3;Group  ;
                CaptionML=[ENU=Applied Amount;
                           THA=จำนวนที่ใช้] }

    { 98  ;4   ;Field     ;
                CaptionML=[ENU=Applied Amount;
                           THA=จำนวนที่ใช้];
                SourceExpr=AppliedAmount + (-PmtDiscAmount) + ApplnRounding;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1900295601;3;Group  ;
                CaptionML=[ENU=Available Amount;
                           THA=จำนวนที่ใช้ได้] }

    { 47  ;4   ;Field     ;
                CaptionML=[ENU=Available Amount;
                           THA=จำนวนที่ใช้ได้];
                SourceExpr=ApplyingAmount;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

    { 1901652401;3;Group  ;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ] }

    { 43  ;4   ;Field     ;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ];
                SourceExpr=AppliedAmount + (-PmtDiscAmount) + ApplyingAmount + ApplnRounding;
                AutoFormatType=1;
                AutoFormatExpr=ApplnCurrencyCode;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      ApplyingVendLedgEntry@1000000000 : TEMPORARY Record 25;
      AppliedVendLedgEntry@1000000001 : Record 25;
      Currency@1000000002 : Record 4;
      CurrExchRate@1000000003 : Record 330;
      GenJnlLine@1000000004 : Record 81;
      GenJnlLine2@1000000005 : Record 81;
      PurchHeader@1000000006 : Record 38;
      Vend@1000000007 : Record 23;
      VendLedgEntry@1000000008 : Record 25;
      GLSetup@1000000009 : Record 98;
      TotalPurchLine@1000000010 : Record 39;
      TotalPurchLineLCY@1000000011 : Record 39;
      Navigate@1000000012 : Form 344;
      GenJnlPostLine@1000000013 : Codeunit 12;
      VendEntrySetApplID@1000000014 : Codeunit 111;
      GenJnlApply@1000000015 : Codeunit 225;
      PurchPost@1000000016 : Codeunit 90;
      GenJnlLineApply@1000000017 : Boolean;
      AppliedAmount@1000000018 : Decimal;
      ApplyingAmount@1000000019 : Decimal;
      PmtDiscAmount@1000000020 : Decimal;
      ApplnDate@1000000021 : Date;
      ApplnCurrencyCode@1000000022 : Code[10];
      ApplnRoundingPrecision@1000000023 : Decimal;
      ApplnRounding@1000000024 : Decimal;
      ApplnType@1000000025 : ' ,Applies-to Doc. No.,Applies-to ID';
      AmountRoundingPrecision@1000000026 : Decimal;
      VATAmount@1000000027 : Decimal;
      VATAmountText@1000000028 : Text[30];
      CalcType@1000000029 : 'Direct,GenJnlLine,PurchHeader';
      VendEntryApplID@1000000030 : Code[20];
      ValidExchRate@1000000031 : Boolean;
      DifferentCurrenciesFound@1000000032 : Boolean;
      DifferentCurrenciesInAppln@1000000033 : Boolean;
      Text002@1000000034 : TextConst 'ENU=You must select an applying entry before you can post the application.;THA=คุณต้องเลือกรายการที่ใช้ก่อนที่คุณจะสามารถลงรายการบัญชีการใช้ได้';
      Text003@1000000035 : TextConst 'ENU=You must post the application from the window where you entered the applying entry.;THA=คุณต้องลงรายการบัญชีการใช้จากหน้าต่างที่คุณเข้าสู่รายการที่ใช้';
      Text004@1000000036 : TextConst 'ENU=You are not allowed to set Applies-to ID while selecting Applies-to Doc. No.;THA=คุณไม่ได้รับอนุญาตให้ตั้ง ID การใช้ในขณะที่เลือก ใช้กับหมายเลขเอกสาร';
      ShowAppliedEntries@1000000037 : Boolean;
      OK@1000000038 : Boolean;
      Text006@1000000039 : TextConst 'ENU=You are not allowed to apply and post an entry to an entry with an earlier posting date.\\Instead, post %1 %2 and then apply it to %3 %4.;THA=คุณไม่สามารถปรับใช้และลงรายการในรายการที่มีวันที่ลงรายการบัญชีที่ผ่านไปแล้ว\\ให้ลงรายการบัญชี %1 %2 และนำมาใช้กับ %3 %4 แทน';
      PostingDone@1000000040 : Boolean;
      Text50000@1000000041 : TextConst 'ENU=Do you want to reset applies-to id on closed entry?;THA=คุณต้องการยกเลิก ID การใช้ในรายการที่ปิดไปแล้วใช่หรือไม่?';
      "Applies-to IDVisible"@19043506 : Boolean INDATASET;

    PROCEDURE SetGenJnlLine@1(NewGenJnlLine@1000000000 : Record 81;ApplnTypeSelect@1000000001 : Integer);
    BEGIN
      GenJnlLine := NewGenJnlLine;
      GenJnlLineApply := TRUE;

      IF GenJnlLine."Account Type" = GenJnlLine."Account Type"::Vendor THEN
        ApplyingAmount := GenJnlLine.Amount;
      IF GenJnlLine."Bal. Account Type" = GenJnlLine."Bal. Account Type"::Vendor THEN
        ApplyingAmount := -GenJnlLine.Amount;
      ApplnDate := GenJnlLine."Posting Date";
      ApplnCurrencyCode := GenJnlLine."Currency Code";
      CalcType := CalcType::GenJnlLine;

      CASE ApplnTypeSelect OF
        GenJnlLine.FIELDNO("Applies-to Doc. No.") :
          ApplnType := ApplnType::"Applies-to Doc. No.";
        GenJnlLine.FIELDNO("Applies-to ID") :
          ApplnType := ApplnType::"Applies-to ID";
      END;

      SetApplyingVendLedgEntry;
    END;

    PROCEDURE SetPurch@2(NewPurchHeader@1000000000 : Record 38;VAR NewVendLedgEntry@1000000001 : Record 25;ApplnTypeSelect@1000000002 : Integer);
    BEGIN
      PurchHeader := NewPurchHeader;
      Rec.COPYFILTERS(NewVendLedgEntry);

      PurchPost.SumPurchLines(
        PurchHeader,0,TotalPurchLine,TotalPurchLineLCY,
        VATAmount,VATAmountText);

      CASE PurchHeader."Document Type" OF
        PurchHeader."Document Type"::"Return Order",
        PurchHeader."Document Type"::"Credit Memo":
          ApplyingAmount := TotalPurchLine."Amount Including VAT"
        ELSE
          ApplyingAmount := -TotalPurchLine."Amount Including VAT";
      END;

      ApplnDate := PurchHeader."Posting Date";
      ApplnCurrencyCode := PurchHeader."Currency Code";
      CalcType := CalcType::PurchHeader;

      CASE ApplnTypeSelect OF
        PurchHeader.FIELDNO("Applies-to Doc. No.") :
          ApplnType := ApplnType::"Applies-to Doc. No.";
        PurchHeader.FIELDNO("Applies-to ID") :
          ApplnType := ApplnType::"Applies-to ID";
      END;

      SetApplyingVendLedgEntry;
    END;

    PROCEDURE SetVendLedgEntry@13(NewVendLedgEntry@1000000000 : Record 25);
    BEGIN
      Rec := NewVendLedgEntry;
    END;

    PROCEDURE SetApplyingVendLedgEntry@9();
    VAR
      "VendEntry-Edit"@1000000000 : Codeunit 113;
      rVendLedgEntry@1000000001 : Record 25;
    BEGIN
      CASE CalcType OF
        CalcType::PurchHeader :
          BEGIN
            ApplyingVendLedgEntry."Posting Date" := PurchHeader."Posting Date";
            IF PurchHeader."Document Type" = PurchHeader."Document Type"::"Return Order" THEN
              ApplyingVendLedgEntry."Document Type" := PurchHeader."Document Type"::"Credit Memo"
            ELSE
              ApplyingVendLedgEntry."Document Type" := PurchHeader."Document Type";
            ApplyingVendLedgEntry."Document No." := PurchHeader."No.";
            ApplyingVendLedgEntry."Vendor No." := PurchHeader."Pay-to Vendor No.";
            ApplyingVendLedgEntry.Description := PurchHeader."Posting Description";
            ApplyingVendLedgEntry."Currency Code" := PurchHeader."Currency Code";
            IF ApplyingVendLedgEntry."Document Type" = ApplyingVendLedgEntry."Document Type"::"Credit Memo" THEN  BEGIN
              ApplyingVendLedgEntry.Amount := TotalPurchLine."Amount Including VAT";
              ApplyingVendLedgEntry."Remaining Amount" := TotalPurchLine."Amount Including VAT";
            END ELSE BEGIN
              ApplyingVendLedgEntry.Amount := -TotalPurchLine."Amount Including VAT";
              ApplyingVendLedgEntry."Remaining Amount" := -TotalPurchLine."Amount Including VAT";
            END;
            CalcApplnAmount;
          END;
        CalcType::Direct :
          BEGIN
            IF "Applying Entry" THEN BEGIN
              IF ApplyingVendLedgEntry."Entry No." <> 0 THEN
                VendLedgEntry := ApplyingVendLedgEntry;
              "VendEntry-Edit".RUN(Rec);
              IF "Applies-to ID" = '' THEN
                SetVendApplId;
              CALCFIELDS(Amount);
              //KKE : #001 +
              IF Amount < 0 THEN BEGIN
                rVendLedgEntry.COPY(Rec);
                CurrPage.SETSELECTIONFILTER(rVendLedgEntry);
                rVendLedgEntry.SETFILTER(Amount,'>%1',0);
                IF rVendLedgEntry.FIND('-') THEN
                  ApplyingVendLedgEntry := rVendLedgEntry
                ELSE
                  ApplyingVendLedgEntry := Rec;

              END ELSE
              //KKE : #001 -
              ApplyingVendLedgEntry := Rec;
              IF VendLedgEntry."Entry No." <> 0 THEN BEGIN
                Rec := VendLedgEntry;
                "Applying Entry" := FALSE;
                SetVendApplId;
              END;
              SETCURRENTKEY("Entry No.");
              SETFILTER("Entry No.",'<> %1',ApplyingVendLedgEntry."Entry No.");
              ApplyingAmount := ApplyingVendLedgEntry."Remaining Amount";
              ApplnDate := ApplyingVendLedgEntry."Posting Date";
              ApplnCurrencyCode := ApplyingVendLedgEntry."Currency Code";
              //KKE : #001 +
              rVendLedgEntry := Rec;
              rVendLedgEntry.MODIFY;
              "Applies-to ID" := VendEntryApplID;
              //KKE : #001 -
            END;
            CalcApplnAmount;
          END;
        CalcType::GenJnlLine :
          BEGIN
            ApplyingVendLedgEntry."Posting Date" := GenJnlLine."Posting Date";
            ApplyingVendLedgEntry."Document Type" := GenJnlLine."Document Type";
            ApplyingVendLedgEntry."Document No." := GenJnlLine."Document No.";
            ApplyingVendLedgEntry."Vendor No." := GenJnlLine."Account No.";
            ApplyingVendLedgEntry.Description := GenJnlLine.Description;
            ApplyingVendLedgEntry."Currency Code" := GenJnlLine."Currency Code";
            ApplyingVendLedgEntry.Amount := GenJnlLine.Amount;
            ApplyingVendLedgEntry."Remaining Amount" := GenJnlLine.Amount;
            CalcApplnAmount;
          END;
      END;
    END;

    PROCEDURE SetVendApplId@10();
    BEGIN
      IF (CalcType = CalcType::GenJnlLine) AND (ApplyingVendLedgEntry."Posting Date" < "Posting Date") THEN
        ERROR(
          Text006,ApplyingVendLedgEntry."Document Type",ApplyingVendLedgEntry."Document No.",
          "Document Type","Document No.");

      IF ApplyingVendLedgEntry."Entry No." <> 0 THEN
        GenJnlApply.CheckAgainstApplnCurrency(
          ApplnCurrencyCode,"Currency Code",GenJnlLine."Account Type"::Vendor,TRUE);

      VendLedgEntry.COPY(Rec);
      //KKE : #001 +
      IF "Applies-to ID" <> '' THEN BEGIN
        VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
        IF VendLedgEntry.FIND('-') THEN BEGIN
          REPEAT
            VendLedgEntry.MARK(TRUE);
          UNTIL VendLedgEntry.NEXT=0;
          VendLedgEntry.MARKEDONLY(TRUE);
        END ELSE
          CurrPage.SETSELECTIONFILTER(VendLedgEntry);
      END ELSE
      //KKE : #001 -
        CurrPage.SETSELECTIONFILTER(VendLedgEntry);
      IF GenJnlLineApply THEN
        VendEntrySetApplID.SetApplId(VendLedgEntry,ApplyingVendLedgEntry,AppliedAmount,PmtDiscAmount,GenJnlLine."Applies-to ID")
      ELSE
        VendEntrySetApplID.SetApplId(VendLedgEntry,ApplyingVendLedgEntry,AppliedAmount,PmtDiscAmount,PurchHeader."Applies-to ID");

      CalcApplnAmount;
    END;

    PROCEDURE CalcApplnAmount@7();
    VAR
      ExchAccGLJnlLine@1000000000 : Codeunit 366;
      I@1000000001 : Integer;
    BEGIN
      AppliedAmount := 0;
      PmtDiscAmount := 0;
      DifferentCurrenciesInAppln := FALSE;

      CASE CalcType OF
        CalcType::Direct :
          BEGIN
            FindAmountRounding;
            VendEntryApplID := USERID;
            IF VendEntryApplID = '' THEN
              VendEntryApplID := '***';

            VendLedgEntry := ApplyingVendLedgEntry;

            AppliedVendLedgEntry.SETCURRENTKEY("Vendor No.",Open,Positive);
            AppliedVendLedgEntry.SETRANGE("Vendor No.","Vendor No.");
            AppliedVendLedgEntry.SETRANGE(Open,TRUE);
            AppliedVendLedgEntry.SETRANGE("Applies-to ID",VendEntryApplID);

            IF ApplyingVendLedgEntry."Entry No." <> 0 THEN BEGIN
              VendLedgEntry.CALCFIELDS("Remaining Amount");
              AppliedVendLedgEntry.SETFILTER("Entry No.",'<>%1',VendLedgEntry."Entry No.");
            END;

            HandlChosenEntries(0,
              VendLedgEntry."Remaining Amount",
              VendLedgEntry."Currency Code",
              VendLedgEntry."Posting Date");
          END;

        CalcType::GenJnlLine :
          BEGIN
            FindAmountRounding;
            IF GenJnlLine."Bal. Account Type" = GenJnlLine."Bal. Account Type"::Vendor THEN
              ExchAccGLJnlLine.RUN(GenJnlLine);

            CASE ApplnType OF
              ApplnType::"Applies-to Doc. No." :
                BEGIN
                  AppliedVendLedgEntry := Rec;
                  WITH AppliedVendLedgEntry DO BEGIN
                    CALCFIELDS("Remaining Amount");
                    IF "Currency Code" <> ApplnCurrencyCode THEN BEGIN
                      "Remaining Amount" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Remaining Amount");
                      "Remaining Pmt. Disc. Possible" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Remaining Pmt. Disc. Possible");
                      "Amount to Apply" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Amount to Apply");
                    END;

                    IF "Amount to Apply" <> 0 THEN
                      AppliedAmount := ROUND("Amount to Apply",AmountRoundingPrecision)
                    ELSE
                      AppliedAmount := ROUND("Remaining Amount",AmountRoundingPrecision);

                    IF GenJnlPostLine.CheckCalcPmtDiscGenJnlVend(
                         GenJnlLine,AppliedVendLedgEntry,0,FALSE) AND
                       ((ABS(GenJnlLine.Amount) + ApplnRoundingPrecision >=
                         ABS(AppliedAmount - "Remaining Pmt. Disc. Possible")) OR
                        (GenJnlLine.Amount = 0))
                    THEN
                      PmtDiscAmount := "Remaining Pmt. Disc. Possible";

                    IF NOT DifferentCurrenciesInAppln THEN
                      DifferentCurrenciesInAppln:= ApplnCurrencyCode <> "Currency Code";

                  END;
                  CheckRounding;
                END;

              ApplnType::"Applies-to ID" :
                BEGIN
                  GenJnlLine2 := GenJnlLine;
                  AppliedVendLedgEntry.SETCURRENTKEY("Vendor No.",Open,Positive);
                  AppliedVendLedgEntry.SETRANGE("Vendor No.",GenJnlLine."Account No.");
                  AppliedVendLedgEntry.SETRANGE(Open,TRUE);
                  AppliedVendLedgEntry.SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID");

                  HandlChosenEntries(1,
                    GenJnlLine2.Amount,
                    GenJnlLine2."Currency Code",
                    GenJnlLine2."Posting Date");
                END;
              END;
          END;

        CalcType::PurchHeader:
          BEGIN
            FindAmountRounding;

            CASE ApplnType OF
              ApplnType::"Applies-to Doc. No." :
                BEGIN
                  AppliedVendLedgEntry := Rec;
                  WITH AppliedVendLedgEntry DO BEGIN
                    CALCFIELDS("Remaining Amount");

                    IF "Currency Code" <> ApplnCurrencyCode THEN
                      "Remaining Amount" :=
                        CurrExchRate.ExchangeAmtFCYToFCY(
                          ApplnDate,"Currency Code",ApplnCurrencyCode,"Remaining Amount");

                    AppliedAmount := AppliedAmount + ROUND("Remaining Amount",AmountRoundingPrecision);

                    IF NOT DifferentCurrenciesInAppln THEN
                      DifferentCurrenciesInAppln:= ApplnCurrencyCode <> "Currency Code";

                  END;
                  CheckRounding;
                END;

              ApplnType::"Applies-to ID" :
                BEGIN
                  WITH VendLedgEntry DO BEGIN
                    AppliedVendLedgEntry.SETCURRENTKEY("Vendor No.",Open,Positive);
                    AppliedVendLedgEntry.SETRANGE("Vendor No.",PurchHeader."Pay-to Vendor No.");
                    AppliedVendLedgEntry.SETRANGE(Open,TRUE);
                    AppliedVendLedgEntry.SETRANGE("Applies-to ID",PurchHeader."Applies-to ID");

                    HandlChosenEntries(2,
                      GenJnlLine.Amount,
                      GenJnlLine."Currency Code",
                      GenJnlLine."Posting Date");
                  END;
                END;
            END;
          END;
      END;
    END;

    PROCEDURE CalcApplnRemainingAmount@4(Amount@1000000000 : Decimal) : Decimal;
    VAR
      ApplnRemainingAmount@1000000001 : Decimal;
    BEGIN
      ValidExchRate := TRUE;
      IF ApplnCurrencyCode = "Currency Code" THEN
        EXIT(Amount)
      ELSE BEGIN
        IF ApplnDate = 0D THEN
          ApplnDate := "Posting Date";
        ApplnRemainingAmount :=
          CurrExchRate.ApplnExchangeAmtFCYToFCY(
            ApplnDate,"Currency Code",ApplnCurrencyCode,Amount,ValidExchRate);
        EXIT(ApplnRemainingAmount);
      END;
    END;

    PROCEDURE CalcApplnAmounttoApply@11(AmounttoApply@1000000000 : Decimal) : Decimal;
    VAR
      ApplnAmountToApply@1000000001 : Decimal;
    BEGIN
      ValidExchRate := TRUE;

      IF ApplnCurrencyCode = "Currency Code" THEN
        EXIT(AmounttoApply)
      ELSE BEGIN
        IF ApplnDate = 0D THEN
          ApplnDate := "Posting Date";
        ApplnAmountToApply :=
          CurrExchRate.ApplnExchangeAmtFCYToFCY(
            ApplnDate,"Currency Code",ApplnCurrencyCode,AmounttoApply,ValidExchRate);
        EXIT(ApplnAmountToApply);
      END;
    END;

    PROCEDURE FindAmountRounding@6();
    BEGIN
      IF ApplnCurrencyCode = '' THEN BEGIN
        Currency.INIT;
        Currency.Code := '';
        Currency.InitRoundingPrecision;
      END ELSE
        IF ApplnCurrencyCode <> Currency.Code THEN
          Currency.GET(ApplnCurrencyCode);

      AmountRoundingPrecision := Currency."Amount Rounding Precision";
    END;

    PROCEDURE CheckRounding@3();
    BEGIN
      ApplnRounding := 0;

      CASE CalcType OF
        CalcType::PurchHeader :
          EXIT;
        CalcType::GenJnlLine :
          IF ("Document Type" <> "Document Type"::Payment) AND
            ("Document Type" <> "Document Type"::Refund)
          THEN
            EXIT;
      END;

      IF ApplnCurrencyCode = '' THEN
        ApplnRoundingPrecision := GLSetup."Appln. Rounding Precision"
      ELSE BEGIN
        IF ApplnCurrencyCode <> "Currency Code" THEN
          Currency.GET(ApplnCurrencyCode);
        ApplnRoundingPrecision := Currency."Appln. Rounding Precision";
      END;

      IF (ABS((AppliedAmount - PmtDiscAmount) + ApplyingAmount) <= ApplnRoundingPrecision) AND DifferentCurrenciesInAppln THEN
        ApplnRounding := -((AppliedAmount - PmtDiscAmount) + ApplyingAmount);
    END;

    PROCEDURE GetVendLedgEntry@5(VAR VendLedgEntry@1000000000 : Record 25);
    BEGIN
      VendLedgEntry := Rec;
    END;

    PROCEDURE FindApplyingEntry@12();
    BEGIN
      IF CalcType = CalcType::Direct THEN BEGIN
        VendEntryApplID := USERID;
        IF VendEntryApplID = '' THEN
          VendEntryApplID := '***';

        VendLedgEntry.SETCURRENTKEY("Vendor No.","Applies-to ID",Open);
        VendLedgEntry.SETRANGE("Vendor No.","Vendor No.");
        VendLedgEntry.SETRANGE("Applies-to ID",VendEntryApplID);
        VendLedgEntry.SETRANGE(Open,TRUE);
        VendLedgEntry.SETRANGE("Applying Entry",TRUE);
        IF VendLedgEntry.FIND('-') THEN BEGIN
          VendLedgEntry.CALCFIELDS(Amount,"Remaining Amount");
          ApplyingVendLedgEntry := VendLedgEntry;
          SETCURRENTKEY("Entry No.");
          SETFILTER("Entry No.",'<> %1',VendLedgEntry."Entry No.");
          ApplyingAmount := VendLedgEntry."Remaining Amount";
          ApplnDate := VendLedgEntry."Posting Date";
          ApplnCurrencyCode := VendLedgEntry."Currency Code";
        END;
        CalcApplnAmount;
      END;
    END;

    PROCEDURE HandlChosenEntries@8(Type@1000000000 : 'Direct,GenJnlLine,PurchHeader';CurrentAmount@1000000001 : Decimal;CurrencyCode@1000000002 : Code[10];"Posting Date"@1000000003 : Date);
    VAR
      AppliedVendLedgEntryTemp@1000000004 : TEMPORARY Record 25;
      PossiblePmtdisc@1000000005 : Decimal;
      OldPmtdisc@1000000006 : Decimal;
      CorrectionAmount@1000000007 : Decimal;
      CalculateCurrency@1000000008 : Boolean;
      CanUseDisc@1000000009 : Boolean;
      FromZeroGenJnl@1000000010 : Boolean;
    BEGIN
      IF AppliedVendLedgEntry.FINDSET(FALSE,FALSE) THEN BEGIN
        REPEAT
          AppliedVendLedgEntryTemp := AppliedVendLedgEntry;
          AppliedVendLedgEntryTemp.INSERT;
        UNTIL AppliedVendLedgEntry.NEXT = 0;
      END ELSE
        EXIT;

      FromZeroGenJnl := (CurrentAmount = 0) AND (Type = Type::GenJnlLine);

      REPEAT
        IF NOT FromZeroGenJnl THEN
          AppliedVendLedgEntryTemp.SETRANGE(Positive,CurrentAmount < 0);
        IF AppliedVendLedgEntryTemp.FINDFIRST THEN BEGIN
          AppliedVendLedgEntryTemp.CALCFIELDS("Remaining Amount");

          IF Type = Type::Direct THEN
            CalculateCurrency := ApplyingVendLedgEntry."Entry No." <> 0
          ELSE
            CalculateCurrency := TRUE;


          IF (CurrencyCode <> AppliedVendLedgEntryTemp."Currency Code") AND CalculateCurrency THEN BEGIN
            AppliedVendLedgEntryTemp."Remaining Amount" :=
              GenJnlPostLine.ExchAmount(
                AppliedVendLedgEntryTemp."Remaining Amount",
                AppliedVendLedgEntryTemp."Currency Code",
                CurrencyCode,"Posting Date");
            AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible" :=
              GenJnlPostLine.ExchAmount(
                AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible",
                AppliedVendLedgEntryTemp."Currency Code",
                CurrencyCode,"Posting Date");
            AppliedVendLedgEntryTemp."Amount to Apply" :=
              GenJnlPostLine.ExchAmount(
                AppliedVendLedgEntryTemp."Amount to Apply",
                AppliedVendLedgEntryTemp."Currency Code",
                CurrencyCode,"Posting Date");
          END;

          CASE Type OF
            Type::Direct:
              CanUseDisc := GenJnlPostLine.CheckCalcPmtDiscVend(VendLedgEntry,AppliedVendLedgEntryTemp,0,FALSE,FALSE);
            Type::GenJnlLine:
              CanUseDisc := GenJnlPostLine.CheckCalcPmtDiscGenJnlVend(GenJnlLine2,AppliedVendLedgEntryTemp,0,FALSE)
            ELSE
              CanUseDisc := FALSE;
          END;

          IF CanUseDisc AND
            (ABS(AppliedVendLedgEntryTemp."Amount to Apply") >= ABS(AppliedVendLedgEntryTemp."Remaining Amount" -
            AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible")) THEN BEGIN

            IF (ABS(CurrentAmount - PossiblePmtdisc) > ABS(AppliedVendLedgEntryTemp."Remaining Amount" -
              AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible"))
            THEN BEGIN
              PmtDiscAmount := PmtDiscAmount + AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible";
              CurrentAmount := CurrentAmount + AppliedVendLedgEntryTemp."Remaining Amount" -
                AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible";
            END ELSE IF (ABS(CurrentAmount - PossiblePmtdisc) = ABS(AppliedVendLedgEntryTemp."Remaining Amount" -
              AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible"))
            THEN BEGIN
              PmtDiscAmount := PmtDiscAmount + AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible" + PossiblePmtdisc;
              CurrentAmount := CurrentAmount + AppliedVendLedgEntryTemp."Remaining Amount" -
                AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible" - PossiblePmtdisc;
              PossiblePmtdisc := 0;
              AppliedAmount := AppliedAmount + CorrectionAmount;
            END ELSE IF FromZeroGenJnl THEN BEGIN
              PmtDiscAmount := PmtDiscAmount + AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible";
              CurrentAmount := CurrentAmount +
                AppliedVendLedgEntryTemp."Remaining Amount" - AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible";
            END ELSE BEGIN
              IF (CurrentAmount + AppliedVendLedgEntryTemp."Remaining Amount" >= 0) <> (CurrentAmount >= 0) THEN BEGIN
                PmtDiscAmount := PmtDiscAmount + PossiblePmtdisc;
                CurrentAmount := CurrentAmount - PossiblePmtdisc;
                AppliedAmount := AppliedAmount + CorrectionAmount;
              END;
              CurrentAmount := CurrentAmount + AppliedVendLedgEntryTemp."Remaining Amount";
              PossiblePmtdisc := AppliedVendLedgEntryTemp."Remaining Pmt. Disc. Possible";
            END;
          END ELSE BEGIN
            IF (((CurrentAmount - PossiblePmtdisc + AppliedVendLedgEntryTemp."Amount to Apply") * CurrentAmount) <= 0) THEN BEGIN
              PmtDiscAmount := PmtDiscAmount + PossiblePmtdisc;
              CurrentAmount := CurrentAmount - PossiblePmtdisc;
              PossiblePmtdisc := 0;
              AppliedAmount := AppliedAmount + CorrectionAmount;
            END;
            CurrentAmount := CurrentAmount + AppliedVendLedgEntryTemp."Amount to Apply";
          END;
        END ELSE BEGIN
          AppliedVendLedgEntryTemp.SETRANGE(Positive);
          AppliedVendLedgEntryTemp.FINDFIRST;
        END;

        IF (OldPmtdisc <> PmtDiscAmount) THEN
          AppliedAmount := AppliedAmount + AppliedVendLedgEntryTemp."Remaining Amount"
        ELSE
          AppliedAmount := AppliedAmount + AppliedVendLedgEntryTemp."Amount to Apply";
        OldPmtdisc := PmtDiscAmount;

        IF PossiblePmtdisc <> 0 THEN
          CorrectionAmount := AppliedVendLedgEntryTemp."Remaining Amount" - AppliedVendLedgEntryTemp."Amount to Apply"
        ELSE
          CorrectionAmount := 0;

        IF NOT DifferentCurrenciesInAppln THEN
          DifferentCurrenciesInAppln:= ApplnCurrencyCode <> AppliedVendLedgEntryTemp."Currency Code";

        AppliedVendLedgEntryTemp.DELETE;
        AppliedVendLedgEntryTemp.SETRANGE(Positive);

      UNTIL NOT AppliedVendLedgEntryTemp.FINDFIRST;
      CheckRounding;
    END;

    LOCAL PROCEDURE AmounttoApplyOnAfterValidate@19038179();
    BEGIN
      IF ApplnType <> ApplnType::"Applies-to Doc. No." THEN BEGIN
        CalcApplnAmount;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE PmtDiscountDateOnAfterValidate@19051222();
    BEGIN
      CurrPage.UPDATE(TRUE);
      CalcApplnAmount;
    END;

    LOCAL PROCEDURE RemainingPmtDiscPossibleOnAfte@19061040();
    BEGIN
      CurrPage.UPDATE(TRUE);
      CalcApplnAmount;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      IF ApplnType = ApplnType::"Applies-to Doc. No." THEN
        CalcApplnAmount;
    END;

    LOCAL PROCEDURE LookupOKOnPush@19031339();
    BEGIN
      OK := TRUE;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   25.10.2005   KKE   -Fix bug "Applying Entry" and "Applies-to ID" when use function 'Set Applying Entry',
                                'Remove Applying Entry' and 'Post Application'.
      002   27.11.2007   KKE   -Reset Applies-to ID on Closed Vendor Ledger Entries.
    }
    END.
  }
}

OBJECT Page 251 General Journal Batches
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=General Journal Batches;
               THA=ชุดงานบัญชีแยกประเภท];
    SourceTable=Table232;
    DataCaptionExpr=DataCaption;
    PageType=List;
    OnInit=BEGIN
             AllowManualWHTCertNoVisible := TRUE;
           END;

    OnOpenPage=BEGIN
                 GenJnlManagement.OpenJnlBatch(Rec);
                 //KKE : #001 +
                 IF GenJnlTemplate.GET("Journal Template Name") THEN
                   AllowManualWHTCertNoVisible :=
                     GenJnlTemplate.Type IN [GenJnlTemplate.Type::Payments,GenJnlTemplate.Type::"Petty Cash"]
                 ELSE
                   AllowManualWHTCertNoVisible := FALSE;
                 //KKE : #001 -
               END;

    OnNewRecord=BEGIN
                  SetupNewBatch;
                END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 29      ;1   ;Action    ;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Edit Journal;
                                 THA=แก้ไขสมุดรายวัน];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=OpenJournal;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 GenJnlManagement.TemplateSelectionFromBatch(Rec);
                               END;
                                }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การ&ลงรายการบัญชี] }
      { 23      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Reconcile;
                                 THA=กระทบยอด];
                      Image=Reconcile;
                      OnAction=BEGIN
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name",Name);
                                 GLReconcile.SetGenJnlLine(GenJnlLine);
                                 GLReconcile.RUN;
                               END;
                                }
      { 16      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintGenJnlBatch(Rec);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ลง&รายการบัญชี];
                      RunObject=Codeunit 233;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process }
      { 18      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      RunObject=Codeunit 234;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Name }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 11  ;2   ;Field     ;
                SourceExpr="Bal. Account Type" }

    { 13  ;2   ;Field     ;
                SourceExpr="Bal. Account No." }

    { 19  ;2   ;Field     ;
                SourceExpr="No. Series" }

    { 21  ;2   ;Field     ;
                SourceExpr="Posting No. Series" }

    { 6   ;2   ;Field     ;
                SourceExpr="Reason Code" }

    { 25  ;2   ;Field     ;
                SourceExpr="Copy VAT Setup to Jnl. Lines" }

    { 27  ;2   ;Field     ;
                SourceExpr="Allow VAT Difference" }

    { 1000000000;2;Field  ;
                SourceExpr="Allow Manual WHT Cert. No.";
                Visible=AllowManualWHTCertNoVisible }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ReportPrint@1000000000 : Codeunit 228;
      GenJnlManagement@1000000001 : Codeunit 230;
      GenJnlLine@1000000002 : Record 81;
      GLReconcile@1000000003 : Form 345;
      GenJnlTemplate@1000000004 : Record 80;
      AllowManualWHTCertNoVisible@19014709 : Boolean INDATASET;

    LOCAL PROCEDURE DataCaption@1() : Text[250];
    VAR
      GenJnlTemplate@1000000000 : Record 80;
    BEGIN
      IF NOT CurrPage.LOOKUPMODE THEN
        IF GETFILTER("Journal Template Name") <> '' THEN
          IF GETRANGEMIN("Journal Template Name") = GETRANGEMAX("Journal Template Name") THEN
            IF GenJnlTemplate.GET(GETRANGEMIN("Journal Template Name")) THEN
              EXIT(GenJnlTemplate.Name + ' ' + GenJnlTemplate.Description);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   08.08.2006   KKE   -Modify program to be able to manual input WHT Certificate No.
    }
    END.
  }
}

OBJECT Page 253 Sales Journal
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,NAVAP4.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Journal;
               THA=สมุดรายวันการขาย];
    SaveValues=Yes;
    SourceTable=Table81;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             TotalBalanceVisible := TRUE;
             BalanceVisible := TRUE;
           END;

    OnOpenPage=VAR
                 JnlSelected@1000000000 : Boolean;
               BEGIN
                 BalAccName := '';
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Journal Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 GenJnlManagement.TemplateSelection(FORM::"Sales Journal",1,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  UpdateBalance;
                  SetUpNewLine(xRec,Balance,BelowxRec);
                  CLEAR(ShortcutDimCode);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 81      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 99      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 545;
                      RunFormLink=Table ID=CONST(81),Journal Template Name=FIELD(Journal Template Name),Journal Batch Name=FIELD(Journal Batch Name),Journal Line No.=FIELD(Line No.);
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process }
      { 41      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 THA=&บัญชี] }
      { 42      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Codeunit 15;
                      Image=EditLines }
      { 43      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Codeunit 14;
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์] }
      { 1000000002;2 ;Action    ;
                      CaptionML=ENU=Sales Voucher;
                      OnAction=BEGIN
                                 GenJnlLine.RESET;
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 GenJnlLine.SETRANGE("Document No.","Document No.");
                                 REPORT.RUN(REPORT::"Sales Voucher",TRUE,FALSE,GenJnlLine);
                               END;
                                }
      { 44      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟังก์&ชัน] }
      { 82      ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      RunObject=Codeunit 225;
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process }
      { 100     ;2   ;Action    ;
                      CaptionML=[ENU=Insert Conv. LCY Rndg. Lines;
                                 THA=แทรกบรรทัดการปัดเศษจากการแปลง LCY];
                      RunObject=Codeunit 407 }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การ&ลงรายการบัญชี] }
      { 46      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Reconcile;
                                 THA=กระทบยอด];
                      Image=Reconcile;
                      OnAction=BEGIN
                                 GLReconcile.SetGenJnlLine(Rec);
                                 GLReconcile.RUN;
                               END;
                                }
      { 47      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintGenJnlLine(Rec);
                               END;
                                }
      { 48      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ลง&รายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 37  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           THA=ชื่อชุดงาน];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             GenJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                               CurrentJnlBatchNameOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           GenJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 87  ;2   ;Field     ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 39  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Account Type";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr="Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 12  ;2   ;Field     ;
                SourceExpr=Description }

    { 1500000;2;Field     ;
                SourceExpr="WHT Business Posting Group";
                Visible=FALSE }

    { 1500002;2;Field     ;
                SourceExpr="WHT Product Posting Group";
                Visible=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="WHT Absorb Base";
                Visible=FALSE }

    { 55  ;2   ;Field     ;
                SourceExpr="Salespers./Purch. Code";
                Visible=FALSE }

    { 101 ;2   ;Field     ;
                SourceExpr="Campaign No.";
                Visible=FALSE }

    { 57  ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr="Currency Code";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 14  ;2   ;Field     ;
                SourceExpr="Gen. Posting Type" }

    { 83  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 16  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 91  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 93  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr=Amount }

    { 103 ;2   ;Field     ;
                SourceExpr="VAT Amount";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                SourceExpr="VAT Difference";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                SourceExpr="Bal. VAT Amount";
                Visible=FALSE }

    { 113 ;2   ;Field     ;
                SourceExpr="Bal. VAT Difference";
                Visible=FALSE }

    { 59  ;2   ;Field     ;
                SourceExpr="Bal. Account Type" }

    { 61  ;2   ;Field     ;
                SourceExpr="Bal. Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 63  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Posting Type" }

    { 85  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Bus. Posting Group" }

    { 65  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Prod. Posting Group" }

    { 95  ;2   ;Field     ;
                SourceExpr="Bal. VAT Bus. Posting Group";
                Visible=FALSE }

    { 97  ;2   ;Field     ;
                SourceExpr="Bal. VAT Prod. Posting Group";
                Visible=FALSE }

    { 105 ;2   ;Field     ;
                SourceExpr="Bill-to/Pay-to No.";
                Visible=FALSE }

    { 107 ;2   ;Field     ;
                SourceExpr="Ship-to/Order Address Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 67  ;2   ;Field     ;
                SourceExpr="Sales/Purch. (LCY)";
                Visible=FALSE }

    { 69  ;2   ;Field     ;
                SourceExpr="Profit (LCY)";
                Visible=FALSE }

    { 71  ;2   ;Field     ;
                SourceExpr="Inv. Discount (LCY)";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Due Date";
                Visible=FALSE }

    { 77  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Visible=FALSE }

    { 79  ;2   ;Field     ;
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type" }

    { 26  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No." }

    { 53  ;2   ;Field     ;
                SourceExpr="Applies-to ID";
                Visible=FALSE }

    { 73  ;2   ;Field     ;
                SourceExpr="On Hold";
                Visible=FALSE }

    { 75  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 28  ;1   ;Group      }

    { 1902205001;2;Group  ;
                GroupType=FixedLayout }

    { 1901652501;3;Group  ;
                CaptionML=[ENU=Account Name;
                           THA=ชื่อบัญชี] }

    { 33  ;4   ;Field     ;
                SourceExpr=AccName;
                Editable=FALSE }

    { 1903867901;3;Group  ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล] }

    { 89  ;4   ;Field     ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล];
                SourceExpr=BalAccName;
                Editable=FALSE }

    { 1903866901;3;Group  ;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ] }

    { 29  ;4   ;Field     ;
                Name=Balance;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ];
                SourceExpr=Balance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=BalanceVisible;
                Editable=FALSE }

    { 1902759701;3;Group  ;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล] }

    { 31  ;4   ;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล];
                SourceExpr=TotalBalance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=TotalBalanceVisible;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900919607;1;Part   ;
                SubFormLink=Table ID=CONST(81),Journal Template Name=FIELD(Journal Template Name),Journal Batch Name=FIELD(Journal Batch Name),Journal Line No.=FIELD(Line No.);
                PagePartID=Page545;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ChangeExchangeRate@1000000000 : Form 511;
      GLReconcile@1000000001 : Form 345;
      GenJnlManagement@1000000002 : Codeunit 230;
      ReportPrint@1000000003 : Codeunit 228;
      CurrentJnlBatchName@1000000004 : Code[10];
      AccName@1000000005 : Text[50];
      BalAccName@1000000006 : Text[50];
      Balance@1000000007 : Decimal;
      TotalBalance@1000000008 : Decimal;
      ShowBalance@1000000009 : Boolean;
      ShowTotalBalance@1000000010 : Boolean;
      ShortcutDimCode@1000000011 : ARRAY [8] OF Code[20];
      GenJnlLine@1000000012 : Record 81;
      OpenedFromBatch@1000000013 : Boolean;
      BalanceVisible@19073040 : Boolean INDATASET;
      TotalBalanceVisible@19063333 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateBalance@1();
    BEGIN
      GenJnlManagement.CalcBalance(
        Rec,xRec,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      BalanceVisible := ShowBalance;
      TotalBalanceVisible := ShowTotalBalance;
    END;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      GenJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
      UpdateBalance;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add print button for localization.
    }
    END.
  }
}

OBJECT Page 254 Purchase Journal
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,NAVAP4.00.01,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Journal;
               THA=สมุดรายวันการซื้อ];
    SaveValues=Yes;
    SourceTable=Table81;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             TotalBalanceVisible := TRUE;
             BalanceVisible := TRUE;
           END;

    OnOpenPage=VAR
                 JnlSelected@1000000000 : Boolean;
               BEGIN
                 BalAccName := '';
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Journal Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 GenJnlManagement.TemplateSelection(FORM::"Purchase Journal",2,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  UpdateBalance;
                  SetUpNewLine(xRec,Balance,BelowxRec);
                  CLEAR(ShortcutDimCode);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 67      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 68      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 545;
                      RunFormLink=Table ID=CONST(81),Journal Template Name=FIELD(Journal Template Name),Journal Batch Name=FIELD(Journal Batch Name),Journal Line No.=FIELD(Line No.);
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process }
      { 41      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 THA=&บัญชี] }
      { 42      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Codeunit 15;
                      Image=EditLines }
      { 43      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Codeunit 14;
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์] }
      { 1000000002;2 ;Action    ;
                      CaptionML=ENU=Purchase Voucher;
                      OnAction=BEGIN
                                 GenJnlLine.RESET;
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 GenJnlLine.SETRANGE("Document No.","Document No.");
                                 REPORT.RUN(REPORT::"Purchase Voucher",TRUE,FALSE,GenJnlLine);
                               END;
                                }
      { 44      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟังก์&ชัน] }
      { 97      ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      RunObject=Codeunit 225;
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process }
      { 98      ;2   ;Action    ;
                      CaptionML=[ENU=Insert Conv. LCY Rndg. Lines;
                                 THA=แทรกบรรทัดการปัดเศษจากการแปลง LCY];
                      RunObject=Codeunit 407 }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การ&ลงรายการบัญชี] }
      { 46      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Reconcile;
                                 THA=กระทบยอด];
                      Image=Reconcile;
                      OnAction=BEGIN
                                 GLReconcile.SetGenJnlLine(Rec);
                                 GLReconcile.RUN;
                               END;
                                }
      { 47      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintGenJnlLine(Rec);
                               END;
                                }
      { 48      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ลง&รายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 37  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           THA=ชื่อชุดงาน];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             GenJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                               CurrentJnlBatchNameOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           GenJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 87  ;2   ;Field     ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 85  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Account Type";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr="Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 12  ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000008;2;Field  ;
                SourceExpr="VAT Amount" }

    { 1000000004;2;Field  ;
                SourceExpr="Average VAT Year" }

    { 1000000006;2;Field  ;
                SourceExpr="VAT Claim %" }

    { 1000000001;2;Field  ;
                SourceExpr="Use Average VAT" }

    { 1500000;2;Field     ;
                SourceExpr="WHT Business Posting Group";
                Visible=FALSE }

    { 1500002;2;Field     ;
                SourceExpr="WHT Product Posting Group";
                Visible=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="WHT Absorb Base";
                Visible=FALSE }

    { 55  ;2   ;Field     ;
                SourceExpr="Salespers./Purch. Code";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                SourceExpr="Campaign No.";
                Visible=FALSE }

    { 57  ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr="Currency Code";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 14  ;2   ;Field     ;
                SourceExpr="Gen. Posting Type" }

    { 81  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 16  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 39  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr=Amount }

    { 105 ;2   ;Field     ;
                SourceExpr="VAT Amount";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                SourceExpr="VAT Difference";
                Visible=FALSE }

    { 1500006;2;Field     ;
                SourceExpr="Vendor Exchange Rate (ACY)" }

    { 107 ;2   ;Field     ;
                SourceExpr="Bal. VAT Amount";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                SourceExpr="Bal. VAT Difference";
                Visible=FALSE }

    { 59  ;2   ;Field     ;
                SourceExpr="Bal. Account Type" }

    { 61  ;2   ;Field     ;
                SourceExpr="Bal. Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 63  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Posting Type" }

    { 83  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Bus. Posting Group" }

    { 65  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Prod. Posting Group" }

    { 93  ;2   ;Field     ;
                SourceExpr="Bal. VAT Bus. Posting Group";
                Visible=FALSE }

    { 95  ;2   ;Field     ;
                SourceExpr="Bal. VAT Prod. Posting Group";
                Visible=FALSE }

    { 101 ;2   ;Field     ;
                SourceExpr="Bill-to/Pay-to No.";
                Visible=FALSE }

    { 103 ;2   ;Field     ;
                SourceExpr="Ship-to/Order Address Code";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 69  ;2   ;Field     ;
                SourceExpr="Sales/Purch. (LCY)";
                Visible=FALSE }

    { 73  ;2   ;Field     ;
                SourceExpr="Inv. Discount (LCY)";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Due Date";
                Visible=FALSE }

    { 75  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Visible=FALSE }

    { 77  ;2   ;Field     ;
                SourceExpr="Payment Discount %";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type" }

    { 26  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No." }

    { 71  ;2   ;Field     ;
                SourceExpr="Applies-to ID";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="On Hold" }

    { 79  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 28  ;1   ;Group      }

    { 1902205001;2;Group  ;
                GroupType=FixedLayout }

    { 1901652501;3;Group  ;
                CaptionML=[ENU=Account Name;
                           THA=ชื่อบัญชี] }

    { 33  ;4   ;Field     ;
                SourceExpr=AccName;
                Editable=FALSE }

    { 1903867901;3;Group  ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล] }

    { 89  ;4   ;Field     ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล];
                SourceExpr=BalAccName;
                Editable=FALSE }

    { 1903866901;3;Group  ;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ] }

    { 29  ;4   ;Field     ;
                Name=Balance;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ];
                SourceExpr=Balance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=BalanceVisible;
                Editable=FALSE }

    { 1902759701;3;Group  ;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล] }

    { 31  ;4   ;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล];
                SourceExpr=TotalBalance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=TotalBalanceVisible;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900919607;1;Part   ;
                SubFormLink=Table ID=CONST(81),Journal Template Name=FIELD(Journal Template Name),Journal Batch Name=FIELD(Journal Batch Name),Journal Line No.=FIELD(Line No.);
                PagePartID=Page545;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ChangeExchangeRate@1000000000 : Form 511;
      GLReconcile@1000000001 : Form 345;
      GenJnlManagement@1000000002 : Codeunit 230;
      ReportPrint@1000000003 : Codeunit 228;
      CurrentJnlBatchName@1000000004 : Code[10];
      AccName@1000000005 : Text[50];
      BalAccName@1000000006 : Text[50];
      Balance@1000000007 : Decimal;
      TotalBalance@1000000008 : Decimal;
      ShowBalance@1000000009 : Boolean;
      ShowTotalBalance@1000000010 : Boolean;
      ShortcutDimCode@1000000011 : ARRAY [8] OF Code[20];
      GenJnlLine@1000000012 : Record 81;
      OpenedFromBatch@1000000013 : Boolean;
      BalanceVisible@19073040 : Boolean INDATASET;
      TotalBalanceVisible@19063333 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateBalance@1();
    BEGIN
      GenJnlManagement.CalcBalance(
        Rec,xRec,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      BalanceVisible := ShowBalance;
      TotalBalanceVisible := ShowTotalBalance;
    END;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      GenJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
      UpdateBalance;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add print button for localization.
    }
    END.
  }
}

OBJECT Page 256 Payment Journal
{
  OBJECT-PROPERTIES
  {
    Date=06/21/12;
    Time=10:31:22 AM;
    Modified=Yes;
    Version List=NAVW16.00,NAVAP4.00.01,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Payment Journal;
               THA=สมุดรายวันการชำระเงิน];
    SaveValues=Yes;
    SourceTable=Table81;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             TotalBalanceVisible := TRUE;
             BalanceVisible := TRUE;
             "WHT Certificate No.Editable" := TRUE;
           END;

    OnOpenPage=VAR
                 JnlSelected@1000000000 : Boolean;
               BEGIN
                 BalAccName := '';
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Journal Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 GenJnlManagement.TemplateSelection(FORM::"Payment Journal",4,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                       //KKE : #004 +
                       IF "Certificate Printed" THEN
                         "WHT Certificate No.Editable" := FALSE
                       ELSE BEGIN
                         GenJnlBatch.GET("Journal Template Name","Journal Batch Name");
                         "WHT Certificate No.Editable" := GenJnlBatch."Allow Manual WHT Cert. No.";
                       END;
                       //KKE : #004 -
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  UpdateBalance;
                  SetUpNewLine(xRec,Balance,BelowxRec);
                  CLEAR(ShortcutDimCode);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 58      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 545;
                      RunFormLink=Table ID=CONST(81),Journal Template Name=FIELD(Journal Template Name),Journal Batch Name=FIELD(Journal Batch Name),Journal Line No.=FIELD(Line No.);
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process }
      { 37      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 THA=&บัญชี] }
      { 38      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Codeunit 15;
                      Image=EditLines }
      { 39      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Codeunit 14;
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 41      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Payments;
                                 THA=&การชำระเงิน] }
      { 42      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Suggest Vendor Payments;
                                 THA=แนะนำการชำระเงินของผู้ขาย];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SuggestVendorPayments;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateVendorPmtSuggestion.SetGenJnlLine(Rec);
                                 CreateVendorPmtSuggestion.RUNMODAL;
                                 CLEAR(CreateVendorPmtSuggestion);
                               END;
                                }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=P&review Check;
                                 THA=ตรวจสอบ&มุมมองก่อนพิมพ์];
                      RunObject=Page 404;
                      RunFormLink=Journal Template Name=FIELD(Journal Template Name),Journal Batch Name=FIELD(Journal Batch Name),Line No.=FIELD(Line No.) }
      { 64      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print Check;
                                 THA=พิมพ์เช็ค];
                      Promoted=Yes;
                      Image=PrintCheck;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 GenJnlLine.RESET;
                                 GenJnlLine.COPY(Rec);
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 DocPrint.PrintCheck(GenJnlLine);
                                 CODEUNIT.RUN(CODEUNIT::"Adjust Gen. Journal Balance",Rec);
                               END;
                                }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Void Check;
                                 THA=โมฆะเช็ค];
                      Promoted=Yes;
                      Image=VoidCheck;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TESTFIELD("Bank Payment Type","Bank Payment Type"::"Computer Check");
                                 TESTFIELD("Check Printed",TRUE);
                                 IF CONFIRM(Text000,FALSE,"Document No.") THEN
                                   CheckManagement.VoidCheck(Rec);
                               END;
                                }
      { 66      ;2   ;Action    ;
                      CaptionML=[ENU=Void &All Checks;
                                 THA=โมฆะ &เช็คทั้งหมด];
                      OnAction=BEGIN
                                 IF CONFIRM(Text001,FALSE) THEN BEGIN
                                   GenJnlLine.RESET;
                                   GenJnlLine.COPY(Rec);
                                   GenJnlLine.SETRANGE("Bank Payment Type","Bank Payment Type"::"Computer Check");
                                   GenJnlLine.SETRANGE("Check Printed",TRUE);
                                   IF GenJnlLine.FIND('-') THEN
                                     REPEAT
                                       GenJnlLine2 := GenJnlLine;
                                       CheckManagement.VoidCheck(GenJnlLine2);
                                     UNTIL GenJnlLine.NEXT = 0;
                                 END;
                               END;
                                }
      { 1500004 ;2   ;Action    ;
                      CaptionML=[ENU=Print WHT Certificate;
                                 THA=พิมพ์ใบรับรอง WHT];
                      Visible=No;
                      OnAction=VAR
                                 WHTEntry3@1000000001 : Record 28044;
                               BEGIN
                                 WHTManagement.PreprintingWHT(Rec);
                               END;
                                }
      { 1000000025;2 ;Separator  }
      { 1000000026;2 ;Action    ;
                      CaptionML=ENU=Get Cash Advance;
                      OnAction=VAR
                                 GetCashAdvance@1000000001 : Report 50008;
                               BEGIN
                                 //KKE : #002 +
                                 GenJnlLine.RESET;
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 GenJnlLine.SETRANGE("Line No.","Line No.");
                                 IF GenJnlLine.FIND('-') THEN
                                 BEGIN
                                   GetCashAdvance.SETTABLEVIEW(GenJnlLine);
                                   GetCashAdvance.GetGenJnlLine2(GenJnlLine);
                                   GetCashAdvance.RUNMODAL;
                                 END;
                                 //KKE : #002 -
                               END;
                                }
      { 1000000027;2 ;Action    ;
                      CaptionML=ENU=Get WHT From Petty Cash;
                      OnAction=VAR
                                 GenJnlLine2@1000000001 : Record 81;
                                 WHTAmount@1000000002 : Decimal;
                               BEGIN
                                 //KKE : #002 +
                                 IF NOT CONFIRM(C_0001,FALSE) THEN
                                   EXIT;

                                 GenJnlLine.RESET;
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 GenJnlLine.SETRANGE("Line No.","Line No.");
                                 IF GenJnlLine.FIND('-') THEN BEGIN
                                   WHTAmount := WHTManagement.WHTAmountJournal(Rec,FALSE);

                                   GenJnlLine2.TRANSFERFIELDS(Rec);
                                   GenJnlLine2."Line No." := "Line No." + 10000;

                                   IF "Account Type" = "Account Type"::Vendor THEN BEGIN
                                     GenJnlLine2."Document Type" := GenJnlLine2."Document Type"::Invoice;
                                     GenJnlLine2."External Document No." := "Applies-to Doc. No.";
                                     GenJnlLine2.VALIDATE("Account Type","Account Type"::Vendor);
                                     GenJnlLine2.VALIDATE("Account No.","Account No.");
                                     GenJnlLine2.VALIDATE("WHT Business Posting Group",'');
                                     GenJnlLine2.VALIDATE(Amount,((-1) * (Amount - WHTAmount)));
                                   END;

                                   GenJnlLine2.VALIDATE("Applies-to Doc. Type",GenJnlLine2."Applies-to Doc. Type"::" ");
                                   GenJnlLine2.VALIDATE("Applies-to Doc. No.",'');
                                   GenJnlLine2.INSERT;
                                   MODIFY;
                                 END;

                                 COMMIT;
                                 MESSAGE(C_0002);
                                 //KKE : #002 -
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;ActionGroup;
                      CaptionML=[ENU=P&rint;
                                 THA=&พิมพ์] }
      { 1000000001;2 ;Action    ;
                      CaptionML=ENU=Payment Voucher;
                      OnAction=BEGIN
                                 GenJnlLine.RESET;
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 GenJnlLine.SETRANGE("Document No.","Document No.");
                                 REPORT.RUN(REPORT::"Payment Voucher",TRUE,FALSE,GenJnlLine);
                               END;
                                }
      { 1000000002;2 ;Action    ;
                      CaptionML=ENU=WHT Slip;
                      OnAction=VAR
                                 GenJnlLine@1000000001 : Record 81;
                                 WHTSlipBefPost@1000000002 : Report 50003;
                               BEGIN
                                 GenJnlLine.RESET;
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 GenJnlLine.SETRANGE("Document No.","Document No.");
                                 CLEAR(WHTSlipBefPost);
                                 WHTSlipBefPost.SETTABLEVIEW(GenJnlLine);
                                 WHTSlipBefPost.RUNMODAL;
                               END;
                                }
      { 40      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟังก์&ชัน] }
      { 93      ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      RunObject=Codeunit 225;
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process }
      { 94      ;2   ;Action    ;
                      CaptionML=[ENU=Insert Conv. LCY Rndg. Lines;
                                 THA=แทรกบรรทัดการปัดเศษจากการแปลง LCY];
                      RunObject=Codeunit 407 }
      { 1500002 ;2   ;Separator  }
      { 1500003 ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Post Dated Check;
                                 THA=ยกเลิกเช็คจ่ายล่วงหน้า];
                      OnAction=BEGIN
                                 PostDatedCheckMgt.CancelCheck(Rec);
                               END;
                                }
      { 1000000023;2 ;Separator  }
      { 1000000024;2 ;Action    ;
                      CaptionML=ENU=Adjust WHT Amount;
                      OnAction=VAR
                                 WHTEntry@1000000001 : Record 28044;
                                 AdjustWHTAmount@1000000002 : Form 50000;
                               BEGIN
                                 //KKE : #001 +
                                 CLEAR(AdjustWHTAmount);
                                 WHTEntry.RESET;
                                 WHTEntry.SETRANGE("Document Type",WHTEntry."Document Type"::Invoice);
                                 IF "Applies-to Doc. No." <> '' THEN
                                   WHTEntry.SETRANGE("Document No.","Applies-to Doc. No.")
                                 ELSE IF "Applies-to ID" <> '' THEN
                                   WHTEntry.SETRANGE("Applies-to ID","Applies-to ID")
                                 ELSE
                                   ERROR(C_0003);
                                 AdjustWHTAmount.SETTABLEVIEW(WHTEntry);
                                 AdjustWHTAmount.RUN;
                                 //KKE : #001 -
                               END;
                                }
      { 1000000038;2 ;Separator  }
      { 1000000039;2 ;Action    ;
                      CaptionML=ENU=Bank Cheque (Create File);
                      OnAction=VAR
                                 GenJnlLine@1000000001 : Record 81;
                               BEGIN
                                 //KKE : #050 +
                                 GenJnlLine.RESET;
                                 GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 GenJnlLine.SETRANGE("Posting Date","Posting Date");
                                 REPORT.RUN(REPORT::"Bank Cheque (Create File)",TRUE,FALSE,GenJnlLine);
                                 //KKE : #050 -
                               END;
                                }
      { 1000000040;2 ;Action    ;
                      CaptionML=ENU=Unblock Bank Cheque;
                      OnAction=BEGIN
                                 UnblockBankCheque;  //KKE : #050
                               END;
                                }
      { 43      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การ&ลงรายการบัญชี] }
      { 44      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Reconcile;
                                 THA=กระทบยอด];
                      Image=Reconcile;
                      OnAction=BEGIN
                                 GLReconcile.SetGenJnlLine(Rec);
                                 GLReconcile.RUN;
                               END;
                                }
      { 45      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintGenJnlLine(Rec);
                               END;
                                }
      { 46      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ลง&รายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 VendEntryEdit@1000000001 : Codeunit 113;
                               BEGIN
                                 //KKE : #005 +
                                 VendEntryEdit.ResetAppliestoIDOnCloseEntry;
                                 CLEAR(VendEntryEdit);
                                 //KKE : #005 -
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 47      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 33  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           THA=ชื่อชุดงาน];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             GenJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                               CurrentJnlBatchNameOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           GenJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 35  ;2   ;Field     ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 83  ;2   ;Field     ;
                SourceExpr="External Document No." }

    { 8   ;2   ;Field     ;
                SourceExpr="Account Type";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr="Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 1000000007;2;Field  ;
                SourceExpr="Dummy Vendor";
                Visible=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr="VAT Registration No.(Dummy)";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000015;2;Field  ;
                SourceExpr="Payee Name" }

    { 1000000032;2;Field  ;
                SourceExpr="Customer/Vendor Bank" }

    { 1000000030;2;Field  ;
                SourceExpr="Bank Account No." }

    { 1000000034;2;Field  ;
                SourceExpr="Bank Branch No." }

    { 1000000011;2;Field  ;
                SourceExpr="Bank Name";
                Visible=FALSE }

    { 1000000013;2;Field  ;
                SourceExpr="Bank Branch";
                Visible=FALSE }

    { 1000000028;2;Field  ;
                SourceExpr="Real Customer/Vendor Name";
                Visible=FALSE }

    { 1500007;2;Field     ;
                SourceExpr="WHT Business Posting Group";
                Visible=FALSE }

    { 1500009;2;Field     ;
                SourceExpr="WHT Product Posting Group";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Salespers./Purch. Code";
                Visible=FALSE }

    { 95  ;2   ;Field     ;
                SourceExpr="Campaign No.";
                Visible=FALSE }

    { 55  ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr="Currency Code";
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 77  ;2   ;Field     ;
                SourceExpr="Gen. Posting Type";
                Visible=FALSE }

    { 79  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 81  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE }

    { 85  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 87  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 1500005;2;Field     ;
                SourceExpr="Skip WHT";
                Visible=FALSE }

    { 1000000017;2;Field  ;
                SourceExpr="One Doc. Per WHT Slip" }

    { 1000000019;2;Field  ;
                SourceExpr="WHT Certificate No.";
                Editable="WHT Certificate No.Editable" }

    { 1000000021;2;Field  ;
                SourceExpr="Certificate Printed" }

    { 14  ;2   ;Field     ;
                SourceExpr=Amount }

    { 97  ;2   ;Field     ;
                SourceExpr="VAT Amount";
                Visible=FALSE }

    { 101 ;2   ;Field     ;
                SourceExpr="VAT Difference";
                Visible=FALSE }

    { 1500011;2;Field     ;
                SourceExpr="Vendor Exchange Rate (ACY)";
                Visible=FALSE }

    { 99  ;2   ;Field     ;
                SourceExpr="Bal. VAT Amount";
                Visible=FALSE }

    { 103 ;2   ;Field     ;
                SourceExpr="Bal. VAT Difference";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Bal. Account Type" }

    { 16  ;2   ;Field     ;
                SourceExpr="Bal. Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 1000000041;2;Field  ;
                SourceExpr="Block Bank Cheque" }

    { 71  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Posting Type";
                Visible=FALSE }

    { 73  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Bus. Posting Group";
                Visible=FALSE }

    { 105 ;2   ;Field     ;
                Name=GetAppliesToDocDueDate;
                CaptionML=[ENU=Applies-to Doc. Due Date;
                           THA=ใช้กับวันครบกำหนดของเอกสาร];
                SourceExpr=GetAppliesToDocDueDate }

    { 67  ;2   ;Field     ;
                SourceExpr="Bank Payment Type" }

    { 75  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Prod. Posting Group";
                Visible=FALSE }

    { 59  ;2   ;Field     ;
                SourceExpr="Check Printed";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Bal. VAT Bus. Posting Group";
                Visible=FALSE }

    { 69  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                SourceExpr="Bal. VAT Prod. Posting Group";
                Visible=FALSE }

    { 49  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 18  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type" }

    { 20  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No." }

    { 22  ;2   ;Field     ;
                SourceExpr="Applies-to ID";
                Visible=FALSE }

    { 24  ;1   ;Group      }

    { 1903561801;2;Group  ;
                GroupType=FixedLayout }

    { 1903866901;3;Group  ;
                CaptionML=[ENU=Account Name;
                           THA=ชื่อบัญชี] }

    { 29  ;4   ;Field     ;
                SourceExpr=AccName;
                Editable=FALSE }

    { 1902759701;3;Group  ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล] }

    { 31  ;4   ;Field     ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล];
                SourceExpr=BalAccName;
                Editable=FALSE }

    { 1900545401;3;Group  ;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ] }

    { 25  ;4   ;Field     ;
                Name=Balance;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ];
                SourceExpr=Balance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=BalanceVisible;
                Editable=FALSE }

    { 1900295801;3;Group  ;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล] }

    { 27  ;4   ;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล];
                SourceExpr=TotalBalance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=TotalBalanceVisible;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900919607;1;Part   ;
                SubFormLink=Table ID=CONST(81),Journal Template Name=FIELD(Journal Template Name),Journal Batch Name=FIELD(Journal Batch Name),Journal Line No.=FIELD(Line No.);
                PagePartID=Page545;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=Void Check %1?;THA=โมฆะเช็ค %1 หรือไม่';
      Text001@1000000001 : TextConst 'ENU=Void all printed checks?;THA=โมฆะเช็คทั้งหมดที่พิมพ์หรือไม่';
      ChangeExchangeRate@1000000002 : Form 511;
      GenJnlLine@1000000003 : Record 81;
      GenJnlLine2@1000000004 : Record 81;
      GLReconcile@1000000005 : Form 345;
      CreateVendorPmtSuggestion@1000000006 : Report 393;
      GenJnlManagement@1000000007 : Codeunit 230;
      ReportPrint@1000000008 : Codeunit 228;
      DocPrint@1000000009 : Codeunit 229;
      CheckManagement@1000000010 : Codeunit 367;
      WHTManagement@1000000011 : Codeunit 28040;
      PostDatedCheckMgt@1000000012 : Codeunit 28090;
      CurrentJnlBatchName@1000000013 : Code[10];
      AccName@1000000014 : Text[50];
      BalAccName@1000000015 : Text[50];
      Balance@1000000016 : Decimal;
      TotalBalance@1000000017 : Decimal;
      ShowBalance@1000000018 : Boolean;
      ShowTotalBalance@1000000019 : Boolean;
      ShortcutDimCode@1000000020 : ARRAY [8] OF Code[20];
      OpenedFromBatch@1000000021 : Boolean;
      TType@1000000022 : 'Vendor,Customer';
      C_0001@1000000023 : TextConst 'ENU=Do you want to get WHT from petty cash?';
      C_0002@1000000024 : TextConst 'ENU=Successfully Inserted.;THA=บันทึกรายการเรียบร้อยแล้ว';
      C_0003@1000000025 : TextConst 'ENU=WHT Entries does not exists.;THA=ไม่พบรายการภาษีหัก ณ ที่จ่าย';
      GenJnlBatch@1000000026 : Record 232;
      "WHT Certificate No.Editable"@19059849 : Boolean INDATASET;
      BalanceVisible@19073040 : Boolean INDATASET;
      TotalBalanceVisible@19063333 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateBalance@1();
    BEGIN
      GenJnlManagement.CalcBalance(
        Rec,xRec,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      BalanceVisible := ShowBalance;
      TotalBalanceVisible := ShowTotalBalance;
    END;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      GenJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
      UpdateBalance;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.12.2004   KKE   -Fixed and update WHT.
                               -Modify program to be able to preprint WHT Slip before posting payment entry in payment journal
                                for all payment to vendor.
                               -System has to assign no. from WHT Slip Nos. in Purchase & Payable Setup Table.
                               -For payment line where WHT Slip is printed, system must fill in WHT Slip No. and check mark in
                                WHT Slip Printed field.
                               -User must be able to reprint, but system will not assign new WHT Slip No.
      002   24.12.2004   KKE   -Add menu "Get Cash Advance","Get WHT from Petty Cash" on payment button.
                                Automatically get payment journal for cash advance.
      003   04.08.2005   KKE   -Modify WHT to support incase of changing WHT amount different
                                with the system supplier calculation.
      004   08.08.2006   KKE   -Modify program to be able to manual input WHT Certificate No.
      005   27.11.2007   KKE   -Reset Applies-to ID on Closed Vendor Ledger Entries.
      Project Burda
      050   11.03.2008   KKE   -Add menu function "Bank Cheque (Create File)" and "Unblock Bank Cheque".
    }
    END.
  }
}

OBJECT Page 279 Source Code Setup
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW15.00,LIQEM6.00,NAVAP4.00,AVATHA4.40;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Source Code Setup;
               THA=เซ็ตอัพรหัสแหล่งที่มา];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table242;
    PageType=Card;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="General Journal" }

    { 113 ;2   ;Field     ;
                SourceExpr="IC General Journal" }

    { 4   ;2   ;Field     ;
                SourceExpr="Close Income Statement" }

    { 8   ;2   ;Field     ;
                SourceExpr="VAT Settlement" }

    { 1500002;2;Field     ;
                SourceExpr="WHT Settlement" }

    { 12  ;2   ;Field     ;
                SourceExpr="Exchange Rate Adjmt." }

    { 20  ;2   ;Field     ;
                SourceExpr="Deleted Document" }

    { 83  ;2   ;Field     ;
                SourceExpr="Adjust Add. Reporting Currency" }

    { 6   ;2   ;Field     ;
                SourceExpr="Compress G/L" }

    { 10  ;2   ;Field     ;
                SourceExpr="Compress VAT Entries" }

    { 53  ;2   ;Field     ;
                SourceExpr="Compress Bank Acc. Ledger" }

    { 63  ;2   ;Field     ;
                SourceExpr="Compress Check Ledger" }

    { 65  ;2   ;Field     ;
                SourceExpr="Financially Voided Check" }

    { 93  ;2   ;Field     ;
                SourceExpr="Trans. Bank Rec. to Gen. Jnl." }

    { 119 ;2   ;Field     ;
                SourceExpr=Reversal }

    { 1461000;2;Field     ;
                SourceExpr="Liquidity Journal" }

    { 1904305601;1;Group  ;
                CaptionML=[ENU=Sales;
                           THA=การขาย] }

    { 14  ;2   ;Field     ;
                SourceExpr=Sales }

    { 16  ;2   ;Field     ;
                SourceExpr="Sales Journal" }

    { 18  ;2   ;Field     ;
                SourceExpr="Cash Receipt Journal" }

    { 22  ;2   ;Field     ;
                SourceExpr="Sales Entry Application" }

    { 121 ;2   ;Field     ;
                SourceExpr="Unapplied Sales Entry Appln." }

    { 69  ;2   ;Field     ;
                SourceExpr=Reminder }

    { 67  ;2   ;Field     ;
                SourceExpr="Finance Charge Memo" }

    { 24  ;2   ;Field     ;
                SourceExpr="Compress Cust. Ledger" }

    { 1907458401;1;Group  ;
                CaptionML=[ENU=Purchases;
                           THA=การซื้อ] }

    { 26  ;2   ;Field     ;
                SourceExpr=Purchases }

    { 28  ;2   ;Field     ;
                SourceExpr="Purchase Journal" }

    { 30  ;2   ;Field     ;
                SourceExpr="Payment Journal" }

    { 32  ;2   ;Field     ;
                SourceExpr="Purchase Entry Application" }

    { 123 ;2   ;Field     ;
                SourceExpr="Unapplied Purch. Entry Appln." }

    { 34  ;2   ;Field     ;
                SourceExpr="Compress Vend. Ledger" }

    { 1000000001;2;Field  ;
                SourceExpr="Petty Cash" }

    { 1000000000;2;Field  ;
                SourceExpr="Cash Advance" }

    { 1904162201;1;Group  ;
                CaptionML=[ENU=Inventory;
                           THA=สินค้าคงคลัง] }

    { 103 ;2   ;Field     ;
                SourceExpr=Transfer }

    { 36  ;2   ;Field     ;
                SourceExpr="Item Journal" }

    { 49  ;2   ;Field     ;
                SourceExpr="Item Reclass. Journal" }

    { 51  ;2   ;Field     ;
                SourceExpr="Phys. Inventory Journal" }

    { 38  ;2   ;Field     ;
                SourceExpr="BOM Journal" }

    { 107 ;2   ;Field     ;
                SourceExpr="Revaluation Journal" }

    { 40  ;2   ;Field     ;
                SourceExpr="Inventory Post Cost" }

    { 42  ;2   ;Field     ;
                SourceExpr="Compress Item Ledger" }

    { 44  ;2   ;Field     ;
                SourceExpr="Compress BOM Ledger" }

    { 109 ;2   ;Field     ;
                SourceExpr="Adjust Cost" }

    { 1903030901;1;Group  ;
                CaptionML=[ENU=Resources;
                           THA=ทรัพยากร] }

    { 55  ;2   ;Field     ;
                SourceExpr="Resource Journal" }

    { 57  ;2   ;Field     ;
                SourceExpr="Compress Res. Ledger" }

    { 1903715801;1;Group  ;
                CaptionML=[ENU=Jobs;
                           THA=งาน] }

    { 61  ;2   ;Field     ;
                SourceExpr="Job Journal" }

    { 127 ;2   ;Field     ;
                SourceExpr="Job G/L Journal" }

    { 129 ;2   ;Field     ;
                SourceExpr="Job G/L WIP" }

    { 59  ;2   ;Field     ;
                SourceExpr="Compress Job Ledger" }

    { 1906780401;1;Group  ;
                CaptionML=[ENU=Fixed Assets;
                           THA=สินทรัพย์ถาวร] }

    { 77  ;2   ;Field     ;
                SourceExpr="Fixed Asset G/L Journal" }

    { 78  ;2   ;Field     ;
                SourceExpr="Fixed Asset Journal" }

    { 79  ;2   ;Field     ;
                SourceExpr="Insurance Journal" }

    { 73  ;2   ;Field     ;
                SourceExpr="Compress FA Ledger" }

    { 72  ;2   ;Field     ;
                SourceExpr="Compress Maintenance Ledger" }

    { 71  ;2   ;Field     ;
                SourceExpr="Compress Insurance Ledger" }

    { 1904591101;1;Group  ;
                CaptionML=[ENU=Manufacturing;
                           THA=การผลิต] }

    { 85  ;2   ;Field     ;
                SourceExpr="Consumption Journal" }

    { 87  ;2   ;Field     ;
                SourceExpr="Output Journal" }

    { 89  ;2   ;Field     ;
                SourceExpr=Flushing }

    { 91  ;2   ;Field     ;
                SourceExpr="Capacity Journal" }

    { 125 ;2   ;Field     ;
                SourceExpr="Production Journal" }

    { 1902138501;1;Group  ;
                CaptionML=[ENU=Service;
                           THA=การบริการ] }

    { 105 ;2   ;Field     ;
                SourceExpr="Service Management" }

    { 1907509201;1;Group  ;
                CaptionML=[ENU=Warehouse;
                           THA=คลังสินค้า] }

    { 111 ;2   ;Field     ;
                SourceExpr="Whse. Item Journal" }

    { 97  ;2   ;Field     ;
                SourceExpr="Whse. Reclassification Journal" }

    { 115 ;2   ;Field     ;
                SourceExpr="Whse. Phys. Invt. Journal" }

    { 95  ;2   ;Field     ;
                SourceExpr="Whse. Put-away" }

    { 99  ;2   ;Field     ;
                SourceExpr="Whse. Pick" }

    { 101 ;2   ;Field     ;
                SourceExpr="Whse. Movement" }

    { 117 ;2   ;Field     ;
                SourceExpr="Compress Whse. Entries" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.08.2006   KKE   -Petty Cash
      002   30.08.2006   KKE   -Cash Advance
    }
    END.
  }
}

OBJECT Page 306 Report Selection - Sales
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=[ 3:47:05 PM];
    Version List=NAVW15.00,KITNA5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Report Selection - Sales;
               THA=การเลือกรายงาน - การขาย];
    SaveValues=Yes;
    SourceTable=Table77;
    PageType=Worksheet;
    OnOpenPage=BEGIN
                 SetUsageFilter;
               END;

    OnNewRecord=BEGIN
                  NewRecord;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 11  ;1   ;Field     ;
                CaptionML=[ENU=Usage;
                           THA=การใช้งาน];
                OptionCaptionML=[ENU=Quote,Blanket Order,Order,Invoice,Work Order,Return Order,Credit Memo,Shipment,Return Receipt,Sales Document - Test,Prepayment Document - Test,Pick Ticket,Tax Invoice - WHT,Tax Credit Memno - WHT;
                                 THA=ใบเสนอราคา,ใบสั่งแบบรวม,ใบสั่ง,ใบแจ้งหนี้,ใบสั่งงาน,ใบสั่งส่งคืนสินค้า,ใบลดหนี้,ใบจัดส่ง,ใบรับสินค้าส่งคืน,เอกสารการขาย - ทดสอบ,เอกสารการชำระเงินล่วงหน้า - ทดสอบ,ใบเบิกจ่าย,Tax Invoice - WHT,Tax Credit Memno - WHT];
                SourceExpr=ReportUsage2;
                OnValidate=BEGIN
                             SetUsageFilter;
                               ReportUsage2OnAfterValidate;
                           END;
                            }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Sequence }

    { 9   ;2   ;Field     ;
                SourceExpr="Report ID";
                LookupFormID=Objects }

    { 4   ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="Report Name";
                LookupFormID=Objects }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ReportUsage2@1000000000 : 'Quote,Blanket Order,Order,Invoice,Work Order,Return Order,Credit Memo,Shipment,Return Receipt,Sales Document - Test,Prepayment Document - Test,Pick Ticket,Tax Invoice - WHT,Tax Credit Memo - WHT';

    LOCAL PROCEDURE SetUsageFilter@1();
    BEGIN
      FILTERGROUP(2);
      CASE ReportUsage2 OF
        ReportUsage2::Quote:
          SETRANGE(Usage,Usage::"S.Quote");
        ReportUsage2::"Blanket Order":
          SETRANGE(Usage,Usage::"S.Blanket");
        ReportUsage2::Order:
          SETRANGE(Usage,Usage::"S.Order");
        ReportUsage2::"Work Order":
          SETRANGE(Usage,Usage::"S.Work Order");
        ReportUsage2::Invoice:
          SETRANGE(Usage,Usage::"S.Invoice");
        ReportUsage2::"Return Order":
          SETRANGE(Usage,Usage::"S.Return");
        ReportUsage2::"Credit Memo":
          SETRANGE(Usage,Usage::"S.Cr.Memo");
        ReportUsage2::Shipment:
          SETRANGE(Usage,Usage::"S.Shipment");
        ReportUsage2::"Return Receipt":
          SETRANGE(Usage,Usage::"S.Ret.Rcpt.");
        ReportUsage2::"Sales Document - Test":
          SETRANGE(Usage,Usage::"S.Test");
        ReportUsage2::"Prepayment Document - Test":
          SETRANGE(Usage,Usage::"S.Test Prepmt.");
        ReportUsage2::"Pick Ticket":
          SETRANGE(Usage,Usage::"S.Pick");
        //KKE : #001 +
        ReportUsage2::"Tax Invoice - WHT":
          SETRANGE(Usage,Usage::"S.TaxInvoice");
        ReportUsage2::"Tax Credit Memo - WHT":
          SETRANGE(Usage,Usage::"P.TaxCreditMemo");
        //KKE : #001 -
      END;
      FILTERGROUP(0);
    END;

    LOCAL PROCEDURE ReportUsage2OnAfterValidate@19038799();
    BEGIN
      CurrPage.UPDATE;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Correct function SetUsageFilter.
    }
    END.
  }
}

OBJECT Page 315 VAT Entries
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW15.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=VAT Entries;
               THA=รายการ VAT];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table254;
    PageType=List;
    OnOpenPage=BEGIN
                 //KKE : #002 +
                 currMonth := DATE2DMY(TODAY,2);
                 currYear := DATE2DMY(TODAY,3);
                 StartingDate := DMY2DATE(1,currMonth,currYear);
                 EndingDate := TODAY;
                 //KKE : #002 -
               END;

    OnModifyRecord=BEGIN
                     CODEUNIT.RUN(CODEUNIT::"VAT Entry - Edit",Rec);
                     EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000000;1 ;Action    ;
                      CaptionML=[ENU=Calculate;
                                 THA=คำนวณ];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //KKE : #002 +
                                 RESET;
                                 IF (StartingDate= 0D) OR (EndingDate = 0D) THEN
                                   ERROR(C_0001);
                                 IF EndingDate - StartingDate < 0 THEN
                                   ERROR(C_0002);

                                 CLEARMARKS;
                                 SumCase1 := 0;
                                 SumCase2 := 0;
                                 SumCase3 := 0;

                                 //CASE 1
                                 TmpVATEntry.RESET;
                                 TmpVATEntry.SETRANGE(Type,TmpVATEntry.Type::Purchase);
                                 TmpVATEntry.SETFILTER("Posting Date",'%1..%2',StartingDate,EndingDate);
                                 TmpVATEntry.SETRANGE("Tax Invoice No.",'');
                                 TmpVATEntry.SETCURRENTKEY("Posting Date","Document Type","Document No.");
                                 IF TmpVATEntry.FIND('-') THEN
                                 REPEAT
                                   SumCase1 += TmpVATEntry.Amount;
                                   "Entry No." := TmpVATEntry."Entry No.";
                                   MARK(TRUE);
                                 UNTIL TmpVATEntry.NEXT = 0;

                                 //CASE 2
                                 TmpVATEntry.RESET;
                                 TmpVATEntry.SETRANGE(Type,TmpVATEntry.Type::Purchase);
                                 TmpVATEntry.SETFILTER("Posting Date",'<%1 | >%2',StartingDate,EndingDate);
                                 TmpVATEntry.SETFILTER("Submit Date",'%1..%2',StartingDate,EndingDate);
                                 TmpVATEntry.SETFILTER("Tax Invoice No.",'<>%1','');
                                 TmpVATEntry.SETCURRENTKEY("Posting Date","Document Type","Document No.");
                                 IF TmpVATEntry.FIND('-') THEN
                                 REPEAT
                                   SumCase2 += TmpVATEntry.Amount;
                                   "Entry No." := TmpVATEntry."Entry No.";
                                   MARK(TRUE);
                                 UNTIL TmpVATEntry.NEXT = 0;

                                 //CASE 3
                                 TmpVATEntry.RESET;
                                 TmpVATEntry.SETRANGE(Type,TmpVATEntry.Type::Purchase);
                                 TmpVATEntry.SETFILTER("Posting Date",'%1..%2',StartingDate,EndingDate);
                                 TmpVATEntry.SETFILTER("Submit Date",'< %1 | > %2',StartingDate,EndingDate);
                                 TmpVATEntry.SETFILTER("Tax Invoice No.",'<>%1','');
                                 TmpVATEntry.SETCURRENTKEY("Posting Date","Document Type","Document No.");
                                 IF TmpVATEntry.FIND('-') THEN
                                 REPEAT
                                   SumCase3 += TmpVATEntry.Amount;
                                   "Entry No." := TmpVATEntry."Entry No.";
                                   MARK(TRUE);
                                 UNTIL TmpVATEntry.NEXT = 0;

                                 SumNotOnReport := SumCase1 + SumCase3;
                                 SumShowedOnReport := (-1) * SumCase2;

                                 MARKEDONLY(TRUE);
                                 CurrPage.UPDATE;
                                 //KKE : #002 -
                               END;
                                }
      { 34      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Entry No." }

    { 4   ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 40  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group" }

    { 8   ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 44  ;2   ;Field     ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Document No." }

    { 1000000021;2;Field  ;
                SourceExpr="External Document No." }

    { 1000000011;2;Field  ;
                SourceExpr="Tax Invoice No." }

    { 1000000013;2;Field  ;
                SourceExpr="Tax Invoice Date" }

    { 1000000015;2;Field  ;
                SourceExpr="Submit Date" }

    { 1000000023;2;Field  ;
                SourceExpr="Real Customer/Vendor Name";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 14  ;2   ;Field     ;
                SourceExpr=Type }

    { 16  ;2   ;Field     ;
                SourceExpr=Base }

    { 18  ;2   ;Field     ;
                SourceExpr=Amount }

    { 1000000019;2;Field  ;
                SourceExpr="Unrealized Base" }

    { 1000000017;2;Field  ;
                SourceExpr="Unrealized Amount" }

    { 46  ;2   ;Field     ;
                SourceExpr="VAT Difference";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Additional-Currency Base";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Additional-Currency Amount";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Add.-Curr. VAT Difference";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="VAT Calculation Type" }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to/Pay-to No." }

    { 54  ;2   ;Field     ;
                SourceExpr="VAT Registration No.";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to/Order Address Code";
                Visible=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Country/Region Code" }

    { 24  ;2   ;Field     ;
                SourceExpr="EU 3-Party Trade" }

    { 26  ;2   ;Field     ;
                SourceExpr=Closed }

    { 28  ;2   ;Field     ;
                SourceExpr="Closed by Entry No." }

    { 30  ;2   ;Field     ;
                SourceExpr="Internal Ref. No." }

    { 56  ;2   ;Field     ;
                SourceExpr=Reversed;
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Reversed by Entry No.";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Reversed Entry No.";
                Visible=FALSE }

    { 1000000006;1;Field  ;
                CaptionML=ENU=ตั้งแต่;
                SourceExpr=StartingDate }

    { 1000000004;1;Field  ;
                CaptionML=ENU=ถึง;
                SourceExpr=EndingDate }

    { 1000000008;1;Field  ;
                CaptionML=ENU=ไม่ออกรายงานแต่ลงบัญชีในช่วง;
                BlankZero=Yes;
                SourceExpr=SumNotOnReport;
                Editable=FALSE }

    { 1000000009;1;Field  ;
                CaptionML=ENU=มีในรายงานแต่ไม่ได้ลงบัญชีในช่วง;
                BlankZero=Yes;
                SourceExpr=SumShowedOnReport;
                Editable=FALSE }

    { 1000000010;1;Field  ;
                CaptionML=ENU=รวมผลต่างระหว่างรายงานกับบัญชี;
                BlankZero=Yes;
                SourceExpr=SumNotOnReport + SumShowedOnReport;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Navigate@1000000000 : Form 344;
      TmpVATEntry@1000000001 : Record 254;
      StartingDate@1000000002 : Date;
      EndingDate@1000000003 : Date;
      currMonth@1000000004 : Integer;
      currYear@1000000005 : Integer;
      SumShowedOnReport@1000000006 : Decimal;
      SumNotOnReport@1000000007 : Decimal;
      SumCase1@1000000008 : Decimal;
      SumCase2@1000000009 : Decimal;
      SumCase3@1000000010 : Decimal;
      C_0001@1000000011 : TextConst 'ENU=Please specify both Starting Date and Ending Date;THA=กรุณาระบุวันที่เริ่มต้น และวันที่ สุดท้าย';
      C_0002@1000000012 : TextConst 'ENU=Invalid Date.;THA=วันที่เริ่มต้นและวันที่สุดท้ายไม่ถูกต้อง';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2004   KKE   -Add new fields for localization.
                               -Allow user to edit "Tax Invoice No.","Tax Invoice Date",Submit Date".
      002   28.12.2004   KKE   -Calculate Tax Invoice amount which show on report and not show on report.
    }
    END.
  }
}

OBJECT Page 344 Navigate
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,CACEM6.00,NAVAP6.00,AVATHA4.40;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Navigate;
               THA=นำทางข้อมูล];
    SaveValues=Yes;
    SourceTable=Table265;
    PageType=NavigatePage;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             SourceNameEnable := TRUE;
             SourceNoEnable := TRUE;
             SourceTypeEnable := TRUE;
             DocTypeEnable := TRUE;
             PrintEnable := TRUE;
             ShowEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 IF (NewDocNo = '') AND (NewPostingDate = 0D) AND (NewSerialNo = '') AND (NewLotNo = '') THEN BEGIN
                   DELETEALL;
                   ShowEnable := FALSE;
                   PrintEnable := FALSE;
                   SetSource(0D,'','',0,'');
                 END ELSE
                   IF (NewSerialNo <> '') OR (NewLotNo <> '') THEN BEGIN
                     SETRANGE("Serial No. Filter",NewSerialNo);
                     SETRANGE("Lot No. Filter",NewLotNo);
                     SerialNoFilter := GETFILTER("Serial No. Filter");
                     LotNoFilter := GETFILTER("Lot No. Filter");
                     ClearInfo;
                     FindTrackingRecords;
                   END ELSE BEGIN
                     SETRANGE("Document No.",NewDocNo);
                     SETRANGE("Posting Date",NewPostingDate);
                     DocNoFilter := GETFILTER("Document No.");
                     PostingDateFilter := GETFILTER("Posting Date");
                     ContactType := ContactType::" ";
                     ContactNo := '';
                     ExtDocNo := '';
                     ClearTrackingInfo;
                     FindRecords;
                   END;
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 2       ;1   ;Action    ;
                      CaptionML=[ENU=Fi&nd;
                                 THA=ค้น&หา];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 FindPush;
                               END;
                                }
      { 21      ;1   ;Action    ;
                      Name=Show;
                      CaptionML=[ENU=&Show;
                                 THA=&แสดง];
                      Promoted=Yes;
                      Enabled=ShowEnable;
                      PromotedIsBig=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      RunFormMode=View;
                      OnAction=BEGIN
                                 ShowRecords;
                               END;
                                }
      { 34      ;1   ;Action    ;
                      Name=Print;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Enabled=PrintEnable;
                      PromotedIsBig=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ItemTrackingNavigate@1000000001 : Report 6529;
                                 DocumentEntries@1000000002 : Report 35;
                               BEGIN
                                 IF ItemTrackingSearch THEN BEGIN
                                   CLEAR(ItemTrackingNavigate);
                                   ItemTrackingNavigate.TransferDocEntries(Rec);
                                   ItemTrackingNavigate.TransferRecordBuffer(TempRecordBuffer);
                                   ItemTrackingNavigate.TransferFilters(SerialNoFilter,LotNoFilter,'','');
                                   ItemTrackingNavigate.RUN;
                                 END ELSE BEGIN
                                   DocumentEntries.TransferDocEntries(Rec);
                                   DocumentEntries.TransferFilters(DocNoFilter,PostingDateFilter);
                                   DocumentEntries.RUN;
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 27  ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 3   ;2   ;Field     ;
                CaptionML=[ENU=Document No.;
                           THA=หมายเลขเอกสาร];
                SourceExpr=DocNoFilter;
                OnValidate=BEGIN
                             SetDocNo(DocNoFilter);
                             ContactType := ContactType::" ";
                             ContactNo := '';
                             ExtDocNo := '';
                             ClearTrackingInfo;
                               DocNoFilterOnAfterValidate;
                           END;
                            }

    { 5   ;2   ;Field     ;
                CaptionML=[ENU=Posting Date;
                           THA=วันที่ลงรายการบัญชี];
                SourceExpr=PostingDateFilter;
                OnValidate=BEGIN
                             SetPostingDate(PostingDateFilter);
                             ContactType := ContactType::" ";
                             ContactNo := '';
                             ExtDocNo := '';
                             ClearTrackingInfo;
                               PostingDateFilterOnAfterValidate;
                           END;
                            }

    { 7   ;1   ;Group     ;
                CaptionML=[ENU=Source;
                           THA=แหล่งที่มา] }

    { 8   ;2   ;Field     ;
                Name=DocType;
                CaptionML=[ENU=Document Type;
                           THA=ชนิดเอกสาร];
                SourceExpr=DocType;
                Enabled=DocTypeEnable;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                Name=SourceType;
                CaptionML=[ENU=Source Type;
                           THA=ชนิดแหล่งที่มา];
                SourceExpr=SourceType;
                Enabled=SourceTypeEnable;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                Name=SourceNo;
                CaptionML=[ENU=Source No.;
                           THA=หมายเลขแหล่งที่มา];
                SourceExpr=SourceNo;
                Enabled=SourceNoEnable;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                Name=SourceName;
                CaptionML=[ENU=Source Name;
                           THA=ชื่อแหล่งที่มา];
                SourceExpr=SourceName;
                Enabled=SourceNameEnable;
                Editable=FALSE }

    { 16  ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 24  ;2   ;Field     ;
                SourceExpr="Entry No.";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Table ID";
                Visible=FALSE }

    { 17  ;2   ;Field     ;
                SourceExpr="Table Name" }

    { 19  ;2   ;Field     ;
                DrillDown=Yes;
                SourceExpr="No. of Records";
                OnDrillDown=BEGIN
                              ShowRecords;
                            END;
                             }

    { 1902856201;1;Group  ;
                CaptionML=[ENU=External;
                           THA=ภายนอก] }

    { 30  ;2   ;Field     ;
                CaptionML=[ENU=Business Contact Type;
                           THA=ชนิดของผู้ติดต่อทางธุรกิจ];
                OptionCaptionML=[ENU=" ,Vendor,Customer";
                                 THA=" ,ผู้ขาย,ลูกค้า"];
                SourceExpr=ContactType;
                OnValidate=BEGIN
                             SetDocNo('');
                             SetPostingDate('');
                             ClearTrackingInfo;
                               ContactTypeOnAfterValidate;
                           END;
                            }

    { 32  ;2   ;Field     ;
                CaptionML=[ENU=Business Contact No.;
                           THA=หมายเลขผู้ติดต่อทางธุรกิจ];
                SourceExpr=ContactNo;
                OnValidate=BEGIN
                             SetDocNo('');
                             SetPostingDate('');
                             ClearTrackingInfo;
                               ContactNoOnAfterValidate;
                           END;

                OnLookup=VAR
                           Vend@1000000002 : Record 23;
                           Cust@1000000003 : Record 18;
                         BEGIN
                           CASE ContactType OF
                             ContactType::Vendor:
                               IF FORM.RUNMODAL(0,Vend) = ACTION::LookupOK THEN BEGIN
                                 Text := Vend."No.";
                                 EXIT(TRUE);
                               END;
                             ContactType::Customer:
                               IF FORM.RUNMODAL(0,Cust) = ACTION::LookupOK THEN BEGIN
                                 Text := Cust."No.";
                                 EXIT(TRUE);
                               END;
                           END;
                         END;
                          }

    { 28  ;2   ;Field     ;
                CaptionML=[ENU=Document No.;
                           THA=หมายเลขเอกสาร];
                SourceExpr=ExtDocNo;
                OnValidate=BEGIN
                             SetDocNo('');
                             SetPostingDate('');
                             ClearTrackingInfo;
                               ExtDocNoOnAfterValidate;
                           END;
                            }

    { 1904830201;1;Group  ;
                CaptionML=[ENU=Item Tracking;
                           THA=ติดตามสินค้า] }

    { 37  ;2   ;Field     ;
                Name=SerialNo;
                CaptionML=[ENU=Serial No.;
                           THA=หมายเลขประจำสินค้า];
                SourceExpr=SerialNoFilter;
                OnValidate=BEGIN
                             ClearInfo;
                               SerialNoFilterOnAfterValidate;
                           END;

                OnLookup=VAR
                           SerialNoInfo@1000000002 : Record 6504;
                           SerialNoList@1000000003 : Form 6509;
                         BEGIN
                           CLEAR(SerialNoList);
                           IF SerialNoList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             Text := SerialNoList.GetSelectionFilter;
                             EXIT(TRUE);
                           END;
                         END;
                          }

    { 39  ;2   ;Field     ;
                CaptionML=[ENU=Lot No.;
                           THA=หมายเลขล็อต];
                SourceExpr=LotNoFilter;
                OnValidate=BEGIN
                             ClearInfo;
                               LotNoFilterOnAfterValidate;
                           END;

                OnLookup=VAR
                           LotNoInfo@1000000002 : Record 6505;
                           LotNoList@1000000003 : Form 6508;
                         BEGIN
                           CLEAR(LotNoList);
                           IF LotNoList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             Text := LotNoList.GetSelectionFilter;
                             EXIT(TRUE);
                           END;
                         END;
                          }

  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=The business contact type was not specified.;THA=ไม่ได้ระบุชนิดของผู้ติดต่อทางธุรกิจ';
      Text001@1000000001 : TextConst 'ENU=There are no posted records with this external document number.;THA=ไม่มีเร็กคอร์ดที่ลงรายการบัญชีใดที่มีหมายเลขเอกสารภายนอกนี้';
      Text002@1000000002 : TextConst 'ENU=Counting records...;THA=กำลังนับเร็กคอร์ด...';
      Text003@1000000003 : TextConst 'ENU=Posted Sales Invoice;THA=ใบแจ้งหนี้การขายที่ลงรายการบัญชี';
      Text004@1000000004 : TextConst 'ENU=Posted Sales Credit Memo;THA=ใบลดหนี้การขายที่ลงรายการบัญชี';
      Text005@1000000005 : TextConst 'ENU=Posted Sales Shipment;THA=การจัดส่งสินค้าขายที่ลงรายการบัญชี';
      Text006@1000000006 : TextConst 'ENU=Issued Reminder;THA=จดหมายเตือนที่ออกใช้';
      Text007@1000000007 : TextConst 'ENU=Issued Finance Charge Memo;THA=บันทึกค่าธรรมเนียมทางการเงินที่ออกใช้';
      Text008@1000000008 : TextConst 'ENU=Posted Purchase Invoice;THA=ใบแจ้งหนี้การซื้อที่ลงรายการบัญชี';
      Text009@1000000009 : TextConst 'ENU=Posted Purchase Credit Memo;THA=ใบลดหนี้การซื้อที่ลงรายการบัญชี';
      Text010@1000000010 : TextConst 'ENU=Posted Purchase Receipt;THA=รับสินค้าซื้อที่ลงรายการ';
      Text011@1000000011 : TextConst 'ENU=The document number has been used more than once.;THA=มีการใช้หมายเลขเอกสารมากกว่าหนึ่งครั้ง';
      Text012@1000000012 : TextConst 'ENU=This combination of document number and posting date has been used more than once.;THA=มีการใช้หมายเลขเอกสารและวันที่ลงรายการบัญชีคู่นี้มากกว่าหนึ่งครั้ง';
      Text013@1000000013 : TextConst 'ENU=There are no posted records with this document number.;THA=ไม่มีเร็กคอร์ดที่ลงรายการบัญชีใดที่มีหมายเลขเอกสารนี้';
      Text014@1000000014 : TextConst 'ENU=There are no posted records with this combination of document number and posting date.;THA=ไม่มีเร็กคอร์ดที่ลงรายการบัญชีใดที่มีหมายเลขเอกสารและวันที่ลงรายการบัญชีคู่นี้';
      Text015@1000000015 : TextConst 'ENU=The search results in too many external documents. Please specify a business contact no.;THA=ผลการค้นหาในเอกสารภายนอกมีมากเกินไป  โปรดระบุหมายเลขผู้ติดต่อทางธุรกิจ';
      Text016@1000000016 : TextConst 'ENU=The search results in too many external documents. Please use Navigate from the relevant ledger entries.;THA=ผลการค้นหาในเอกสารภายนอกมีมากเกินไป  โปรดใช้การนำทางข้อมูลจากรายการบัญชีแยกประเภทที่เกี่ยวข้อง';
      Text017@1000000017 : TextConst 'ENU=Posted Return Receipt;THA=การรับสินค้าส่งคืนที่ลงรายการบัญชี';
      Text018@1000000018 : TextConst 'ENU=Posted Return Shipment;THA=ใบจัดส่งคืนสินค้าที่ลงรายการบัญชี';
      Text019@1000000019 : TextConst 'ENU=Posted Transfer Shipment;THA=การจัดส่งแบบโอนย้ายที่ลงรายการบัญชี';
      Text020@1000000020 : TextConst 'ENU=Posted Transfer Receipt;THA=ใบรับสินค้าโอนย้ายที่ลงรายการบัญชี';
      Text021@1000000021 : TextConst 'ENU=Sales Order;THA=ใบสั่งขาย';
      Text022@1000000022 : TextConst 'ENU=Sales Invoice;THA=ใบแจ้งหนี้การขาย';
      Text023@1000000023 : TextConst 'ENU=Sales Return Order;THA=ใบสั่งส่งคืนสินค้าขาย';
      Text024@1000000024 : TextConst 'ENU=Sales Credit Memo;THA=ใบลดหนี้การขาย';
      sText003@1000000025 : TextConst 'ENU=Posted Service Invoice;THA=ใบแจ้งหนี้บริการที่ลงรายการบัญชี';
      sText004@1000000026 : TextConst 'ENU=Posted Service Credit Memo;THA=ใบลดหนี้บริการที่ลงรายการบัญชี';
      sText005@1000000027 : TextConst 'ENU=Posted Service Shipment;THA=ใบส่งงานบริการที่ลงรายการบัญชี';
      sText021@1000000028 : TextConst 'ENU=Service Order;THA=ใบสั่งบริการ';
      sText022@1000000029 : TextConst 'ENU=Service Invoice;THA=ใบแจ้งหนี้บริการ';
      sText024@1000000030 : TextConst 'ENU=Service Credit Memo;THA=ใบลดหนี้บริการ';
      Text99000000@1000000031 : TextConst 'ENU=Production Order;THA=ใบสั่งผลิต';
      Cust@1000000032 : Record 18;
      Vend@1000000033 : Record 23;
      SOSalesHeader@1000000034 : Record 36;
      SISalesHeader@1000000035 : Record 36;
      SROSalesHeader@1000000036 : Record 36;
      SCMSalesHeader@1000000037 : Record 36;
      SalesShptHeader@1000000038 : Record 110;
      SalesInvHeader@1000000039 : Record 112;
      ReturnRcptHeader@1000000040 : Record 6660;
      SalesCrMemoHeader@1000000041 : Record 114;
      SOServHeader@1000000042 : Record 5900;
      SIServHeader@1000000043 : Record 5900;
      SCMServHeader@1000000044 : Record 5900;
      ServShptHeader@1000000045 : Record 5990;
      ServInvHeader@1000000046 : Record 5992;
      ServCrMemoHeader@1000000047 : Record 5994;
      IssuedReminderHeader@1000000048 : Record 297;
      IssuedFinChrgMemoHeader@1000000049 : Record 304;
      PurchRcptHeader@1000000050 : Record 120;
      PurchInvHeader@1000000051 : Record 122;
      ReturnShptHeader@1000000052 : Record 6650;
      PurchCrMemoHeader@1000000053 : Record 124;
      ProductionOrderHeader@1000000054 : Record 5405;
      TransShptHeader@1000000055 : Record 5744;
      TransRcptHeader@1000000056 : Record 5746;
      PostedWhseRcptLine@1000000057 : Record 7319;
      PostedWhseShptLine@1000000058 : Record 7323;
      GLEntry@1000000059 : Record 17;
      VATEntry@1000000060 : Record 254;
      WHTEntry@1000000061 : Record 28044;
      CustLedgEntry@1000000062 : Record 21;
      DtldCustLedgEntry@1000000063 : Record 379;
      VendLedgEntry@1000000064 : Record 25;
      DtldVendLedgEntry@1000000065 : Record 380;
      ItemLedgEntry@1000000066 : Record 32;
      PhysInvtLedgEntry@1000000067 : Record 281;
      ResLedgEntry@1000000068 : Record 203;
      JobLedgEntry@1000000069 : Record 169;
      ValueEntry@1000000070 : Record 5802;
      BankAccLedgEntry@1000000071 : Record 271;
      CheckLedgEntry@1000000072 : Record 272;
      ReminderEntry@1000000073 : Record 300;
      FALedgEntry@1000000074 : Record 5601;
      MaintenanceLedgEntry@1000000075 : Record 5625;
      InsuranceCovLedgEntry@1000000076 : Record 5629;
      CapacityLedgEntry@1000000077 : Record 5832;
      ServLedgerEntry@1000000078 : Record 5907;
      WarrantyLedgerEntry@1000000079 : Record 5908;
      WhseEntry@1000000080 : Record 7312;
      TempRecordBuffer@1000000081 : TEMPORARY Record 6529;
      ApplicationManagement@1000000082 : Codeunit 1;
      ItemTrackingNavigateMgt@1000000083 : Codeunit 6529;
      Window@1000000084 : Dialog;
      DocNoFilter@1000000085 : Code[250];
      PettyCashInvHdr@1000000086 : Record 55004;
      PostingDateFilter@1000000087 : Text[250];
      PettyCashInvLine@1000000088 : Record 55005;
      NewDocNo@1000000089 : Code[20];
      Text55000@1000000090 : TextConst 'ENU=Posted Petty Cash Invoice';
      ContactNo@1000000091 : Code[250];
      CashAdvInvHdr@1000000092 : Record 55054;
      ExtDocNo@1000000093 : Code[250];
      CashAdvInvLine@1000000094 : Record 55055;
      NewPostingDate@1000000095 : Date;
      Text55050@1000000096 : TextConst 'ENU=Posted Cash Advance Invoice';
      DocType@1000000097 : Text[50];
      SourceType@1000000098 : Text[30];
      SourceNo@1000000099 : Code[20];
      SourceName@1000000100 : Text[50];
      ContactType@1000000101 : ' ,Vendor,Customer';
      DocExists@1000000102 : Boolean;
      NewSerialNo@1000000103 : Code[20];
      NewLotNo@1000000104 : Code[20];
      SerialNoFilter@1000000105 : Code[1000];
      LotNoFilter@1000000106 : Code[1000];
      CostEntry@1000000107 : Record 3010554;
      GSTPurchEntry@1000000108 : Record 28160;
      GSTSalesEntry@1000000109 : Record 28161;
      ShowEnable@19017131 : Boolean INDATASET;
      PrintEnable@19037407 : Boolean INDATASET;
      DocTypeEnable@19044345 : Boolean INDATASET;
      SourceTypeEnable@19078091 : Boolean INDATASET;
      SourceNoEnable@19029280 : Boolean INDATASET;
      SourceNameEnable@19028072 : Boolean INDATASET;

    PROCEDURE SetDoc@1(PostingDate@1000000000 : Date;DocNo@1000000001 : Code[20]);
    BEGIN
      NewDocNo := DocNo;
      NewPostingDate := PostingDate;
    END;

    LOCAL PROCEDURE FindExtRecords@8();
    VAR
      VendLedgEntry2@1000000000 : Record 25;
      FoundRecords@1000000001 : Boolean;
      DateFilter2@1000000002 : Code[250];
      DocNoFilter2@1000000003 : Code[250];
    BEGIN
      FoundRecords := FALSE;
      CASE ContactType OF
        ContactType::Vendor:
          BEGIN
            VendLedgEntry2.SETCURRENTKEY("External Document No.");
            VendLedgEntry2.SETFILTER("External Document No.",ExtDocNo);
            VendLedgEntry2.SETFILTER("Vendor No.",ContactNo);
            IF VendLedgEntry2.FINDSET THEN BEGIN
              REPEAT
                MakeExtFilter(
                  DateFilter2,
                  VendLedgEntry2."Posting Date",
                  DocNoFilter2,
                  VendLedgEntry2."Document No.");
              UNTIL VendLedgEntry2.NEXT = 0;
              SetPostingDate(DateFilter2);
              SetDocNo(DocNoFilter2);
              FindRecords;
              FoundRecords := TRUE;
            END;
          END;
        ContactType::Customer:
          BEGIN
            DELETEALL;
            "Entry No." := 0;
            FindUnpostedSalesDocs(SOSalesHeader."Document Type"::Order,Text021,SOSalesHeader);
            FindUnpostedSalesDocs(SISalesHeader."Document Type"::Invoice,Text022,SISalesHeader);
            FindUnpostedSalesDocs(SROSalesHeader."Document Type"::"Return Order",Text023,SROSalesHeader);
            FindUnpostedSalesDocs(SCMSalesHeader."Document Type"::"Credit Memo",Text024,SCMSalesHeader);
            IF SalesShptHeader.READPERMISSION THEN BEGIN
              SalesShptHeader.RESET;
              SalesShptHeader.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
              SalesShptHeader.SETFILTER("Sell-to Customer No.",ContactNo);
              SalesShptHeader.SETFILTER("External Document No.",ExtDocNo);
              InsertIntoDocEntry(
                DATABASE::"Sales Shipment Header",0,Text005,SalesShptHeader.COUNT);
            END;
            IF SalesInvHeader.READPERMISSION THEN BEGIN
              SalesInvHeader.RESET;
              SalesInvHeader.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
              SalesInvHeader.SETFILTER("Sell-to Customer No.",ContactNo);
              SalesInvHeader.SETFILTER("External Document No.",ExtDocNo);
              InsertIntoDocEntry(
                DATABASE::"Sales Invoice Header",0,Text003,SalesInvHeader.COUNT);
            END;
            IF ReturnRcptHeader.READPERMISSION THEN BEGIN
              ReturnRcptHeader.RESET;
              ReturnRcptHeader.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
              ReturnRcptHeader.SETFILTER("Sell-to Customer No.",ContactNo);
              ReturnRcptHeader.SETFILTER("External Document No.",ExtDocNo);
              InsertIntoDocEntry(
                DATABASE::"Return Receipt Header",0,Text017,ReturnRcptHeader.COUNT);
            END;
            IF SalesCrMemoHeader.READPERMISSION THEN BEGIN
              SalesCrMemoHeader.RESET;
              SalesCrMemoHeader.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
              SalesCrMemoHeader.SETFILTER("Sell-to Customer No.",ContactNo);
              SalesCrMemoHeader.SETFILTER("External Document No.",ExtDocNo);
              InsertIntoDocEntry(
                DATABASE::"Sales Cr.Memo Header",0,Text004,SalesCrMemoHeader.COUNT);
            END;
            FindUnpostedServDocs(SOServHeader."Document Type"::Order,sText021,SOServHeader);
            FindUnpostedServDocs(SIServHeader."Document Type"::Invoice,sText022,SIServHeader);
            FindUnpostedServDocs(SCMServHeader."Document Type"::"Credit Memo",sText024,SCMServHeader);
            IF ServShptHeader.READPERMISSION THEN BEGIN
              IF ExtDocNo = '' THEN BEGIN
                ServShptHeader.RESET;
                ServShptHeader.SETCURRENTKEY("Customer No.");
                ServShptHeader.SETFILTER("Customer No.",ContactNo);
                InsertIntoDocEntry(
                  DATABASE::"Service Shipment Header",0,sText005,ServShptHeader.COUNT);
              END;
            END;
            IF ServInvHeader.READPERMISSION THEN BEGIN
              IF ExtDocNo = '' THEN BEGIN
                ServInvHeader.RESET;
                ServShptHeader.SETCURRENTKEY("Customer No.");
                ServInvHeader.SETFILTER("Customer No.",ContactNo);
                InsertIntoDocEntry(
                  DATABASE::"Service Invoice Header",0,sText003,ServInvHeader.COUNT);
              END;
            END;
            IF ServCrMemoHeader.READPERMISSION THEN BEGIN
              IF ExtDocNo = '' THEN BEGIN
                ServCrMemoHeader.RESET;
                ServShptHeader.SETCURRENTKEY("Customer No.");
                ServCrMemoHeader.SETFILTER("Customer No.",ContactNo);
                InsertIntoDocEntry(
                  DATABASE::"Service Cr.Memo Header",0,sText004,ServCrMemoHeader.COUNT);
              END;
            END;

            DocExists := FINDFIRST;

            UpdateFormAfterFindRecords;
            FoundRecords := DocExists;
          END;
        ELSE
          ERROR(Text000);
      END;

      IF NOT FoundRecords THEN BEGIN
        SetSource(0D,'','',0,'');
        MESSAGE(Text001);
      END;
    END;

    LOCAL PROCEDURE FindRecords@2();
    BEGIN
      Window.OPEN(Text002);
      RESET;
      DELETEALL;
      "Entry No." := 0;
      IF SalesShptHeader.READPERMISSION THEN BEGIN
        SalesShptHeader.RESET;
        SalesShptHeader.SETFILTER("No.",DocNoFilter);
        SalesShptHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Sales Shipment Header",0,Text005,SalesShptHeader.COUNT);
      END;
      IF SalesInvHeader.READPERMISSION THEN BEGIN
        SalesInvHeader.RESET;
        SalesInvHeader.SETFILTER("No.",DocNoFilter);
        SalesInvHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Sales Invoice Header",0,Text003,SalesInvHeader.COUNT);
      END;
      IF ReturnRcptHeader.READPERMISSION THEN BEGIN
        ReturnRcptHeader.RESET;
        ReturnRcptHeader.SETFILTER("No.",DocNoFilter);
        ReturnRcptHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Return Receipt Header",0,Text017,ReturnRcptHeader.COUNT);
      END;
      IF SalesCrMemoHeader.READPERMISSION THEN BEGIN
        SalesCrMemoHeader.RESET;
        SalesCrMemoHeader.SETFILTER("No.",DocNoFilter);
        SalesCrMemoHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Sales Cr.Memo Header",0,Text004,SalesCrMemoHeader.COUNT);
      END;
      IF ServShptHeader.READPERMISSION THEN BEGIN
        ServShptHeader.RESET;
        ServShptHeader.SETFILTER("No.",DocNoFilter);
        ServShptHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Service Shipment Header",0,sText005,ServShptHeader.COUNT);
      END;
      IF ServInvHeader.READPERMISSION THEN BEGIN
        ServInvHeader.RESET;
        ServInvHeader.SETFILTER("No.",DocNoFilter);
        ServInvHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Service Invoice Header",0,sText003,ServInvHeader.COUNT);
      END;
      IF ServCrMemoHeader.READPERMISSION THEN BEGIN
        ServCrMemoHeader.RESET;
        ServCrMemoHeader.SETFILTER("No.",DocNoFilter);
        ServCrMemoHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Service Cr.Memo Header",0,sText004,ServCrMemoHeader.COUNT);
      END;
      IF IssuedReminderHeader.READPERMISSION THEN BEGIN
        IssuedReminderHeader.RESET;
        IssuedReminderHeader.SETFILTER("No.",DocNoFilter);
        IssuedReminderHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Issued Reminder Header",0,Text006,IssuedReminderHeader.COUNT);
      END;
      IF IssuedFinChrgMemoHeader.READPERMISSION THEN BEGIN
        IssuedFinChrgMemoHeader.RESET;
        IssuedFinChrgMemoHeader.SETFILTER("No.",DocNoFilter);
        IssuedFinChrgMemoHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Issued Fin. Charge Memo Header",0,Text007,
          IssuedFinChrgMemoHeader.COUNT);
      END;
      IF PurchRcptHeader.READPERMISSION THEN BEGIN
        PurchRcptHeader.RESET;
        PurchRcptHeader.SETFILTER("No.",DocNoFilter);
        PurchRcptHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Purch. Rcpt. Header",0,Text010,PurchRcptHeader.COUNT);
      END;
      IF PurchInvHeader.READPERMISSION THEN BEGIN
        PurchInvHeader.RESET;
        PurchInvHeader.SETFILTER("No.",DocNoFilter);
        PurchInvHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Purch. Inv. Header",0,Text008,PurchInvHeader.COUNT);
      END;
      IF ReturnShptHeader.READPERMISSION THEN BEGIN
        ReturnShptHeader.RESET;
        ReturnShptHeader.SETFILTER("No.",DocNoFilter);
        ReturnShptHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Return Shipment Header",0,Text018,ReturnShptHeader.COUNT);
      END;
      IF PurchCrMemoHeader.READPERMISSION THEN BEGIN
        PurchCrMemoHeader.RESET;
        PurchCrMemoHeader.SETFILTER("No.",DocNoFilter);
        PurchCrMemoHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Purch. Cr. Memo Hdr.",0,Text009,PurchCrMemoHeader.COUNT);
      END;
        //KKE : #002 +
        IF PettyCashInvHdr.READPERMISSION THEN BEGIN
          PettyCashInvHdr.RESET;
          PettyCashInvHdr.SETFILTER("No.",DocNoFilter);
          PettyCashInvHdr.SETFILTER("Posting Date",PostingDateFilter);
          InsertIntoDocEntry(
            DATABASE::"Petty Cash Invoice Header",0,Text55000,PettyCashInvHdr.COUNT);
        END;
        //KKE : #002 -
        //KKE : #003 +
        IF CashAdvInvHdr.READPERMISSION THEN BEGIN
          CashAdvInvHdr.RESET;
          CashAdvInvHdr.SETFILTER("No.",DocNoFilter);
          CashAdvInvHdr.SETFILTER("Posting Date",PostingDateFilter);
          InsertIntoDocEntry(
            DATABASE::"Cash Advance Invoice Header",0,Text55050,CashAdvInvHdr.COUNT);
        END;
        //KKE : #003 -
      IF ProductionOrderHeader.READPERMISSION THEN BEGIN
        ProductionOrderHeader.RESET;
        ProductionOrderHeader.SETRANGE(
          Status,
          ProductionOrderHeader.Status::Released,
          ProductionOrderHeader.Status::Finished);
        ProductionOrderHeader.SETFILTER("No.",DocNoFilter);
        InsertIntoDocEntry(
          DATABASE::"Production Order",0,Text99000000,ProductionOrderHeader.COUNT);
      END;
      IF TransShptHeader.READPERMISSION THEN BEGIN
        TransShptHeader.RESET;
        TransShptHeader.SETFILTER("No.",DocNoFilter);
        TransShptHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Transfer Shipment Header",0,Text019,TransShptHeader.COUNT);
      END;
      IF TransRcptHeader.READPERMISSION THEN BEGIN
        TransRcptHeader.RESET;
        TransRcptHeader.SETFILTER("No.",DocNoFilter);
        TransRcptHeader.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Transfer Receipt Header",0,Text020,TransRcptHeader.COUNT);
      END;
      IF PostedWhseShptLine.READPERMISSION THEN BEGIN
        PostedWhseShptLine.RESET;
        PostedWhseShptLine.SETCURRENTKEY("Posted Source No.","Posting Date");
        PostedWhseShptLine.SETFILTER("Posted Source No.",DocNoFilter);
        PostedWhseShptLine.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Posted Whse. Shipment Line",0,
          PostedWhseShptLine.TABLECAPTION,PostedWhseShptLine.COUNT);
      END;
      IF PostedWhseRcptLine.READPERMISSION THEN BEGIN
        PostedWhseRcptLine.RESET;
        PostedWhseRcptLine.SETCURRENTKEY("Posted Source No.","Posting Date");
        PostedWhseRcptLine.SETFILTER("Posted Source No.",DocNoFilter);
        PostedWhseRcptLine.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Posted Whse. Receipt Line",0,
          PostedWhseRcptLine.TABLECAPTION,PostedWhseRcptLine.COUNT);
      END;
      IF GLEntry.READPERMISSION THEN BEGIN
        GLEntry.RESET;
        GLEntry.SETCURRENTKEY("Document No.","Posting Date");
        GLEntry.SETFILTER("Document No.",DocNoFilter);
        GLEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"G/L Entry",0,GLEntry.TABLECAPTION,GLEntry.COUNT);
      END;
      IF VATEntry.READPERMISSION THEN BEGIN
        VATEntry.RESET;
        VATEntry.SETCURRENTKEY("Document No.","Posting Date");
        VATEntry.SETFILTER("Document No.",DocNoFilter);
        VATEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"VAT Entry",0,VATEntry.TABLECAPTION,VATEntry.COUNT);
      END;

      //23675.BEGIN
      IF GSTPurchEntry.READPERMISSION THEN BEGIN
        GSTPurchEntry.RESET;
        GSTPurchEntry.SETCURRENTKEY("Document No.","Posting Date");
        GSTPurchEntry.SETFILTER("Document No.",DocNoFilter);
        GSTPurchEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"GST Purchase Entry",0,GSTPurchEntry.TABLECAPTION,GSTPurchEntry.COUNT);
      END;
      IF GSTSalesEntry.READPERMISSION THEN BEGIN
        GSTSalesEntry.RESET;
        GSTSalesEntry.SETCURRENTKEY("Document No.","Posting Date");
        GSTSalesEntry.SETFILTER("Document No.",DocNoFilter);
        GSTSalesEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"GST Sales Entry",0,GSTSalesEntry.TABLECAPTION,GSTSalesEntry.COUNT);
      END;
      //23675.END

      IF WHTEntry.READPERMISSION THEN BEGIN
        WHTEntry.RESET;
        WHTEntry.SETCURRENTKEY("Document No.","Posting Date");
        WHTEntry.SETFILTER("Document No.",DocNoFilter);
        WHTEntry.SETFILTER("Posting Date",PostingDateFilter);
          //KKE : #001 +
          IF WHTEntry.COUNT = 0 THEN BEGIN
            WHTEntry.SETRANGE("Document No.");
            WHTEntry.SETFILTER("Original Document No.",DocNoFilter);
          END;
          //KKE : #001 -
        InsertIntoDocEntry(
          DATABASE::"WHT Entry",0,WHTEntry.TABLECAPTION,WHTEntry.COUNT);
      END;

      IF CustLedgEntry.READPERMISSION THEN BEGIN
        CustLedgEntry.RESET;
        CustLedgEntry.SETCURRENTKEY("Document No.");
        CustLedgEntry.SETFILTER("Document No.",DocNoFilter);
        CustLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Cust. Ledger Entry",0,CustLedgEntry.TABLECAPTION,CustLedgEntry.COUNT);
      END;
      IF DtldCustLedgEntry.READPERMISSION THEN BEGIN
        DtldCustLedgEntry.RESET;
        DtldCustLedgEntry.SETCURRENTKEY("Document No.");
        DtldCustLedgEntry.SETFILTER("Document No.",DocNoFilter);
        DtldCustLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Detailed Cust. Ledg. Entry",0,DtldCustLedgEntry.TABLECAPTION,DtldCustLedgEntry.COUNT);
      END;
      IF ReminderEntry.READPERMISSION THEN BEGIN
        ReminderEntry.RESET;
        ReminderEntry.SETCURRENTKEY(Type,"No.");
        ReminderEntry.SETFILTER("No.",DocNoFilter);
        ReminderEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Reminder/Fin. Charge Entry",0,ReminderEntry.TABLECAPTION,ReminderEntry.COUNT);
      END;
      IF VendLedgEntry.READPERMISSION THEN BEGIN
        VendLedgEntry.RESET;
        VendLedgEntry.SETCURRENTKEY("Document No.");
        VendLedgEntry.SETFILTER("Document No.",DocNoFilter);
        VendLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Vendor Ledger Entry",0,VendLedgEntry.TABLECAPTION,VendLedgEntry.COUNT);
      END;
      IF DtldVendLedgEntry.READPERMISSION THEN BEGIN
        DtldVendLedgEntry.RESET;
        DtldVendLedgEntry.SETCURRENTKEY("Document No.");
        DtldVendLedgEntry.SETFILTER("Document No.",DocNoFilter);
        DtldVendLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Detailed Vendor Ledg. Entry",0,DtldVendLedgEntry.TABLECAPTION,DtldVendLedgEntry.COUNT);
      END;
      IF ItemLedgEntry.READPERMISSION THEN BEGIN
        ItemLedgEntry.RESET;
        ItemLedgEntry.SETCURRENTKEY("Document No.");
        ItemLedgEntry.SETFILTER("Document No.",DocNoFilter);
        ItemLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Item Ledger Entry",0,ItemLedgEntry.TABLECAPTION,ItemLedgEntry.COUNT);
      END;
      IF ValueEntry.READPERMISSION THEN BEGIN
        ValueEntry.RESET;
        ValueEntry.SETCURRENTKEY("Document No.");
        ValueEntry.SETFILTER("Document No.",DocNoFilter);
        ValueEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Value Entry",0,ValueEntry.TABLECAPTION,ValueEntry.COUNT);
      END;
      IF PhysInvtLedgEntry.READPERMISSION THEN BEGIN
        PhysInvtLedgEntry.RESET;
        PhysInvtLedgEntry.SETCURRENTKEY("Document No.","Posting Date");
        PhysInvtLedgEntry.SETFILTER("Document No.",DocNoFilter);
        PhysInvtLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Phys. Inventory Ledger Entry",0,PhysInvtLedgEntry.TABLECAPTION,PhysInvtLedgEntry.COUNT);
      END;
      IF ResLedgEntry.READPERMISSION THEN BEGIN
        ResLedgEntry.RESET;
        ResLedgEntry.SETCURRENTKEY("Document No.","Posting Date");
        ResLedgEntry.SETFILTER("Document No.",DocNoFilter);
        ResLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Res. Ledger Entry",0,ResLedgEntry.TABLECAPTION,ResLedgEntry.COUNT);
      END;
      IF JobLedgEntry.READPERMISSION THEN BEGIN
        JobLedgEntry.RESET;
        JobLedgEntry.SETCURRENTKEY("Document No.","Posting Date");
        JobLedgEntry.SETFILTER("Document No.",DocNoFilter);
        JobLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Job Ledger Entry",0,JobLedgEntry.TABLECAPTION,JobLedgEntry.COUNT);
      END;
      IF BankAccLedgEntry.READPERMISSION THEN BEGIN
        BankAccLedgEntry.RESET;
        BankAccLedgEntry.SETCURRENTKEY("Document No.","Posting Date");
        BankAccLedgEntry.SETFILTER("Document No.",DocNoFilter);
        BankAccLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Bank Account Ledger Entry",0,BankAccLedgEntry.TABLECAPTION,BankAccLedgEntry.COUNT);
      END;
      IF CheckLedgEntry.READPERMISSION THEN BEGIN
        CheckLedgEntry.RESET;
        CheckLedgEntry.SETCURRENTKEY("Document No.","Posting Date");
        CheckLedgEntry.SETFILTER("Document No.",DocNoFilter);
        CheckLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Check Ledger Entry",0,CheckLedgEntry.TABLECAPTION,CheckLedgEntry.COUNT);
      END;
      IF FALedgEntry.READPERMISSION THEN BEGIN
        FALedgEntry.RESET;
        FALedgEntry.SETCURRENTKEY("Document No.","Posting Date");
        FALedgEntry.SETFILTER("Document No.",DocNoFilter);
        FALedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"FA Ledger Entry",0,FALedgEntry.TABLECAPTION,FALedgEntry.COUNT);
      END;
      IF MaintenanceLedgEntry.READPERMISSION THEN BEGIN
        MaintenanceLedgEntry.RESET;
        MaintenanceLedgEntry.SETCURRENTKEY("Document No.","Posting Date");
        MaintenanceLedgEntry.SETFILTER("Document No.",DocNoFilter);
        MaintenanceLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Maintenance Ledger Entry",0,MaintenanceLedgEntry.TABLECAPTION,MaintenanceLedgEntry.COUNT);
      END;
      IF InsuranceCovLedgEntry.READPERMISSION THEN BEGIN
        InsuranceCovLedgEntry.RESET;
        InsuranceCovLedgEntry.SETCURRENTKEY("Document No.","Posting Date");
        InsuranceCovLedgEntry.SETFILTER("Document No.",DocNoFilter);
        InsuranceCovLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Ins. Coverage Ledger Entry",0,InsuranceCovLedgEntry.TABLECAPTION,InsuranceCovLedgEntry.COUNT);
      END;
      IF CapacityLedgEntry.READPERMISSION THEN BEGIN
        CapacityLedgEntry.RESET;
        CapacityLedgEntry.SETCURRENTKEY("Document No.","Posting Date");
        CapacityLedgEntry.SETFILTER("Document No.",DocNoFilter);
        CapacityLedgEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Capacity Ledger Entry",0,CapacityLedgEntry.TABLECAPTION,CapacityLedgEntry.COUNT);
      END;
      IF WhseEntry.READPERMISSION THEN BEGIN
        WhseEntry.RESET;
        WhseEntry.SETCURRENTKEY("Reference No.","Registering Date");
        WhseEntry.SETFILTER("Reference No.",DocNoFilter);
        WhseEntry.SETFILTER("Registering Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Warehouse Entry",0,WhseEntry.TABLECAPTION,WhseEntry.COUNT);
      END;

      IF ServLedgerEntry.READPERMISSION THEN BEGIN
        ServLedgerEntry.RESET;
        ServLedgerEntry.SETCURRENTKEY("Document No.","Posting Date");
        ServLedgerEntry.SETFILTER("Document No.",DocNoFilter);
        ServLedgerEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Service Ledger Entry",0,ServLedgerEntry.TABLECAPTION,ServLedgerEntry.COUNT);
      END;
      IF WarrantyLedgerEntry.READPERMISSION THEN BEGIN
        WarrantyLedgerEntry.RESET;
        WarrantyLedgerEntry.SETCURRENTKEY("Document No.","Posting Date");
        WarrantyLedgerEntry.SETFILTER("Document No.",DocNoFilter);
        WarrantyLedgerEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Warranty Ledger Entry",0,WarrantyLedgerEntry.TABLECAPTION,WarrantyLedgerEntry.COUNT);
      END;

      IF CostEntry.READPERMISSION THEN BEGIN
        CostEntry.RESET;
        CostEntry.SETCURRENTKEY("Document No.","Posting Date");
        CostEntry.SETFILTER("Document No.",DocNoFilter);
        CostEntry.SETFILTER("Posting Date",PostingDateFilter);
        InsertIntoDocEntry(
          DATABASE::"Cost Entry",0,CostEntry.TABLECAPTION,CostEntry.COUNT);
      END;

      DocExists := FINDFIRST;

      SetSource(0D,'','',0,'');
      IF DocExists THEN BEGIN
        IF (NoOfRecords(DATABASE::"Cust. Ledger Entry") + NoOfRecords(DATABASE::"Vendor Ledger Entry") <= 1) AND
           (NoOfRecords(DATABASE::"Sales Invoice Header") + NoOfRecords(DATABASE::"Sales Cr.Memo Header") +
            NoOfRecords(DATABASE::"Sales Shipment Header") + NoOfRecords(DATABASE::"Issued Reminder Header") +
            NoOfRecords(DATABASE::"Issued Fin. Charge Memo Header") + NoOfRecords(DATABASE::"Purch. Inv. Header") +
            NoOfRecords(DATABASE::"Return Shipment Header") + NoOfRecords(DATABASE::"Return Receipt Header") +
            NoOfRecords(DATABASE::"Purch. Cr. Memo Hdr.") + NoOfRecords(DATABASE::"Purch. Rcpt. Header") +
            NoOfRecords(DATABASE::"Service Invoice Header") + NoOfRecords(DATABASE::"Service Cr.Memo Header") +
            NoOfRecords(DATABASE::"Service Shipment Header") +
            NoOfRecords(DATABASE::"Transfer Shipment Header") + NoOfRecords(DATABASE::"Transfer Receipt Header") <= 1)
        THEN BEGIN
          // Service Management
          IF NoOfRecords(DATABASE::"Service Ledger Entry") = 1 THEN BEGIN
            ServLedgerEntry.FINDFIRST;
            IF ServLedgerEntry.Type = ServLedgerEntry.Type::"Service Contract" THEN
              SetSource(
                ServLedgerEntry."Posting Date",FORMAT(ServLedgerEntry."Document Type"),ServLedgerEntry."Document No.",
                2,ServLedgerEntry."Service Contract No.")
            ELSE
              SetSource(
                ServLedgerEntry."Posting Date",FORMAT(ServLedgerEntry."Document Type"),ServLedgerEntry."Document No.",
                2,ServLedgerEntry."Service Order No.")
          END;
          IF NoOfRecords(DATABASE::"Warranty Ledger Entry") = 1 THEN BEGIN
            WarrantyLedgerEntry.FINDFIRST;
            SetSource(
              WarrantyLedgerEntry."Posting Date",'',WarrantyLedgerEntry."Document No.",
              2,WarrantyLedgerEntry."Service Order No.")
          END;

          // Sales
          IF NoOfRecords(DATABASE::"Cust. Ledger Entry") = 1 THEN BEGIN
            CustLedgEntry.FINDFIRST;
            SetSource(
              CustLedgEntry."Posting Date",FORMAT(CustLedgEntry."Document Type"),CustLedgEntry."Document No.",
              1,CustLedgEntry."Customer No.");
          END;
          IF NoOfRecords(DATABASE::"Detailed Cust. Ledg. Entry") = 1 THEN BEGIN
            DtldCustLedgEntry.FINDFIRST;
            SetSource(
              DtldCustLedgEntry."Posting Date",FORMAT(DtldCustLedgEntry."Document Type"),DtldCustLedgEntry."Document No.",
              1,DtldCustLedgEntry."Customer No.");
          END;
          IF NoOfRecords(DATABASE::"Sales Invoice Header") = 1 THEN BEGIN
            SalesInvHeader.FINDFIRST;
            SetSource(
              SalesInvHeader."Posting Date",FORMAT("Table Name"),SalesInvHeader."No.",
              1,SalesInvHeader."Bill-to Customer No.");
          END;
          IF NoOfRecords(DATABASE::"Sales Cr.Memo Header") = 1 THEN BEGIN
            SalesCrMemoHeader.FINDFIRST;
            SetSource(
              SalesCrMemoHeader."Posting Date",FORMAT("Table Name"),SalesCrMemoHeader."No.",
              1,SalesCrMemoHeader."Bill-to Customer No.");
          END;
          IF NoOfRecords(DATABASE::"Return Receipt Header") = 1 THEN BEGIN
            ReturnRcptHeader.FINDFIRST;
            SetSource(
              ReturnRcptHeader."Posting Date",FORMAT("Table Name"),ReturnRcptHeader."No.",
              1,ReturnRcptHeader."Sell-to Customer No.");
          END;
          IF NoOfRecords(DATABASE::"Sales Shipment Header") = 1 THEN BEGIN
            SalesShptHeader.FINDFIRST;
            SetSource(
              SalesShptHeader."Posting Date",FORMAT("Table Name"),SalesShptHeader."No.",
              1,SalesShptHeader."Sell-to Customer No.");
          END;
          IF NoOfRecords(DATABASE::"Posted Whse. Shipment Line") = 1 THEN BEGIN
            PostedWhseShptLine.FINDFIRST;
            SetSource(
              PostedWhseShptLine."Posting Date",FORMAT("Table Name"),PostedWhseShptLine."No.",
              1,PostedWhseShptLine."Destination No.");
          END;
          IF NoOfRecords(DATABASE::"Issued Reminder Header") = 1 THEN BEGIN
            IssuedReminderHeader.FINDFIRST;
            SetSource(
              IssuedReminderHeader."Posting Date",FORMAT("Table Name"),IssuedReminderHeader."No.",
              1,IssuedReminderHeader."Customer No.");
          END;
          IF NoOfRecords(DATABASE::"Issued Fin. Charge Memo Header") = 1 THEN BEGIN
            IssuedFinChrgMemoHeader.FINDFIRST;
            SetSource(
              IssuedFinChrgMemoHeader."Posting Date",FORMAT("Table Name"),IssuedFinChrgMemoHeader."No.",
              1,IssuedFinChrgMemoHeader."Customer No.");
          END;

          IF NoOfRecords(DATABASE::"Service Invoice Header") = 1 THEN BEGIN
            ServInvHeader.FIND('-');
            SetSource(
              ServInvHeader."Posting Date",FORMAT("Table Name"),ServInvHeader."No.",
              1,ServInvHeader."Bill-to Customer No.");
          END;
          IF NoOfRecords(DATABASE::"Service Cr.Memo Header") = 1 THEN BEGIN
            ServCrMemoHeader.FIND('-');
            SetSource(
              ServCrMemoHeader."Posting Date",FORMAT("Table Name"),ServCrMemoHeader."No.",
              1,ServCrMemoHeader."Bill-to Customer No.");
          END;
          IF NoOfRecords(DATABASE::"Service Shipment Header") = 1 THEN BEGIN
            ServShptHeader.FIND('-');
            SetSource(
              ServShptHeader."Posting Date",FORMAT("Table Name"),ServShptHeader."No.",
              1,ServShptHeader."Customer No.");
          END;

          // Purchase
          IF NoOfRecords(DATABASE::"Vendor Ledger Entry") = 1 THEN BEGIN
            VendLedgEntry.FINDFIRST;
            SetSource(
              VendLedgEntry."Posting Date",FORMAT(VendLedgEntry."Document Type"),VendLedgEntry."Document No.",
              2,VendLedgEntry."Vendor No.");
          END;
          IF NoOfRecords(DATABASE::"Detailed Vendor Ledg. Entry") = 1 THEN BEGIN
            DtldVendLedgEntry.FINDFIRST;
            SetSource(
              DtldVendLedgEntry."Posting Date",FORMAT(DtldVendLedgEntry."Document Type"),DtldVendLedgEntry."Document No.",
              2,DtldVendLedgEntry."Vendor No.");
          END;
          IF NoOfRecords(DATABASE::"Purch. Inv. Header") = 1 THEN BEGIN
            PurchInvHeader.FINDFIRST;
            SetSource(
              PurchInvHeader."Posting Date",FORMAT("Table Name"),PurchInvHeader."No.",
              2,PurchInvHeader."Pay-to Vendor No.");
          END;
          IF NoOfRecords(DATABASE::"Purch. Cr. Memo Hdr.") = 1 THEN BEGIN
            PurchCrMemoHeader.FINDFIRST;
            SetSource(
              PurchCrMemoHeader."Posting Date",FORMAT("Table Name"),PurchCrMemoHeader."No.",
              2,PurchCrMemoHeader."Pay-to Vendor No.");
          END;
          IF NoOfRecords(DATABASE::"Return Shipment Header") = 1 THEN BEGIN
            ReturnShptHeader.FINDFIRST;
            SetSource(
              ReturnShptHeader."Posting Date",FORMAT("Table Name"),ReturnShptHeader."No.",
              2,ReturnShptHeader."Buy-from Vendor No.");
          END;
          IF NoOfRecords(DATABASE::"Purch. Rcpt. Header") = 1 THEN BEGIN
            PurchRcptHeader.FINDFIRST;
            SetSource(
              PurchRcptHeader."Posting Date",FORMAT("Table Name"),PurchRcptHeader."No.",
              2,PurchRcptHeader."Buy-from Vendor No.");
          END;
          IF NoOfRecords(DATABASE::"Posted Whse. Receipt Line") = 1 THEN BEGIN
            PostedWhseRcptLine.FINDFIRST;
            SetSource(
              PostedWhseRcptLine."Posting Date",FORMAT("Table Name"),PostedWhseRcptLine."No.",
              2,'');
          END;
        END ELSE BEGIN
          IF DocNoFilter <> '' THEN
            IF PostingDateFilter = '' THEN
              MESSAGE(Text011)
            ELSE
              MESSAGE(Text012);
        END;
      END ELSE
        IF PostingDateFilter = '' THEN
          MESSAGE(Text013)
        ELSE
          MESSAGE(Text014);

      UpdateFormAfterFindRecords;
      Window.CLOSE;
    END;

    LOCAL PROCEDURE UpdateFormAfterFindRecords@15();
    BEGIN
      ShowEnable := DocExists;
      PrintEnable := DocExists;
      CurrPage.UPDATE(FALSE);
      DocExists := FINDFIRST;
      IF DocExists THEN;
    END;

    LOCAL PROCEDURE InsertIntoDocEntry@3(DocTableID@1000000000 : Integer;DocType@1000000001 : Option;DocTableName@1000000002 : Text[1024];DocNoOfRecords@1000000003 : Integer);
    BEGIN
      IF DocNoOfRecords = 0 THEN
        EXIT;
      INIT;
      "Entry No." := "Entry No." + 1;
      "Table ID" := DocTableID;
      "Document Type" := DocType;
      "Table Name" := COPYSTR(DocTableName,1,MAXSTRLEN("Table Name"));
      "No. of Records" := DocNoOfRecords;
      INSERT;
    END;

    LOCAL PROCEDURE NoOfRecords@4(TableID@1000000000 : Integer) : Integer;
    BEGIN
      SETRANGE("Table ID",TableID);
      IF NOT FINDFIRST THEN
        INIT;
      SETRANGE("Table ID");
      EXIT("No. of Records");
    END;

    LOCAL PROCEDURE SetSource@5(PostingDate@1000000000 : Date;DocType2@1000000001 : Text[50];DocNo@1000000002 : Text[50];SourceType2@1000000003 : Integer;SourceNo2@1000000004 : Code[20]);
    BEGIN
      IF SourceType2 = 0 THEN BEGIN
        DocType := '';
        SourceType := '';
        SourceNo := '';
        SourceName := '';
      END ELSE BEGIN
        DocType := DocType2;
        SourceNo := SourceNo2;
        SETRANGE("Document No.",DocNo);
        SETRANGE("Posting Date",PostingDate);
        DocNoFilter := GETFILTER("Document No.");
        PostingDateFilter := GETFILTER("Posting Date");
        CASE SourceType2 OF
          1:
            BEGIN
              SourceType := Cust.TABLECAPTION;
              IF NOT Cust.GET(SourceNo) THEN
                Cust.INIT;
              SourceName := Cust.Name;
            END;
          2:
            BEGIN
              SourceType := Vend.TABLECAPTION;
              IF NOT Vend.GET(SourceNo) THEN
                Vend.INIT;
              SourceName := Vend.Name;
            END;
        END;
      END;
      DocTypeEnable := SourceType2 <> 0;
      SourceTypeEnable := SourceType2 <> 0;
      SourceNoEnable := SourceType2 <> 0;
      SourceNameEnable := SourceType2 <> 0;
    END;

    LOCAL PROCEDURE ShowRecords@6();
    BEGIN
      IF ItemTrackingSearch THEN
        ItemTrackingNavigateMgt.Show("Table ID")
      ELSE BEGIN
        CASE "Table ID" OF
          DATABASE::"Sales Header":
            CASE "Document Type" OF
              "Document Type"::Order:
                IF "No. of Records" = 1 THEN
                  FORM.RUN(FORM::"Sales Order",SOSalesHeader)
                ELSE
                  FORM.RUN(0,SOSalesHeader);
              "Document Type"::Invoice:
                IF "No. of Records" = 1 THEN
                  FORM.RUN(FORM::"Sales Invoice",SISalesHeader)
                ELSE
                  FORM.RUN(0,SISalesHeader);
              "Document Type"::"Return Order":
                IF "No. of Records" = 1 THEN
                  FORM.RUN(FORM::"Sales Return Order",SROSalesHeader)
                ELSE
                  FORM.RUN(0,SROSalesHeader);
              "Document Type"::"Credit Memo":
                IF "No. of Records" = 1 THEN
                  FORM.RUN(FORM::"Sales Credit Memo",SCMSalesHeader)
                ELSE
                  FORM.RUN(0,SCMSalesHeader);
            END;
          DATABASE::"Sales Invoice Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Sales Invoice",SalesInvHeader)
            ELSE
              FORM.RUN(0,SalesInvHeader);
          DATABASE::"Sales Cr.Memo Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Sales Credit Memo",SalesCrMemoHeader)
            ELSE
              FORM.RUN(0,SalesCrMemoHeader);
          DATABASE::"Return Receipt Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Return Receipt",ReturnRcptHeader)
            ELSE
              FORM.RUN(0,ReturnRcptHeader);
          DATABASE::"Sales Shipment Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Sales Shipment",SalesShptHeader)
            ELSE
              FORM.RUN(0,SalesShptHeader);
          DATABASE::"Issued Reminder Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Issued Reminder",IssuedReminderHeader)
            ELSE
              FORM.RUN(0,IssuedReminderHeader);
          DATABASE::"Issued Fin. Charge Memo Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Issued Finance Charge Memo",IssuedFinChrgMemoHeader)
            ELSE
              FORM.RUN(0,IssuedFinChrgMemoHeader);
          DATABASE::"Purch. Inv. Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Purchase Invoice",PurchInvHeader)
            ELSE
              FORM.RUN(0,PurchInvHeader);
          DATABASE::"Purch. Cr. Memo Hdr.":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Purchase Credit Memo",PurchCrMemoHeader)
            ELSE
              FORM.RUN(0,PurchCrMemoHeader);
          DATABASE::"Return Shipment Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Return Shipment",ReturnShptHeader)
            ELSE
              FORM.RUN(0,ReturnShptHeader);
          DATABASE::"Purch. Rcpt. Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Purchase Receipt",PurchRcptHeader)
            ELSE
              FORM.RUN(0,PurchRcptHeader);
          DATABASE::"Production Order":
            FORM.RUN(0,ProductionOrderHeader);
          DATABASE::"Transfer Shipment Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Transfer Shipment",TransShptHeader)
            ELSE
              FORM.RUN(0,TransShptHeader);
          DATABASE::"Transfer Receipt Header":
            IF "No. of Records" = 1 THEN
              FORM.RUN(FORM::"Posted Transfer Receipt",TransRcptHeader)
            ELSE
              FORM.RUN(0,TransRcptHeader);
          DATABASE::"Posted Whse. Shipment Line":
            FORM.RUN(0,PostedWhseShptLine);
          DATABASE::"Posted Whse. Receipt Line":
            FORM.RUN(0,PostedWhseRcptLine);
          DATABASE::"G/L Entry":
            FORM.RUN(0,GLEntry);
          DATABASE::"VAT Entry":
            FORM.RUN(0,VATEntry);
          DATABASE::"GST Purchase Entry":
            FORM.RUN(0,GSTPurchEntry);
          DATABASE::"GST Sales Entry":
            FORM.RUN(0,GSTSalesEntry);
          DATABASE::"WHT Entry":
            FORM.RUN(0,WHTEntry);
          DATABASE::"Detailed Cust. Ledg. Entry":
            FORM.RUN(0,DtldCustLedgEntry);
          DATABASE::"Cust. Ledger Entry":
            FORM.RUN(0,CustLedgEntry);
          DATABASE::"Reminder/Fin. Charge Entry":
            FORM.RUN(0,ReminderEntry);
          DATABASE::"Vendor Ledger Entry":
            FORM.RUN(0,VendLedgEntry);
          DATABASE::"Detailed Vendor Ledg. Entry":
            FORM.RUN(0,DtldVendLedgEntry);
          DATABASE::"Item Ledger Entry":
            FORM.RUN(0,ItemLedgEntry);
          DATABASE::"Value Entry":
            FORM.RUN(0,ValueEntry);
          DATABASE::"Phys. Inventory Ledger Entry":
            FORM.RUN(0,PhysInvtLedgEntry);
          DATABASE::"Res. Ledger Entry":
            FORM.RUN(0,ResLedgEntry);
          DATABASE::"Job Ledger Entry":
            FORM.RUN(0,JobLedgEntry);
          DATABASE::"Bank Account Ledger Entry":
            FORM.RUN(0,BankAccLedgEntry);
          DATABASE::"Check Ledger Entry":
            FORM.RUN(0,CheckLedgEntry);
          DATABASE::"FA Ledger Entry":
            FORM.RUN(0,FALedgEntry);
          DATABASE::"Maintenance Ledger Entry":
            FORM.RUN(0,MaintenanceLedgEntry);
          DATABASE::"Ins. Coverage Ledger Entry":
            FORM.RUN(0,InsuranceCovLedgEntry);
          DATABASE::"Capacity Ledger Entry":
            FORM.RUN(0,CapacityLedgEntry);
          DATABASE::"Warehouse Entry":
            FORM.RUN(0,WhseEntry);
          DATABASE::"Service Header":
            CASE "Document Type" OF
              "Document Type"::Order:
                FORM.RUN(0,SOServHeader);
              "Document Type"::Invoice:
                FORM.RUN(0,SIServHeader);
              "Document Type"::"Credit Memo":
                FORM.RUN(0,SCMServHeader);
            END;
          DATABASE::"Service Invoice Header":
            FORM.RUN(0,ServInvHeader);
          DATABASE::"Service Cr.Memo Header":
            FORM.RUN(0,ServCrMemoHeader);
          DATABASE::"Service Shipment Header":
            FORM.RUN(0,ServShptHeader);
          DATABASE::"Service Ledger Entry":
            FORM.RUN(0,ServLedgerEntry);
          DATABASE::"Warranty Ledger Entry":
            FORM.RUN(0,WarrantyLedgerEntry);
          DATABASE::"Cost Entry":
            FORM.RUN(0,CostEntry);
          //KKE : #002 +
          DATABASE::"Petty Cash Invoice Header":
            FORM.RUN(0,PettyCashInvHdr);
          //KKE : #002 -
          //KKE : #003 +
          DATABASE::"Cash Advance Invoice Header":
            FORM.RUN(0,CashAdvInvHdr);
          //KKE : #003 -
        END;
      END;
    END;

    LOCAL PROCEDURE SetPostingDate@9(PostingDate@1000000000 : Text[250]);
    BEGIN
      IF ApplicationManagement.MakeDateFilter(PostingDate) = 0 THEN;
      SETFILTER("Posting Date",PostingDate);
      PostingDateFilter := GETFILTER("Posting Date");
    END;

    LOCAL PROCEDURE SetDocNo@10(DocNo@1000000000 : Text[250]);
    BEGIN
      SETFILTER("Document No.",DocNo);
      DocNoFilter := GETFILTER("Document No.");
      PostingDateFilter := GETFILTER("Posting Date");
    END;

    LOCAL PROCEDURE ClearSourceInfo@7();
    BEGIN
      IF DocExists THEN BEGIN
        DocExists := FALSE;
        DELETEALL;
        ShowEnable := FALSE;
        SetSource(0D,'','',0,'');
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE MakeExtFilter@11(VAR DateFilter@1000000000 : Code[250];AddDate@1000000001 : Date;VAR DocNoFilter@1000000002 : Code[250];AddDocNo@1000000003 : Code[20]);
    BEGIN
      IF DateFilter = '' THEN
        DateFilter := FORMAT(AddDate)
      ELSE
        IF STRPOS(DateFilter,FORMAT(AddDate)) = 0 THEN
          IF MAXSTRLEN(DateFilter) >= STRLEN(DateFilter + '|' + FORMAT(AddDate)) THEN
            DateFilter := DateFilter + '|' + FORMAT(AddDate)
          ELSE
            TooLongFilter;

      IF DocNoFilter = '' THEN
        DocNoFilter := AddDocNo
      ELSE
        IF STRPOS(DocNoFilter,AddDocNo) = 0 THEN
          IF MAXSTRLEN(DocNoFilter) >= STRLEN(DocNoFilter + '|' + AddDocNo) THEN
            DocNoFilter := DocNoFilter + '|' + AddDocNo
          ELSE
            TooLongFilter;
    END;

    LOCAL PROCEDURE FindPush@13();
    BEGIN
      IF (DocNoFilter = '') AND (PostingDateFilter = '') AND
         (NOT ItemTrackingSearch) AND
         ((ContactType <> 0) OR (ContactNo <> '') OR (ExtDocNo <> ''))
      THEN
        FindExtRecords
      ELSE
        IF ItemTrackingSearch AND
          (DocNoFilter = '') AND (PostingDateFilter = '') AND
          (ContactType = 0) AND (ContactNo = '') AND (ExtDocNo = '') THEN
          FindTrackingRecords
        ELSE
          FindRecords;
    END;

    LOCAL PROCEDURE TooLongFilter@12();
    BEGIN
      IF ContactNo = '' THEN
        ERROR(Text015)
      ELSE
        ERROR(Text016);
    END;

    LOCAL PROCEDURE FindUnpostedSalesDocs@14(DocType@1000000000 : Option;DocTableName@1000000001 : Text[100];VAR SalesHeader@1000000002 : Record 36);
    BEGIN
      IF SalesHeader.READPERMISSION THEN BEGIN
        SalesHeader.RESET;
        SalesHeader.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
        SalesHeader.SETFILTER("Sell-to Customer No.",ContactNo);
        SalesHeader.SETFILTER("External Document No.",ExtDocNo);
        SalesHeader.SETRANGE("Document Type",DocType);
        InsertIntoDocEntry(DATABASE::"Sales Header",DocType,DocTableName,SalesHeader.COUNT);
      END;
    END;

    LOCAL PROCEDURE FindUnpostedServDocs@16(DocType@1000000000 : Option;DocTableName@1000000001 : Text[100];VAR ServHeader@1000000002 : Record 5900);
    BEGIN
      IF ServHeader.READPERMISSION THEN BEGIN
        IF ExtDocNo = '' THEN BEGIN
          ServHeader.RESET;
          ServHeader.SETCURRENTKEY("Customer No.");
          ServHeader.SETFILTER("Customer No.",ContactNo);
          ServHeader.SETRANGE("Document Type",DocType);
          InsertIntoDocEntry(DATABASE::"Service Header",DocType,DocTableName,ServHeader.COUNT);
        END;
      END;
    END;

    PROCEDURE FindTrackingRecords@22();
    VAR
      DocNoOfRecords@1000000000 : Integer;
    BEGIN
      Window.OPEN(Text002);
      DELETEALL;
      "Entry No." := 0;

      CLEAR(ItemTrackingNavigateMgt);
      ItemTrackingNavigateMgt.FindTrackingRecords(SerialNoFilter,LotNoFilter,'','');

      ItemTrackingNavigateMgt.Collect(TempRecordBuffer);
      TempRecordBuffer.SETCURRENTKEY("Table No.","Search Record ID");
      IF TempRecordBuffer.FIND('-') THEN
        REPEAT
          TempRecordBuffer.SETRANGE("Table No.",TempRecordBuffer."Table No.");

          DocNoOfRecords := 0;
          IF TempRecordBuffer.FIND('-') THEN
            REPEAT
              TempRecordBuffer.SETRANGE("Search Record ID",TempRecordBuffer."Search Record ID");
              TempRecordBuffer.FIND('+');
              TempRecordBuffer.SETRANGE("Search Record ID");
              DocNoOfRecords += 1;
            UNTIL TempRecordBuffer.NEXT = 0;

          InsertIntoDocEntry(
            TempRecordBuffer."Table No.",0,TempRecordBuffer."Table Name",DocNoOfRecords);

          TempRecordBuffer.SETRANGE("Table No.");
        UNTIL TempRecordBuffer.NEXT = 0;

      DocExists := FIND('-');

      UpdateFormAfterFindRecords;
      Window.CLOSE;
    END;

    PROCEDURE SetTracking@20(SerialNo@1000000000 : Code[20];LotNo@1000000001 : Code[20]);
    BEGIN
      NewSerialNo := SerialNo;
      NewLotNo := LotNo;
    END;

    PROCEDURE ItemTrackingSearch@19() : Boolean;
    BEGIN
      EXIT((SerialNoFilter <> '') OR (LotNoFilter <> ''));
    END;

    PROCEDURE ClearTrackingInfo@17();
    BEGIN
      SerialNoFilter := '';
      LotNoFilter := '';
    END;

    PROCEDURE ClearInfo@18();
    BEGIN
      SetDocNo('');
      SetPostingDate('');
      ContactType := ContactType::" ";
      ContactNo := '';
      ExtDocNo := '';
    END;

    LOCAL PROCEDURE DocNoFilterOnAfterValidate@19079756();
    BEGIN
      ClearSourceInfo;
    END;

    LOCAL PROCEDURE PostingDateFilterOnAfterValida@19064000();
    BEGIN
      ClearSourceInfo;
    END;

    LOCAL PROCEDURE ExtDocNoOnAfterValidate@19035593();
    BEGIN
      ClearSourceInfo;
    END;

    LOCAL PROCEDURE ContactTypeOnAfterValidate@19057702();
    BEGIN
      ClearSourceInfo;
    END;

    LOCAL PROCEDURE ContactNoOnAfterValidate@19009577();
    BEGIN
      ClearSourceInfo;
    END;

    LOCAL PROCEDURE SerialNoFilterOnAfterValidate@19049364();
    BEGIN
      ClearSourceInfo;
    END;

    LOCAL PROCEDURE LotNoFilterOnAfterValidate@19054399();
    BEGIN
      ClearSourceInfo;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   22.09.2005   KKE   Modify program to find data on WHT Entry.
      002   18.08.2006   KKE   Petty Cash.
      003   30.08.2006   KKE   Cash Advance.
    }
    END.
  }
}

OBJECT Page 347 Report Selection - Purchase
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=[ 3:48:20 PM];
    Version List=NAVW15.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Report Selection - Purchase;
               THA=การเลือกรายงาน - การซื้อ];
    SaveValues=Yes;
    SourceTable=Table77;
    PageType=Worksheet;
    OnOpenPage=BEGIN
                 SetUsageFilter;
               END;

    OnNewRecord=BEGIN
                  NewRecord;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 11  ;1   ;Field     ;
                CaptionML=[ENU=Usage;
                           THA=การใช้งาน];
                OptionCaptionML=[ENU=Quote,Blanket Order,Order,Invoice,Return Order,Credit Memo,Receipt,Return Shipment,Purchase Document - Test,Prepayment Document - Test,WHT Certificate,Tax Invoice,Tax Credit Memo;
                                 THA=ใบเสนอราคา,ใบสั่งแบบรวม,ใบสั่ง,ใบแจ้งหนี้,ใบสั่งส่งคืนสินค้า,ใบลดหนี้,ใบรับ,ใบจัดส่งคืนสินค้า,เอกสารการซื้อ - ทดสอบ,เอกสารการชำระเงินล่วงหน้า - ทดสอบ,หนังสือรับรอง WHT,ใบกำกับภาษี - WHT,บันทึกสินเชื่อภาษี - WHT];
                SourceExpr=ReportUsage2;
                OnValidate=BEGIN
                             SetUsageFilter;
                               ReportUsage2OnAfterValidate;
                           END;
                            }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Sequence }

    { 9   ;2   ;Field     ;
                SourceExpr="Report ID";
                LookupFormID=Objects }

    { 4   ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="Report Name" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ReportUsage2@1000000000 : 'Quote,Blanket Order,Order,Invoice,Return Order,Credit Memo,Receipt,Return Shipment,Purchase Document - Test,Prepayment Document - Test,WHT Certificate,Service Tax Invoice,Service Tax Credit Memo';

    LOCAL PROCEDURE SetUsageFilter@1();
    BEGIN
      FILTERGROUP(2);
      CASE ReportUsage2 OF
        ReportUsage2::Quote:
          SETRANGE(Usage,Usage::"P.Quote");
        ReportUsage2::"Blanket Order":
          SETRANGE(Usage,Usage::"P.Blanket");
        ReportUsage2::Order:
          SETRANGE(Usage,Usage::"P.Order");
        ReportUsage2::Invoice:
          SETRANGE(Usage,Usage::"P.Invoice");
        ReportUsage2::"Return Order":
          SETRANGE(Usage,Usage::"P.Return");
        ReportUsage2::"Credit Memo":
          SETRANGE(Usage,Usage::"P.Cr.Memo");
        ReportUsage2::Receipt:
          SETRANGE(Usage,Usage::"P.Receipt");
        ReportUsage2::"Return Shipment":
          SETRANGE(Usage,Usage::"P.Ret.Shpt.");
        ReportUsage2::"Purchase Document - Test":
          SETRANGE(Usage,Usage::"P.Test");
        ReportUsage2::"Prepayment Document - Test":
          SETRANGE(Usage,Usage::"P.Test Prepmt.");
        //KKE : 001+
        ReportUsage2::"WHT Certificate":
          SETRANGE(Usage,Usage::"WHT Certificate");
        ReportUsage2::"Service Tax Invoice":
          SETRANGE(Usage,Usage::"P.TaxInvoice");
        ReportUsage2::"Service Tax Credit Memo":
          SETRANGE(Usage,Usage::"P.TaxCreditMemo");
        //KKE : 001-
      END;
      FILTERGROUP(0);
    END;

    LOCAL PROCEDURE ReportUsage2OnAfterValidate@19038799();
    BEGIN
      CurrPage.UPDATE;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Correct function SetUsageFilter.
    }
    END.
  }
}

OBJECT Page 367 Post Codes
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW13.00,NAVAP4.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Post Codes;
               THA=รหัสไปรษณีย์];
    SourceTable=Table225;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=City }

    { 1000000000;2;Field  ;
                SourceExpr="Zone Area" }

    { 1500000;2;Field     ;
                SourceExpr=County;
                TableRelation=County.Name }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 370 Bank Account Card
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,NAVAP4.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Bank Account Card;
               THA=บัตรแสดงบัญชีธนาคาร];
    SourceTable=Table270;
    PageType=Card;
    OnInit=BEGIN
             MapPointVisible := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000000000 : Codeunit 802;
               BEGIN
                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       CALCFIELDS("Check Report Name");
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 40      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Bank Acc.;
                                 THA=&บัญชีธนาคาร] }
      { 42      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 375;
                      RunFormLink=No.=FIELD(No.),Date Filter=FIELD(Date Filter),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 43      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Bank Account),No.=FIELD(No.);
                      Image=ViewComments }
      { 84      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(270),No.=FIELD(No.);
                      Image=Dimensions }
      { 52      ;2   ;Action    ;
                      CaptionML=[ENU=Balance;
                                 THA=ยอดคงเหลือ];
                      RunObject=Page 377;
                      RunFormLink=No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Image=Balance }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=St&atements;
                                 THA=งบ&ดุล];
                      RunObject=Page 389;
                      RunFormLink=Bank Account No.=FIELD(No.);
                      Promoted=Yes;
                      Image=BankAccountStatement;
                      PromotedCategory=Process }
      { 44      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 372;
                      RunFormView=SORTING(Bank Account No.);
                      RunFormLink=Bank Account No.=FIELD(No.);
                      Promoted=No;
                      Image=BankAccountLedger;
                      PromotedCategory=Process }
      { 46      ;2   ;Action    ;
                      CaptionML=[ENU=Chec&k Ledger Entries;
                                 THA=ตรวจ&สอบรายการบัญชีแยกประเภท];
                      RunObject=Page 374;
                      RunFormView=SORTING(Bank Account No.);
                      RunFormLink=Bank Account No.=FIELD(No.);
                      Image=CheckLedger }
      { 56      ;2   ;Action    ;
                      CaptionML=[ENU=C&ontact;
                                 THA=ผู้&ติดต่อ];
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 81      ;2   ;Separator  }
      { 86      ;2   ;Action    ;
                      CaptionML=[ENU=Online Map;
                                 THA=Online Map];
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 1905334303;1 ;Action    ;
                      CaptionML=ENU=Bank Account Reconciliations;
                      RunObject=Page 388;
                      RunFormView=SORTING(Bank Account No.);
                      RunFormLink=Bank Account No.=FIELD(No.);
                      Promoted=Yes;
                      Image=BankAccountRec;
                      PromotedCategory=Process }
      { 1906306803;1 ;Action    ;
                      CaptionML=ENU=Receivables-Payables;
                      RunObject=Page 355;
                      Promoted=Yes;
                      Image=ReceivablesPayables;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1903941404;1 ;Action    ;
                      CaptionML=ENU=Cash Receipt Journals;
                      RunObject=Page 255;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1906045504;1 ;Action    ;
                      CaptionML=ENU=Payment Journals;
                      RunObject=Page 256;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1900084706;1 ;Action    ;
                      CaptionML=ENU=List;
                      RunObject=Report 1402;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900670506;1 ;Action    ;
                      CaptionML=ENU=Detail Trial Balance;
                      RunObject=Report 1404;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1906306806;1 ;Action    ;
                      CaptionML=ENU=Receivables-Payables;
                      RunObject=Report 5;
                      Promoted=No;
                      Image=ReceivablesPayables;
                      PromotedCategory=Report }
      { 1904208406;1 ;Action    ;
                      CaptionML=ENU=Check Details;
                      RunObject=Report 1406;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Name;
                Importance=Promoted }

    { 6   ;2   ;Field     ;
                SourceExpr=Address }

    { 8   ;2   ;Field     ;
                SourceExpr="Address 2" }

    { 11  ;2   ;Field     ;
                SourceExpr="Post Code" }

    { 10  ;2   ;Field     ;
                SourceExpr=City }

    { 1500000;2;Field     ;
                SourceExpr=County }

    { 12  ;2   ;Field     ;
                CaptionML=[ENU=County/Country Code;
                           THA=เขต/รหัสประเทศ];
                SourceExpr="Country/Region Code" }

    { 14  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 18  ;2   ;Field     ;
                SourceExpr=Contact }

    { 64  ;2   ;Field     ;
                SourceExpr="Bank Branch No." }

    { 36  ;2   ;Field     ;
                SourceExpr="Bank Account No.";
                Importance=Promoted }

    { 20  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 22  ;2   ;Field     ;
                SourceExpr=Balance;
                Importance=Promoted }

    { 54  ;2   ;Field     ;
                SourceExpr="Balance (LCY)" }

    { 24  ;2   ;Field     ;
                SourceExpr="Min. Balance" }

    { 26  ;2   ;Field     ;
                SourceExpr="Our Contact Code" }

    { 28  ;2   ;Field     ;
                SourceExpr=Blocked }

    { 30  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 1902768601;1;Group  ;
                CaptionML=[ENU=Communication;
                           THA=การสื่อสาร] }

    { 16  ;2   ;Field     ;
                SourceExpr="Phone No.";
                Importance=Promoted }

    { 66  ;2   ;Field     ;
                SourceExpr="Fax No." }

    { 68  ;2   ;Field     ;
                SourceExpr="E-Mail";
                Importance=Promoted }

    { 70  ;2   ;Field     ;
                SourceExpr="Home Page" }

    { 1904784501;1;Group  ;
                CaptionML=[ENU=Posting;
                           THA=การลงรายการบัญชี] }

    { 34  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted }

    { 48  ;2   ;Field     ;
                SourceExpr="Last Check No." }

    { 50  ;2   ;Field     ;
                SourceExpr="Transit No." }

    { 60  ;2   ;Field     ;
                SourceExpr="Last Statement No.";
                Importance=Promoted }

    { 62  ;2   ;Field     ;
                SourceExpr="Balance Last Statement";
                Importance=Promoted }

    { 1000000000;2;Field  ;
                SourceExpr="Format Cheque" }

    { 32  ;2   ;Field     ;
                SourceExpr="Bank Acc. Posting Group";
                Importance=Promoted }

    { 1905090301;1;Group  ;
                CaptionML=[ENU=Transfer;
                           THA=การโอนย้าย] }

    { 59  ;2   ;Field     ;
                SourceExpr="Bank Branch No.";
                Importance=Promoted }

    { 58  ;2   ;Field     ;
                SourceExpr="Bank Account No.";
                Importance=Promoted }

    { 76  ;2   ;Field     ;
                SourceExpr="Transit No." }

    { 78  ;2   ;Field     ;
                SourceExpr="SWIFT Code";
                Importance=Promoted }

    { 82  ;2   ;Field     ;
                SourceExpr=IBAN;
                Importance=Promoted }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      MapPointVisible@19022708 : Boolean INDATASET;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   -Add field "Format Cheque".
    }
    END.
  }
}

OBJECT Page 372 Bank Account Ledger Entries
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW14.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Bank Account Ledger Entries;
               THA=รายการบัญชีแยกประเภทของบัญชีธนาคาร];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table271;
    DataCaptionFields=Bank Account No.;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       VendorCustName := '';
                       CASE "Bal. Account Type" OF
                         "Bal. Account Type"::Customer:
                           IF Cust.GET("Bal. Account No.") THEN BEGIN
                             IF Cust."Name (Thai)" <> '' THEN
                               VendorCustName := Cust."Name (Thai)"
                             ELSE
                               VendorCustName := Cust.Name + Cust."Name 2";
                           END;
                         "Bal. Account Type"::Vendor:
                           IF Vend.GET("Bal. Account No.") THEN BEGIN
                             IF Vend."Name (Thai)" <> '' THEN
                               VendorCustName := Vend."Name (Thai)"
                             ELSE
                               VendorCustName := Vend.Name + Vend."Name 2";
                           END;
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 24      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 46      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Check Ledger E&ntries;
                                 THA=ตรวจสอบรายการ&บัญชีแยกประเภท];
                      RunObject=Page 374;
                      RunFormView=SORTING(Bank Account Ledger Entry No.);
                      RunFormLink=Bank Account Ledger Entry No.=FIELD(Entry No.);
                      Image=CheckLedger }
      { 25      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 544;
                      RunFormLink=Table ID=CONST(271),Entry No.=FIELD(Entry No.);
                      Image=Dimensions }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 22      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 37      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reverse Transaction;
                                 THA=กลับรายการ];
                      OnAction=VAR
                                 ReversalEntry@1000000001 : Record 179;
                               BEGIN
                                 CLEAR(ReversalEntry);
                                 IF Reversed THEN
                                   ReversalEntry.AlreadyReversedEntry(TABLECAPTION,"Entry No.");
                                 IF "Journal Batch Name" = '' THEN
                                   ReversalEntry.TestFieldError;
                                 TESTFIELD("Transaction No.");
                                 ReversalEntry.ReverseTransaction("Transaction No.");
                               END;
                                }
      { 21      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No.";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Bank Account No.";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr=Description;
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Bal. Account Type";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Bal. Account No.";
                Editable=FALSE }

    { 1000000006;2;Field  ;
                CaptionML=ENU=Vendor/Customer Name;
                SourceExpr=VendorCustName;
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Vendor Bank Account No." }

    { 1000000002;2;Field  ;
                SourceExpr="Vendor Bank Branch No." }

    { 1000000004;2;Field  ;
                SourceExpr="Customer/Vendor Bank" }

    { 12  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code";
                Visible=FALSE;
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Our Contact Code";
                Visible=FALSE;
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE;
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr=Amount;
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Amount (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Remaining Amount";
                Visible=FALSE;
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr=Open;
                Editable=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="User ID";
                Visible=FALSE;
                Editable=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Source Code";
                Visible=FALSE;
                Editable=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE;
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr=Reversed;
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Reversed by Entry No.";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Reversed Entry No.";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Entry No.";
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Navigate@1000000000 : Form 344;
      Cust@1000000001 : Record 18;
      Vend@1000000002 : Record 23;
      VendorCustName@1000000003 : Text[150];

    BEGIN
    END.
  }
}

OBJECT Page 380 Bank Acc. Reconciliation Lines
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    LinksAllowed=No;
    SourceTable=Table274;
    DelayedInsert=Yes;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             BalanceEnable := TRUE;
             TotalBalanceEnable := TRUE;
             TotalDiffEnable := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  IF BelowxRec THEN
                    CalcBalance(xRec."Statement Line No.")
                  ELSE
                    CalcBalance(xRec."Statement Line No." - 1);
                  OnAfterGetCurrRecord;
                END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Transaction Date" }

    { 22  ;2   ;Field     ;
                SourceExpr="Value Date";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Document No.";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="Check No.";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr=Type }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000004;2;Field  ;
                SourceExpr="Outstanding Check" }

    { 1000000000;2;Field  ;
                SourceExpr="Statement Check" }

    { 1000000002;2;Field  ;
                SourceExpr="Applied Check" }

    { 8   ;2   ;Field     ;
                SourceExpr="Statement Amount" }

    { 10  ;2   ;Field     ;
                SourceExpr="Applied Amount" }

    { 12  ;2   ;Field     ;
                SourceExpr=Difference }

    { 14  ;2   ;Field     ;
                SourceExpr="Applied Entries";
                Visible=FALSE }

    { 16  ;1   ;Group      }

    { 26  ;2   ;Field     ;
                Name=Balance;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ];
                SourceExpr=Balance + Rec."Statement Amount";
                AutoFormatType=1;
                AutoFormatExpr=GetCurrencyCode;
                Enabled=BalanceEnable;
                Editable=FALSE }

    { 17  ;2   ;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล];
                SourceExpr=TotalBalance + Rec."Statement Amount";
                AutoFormatType=1;
                AutoFormatExpr=GetCurrencyCode;
                Enabled=TotalBalanceEnable;
                Editable=FALSE }

    { 19  ;2   ;Field     ;
                Name=TotalDiff;
                CaptionML=[ENU=Total Difference;
                           THA=รวมผลต่าง];
                SourceExpr=TotalDiff + Rec.Difference;
                AutoFormatType=1;
                AutoFormatExpr=GetCurrencyCode;
                Enabled=TotalDiffEnable;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      BankAccRecon@1000000000 : Record 273;
      StmtApplyEntries@1000000001 : Codeunit 374;
      TotalDiff@1000000002 : Decimal;
      Balance@1000000003 : Decimal;
      TotalBalance@1000000004 : Decimal;
      TotalDiffEnable@19038859 : Boolean INDATASET;
      TotalBalanceEnable@19047480 : Boolean INDATASET;
      BalanceEnable@19079599 : Boolean INDATASET;

    LOCAL PROCEDURE CalcBalance@3(BankAccReconLineNo@1000000000 : Integer);
    VAR
      TempBankAccReconLine@1000000001 : Record 274;
    BEGIN
      IF BankAccRecon.GET("Bank Account No.","Statement No.") THEN;

      TempBankAccReconLine.COPY(Rec);

      TotalDiff := -Difference;
      IF TempBankAccReconLine.CALCSUMS(Difference) THEN BEGIN
        TotalDiff := TotalDiff + TempBankAccReconLine.Difference;
        TotalDiffEnable := TRUE;
      END ELSE
        TotalDiffEnable := FALSE;

      TotalBalance := BankAccRecon."Balance Last Statement" - "Statement Amount";
      IF TempBankAccReconLine.CALCSUMS("Statement Amount") THEN BEGIN
        TotalBalance := TotalBalance + TempBankAccReconLine."Statement Amount";
        TotalBalanceEnable := TRUE;
      END ELSE
        TotalBalanceEnable := FALSE;

      Balance := BankAccRecon."Balance Last Statement" - "Statement Amount";
      TempBankAccReconLine.SETRANGE("Statement Line No.",0,BankAccReconLineNo);
      IF TempBankAccReconLine.CALCSUMS("Statement Amount") THEN BEGIN
        Balance := Balance + TempBankAccReconLine."Statement Amount";
        BalanceEnable := TRUE;
      END ELSE
        BalanceEnable := FALSE;
    END;

    PROCEDURE ApplyEntries@1();
    BEGIN
      "Ready for Application" := TRUE;
      CurrPage.SAVERECORD;
      COMMIT;
      StmtApplyEntries.ApplyEntries(Rec);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      IF "Statement Line No." <> 0 THEN
        CalcBalance("Statement Line No.");
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 404 Check Preview
{
  OBJECT-PROPERTIES
  {
    Date=12/14/11;
    Time=[ 6:49:53 PM];
    Version List=NAVW16.00,NAVAP6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Check Preview;
               THA=ตรวจสอบมุมมองก่อนพิมพ์];
    LinksAllowed=No;
    SourceTable=Table81;
    DataCaptionExpr="Document No." + ' ' + CheckToAddr[1];
    PageType=Card;
    OnOpenPage=BEGIN
                 CompanyInfo.GET;
                 FormatAddr.Company(CompanyAddr,CompanyInfo);
               END;

    OnAfterGetRecord=BEGIN
                       CalcCheck;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 11  ;1   ;Group     ;
                CaptionML=[ENU=Payer;
                           THA=ผู้จ่ายเงิน] }

    { 15  ;2   ;Field     ;
                CaptionML=[ENU=Company Name;
                           THA=ชื่อบริษัท];
                SourceExpr=CompanyAddr[1] }

    { 16  ;2   ;Field     ;
                CaptionML=[ENU=Company Address;
                           THA=ที่อยู่บริษัท];
                SourceExpr=CompanyAddr[2] }

    { 17  ;2   ;Field     ;
                CaptionML=[ENU=Company Address 2;
                           THA=ที่อยู่บริษัท 2];
                SourceExpr=CompanyAddr[3] }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=Company Post Code/City;
                           THA=รหัสไปรษณีย์/เมืองของบริษัท];
                SourceExpr=CompanyAddr[4] }

    { 5   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 19  ;2   ;Field     ;
                CaptionML=[ENU=Status;
                           THA=สถานะ];
                SourceExpr=CheckStatusText }

    { 20  ;1   ;Group     ;
                CaptionML=[ENU=Amount;
                           THA=จำนวน] }

    { 11026;2  ;Group      }

    { 13  ;3   ;Field     ;
                CaptionML=[ENU=Amount Text;
                           THA=ข้อความยอดเงิน];
                CaptionClass=FORMAT (NumberText[1]) }

    { 14  ;3   ;Field     ;
                CaptionML=[ENU=Amount Text 2;
                           THA=ข้อความยอดเงิน 2];
                CaptionClass=FORMAT (NumberText[2]) }

    { 23  ;1   ;Group     ;
                CaptionML=[ENU=Payee;
                           THA=ผู้รับเงิน] }

    { 1902115401;2;Group  ;
                GroupType=FixedLayout }

    { 1900724701;3;Group  ;
                CaptionML=[ENU=Pay to the order of;
                           THA=จ่ายตามใบสั่งของ] }

    { 2   ;4   ;Field     ;
                CaptionML=[ENU=Pay-to Name;
                           THA=ชื่อผู้รับเงิน];
                SourceExpr=VendorName }

    { 8   ;4   ;Field     ;
                CaptionML=[ENU=Pay-to Address;
                           THA=ที่อยู่ทำจ่ายเงิน];
                SourceExpr=CheckToAddr[2] }

    { 9   ;4   ;Field     ;
                CaptionML=[ENU=Pay-to Address 2;
                           THA=ที่อยู่ทำจ่ายเงิน 2];
                SourceExpr=CheckToAddr[3] }

    { 10  ;4   ;Field     ;
                CaptionML=[ENU=Pay-to Post Code/City;
                           THA=รหัสไปรษณีย์/เมืองที่ทำจ่าย];
                SourceExpr=CheckToAddr[4] }

    { 1900724501;3;Group  ;
                CaptionML=[ENU=Date;
                           THA=วันที่] }

    { 6   ;4   ;Field     ;
                SourceExpr="Posting Date" }

    { 24  ;4   ;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 26  ;4   ;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 28  ;4   ;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 1900724401;3;Group  ;
                CaptionML=[ENU=Amount;
                           THA=จำนวน] }

    { 7   ;4   ;Field     ;
                Name=CheckAmount + WHTAmount;
                SourceExpr=CheckAmount - WHTAmount;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code" }

    { 25  ;4   ;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 27  ;4   ;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 29  ;4   ;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 1500001;2;Field     ;
                Name=WHTAmount;
                CaptionML=[ENU=WHT;
                           THA=WHT];
                SourceExpr=WHTAmount;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code" }

    { 1500007;2;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 1500002;2;Field     ;
                Name=CheckAmount;
                CaptionML=[ENU=CheckAmount;
                           THA=ตรวจสอบจำนวน];
                SourceExpr=CheckAmount;
                AutoFormatType=1;
                AutoFormatExpr="Currency Code";
                CaptionClass=FORMAT ('Total ' + "Currency Code") }

    { 1500010;2;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 1500006;2;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 1500009;2;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 1500005;2;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

    { 1500008;2;Field     ;
                SourceExpr=Text002;
                Visible=FALSE }

  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=Printed Check;THA=เช็คที่พิมพ์แล้ว';
      Text001@1000000001 : TextConst 'ENU=Not Printed Check;THA=ไม่ใช่เช็คที่พิมพ์';
      GenJnlLine@1000000002 : Record 81;
      Cust@1000000003 : Record 18;
      Vend@1000000004 : Record 23;
      BankAcc@1000000005 : Record 270;
      CompanyInfo@1000000006 : Record 79;
      CheckReport@1000000007 : Report 1401;
      FormatAddr@1000000008 : Codeunit 365;
      WHTManagement@1000000009 : Codeunit 28040;
      CheckToAddr@1000000010 : ARRAY [8] OF Text[50];
      CompanyAddr@1000000011 : ARRAY [8] OF Text[50];
      NumberText@1000000012 : ARRAY [2] OF Text[80];
      CheckStatusText@1000000013 : Text[30];
      CheckAmount@1000000014 : Decimal;
      WHTAmount@1000000015 : Decimal;
      VendorName@1000000016 : Text[150];
      Text002@1000000017 : TextConst 'ENU=Placeholder;THA=ตัวยึด';

    LOCAL PROCEDURE CalcCheck@1();
    VAR
      GenJnlLine1@1000000000 : Record 81;
      WHTSetup@1000000001 : Record 28043;
    BEGIN
      IF "Check Printed" THEN BEGIN
        GenJnlLine.RESET;
        GenJnlLine.SETCURRENTKEY("Journal Template Name","Journal Batch Name","Posting Date","Document No.");
        GenJnlLine.SETRANGE("Journal Template Name", "Journal Template Name");
        GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
        GenJnlLine.SETRANGE("Posting Date","Posting Date");
        GenJnlLine.SETRANGE("Document No.","Document No.");
        IF "Bal. Account No." = '' THEN
          GenJnlLine.SETRANGE("Bank Payment Type","Bank Payment Type"::" ")
        ELSE
          GenJnlLine.SETRANGE("Bank Payment Type","Bank Payment Type"::"Computer Check");
        GenJnlLine.SETRANGE("Check Printed",TRUE);
        CheckStatusText := Text000;
      END ELSE BEGIN
        GenJnlLine.RESET;
        GenJnlLine.SETCURRENTKEY("Journal Template Name","Journal Batch Name","Posting Date","Document No.");
        GenJnlLine.SETRANGE("Journal Template Name", "Journal Template Name");
        GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
        GenJnlLine.SETRANGE("Posting Date","Posting Date");
        GenJnlLine.SETRANGE("Document No.","Document No.");
        GenJnlLine.SETRANGE("Account Type","Account Type");
        GenJnlLine.SETRANGE("Account No.","Account No.");
        GenJnlLine.SETRANGE("Bal. Account Type","Bal. Account Type");
        GenJnlLine.SETRANGE("Bal. Account No.","Bal. Account No.");
        GenJnlLine.SETRANGE("Bank Payment Type","Bank Payment Type");
        CheckStatusText := Text001;
      END;

      CheckAmount := 0;
      WHTAmount := 0;
      IF GenJnlLine.FIND('-') THEN
        REPEAT
          CheckAmount := CheckAmount + GenJnlLine.Amount;
          GenJnlLine1.COPY(GenJnlLine);

          IF (GenJnlLine1."Interest Amount"<>0) THEN
            GenJnlLine1.VALIDATE(Amount,GenJnlLine1.Amount-GenJnlLine1."Interest Amount");
          IF GenJnlLine."Account Type" = GenJnlLine."Account Type"::Vendor THEN BEGIN
            {
            IF WHTSetup.GET(GenJnlLine."WHT Business Posting Group",GenJnlLine."WHT Product Posting Group") THEN
              IF WHTSetup."Realized WHT Type" <> WHTSetup."Realized WHT Type"::Earliest THEN
                WHTAmount := WHTAmount + WHTManagement.WHTAmountJournal(GenJnlLine1,FALSE)
              ELSE
                WHTAmount := WHTAmount + ABS(WHTManagement.CalcVendExtraWHTForEarliest(GenJnlLine1));
            }
            GenJnlLine1.VALIDATE(Amount,-GenJnlLine.Amount); //KKE : #001
            WHTAmount := WHTAmount + WHTManagement.WHTAmountJournal(GenJnlLine1,FALSE);
          END;
        UNTIL GenJnlLine.NEXT = 0;
      //CheckAmount := CheckAmount - WHTAmount;
      CheckAmount := CheckAmount + WHTAmount;  //KKE : #001

      IF CheckAmount < 0 THEN
        CheckAmount := 0;

      CheckReport.InitTextVariable;
      CheckReport.FormatNoText(NumberText,CheckAmount,GenJnlLine."Currency Code");

      CASE GenJnlLine."Account Type" OF
        GenJnlLine."Account Type"::"G/L Account":
          BEGIN
            CLEAR(CheckToAddr);
            CheckToAddr[1] := GenJnlLine.Description;
          END;
        GenJnlLine."Account Type"::Customer:
          BEGIN
            Cust.GET(GenJnlLine."Account No.");
            Cust.Contact := '';
            FormatAddr.Customer(CheckToAddr,Cust);
          END;
        GenJnlLine."Account Type"::Vendor:
          BEGIN
            Vend.GET(GenJnlLine."Account No.");
            Vend.Contact := '';
            FormatAddr.Vendor(CheckToAddr,Vend);
            //KKE : #001 +
            IF GenJnlLine."Payee Name" <> '' THEN
              VendorName := GenJnlLine."Payee Name"
            ELSE
              IF Vend."Name (Thai)" <> '' THEN
                VendorName := Vend."Name (Thai)"
              ELSE
                VendorName := Vend.Name + Vend."Name 2";
            //KKE : #001 -
          END;
        GenJnlLine."Account Type"::"Bank Account":
          BEGIN
            BankAcc.GET(GenJnlLine."Account No.");
            BankAcc.Contact := '';
            FormatAddr.BankAcc(CheckToAddr,BankAcc);
          END;
        GenJnlLine."Account Type"::"Fixed Asset":
          GenJnlLine.FIELDERROR("Account Type");
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Correct WHT Amount.
    }
    END.
  }
}

OBJECT Page 408 G/L Balance by Dimension
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,NAVAP6.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=G/L Balance by Dimension;
               THA=ดุล G/L ตามมิติ];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table367;
    PageType=Card;
  }
  CONTROLS
  {
  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=<Sign><Integer Thousand><Decimals,2>;THA=<Sign><Integer Thousand><Decimals,2>';
      Text001@1000000001 : TextConst 'ENU=Period;THA=รอบระยะเวลา';
      Text002@1000000002 : TextConst 'ENU=%1 is not a valid line definition.;THA=%1 เป็นการกำหนดบรรทัดที่ไม่ถูกต้อง';
      Text003@1000000003 : TextConst 'ENU=%1 is not a valid column definition.;THA=%1 เป็นการกำหนดคอลัมน์ที่ไม่ถูกต้อง';
      GLSetup@1000000004 : Record 98;
      GLAcc@1000000005 : Record 15;
      BusUnit@1000000006 : Record 220;
      DimCodAmtBuf@1000000007 : TEMPORARY Record 375;
      CurrExchRate@1000000008 : Record 330;
      LineDimOption@1000000009 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      ColumnDimOption@1000000010 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      LineDimCode@1000000011 : Text[30];
      ColumnDimCode@1000000012 : Text[30];
      PeriodType@1000000013 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      AmountType@1000000014 : 'Net Change,Balance at Date';
      RoundingFactor@1000000015 : 'None,1,1000,1000000';
      AmountField@1000000016 : 'Amount,Debit Amount,Credit Amount';
      ShowActualBudg@1000000017 : 'Actual Amounts,Budgeted Amounts,Variance,Variance%,Index%';
      ShowInAddCurr@1000000018 : Boolean;
      ClosingEntryFilter@1000000019 : 'Include,Exclude';
      ShowColumnName@1000000020 : Boolean;
      DateFilter@1000000021 : Text[250];
      InternalDateFilter@1000000022 : Text[250];
      ExcludeClosingDateFilter@1000000023 : Text[250];
      GLAccFilter@1000000024 : Code[250];
      BudgetFilter@1000000025 : Code[250];
      BusUnitFilter@1000000026 : Code[250];
      GlobalDim1Filter@1000000027 : Code[250];
      GlobalDim2Filter@1000000028 : Code[250];
      MatrixHeader@1000000029 : Text[50];
      MatrixAmount@1000000030 : Decimal;
      PeriodInitialized@1000000031 : Boolean;
      CurrExchDate@1000000032 : Date;
      BusUnitFilterCaption@1000000033 : Text[80];
      IncludeSimulation@1000000034 : Boolean;

    LOCAL PROCEDURE DimCodeToOption@21(DimCode@1000000000 : Text[30]) : Integer;
    VAR
      BusUnit@1000000001 : Record 220;
    BEGIN
    END;

    LOCAL PROCEDURE FindRec@59(DimOption@1000000000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2';VAR DimCodeBuf@1000000001 : Record 367;Which@1000000002 : Text[250]) : Boolean;
    VAR
      GLAcc@1000000003 : Record 15;
      BusUnit@1000000004 : Record 220;
      Period@1000000005 : Record 2000000007;
      DimVal@1000000006 : Record 349;
      PeriodFormMgt@1000000007 : Codeunit 359;
      Found@1000000008 : Boolean;
    BEGIN
    END;

    LOCAL PROCEDURE NextRec@60(DimOption@1000000000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2';VAR DimCodeBuf@1000000001 : Record 367;Steps@1000000002 : Integer) : Integer;
    VAR
      GLAcc@1000000003 : Record 15;
      BusUnit@1000000004 : Record 220;
      Period@1000000005 : Record 2000000007;
      DimVal@1000000006 : Record 349;
      PeriodFormMgt@1000000007 : Codeunit 359;
      ResultSteps@1000000008 : Integer;
    BEGIN
    END;

    LOCAL PROCEDURE CopyGLAccToBuf@1(VAR TheGLAcc@1000000000 : Record 15;VAR TheDimCodeBuf@1000000001 : Record 367);
    BEGIN
    END;

    LOCAL PROCEDURE CopyPeriodToBuf@8(VAR ThePeriod@1000000000 : Record 2000000007;VAR TheDimCodeBuf@1000000001 : Record 367);
    VAR
      Period2@1000000002 : Record 2000000007;
    BEGIN
    END;

    LOCAL PROCEDURE CopyBusUnitToBuf@5(VAR TheBusUnit@1000000000 : Record 220;VAR TheDimCodeBuf@1000000001 : Record 367);
    BEGIN
    END;

    LOCAL PROCEDURE CopyDimValueToBuf@9(VAR TheDimVal@1000000000 : Record 349;VAR TheDimCodeBuf@1000000001 : Record 367);
    BEGIN
    END;

    LOCAL PROCEDURE FindPeriod@2(SearchText@1000000000 : Code[10]);
    VAR
      Period@1000000001 : Record 2000000007;
      PeriodFormMgt@1000000002 : Codeunit 359;
    BEGIN
    END;

    LOCAL PROCEDURE CalculateClosingDateFilter@45();
    VAR
      AccountingPeriod@1000000000 : Record 50;
      FirstRec@1000000001 : Boolean;
    BEGIN
    END;

    LOCAL PROCEDURE FormatAmount@6(VAR Text@1000000000 : Text[250]);
    VAR
      Amount@1000000001 : Decimal;
    BEGIN
    END;

    LOCAL PROCEDURE GetDimSelection@3(OldDimSelCode@1000000000 : Text[30]) : Text[30];
    VAR
      DimSelection@1000000001 : Form 568;
    BEGIN
    END;

    LOCAL PROCEDURE LookUpCode@4(DimOption@1000000000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2';DimCode@1000000001 : Text[30];Code@1000000002 : Text[30]);
    VAR
      GLAcc@1000000003 : Record 15;
      BusUnit@1000000004 : Record 220;
      DimVal@1000000005 : Record 349;
      DimValList@1000000006 : Form 560;
    BEGIN
    END;

    LOCAL PROCEDURE LookUpDimFilter@57(Dim@1000000000 : Code[20];VAR Text@1000000001 : Text[250]) : Boolean;
    VAR
      DimVal@1000000002 : Record 349;
      DimValList@1000000003 : Form 560;
    BEGIN
    END;

    LOCAL PROCEDURE SetCommonFilters@15(VAR TheGLAcc@1000000000 : Record 15);
    VAR
      DateFilter2@1000000001 : Text[1024];
    BEGIN
    END;

    LOCAL PROCEDURE SetDimFilters@17(VAR TheGLAcc@1000000000 : Record 15;LineOrColumn@1000000001 : 'Line,Column');
    VAR
      DimOption@1000000002 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      DimCodeBuf@1000000003 : Record 367;
    BEGIN
    END;

    LOCAL PROCEDURE DrillDown@30(SetColFilter@1000000000 : Boolean);
    VAR
      GLEntry@1000000001 : Record 17;
      GLBudgetEntry@1000000002 : Record 96;
    BEGIN
    END;

    LOCAL PROCEDURE ValidateLineDimCode@19();
    VAR
      BusUnit@1000000000 : Record 220;
    BEGIN
    END;

    LOCAL PROCEDURE ValidateColumnDimCode@20();
    VAR
      BusUnit@1000000000 : Record 220;
    BEGIN
    END;

    LOCAL PROCEDURE CalcAmount@27(SetColFilter@1000000000 : Boolean) : Decimal;
    VAR
      Amount@1000000001 : Decimal;
      ColumnCode@1000000002 : Code[20];
    BEGIN
    END;

    LOCAL PROCEDURE CalcActualAmount@7() : Decimal;
    VAR
      Amount@1000000000 : Decimal;
    BEGIN
    END;

    LOCAL PROCEDURE CalcBudgAmount@10() : Decimal;
    VAR
      Amount@1000000000 : Decimal;
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT Page 426 Vendor Bank Account List
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW15.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Vendor Bank Account List;
               THA=รายการบัญชีธนาคารของผู้ขาย];
    SourceTable=Table288;
    DataCaptionFields=Vendor No.;
    PageType=List;
    CardFormID=Page425;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 105 ;2   ;Field     ;
                SourceExpr="Bank Account No." }

    { 1000000000;2;Field  ;
                SourceExpr="Bank Branch No." }

    { 87  ;2   ;Field     ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 93  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                SourceExpr=Contact }

    { 6   ;2   ;Field     ;
                SourceExpr="SWIFT Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr=IBAN;
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 103 ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 459 Sales & Receivables Setup
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,KITNA6.00,NAVAP5.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales & Receivables Setup;
               THA=เซ็ตอัพบัญชียอดขาย & ค้างรับ];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table311;
    PageType=Card;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 18  ;2   ;Field     ;
                SourceExpr="Discount Posting" }

    { 3   ;2   ;Field     ;
                SourceExpr="Credit Warnings" }

    { 20  ;2   ;Field     ;
                SourceExpr="Stockout Warning" }

    { 16  ;2   ;Field     ;
                SourceExpr="Shipment on Invoice" }

    { 57  ;2   ;Field     ;
                SourceExpr="Return Receipt on Credit Memo" }

    { 8   ;2   ;Field     ;
                SourceExpr="Invoice Rounding" }

    { 9   ;2   ;Field     ;
                SourceExpr="Ext. Doc. No. Mandatory" }

    { 44  ;2   ;Field     ;
                SourceExpr="Appln. between Currencies" }

    { 65  ;2   ;Field     ;
                SourceExpr="Logo Position on Documents" }

    { 77  ;2   ;Field     ;
                SourceExpr="Default Posting Date" }

    { 79  ;2   ;Field     ;
                SourceExpr="Default Quantity to Ship" }

    { 36  ;2   ;Field     ;
                SourceExpr="Copy Comments Blanket to Order" }

    { 40  ;2   ;Field     ;
                SourceExpr="Copy Comments Order to Invoice" }

    { 42  ;2   ;Field     ;
                SourceExpr="Copy Comments Order to Shpt." }

    { 61  ;2   ;Field     ;
                SourceExpr="Copy Cmts Ret.Ord. to Cr. Memo" }

    { 48  ;2   ;Field     ;
                SourceExpr="Copy Cmts Ret.Ord. to Ret.Rcpt" }

    { 46  ;2   ;Field     ;
                SourceExpr="Allow VAT Difference" }

    { 22  ;2   ;Field     ;
                SourceExpr="Calc. Inv. Discount" }

    { 52  ;2   ;Field     ;
                SourceExpr="Calc. Inv. Disc. per VAT ID" }

    { 59  ;2   ;Field     ;
                SourceExpr="Exact Cost Reversing Mandatory" }

    { 71  ;2   ;Field     ;
                SourceExpr="Check Prepmt. when Posting" }

    { 81  ;2   ;Field     ;
                SourceExpr="Archive Quotes and Orders" }

    { 1900309501;1;Group  ;
                CaptionML=[ENU=Dimensions;
                           THA=มิติ] }

    { 63  ;2   ;Field     ;
                SourceExpr="Customer Group Dimension Code" }

    { 14  ;2   ;Field     ;
                SourceExpr="Salesperson Dimension Code" }

    { 1904569201;1;Group  ;
                CaptionML=[ENU=Numbering;
                           THA=การกำหนดหมายเลข] }

    { 85  ;2   ;Field     ;
                SourceExpr="Customer Nos." }

    { 24  ;2   ;Field     ;
                SourceExpr="Quote Nos." }

    { 38  ;2   ;Field     ;
                SourceExpr="Blanket Order Nos." }

    { 26  ;2   ;Field     ;
                SourceExpr="Order Nos." }

    { 55  ;2   ;Field     ;
                SourceExpr="Return Order Nos." }

    { 75  ;2   ;Field     ;
                SourceExpr="Invoice Nos." }

    { 30  ;2   ;Field     ;
                SourceExpr="Posted Invoice Nos." }

    { 74  ;2   ;Field     ;
                SourceExpr="Credit Memo Nos." }

    { 32  ;2   ;Field     ;
                SourceExpr="Posted Credit Memo Nos." }

    { 28  ;2   ;Field     ;
                SourceExpr="Posted Shipment Nos." }

    { 50  ;2   ;Field     ;
                SourceExpr="Posted Return Receipt Nos." }

    { 6   ;2   ;Field     ;
                SourceExpr="Reminder Nos." }

    { 10  ;2   ;Field     ;
                SourceExpr="Issued Reminder Nos." }

    { 34  ;2   ;Field     ;
                SourceExpr="Fin. Chrg. Memo Nos." }

    { 12  ;2   ;Field     ;
                SourceExpr="Issued Fin. Chrg. M. Nos." }

    { 69  ;2   ;Field     ;
                SourceExpr="Posted Prepmt. Inv. Nos." }

    { 1000000000;2;Field  ;
                SourceExpr="Complaint Nos." }

    { 67  ;2   ;Field     ;
                SourceExpr="Posted Prepmt. Cr. Memo Nos." }

    { 1000000002;2;Field  ;
                SourceExpr="Sales Tax Invoice Nos." }

    { 1000000004;2;Field  ;
                SourceExpr="Issued Tax Invoice/Receipt Nos" }

    { 1902241801;1;Group  ;
                CaptionML=[ENU=WHT/GST;
                           THA=WHT/GST] }

    { 1500006;2;Field     ;
                SourceExpr="Print WHT on Credit Memo" }

    { 1500004;2;Field     ;
                SourceExpr="Print Dialog" }

    { 1500002;2;Field     ;
                SourceExpr="Payment Discount Reason Code" }

    { 1500014;2;Field     ;
                SourceExpr="Posted Tax Invoice Nos." }

    { 1500016;2;Field     ;
                SourceExpr="Posted Tax Credit Memo Nos" }

    { 1500000;2;Field     ;
                SourceExpr="Posted Non Tax Invoice Nos." }

    { 1500018;2;Field     ;
                SourceExpr="Posted Non Tax Credit Memo Nos" }

    { 1904240901;1;Group  ;
                CaptionML=[ENU=Post Dated Checks;
                           THA=เช็คสั่งจ่ายล่วงหน้า] }

    { 1500012;2;Field     ;
                SourceExpr="Post Dated Check Template" }

    { 1500011;2;Field     ;
                SourceExpr="Post Dated Check Batch" }

    { 1500010;2;Field     ;
                SourceExpr="Incl. PDC in Cr. Limit Check" }

    { 1905108901;1;Group  ;
                CaptionML=[ENU=Kitting;
                           THA=Kitting] }

    { 1462000;2;Field     ;
                SourceExpr="Components on Sales Orders" }

    { 1462002;2;Field     ;
                SourceExpr="Components on Shipments" }

    { 1462004;2;Field     ;
                SourceExpr="Components on Invoices" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 460 Purchases & Payables Setup
{
  OBJECT-PROPERTIES
  {
    Date=12/14/11;
    Time=[ 2:28:50 PM];
    Version List=NAVW16.00,NAVAP6.00,AVATHA4.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchases & Payables Setup;
               THA=เซ็ตอัพบัญชีเจ้าหนี้ & การซื้อ];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table312;
    DataCaptionExpr='';
    PageType=Card;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="Discount Posting" }

    { 4   ;2   ;Field     ;
                SourceExpr="Receipt on Invoice" }

    { 32  ;2   ;Field     ;
                SourceExpr="Return Shipment on Credit Memo" }

    { 6   ;2   ;Field     ;
                SourceExpr="Invoice Rounding" }

    { 8   ;2   ;Field     ;
                SourceExpr="Ext. Doc. No. Mandatory" }

    { 24  ;2   ;Field     ;
                SourceExpr="Allow VAT Difference" }

    { 10  ;2   ;Field     ;
                SourceExpr="Calc. Inv. Discount" }

    { 28  ;2   ;Field     ;
                SourceExpr="Calc. Inv. Disc. per VAT ID" }

    { 22  ;2   ;Field     ;
                SourceExpr="Appln. between Currencies" }

    { 12  ;2   ;Field     ;
                SourceExpr="Copy Comments Blanket to Order" }

    { 16  ;2   ;Field     ;
                SourceExpr="Copy Comments Order to Invoice" }

    { 18  ;2   ;Field     ;
                SourceExpr="Copy Comments Order to Receipt" }

    { 36  ;2   ;Field     ;
                SourceExpr="Copy Cmts Ret.Ord. to Cr. Memo" }

    { 30  ;2   ;Field     ;
                SourceExpr="Copy Cmts Ret.Ord. to Ret.Shpt" }

    { 38  ;2   ;Field     ;
                SourceExpr="Exact Cost Reversing Mandatory" }

    { 55  ;2   ;Field     ;
                SourceExpr="Check Prepmt. when Posting" }

    { 57  ;2   ;Field     ;
                SourceExpr="Archive Quotes and Orders" }

    { 59  ;2   ;Field     ;
                SourceExpr="Default Posting Date" }

    { 61  ;2   ;Field     ;
                SourceExpr="Default Qty. to Ship/Rcv." }

    { 1000000004;2;Field  ;
                SourceExpr="Average VAT Varience Account" }

    { 1904569201;1;Group  ;
                CaptionML=[ENU=Numbering;
                           THA=การกำหนดหมายเลข] }

    { 83  ;2   ;Field     ;
                SourceExpr="Vendor Nos." }

    { 42  ;2   ;Field     ;
                SourceExpr="Quote Nos." }

    { 14  ;2   ;Field     ;
                SourceExpr="Blanket Order Nos." }

    { 44  ;2   ;Field     ;
                SourceExpr="Order Nos." }

    { 34  ;2   ;Field     ;
                SourceExpr="Return Order Nos." }

    { 20  ;2   ;Field     ;
                SourceExpr="Invoice Nos." }

    { 48  ;2   ;Field     ;
                SourceExpr="Posted Invoice Nos." }

    { 87  ;2   ;Field     ;
                SourceExpr="Credit Memo Nos." }

    { 50  ;2   ;Field     ;
                SourceExpr="Posted Credit Memo Nos." }

    { 46  ;2   ;Field     ;
                SourceExpr="Posted Receipt Nos." }

    { 26  ;2   ;Field     ;
                SourceExpr="Posted Return Shpt. Nos." }

    { 52  ;2   ;Field     ;
                SourceExpr="Posted Prepmt. Inv. Nos." }

    { 40  ;2   ;Field     ;
                SourceExpr="Posted Prepmt. Cr. Memo Nos." }

    { 1902241801;1;Group  ;
                CaptionML=[ENU=WHT/GST;
                           THA=WHT/GST] }

    { 1500010;2;Field     ;
                SourceExpr="Posted Tax Invoice Nos." }

    { 1500012;2;Field     ;
                SourceExpr="Posted Tax Credit Memo Nos" }

    { 1500022;2;Field     ;
                SourceExpr="Posted Non Tax Invoice Nos." }

    { 1500020;2;Field     ;
                SourceExpr="Posted Non Tax Credit Memo Nos" }

    { 1500000;2;Field     ;
                SourceExpr="WHT Certificate No. Series" }

    { 1500004;2;Field     ;
                SourceExpr="Print WHT Docs. on Pay. Post" }

    { 1500026;2;Field     ;
                SourceExpr="Print WHT Docs. on Credit Memo" }

    { 1500016;2;Field     ;
                SourceExpr="GST Prod. Posting Group" }

    { 1500014;2;Field     ;
                SourceExpr="Payment Discount Reason Code" }

    { 1500002;2;Field     ;
                SourceExpr="Print Dialog" }

    { 1500018;2;Field     ;
                SourceExpr="Vendor Registration Warning" }

    { 1500024;2;Field     ;
                SourceExpr="Enable Vendor GST Amount (ACY)" }

    { 1000000000;2;Field  ;
                SourceExpr="Allow WHT Difference" }

    { 1000000002;2;Field  ;
                SourceExpr="Allow Manual WHT Cert. No." }

    { 1904240901;1;Group  ;
                CaptionML=[ENU=Post Dated Checks;
                           THA=เช็คสั่งจ่ายล่วงหน้า] }

    { 1500006;2;Field     ;
                SourceExpr="Post Dated Check Template" }

    { 1500008;2;Field     ;
                SourceExpr="Post Dated Check Batch" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 471 VAT Product Posting Groups
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW13.00,AVATHA4.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=VAT Product Posting Groups;
               THA=กลุ่มการลงรายการบัญชีตามผลิตภัณฑ์ที่ต้องเสีย VAT];
    SourceTable=Table324;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 8       ;1   ;Action    ;
                      CaptionML=[ENU=&Setup;
                                 THA=&เซ็ตอัพ];
                      RunObject=Page 472;
                      RunFormLink=VAT Prod. Posting Group=FIELD(Code);
                      Promoted=Yes;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000000;2;Field  ;
                SourceExpr="No VAT" }

    { 1000000002;2;Field  ;
                SourceExpr="Average VAT" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 554 Analysis by Dimensions
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Analysis by Dimensions;
               THA=การวิเคราะห์ตามมิติ];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table367;
    DataCaptionExpr=AnalysisViewCode;
    PageType=Card;
  }
  CONTROLS
  {
  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=Period;THA=รอบระยะเวลา';
      Text001@1000000001 : TextConst 'ENU=<Sign><Integer Thousand><Decimals,2>;THA=<Sign><Integer Thousand><Decimals,2>';
      Text002@1000000002 : TextConst 'ENU=You have not yet defined an analysis view.;THA=คุณยังไม่ได้กำหนดมุมมองการวิเคราะห์';
      Text003@1000000003 : TextConst 'ENU=%1 is not a valid line definition.;THA=%1 เป็นการกำหนดบรรทัดที่ไม่ถูกต้อง';
      Text004@1000000004 : TextConst 'ENU=%1 is not a valid column definition.;THA=%1 เป็นการกำหนดคอลัมน์ที่ไม่ถูกต้อง';
      Text005@1000000005 : TextConst 'ENU=1,6,,Dimension 1 Filter;THA=1,6,,ตัวกรองมิติ 1';
      Text006@1000000006 : TextConst 'ENU=1,6,,Dimension 2 Filter;THA=1,6,,ตัวกรองมิติ 2';
      Text007@1000000007 : TextConst 'ENU=1,6,,Dimension 3 Filter;THA=1,6,,ตัวกรองมิติ 3';
      Text008@1000000008 : TextConst 'ENU=1,6,,Dimension 4 Filter;THA=1,6,,ตัวกรองมิติ 4';
      GLSetup@1000000009 : Record 98;
      AnalysisView@1000000010 : Record 363;
      AnalysisViewEntry@1000000011 : Record 365;
      AnalysisViewBudgetEntry@1000000012 : Record 366;
      AVBreakdownBuffer@1000000013 : TEMPORARY Record 375;
      Currency@1000000014 : Record 4;
      CurrExchRate@1000000015 : Record 330;
      AnalysisViewCode@1000000016 : Code[10];
      LineDimOption@1000000017 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      ColumnDimOption@1000000018 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      LineDimCode@1000000019 : Text[30];
      ColumnDimCode@1000000020 : Text[30];
      PeriodType@1000000021 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      AmountType@1000000022 : 'Net Change,Balance at Date';
      RoundingFactor@1000000023 : 'None,1,1000,1000000';
      AmountField@1000000024 : 'Amount,Debit Amount,Credit Amount';
      ShowActualBudg@1000000025 : 'Actual Amounts,Budgeted Amounts,Variance,Variance%,Index%';
      ShowInAddCurr@1000000026 : Boolean;
      ShowOppositeSign@1000000027 : Boolean;
      ClosingEntryFilter@1000000028 : 'Include,Exclude';
      ShowColumnName@1000000029 : Boolean;
      DateFilter@1000000030 : Text[250];
      InternalDateFilter@1000000031 : Text[250];
      ExcludeClosingDateFilter@1000000032 : Text[1024];
      GLAccFilter@1000000033 : Code[250];
      BudgetFilter@1000000034 : Text[250];
      Dim1Filter@1000000035 : Code[250];
      Dim2Filter@1000000036 : Code[250];
      Dim3Filter@1000000037 : Code[250];
      Dim4Filter@1000000038 : Code[250];
      MatrixHeader@1000000039 : Text[50];
      MatrixAmount@1000000040 : Decimal;
      PeriodInitialized@1000000041 : Boolean;
      CurrExchDate@1000000042 : Date;
      BusUnitFilter@1000000043 : Code[250];
      BusUnitFilterCaption@1000000044 : Text[80];

    LOCAL PROCEDURE DimCodeToOption@21(DimCode@1000000000 : Text[30]) : Integer;
    VAR
      GLAcc@1000000001 : Record 15;
      BusUnit@1000000002 : Record 220;
    BEGIN
    END;

    LOCAL PROCEDURE FindRec@59(DimOption@1000000000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';VAR DimCodeBuf@1000000001 : Record 367;Which@1000000002 : Text[250]) : Boolean;
    VAR
      GLAcc@1000000003 : Record 15;
      BusUnit@1000000004 : Record 220;
      Period@1000000005 : Record 2000000007;
      DimVal@1000000006 : Record 349;
      PeriodFormMgt@1000000007 : Codeunit 359;
      Found@1000000008 : Boolean;
    BEGIN
    END;

    LOCAL PROCEDURE NextRec@60(DimOption@1000000000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';VAR DimCodeBuf@1000000001 : Record 367;Steps@1000000002 : Integer) : Integer;
    VAR
      GLAcc@1000000003 : Record 15;
      BusUnit@1000000004 : Record 220;
      Period@1000000005 : Record 2000000007;
      DimVal@1000000006 : Record 349;
      PeriodFormMgt@1000000007 : Codeunit 359;
      ResultSteps@1000000008 : Integer;
    BEGIN
    END;

    LOCAL PROCEDURE CopyGLAccToBuf@1(VAR TheGLAcc@1000000000 : Record 15;VAR TheDimCodeBuf@1000000001 : Record 367);
    BEGIN
    END;

    LOCAL PROCEDURE CopyPeriodToBuf@8(VAR ThePeriod@1000000000 : Record 2000000007;VAR TheDimCodeBuf@1000000001 : Record 367);
    VAR
      Period2@1000000002 : Record 2000000007;
    BEGIN
    END;

    LOCAL PROCEDURE CopyBusUnitToBuf@5(VAR TheBusUnit@1000000000 : Record 220;VAR TheDimCodeBuf@1000000001 : Record 367);
    BEGIN
    END;

    LOCAL PROCEDURE CopyDimValueToBuf@9(VAR TheDimVal@1000000000 : Record 349;VAR TheDimCodeBuf@1000000001 : Record 367);
    BEGIN
    END;

    LOCAL PROCEDURE FindPeriod@2(SearchText@1000000000 : Code[10]);
    VAR
      Calendar@1000000001 : Record 2000000007;
      PeriodFormMgt@1000000002 : Codeunit 359;
    BEGIN
    END;

    LOCAL PROCEDURE CalculateClosingDateFilter@45();
    VAR
      AccountingPeriod@1000000000 : Record 50;
      FirstRec@1000000001 : Boolean;
    BEGIN
    END;

    LOCAL PROCEDURE FormatAmount@6(VAR Text@1000000000 : Text[250]);
    VAR
      Amount@1000000001 : Decimal;
    BEGIN
    END;

    LOCAL PROCEDURE GetDimSelection@3(OldDimSelCode@1000000000 : Text[30]) : Text[30];
    VAR
      GLAcc@1000000001 : Record 15;
      BusUnit@1000000002 : Record 220;
      DimSelection@1000000003 : Form 568;
    BEGIN
    END;

    LOCAL PROCEDURE LookUpCode@4(DimOption@1000000000 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';DimCode@1000000001 : Text[30];Code@1000000002 : Text[30]);
    VAR
      GLAcc@1000000003 : Record 15;
      BusUnit@1000000004 : Record 220;
      DimVal@1000000005 : Record 349;
      DimValList@1000000006 : Form 560;
    BEGIN
    END;

    LOCAL PROCEDURE LookUpDimFilter@57(Dim@1000000000 : Code[20];VAR Text@1000000001 : Text[250]) : Boolean;
    VAR
      DimVal@1000000002 : Record 349;
      DimValList@1000000003 : Form 560;
    BEGIN
    END;

    LOCAL PROCEDURE SetCommonFilters@15(VAR TheAnalysisViewEntry@1000000000 : Record 365);
    VAR
      DateFilter2@1000000001 : Text[1024];
    BEGIN
    END;

    LOCAL PROCEDURE SetDimFilters@17(VAR TheAnalysisViewEntry@1000000000 : Record 365;LineOrColumn@1000000001 : 'Line,Column');
    VAR
      DimOption@1000000002 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      DimCodeBuf@1000000003 : Record 367;
    BEGIN
    END;

    LOCAL PROCEDURE SetCommonBudgetFilters@28(VAR TheAnalysisViewBudgetEntry@1000000000 : Record 366);
    BEGIN
    END;

    LOCAL PROCEDURE SetDimBudgetFilters@26(VAR TheAnalysisViewBudgetEntry@1000000000 : Record 366;LineOrColumn@1000000001 : 'Line,Column');
    VAR
      DimOption@1000000002 : 'G/L Account,Period,Business Unit,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      DimCodeBuf@1000000003 : Record 367;
    BEGIN
    END;

    LOCAL PROCEDURE DrillDown@30(SetColFilter@1000000000 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE ValidateAnalysisViewCode@11();
    VAR
      AnalysisViewFilter@1000000000 : Record 364;
    BEGIN
    END;

    LOCAL PROCEDURE ValidateLineDimCode@19();
    VAR
      GLAcc@1000000000 : Record 15;
      BusUnit@1000000001 : Record 220;
    BEGIN
    END;

    LOCAL PROCEDURE ValidateColumnDimCode@20();
    VAR
      GLAcc@1000000000 : Record 15;
      BusUnit@1000000001 : Record 220;
    BEGIN
    END;

    LOCAL PROCEDURE CalcAmount@27(SetColFilter@1000000000 : Boolean) : Decimal;
    VAR
      Amount@1000000001 : Decimal;
      ColumnCode@1000000002 : Code[20];
    BEGIN
    END;

    LOCAL PROCEDURE CalcActualAmount@7(SetColFilter@1000000000 : Boolean) : Decimal;
    VAR
      Amount@1000000001 : Decimal;
    BEGIN
    END;

    LOCAL PROCEDURE CalcBudgAmount@10(SetColFilter@1000000000 : Boolean) : Decimal;
    VAR
      Amount@1000000001 : Decimal;
    BEGIN
    END;

    LOCAL PROCEDURE GetCaptionClass@12(AnalysisViewDimType@1000000000 : Integer) : Text[250];
    BEGIN
    END;

    LOCAL PROCEDURE ShownCurrency@13() : Code[10];
    BEGIN
    END;

    PROCEDURE SetAnalysisViewCode@14(NextAnalysisViewCode@1000000000 : Code[10]);
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT Page 576 VAT Specification Subform
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,NAVAP5.00,AVATHA4.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table290;
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             "VAT Difference (ACY)Visible" := TRUE;
             "Amount (ACY)Visible" := TRUE;
             AmountIncludingVATACYVisible := TRUE;
             "VAT Amount (ACY)Visible" := TRUE;
             "VAT Base (ACY)Visible" := TRUE;
             InvoiceDiscountAmountEditable := TRUE;
             "VAT AmountEditable" := TRUE;
           END;

    OnAfterGetRecord=BEGIN
                       IF MainFormActiveTab = MainFormActiveTab::Other THEN
                         "VAT AmountEditable" := AllowVATDifference AND NOT "Includes Prepayment"
                       ELSE
                         "VAT AmountEditable" := AllowVATDifference;
                       InvoiceDiscountAmountEditable := AllowInvDisc AND NOT "Includes Prepayment";
                     END;

    OnModifyRecord=BEGIN
                     ModifyRec;
                     EXIT(FALSE);
                   END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="VAT Identifier";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="VAT %" }

    { 8   ;2   ;Field     ;
                SourceExpr="VAT Calculation Type";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Line Amount";
                AutoFormatType=1;
                AutoFormatExpr=CurrencyCode }

    { 12  ;2   ;Field     ;
                SourceExpr="Inv. Disc. Base Amount";
                AutoFormatType=1;
                AutoFormatExpr=CurrencyCode;
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Invoice Discount Amount";
                AutoFormatType=1;
                AutoFormatExpr=CurrencyCode;
                Visible=FALSE;
                Editable=InvoiceDiscountAmountEditable;
                OnValidate=BEGIN
                             CalcVATFields(CurrencyCode,PricesIncludingVAT,VATBaseDiscPct);
                             ModifyRec;
                           END;
                            }

    { 16  ;2   ;Field     ;
                SourceExpr="VAT Base";
                AutoFormatType=1;
                AutoFormatExpr=CurrencyCode }

    { 20  ;2   ;Field     ;
                SourceExpr="VAT Amount";
                AutoFormatType=1;
                AutoFormatExpr=CurrencyCode;
                Editable="VAT AmountEditable";
                OnValidate=BEGIN
                             IF AllowVATDifference AND NOT AllowVATDifferenceOnThisTab THEN
                               IF ParentControl = FORM::"Service Order Statistics" THEN
                                 ERROR(Text000,FIELDCAPTION("VAT Amount"),Text002)
                               ELSE
                                 ERROR(Text000,FIELDCAPTION("VAT Amount"),Text003);

                             GLSetup.GET;
                             IF GLSetup."Additional Reporting Currency" <> '' THEN
                               AddCurrency.GET(GLSetup."Additional Reporting Currency");
                             IF PurchHeader1."Posting Date" <> 0D THEN BEGIN
                               IF (PurchHeader1."Vendor Exchange Rate (ACY)"<>0) AND (PurchHeader1."Currency Code"='') THEN BEGIN
                                 CurrencyFactor :=
                                   CurrExchRate.ExchangeRateFactorFRS21(
                                     PurchHeader1."Posting Date",GLSetup."Additional Reporting Currency",PurchHeader1."Vendor Exchange Rate (ACY)")
                               END ELSE
                                 CurrencyFactor :=
                                   CurrExchRate.ExchangeRate(
                                     PurchHeader1."Posting Date",GLSetup."Additional Reporting Currency");

                               "VAT Amount (ACY)" :=
                                 ROUND(
                                   CurrExchRate.ExchangeAmtLCYToFCY(
                                     PurchHeader1."Posting Date",GLSetup."Additional Reporting Currency",
                                   ROUND(CurrExchRate.ExchangeAmtFCYToLCY(
                                     PurchHeader1."Posting Date",PurchHeader1."Currency Code","VAT Amount",
                                     PurchHeader1."Currency Factor"),AddCurrency."Amount Rounding Precision"),CurrencyFactor),
                                     AddCurrency."Amount Rounding Precision");
                             END;

                             IF PricesIncludingVAT THEN BEGIN
                               "VAT Base" := "Amount Including VAT" - "VAT Amount";
                               "VAT Base (ACY)" := "Amount Including VAT (ACY)" - "VAT Amount (ACY)";
                             END ELSE BEGIN
                               "Amount Including VAT" := "VAT Amount" + "VAT Base";
                               "Amount Including VAT (ACY)" := "VAT Amount (ACY)" + "VAT Base (ACY)";
                             END;

                             FormCheckVATDifference;
                             ModifyRec;
                           END;
                            }

    { 24  ;2   ;Field     ;
                SourceExpr="Calculated VAT Amount";
                AutoFormatType=1;
                AutoFormatExpr=CurrencyCode;
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="VAT Difference";
                AutoFormatType=1;
                AutoFormatExpr=CurrencyCode;
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Amount Including VAT";
                AutoFormatType=1;
                AutoFormatExpr=CurrencyCode;
                OnValidate=BEGIN
                             FormCheckVATDifference;
                           END;
                            }

    { 1000000000;2;Field  ;
                SourceExpr="VAT Claim %" }

    { 1000000002;2;Field  ;
                SourceExpr="Avg. VAT Amount" }

    { 1500000;2;Field     ;
                SourceExpr="VAT Base (ACY)";
                Visible="VAT Base (ACY)Visible" }

    { 1500002;2;Field     ;
                SourceExpr="VAT Amount (ACY)";
                Visible="VAT Amount (ACY)Visible";
                OnValidate=BEGIN
                             "Amount Including VAT (ACY)" := "VAT Amount (ACY)" + "VAT Base (ACY)";
                             FormCheckVATDifference;
                             ModifyRec;
                           END;
                            }

    { 1500004;2;Field     ;
                SourceExpr="Amount Including VAT (ACY)";
                Visible=AmountIncludingVATACYVisible }

    { 1500006;2;Field     ;
                SourceExpr="Amount (ACY)";
                Visible="Amount (ACY)Visible" }

    { 1500008;2;Field     ;
                SourceExpr="VAT Difference (ACY)";
                Visible="VAT Difference (ACY)Visible" }

  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=%1 can only be modified on the %2 tab.;THA=สามารถแก้ไข %1 ได้บนแท็บ %2 เท่านั้น';
      Text001@1000000001 : TextConst 'ENU="The total %1 for a document must not exceed %2 = %3.";THA="รวม %1 สำหรับเอกสารต้องไม่เกิน %2 = %3"';
      Currency@1000000002 : Record 4;
      ServHeader@1000000003 : Record 5900;
      CurrencyCode@1000000004 : Code[10];
      AllowVATDifference@1000000005 : Boolean;
      AllowVATDifferenceOnThisTab@1000000006 : Boolean;
      PricesIncludingVAT@1000000007 : Boolean;
      AllowInvDisc@1000000008 : Boolean;
      VATBaseDiscPct@1000000009 : Decimal;
      ParentControl@1000000010 : Integer;
      Text002@1000000011 : TextConst 'ENU=Details;THA=รายละเอียด';
      Text003@1000000012 : TextConst 'ENU=Invoicing;THA=การออกใบแจ้งหนี้';
      CurrentTabNo@1000000013 : Integer;
      MainFormActiveTab@1000000014 : 'Other,Prepayment';
      PurchHeader1@1000000015 : Record 38;
      CurrExchRate@1000000016 : Record 330;
      GLSetup@1000000017 : Record 98;
      AddCurrency@1000000018 : Record 4;
      CurrencyFactor@1000000019 : Decimal;
      "VAT AmountEditable"@19075252 : Boolean INDATASET;
      InvoiceDiscountAmountEditable@19042140 : Boolean INDATASET;
      "VAT Base (ACY)Visible"@19040061 : Boolean INDATASET;
      "VAT Amount (ACY)Visible"@19005943 : Boolean INDATASET;
      AmountIncludingVATACYVisible@19048959 : Boolean INDATASET;
      "Amount (ACY)Visible"@19061803 : Boolean INDATASET;
      "VAT Difference (ACY)Visible"@19009694 : Boolean INDATASET;

    PROCEDURE SetTempVATAmountLine@1(VAR NewVATAmountLine@1000000000 : Record 290);
    BEGIN
      DELETEALL;
      IF NewVATAmountLine.FIND('-') THEN
        REPEAT
          COPY(NewVATAmountLine);
          INSERT;
        UNTIL NewVATAmountLine.NEXT = 0;
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE GetTempVATAmountLine@5(VAR NewVATAmountLine@1000000000 : Record 290);
    BEGIN
      NewVATAmountLine.DELETEALL;
      IF FIND('-') THEN
        REPEAT
          NewVATAmountLine.COPY(Rec);
          NewVATAmountLine.INSERT;
        UNTIL NEXT = 0;
    END;

    PROCEDURE InitGlobals@2(NewCurrencyCode@1000000000 : Code[10];NewAllowVATDifference@1000000001 : Boolean;NewAllowVATDifferenceOnThisTab@1000000002 : Boolean;NewPricesIncludingVAT@1000000003 : Boolean;NewAllowInvDisc@1000000004 : Boolean;NewVATBaseDiscPct@1000000005 : Decimal;Type@1000000006 : 'Purchase,Sales,Services');
    VAR
      PurchSetup@1000000007 : Record 312;
    BEGIN
      CurrencyCode := NewCurrencyCode;
      AllowVATDifference := NewAllowVATDifference;
      AllowVATDifferenceOnThisTab := NewAllowVATDifferenceOnThisTab;
      PricesIncludingVAT := NewPricesIncludingVAT;
      AllowInvDisc := NewAllowInvDisc;
      VATBaseDiscPct := NewVATBaseDiscPct;
      "VAT AmountEditable" := AllowVATDifference;
      InvoiceDiscountAmountEditable := AllowInvDisc;
      IF Type=Type::Purchase THEN BEGIN
        PurchSetup.GET;
        "VAT Base (ACY)Visible" := PurchSetup."Enable Vendor GST Amount (ACY)";
        "VAT Amount (ACY)Visible" := PurchSetup."Enable Vendor GST Amount (ACY)";
        AmountIncludingVATACYVisible := PurchSetup."Enable Vendor GST Amount (ACY)";
        "Amount (ACY)Visible" := PurchSetup."Enable Vendor GST Amount (ACY)";
        "VAT Difference (ACY)Visible" := PurchSetup."Enable Vendor GST Amount (ACY)";
      END ELSE BEGIN
        "VAT Base (ACY)Visible" := FALSE;
        "VAT Amount (ACY)Visible" := FALSE;
        AmountIncludingVATACYVisible := FALSE;
        "Amount (ACY)Visible" := FALSE;
        "VAT Difference (ACY)Visible" := FALSE;
      END;
      IF CurrencyCode = '' THEN
        Currency.InitRoundingPrecision
      ELSE
        Currency.GET(CurrencyCode);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE FormCheckVATDifference@4();
    VAR
      VATAmountLine2@1000000000 : Record 290;
      TotalVATDifference@1000000001 : Decimal;
      TotalVATDifferenceACY@1000000002 : Decimal;
    BEGIN
      Rec.CheckVATDifference(CurrencyCode,AllowVATDifference,PricesIncludingVAT);
      VATAmountLine2 := Rec;
      TotalVATDifference := ABS("VAT Difference") - ABS(xRec."VAT Difference");
      TotalVATDifferenceACY := ABS("VAT Difference (ACY)") - ABS(xRec."VAT Difference (ACY)");
      IF FIND('-') THEN
        REPEAT
          TotalVATDifference := TotalVATDifference + ABS("VAT Difference");
          TotalVATDifferenceACY := TotalVATDifferenceACY + ABS("VAT Difference (ACY)");
        UNTIL NEXT = 0;
      Rec := VATAmountLine2;
      IF TotalVATDifference > Currency."Max. VAT Difference Allowed" THEN
        ERROR(
          Text001,FIELDCAPTION("VAT Difference"),
          Currency.FIELDCAPTION("Max. VAT Difference Allowed"),Currency."Max. VAT Difference Allowed");
      IF TotalVATDifferenceACY > (Currency."Max. VAT Difference Allowed"*PurchHeader1."Vendor Exchange Rate (ACY)") THEN
        ERROR(
          Text001,FIELDCAPTION("VAT Difference (ACY)"),
          Currency.FIELDCAPTION("Max. VAT Difference Allowed"),
          Currency."Max. VAT Difference Allowed"*PurchHeader1."Vendor Exchange Rate (ACY)");
    END;

    LOCAL PROCEDURE ModifyRec@3();
    VAR
      ServLine@1000000000 : Record 5902;
    BEGIN
      Modified := TRUE;
      MODIFY;

      IF ((ParentControl = FORM::"Service Order Statistics") AND
          (CurrentTabNo <> 1)) OR
         (ParentControl = FORM::"Service Statistics") THEN
        IF GetAnyLineModified THEN BEGIN
          ServLine.UpdateVATOnLines(0,ServHeader,ServLine,Rec);
          ServLine.UpdateVATOnLines(1,ServHeader,ServLine,Rec);
        END;
    END;

    PROCEDURE SetParentControl@6(ID@1000000000 : Integer);
    BEGIN
      ParentControl := ID;
    END;

    PROCEDURE SetServHeader@7(ServiceHeader@1000000000 : Record 5900);
    BEGIN
      ServHeader := ServiceHeader;
    END;

    PROCEDURE SetCurrentTabNo@8(TabNo@1000000000 : Integer);
    BEGIN
      CurrentTabNo := TabNo;
    END;

    PROCEDURE CurrentMainFrmTabIsPrpmt@10(IsPrepmtTab@1000000000 : Boolean);
    BEGIN
      IF IsPrepmtTab THEN
        MainFormActiveTab := MainFormActiveTab::Prepayment
      ELSE
        MainFormActiveTab := MainFormActiveTab::Other;
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE SetPurchHeader@1500000(VAR PurchHeader@1000000000 : Record 38);
    BEGIN
      PurchHeader1.GET(PurchHeader."Document Type",PurchHeader."No.");
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   25.01.2006   KKE   Fix error when change value on "VAT Amount".
      Burda
      002   16.07.2007   KKE   Average VAT
    }
    END.
  }
}

OBJECT Page 5050 Contact Card
{
  OBJECT-PROPERTIES
  {
    Date=12/08/11;
    Time=10:51:24 PM;
    Version List=NAVW16.00.10,NAVAP4.00.01,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Contact Card;
               THA=บัตรผู้ติดต่อ];
    SourceTable=Table5050;
    PageType=ListPlus;
    OnInit=BEGIN
             NoofJobResponsibilitiesEnable := TRUE;
             OrganizationalLevelCodeEnable := TRUE;
             "Company NameEnable" := TRUE;
             "Company No.Enable" := TRUE;
             "VAT Registration No.Enable" := TRUE;
             "Currency CodeEnable" := TRUE;
             MapPointVisible := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := FALSE;
               END;

    OnFindRecord=VAR
                   RecordFound@1000 : Boolean;
                 BEGIN
                   RecordFound := FIND(Which);
                   CurrPage.EDITABLE := RecordFound OR (GETFILTER("No.") = '');
                   EXIT(RecordFound);
                 END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 76      ;1   ;ActionGroup;
                      CaptionML=[ENU=C&ontact;
                                 THA=ผู้&ติดต่อ] }
      { 79      ;2   ;Action    ;
                      CaptionML=[ENU=Relate&d Contacts;
                                 THA=ผู้ติดต่อ&ที่เกี่ยวข้อง];
                      RunObject=Page 5052;
                      RunFormLink=Company No.=FIELD(Company No.) }
      { 82      ;2   ;ActionGroup;
                      CaptionML=[ENU=Comp&any;
                                 THA=บริ&ษัท] }
      { 85      ;3   ;Action    ;
                      CaptionML=[ENU=Business Relations;
                                 THA=ความสัมพันธ์ทางธุรกิจ];
                      RunObject=Page 5061;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 83      ;3   ;Action    ;
                      CaptionML=[ENU=Industry Groups;
                                 THA=กลุ่มอุตสาหกรรม];
                      RunObject=Page 5067;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 84      ;3   ;Action    ;
                      CaptionML=[ENU=Web Sources;
                                 THA=แหล่งที่มาของเว็บ];
                      RunObject=Page 5070;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 80      ;2   ;ActionGroup;
                      CaptionML=[ENU=P&erson;
                                 THA=บุ&คคล] }
      { 81      ;3   ;Action    ;
                      CaptionML=[ENU=Job Responsibilities;
                                 THA=งานที่รับผิดชอบ];
                      OnAction=VAR
                                 ContJobResp@1001 : Record 5067;
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 86      ;2   ;Action    ;
                      CaptionML=[ENU=Mailing &Groups;
                                 THA=กลุ่ม&เมล];
                      RunObject=Page 5064;
                      RunFormLink=Contact No.=FIELD(No.) }
      { 87      ;2   ;Action    ;
                      CaptionML=[ENU=Pro&files;
                                 THA=&ประวัติ];
                      OnAction=VAR
                                 ProfileManagement@1001 : Codeunit 5059;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 88      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 5053;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 89      ;2   ;Action    ;
                      CaptionML=[ENU=&Picture;
                                 THA=&รูปภาพ];
                      RunObject=Page 5104;
                      RunFormLink=No.=FIELD(No.) }
      { 90      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 5072;
                      RunFormLink=Table Name=CONST(Contact),No.=FIELD(No.),Sub No.=CONST(0);
                      Image=ViewComments }
      { 91      ;2   ;ActionGroup;
                      CaptionML=[ENU=Alternati&ve Address;
                                 THA=ที่อยู่&อื่น] }
      { 92      ;3   ;Action    ;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 5057;
                      RunFormLink=Contact No.=FIELD(No.);
                      Image=EditLines }
      { 93      ;3   ;Action    ;
                      CaptionML=[ENU=Date Ranges;
                                 THA=ช่วงวันที่];
                      RunObject=Page 5059;
                      RunFormLink=Contact No.=FIELD(No.) }
      { 94      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 95      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Interaction Log E&ntries;
                                 THA=รายการ&ล็อกการโต้ตอบ];
                      RunObject=Page 5076;
                      RunFormView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FILTER(<>''),Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 149     ;2   ;Action    ;
                      CaptionML=[ENU=Postponed &Interactions;
                                 THA=การโต้ตอบ&ที่เลื่อนออกไป];
                      RunObject=Page 5082;
                      RunFormView=SORTING(Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FILTER(<>''),Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 96      ;2   ;Action    ;
                      CaptionML=[ENU=T&o-dos;
                                 THA=สิ่&งที่ต้องปฏิบัติ];
                      RunObject=Page 5096;
                      RunFormView=SORTING(Contact Company No.,Date,Contact No.,Closed);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FIELD(FILTER(Lookup Contact No.)),System To-do Type=FILTER(Contact Attendee) }
      { 151     ;2   ;ActionGroup;
                      CaptionML=[ENU=Oppo&rtunities;
                                 THA=โอ&กาส] }
      { 97      ;3   ;Action    ;
                      CaptionML=[ENU=List;
                                 THA=รายการ];
                      RunObject=Page 5123;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FILTER(<>''),Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 100     ;2   ;Action    ;
                      CaptionML=[ENU=Segmen&ts;
                                 THA=เซกเม&นต์];
                      RunObject=Page 5150;
                      RunFormView=SORTING(Contact No.,Segment No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FILTER(<>''),Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=Segment }
      { 98      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 116     ;2   ;Action    ;
                      CaptionML=[ENU=Sales &Quotes;
                                 THA=ใบเสนอราคา&ขาย];
                      RunObject=Page 9300;
                      RunFormView=SORTING(Document Type,Sell-to Contact No.);
                      RunFormLink=Sell-to Contact No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=Process }
      { 119     ;2   ;Separator  }
      { 99      ;2   ;Action    ;
                      CaptionML=[ENU=C&ustomer/Vendor/Bank Acc.;
                                 THA=ลู&กค้า/ผู้ขาย/บัญชีธนาคาร];
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 62      ;2   ;Separator  }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Online Map;
                                 THA=Online Map];
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 75      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 102     ;2   ;Action    ;
                      CaptionML=[ENU=Launch &Web Source;
                                 THA=เปิดใช้ &Web Source];
                      OnAction=VAR
                                 ContactWebSource@1001 : Record 5060;
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 IF FORM.RUNMODAL(FORM::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                   ContactWebSource.Launch;
                               END;
                                }
      { 103     ;2   ;Action    ;
                      CaptionML=[ENU=Print Cover &Sheet;
                                 THA=พิมพ์&ใบปะหน้า];
                      OnAction=VAR
                                 Cont@1001 : Record 5050;
                               BEGIN
                                 Cont := Rec;
                                 Cont.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                               END;
                                }
      { 105     ;2   ;ActionGroup;
                      CaptionML=[ENU=Create as;
                                 THA=สร้างเป็น] }
      { 106     ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 THA=ลูกค้า];
                      OnAction=BEGIN
                                 CreateCustomer(ChooseCustomerTemplate);
                               END;
                                }
      { 107     ;3   ;Action    ;
                      CaptionML=[ENU=Vendor;
                                 THA=ผู้ขาย];
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 108     ;3   ;Action    ;
                      CaptionML=[ENU=Bank;
                                 THA=ธนาคาร];
                      OnAction=BEGIN
                                 CreateBankAccount;
                               END;
                                }
      { 109     ;2   ;ActionGroup;
                      CaptionML=[ENU=Link with existing;
                                 THA=เชื่อมโยงกับที่มีอยู่] }
      { 110     ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 THA=ลูกค้า];
                      OnAction=BEGIN
                                 CreateCustomerLink;
                               END;
                                }
      { 111     ;3   ;Action    ;
                      CaptionML=[ENU=Vendor;
                                 THA=ผู้ขาย];
                      OnAction=BEGIN
                                 CreateVendorLink;
                               END;
                                }
      { 112     ;3   ;Action    ;
                      CaptionML=[ENU=Bank;
                                 THA=ธนาคาร];
                      OnAction=BEGIN
                                 CreateBankAccountLink;
                               END;
                                }
      { 146     ;2   ;Action    ;
                      CaptionML=[ENU=Co&ntact Search;
                                 THA=การ&ค้นหาผู้ติดต่อ];
                      OnAction=VAR
                                 SearchResult@1001 : Record 5113;
                                 ContactSearchForm@1000 : Form 5177;
                               BEGIN
                                 ContactSearchForm.LOOKUPMODE(TRUE);
                                 IF ContactSearchForm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                   ContactSearchForm.GETRECORD(SearchResult);
                                   IF GET(SearchResult."Contact No.") THEN;
                                 END;
                               END;
                                }
      { 152     ;2   ;Separator  }
      { 153     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Template;
                                 THA=ใช้ต้นแบบ];
                      Promoted=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TemplateMgt@1000 : Codeunit 8612;
                                 RecRef@1001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 TemplateMgt.UpdateFromTemplateSelection(RecRef);
                               END;
                                }
      { 77      ;1   ;Action    ;
                      CaptionML=[ENU=Create &Interact;
                                 THA=สร้าง&การโต้ตอบ];
                      Promoted=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1907415106;1 ;Action    ;
                      CaptionML=ENU=Contact Cover Sheet;
                      RunObject=Report 5055;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             TypeOnAfterValidate;
                           END;
                            }

    { 6   ;2   ;Field     ;
                SourceExpr="Company No.";
                Enabled="Company No.Enable" }

    { 8   ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr="Company Name";
                Enabled="Company NameEnable";
                OnAssistEdit=BEGIN
                               Cont.SETRANGE("No.","Company No.");
                               CLEAR(CompanyDetails);
                               CompanyDetails.SETTABLEVIEW(Cont);
                               CompanyDetails.SETRECORD(Cont);
                               IF Type = Type::Person THEN
                                 CompanyDetails.EDITABLE := FALSE;
                               CompanyDetails.RUNMODAL;
                             END;
                              }

    { 10  ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr=Name;
                OnAssistEdit=BEGIN
                               MODIFY;
                               COMMIT;
                               Cont.SETRANGE("No.","No.");
                               IF Type = Type::Person THEN BEGIN
                                 CLEAR(NameDetails);
                                 NameDetails.SETTABLEVIEW(Cont);
                                 NameDetails.SETRECORD(Cont);
                                 NameDetails.RUNMODAL;
                               END ELSE BEGIN
                                 CLEAR(CompanyDetails);
                                 CompanyDetails.SETTABLEVIEW(Cont);
                                 CompanyDetails.SETRECORD(Cont);
                                 CompanyDetails.RUNMODAL;
                               END;
                               GET("No.");
                               CurrPage.UPDATE;
                             END;
                              }

    { 12  ;2   ;Field     ;
                SourceExpr=Address }

    { 14  ;2   ;Field     ;
                SourceExpr="Address 2" }

    { 1000000004;2;Field  ;
                SourceExpr="Address 3" }

    { 16  ;2   ;Field     ;
                SourceExpr="Post Code" }

    { 1500000;2;Field     ;
                SourceExpr=County }

    { 1000000005;2;Field  ;
                SourceExpr="Name (Thai)" }

    { 1000000006;2;Field  ;
                SourceExpr="Address (Thai)" }

    { 34  ;2   ;Field     ;
                SourceExpr=City }

    { 18  ;2   ;Field     ;
                CaptionML=[ENU=County/Country Code;
                           THA=เขต/รหัสประเทศ];
                SourceExpr="Country/Region Code" }

    { 20  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 22  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 24  ;2   ;Field     ;
                SourceExpr="Salesperson Code" }

    { 117 ;2   ;Field     ;
                SourceExpr="Salutation Code" }

    { 26  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 28  ;2   ;Field     ;
                SourceExpr="Date of Last Interaction";
                OnDrillDown=VAR
                              InteractionLogEntry@1000 : Record 5065;
                            BEGIN
                              InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                              InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                              InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                              InteractionLogEntry.SETRANGE("Attempt Failed",FALSE);
                              IF InteractionLogEntry.FIND('+') THEN
                                FORM.RUN(0,InteractionLogEntry);
                            END;
                             }

    { 30  ;2   ;Field     ;
                SourceExpr="Last Date Attempted";
                OnDrillDown=VAR
                              InteractionLogEntry@1000 : Record 5065;
                            BEGIN
                              InteractionLogEntry.SETCURRENTKEY("Contact Company No.",Date,"Contact No.",Canceled,"Initiated By","Attempt Failed");
                              InteractionLogEntry.SETRANGE("Contact Company No.","Company No.");
                              InteractionLogEntry.SETFILTER("Contact No.","Lookup Contact No.");
                              InteractionLogEntry.SETRANGE("Initiated By",InteractionLogEntry."Initiated By"::Us);
                              IF InteractionLogEntry.FIND('+') THEN
                                FORM.RUN(0,InteractionLogEntry);
                            END;
                             }

    { 32  ;2   ;Field     ;
                SourceExpr="Next To-do Date" }

    { 1000000000;2;Field  ;
                CaptionML=ENU=Subscriber No.;
                SourceExpr=Subscriber."No.";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                CaptionML=ENU=Customer No.;
                SourceExpr=Subscriber."Customer No.";
                Editable=FALSE }

    { 72  ;1   ;Part      ;
                SubFormLink=Contact No.=FIELD(No.);
                PagePartID=Page5051 }

    { 1902768601;1;Group  ;
                CaptionML=[ENU=Communication;
                           THA=การสื่อสาร] }

    { 35  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 36  ;2   ;Field     ;
                SourceExpr="Mobile Phone No." }

    { 38  ;2   ;Field     ;
                SourceExpr="Fax No." }

    { 40  ;2   ;Field     ;
                SourceExpr="Telex No." }

    { 42  ;2   ;Field     ;
                SourceExpr=Pager }

    { 44  ;2   ;Field     ;
                SourceExpr="Telex Answer Back" }

    { 46  ;2   ;Field     ;
                SourceExpr="E-Mail" }

    { 48  ;2   ;Field     ;
                SourceExpr="Home Page" }

    { 130 ;2   ;Field     ;
                SourceExpr="Language Code" }

    { 128 ;2   ;Field     ;
                SourceExpr="Salutation Code" }

    { 126 ;2   ;Field     ;
                SourceExpr="Correspondence Type" }

    { 125 ;2   ;Field     ;
                SourceExpr=IntegrationCustomerNo;
                Visible=FALSE;
                OnValidate=VAR
                             Customer@1000 : Record 18;
                             ContactBusinessRelation@1001 : Record 5054;
                           BEGIN
                             IF NOT (IntegrationCustomerNo = '') THEN BEGIN
                               Customer.GET(IntegrationCustomerNo);
                               ContactBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                               ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
                               ContactBusinessRelation.SETRANGE("No.",Customer."No.");
                               IF ContactBusinessRelation.FINDFIRST THEN
                                 VALIDATE("Company No.",ContactBusinessRelation."Contact No.");
                             END ELSE
                               VALIDATE("Company No.",'');
                           END;
                            }

    { 101 ;2   ;Field     ;
                SourceExpr="First Name";
                Visible=FALSE }

    { 121 ;2   ;Field     ;
                SourceExpr="Middle Name";
                Visible=FALSE }

    { 123 ;2   ;Field     ;
                SourceExpr=Surname;
                Visible=FALSE }

    { 1904829601;1;Group  ;
                CaptionML=[ENU=Segmentation;
                           THA=การแบ่งเซกเมนต์] }

    { 50  ;2   ;Field     ;
                SourceExpr="No. of Mailing Groups";
                OnDrillDown=VAR
                              ContMailingGrp@1001 : Record 5056;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ContMailingGrp.SETRANGE("Contact No.","No.");
                              FORM.RUNMODAL(FORM::"Contact Mailing Groups",ContMailingGrp);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 52  ;2   ;Field     ;
                SourceExpr="No. of Business Relations";
                OnDrillDown=VAR
                              ContBusRel@1001 : Record 5054;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ContBusRel.SETRANGE("Contact No.","Company No.");
                              FORM.RUNMODAL(FORM::"Contact Business Relations",ContBusRel);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 54  ;2   ;Field     ;
                SourceExpr="No. of Industry Groups";
                OnDrillDown=VAR
                              ContIndustGrp@1001 : Record 5058;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ContIndustGrp.SETRANGE("Contact No.","Company No.");
                              FORM.RUNMODAL(FORM::"Contact Industry Groups",ContIndustGrp);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 56  ;2   ;Field     ;
                SourceExpr="No. of Job Responsibilities";
                Enabled=NoofJobResponsibilitiesEnable;
                OnDrillDown=VAR
                              ContJobResp@1001 : Record 5067;
                            BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ContJobResp.SETRANGE("Contact No.","No.");
                              FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 58  ;2   ;Field     ;
                SourceExpr="Organizational Level Code";
                Enabled=OrganizationalLevelCodeEnable }

    { 60  ;2   ;Field     ;
                SourceExpr="Exclude from Segment" }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 64  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Enabled="Currency CodeEnable" }

    { 68  ;2   ;Field     ;
                SourceExpr="Territory Code" }

    { 66  ;2   ;Field     ;
                SourceExpr="VAT Registration No.";
                Enabled="VAT Registration No.Enable" }

    { 1902813501;1;Group  ;
                CaptionML=[ENU=Registration;
                           THA=การลงทะเบียน] }

    { 1500003;2;Field     ;
                SourceExpr="IRD No." }

    { 1500007;2;Field     ;
                SourceExpr=ABN }

    { 1500009;2;Field     ;
                SourceExpr="ABN Division Part No." }

    { 1500005;2;Field     ;
                SourceExpr=Registered }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Cont@1000 : Record 5050;
      CompanyDetails@1001 : Form 5054;
      NameDetails@1002 : Form 5055;
      IntegrationCustomerNo@1003 : Code[20];
      Subscriber@1000000000 : Record 50001;
      MapPointVisible@19022708 : Boolean INDATASET;
      "Currency CodeEnable"@19025310 : Boolean INDATASET;
      "VAT Registration No.Enable"@19054634 : Boolean INDATASET;
      "Company No.Enable"@19064179 : Boolean INDATASET;
      "Company NameEnable"@19044404 : Boolean INDATASET;
      OrganizationalLevelCodeEnable@19070485 : Boolean INDATASET;
      NoofJobResponsibilitiesEnable@19004457 : Boolean INDATASET;

    PROCEDURE EnableFields@1();
    BEGIN
      "Currency CodeEnable" := Type = Type::Company;
      "VAT Registration No.Enable" := Type = Type::Company;
      "Company No.Enable" := Type = Type::Person;
      "Company NameEnable" := Type = Type::Person;
      OrganizationalLevelCodeEnable := Type = Type::Person;
      NoofJobResponsibilitiesEnable := Type = Type::Person;
    END;

    PROCEDURE IntegrationFindCustomerNo@2();
    VAR
      ContactBusinessRelation@1000 : Record 5054;
    BEGIN
      ContactBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
      ContactBusinessRelation.SETRANGE("Contact No.","Company No.");
      IF ContactBusinessRelation.FINDFIRST THEN BEGIN
        IntegrationCustomerNo := ContactBusinessRelation."No.";
      END ELSE BEGIN
        IntegrationCustomerNo := '';
      END;
    END;

    LOCAL PROCEDURE TypeOnAfterValidate@19069045();
    BEGIN
      EnableFields;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      EnableFields;

      IF Type = Type::Person THEN
        IntegrationFindCustomerNo;

      //KKE : #002 +
      Subscriber.RESET;
      Subscriber.SETCURRENTKEY("Contact No.");
      Subscriber.SETRANGE("Contact No.","No.");
      IF NOT Subscriber.FIND('-') THEN
        CLEAR(Subscriber);
      //KKE : #002 -
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
      Burda
      002   20.03.2007   KKE   Show Subscriber No., Customer No. (Related to Subscriber table)
    }
    END.
  }
}

OBJECT Page 5052 Contact List
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW15.00,NAVAP6.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Contact List;
               THA=รายชื่อผู้ติดต่อ];
    SourceTable=Table5050;
    SourceTableView=SORTING(Company Name,Company No.,Type,Name);
    DataCaptionFields=Company No.;
    PageType=List;
    CardFormID=Page5050;
    OnAfterGetRecord=BEGIN
                       NameIndent := 0;
                       NoOnFormat;
                       NameOnFormat;
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=C&ontact;
                                 THA=ผู้&ติดต่อ] }
      { 33      ;2   ;Action    ;
                      CaptionML=[ENU=Relate&d Contacts;
                                 THA=ผู้ติดต่อ&ที่เกี่ยวข้อง];
                      RunObject=Page 5052;
                      RunFormLink=Company No.=FIELD(Company No.) }
      { 34      ;2   ;ActionGroup;
                      CaptionML=[ENU=Comp&any;
                                 THA=บริ&ษัท] }
      { 35      ;3   ;Action    ;
                      CaptionML=[ENU=Business Relations;
                                 THA=ความสัมพันธ์ทางธุรกิจ];
                      RunObject=Page 5061;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 36      ;3   ;Action    ;
                      CaptionML=[ENU=Industry Groups;
                                 THA=กลุ่มอุตสาหกรรม];
                      RunObject=Page 5067;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 37      ;3   ;Action    ;
                      CaptionML=[ENU=Web Sources;
                                 THA=แหล่งที่มาของเว็บ];
                      RunObject=Page 5070;
                      RunFormLink=Contact No.=FIELD(Company No.) }
      { 38      ;2   ;ActionGroup;
                      CaptionML=[ENU=P&erson;
                                 THA=บุ&คคล] }
      { 39      ;3   ;Action    ;
                      CaptionML=[ENU=Job Responsibilities;
                                 THA=งานที่รับผิดชอบ];
                      OnAction=VAR
                                 ContJobResp@1000000001 : Record 5067;
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 FORM.RUNMODAL(FORM::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 1000000036;2 ;ActionGroup;
                      CaptionML=ENU=Subscri&ption (Burda) }
      { 1000000037;3 ;Action    ;
                      CaptionML=ENU=Subscriber;
                      OnAction=VAR
                                 Subscriber@1000000001 : Record 50001;
                               BEGIN
                                 //KKE : #001 +
                                 Subscriber.RESET;
                                 Subscriber.SETCURRENTKEY("Contact No.");
                                 Subscriber.SETRANGE("Contact No.","No.");
                                 IF NOT Subscriber.FIND('-') THEN
                                   CLEAR(Subscriber);
                                 IF Subscriber."No." <> '' THEN BEGIN
                                   Subscriber.GET(Subscriber."No.");
                                   FORM.RUN(FORM::"Subscriber Card",Subscriber);
                                 END;
                                 //KKE : #001 -
                               END;
                                }
      { 1000000038;3 ;Action    ;
                      CaptionML=ENU=Customer;
                      OnAction=VAR
                                 Subscriber@1000000001 : Record 50001;
                                 Cust@1000000002 : Record 18;
                               BEGIN
                                 //KKE : #001 +
                                 Subscriber.RESET;
                                 Subscriber.SETCURRENTKEY("Contact No.");
                                 Subscriber.SETRANGE("Contact No.","No.");
                                 IF NOT Subscriber.FIND('-') THEN
                                   CLEAR(Subscriber);
                                 IF Subscriber."Customer No." <> '' THEN BEGIN
                                   Cust.GET(Subscriber."Customer No.");
                                   FORM.RUN(FORM::"Customer Card",Cust);
                                 END;
                                 //KKE : #001 -
                               END;
                                }
      { 1000000039;3 ;Action    ;
                      CaptionML=ENU=Business Relations;
                      RunObject=Page 5061;
                      RunFormLink=Contact No.=FIELD(No.) }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Mailing &Groups;
                                 THA=กลุ่ม&เมล];
                      RunObject=Page 5064;
                      RunFormLink=Contact No.=FIELD(No.) }
      { 41      ;2   ;Action    ;
                      CaptionML=[ENU=Pro&files;
                                 THA=&ประวัติ];
                      OnAction=VAR
                                 ProfileManagement@1000000001 : Codeunit 5059;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 42      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 5053;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 43      ;2   ;Action    ;
                      CaptionML=[ENU=&Picture;
                                 THA=&รูปภาพ];
                      RunObject=Page 5104;
                      RunFormLink=No.=FIELD(No.) }
      { 44      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 5072;
                      RunFormLink=Table Name=CONST(Contact),No.=FIELD(No.),Sub No.=CONST(0);
                      Image=ViewComments }
      { 45      ;2   ;ActionGroup;
                      CaptionML=[ENU=Alternati&ve Address;
                                 THA=ที่อยู่&อื่น] }
      { 46      ;3   ;Action    ;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 5057;
                      RunFormLink=Contact No.=FIELD(No.);
                      Image=EditLines }
      { 47      ;3   ;Action    ;
                      CaptionML=[ENU=Date Ranges;
                                 THA=ช่วงวันที่];
                      RunObject=Page 5059;
                      RunFormLink=Contact No.=FIELD(No.) }
      { 48      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Interaction Log E&ntries;
                                 THA=รายการ&ล็อกการโต้ตอบ];
                      RunObject=Page 5076;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FILTER(<>''),Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 76      ;2   ;Action    ;
                      CaptionML=[ENU=Postponed &Interactions;
                                 THA=การโต้ตอบ&ที่เลื่อนออกไป];
                      RunObject=Page 5082;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FILTER(<>''),Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 50      ;2   ;Action    ;
                      CaptionML=[ENU=T&o-dos;
                                 THA=สิ่&งที่ต้องปฏิบัติ];
                      RunObject=Page 5096;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FIELD(FILTER(Lookup Contact No.)),System To-do Type=FILTER(Contact Attendee) }
      { 78      ;2   ;ActionGroup;
                      CaptionML=[ENU=Oppo&rtunities;
                                 THA=โอ&กาส] }
      { 51      ;3   ;Action    ;
                      CaptionML=[ENU=List;
                                 THA=รายการ];
                      RunObject=Page 5123;
                      RunFormView=SORTING(Contact Company No.,Contact No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FILTER(<>''),Contact No.=FIELD(FILTER(Lookup Contact No.)) }
      { 55      ;2   ;Action    ;
                      CaptionML=[ENU=Segmen&ts;
                                 THA=เซกเ&มนต์];
                      RunObject=Page 5150;
                      RunFormView=SORTING(Contact No.,Segment No.);
                      RunFormLink=Contact Company No.=FIELD(Company No.),Contact No.=FILTER(<>''),Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=Segment }
      { 52      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Sales &Quotes;
                                 THA=ใบเสนอราคา&ขาย];
                      RunObject=Page 9300;
                      RunFormView=SORTING(Document Type,Sell-to Contact No.);
                      RunFormLink=Sell-to Contact No.=FIELD(No.);
                      Image=Quote }
      { 69      ;2   ;Separator  }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=C&ustomer/Vendor/Bank Acc.;
                                 THA=ลู&กค้า/ผู้ขาย/บัญชีธนาคาร];
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 54      ;2   ;Action    ;
                      CaptionML=[ENU=Make &Phone Call;
                                 THA=โทร&ออก];
                      OnAction=VAR
                                 TAPIManagement@1000000001 : Codeunit 5053;
                               BEGIN
                                 TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Phone No.",'');
                               END;
                                }
      { 56      ;2   ;Action    ;
                      CaptionML=[ENU=Launch &Web Source;
                                 THA=เปิดใช้ &Web Source];
                      OnAction=VAR
                                 ContactWebSource@1000000001 : Record 5060;
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 IF FORM.RUNMODAL(FORM::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                   ContactWebSource.Launch;
                               END;
                                }
      { 57      ;2   ;Action    ;
                      CaptionML=[ENU=Print Cover &Sheet;
                                 THA=พิมพ์&ใบปะหน้า];
                      OnAction=VAR
                                 Cont@1000000001 : Record 5050;
                               BEGIN
                                 Cont := Rec;
                                 Cont.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                               END;
                                }
      { 58      ;2   ;ActionGroup;
                      CaptionML=[ENU=Create as;
                                 THA=สร้างเป็น] }
      { 59      ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 THA=ลูกค้า];
                      OnAction=BEGIN
                                 CreateCustomer(ChooseCustomerTemplate);
                               END;
                                }
      { 60      ;3   ;Action    ;
                      CaptionML=[ENU=Vendor;
                                 THA=ผู้ขาย];
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 61      ;3   ;Action    ;
                      CaptionML=[ENU=Bank;
                                 THA=ธนาคาร];
                      OnAction=BEGIN
                                 CreateBankAccount;
                               END;
                                }
      { 62      ;2   ;ActionGroup;
                      CaptionML=[ENU=Link with existing;
                                 THA=เชื่อมโยงกับที่มีอยู่] }
      { 63      ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 THA=ลูกค้า];
                      OnAction=BEGIN
                                 CreateCustomerLink;
                               END;
                                }
      { 64      ;3   ;Action    ;
                      CaptionML=[ENU=Vendor;
                                 THA=ผู้ขาย];
                      OnAction=BEGIN
                                 CreateVendorLink;
                               END;
                                }
      { 65      ;3   ;Action    ;
                      CaptionML=[ENU=Bank;
                                 THA=ธนาคาร];
                      OnAction=BEGIN
                                 CreateBankAccountLink;
                               END;
                                }
      { 74      ;2   ;Action    ;
                      CaptionML=[ENU=Co&ntact Search;
                                 THA=การ&ค้นหาผู้ติดต่อ];
                      OnAction=VAR
                                 SearchResult@1000000001 : Record 5113;
                                 ContactSearchForm@1000000002 : Form 5177;
                               BEGIN
                                 ContactSearchForm.LOOKUPMODE(TRUE);
                                 IF ContactSearchForm.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                   ContactSearchForm.GETRECORD(SearchResult);
                                   IF GET(SearchResult."Contact No.") THEN;
                                 END;
                               END;
                                }
      { 31      ;1   ;Action    ;
                      CaptionML=[ENU=Create &Interact;
                                 THA=สร้าง&การโต้ตอบ];
                      Promoted=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1900900305;1 ;Action    ;
                      CaptionML=ENU=New Sales Quote;
                      RunObject=Page 41;
                      RunFormLink=Sell-to Contact No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=New;
                      RunFormMode=Create }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1907415106;1 ;Action    ;
                      CaptionML=ENU=Contact Cover Sheet;
                      RunObject=Report 5055;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1907778706;1 ;Action    ;
                      CaptionML=ENU=Contact Company Summary;
                      RunObject=Report 5051;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1904205506;1 ;Action    ;
                      CaptionML=ENU=Contact Labels;
                      RunObject=Report 5056;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905922906;1 ;Action    ;
                      CaptionML=ENU=Questionnaire Handout;
                      RunObject=Report 5066;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1900800206;1 ;Action    ;
                      CaptionML=ENU=Sales Cycle Analysis;
                      RunObject=Report 5062;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=NameIndent;
                IndentationControls=Name;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 66  ;2   ;Field     ;
                SourceExpr="Company Name";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 24  ;2   ;Field     ;
                SourceExpr="Mobile Phone No.";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Salesperson Code" }

    { 16  ;2   ;Field     ;
                SourceExpr="Territory Code" }

    { 18  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 1500000;2;Field     ;
                SourceExpr=County }

    { 22  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Cont@1000000000 : Record 5050;
      "No.Emphasize"@19074284 : Boolean INDATASET;
      NameEmphasize@19018670 : Boolean INDATASET;
      NameIndent@19079073 : Integer INDATASET;

    LOCAL PROCEDURE NoOnFormat@19031395();
    BEGIN
      IF Type = Type::Company THEN
        "No.Emphasize" := TRUE;
    END;

    LOCAL PROCEDURE NameOnFormat@19039177();
    BEGIN
      IF Type = Type::Company THEN
        NameEmphasize := TRUE
      ELSE BEGIN
        Cont.SETCURRENTKEY("Company Name","Company No.",Type,Name);
        IF ("Company No." <> '') AND (NOT HASFILTER) AND (NOT MARKEDONLY) AND (CURRENTKEY = Cont.CURRENTKEY)
        THEN
          NameIndent := 1;
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   20.03.2007   KKE   Add Menu button for Subscription - Burda
    }
    END.
  }
}

OBJECT Page 5061 Contact Business Relations
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW13.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Contact Business Relations;
               THA=ความสัมพันธ์ทางธุรกิจกับผู้ติดต่อ];
    SourceTable=Table5054;
    DataCaptionFields=Contact No.;
    PageType=List;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Business Relation Code" }

    { 4   ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="Business Relation Description" }

    { 1000000000;2;Field  ;
                SourceExpr="Link to Table" }

    { 1000000002;2;Field  ;
                SourceExpr="No." }

    { 1000000004;2;Field  ;
                SourceExpr="Business Relation Description" }

    { 1000000006;2;Field  ;
                SourceExpr="Contact Name" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 5076 Interaction Log Entries
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Interaction Log Entries;
               THA=รายการล็อกการโต้ตอบ];
    SourceTable=Table5065;
    SourceTableView=WHERE(Postponed=CONST(No));
    DataCaptionFields=Contact Company No.,Contact No.,Salesperson Code,Interaction Template Code,To-do No.,Opportunity No.;
    PageType=Worksheet;
    OnInit=BEGIN
             EntryEnable := TRUE;
             ShowEnable := TRUE;
             FunctionsEnable := TRUE;
           END;

    OnFindRecord=VAR
                   RecordsFound@1000000001 : Boolean;
                 BEGIN
                   RecordsFound := FIND(Which);
                   FunctionsEnable := RecordsFound;
                   ShowEnable := RecordsFound;
                   EntryEnable := RecordsFound;
                   EXIT(RecordsFound);
                 END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 80      ;1   ;ActionGroup;
                      Name=Entry;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 83      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 5187;
                      RunFormLink=Entry No.=FIELD(Entry No.);
                      Image=ViewComments }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 57      ;1   ;ActionGroup;
                      Name=Functions;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 59      ;2   ;Action    ;
                      CaptionML=[ENU=Switch Check&mark in Canceled;
                                 THA=เปลี่ยนเครื่องหมาย&ถูกในช่อง "ถูกยกเลิก"];
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(InteractionLogEntry);
                                 InteractionLogEntry.ToggleCanceledCheckmark;
                               END;
                                }
      { 61      ;2   ;Action    ;
                      CaptionML=[ENU=Resend;
                                 THA=ส่งอีกครั้ง];
                      OnAction=VAR
                                 InteractLogEntry@1000000001 : Record 5065;
                                 ResendAttachments@1000000002 : Report 5183;
                               BEGIN
                                 InteractLogEntry.SETRANGE("Logged Segment Entry No.","Logged Segment Entry No.");
                                 InteractLogEntry.SETRANGE("Entry No.","Entry No.");
                                 ResendAttachments.SETTABLEVIEW(InteractLogEntry);
                                 ResendAttachments.RUNMODAL;
                               END;
                                }
      { 85      ;2   ;Action    ;
                      CaptionML=[ENU=Evaluate Interaction;
                                 THA=ประเมินการโต้ตอบ];
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(InteractionLogEntry);
                                 InteractionLogEntry.EvaluateInteraction;
                               END;
                                }
      { 75      ;2   ;Separator  }
      { 76      ;2   ;Action    ;
                      CaptionML=[ENU=Create To-do;
                                 THA=สร้างสิ่งที่ต้องปฏิบัติ];
                      OnAction=BEGIN
                                 CreateTodo;
                               END;
                                }
      { 2       ;1   ;Action    ;
                      Name=Show;
                      CaptionML=[ENU=&Show;
                                 THA=&แสดง];
                      Promoted=Yes;
                      Enabled=ShowEnable;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF "Attachment No." <> 0 THEN
                                   OpenAttachment
                                 ELSE
                                   ShowDocument;
                               END;
                                }
      { 60      ;1   ;Action    ;
                      CaptionML=[ENU=Create &Interact;
                                 THA=สร้าง&การโต้ตอบ];
                      Promoted=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 4   ;2   ;Field     ;
                SourceExpr=Canceled }

    { 6   ;2   ;Field     ;
                SourceExpr="Attempt Failed" }

    { 34  ;2   ;Field     ;
                SourceExpr="Document Type";
                Visible=FALSE }

    { 64  ;2   ;Field     ;
                SourceExpr="Document No.";
                Visible=FALSE }

    { 62  ;2   ;Field     ;
                SourceExpr="Delivery Status";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr=Date }

    { 10  ;2   ;Field     ;
                SourceExpr="Time of Interaction";
                Visible=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="Reference No." }

    { 1000000000;2;Field  ;
                SourceExpr="Start Time" }

    { 1000000002;2;Field  ;
                SourceExpr="End Time" }

    { 12  ;2   ;Field     ;
                SourceExpr="Correspondence Type";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Interaction Group Code";
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Interaction Template Code" }

    { 26  ;2   ;Field     ;
                SourceExpr=Description }

    { 3   ;2   ;Field     ;
                CaptionML=[ENU=Attachment;
                           THA=สิ่งที่แนบ];
                BlankZero=Yes;
                SourceExpr="Attachment No."<>0;
                OnAssistEdit=BEGIN
                               IF "Attachment No." <> 0 THEN
                                 OpenAttachment;
                             END;
                              }

    { 18  ;2   ;Field     ;
                SourceExpr="Information Flow";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Initiated By";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Contact No." }

    { 24  ;2   ;Field     ;
                SourceExpr="Contact Company No.";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr=Evaluation }

    { 30  ;2   ;Field     ;
                SourceExpr="Cost (LCY)" }

    { 32  ;2   ;Field     ;
                SourceExpr="Duration (Min.)" }

    { 36  ;2   ;Field     ;
                SourceExpr="Salesperson Code" }

    { 38  ;2   ;Field     ;
                SourceExpr="User ID";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Segment No.";
                Visible=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Campaign No." }

    { 44  ;2   ;Field     ;
                SourceExpr="Campaign Entry No.";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Campaign Response";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Campaign Target";
                Visible=FALSE }

    { 81  ;2   ;Field     ;
                SourceExpr="Opportunity No." }

    { 50  ;2   ;Field     ;
                SourceExpr="To-do No.";
                Visible=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="Interaction Language Code";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr=Subject;
                Visible=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Contact Via";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Entry No." }

    { 77  ;2   ;Field     ;
                SourceExpr=Comment }

    { 78  ;1   ;Group      }

    { 72  ;2   ;Field     ;
                DrillDown=No;
                CaptionML=[ENU=Contact Name;
                           THA=ชื่อผู้ติดต่อ];
                SourceExpr="Contact Name" }

    { 79  ;2   ;Field     ;
                DrillDown=No;
                SourceExpr="Contact Company Name" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      InteractionLogEntry@1000000000 : Record 5065;
      FunctionsEnable@19066687 : Boolean INDATASET;
      ShowEnable@19017131 : Boolean INDATASET;
      EntryEnable@19026620 : Boolean INDATASET;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      CALCFIELDS("Contact Name","Contact Company Name");
    END;

    BEGIN
    END.
  }
}

OBJECT Page 5094 Marketing Setup
{
  OBJECT-PROPERTIES
  {
    Date=12/08/11;
    Time=10:53:06 PM;
    Version List=NAVW16.00.10,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Marketing Setup;
               THA=การตั้งค่าการตลาด];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table5079;
    PageType=Card;
    OnInit=BEGIN
             "Queue Folder NameEnable" := TRUE;
             "Storage Folder NameEnable" := TRUE;
             EMailLoggingProfileNameEnable := TRUE;
             "Attachment Storage TypeEnable" := TRUE;
             AttachmentStorageLocationEnabl := TRUE;
           END;

    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;

                 AttachmentStorageLocationEnabl := "Attachment Storage Type" = "Attachment Storage Type"::"Disk File";

                 IF ISSERVICETIER THEN BEGIN
                   "Attachment Storage TypeEnable" := FALSE;
                   AttachmentStorageLocationEnabl := FALSE;
                   EMailLoggingProfileNameEnable := FALSE;
                   "Storage Folder NameEnable" := FALSE;
                   "Queue Folder NameEnable" := FALSE;
                 END;
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 100     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Setup;
                                 THA=&ตั้งค่า] }
      { 101     ;2   ;Action    ;
                      CaptionML=[ENU=Duplicate Search String Setup;
                                 THA=การตั้งค่าสตริงการค้นหาสำเนา];
                      RunObject=Page 5138 }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 50      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=&ฟังก์ชัน] }
      { 51      ;2   ;Action    ;
                      CaptionML=[ENU=Clear E-Mail Logging Setup;
                                 THA=ล้างการตั้งค่าการล็อกอีเมล];
                      OnAction=VAR
                                 EMailLogging@1102601000 : Codeunit 5064;
                               BEGIN
                                 EMailLogging.ClearEMailJounalingSetup(Rec);
                               END;
                                }
      { 52      ;2   ;Action    ;
                      CaptionML=[ENU=Generate Integration IDs for Connector for Microsoft Dynamics;
                                 THA=สร้าง ID การรวมสำหรับ Connector สำหรับ Microsoft Dynamics];
                      OnAction=VAR
                                 IntegrationManagement@1000 : Codeunit 5150;
                               BEGIN
                                 TESTFIELD("Enable Connector");
                                 IF CONFIRM(Text004,TRUE) THEN BEGIN
                                   IntegrationManagement.SetupIntegrationTables;
                                   MESSAGE(Text005);
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="Attachment Storage Type";
                Enabled="Attachment Storage TypeEnable";
                OnValidate=BEGIN
                             AttachmentStorageTypeOnAfterValidate;
                           END;
                            }

    { 4   ;2   ;Field     ;
                SourceExpr="Attachment Storage Location";
                Enabled=AttachmentStorageLocationEnabl;
                OnValidate=BEGIN
                             AttachmentStorageLocationOnAfterValidate;
                           END;
                            }

    { 123 ;2   ;Field     ;
                SourceExpr="Index Mode" }

    { 1904626001;1;Group  ;
                CaptionML=[ENU=Inheritance;
                           THA=การรับช่วง] }

    { 6   ;2   ;Group     ;
                CaptionML=[ENU=Inherit;
                           THA=รับมา] }

    { 13  ;3   ;Field     ;
                CaptionML=[ENU=Salesperson Code;
                           THA=รหัสพนักงานขาย];
                SourceExpr="Inherit Salesperson Code" }

    { 14  ;3   ;Field     ;
                CaptionML=[ENU=Territory Code;
                           THA=รหัสอาณาเขต];
                SourceExpr="Inherit Territory Code" }

    { 15  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region Code;
                           THA=รหัสประเทศ/ภูมิภาค];
                SourceExpr="Inherit Country/Region Code" }

    { 16  ;3   ;Field     ;
                CaptionML=[ENU=Language Code;
                           THA=รหัสภาษา];
                SourceExpr="Inherit Language Code" }

    { 17  ;3   ;Field     ;
                CaptionML=[ENU=Address Details;
                           THA=รายละเอียดที่อยู่];
                SourceExpr="Inherit Address Details" }

    { 79  ;3   ;Field     ;
                CaptionML=[ENU=Communication Details;
                           THA=รายละเอียดการสื่อสาร];
                SourceExpr="Inherit Communication Details" }

    { 1902985101;1;Group  ;
                CaptionML=[ENU=Defaults;
                           THA=ค่าเริ่มต้น] }

    { 80  ;2   ;Group     ;
                CaptionML=[ENU=Default;
                           THA=ค่าเริ่ม] }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=Salesperson Code;
                           THA=รหัสพนักงานขาย];
                SourceExpr="Default Salesperson Code" }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=Territory Code;
                           THA=รหัสอาณาเขต];
                SourceExpr="Default Territory Code" }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region Code;
                           THA=รหัสประเทศ/ภูมิภาค];
                SourceExpr="Default Country/Region Code" }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Language Code;
                           THA=รหัสภาษา];
                SourceExpr="Default Language Code" }

    { 102 ;3   ;Field     ;
                CaptionML=[ENU=Correspondence Type;
                           THA=ชนิดรูปแบบการติดต่อ];
                SourceExpr="Default Correspondence Type" }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Company Salutation Code;
                           THA=รหัสการทักทายของบริษัท];
                SourceExpr="Def. Company Salutation Code" }

    { 86  ;3   ;Field     ;
                CaptionML=[ENU=Person Salutation Code;
                           THA=รหัสการทักทายบุคคล];
                SourceExpr="Default Person Salutation Code" }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Sales Cycle Code;
                           THA=รหัสรอบการขาย];
                SourceExpr="Default Sales Cycle Code" }

    { 124 ;3   ;Field     ;
                CaptionML=[ENU=To-do Date Calculation;
                           THA=การคำนวณวันที่สิ่งที่ต้องปฏิบัติ];
                SourceExpr="Default To-do Date Calculation" }

    { 1906323901;1;Group  ;
                CaptionML=[ENU=Interactions;
                           THA=การโต้ตอบ] }

    { 55  ;2   ;Field     ;
                SourceExpr="Mergefield Language ID";
                LookupFormID=Windows Languages }

    { 1903203501;1;Group  ;
                CaptionML=[ENU=Synchronization;
                           THA=การปรับเวลาให้ตรงกัน] }

    { 1000000000;2;Field  ;
                SourceExpr="Burda-Bus. Rel. Code for Cust." }

    { 83  ;2   ;Group     ;
                CaptionML=[ENU=Bus. Relation Code for;
                           THA=รหัสความสัมพันธ์ทางธุรกิจสำหรับ] }

    { 56  ;3   ;Field     ;
                CaptionML=[ENU=Customers;
                           THA=ลูกค้า];
                SourceExpr="Bus. Rel. Code for Customers" }

    { 58  ;3   ;Field     ;
                CaptionML=[ENU=Vendors;
                           THA=ผู้ขาย];
                SourceExpr="Bus. Rel. Code for Vendors" }

    { 60  ;3   ;Field     ;
                CaptionML=[ENU=Bank Accounts;
                           THA=บัญชีธนาคาร];
                SourceExpr="Bus. Rel. Code for Bank Accs." }

    { 33  ;3   ;Field     ;
                SourceExpr="Enable Connector" }

    { 1904569201;1;Group  ;
                CaptionML=[ENU=Numbering;
                           THA=การกำหนดหมายเลข] }

    { 62  ;2   ;Field     ;
                SourceExpr="Contact Nos." }

    { 64  ;2   ;Field     ;
                SourceExpr="Campaign Nos." }

    { 66  ;2   ;Field     ;
                SourceExpr="Segment Nos." }

    { 68  ;2   ;Field     ;
                SourceExpr="To-do Nos." }

    { 70  ;2   ;Field     ;
                SourceExpr="Opportunity Nos." }

    { 1903832701;1;Group  ;
                CaptionML=[ENU=Duplicates;
                           THA=สำเนา] }

    { 75  ;2   ;Field     ;
                SourceExpr="Maintain Dupl. Search Strings" }

    { 77  ;2   ;Field     ;
                SourceExpr="Autosearch for Duplicates" }

    { 73  ;2   ;Field     ;
                SourceExpr="Search Hit %" }

    { 1900887301;1;Group  ;
                CaptionML=[ENU=E-Mail Logging;
                           THA=การล็อกอีเมล] }

    { 114 ;2   ;Field     ;
                SourceExpr="Time Interval (Sec.)" }

    { 106 ;2   ;Field     ;
                SourceExpr="E-Mail Logging Profile Name";
                Enabled=EMailLoggingProfileNameEnable;
                OnAssistEdit=VAR
                               EMailLogging@1102601000 : Codeunit 5064;
                             BEGIN
                               CurrPage.SAVERECORD;
                               EMailLogging.LookupProfile("E-Mail Logging Profile Name");
                               MODIFY;
                             END;
                              }

    { 104 ;2   ;Field     ;
                SourceExpr="Queue Folder Name";
                Enabled="Queue Folder NameEnable";
                OnAssistEdit=VAR
                               EMailLogging@1102601002 : Codeunit 5064;
                               QueueStoreID@1102601001 : OutStream;
                               QueueEntryID@1102601000 : OutStream;
                             BEGIN
                               CurrPage.SAVERECORD;
                               CALCFIELDS("Queue Folder Store ID","Queue Folder Entry ID");
                               "Queue Folder Store ID".CREATEOUTSTREAM(QueueStoreID);
                               "Queue Folder Entry ID".CREATEOUTSTREAM(QueueEntryID);
                               IF EMailLogging.LookupFolder(
                                 "Queue Folder Name",QueueStoreID,QueueEntryID,TRUE,Text001+'\'+Text002+'\\'+Text003)
                               THEN
                                 MODIFY;
                             END;
                              }

    { 19  ;2   ;Field     ;
                SourceExpr="Storage Folder Name";
                Enabled="Storage Folder NameEnable";
                OnAssistEdit=VAR
                               EMailLogging@1102601002 : Codeunit 5064;
                               StorageStoreID@1102601001 : OutStream;
                               StorageEntryID@1102601000 : OutStream;
                             BEGIN
                               CurrPage.SAVERECORD;
                               CALCFIELDS("Storage Folder Store ID","Storage Folder Entry ID");
                               "Storage Folder Store ID".CREATEOUTSTREAM(StorageStoreID);
                               "Storage Folder Entry ID".CREATEOUTSTREAM(StorageEntryID);
                               IF EMailLogging.LookupFolder("Storage Folder Name",StorageStoreID,StorageEntryID,FALSE,'') THEN
                                 MODIFY;
                             END;
                              }

    { 111 ;2   ;Field     ;
                SourceExpr="E-Mail Logging User ID" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=If you select this folder as your Queue folder, you will delete all the messages in the folder, and your messages cannot be restored.;THA=หากคุณเลือกโฟลเดอร์นี้เป็นโฟลเดอร์คิว คุณจะลบข้อความทั้งหมดในโฟลเดอร์ และข้อความของคุณจะไม่สามารถกู้คืนได้';
      Text002@1001 : TextConst 'ENU=Create a queue folder outside your Inbox if you want to avoid deleting your messages.;THA=สร้างโฟลเดอร์คิวนอกอินบ็อกซ์ หากคุณต้องการหลีกเลี่ยงการลบข้อความของคุณ';
      Text003@1002 : TextConst 'ENU=Do you want to select this folder as your Queue folder anyway?;THA=คุณต้องการเลือกโฟลเดอร์นี้เป็นโฟลเดอร์คิวของคุณหรือไม่';
      Text004@1003 : TextConst 'ENU=You are about to add integration data to tables. This process may take several minutes. Do you want to continue?;THA=คุณกำลังจะเพิ่มข้อมูลการรวมลงในตาราง ขั้นตอนนี้อาจใช้เวลาหลายนาที คุณต้องการทำต่อไปหรือไม่';
      Text005@1004 : TextConst 'ENU=The integration data has been added to the tables.;THA=ข้อมูลการรวมถูกเพิ่มลงในตาราง';
      AttachmentStorageLocationEnabl@19012985 : Boolean INDATASET;
      "Attachment Storage TypeEnable"@19069067 : Boolean INDATASET;
      EMailLoggingProfileNameEnable@19058160 : Boolean INDATASET;
      "Storage Folder NameEnable"@19043710 : Boolean INDATASET;
      "Queue Folder NameEnable"@19001091 : Boolean INDATASET;

    LOCAL PROCEDURE AttachmentStorageTypeOnAfterVa@19041025();
    BEGIN
      AttachmentStorageLocationEnabl := "Attachment Storage Type" = "Attachment Storage Type"::"Disk File";

      IF ("Attachment Storage Type" = "Attachment Storage Type"::Embedded) OR
         ("Attachment Storage Location" <> '')
      THEN BEGIN
        MODIFY;
        COMMIT;
        REPORT.RUN(REPORT::"Relocate Attachments");
      END;
    END;

    LOCAL PROCEDURE AttachmentStorageLocationOnAft@19001696();
    BEGIN
      IF "Attachment Storage Location" <> '' THEN BEGIN
        MODIFY;
        COMMIT;
        REPORT.RUN(REPORT::"Relocate Attachments");
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 5157 Customer Template Card
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW15.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Customer Template Card;
               THA=บัตรต้นแบบลูกค้า];
    SourceTable=Table5105;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Customer Template;
                                 THA=&ต้นแบบลูกค้า] }
      { 31      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(5105),No.=FIELD(Code);
                      Image=Dimensions }
      { 27      ;1   ;ActionGroup;
                      CaptionML=[ENU=S&ales;
                                 THA=ก&ารขาย] }
      { 28      ;2   ;Action    ;
                      CaptionML=[ENU=Invoice &Discounts;
                                 THA=ส่วนลดใน&ใบแจ้งหนี้];
                      RunObject=Page 23;
                      RunFormLink=Code=FIELD(Invoice Disc. Code) }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 6   ;2   ;Field     ;
                SourceExpr="Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Territory Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Currency Code" }

    { 12  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 14  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1000000000;2;Field  ;
                SourceExpr="WHT Business Posting Group" }

    { 16  ;2   ;Field     ;
                SourceExpr="Customer Posting Group" }

    { 18  ;2   ;Field     ;
                SourceExpr="Customer Price Group" }

    { 20  ;2   ;Field     ;
                SourceExpr="Customer Disc. Group" }

    { 22  ;2   ;Field     ;
                SourceExpr="Allow Line Disc." }

    { 24  ;2   ;Field     ;
                SourceExpr="Invoice Disc. Code" }

    { 32  ;2   ;Field     ;
                SourceExpr="Payment Terms Code" }

    { 34  ;2   ;Field     ;
                SourceExpr="Payment Method Code" }

    { 36  ;2   ;Field     ;
                SourceExpr="Shipment Method Code" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   27.03.2007   KKE   New field for WHT Bus.
    }
    END.
  }
}

OBJECT Page 5600 Fixed Asset Card
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW14.00.03,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Fixed Asset Card;
               THA=บัตรสินทรัพย์ถาวร];
    SourceTable=Table5600;
    PageType=ListPlus;
    RefreshOnActivate=Yes;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=Fixed &Asset;
                                 THA=สินทรัพย์&ถาวร] }
      { 51      ;2   ;Action    ;
                      CaptionML=[ENU=Depreciation &Books;
                                 THA=สมุด&บัญชีค่าเสื่อมราคา];
                      RunObject=Page 5619;
                      RunFormLink=FA No.=FIELD(No.);
                      Promoted=Yes;
                      Image=DepreciationBooks;
                      PromotedCategory=Process }
      { 7       ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Page 5604;
                      RunFormView=SORTING(FA No.);
                      RunFormLink=FA No.=FIELD(No.);
                      Promoted=No;
                      Image=FixedAssetLedger;
                      PromotedCategory=Process }
      { 8       ;2   ;Action    ;
                      CaptionML=[ENU=Error Ledger Entries;
                                 THA=รายการบัญชีแยกประเภทที่ผิดพลาด];
                      RunObject=Page 5605;
                      RunFormView=SORTING(Canceled from FA No.);
                      RunFormLink=Canceled from FA No.=FIELD(No.) }
      { 9       ;2   ;Action    ;
                      CaptionML=[ENU=Main&tenance Ledger Entries;
                                 THA=รายการบัญชีแยกประเภท&การบำรุงรักษา];
                      RunObject=Page 5641;
                      RunFormView=SORTING(FA No.);
                      RunFormLink=FA No.=FIELD(No.);
                      Promoted=Yes;
                      Image=MaintenanceLedgerEntries;
                      PromotedCategory=Process }
      { 50      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 124;
                      RunFormLink=Table Name=CONST(Fixed Asset),No.=FIELD(No.);
                      Image=ViewComments }
      { 84      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(5600),No.=FIELD(No.);
                      Image=Dimensions }
      { 36      ;2   ;Action    ;
                      CaptionML=[ENU=Picture;
                                 THA=รูปภาพ];
                      RunObject=Page 5620;
                      RunFormLink=No.=FIELD(No.) }
      { 35      ;2   ;Action    ;
                      CaptionML=[ENU=Maintenance &Registration;
                                 THA=การลงทะเบียน&การบำรุงรักษา];
                      RunObject=Page 5625;
                      RunFormLink=FA No.=FIELD(No.);
                      Promoted=Yes;
                      Image=MaintenanceRegistrations;
                      PromotedCategory=Process }
      { 29      ;2   ;Action    ;
                      CaptionML=[ENU=M&ain Asset Components;
                                 THA=ส่&วนประกอบสินทรัพย์หลัก];
                      RunObject=Page 5658;
                      RunFormLink=Main Asset No.=FIELD(No.) }
      { 57      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=C&opy Fixed Asset;
                                 THA=คั&ดลอกสินทรัพย์ถาวร];
                      Promoted=Yes;
                      Image=CopyFixedAssets;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CopyFA@1000000001 : Report 5685;
                               BEGIN
                                 CopyFA.SetFANo("No.");
                                 CopyFA.RUNMODAL;
                               END;
                                }
      { 39      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 THA=""] }
      { 40      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 5602;
                      RunFormLink=FA No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 41      ;2   ;Action    ;
                      CaptionML=[ENU=Ma&in Asset Statistics;
                                 THA=ส&ถิติสินทรัพย์หลัก];
                      RunObject=Page 5603;
                      RunFormLink=FA No.=FIELD(No.) }
      { 42      ;2   ;Action    ;
                      CaptionML=[ENU=FA Posting Types Overview;
                                 THA=ภาพรวมชนิดการลงรายการบัญชี FA];
                      RunObject=Page 5662 }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Total Value Ins&ured;
                                 THA=มูลค่ารวมที่&ประกัน];
                      RunObject=Page 5649;
                      RunFormLink=No.=FIELD(No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1900145704;1 ;Action    ;
                      CaptionML=ENU=Calculate Depreciation;
                      RunObject=Report 5692;
                      Promoted=Yes;
                      Image=CalculateDepreciation;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1907091306;1 ;Action    ;
                      CaptionML=ENU=Fixed Assets List;
                      RunObject=Report 5601;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1903109606;1 ;Action    ;
                      CaptionML=ENU=Acquisition List;
                      RunObject=Report 5608;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1901902606;1 ;Action    ;
                      CaptionML=ENU=Details;
                      RunObject=Report 5604;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1905598506;1 ;Action    ;
                      CaptionML=ENU=Book Value 01;
                      RunObject=Report 5605;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1905598606;1 ;Action    ;
                      CaptionML=ENU=Book Value 02;
                      RunObject=Report 5602;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1901105406;1 ;Action    ;
                      CaptionML=ENU=Analysis;
                      RunObject=Report 5600;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1902048606;1 ;Action    ;
                      CaptionML=ENU=Projected Value;
                      RunObject=Report 5607;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1903345906;1 ;Action    ;
                      CaptionML=ENU=G/L Analysis;
                      RunObject=Report 5610;
                      Promoted=No;
                      PromotedCategory=Report }
      { 1903807106;1 ;Action    ;
                      CaptionML=ENU=Register;
                      RunObject=Report 5603;
                      Promoted=Yes;
                      Image=Confirm;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Description;
                Importance=Promoted }

    { 26  ;2   ;Field     ;
                SourceExpr="Serial No.";
                Importance=Promoted }

    { 22  ;2   ;Field     ;
                SourceExpr="Main Asset/Component" }

    { 20  ;2   ;Field     ;
                SourceExpr="Component of Main Asset";
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Search Description" }

    { 63  ;2   ;Field     ;
                SourceExpr="Responsible Employee";
                Importance=Promoted }

    { 65  ;2   ;Field     ;
                SourceExpr=Inactive }

    { 30  ;2   ;Field     ;
                SourceExpr=Blocked }

    { 32  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 6   ;1   ;Part      ;
                Name=DepreciationBook;
                SubFormLink=FA No.=FIELD(No.);
                PagePartID=Page5666 }

    { 1904784501;1;Group  ;
                CaptionML=[ENU=Posting;
                           THA=การลงรายการบัญชี] }

    { 43  ;2   ;Field     ;
                SourceExpr="FA Class Code";
                Importance=Promoted }

    { 45  ;2   ;Field     ;
                SourceExpr="FA Subclass Code";
                Importance=Promoted }

    { 52  ;2   ;Field     ;
                SourceExpr="FA Location Code";
                Importance=Promoted }

    { 16  ;2   ;Field     ;
                SourceExpr="Budgeted Asset";
                Importance=Promoted }

    { 1903524101;1;Group  ;
                CaptionML=[ENU=Maintenance;
                           THA=การบำรุงรักษา] }

    { 10  ;2   ;Field     ;
                SourceExpr="Vendor No.";
                Importance=Promoted }

    { 12  ;2   ;Field     ;
                SourceExpr="Maintenance Vendor No.";
                Importance=Promoted }

    { 14  ;2   ;Field     ;
                SourceExpr="Under Maintenance" }

    { 24  ;2   ;Field     ;
                SourceExpr="Next Service Date";
                Importance=Promoted }

    { 37  ;2   ;Field     ;
                SourceExpr="Warranty Date" }

    { 28  ;2   ;Field     ;
                SourceExpr=Insured }

    { 1905718701;1;Group  ;
                CaptionML=[ENU=Burda;
                           THA=Burda] }

    { 1000000010;2;Field  ;
                SourceExpr="Purchase Value" }

    { 1000000012;2;Field  ;
                SourceExpr="VAT Amount" }

    { 1000000014;2;Field  ;
                SourceExpr="VAT Portion" }

    { 1000000016;2;Field  ;
                SourceExpr="Cost Portion" }

    { 1000000000;2;Field  ;
                SourceExpr="Receipt/Tax invoice" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 5604 FA Ledger Entries
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW14.00,Burda1.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=FA Ledger Entries;
               THA=รายการบัญชีแยกประเภท FA];
    SourceTable=Table5601;
    DataCaptionFields=FA No.,Depreciation Book Code;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 35      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ent&ry;
                                 THA=ราย&การ] }
      { 36      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 544;
                      RunFormLink=Table ID=CONST(5601),Entry No.=FIELD(Entry No.);
                      Image=Dimensions }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 19      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 33      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Cancel Entries;
                                 THA=ยกเลิกรายการ];
                      OnAction=BEGIN
                                 FALedgEntry.COPY(Rec);
                                 CurrPage.SETSELECTIONFILTER(FALedgEntry);
                                 CLEAR(CancelFAEntries);
                                 CancelFAEntries.GetFALedgEntry(FALedgEntry);
                                 CancelFAEntries.RUNMODAL;
                                 CLEAR(CancelFAEntries);
                               END;
                                }
      { 37      ;2   ;Separator  }
      { 38      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Reverse Transaction;
                                 THA=กลับรายการ];
                      Visible=No;
                      OnAction=VAR
                                 ReversalEntry@1000000001 : Record 179;
                                 DeprBook@1000000002 : Record 5611;
                                 FADeprBook@1000000003 : Record 5612;
                               BEGIN
                                 CLEAR(ReversalEntry);
                                 IF Reversed THEN
                                   ReversalEntry.AlreadyReversedEntry(TABLECAPTION,"Entry No.");
                                 IF "Journal Batch Name" = '' THEN
                                   ReversalEntry.TestFieldError;
                                 FADeprBook.GET("FA No.","Depreciation Book Code");
                                 IF FADeprBook."Disposal Date" > 0D THEN
                                   ERROR(Text002);
                                 IF "Transaction No." = 0 THEN
                                   ERROR(
                                     STRSUBSTNO(Text000,TABLECAPTION,"Entry No.") + ' ' +
                                     STRSUBSTNO(Text001,DeprBook.TABLECAPTION,"Depreciation Book Code"));
                                 TESTFIELD("G/L Entry No.");
                                 ReversalEntry.ReverseTransaction("Transaction No.");
                               END;
                                }
      { 18      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 8   ;2   ;Field     ;
                SourceExpr="FA Posting Date" }

    { 12  ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 16  ;2   ;Field     ;
                SourceExpr="Document No." }

    { 6   ;2   ;Field     ;
                SourceExpr="FA No." }

    { 27  ;2   ;Field     ;
                SourceExpr="Depreciation Book Code" }

    { 22  ;2   ;Field     ;
                SourceExpr="FA Posting Category" }

    { 29  ;2   ;Field     ;
                SourceExpr="FA Posting Type" }

    { 20  ;2   ;Field     ;
                SourceExpr=Description }

    { 52  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code";
                Visible=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr=Amount }

    { 30  ;2   ;Field     ;
                SourceExpr="Reclassification Entry" }

    { 26  ;2   ;Field     ;
                SourceExpr="Index Entry";
                Visible=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="No. of Depreciation Days" }

    { 84  ;2   ;Field     ;
                SourceExpr="Bal. Account Type";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Bal. Account No.";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="User ID";
                Visible=FALSE }

    { 78  ;2   ;Field     ;
                SourceExpr="Source Code";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr=Reversed;
                Visible=FALSE }

    { 43  ;2   ;Field     ;
                SourceExpr="Reversed by Entry No.";
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Reversed Entry No.";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 4   ;2   ;Field     ;
                SourceExpr="G/L Entry No." }

    { 2   ;2   ;Field     ;
                SourceExpr="Entry No." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      FALedgEntry@1000000000 : Record 5601;
      Navigate@1000000001 : Form 344;
      CancelFAEntries@1000000002 : Report 5686;
      Text000@1000000003 : TextConst 'ENU=You cannot undo the %1 No. %2 by using the reversing function;THA=คุณไม่สามารถยกเลิก %1 หมายเลข %2 ด้วยการใช้ฟังก์ชันการย้อนหลัง';
      Text001@1000000004 : TextConst 'ENU=because %1 %2 does not have the appropriate G/L integration setup.;THA=เนื่องจาก %1 %2 ไม่มีการเซ็ตอัพการรวม G/L ที่เหมาะสม';
      Text002@1000000005 : TextConst 'ENU=You cannot reverse the transaction because the fixed asset has been sold.;THA=คุณไม่สามารถย้อนกลับธุรกิจได้เนื่องจากมีการขายสินทรัพย์ถาวรแล้ว';

    BEGIN
    {
      Burda
      001  11.07.2007  KKE  -Hide function "Reverse Transaction"
    }
    END.
  }
}

OBJECT Page 5610 Depreciation Book Card
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Depreciation Book Card;
               THA=บัตรสมุดบัญชีค่าเสื่อมราคา];
    SourceTable=Table5611;
    PageType=Card;
    RefreshOnActivate=Yes;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Depr. Book;
                                 THA=&สมุดบัญชีค่าเสื่อมราคา] }
      { 61      ;2   ;Action    ;
                      Ellipsis=No;
                      CaptionML=[ENU=FA Posting Type Setup;
                                 THA=เซ็ตอัพชนิดการลงรายการบัญชี FA];
                      RunObject=Page 5608;
                      RunFormLink=Depreciation Book Code=FIELD(Code) }
      { 16      ;2   ;Action    ;
                      CaptionML=[ENU=FA &Journal Setup;
                                 THA=เซ็ตอัพ&สมุดรายวัน FA];
                      RunObject=Page 5609;
                      RunFormLink=Depreciation Book Code=FIELD(Code) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 40      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 41      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create FA Depreciation Books;
                                 THA=สร้างสมุดบัญชีค่าเสื่อมราคา FA];
                      RunObject=Report 5689 }
      { 19      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=C&opy Depreciation Book;
                                 THA=คั&ดลอกสมุดบัญชีค่าเสื่อมราคา];
                      RunObject=Report 5687 }
      { 18      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=C&ancel FA Ledger Entries;
                                 THA=ยกเ&ลิกรายการบัญชีแยกประเภท FA];
                      RunObject=Report 5688 }
      { 55      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Co&py FA Entries to G/L Budget;
                                 THA=คัด&ลอกรายการ FA ไปที่งบประมาณ G/L];
                      RunObject=Report 5684 }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 6   ;2   ;Field     ;
                SourceExpr="Default Final Rounding Amount" }

    { 8   ;2   ;Field     ;
                SourceExpr="Default Ending Book Value" }

    { 10  ;2   ;Field     ;
                SourceExpr="Disposal Calculation Method" }

    { 53  ;2   ;Field     ;
                SourceExpr="Subtract Disc. in Purch. Inv." }

    { 1000000000;2;Field  ;
                SourceExpr="No. of Days in Fiscal Year" }

    { 56  ;2   ;Field     ;
                SourceExpr="Allow Correction of Disposal" }

    { 39  ;2   ;Field     ;
                SourceExpr="Allow Changes in Depr. Fields" }

    { 68  ;2   ;Field     ;
                SourceExpr="VAT on Net Disposal Entries" }

    { 64  ;2   ;Field     ;
                SourceExpr="Allow Identical Document No." }

    { 45  ;2   ;Field     ;
                SourceExpr="Allow Indexation" }

    { 43  ;2   ;Field     ;
                SourceExpr="Allow Depr. below Zero" }

    { 62  ;2   ;Field     ;
                SourceExpr="Allow more than 360/365 Days" }

    { 35  ;2   ;Field     ;
                SourceExpr="Use FA Ledger Check" }

    { 49  ;2   ;Field     ;
                SourceExpr="Use Rounding in Periodic Depr." }

    { 22  ;2   ;Field     ;
                SourceExpr="Use Same FA+G/L Posting Dates" }

    { 66  ;2   ;Field     ;
                SourceExpr="Fiscal Year 365 Days" }

    { 1905052801;1;Group  ;
                CaptionML=[ENU=Integration;
                           THA=การรวม] }

    { 26  ;2   ;Group     ;
                CaptionML=[ENU=G/L Integration;
                           THA=การรวม G/L] }

    { 17  ;3   ;Field     ;
                CaptionML=[ENU=Acquisition Cost;
                           THA=ต้นทุนการซื้อ];
                SourceExpr="G/L Integration - Acq. Cost" }

    { 29  ;3   ;Field     ;
                CaptionML=[ENU=Depreciation;
                           THA=ค่าเสื่อมราคา];
                SourceExpr="G/L Integration - Depreciation" }

    { 27  ;3   ;Field     ;
                CaptionML=[ENU=Write-Down;
                           THA=การลดมูลค่าของสินทรัพย์ในบัญชี];
                SourceExpr="G/L Integration - Write-Down" }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=Appreciation;
                           THA=การเพิ่มค่า];
                SourceExpr="G/L Integration - Appreciation" }

    { 32  ;3   ;Field     ;
                CaptionML=[ENU=Custom 1;
                           THA=ภาษี 1];
                SourceExpr="G/L Integration - Custom 1" }

    { 34  ;3   ;Field     ;
                CaptionML=[ENU=Custom 2;
                           THA=ภาษี 2];
                SourceExpr="G/L Integration - Custom 2" }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Disposal;
                           THA=การขายทิ้ง];
                SourceExpr="G/L Integration - Disposal" }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=Maintenance;
                           THA=การบำรุงรักษา];
                SourceExpr="G/L Integration - Maintenance" }

    { 1907428201;1;Group  ;
                CaptionML=[ENU=Duplication;
                           THA=การทำสำเนา] }

    { 28  ;2   ;Field     ;
                SourceExpr="Part of Duplication List" }

    { 20  ;2   ;Field     ;
                SourceExpr="Use FA Exch. Rate in Duplic." }

    { 24  ;2   ;Field     ;
                SourceExpr="Default Exchange Rate" }

    { 1904488501;1;Group  ;
                CaptionML=[ENU=Reporting;
                           THA=การรายงาน] }

    { 13  ;2   ;Group     ;
                CaptionML=[ENU=Use Add.-Curr Exch. Rate;
                           THA=ใช้อัตราแลกเปลี่ยนสกุลเงินเพิ่มเติม] }

    { 12  ;3   ;Field     ;
                CaptionML=[ENU=Acquisition Cost;
                           THA=ต้นทุนการซื้อ];
                SourceExpr="Add-Curr Exch Rate - Acq. Cost" }

    { 14  ;3   ;Field     ;
                CaptionML=[ENU=Depreciation;
                           THA=ค่าเสื่อมราคา];
                SourceExpr="Add.-Curr. Exch. Rate - Depr." }

    { 15  ;3   ;Field     ;
                CaptionML=[ENU=Write-Down;
                           THA=การลดมูลค่าของสินทรัพย์ในบัญชี];
                SourceExpr="Add-Curr Exch Rate -Write-Down" }

    { 33  ;3   ;Field     ;
                CaptionML=[ENU=Appreciation;
                           THA=การเพิ่มค่า];
                SourceExpr="Add-Curr. Exch. Rate - Apprec." }

    { 47  ;3   ;Field     ;
                CaptionML=[ENU=Custom 1;
                           THA=ภาษี 1];
                SourceExpr="Add-Curr. Exch Rate - Custom 1" }

    { 48  ;3   ;Field     ;
                CaptionML=[ENU=Custom 2;
                           THA=ภาษี 2];
                SourceExpr="Add-Curr. Exch Rate - Custom 2" }

    { 51  ;3   ;Field     ;
                CaptionML=[ENU=Disposal;
                           THA=การขายทิ้ง];
                SourceExpr="Add.-Curr. Exch. Rate - Disp." }

    { 52  ;3   ;Field     ;
                CaptionML=[ENU=Maintenance;
                           THA=การบำรุงรักษา];
                SourceExpr="Add.-Curr. Exch. Rate - Maint." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 5628 Fixed Asset G/L Journal
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,NAVAP4.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Fixed Asset G/L Journal;
               THA=สมุดรายวันใน G/L ของสินทรัพย์ถาวร];
    SaveValues=Yes;
    SourceTable=Table81;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnInit=BEGIN
             TotalBalanceVisible := TRUE;
             BalanceVisible := TRUE;
           END;

    OnOpenPage=VAR
                 JnlSelected@1000000000 : Boolean;
               BEGIN
                 BalAccountName := '';
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Journal Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 GenJnlManagement.TemplateSelection(FORM::"Fixed Asset G/L Journal",5,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  UpdateBalance;
                  SetUpNewLine(xRec,Balance,BelowxRec);
                  CLEAR(ShortcutDimCode);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 121     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 122     ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 545;
                      RunFormLink=Table ID=CONST(81),Journal Template Name=FIELD(Journal Template Name),Journal Batch Name=FIELD(Journal Batch Name),Journal Line No.=FIELD(Line No.);
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process }
      { 43      ;1   ;ActionGroup;
                      CaptionML=[ENU=A&ccount;
                                 THA=&บัญชี] }
      { 44      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Codeunit 15;
                      Image=EditLines }
      { 45      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Codeunit 14;
                      Promoted=No;
                      Image=GLRegisters;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 100     ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟั&งก์ชัน] }
      { 123     ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      RunObject=Codeunit 225;
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process }
      { 107     ;2   ;Action    ;
                      CaptionML=[ENU=Insert FA &Bal. Account;
                                 THA=แทรกบัญชีดุล &FA];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 GenJnlLine@1000000001 : Record 81;
                                 FAGetBalAcc@1000000002 : Codeunit 5603;
                               BEGIN
                                 GenJnlLine.COPY(Rec);
                                 CurrPage.SETSELECTIONFILTER(GenJnlLine);
                                 FAGetBalAcc.InsertAcc(GenJnlLine);
                               END;
                                }
      { 124     ;2   ;Action    ;
                      CaptionML=[ENU=Insert Conv. LCY Rndg. Lines;
                                 THA=แทรกบรรทัดการปัดเศษจากการแปลง LCY];
                      RunObject=Codeunit 407 }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=ก&ารลงรายการบัญชี] }
      { 48      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      CaptionML=[ENU=Reconcile;
                                 THA=กระทบยอด];
                      Image=Reconcile;
                      OnAction=BEGIN
                                 GLReconcile.SetGenJnlLine(Rec);
                                 GLReconcile.RUN;
                               END;
                                }
      { 49      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintGenJnlLine(Rec);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ล&งรายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 51      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 39  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           THA=ชื่อชุดงาน];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             GenJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                               CurrentJnlBatchNameOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           GenJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 83  ;2   ;Field     ;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 6   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 81  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Account Type";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccountName);
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr="Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccountName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 87  ;2   ;Field     ;
                SourceExpr="Depreciation Book Code" }

    { 85  ;2   ;Field     ;
                SourceExpr="FA Posting Type" }

    { 75  ;2   ;Field     ;
                CaptionML=[ENU=FA Add.-Currency Code;
                           THA=รหัสสกุลเงินเพิ่มเติมสำหรับ FA];
                SourceExpr=GetAddCurrCode;
                Visible=FALSE;
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameterFA("FA Add.-Currency Factor",GetAddCurrCode,"Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "FA Add.-Currency Factor" := ChangeExchangeRate.GetParameter;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 12  ;2   ;Field     ;
                SourceExpr=Description }

    { 71  ;2   ;Field     ;
                SourceExpr="Business Unit Code";
                Visible=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Salespers./Purch. Code";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Campaign No.";
                Visible=FALSE }

    { 67  ;2   ;Field     ;
                AssistEdit=Yes;
                SourceExpr="Currency Code";
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 14  ;2   ;Field     ;
                SourceExpr="Gen. Posting Type" }

    { 77  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 16  ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 97  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 115 ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr=Amount }

    { 126 ;2   ;Field     ;
                SourceExpr="VAT Amount";
                Visible=FALSE }

    { 130 ;2   ;Field     ;
                SourceExpr="VAT Difference";
                Visible=FALSE }

    { 128 ;2   ;Field     ;
                SourceExpr="Bal. VAT Amount";
                Visible=FALSE }

    { 132 ;2   ;Field     ;
                SourceExpr="Bal. VAT Difference";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Bal. Account Type" }

    { 55  ;2   ;Field     ;
                SourceExpr="Bal. Account No.";
                OnValidate=BEGIN
                             GenJnlManagement.GetAccounts(Rec,AccName,BalAccountName);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 57  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Posting Type" }

    { 59  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Prod. Posting Group" }

    { 117 ;2   ;Field     ;
                SourceExpr="Bal. VAT Bus. Posting Group";
                Visible=FALSE }

    { 119 ;2   ;Field     ;
                SourceExpr="Bal. VAT Prod. Posting Group";
                Visible=FALSE }

    { 79  ;2   ;Field     ;
                SourceExpr="Bal. Gen. Bus. Posting Group" }

    { 69  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No.";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Applies-to ID";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="On Hold";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Bank Payment Type";
                Visible=FALSE }

    { 73  ;2   ;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 41  ;2   ;Field     ;
                SourceExpr="FA Posting Date";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 89  ;2   ;Field     ;
                SourceExpr="Salvage Value";
                Visible=FALSE }

    { 91  ;2   ;Field     ;
                SourceExpr="No. of Depreciation Days" }

    { 93  ;2   ;Field     ;
                SourceExpr="Depr. until FA Posting Date" }

    { 95  ;2   ;Field     ;
                SourceExpr="Depr. Acquisition Cost" }

    { 101 ;2   ;Field     ;
                SourceExpr="Maintenance Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 103 ;2   ;Field     ;
                SourceExpr="Insurance No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 105 ;2   ;Field     ;
                SourceExpr="Budgeted FA No." }

    { 98  ;2   ;Field     ;
                SourceExpr="Duplicate in Depreciation Book";
                Visible=FALSE }

    { 109 ;2   ;Field     ;
                SourceExpr="Use Duplication List";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                SourceExpr="FA Reclassification Entry" }

    { 113 ;2   ;Field     ;
                SourceExpr="FA Error Entry No." }

    { 30  ;1   ;Group      }

    { 1901776101;2;Group  ;
                GroupType=FixedLayout }

    { 1900545301;3;Group  ;
                CaptionML=[ENU=Account Name;
                           THA=ชื่อบัญชี] }

    { 35  ;4   ;Field     ;
                SourceExpr=AccName;
                Editable=FALSE }

    { 1900295701;3;Group  ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล] }

    { 37  ;4   ;Field     ;
                CaptionML=[ENU=Bal. Account Name;
                           THA=ชื่อบัญชีดุล];
                SourceExpr=BalAccountName;
                Editable=FALSE }

    { 1902759701;3;Group  ;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ] }

    { 31  ;4   ;Field     ;
                Name=Balance;
                CaptionML=[ENU=Balance;
                           THA=ยอดคงเหลือ];
                SourceExpr=Balance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=BalanceVisible;
                Editable=FALSE }

    { 1901652501;3;Group  ;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล] }

    { 33  ;4   ;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance;
                           THA=รวมดุล];
                SourceExpr=TotalBalance+"Balance (LCY)"-xRec."Balance (LCY)";
                AutoFormatType=1;
                Visible=TotalBalanceVisible;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      GLSetup@1000000000 : Record 98;
      ChangeExchangeRate@1000000001 : Form 511;
      GLReconcile@1000000002 : Form 345;
      GenJnlManagement@1000000003 : Codeunit 230;
      ReportPrint@1000000004 : Codeunit 228;
      CurrentJnlBatchName@1000000005 : Code[10];
      AccName@1000000006 : Text[50];
      BalAccountName@1000000007 : Text[50];
      Balance@1000000008 : Decimal;
      TotalBalance@1000000009 : Decimal;
      ShowBalance@1000000010 : Boolean;
      ShowTotalBalance@1000000011 : Boolean;
      AddCurrCodeIsFound@1000000012 : Boolean;
      ShortcutDimCode@1000000013 : ARRAY [8] OF Code[20];
      GenJnlLine@1000000014 : Record 81;
      OpenedFromBatch@1000000015 : Boolean;
      BalanceVisible@19073040 : Boolean INDATASET;
      TotalBalanceVisible@19063333 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateBalance@1();
    BEGIN
      GenJnlManagement.CalcBalance(Rec,xRec,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      BalanceVisible := ShowBalance;
      TotalBalanceVisible := ShowTotalBalance;
    END;

    PROCEDURE GetAddCurrCode@2() : Code[10];
    BEGIN
      IF NOT AddCurrCodeIsFound THEN BEGIN
        AddCurrCodeIsFound := TRUE;
        GLSetup.GET;
      END;
      EXIT(GLSetup."Additional Reporting Currency");
    END;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      GenJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      GenJnlManagement.GetAccounts(Rec,AccName,BalAccountName);
      UpdateBalance;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 5629 Fixed Asset Journal
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,NAVAP4.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Fixed Asset Journal;
               THA=สมุดรายวันสินทรัพย์ถาวร];
    SaveValues=Yes;
    SourceTable=Table5621;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnOpenPage=VAR
                 JnlSelected@1000000000 : Boolean;
               BEGIN
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Journal Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   FAJnlManagement.OpenJournal(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 FAJnlManagement.TemplateSelection(FORM::"Fixed Asset Journal",FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 FAJnlManagement.OpenJournal(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  SetUpNewLine(xRec);
                  CLEAR(ShortcutDimCode);
                  OnAfterGetCurrRecord;
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 60      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 61      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 545;
                      RunFormLink=Table ID=CONST(5621),Journal Template Name=FIELD(Journal Template Name),Journal Batch Name=FIELD(Journal Batch Name),Journal Line No.=FIELD(Line No.);
                      Image=Dimensions }
      { 44      ;1   ;ActionGroup;
                      CaptionML=[ENU=Fixed &Asset;
                                 THA=สินทรัพย์&ถาวร] }
      { 46      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=&Card;
                                 THA=&บัตร];
                      RunObject=Page 5600;
                      RunFormLink=No.=FIELD(FA No.);
                      Image=EditLines }
      { 47      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      RunObject=Codeunit 5634 }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=ก&ารลงรายการบัญชี] }
      { 49      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Test Report;
                                 THA=&รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintFAJnlLine(Rec);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 THA=ล&งรายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"FA. Jnl.-Post",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 51      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"FA. Jnl.-Post+Print",Rec);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 COMMIT;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 42  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           THA=ชื่อชุดงาน];
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             FAJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                               CurrentJnlBatchNameOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           FAJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr="FA Posting Date" }

    { 58  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                SourceExpr="Document Type" }

    { 7   ;2   ;Field     ;
                SourceExpr="Document No." }

    { 9   ;2   ;Field     ;
                SourceExpr="FA No.";
                OnValidate=BEGIN
                             FAJnlManagement.GetFA("FA No.",FADescription);
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 17  ;2   ;Field     ;
                SourceExpr="Depreciation Book Code" }

    { 11  ;2   ;Field     ;
                SourceExpr="FA Posting Type" }

    { 13  ;2   ;Field     ;
                SourceExpr=Description }

    { 15  ;2   ;Field     ;
                SourceExpr=Amount }

    { 54  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

    { 19  ;2   ;Field     ;
                SourceExpr="Salvage Value";
                Visible=FALSE }

    { 23  ;2   ;Field     ;
                SourceExpr="No. of Depreciation Days" }

    { 29  ;2   ;Field     ;
                SourceExpr="Depr. until FA Posting Date" }

    { 31  ;2   ;Field     ;
                SourceExpr="Depr. Acquisition Cost" }

    { 25  ;2   ;Field     ;
                SourceExpr="Maintenance Code";
                Visible=FALSE;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 27  ;2   ;Field     ;
                SourceExpr="Insurance No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 36  ;2   ;Field     ;
                SourceExpr="Budgeted FA No." }

    { 52  ;2   ;Field     ;
                SourceExpr="Duplicate in Depreciation Book" }

    { 38  ;2   ;Field     ;
                SourceExpr="Use Duplication List";
                Visible=FALSE }

    { 21  ;2   ;Field     ;
                SourceExpr="FA Reclassification Entry" }

    { 33  ;2   ;Field     ;
                SourceExpr="FA Error Entry No." }

    { 2   ;1   ;Group      }

    { 1900116601;2;Group  ;
                GroupType=FixedLayout }

    { 1901313201;3;Group  ;
                CaptionML=[ENU=FA Description;
                           THA=คำอธิบาย FA] }

    { 40  ;4   ;Field     ;
                SourceExpr=FADescription;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      FAJnlManagement@1000000000 : Codeunit 5638;
      ReportPrint@1000000001 : Codeunit 228;
      CurrentJnlBatchName@1000000002 : Code[10];
      FADescription@1000000003 : Text[30];
      ShortcutDimCode@1000000004 : ARRAY [8] OF Code[20];
      GenJnlLine@1000000005 : Record 81;
      OpenedFromBatch@1000000006 : Boolean;

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      FAJnlManagement.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      xRec := Rec;
      FAJnlManagement.GetFA("FA No.",FADescription);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 5666 FA Depreciation Books Subform
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    LinksAllowed=No;
    SourceTable=Table5612;
    DelayedInsert=Yes;
    DataCaptionFields=FA No.,Depreciation Book Code;
    PageType=ListPart;
    RefreshOnActivate=Yes;
    OnAfterGetRecord=BEGIN
                       Disposed := "Disposal Date" > 0D;
                       IF Disposed THEN
                         "Book Value" := 0;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1907746904;1 ;ActionGroup;
                      CaptionML=[ENU=&Depr. Book;
                                 THA=&สมุดบัญชีค่าเสื่อมราคา] }
      { 1900295504;2 ;Action    ;
                      CaptionML=[ENU=Ledger E&ntries;
                                 THA=รายการ&บัญชีแยกประเภท];
                      OnAction=BEGIN
                                 //This functionality was copied from page #5600. Unsupported part was commented. Please check it.
                                 {CurrPage.DepreciationBook.FORM.}
                                 ShowFALedgEntries;
                               END;
                                }
      { 1901741904;2 ;Action    ;
                      CaptionML=[ENU=Error Ledger Entries;
                                 THA=รายการบัญชีแยกประเภทที่ผิดพลาด];
                      OnAction=BEGIN
                                 //This functionality was copied from page #5600. Unsupported part was commented. Please check it.
                                 {CurrPage.DepreciationBook.FORM.}
                                 ShowFAErrorLedgEntries;
                               END;
                                }
      { 1903866604;2 ;Action    ;
                      CaptionML=[ENU=Maintenance Ledger Entries;
                                 THA=รายการบัญชีแยกประเภทการบำรุงรักษา];
                      Image=MaintenanceLedgerEntries;
                      OnAction=BEGIN
                                 //This functionality was copied from page #5600. Unsupported part was commented. Please check it.
                                 {CurrPage.DepreciationBook.FORM.}
                                 ShowMaintenanceLedgEntries;
                               END;
                                }
      { 1902759404;2 ;Action    ;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //This functionality was copied from page #5600. Unsupported part was commented. Please check it.
                                 {CurrPage.DepreciationBook.FORM.}
                                 ShowStatistics;
                               END;
                                }
      { 1901991404;2 ;Action    ;
                      CaptionML=[ENU=Main &Asset Statistics;
                                 THA=ส&ถิติสินทรัพย์หลัก];
                      OnAction=BEGIN
                                 //This functionality was copied from page #5600. Unsupported part was commented. Please check it.
                                 {CurrPage.DepreciationBook.FORM.}
                                 ShowMainAssetStatistics;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 4   ;2   ;Field     ;
                SourceExpr="Depreciation Book Code";
                Editable=TRUE }

    { 67  ;2   ;Field     ;
                CaptionML=[ENU=FA Add.-Currency Code;
                           THA=รหัสสกุลเงินเพิ่มเติมสำหรับ FA];
                SourceExpr=GetAddCurrCode;
                Visible=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameterFA("FA Add.-Currency Factor",GetAddCurrCode,WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "FA Add.-Currency Factor" := ChangeExchangeRate.GetParameter;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 6   ;2   ;Field     ;
                SourceExpr="FA Posting Group" }

    { 8   ;2   ;Field     ;
                SourceExpr="Depreciation Method" }

    { 10  ;2   ;Field     ;
                SourceExpr="Depreciation Starting Date" }

    { 33  ;2   ;Field     ;
                SourceExpr="Depreciation Ending Date";
                Visible=TRUE }

    { 14  ;2   ;Field     ;
                SourceExpr="No. of Depreciation Years" }

    { 16  ;2   ;Field     ;
                SourceExpr="No. of Depreciation Months";
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Salvage Value" }

    { 12  ;2   ;Field     ;
                SourceExpr="Straight-Line %";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Fixed Depr. Amount";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Declining-Balance %";
                Visible=FALSE }

    { 37  ;2   ;Field     ;
                SourceExpr="First User-Defined Depr. Date";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                CaptionML=[ENU=Disposed Of;
                           THA=ขายทิ้ง];
                SourceExpr=Disposed;
                Editable=FALSE }

    { 2   ;2   ;Field     ;
                SourceExpr="Book Value";
                OnDrillDown=VAR
                              FALedgEntry@1000000001 : Record 5601;
                            BEGIN
                              IF ("Disposal Date" > 0D) THEN
                                ShowBookValueAfterDisposal
                              ELSE BEGIN
                                FALedgEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","Part of Book Value","FA Posting Date");
                                FALedgEntry.SETRANGE("FA No.","FA No.");
                                FALedgEntry.SETRANGE("Depreciation Book Code","Depreciation Book Code");
                                FALedgEntry.SETRANGE("Part of Book Value",TRUE);
                                FORM.RUN(0,FALedgEntry);
                              END;
                            END;
                             }

    { 22  ;2   ;Field     ;
                SourceExpr="Depreciation Table Code";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Final Rounding Amount";
                Visible=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Ending Book Value";
                Visible=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Ignore Def. Ending Book Value";
                Visible=FALSE }

    { 31  ;2   ;Field     ;
                SourceExpr="FA Exchange Rate";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                SourceExpr="Use FA Ledger Check";
                Visible=FALSE }

    { 41  ;2   ;Field     ;
                SourceExpr="Depr. below Zero %";
                Visible=FALSE }

    { 39  ;2   ;Field     ;
                SourceExpr="Fixed Depr. Amount below Zero";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Projected Disposal Date";
                Visible=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Projected Proceeds on Disposal";
                Visible=FALSE }

    { 49  ;2   ;Field     ;
                SourceExpr="Depr. Starting Date (Custom 1)";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="Depr. Ending Date (Custom 1)";
                Visible=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Accum. Depr. % (Custom 1)";
                Visible=FALSE }

    { 55  ;2   ;Field     ;
                SourceExpr="Depr. This Year % (Custom 1)";
                Visible=FALSE }

    { 57  ;2   ;Field     ;
                SourceExpr="Property Class (Custom 1)";
                Visible=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Use Half-Year Convention";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Use DB% First Fiscal Year";
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr="Temp. Ending Date";
                Visible=FALSE }

    { 47  ;2   ;Field     ;
                SourceExpr="Temp. Fixed Depr. Amount";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      GLSetup@1000000000 : Record 98;
      FALedgEntry@1000000001 : Record 5601;
      MaintenanceLedgEntry@1000000002 : Record 5625;
      FADeprBook@1000000003 : Record 5612;
      DepreciationCalc@1000000004 : Codeunit 5616;
      ChangeExchangeRate@1000000005 : Form 511;
      AddCurrCodeIsFound@1000000006 : Boolean;
      Disposed@1000000007 : Boolean;

    PROCEDURE GetAddCurrCode@1() : Code[10];
    BEGIN
      IF NOT AddCurrCodeIsFound THEN
        GLSetup.GET;
      EXIT(GLSetup."Additional Reporting Currency");
    END;

    PROCEDURE ShowFALedgEntries@2();
    BEGIN
      DepreciationCalc.SetFAFilter(FALedgEntry,"FA No.","Depreciation Book Code",FALSE);
      FORM.RUN(FORM::"FA Ledger Entries",FALedgEntry);
    END;

    PROCEDURE ShowFAErrorLedgEntries@3();
    BEGIN
      FALedgEntry.RESET;
      FALedgEntry.SETCURRENTKEY("Canceled from FA No.");
      FALedgEntry.SETRANGE("Canceled from FA No.","FA No.");
      FALedgEntry.SETRANGE("Depreciation Book Code","Depreciation Book Code");
      FORM.RUN(FORM::"FA Error Ledger Entries",FALedgEntry);
    END;

    PROCEDURE ShowMaintenanceLedgEntries@4();
    BEGIN
      MaintenanceLedgEntry.SETCURRENTKEY("FA No.","Depreciation Book Code");
      MaintenanceLedgEntry.SETRANGE("FA No.","FA No.");
      MaintenanceLedgEntry.SETRANGE("Depreciation Book Code","Depreciation Book Code");
      FORM.RUN(FORM::"Maintenance Ledger Entries",MaintenanceLedgEntry);
    END;

    PROCEDURE ShowStatistics@5();
    BEGIN
      FADeprBook.SETRANGE("FA No.","FA No.");
      FADeprBook.SETRANGE("Depreciation Book Code","Depreciation Book Code");
      FORM.RUN(FORM::"Fixed Asset Statistics",FADeprBook);
    END;

    PROCEDURE ShowMainAssetStatistics@6();
    BEGIN
      FADeprBook.SETRANGE("FA No.","FA No.");
      FADeprBook.SETRANGE("Depreciation Book Code","Depreciation Book Code");
      FORM.RUN(FORM::"Main Asset Statistics",FADeprBook);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 5800 Item Charges
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW13.00,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Item Charges;
               THA=ค่าธรรมเนียมสินค้า];
    SourceTable=Table5800;
    PageType=List;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 15      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Item Charge;
                                 THA=&ค่าธรรมเนียมสินค้า] }
      { 17      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Value E&ntries;
                                 THA=รายการ&บัญชีแสดงมูลค่า];
                      RunObject=Page 5802;
                      RunFormView=SORTING(Item Charge No.);
                      RunFormLink=Entry Type=CONST(Direct Cost),Item Charge No.=FIELD(No.);
                      Image=ValueLedger }
      { 19      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 540;
                      RunFormLink=Table ID=CONST(5800),No.=FIELD(No.);
                      Image=Dimensions }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 6   ;2   ;Field     ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 8   ;2   ;Field     ;
                SourceExpr="Tax Group Code";
                Visible=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="WHT Product Posting Group" }

    { 10  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group" }

    { 16  ;2   ;Field     ;
                SourceExpr="Search Description" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 6630 Sales Return Order
{
  OBJECT-PROPERTIES
  {
    Date=12/14/11;
    Time=10:30:57 AM;
    Version List=NAVW16.00,NAVAP6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales Return Order;
               THA=ใบสั่งส่งคืนสินค้าขาย];
    SourceTable=Table36;
    SourceTableView=WHERE(Document Type=FILTER(Return Order));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 IF UserMgt.GetSalesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetSalesFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetSalesFilter;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 49      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Ret. Order;
                                 THA=&ใบสั่งส่งคืนสินค้า] }
      { 51      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Sales Order Statistics",Rec);
                               END;
                                }
      { 52      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 21;
                      RunFormLink=No.=FIELD(Sell-to Customer No.);
                      Image=EditLines }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=CONST(Return Order),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 5801    ;2   ;Action    ;
                      CaptionML=[ENU=Return Receipts;
                                 THA=ใบรับสินค้าส่งคืน];
                      RunObject=Page 6662;
                      RunFormView=SORTING(Return Order No.);
                      RunFormLink=Return Order No.=FIELD(No.) }
      { 5802    ;2   ;Action    ;
                      CaptionML=[ENU=Cred&it Memos;
                                 THA=&ใบลดหนี้];
                      RunObject=Page 144;
                      RunFormView=SORTING(Return Order No.);
                      RunFormLink=Return Order No.=FIELD(No.);
                      Image=CreditMemo }
      { 105     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 140     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1000000001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Sales Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 131     ;2   ;Separator  }
      { 120     ;2   ;Action    ;
                      CaptionML=[ENU=Whse. Receipt Lines;
                                 THA=บรรทัดใบรับของคลังสินค้า];
                      RunObject=Page 7342;
                      RunFormView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunFormLink=Source Type=CONST(37),Source Subtype=FIELD(Document Type),Source No.=FIELD(No.) }
      { 130     ;2   ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 THA=&บรรทัดการย้ายเก็บ/การรับสินค้าคงคลัง];
                      RunObject=Page 5774;
                      RunFormView=SORTING(Source Document,Source No.,Location Code);
                      RunFormLink=Source Document=CONST(Sales Return Order),Source No.=FIELD(No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 54      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟัง&ก์ชัน] }
      { 55      ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 132     ;2   ;Separator  }
      { 93      ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Sales Header Apply",Rec);
                               END;
                                }
      { 115     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Return-Related &Documents;
                                 THA=สร้างเอกสารที่เกี่ยวข้องกับ&การส่งคืนสินค้า];
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CLEAR(CreateRetRelDocs);
                                 CreateRetRelDocs.SetSalesHeader(Rec);
                                 CreateRetRelDocs.RUNMODAL;
                                 CreateRetRelDocs.ShowDocuments;
                               END;
                                }
      { 133     ;2   ;Separator  }
      { 56      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopySalesDoc.SetSalesHeader(Rec);
                                 CopySalesDoc.RUNMODAL;
                                 CLEAR(CopySalesDoc);
                               END;
                                }
      { 145     ;2   ;Action    ;
                      CaptionML=[ENU=Archive Document;
                                 THA=เก็บถาวรเอกสาร];
                      OnAction=BEGIN
                                 ArchiveManagement.ArchiveSalesDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 118     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 THA=ย้ายบรรทัดที่มีค่าลบ];
                      OnAction=BEGIN
                                 CLEAR(MoveNegSalesLines);
                                 MoveNegSalesLines.SetSalesHeader(Rec);
                                 MoveNegSalesLines.RUNMODAL;
                                 MoveNegSalesLines.ShowDocument;
                               END;
                                }
      { 139     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Posted Doc&ument Lines to Reverse;
                                 THA=เรียกบรรทัดเอกสารที่ลงรายการบัญชี&ที่จะกลับรายการ];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReverseLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 GetPstdDocLinesToRevere;
                               END;
                                }
      { 135     ;2   ;Separator  }
      { 122     ;2   ;Action    ;
                      CaptionML=[ENU=Create &Whse. Receipt;
                                 THA=สร้างใบรับสินค้าของ&คลังสินค้า];
                      OnAction=VAR
                                 GetSourceDocInbound@1000000001 : Codeunit 5751;
                               BEGIN
                                 GetSourceDocInbound.CreateFromSalesReturnOrder(Rec);
                               END;
                                }
      { 121     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away / Pick;
                                 THA=สร้างการย้ายเก็บ / การรับสินค้าคง&คลัง];
                      Image=CreateInventoryPickup;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;
                               END;
                                }
      { 136     ;2   ;Separator  }
      { 142     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1000000001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.SendSalesApprovalRequest(Rec) THEN;
                               END;
                                }
      { 143     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1000000001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.CancelSalesApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 30      ;2   ;Separator  }
      { 112     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Image=ReleaseDoc;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000000001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 113     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleaseSalesDoc@1000000001 : Codeunit 414;
                               BEGIN
                                 ReleaseSalesDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 600     ;2   ;Separator  }
      { 31      ;2   ;Action    ;
                      CaptionML=[ENU=Send IC Return Order Cnfmn.;
                                 THA=ส่งการยืนยันใบสั่งส่งคืนสินค้า IC];
                      OnAction=VAR
                                 ICInOutboxMgt@1000000001 : Codeunit 427;
                                 PurchaseHeader@1000000002 : Record 38;
                                 ApprovalMgt@1000000003 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   ICInOutboxMgt.SendSalesDoc(Rec,FALSE);
                               END;
                                }
      { 59      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การ&ลงรายการบัญชี] }
      { 60      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintSalesHeader(Rec);
                               END;
                                }
      { 61      ;2   ;Action    ;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 THA=ลง&รายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseHeader@1000000001 : Record 38;
                                 ApprovalMgt@1000000002 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Sales-Post (Yes/No)",Rec);
                               END;
                                }
      { 62      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 PurchaseHeader@1000000001 : Record 38;
                                 ApprovalMgt@1000000002 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(Rec,PurchaseHeader) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Sales-Post + Print",Rec);
                               END;
                                }
      { 63      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 THA=ลงรายการบัญชี&ชุดงาน];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Sales Return Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 119     ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintSalesHeader(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             SelltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 117 ;2   ;Field     ;
                SourceExpr="Sell-to Contact No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name" }

    { 65  ;2   ;Field     ;
                SourceExpr="Sell-to Address" }

    { 67  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2" }

    { 1000000000;2;Field  ;
                SourceExpr="Sell-to Address 3" }

    { 70  ;2   ;Field     ;
                SourceExpr="Sell-to Post Code" }

    { 69  ;2   ;Field     ;
                SourceExpr="Sell-to City" }

    { 1500000;2;Field     ;
                SourceExpr="Sell-to County" }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Sell-to County/Country Code;
                           THA=ขายไปที่เขต/รหัสประเทศ];
                SourceExpr="Sell-to Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Sell-to Contact" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 125 ;2   ;Field     ;
                SourceExpr="Order Date";
                Importance=Promoted }

    { 39  ;2   ;Field     ;
                SourceExpr="Document Date" }

    { 58  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                OnValidate=BEGIN
                             SalespersonCodeOnAfterValidate;
                           END;
                            }

    { 104 ;2   ;Field     ;
                SourceExpr="Campaign No." }

    { 107 ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 141 ;2   ;Field     ;
                SourceExpr="Assigned User ID" }

    { 110 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 1000000012;2;Field  ;
                SourceExpr="Applied-to Tax Invoice" }

    { 48  ;1   ;Part      ;
                Name=SalesLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page6631 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 18  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             BilltoCustomerNoOnAfterValidate;
                           END;
                            }

    { 128 ;2   ;Field     ;
                SourceExpr="Bill-to Contact No." }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Name" }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to Address" }

    { 24  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2" }

    { 1000000006;2;Field  ;
                SourceExpr="Bill-to Address 3" }

    { 75  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code" }

    { 26  ;2   ;Field     ;
                SourceExpr="Bill-to City" }

    { 1500004;2;Field     ;
                SourceExpr="Bill-to County" }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Bill-to County/Country Code;
                           THA=เรียกเก็บเงินที่เขต/รหัสประเทศ];
                SourceExpr="Bill-to Country/Region Code" }

    { 28  ;2   ;Field     ;
                SourceExpr="Bill-to Contact" }

    { 1000000010;2;Field  ;
                SourceExpr="Posting Description" }

    { 74  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 78  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 14  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type";
                Importance=Promoted }

    { 16  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No.";
                Importance=Promoted }

    { 94  ;2   ;Field     ;
                SourceExpr="Applies-to ID" }

    { 100 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 137 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1000000008;2;Field  ;
                SourceExpr="Posting No. Series" }

    { 147 ;2   ;Field     ;
                SourceExpr="No. of Archived Versions" }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Address" }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2" }

    { 1000000016;2;Field  ;
                SourceExpr="Ship-to Address 3" }

    { 83  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code" }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County" }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code" }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Contact" }

    { 80  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 96  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Importance=Promoted }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 91  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 42  ;2   ;Field     ;
                SourceExpr="EU 3-Party Trade" }

    { 44  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 89  ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 46  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 85  ;2   ;Field     ;
                SourceExpr="Exit Point" }

    { 87  ;2   ;Field     ;
                SourceExpr=Area }

    { 1902492201;1;Group  ;
                CaptionML=[ENU=Adjustment Details;
                           THA=รายละเอียดการปรับปรุง] }

    { 1500015;2;Field     ;
                SourceExpr=Adjustment }

    { 1500013;2;Field     ;
                SourceExpr="BAS Adjustment" }

    { 1500009;2;Field     ;
                SourceExpr="Adjustment Applies-to" }

    { 1500001;2;Field     ;
                SourceExpr="Reason Code" }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=Address (Thai)] }

    { 1000000014;2;Field  ;
                SourceExpr="Sell-to Name (Thai)" }

    { 1000000015;2;Field  ;
                SourceExpr="Sell-to Address (Thai)";
                MultiLine=Yes }

    { 1000000026;2;Field  ;
                SourceExpr="Bill-to Name (Thai)" }

    { 1000000027;2;Field  ;
                SourceExpr="Bill-to Address (Thai)";
                MultiLine=Yes }

    { 1000000032;2;Field  ;
                SourceExpr="Ship-to Name (Thai)" }

    { 1000000034;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1903720907;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9080;
                Visible=TRUE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubFormLink=No.=FIELD(Bill-to Customer No.);
                PagePartID=Page9082;
                Visible=FALSE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubFormLink=No.=FIELD(Sell-to Customer No.);
                PagePartID=Page9084;
                Visible=TRUE;
                PartType=Page }

    { 1906127307;1;Part   ;
                SubFormLink=Document Type=FIELD(Document Type),Document No.=FIELD(Document No.),Line No.=FIELD(Line No.);
                PagePartID=Page9087;
                ProviderID=48;
                Visible=FALSE;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(36),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1907012907;1;Part   ;
                SubFormLink=No.=FIELD(No.);
                PagePartID=Page9108;
                ProviderID=48;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesSetup@1000000000 : Record 311;
      ChangeExchangeRate@1000000001 : Form 511;
      CopySalesDoc@1000000002 : Report 292;
      MoveNegSalesLines@1000000003 : Report 6699;
      CreateRetRelDocs@1000000004 : Report 6697;
      ReportPrint@1000000005 : Codeunit 228;
      DocPrint@1000000006 : Codeunit 229;
      UserMgt@1000000007 : Codeunit 5700;
      ArchiveManagement@1000000008 : Codeunit 5063;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.SalesLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE SelltoCustomerNoOnAfterValidat@19034782();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SalespersonCodeOnAfterValidate@19011896();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE BilltoCustomerNoOnAfterValidat@19044114();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.SalesLines.FORM.UpdateForm(TRUE);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 6631 Sales Return Order Subform
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVW16.00.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    MultipleNewLines=Yes;
    LinksAllowed=No;
    SourceTable=Table37;
    DelayedInsert=Yes;
    SourceTableView=WHERE(Document Type=FILTER(Return Order));
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  Type := xRec.Type;
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveSalesLine@1000000000 : Codeunit 99000832;
                   BEGIN
                     IF (Quantity <> 0) AND ItemExists("No.") THEN BEGIN
                       COMMIT;
                       IF NOT ReserveSalesLine.DeleteLineConfirm(Rec) THEN
                         EXIT(FALSE);
                       ReserveSalesLine.DeleteLine(Rec);
                     END;
                   END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1906587504;1 ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟัง&ก์ชัน] }
      { 1901991504;2 ;Action    ;
                      CaptionML=[ENU=E&xplode BOM;
                                 THA=ข&ยาย BOM];
                      Image=ExplodeBOM;
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ExplodeBOM;
                               END;
                                }
      { 1901991804;2 ;Action    ;
                      CaptionML=[ENU=Insert &Ext. Texts;
                                 THA=แทรกข้อความ&ที่ขยายเพิ่มเติม];
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _InsertExtendedText(TRUE);
                               END;
                                }
      { 1902085804;2 ;Action    ;
                      CaptionML=[ENU=&Reserve;
                                 THA=&สำรอง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowReservation;
                               END;
                                }
      { 1906421304;2 ;Action    ;
                      CaptionML=[ENU=Order &Tracking;
                                 THA=การติดตาม&ใบสั่ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ShowTracking;
                               END;
                                }
      { 1907935204;1 ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 THA=&บรรทัด] }
      { 1907981204;2 ;ActionGroup;
                      CaptionML=[ENU=Item Availability by;
                                 THA=การมีอยู่ของสินค้าตาม] }
      { 1903587104;3 ;Action    ;
                      CaptionML=[ENU=Period;
                                 THA=รอบระยะเวลา];
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(0);
                               END;
                                }
      { 1903193004;3 ;Action    ;
                      CaptionML=[ENU=Variant;
                                 THA=ตัวแปร];
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(1);
                               END;
                                }
      { 1901743104;3 ;Action    ;
                      CaptionML=[ENU=Location;
                                 THA=ที่ตั้ง];
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ItemAvailability(2);
                               END;
                                }
      { 1902740304;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowDimensions;
                               END;
                                }
      { 1900525904;2 ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      Image=ViewComments;
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _ShowLineComments;
                               END;
                                }
      { 1907184504;2 ;Action    ;
                      CaptionML=[ENU=Item Charge &Assignment;
                                 THA=การกำหนดค่าธรรมเนียม&สินค้า];
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 ItemChargeAssgnt;
                               END;
                                }
      { 1905987604;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 THA=บรรทัด&การติดตามสินค้า];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 //This functionality was copied from page #6630. Unsupported part was commented. Please check it.
                                 {CurrPage.SalesLines.FORM.}
                                 _OpenItemTrackingLines;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr="No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                               NoOnAfterValidate;
                           END;
                            }

    { 34  ;2   ;Field     ;
                SourceExpr="Cross-Reference No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             CrossReferenceNoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           CrossReferenceNoLookUp;
                           InsertExtendedText(FALSE);
                         END;
                          }

    { 64  ;2   ;Field     ;
                SourceExpr="IC Partner Ref. Type";
                Visible=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="Gen. Prod. Posting Group" }

    { 1000000004;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1000000000;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 1000000006;2;Field  ;
                SourceExpr="WHT Business Posting Group" }

    { 1000000008;2;Field  ;
                SourceExpr="WHT Product Posting Group" }

    { 68  ;2   ;Field     ;
                SourceExpr="IC Partner Reference";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr=Nonstock;
                Visible=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="VAT Prod. Posting Group";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 66  ;2   ;Field     ;
                SourceExpr="Return Reason Code" }

    { 72  ;2   ;Field     ;
                SourceExpr="Location Code";
                Visible=TRUE }

    { 62  ;2   ;Field     ;
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr=Reserve;
                Visible=FALSE;
                OnValidate=BEGIN
                             ReserveOnAfterValidate;
                           END;
                            }

    { 8   ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr=Quantity;
                OnValidate=BEGIN
                             QuantityOnAfterValidate;
                           END;
                            }

    { 26  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Reserved Quantity";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              COMMIT;
                              ShowReservationEntries(TRUE);
                              UpdateForm(TRUE);
                            END;
                             }

    { 22  ;2   ;Field     ;
                SourceExpr="Unit of Measure Code";
                OnValidate=BEGIN
                             UnitofMeasureCodeOnAfterValidate;
                           END;
                            }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit of Measure";
                Visible=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Unit Price" }

    { 82  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Return Qty. to Receive" }

    { 92  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Amount" }

    { 16  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Line Discount %" }

    { 84  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Return Qty. Received" }

    { 24  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Invoice" }

    { 56  ;2   ;Field     ;
                SourceExpr="Line Discount Amount";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Quantity Invoiced" }

    { 54  ;2   ;Field     ;
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Allow Item Charge Assignment";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Inv. Discount Amount";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. to Assign";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 60  ;2   ;Field     ;
                BlankZero=Yes;
                SourceExpr="Qty. Assigned";
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              ShowItemChargeAssgnt;
                              UpdateForm(FALSE);
                            END;
                             }

    { 78  ;2   ;Field     ;
                SourceExpr="Requested Delivery Date";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Promised Delivery Date";
                Visible=FALSE }

    { 94  ;2   ;Field     ;
                SourceExpr="Planned Delivery Date";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                SourceExpr="Planned Shipment Date";
                Visible=FALSE }

    { 98  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Visible=FALSE }

    { 100 ;2   ;Field     ;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 102 ;2   ;Field     ;
                SourceExpr="Shipping Agent Service Code";
                Visible=FALSE }

    { 104 ;2   ;Field     ;
                SourceExpr="Shipping Time";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Blanket Order No.";
                Visible=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Blanket Order Line No.";
                Visible=FALSE }

    { 5810;2   ;Field     ;
                SourceExpr="Appl.-from Item Entry";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Appl.-to Item Entry";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 74  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(3,ShortcutDimCode[3]);
                         END;
                          }

    { 302 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(4,ShortcutDimCode[4]);
                         END;
                          }

    { 304 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(5,ShortcutDimCode[5]);
                         END;
                          }

    { 306 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(6,ShortcutDimCode[6]);
                         END;
                          }

    { 308 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(7,ShortcutDimCode[7]);
                         END;
                          }

    { 310 ;2   ;Field     ;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;

                OnLookup=BEGIN
                           LookupShortcutDimCode(8,ShortcutDimCode[8]);
                         END;
                          }

  }
  CODE
  {
    VAR
      TransferExtendedText@1000000000 : Codeunit 378;
      ShortcutDimCode@1000000001 : ARRAY [8] OF Code[20];
      SalesHeader@1000000002 : Record 36;

    PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Disc. (Yes/No)",Rec);
    END;

    PROCEDURE CalcInvDisc@6();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Calc. Discount",Rec);
    END;

    PROCEDURE ExplodeBOM@3();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"Sales-Explode BOM",Rec);
    END;

    PROCEDURE _InsertExtendedText@19065029(Unconditionally@1000000000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE InsertExtendedText@5(Unconditionally@1000000000 : Boolean);
    BEGIN
      IF TransferExtendedText.SalesCheckIfAnyExtText(Rec,Unconditionally) THEN BEGIN
        CurrPage.SAVERECORD;
        TransferExtendedText.InsertSalesExtText(Rec);
      END;
      IF TransferExtendedText.MakeUpdate THEN
        UpdateForm(TRUE);
    END;

    PROCEDURE _ItemAvailability@19008035(AvailabilityType@1000000000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE ItemAvailability@7(AvailabilityType@1000000000 : 'Date,Variant,Location,Bin');
    BEGIN
      Rec.ItemAvailability(AvailabilityType);
    END;

    PROCEDURE _ShowReservation@19004172();
    BEGIN
      FIND;
      Rec.ShowReservation;
    END;

    PROCEDURE ShowReservation@2();
    BEGIN
      FIND;
      Rec.ShowReservation;
    END;

    PROCEDURE _ShowDimensions@19020529();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowDimensions@8();
    BEGIN
      Rec.ShowDimensions;
    END;

    PROCEDURE ShowTracking@13();
    VAR
      TrackingForm@1000000000 : Form 99000822;
    BEGIN
      TrackingForm.SetSalesLine(Rec);
      TrackingForm.RUNMODAL;
    END;

    PROCEDURE _OpenItemTrackingLines@19054693();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE OpenItemTrackingLines@6500();
    BEGIN
      Rec.OpenItemTrackingLines;
    END;

    PROCEDURE ItemChargeAssgnt@5800();
    BEGIN
      Rec.ShowItemChargeAssgnt;
    END;

    PROCEDURE UpdateForm@12(SetSaveRecord@1000000000 : Boolean);
    BEGIN
      CurrPage.UPDATE(SetSaveRecord);
    END;

    PROCEDURE _ShowLineComments@19074756();
    BEGIN
      Rec.ShowLineComments;
    END;

    PROCEDURE ShowLineComments@4();
    BEGIN
      Rec.ShowLineComments;
    END;

    LOCAL PROCEDURE NoOnAfterValidate@19066594();
    BEGIN
      InsertExtendedText(FALSE);
      IF (Type = Type::"Charge (Item)") AND ("No." <> xRec."No.") AND
         (xRec."No." <> '')
      THEN
        CurrPage.SAVERECORD;

      IF (Reserve = Reserve::Always) AND
         ("Outstanding Qty. (Base)" <> 0) AND
         ("No." <> xRec."No.")
      THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE CrossReferenceNoOnAfterValidat@19048248();
    BEGIN
      InsertExtendedText(FALSE);
    END;

    LOCAL PROCEDURE ReserveOnAfterValidate@19004502();
    BEGIN
      IF (Reserve = Reserve::Always) AND ("Outstanding Qty. (Base)" <> 0) THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    LOCAL PROCEDURE QuantityOnAfterValidate@19032465();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    LOCAL PROCEDURE UnitofMeasureCodeOnAfterValida@19057939();
    BEGIN
      IF Reserve = Reserve::Always THEN BEGIN
        CurrPage.SAVERECORD;
        AutoReserve;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 6640 Purchase Return Order
{
  OBJECT-PROPERTIES
  {
    Date=12/12/11;
    Time=[ 2:50:54 PM];
    Version List=NAVW16.00,NAVAP6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Purchase Return Order;
               THA=ใบสั่งส่งคืนสินค้าซื้อ];
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Return Order));
    PageType=Document;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
                   FILTERGROUP(0);
                 END;
               END;

    OnNewRecord=BEGIN
                  "Responsibility Center" := UserMgt.GetPurchasesFilter;
                END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Ret. Order;
                                 THA=&ใบสั่งส่งคืนสินค้า] }
      { 49      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 FORM.RUNMODAL(FORM::"Purchase Order Statistics",Rec);
                               END;
                                }
      { 50      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 THA=บัตร];
                      RunObject=Page 26;
                      RunFormLink=No.=FIELD(Buy-from Vendor No.);
                      Image=EditLines }
      { 51      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=FIELD(Document Type),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 5801    ;2   ;Action    ;
                      CaptionML=[ENU=Return Shipments;
                                 THA=การจัดส่งคืนสินค้า];
                      RunObject=Page 6652;
                      RunFormView=SORTING(Return Order No.);
                      RunFormLink=Return Order No.=FIELD(No.) }
      { 117     ;2   ;Action    ;
                      CaptionML=[ENU=Cred&it Memos;
                                 THA=&ใบลดหนี้];
                      RunObject=Page 147;
                      RunFormView=SORTING(Return Order No.);
                      RunFormLink=Return Order No.=FIELD(No.);
                      Image=CreditMemo }
      { 105     ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      Image=Dimensions;
                      OnAction=BEGIN
                                 Rec.ShowDocDim;
                               END;
                                }
      { 141     ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1000000001 : Form 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 136     ;2   ;Separator  }
      { 114     ;2   ;Action    ;
                      CaptionML=[ENU=Whse. Shipment Lines;
                                 THA=บรรทัดการจัดส่งของคลังสินค้า];
                      RunObject=Page 7341;
                      RunFormView=SORTING(Source Type,Source Subtype,Source No.,Source Line No.);
                      RunFormLink=Source Type=CONST(39),Source Subtype=FIELD(Document Type),Source No.=FIELD(No.) }
      { 129     ;2   ;Action    ;
                      CaptionML=[ENU=In&vt. Put-away/Pick Lines;
                                 THA=&บรรทัดการย้ายเก็บ/การรับสินค้าคงคลัง];
                      RunObject=Page 5774;
                      RunFormView=SORTING(Source Document,Source No.,Location Code);
                      RunFormLink=Source Document=CONST(Purchase Return Order),Source No.=FIELD(No.) }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 52      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 THA=ฟัง&ก์ชัน] }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=Calculate &Invoice Discount;
                                 THA=คำนวณส่วนลดใน&ใบแจ้งหนี้];
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                               END;
                                }
      { 130     ;2   ;Separator  }
      { 119     ;2   ;Action    ;
                      ShortCutKey=Shift+F11;
                      CaptionML=[ENU=Apply Entries;
                                 THA=ใช้รายการ];
                      Promoted=Yes;
                      Image=ApplyEntries;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CODEUNIT.RUN(CODEUNIT::"Purchase Header Apply",Rec);
                               END;
                                }
      { 132     ;2   ;Separator  }
      { 54      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy Document;
                                 THA=คัดลอกเอกสาร];
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                               END;
                                }
      { 142     ;2   ;Action    ;
                      CaptionML=[ENU=Archive Document;
                                 THA=เก็บถาวรเอกสาร];
                      OnAction=BEGIN
                                 ArchiveManagement.ArchivePurchDocument(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 120     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Move Negative Lines;
                                 THA=ย้ายบรรทัดที่มีค่าลบ];
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 285     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get Posted Doc&ument Lines to Reverse;
                                 THA=เรียกบรรทัดเอกสารที่ลงรายการบัญชี&ที่จะกลับรายการ];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ReverseLines;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CopyDocMgt@1000000001 : Codeunit 6620;
                               BEGIN
                                 GetPstdDocLinesToRevere;
                               END;
                                }
      { 134     ;2   ;Separator  }
      { 93      ;2   ;Action    ;
                      CaptionML=[ENU=Create &Whse. Shipment;
                                 THA=สร้างใบจัดส่งสินค้าของค&ลังสินค้า];
                      OnAction=VAR
                                 GetSourceDocOutbound@1000000001 : Codeunit 5752;
                               BEGIN
                                 GetSourceDocOutbound.CreateFromPurchaseReturnOrder(Rec);
                               END;
                                }
      { 118     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Inventor&y Put-away / Pick;
                                 THA=สร้างการย้ายเก็บ / การรับสินค้าคง&คลัง];
                      Image=CreateInventoryPickup;
                      OnAction=BEGIN
                                 CreateInvtPutAwayPick;
                               END;
                                }
      { 135     ;2   ;Separator  }
      { 143     ;2   ;Action    ;
                      CaptionML=[ENU=Send A&pproval Request;
                                 THA=ส่งคำ&ขออนุมัติ];
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalMgt@1000000001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.SendPurchaseApprovalRequest(Rec) THEN;
                               END;
                                }
      { 144     ;2   ;Action    ;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 THA=ยกเลิ&กคำขออนุมัติ];
                      OnAction=VAR
                                 ApprovalMgt@1000000001 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.CancelPurchaseApprovalRequest(Rec,TRUE,TRUE) THEN;
                               END;
                                }
      { 137     ;2   ;Separator  }
      { 112     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 THA=นำ&ออกใช้];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1000000001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 113     ;2   ;Action    ;
                      CaptionML=[ENU=Re&open;
                                 THA=เปิด&ใหม่];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleasePurchDoc@1000000001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 690     ;2   ;Separator  }
      { 138     ;2   ;Action    ;
                      CaptionML=[ENU=Send IC Return Order;
                                 THA=ส่งใบสั่งส่งคืนสินค้า IC];
                      OnAction=VAR
                                 ICInOutMgt@1000000001 : Codeunit 427;
                                 SalesHeader@1000000002 : Record 36;
                                 ApprovalMgt@1000000003 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   ICInOutMgt.SendPurchDoc(Rec,FALSE);
                               END;
                                }
      { 57      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 THA=การ&ลงรายการบัญชี] }
      { 58      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 THA=รายงานการทดสอบ];
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 59      ;2   ;Action    ;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 THA=ลง&รายการบัญชี];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesHeader@1000000001 : Record 36;
                                 ApprovalMgt@1000000002 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Purch.-Post (Yes/No)",Rec);
                               END;
                                }
      { 60      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post and &Print;
                                 THA=ลงรายการบัญชีและ&พิมพ์];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 SalesHeader@1000000001 : Record 36;
                                 ApprovalMgt@1000000002 : Codeunit 439;
                               BEGIN
                                 IF ApprovalMgt.PrePostApprovalCheck(SalesHeader,Rec) THEN
                                   CODEUNIT.RUN(CODEUNIT::"Purch.-Post + Print",Rec);
                               END;
                                }
      { 61      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post &Batch;
                                 THA=ลงรายการบัญชี&ชุดงาน];
                      Image=PostBatch;
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purch. Ret. Orders",TRUE,TRUE,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 104     ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DocPrint.PrintPurchHeader(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             BuyfromVendorNoOnAfterValidate;
                           END;
                            }

    { 125 ;2   ;Field     ;
                SourceExpr="Buy-from Contact No." }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name" }

    { 63  ;2   ;Field     ;
                SourceExpr="Buy-from Address" }

    { 65  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2" }

    { 1000000002;2;Field  ;
                SourceExpr="Buy-from Address 3" }

    { 68  ;2   ;Field     ;
                SourceExpr="Buy-from Post Code" }

    { 67  ;2   ;Field     ;
                SourceExpr="Buy-from City" }

    { 1500000;2;Field     ;
                SourceExpr="Buy-from County" }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Buy-from County/Country Code;
                           THA=ซื้อจากเขต/รหัสประเทศ];
                SourceExpr="Buy-from Country/Region Code" }

    { 8   ;2   ;Field     ;
                SourceExpr="Buy-from Contact" }

    { 146 ;2   ;Field     ;
                SourceExpr="No. of Archived Versions" }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date" }

    { 121 ;2   ;Field     ;
                SourceExpr="Order Date";
                Importance=Promoted }

    { 39  ;2   ;Field     ;
                SourceExpr="Document Date" }

    { 115 ;2   ;Field     ;
                SourceExpr="Vendor Authorization No.";
                Importance=Promoted }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor Cr. Memo No.";
                Importance=Promoted }

    { 72  ;2   ;Field     ;
                SourceExpr="Order Address Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                OnValidate=BEGIN
                             PurchaserCodeOnAfterValidate;
                           END;
                            }

    { 1102601000;2;Field  ;
                SourceExpr="Campaign No." }

    { 107 ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 56  ;2   ;Field     ;
                SourceExpr="Assigned User ID" }

    { 101 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 46  ;1   ;Part      ;
                Name=PurchLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page6641 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 20  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             PaytoVendorNoOnAfterValidate;
                           END;
                            }

    { 127 ;2   ;Field     ;
                SourceExpr="Pay-to Contact No." }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Name" }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to Address" }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2" }

    { 1000000008;2;Field  ;
                SourceExpr="Pay-to Address 3" }

    { 73  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code" }

    { 28  ;2   ;Field     ;
                SourceExpr="Pay-to City" }

    { 1500004;2;Field     ;
                SourceExpr="Pay-to County" }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Pay-to County/Country Code;
                           THA=เขต/รหัสประเทศที่ทำจ่าย];
                SourceExpr="Pay-to Country/Region Code" }

    { 30  ;2   ;Field     ;
                SourceExpr="Pay-to Contact" }

    { 76  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                OnValidate=BEGIN
                             ShortcutDimension1CodeOnAfterValidate;
                           END;
                            }

    { 78  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterValidate;
                           END;
                            }

    { 16  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type";
                Importance=Promoted }

    { 18  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No.";
                Importance=Promoted }

    { 94  ;2   ;Field     ;
                SourceExpr="Applies-to ID" }

    { 110 ;2   ;Field     ;
                SourceExpr="Prices Including VAT";
                OnValidate=BEGIN
                             PricesIncludingVATOnAfterValidate;
                           END;
                            }

    { 139 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1500001;2;Field     ;
                SourceExpr="Vendor Exchange Rate (ACY)" }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to Name" }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Address" }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2" }

    { 1000000014;2;Field  ;
                SourceExpr="Ship-to Address 3" }

    { 83  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code" }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to City" }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County" }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code" }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Contact" }

    { 80  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted }

    { 96  ;2   ;Field     ;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 91  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrencyCodeOnAfterValidate;
                           END;

                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 42  ;2   ;Field     ;
                SourceExpr="Transaction Type" }

    { 89  ;2   ;Field     ;
                SourceExpr="Transaction Specification" }

    { 44  ;2   ;Field     ;
                SourceExpr="Transport Method" }

    { 85  ;2   ;Field     ;
                SourceExpr="Entry Point" }

    { 87  ;2   ;Field     ;
                SourceExpr=Area }

    { 1902492201;1;Group  ;
                CaptionML=[ENU=Adjustment Details;
                           THA=รายละเอียดการปรับปรุง] }

    { 1500024;2;Field     ;
                SourceExpr=Adjustment }

    { 1500022;2;Field     ;
                SourceExpr="BAS Adjustment" }

    { 1500021;2;Field     ;
                SourceExpr="Adjustment Applies-to" }

    { 1500020;2;Field     ;
                SourceExpr="Reason Code" }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=Address (Thai)] }

    { 1000000000;2;Field  ;
                SourceExpr="Buy-from Name (Thai)" }

    { 1000000001;2;Field  ;
                SourceExpr="Buy-from Address (Thai)";
                MultiLine=Yes }

    { 1000000005;2;Field  ;
                SourceExpr="Pay-to Name (Thai)" }

    { 1000000010;2;Field  ;
                SourceExpr="Pay-to Address (Thai)";
                MultiLine=Yes }

    { 1000000012;2;Field  ;
                SourceExpr="Ship-to Name (Thai)" }

    { 1000000028;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1906354007;1;Part   ;
                SubFormLink=Table ID=CONST(38),Document Type=FIELD(Document Type),Document No.=FIELD(No.),Status=CONST(Open);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=TRUE;
                PartType=Page }

    { 1904651607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9094;
                Visible=FALSE;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubFormLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                Visible=TRUE;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubFormLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchSetup@1000000000 : Record 312;
      ChangeExchangeRate@1000000001 : Form 511;
      CopyPurchDoc@1000000002 : Report 492;
      MoveNegPurchLines@1000000003 : Report 6698;
      DocPrint@1000000004 : Codeunit 229;
      ReportPrint@1000000005 : Codeunit 228;
      UserMgt@1000000006 : Codeunit 5700;
      ArchiveManagement@1000000007 : Codeunit 5063;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.FORM.ApproveCalcInvDisc;
    END;

    LOCAL PROCEDURE BuyfromVendorNoOnAfterValidate@19032492();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PaytoVendorNoOnAfterValidate@19048314();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CurrencyCodeOnAfterValidate@19068298();
    BEGIN
      CurrPage.PurchLines.FORM.UpdateForm(TRUE);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 6650 Posted Return Shipment
{
  OBJECT-PROPERTIES
  {
    Date=12/12/11;
    Time=[ 2:05:11 PM];
    Version List=NAVW15.00.01,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Return Shipment;
               THA=ใบจัดส่งคืนสินค้าที่ลงรายการบัญชี];
    InsertAllowed=No;
    SourceTable=Table6650;
    PageType=Document;
    RefreshOnActivate=Yes;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 45      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Return Shpt.;
                                 THA=&การจัดส่งคืนสินค้า] }
      { 8       ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 6655;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 47      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 66;
                      RunFormLink=Document Type=CONST(Posted Return Shipment),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 79      ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(6650),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 83      ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 PostedApprovalEntries@1000000001 : Form 659;
                               BEGIN
                                 PostedApprovalEntries.Setfilters(DATABASE::"Return Shipment Header","No.");
                                 PostedApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 48      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(ReturnShptHeader);
                                 ReturnShptHeader.PrintRecords(TRUE);
                               END;
                                }
      { 49      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 87  ;2   ;Field     ;
                SourceExpr="Buy-from Contact No.";
                Editable=FALSE }

    { 51  ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name";
                Editable=FALSE }

    { 53  ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Editable=FALSE }

    { 55  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Buy-from Address 3";
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Post Code";
                Editable=FALSE }

    { 57  ;2   ;Field     ;
                SourceExpr="Buy-from City";
                Editable=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="Buy-from County";
                Editable=FALSE }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Buy-from County/Country Code;
                           THA=ซื้อจากเขต/รหัสประเทศ];
                SourceExpr="Buy-from Country/Region Code";
                Editable=FALSE }

    { 59  ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 31  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Return Order No.";
                Importance=Promoted;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor Authorization No.";
                Importance=Promoted;
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                SourceExpr="Order Address Code";
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Purchaser Code";
                Editable=FALSE }

    { 80  ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="No. Printed";
                Editable=FALSE }

    { 44  ;1   ;Part      ;
                Name=ReturnShptLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page6651 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                Editable=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Pay-to Contact No.";
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to Address";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2";
                Editable=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Pay-to Address 3";
                Editable=FALSE }

    { 70  ;2   ;Field     ;
                SourceExpr="Pay-to Post Code";
                Editable=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Pay-to City";
                Editable=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="Pay-to County";
                Editable=FALSE }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Pay-to County/Country Code;
                           THA=เขต/รหัสประเทศที่ทำจ่าย];
                SourceExpr="Pay-to Country/Region Code";
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Editable=FALSE }

    { 64  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 66  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. Type";
                Importance=Promoted;
                Editable=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Applies-to Doc. No.";
                Importance=Promoted;
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 68  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable=FALSE }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           THA=การค้าต่างประเทศ] }

    { 75  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่ (ไทย)] }

    { 1000000002;2;Field  ;
                SourceExpr="Buy-from Name (Thai)";
                Editable=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr="Buy-from Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000004;2;Field  ;
                SourceExpr="Pay-to Name (Thai)";
                Editable=FALSE }

    { 1000000005;2;Field  ;
                SourceExpr="Pay-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000014;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable=FALSE }

    { 1000000016;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ReturnShptHeader@1000000000 : Record 6650;
      ChangeExchangeRate@1000000001 : Form 511;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 6660 Posted Return Receipt
{
  OBJECT-PROPERTIES
  {
    Date=12/12/11;
    Time=[ 2:07:22 PM];
    Version List=NAVW15.00.01,NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Return Receipt;
               THA=การรับสินค้าส่งคืนที่ลงรายการบัญชี];
    InsertAllowed=No;
    SourceTable=Table6660;
    PageType=Document;
    RefreshOnActivate=Yes;
    OnModifyRecord=BEGIN
                     CODEUNIT.RUN(CODEUNIT::"Return Receipt - Printed",Rec);
                     EXIT(FALSE);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 47      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Return Rcpt.;
                                 THA=&การรับสินค้าส่งคืน] }
      { 10      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 THA=สถิติ];
                      RunObject=Page 6665;
                      RunFormLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 78      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 THA=ข้อ&คิดเห็น];
                      RunObject=Page 67;
                      RunFormLink=Document Type=CONST(Posted Return Receipt),No.=FIELD(No.),Document Line No.=CONST(0);
                      Image=ViewComments }
      { 80      ;2   ;Action    ;
                      CaptionML=[ENU=Dimensions;
                                 THA=มิติ];
                      RunObject=Page 547;
                      RunFormLink=Table ID=CONST(6660),Document No.=FIELD(No.),Line No.=CONST(0);
                      Image=Dimensions }
      { 62      ;2   ;Action    ;
                      CaptionML=[ENU=Approvals;
                                 THA=อนุมัติ];
                      Image=Approvals;
                      OnAction=VAR
                                 PostedApprovalEntries@1000000001 : Form 659;
                               BEGIN
                                 PostedApprovalEntries.Setfilters(DATABASE::"Return Receipt Header","No.");
                                 PostedApprovalEntries.RUN;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 49      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 THA=&พิมพ์];
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.SETSELECTIONFILTER(ReturnRcptHeader);
                                 ReturnRcptHeader.PrintRecords(TRUE);
                               END;
                                }
      { 50      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           THA=ทั่วไป] }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Sell-to Customer No.";
                Importance=Promoted;
                Editable=FALSE }

    { 87  ;2   ;Field     ;
                SourceExpr="Sell-to Contact No.";
                Editable=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="Sell-to Customer Name";
                Editable=FALSE }

    { 54  ;2   ;Field     ;
                SourceExpr="Sell-to Address";
                Editable=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Sell-to Address 2";
                Editable=FALSE }

    { 1000000000;2;Field  ;
                SourceExpr="Sell-to Address 3";
                Editable=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Sell-to Post Code";
                Editable=FALSE }

    { 58  ;2   ;Field     ;
                SourceExpr="Sell-to City";
                Editable=FALSE }

    { 1500000;2;Field     ;
                SourceExpr="Sell-to County";
                Editable=FALSE }

    { 1500002;2;Field     ;
                CaptionML=[ENU=Sell-to County/Country Code;
                           THA=ขายไปที่เขต/รหัสประเทศ];
                SourceExpr="Sell-to Country/Region Code";
                Editable=FALSE }

    { 60  ;2   ;Field     ;
                SourceExpr="Sell-to Contact";
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Promoted;
                Editable=FALSE }

    { 27  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable=FALSE }

    { 4   ;2   ;Field     ;
                SourceExpr="Return Order No.";
                Importance=Promoted;
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="External Document No.";
                Importance=Promoted;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Editable=FALSE }

    { 82  ;2   ;Field     ;
                SourceExpr="Responsibility Center";
                Editable=FALSE }

    { 16  ;2   ;Field     ;
                SourceExpr="No. Printed";
                Editable=FALSE }

    { 46  ;1   ;Part      ;
                Name=ReturnRcptLines;
                SubFormLink=Document No.=FIELD(No.);
                PagePartID=Page6661 }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           THA=การออกใบแจ้งหนี้] }

    { 18  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                Editable=FALSE }

    { 89  ;2   ;Field     ;
                SourceExpr="Bill-to Contact No.";
                Editable=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Bill-to Name";
                Editable=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Bill-to Address";
                Editable=FALSE }

    { 24  ;2   ;Field     ;
                SourceExpr="Bill-to Address 2";
                Editable=FALSE }

    { 1000000008;2;Field  ;
                SourceExpr="Bill-to Address 3";
                Editable=FALSE }

    { 67  ;2   ;Field     ;
                SourceExpr="Bill-to Post Code";
                Editable=FALSE }

    { 26  ;2   ;Field     ;
                SourceExpr="Bill-to City";
                Editable=FALSE }

    { 1500004;2;Field     ;
                SourceExpr="Bill-to County";
                Editable=FALSE }

    { 1500006;2;Field     ;
                CaptionML=[ENU=Bill-to County/Country Code;
                           THA=เรียกเก็บเงินที่เขต/รหัสประเทศ];
                SourceExpr="Bill-to Country/Region Code";
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                SourceExpr="Bill-to Contact";
                Editable=FALSE }

    { 9   ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 63  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 1906801201;1;Group  ;
                CaptionML=[ENU=Shipping;
                           THA=การจัดส่ง] }

    { 30  ;2   ;Field     ;
                SourceExpr="Ship-to Code";
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 1000000014;2;Field  ;
                SourceExpr="Ship-to Address 3";
                Editable=FALSE }

    { 69  ;2   ;Field     ;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 1500008;2;Field     ;
                SourceExpr="Ship-to County";
                Editable=FALSE }

    { 1500010;2;Field     ;
                CaptionML=[ENU=Ship-to County/Country Code;
                           THA=จัดส่งที่เขต/รหัสประเทศ];
                SourceExpr="Ship-to Country/Region Code";
                Editable=FALSE }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 65  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Promoted;
                Editable=FALSE }

    { 42  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Editable=FALSE }

    { 44  ;2   ;Field     ;
                SourceExpr="Shipment Date";
                Importance=Promoted;
                Editable=FALSE }

    { 1903041301;1;Group  ;
                CaptionML=[ENU=Address (Thai);
                           THA=ที่อยู่ (ไทย)] }

    { 1000000016;2;Field  ;
                SourceExpr="Sell-to Name (Thai)";
                Editable=FALSE }

    { 1000000017;2;Field  ;
                SourceExpr="Sell-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000018;2;Field  ;
                SourceExpr="Bill-to Name (Thai)";
                Editable=FALSE }

    { 1000000022;2;Field  ;
                SourceExpr="Bill-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1000000024;2;Field  ;
                SourceExpr="Ship-to Name (Thai)";
                Editable=FALSE }

    { 1000000026;2;Field  ;
                SourceExpr="Ship-to Address (Thai)";
                Editable=FALSE;
                MultiLine=Yes }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ReturnRcptHeader@1000000000 : Record 6660;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 28040 WHT Business Posting Group
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVAP4.00.01,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=WHT Business Posting Group;
               THA=กลุ่มการลงรายการบัญชีธุรกิจ WHT];
    SourceTable=Table28040;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1500009 ;1   ;Action    ;
                      CaptionML=[ENU=&Setup;
                                 THA=&เซ็ตอัพ];
                      RunObject=Page 28043;
                      RunFormLink=WHT Business Posting Group=FIELD(Code);
                      Promoted=Yes;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1500000;1;Group     ;
                GroupType=Repeater }

    { 1500001;2;Field     ;
                SourceExpr=Code }

    { 1500003;2;Field     ;
                SourceExpr=Description }

    { 1000000000;2;Field  ;
                SourceExpr="WHT Certificate No. Series" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 28043 WHT Posting Setup
{
  OBJECT-PROPERTIES
  {
    Date=09/06/11;
    Time=[ 6:00:00 PM];
    Version List=NAVAP6.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=WHT Posting Setup;
               THA=การตั้งค่าการลงรายการบัญชี WHT];
    SourceTable=Table28043;
    PageType=Card;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1500000;1;Group     ;
                GroupType=Repeater }

    { 1500001;2;Field     ;
                SourceExpr="WHT Business Posting Group" }

    { 1500003;2;Field     ;
                SourceExpr="WHT Product Posting Group" }

    { 1500019;2;Field     ;
                SourceExpr="WHT Calculation Rule" }

    { 1500021;2;Field     ;
                SourceExpr="WHT Minimum Invoice Amount" }

    { 1500005;2;Field     ;
                SourceExpr="WHT %" }

    { 1500011;2;Field     ;
                SourceExpr="Realized WHT Type" }

    { 1000000000;2;Field  ;
                SourceExpr="Bal. Prepaid Account Type" }

    { 1500007;2;Field     ;
                SourceExpr="Prepaid WHT Account Code" }

    { 1000000002;2;Field  ;
                SourceExpr="Bal. Prepaid Account No." }

    { 1500009;2;Field     ;
                SourceExpr="Payable WHT Account Code" }

    { 1000000004;2;Field  ;
                SourceExpr="Bal. Payable Account Type" }

    { 1500013;2;Field     ;
                SourceExpr="WHT Report" }

    { 1000000006;2;Field  ;
                SourceExpr="Bal. Payable Account No." }

    { 150000;2 ;Field     ;
                SourceExpr="Bal. Prepaid Account Type" }

    { 150002;2 ;Field     ;
                SourceExpr="Bal. Prepaid Account No." }

    { 150004;2 ;Field     ;
                SourceExpr="Bal. Payable Account Type" }

    { 150006;2 ;Field     ;
                SourceExpr="Bal. Payable Account No." }

    { 1500015;2;Field     ;
                SourceExpr="WHT Report Line No. Series" }

    { 1500017;2;Field     ;
                SourceExpr="Revenue Type" }

    { 1500027;2;Field     ;
                SourceExpr="Purch. WHT Adj. Account No." }

    { 1500029;2;Field     ;
                SourceExpr="Sales WHT Adj. Account No." }

    { 1500031;2;Field     ;
                SourceExpr=Sequence }

  }
  CODE
  {

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   01.02.2006   KKE   Add new fields for localization.
    }
    END.
  }
}

OBJECT Page 28044 WHT Entry
{
  OBJECT-PROPERTIES
  {
    Date=12/23/11;
    Time=[ 4:15:36 PM];
    Modified=Yes;
    Version List=NAVAP5.00,AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=WHT Entry;
               THA=รายการ WHT];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table28044;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000012;1 ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 THA=&นำทางข้อมูล];
                      Promoted=Yes;
                      Image=Navigate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Navigate.SetDoc("Posting Date","Document No.");
                                 Navigate.RUN;
                               END;
                                }
      { 1000000011;1 ;Action    ;
                      CaptionML=[DEU=&Suchen;
                                 ENU=Fi&nd;
                                 THA=ค้นหา];
                      Promoted=Yes;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF WHTReportFilter <> WHTReportFilter::" " THEN
                                   SETRANGE("WHT Report",WHTReportFilter)
                                 ELSE
                                   SETRANGE("WHT Report");
                                 IF WHTCertificateNoFilter <> '' THEN
                                   SETRANGE("WHT Certificate No.",WHTCertificateNoFilter)
                                 ELSE
                                   SETRANGE("WHT Certificate No.");
                                 IF DocumentNoFilter <> '' THEN
                                   SETRANGE("Document No.",DocumentNoFilter)
                                 ELSE
                                   SETRANGE("Document No.");
                                 IF (StartingDate <> 0D) AND (EndingDate <> 0D) THEN
                                   SETFILTER("Posting Date",'%1..%2',StartingDate,EndingDate)
                                 ELSE IF (StartingDate <> 0D) AND (EndingDate = 0D) THEN
                                   SETFILTER("Posting Date",'%1..',StartingDate)
                                 ELSE IF (StartingDate = 0D) AND (EndingDate <> 0D) THEN
                                   SETFILTER("Posting Date",'..%1',EndingDate);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Group  ;
                CaptionML=[ENU=Option;
                           THA=ออพชั่น] }

    { 1000000001;2;Field  ;
                CaptionML=[ENU=WHT Report;
                           THA=รายงานภาษีหัก ณ ที่จ่าย];
                SourceExpr=WHTReportFilter }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=WHT Certificate No.;
                           THA=เลขที่ใบรับรองหักภาษี ณ ที่จ่าย];
                SourceExpr=WHTCertificateNoFilter }

    { 1000000005;2;Field  ;
                CaptionML=[ENU=Document No.;
                           THA=เลขที่เอกสาร];
                SourceExpr=DocumentNoFilter;
                Editable=FALSE }

    { 1000000007;2;Field  ;
                CaptionML=[ENU=Starting Date;
                           THA=วันเริ่มต้น];
                SourceExpr=StartingDate;
                Editable=FALSE }

    { 1000000009;2;Field  ;
                CaptionML=[ENU=Ending Date;
                           THA=วันสิ้นสุด];
                SourceExpr=EndingDate;
                Editable=FALSE }

    { 1500000;1;Group     ;
                GroupType=Repeater }

    { 1500001;2;Field     ;
                SourceExpr="Entry No." }

    { 1500087;2;Field     ;
                SourceExpr="WHT Certificate No." }

    { 1000000015;2;Field  ;
                SourceExpr=Cancelled }

    { 1500093;2;Field     ;
                SourceExpr="Original Document No.";
                Editable=FALSE }

    { 1500057;2;Field     ;
                SourceExpr="WHT Bus. Posting Group";
                Editable=FALSE }

    { 1500059;2;Field     ;
                SourceExpr="WHT Prod. Posting Group";
                Editable=FALSE }

    { 1000000013;2;Field  ;
                SourceExpr="WHT Revenue Type";
                Editable=FALSE }

    { 1500069;2;Field     ;
                SourceExpr="WHT %";
                Editable=FALSE }

    { 1500003;2;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE;
                Editable=FALSE }

    { 1500005;2;Field     ;
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE;
                Editable=FALSE }

    { 1500007;2;Field     ;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 1500011;2;Field     ;
                SourceExpr="Document Type";
                Editable=FALSE }

    { 1500009;2;Field     ;
                SourceExpr="Document No.";
                Editable=FALSE }

    { 1500023;2;Field     ;
                SourceExpr="Bill-to/Pay-to No.";
                Editable=FALSE }

    { 1500085;2;Field     ;
                SourceExpr="Actual Vendor No.";
                Editable=FALSE }

    { 1500015;2;Field     ;
                SourceExpr=Base;
                Editable=FALSE }

    { 1500017;2;Field     ;
                SourceExpr=Amount;
                Editable=FALSE }

    { 1500045;2;Field     ;
                SourceExpr="Unrealized Base";
                Editable=FALSE }

    { 1500043;2;Field     ;
                SourceExpr="Unrealized Amount";
                Editable=FALSE }

    { 1500049;2;Field     ;
                SourceExpr="Remaining Unrealized Base";
                Editable=FALSE }

    { 1500047;2;Field     ;
                SourceExpr="Remaining Unrealized Amount";
                Editable=FALSE }

    { 1500021;2;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1500027;2;Field     ;
                SourceExpr="User ID";
                Editable=FALSE }

    { 1500029;2;Field     ;
                SourceExpr="Source Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1500031;2;Field     ;
                SourceExpr="Reason Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1500033;2;Field     ;
                SourceExpr="Closed by Entry No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1500035;2;Field     ;
                SourceExpr=Closed;
                Editable=FALSE }

    { 1500013;2;Field     ;
                SourceExpr="Transaction Type";
                Visible=FALSE;
                Editable=FALSE }

    { 1500041;2;Field     ;
                SourceExpr="Transaction No.";
                Editable=FALSE }

    { 1500051;2;Field     ;
                SourceExpr="External Document No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1500053;2;Field     ;
                SourceExpr="No. Series";
                Visible=FALSE;
                Editable=FALSE }

    { 1500055;2;Field     ;
                SourceExpr="Unrealized WHT Entry No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1500061;2;Field     ;
                SourceExpr="Base (LCY)";
                Editable=FALSE }

    { 1500063;2;Field     ;
                SourceExpr="Amount (LCY)";
                Editable=FALSE }

    { 1500065;2;Field     ;
                SourceExpr="Unrealized Amount (LCY)";
                Editable=FALSE }

    { 1500067;2;Field     ;
                SourceExpr="Unrealized Base (LCY)";
                Editable=FALSE }

    { 1500071;2;Field     ;
                SourceExpr="Rem Unrealized Amount (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 1500073;2;Field     ;
                SourceExpr="Rem Unrealized Base (LCY)";
                Visible=FALSE;
                Editable=FALSE }

    { 1500075;2;Field     ;
                SourceExpr="WHT Difference";
                Visible=FALSE;
                Editable=FALSE }

    { 1500079;2;Field     ;
                SourceExpr="Ship-to/Order Address Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1500081;2;Field     ;
                SourceExpr="Document Date";
                Visible=FALSE;
                Editable=FALSE }

    { 1500091;2;Field     ;
                SourceExpr="Void Check";
                Visible=FALSE;
                Editable=FALSE }

    { 1500095;2;Field     ;
                SourceExpr="Void Payment Entry No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1500099;2;Field     ;
                SourceExpr="WHT Report";
                Editable=FALSE }

  }
  CODE
  {
    VAR
      WHTManagement@1000000000 : Codeunit 28040;
      StartingDate@1000000001 : Date;
      EndingDate@1000000002 : Date;
      WHTReportFilter@1000000003 : ' ,Por Ngor Dor 1,Por Ngor Dor 2,Por Ngor Dor 3,Por Ngor Dor 53,Por Ngor Dor 54';
      WHTCertificateNoFilter@1000000004 : Text[50];
      DocumentNoFilter@1000000005 : Text[50];
      VendName@1000000006 : Text[200];
      Navigate@1000000007 : Form 344;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   -Modify program to allow edit WHT entries.
    }
    END.
  }
}

