OBJECT Report 50000 FORM 53
{
  OBJECT-PROPERTIES
  {
    Date=03/12/12;
    Time=[ 2:27:58 PM];
    Modified=Yes;
    Version List=AVATHA4.02;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=800;
    OnPreReport=BEGIN
                  IF CompanyInfo.GET THEN
                    FOR i := 1 TO STRLEN(CompanyInfo."VAT Registration No.") DO
                      CId[i] := COPYSTR(CompanyInfo."VAT Registration No.",i,1);

                  FOR i := 1 TO STRLEN(BranchNo) DO
                    Branch[i] := COPYSTR(BranchNo,i,1);

                  GLSetup.FIND('-');

                  WHTTerm := '1';
                END;

    Orientation=Landscape;
    PaperSize=A4 210 x 297 mm;
    HorzGrid=30;
    VertGrid=30;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..2));
        DataItemVarName=Integer1;
        OnPreDataItem=BEGIN
                        pNO := 1;
                      END;

        OnAfterGetRecord=BEGIN
                           IF (pNO >= 2) AND (Number > 1) AND (PageHeight = 0) THEN
                             pNO := pNO - 1;

                           PageHeight := 0;
                           SNo := 0;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27810;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27810;
            SectionHeight=4260;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(SNo <> 0);
                         END;

          }
          CONTROLS
          {
            { 1000000013;Shape  ;27650;0    ;30   ;4230 ;ShapeStyle=VertLine }
            { 1000000018;Shape  ;26310;0    ;30   ;1140 ;ShapeStyle=VertLine }
            { 1000000039;Label  ;13920;0    ;5610 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=รวมยอดเงินได้และภาษีที่นำส่ง }
            { 1000000040;Shape  ;19680;0    ;30   ;1140 ;ShapeStyle=VertLine }
            { 1000000041;Shape  ;19690;500  ;6640 ;30   ;ShapeStyle=HorzLine }
            { 1000000042;Shape  ;12780;0    ;30   ;4260 ;ShapeStyle=VertLine }
            { 1000000043;Label  ;240  ;420  ;10050;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(1) ให้ระบุว่าจ่ายเป็นค่าอะไร เช่น ค่าเช่าอาคาร ค่าสอบบัญชี }
            { 1000000044;Label  ;870  ;840  ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ค่าออกแบบ  ค่าก่อสร้างโรงเรียน  ค่าซื้อเครื่องพิมพ์ดีด }
            { 1000000045;Label  ;870  ;1260 ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU="ค่าซื้อพืชผลทางการเกษตร  ( ยางพารา มันสำปะหลัง ปอ ข้าว ฯลฯ) " }
            { 1000000046;Label  ;360  ;0    ;3540 ;450  ;FontName=Tahoma;
                                                         FontSize=10;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000047;Shape  ;0    ;0    ;30   ;4260 ;ShapeStyle=VertLine }
            { 1000000048;Label  ;870  ;1680 ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU="ค่าจ้างทำของ ค่าจ้างโฆษณา ดอกเบี้ยเงินฝาก ดอกเบี้ยตั๋วเงิน " }
            { 1000000049;Label  ;870  ;2100 ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU="เงินปันผล เงินส่วนแบ่งของกำไร รางวัลใน การประกวด  การแข่งขัน  " }
            { 1000000050;Label  ;870  ;2520 ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=การชิงโชค  ฯลฯ }
            { 1000000051;Label  ;17080;1680 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ลงชื่อ }
            { 1000000052;Label  ;23880;1620 ;1590 ;510  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 1000000053;Label  ;18420;1680 ;5400 ;423  ;HorzAlign=General;
                                                         VertAlign=Bottom;
                                                         CaptionML=ENU=..................................................................... }
            { 1000000054;Label  ;240  ;3180 ;10020;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(2) เงื่อนไขการหักภาษี ณ ที่จ่ายให้กรอกดังนี้ }
            { 1000000055;Label  ;810  ;3603 ;9450 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=- หัก ณ ที่จ่าย กรอก 1     - ออกภาษีให้ กรอก 2 }
            { 1000000056;Label  ;17120;2970 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ตำแหน่ง }
            { 1000000057;Label  ;18460;2970 ;6810 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................. }
            { 1000000058;Label  ;17100;3582 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ยื่นวันที่ }
            { 1000000059;Label  ;19670;3582 ;930  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เดือน }
            { 1000000060;Label  ;22730;3582 ;870  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=พ.ศ. }
            { 1000000061;Label  ;18440;3582 ;1230 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.............. }
            { 1000000062;Label  ;20600;3582 ;2130 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................... }
            { 1000000063;Label  ;23600;3582 ;1650 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................... }
            { 1000000064;Shape  ;15   ;4230 ;27675;30   ;ShapeStyle=HorzLine }
            { 1000000065;TextBox;19890;0    ;3150 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 1000000066;TextBox;23310;0    ;2910 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000067;Shape  ;23160;0    ;30   ;1140 ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;14820;2130 ;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000069;Label  ;14870;2330 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000070;Label  ;14870;2646 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000071;Label  ;14870;2930 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000072;Label  ;18420;2310 ;5490 ;423  ;HorzAlign=General;
                                                         VertAlign=Bottom;
                                                         CaptionML=ENU=(..................................................................) }
            { 1000000073;Shape  ;19690;1040 ;6640 ;30   ;ShapeStyle=HorzLine }
            { 1000000074;TextBox;19890;560  ;3150 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT2 }
            { 1000000075;TextBox;23310;560  ;2910 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY2 }
            { 1000000076;Label  ;13920;540  ;5610 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=รวมทั้งหมด }
            { 1000000077;Shape  ;19690;1120 ;6640 ;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table28044;
        DataItemTableView=SORTING(Document Type,Posting Date,WHT Certificate No.)
                          WHERE(Transaction Type=CONST(Purchase),
                                Document Type=CONST(Payment),
                                Amount=FILTER(<>0),
                                WHT Report=CONST(Por Ngor Dor 53),
                                Cancelled=CONST(No));
        OnPreDataItem=BEGIN
                        WHTEntry.COPYFILTERS("WHT Entry");
                        IF WHTEntry.FIND('-') THEN;

                        CLEAR(NewDocNo);
                        CLEAR(Name);
                        CLEAR(Address);
                        CLEAR(VAT);
                        CLEAR(PostingDate);
                        CLEAR(WHTExpenseText);
                        CLEAR("WHT%");
                        CLEAR(WHTBaseAmtLCYExcVAT);
                        CLEAR(WHTAmtLCY);
                      END;

        OnAfterGetRecord=BEGIN
                           IF "Actual Vendor No." <> '' THEN
                             Vendor.GET("Actual Vendor No.")
                           ELSE
                             Vendor.GET("Bill-to/Pay-to No.");

                           IF (NewDocNo <> "WHT Certificate No.") OR (NewVendor <> Vendor."No.")  THEN BEGIN
                             NewDocNo := "WHT Certificate No.";
                             NewVendor := Vendor."No." ;
                             CLEAR(Name);
                             CLEAR(Address);
                             CLEAR(VAT);
                             CLEAR(PostingDate);
                             CLEAR(WHTExpenseText);
                             CLEAR("WHT%");
                             CLEAR(WHTBaseAmtLCYExcVAT);
                             CLEAR(WHTAmtLCY);
                           END;
                           //TSA001

                           //KKE : #002 +
                           IF "Dummy Vendor" AND PurchInvHeader.GET("Document No.") THEN BEGIN
                             IF PurchInvHeader."Pay-to Name (Thai)" <> '' THEN BEGIN
                               Name := PurchInvHeader."Pay-to Name (Thai)";
                               Address := PurchInvHeader."Pay-to Address (Thai)";
                             END ELSE BEGIN
                               Name := PurchInvHeader."Pay-to Name" + PurchInvHeader."Pay-to Name 2";
                               Address := PurchInvHeader."Pay-to Address" + ' ' +
                                          PurchInvHeader."Pay-to Address 2" + ' ' + PurchInvHeader."Pay-to Address 3";
                             END;
                             FOR i := 1 TO STRLEN("VAT Registration No.(Dummy)") DO
                               VAT[i] := COPYSTR("VAT Registration No.(Dummy)",i,1);
                           END ELSE BEGIN
                           //KKE : #002 -
                             IF Vendor."Name (Thai)" <> '' THEN BEGIN
                               Name := Vendor."Name (Thai)";
                               Address := Vendor."Address (Thai)";
                             END ELSE BEGIN
                               Name := Vendor.Name + Vendor."Name 2";
                               Address := Vendor.Address + ' ' + Vendor."Address 2" + ' ' + Vendor."Address 3";
                             END;
                             FOR i := 1 TO STRLEN(Vendor."VAT Registration No.") DO
                               VAT[i] := COPYSTR(Vendor."VAT Registration No.",i,1);
                           END;

                           PostingDate := "Posting Date";

                           IF WHTRevType.GET("WHT Revenue Type") THEN BEGIN
                             i := 0;
                             MatchType := FALSE;
                             REPEAT
                               i := i + 1;
                               IF (WHTExpenseText[i] = '') OR (WHTExpenseText[i] = WHTRevType.Description) THEN
                                 MatchType := TRUE;
                             UNTIL (i=12) OR (MatchType);
                             WHTExpenseText[i] := WHTRevType.Description;
                             "WHT%"[i] := "WHT %";

                             WHTAmtLCY[i] := WHTAmtLCY[i] + "Amount (LCY)";
                             WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + "Base (LCY)";
                           END;

                           IF PrintTest THEN
                             TestText := "Original Document No." + '/ ' + "WHT Certificate No.";
                         END;

        ReqFilterFields=Transaction Type,Document Type,Document No.,WHT Certificate No.,Posting Date;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27810;
            SectionHeight=5160;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           TotWHTBaseAmtLCYExcVAT := 0;
                           TotWHTAmtLCY := 0;
                         END;

          }
          CONTROLS
          {
            { 1   ;Label        ;23820;1620 ;1200 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=แผ่น }
            { 2   ;Shape        ;15   ;2330 ;27660;50   ;ShapeStyle=HorzLine }
            { 3   ;Shape        ;27650;2370 ;30   ;2760 ;ShapeStyle=VertLine }
            { 4   ;Label        ;26370;3840 ;1270 ;450  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เงื่อนไข }
            { 5   ;Label        ;26370;3480 ;1290 ;375  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         CaptionML=ENU=(2) }
            { 20  ;Shape        ;26310;2370 ;30   ;2760 ;ShapeStyle=VertLine }
            { 22  ;Shape        ;19680;4500 ;6650 ;50   ;ShapeStyle=HorzLine }
            { 23  ;Label        ;23280;3120 ;2870 ;1020 ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงินภาษี ที่หักและนำส่งในครั้งนี้ }
            { 25  ;Label        ;22470;1710 ;1350 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.................................. }
            { 27  ;Label        ;23460;4620 ;2670 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=บาท }
            { 28  ;TextBox      ;25320;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[4] }
            { 29  ;TextBox      ;24870;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[3] }
            { 30  ;Shape        ;25320;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 31  ;TextBox      ;24420;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[2] }
            { 32  ;Shape        ;24870;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 33  ;TextBox      ;23970;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[1] }
            { 34  ;Shape        ;24420;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 35  ;Shape        ;23970;270  ;1800 ;423   }
            { 36  ;Label        ;22770;210  ;1200 ;540  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=สาขาที่ }
            { 37  ;Label        ;21120;1620 ;1350 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ในจำนวน }
            { 38  ;Shape        ;16680;270  ;5850 ;423   }
            { 39  ;TextBox      ;20730;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[10] }
            { 40  ;TextBox      ;20280;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[9] }
            { 41  ;Shape        ;20730;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 42  ;Shape        ;23160;2370 ;30   ;2790 ;ShapeStyle=VertLine }
            { 45  ;TextBox      ;19830;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[8] }
            { 46  ;Shape        ;20280;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 47  ;Label        ;19740;1650 ;1350 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=....................... }
            { 48  ;Label        ;19770;3870 ;3180 ;570  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=จำนวนเงินที่จ่ายในครั้งนี้ }
            { 49  ;TextBox      ;19380;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[7] }
            { 50  ;Shape        ;19830;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 52  ;TextBox      ;18930;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[6] }
            { 53  ;Shape        ;19380;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 54  ;Label        ;14120;2790 ;7290 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รายละเอียดเกี่ยวกับการจ่ายเงินได้พึงประเมิน }
            { 55  ;Label        ;19950;4620 ;3090 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=บาท }
            { 56  ;Label        ;18570;1620 ;1200 ;423  ;FontName=Tahoma;
                                                         FontSize=10;
                                                         CaptionML=ENU=แผ่นที่ }
            { 57  ;TextBox      ;18480;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[5] }
            { 58  ;Shape        ;18930;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 59  ;TextBox      ;18030;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[4] }
            { 60  ;Shape        ;18480;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 62  ;Shape        ;18030;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 63  ;TextBox      ;17580;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[3] }
            { 64  ;Shape        ;18030;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 65  ;TextBox      ;16680;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[1] }
            { 66  ;Shape        ;17580;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 67  ;Label        ;18430;3810 ;1140 ;420  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=อัตรา }
            { 68  ;Shape        ;19680;3810 ;30   ;1320 ;ShapeStyle=VertLine }
            { 69  ;Label        ;18420;4200 ;1140 ;420  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=ภาษี }
            { 70  ;Label        ;18430;4590 ;1140 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=ร้อยละ }
            { 71  ;Shape        ;17130;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 72  ;TextBox      ;17130;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[2] }
            { 73  ;Label        ;7650 ;210  ;8550 ;540  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร (ของผู้มีหน้าที่หักภาษี ณ ที่จ่าย) }
            { 74  ;Shape        ;18330;3810 ;30   ;1320 ;ShapeStyle=VertLine }
            { 75  ;Label        ;15020;4430 ;2820 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=พึงประเมินที่จ่าย }
            { 76  ;Label        ;14990;3960 ;2850 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=(1) ประเภทเงินได้ }
            { 78  ;Shape        ;14610;3810 ;30   ;1320 ;ShapeStyle=VertLine }
            { 79  ;Label        ;7350 ;2490 ;4830 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 80  ;Shape        ;1260 ;3789 ;21900;50   ;ShapeStyle=HorzLine }
            { 81  ;Shape        ;12780;2370 ;30   ;2790 ;ShapeStyle=VertLine }
            { 82  ;Label        ;1360 ;4665 ;10350;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุเลขที่ ตรอก/ซอย หมู่ที่ ถนนตำบล/แขวง อำเภอ/เขต จังหวัด) }
            { 83  ;Label        ;7380 ;2910 ;4800 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ของผู้มีเงินได้) }
            { 84  ;Label        ;2790 ;4012 ;3520 ;488  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ที่อยู่ของผู้มีเงินได้ }
            { 85  ;Label        ;1440 ;2490 ;5040 ;483  ;FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อผู้รับเงินได้พึงประเมิน }
            { 86  ;Shape        ;7080 ;2370 ;50   ;1465 ;ShapeStyle=VertLine }
            { 87  ;Label        ;1440 ;2911 ;5280 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็นบริษัทจำกัด ห้างหุ้นส่วน }
            { 88  ;Label        ;1440 ;3334 ;5250 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=จำกัด หรือห้างหุ้นส่วนสามัญนิติบุคคล) }
            { 89  ;Label        ;900  ;1020 ;4950 ;996  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=20;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.53 }
            { 90  ;Label        ;0    ;1320 ;930  ;696  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบต่อ }
            { 91  ;Shape        ;1260 ;2370 ;30   ;2790 ;ShapeStyle=VertLine }
            { 92  ;Label        ;90   ;3630 ;1110 ;510  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลำดับที่ }
            { 95  ;Shape        ;0    ;2370 ;30   ;2790 ;ShapeStyle=VertLine }
            { 96  ;Shape        ;15   ;5127 ;27675;30   ;ShapeStyle=HorzLine }
            { 174 ;TextBox      ;19740;1590 ;1350 ;423  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000004;TextBox;22440;1620 ;1350 ;423  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         SourceExpr=pNO }
            { 1000000005;Label  ;12900;3900 ;1650 ;581  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=วัน เดือน ปี }
            { 1000000006;Label  ;12900;4429 ;1650 ;554  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         CaptionML=ENU=ที่จ่าย }
            { 1000000031;TextBox;6990 ;1080 ;11430;690  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000110;Shape  ;21630;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000111;TextBox;21180;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[11] }
            { 1000000114;TextBox;21630;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[12] }
            { 1000000145;TextBox;22080;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[13] }
            { 1000000146;Shape  ;22080;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000147;Shape  ;21180;300  ;30   ;423  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27810;
            SectionHeight=1800;
            OnPreSection=BEGIN
                           CLEAR(OldData);
                           WHTEntry := "WHT Entry";
                           //WHTEntry.SETCURRENTKEY("Entry Type","WHT Slip No.","Pay-to/Bill-to Account Type","Pay-to/Bill-to Account No.","Open Entry");
                           //KK : #1 +
                           //WHTEntry.SETCURRENTKEY("Entry Type","Posting Date","WHT Certificate No.","Pay-to/Bill-to Account Type",
                           //  "Pay-to/Bill-to Account No.","Open Entry");

                           //WHTEntry.SETCURRENTKEY("Transaction Type","Document Type","Document No.","Bill-to/Pay-to No.");
                           WHTEntry.SETCURRENTKEY("Document Type","Posting Date","WHT Certificate No.");  //KKE : #003
                           //KK : #1 -
                           IF WHTEntry.NEXT <> 0 THEN BEGIN
                             IF NewDocNo = WHTEntry."WHT Certificate No." THEN
                               OldData := TRUE;
                           END;

                           IF OldData THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE BEGIN
                             IF Integer1.Number = 1 THEN BEGIN
                               CurrReport.SHOWOUTPUT(FALSE);
                               PageHeight := PageHeight + 1830;
                               IF ((8670  - PageHeight) < 1830) AND (i <= 3) THEN BEGIN
                                 PageHeight := 0;
                                 pNO := pNO + 1;
                               END;
                             END ELSE
                               SNo := SNo + 1;
                           END;
                         END;

            OnPostSection=BEGIN
                            IF NOT OldData THEN BEGIN
                              IF Integer1.Number <> 1 THEN BEGIN
                                TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT +
                                          WHTBaseAmtLCYExcVAT[1] + WHTBaseAmtLCYExcVAT[2] + WHTBaseAmtLCYExcVAT[3];
                                TotWHTAmtLCY := TotWHTAmtLCY +
                                          WHTAmtLCY[1] + WHTAmtLCY[2] + WHTAmtLCY[3];
                                TotWHTBaseAmtLCYExcVAT2 := TotWHTBaseAmtLCYExcVAT2 +
                                          WHTBaseAmtLCYExcVAT[1] + WHTBaseAmtLCYExcVAT[2] + WHTBaseAmtLCYExcVAT[3];
                                TotWHTAmtLCY2 := TotWHTAmtLCY2 +
                                          WHTAmtLCY[1] + WHTAmtLCY[2] + WHTAmtLCY[3];
                              END;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000036;Label  ;2130 ;450  ;10500;501  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 8   ;Shape        ;27650;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 9   ;Shape        ;26310;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 11  ;Shape        ;23160;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 97  ;Shape        ;19680;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 98  ;Shape        ;18330;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 99  ;Shape        ;14610;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 102 ;Shape        ;12780;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 104 ;Label        ;2130 ;960  ;10500;480  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 105 ;TextBox      ;2250 ;990  ;10230;750  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         MultiLine=Yes;
                                                         SourceExpr=Address + '  ' + Address2 + '  ' + City }
            { 118 ;Label        ;1380 ;960  ;750  ;480  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 132 ;Label        ;1380 ;450  ;780  ;510  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 133 ;Shape        ;1260 ;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 134 ;Shape        ;0    ;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 170 ;TextBox      ;120  ;720  ;960  ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=SNo }
            { 1000000080;TextBox;12900;240  ;1650 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PostingDate }
            { 1000000083;TextBox;14710;240  ;3570 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTExpenseText[1] }
            { 1000000082;TextBox;14710;750  ;3570 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTExpenseText[2] }
            { 1000000017;TextBox;18480;240  ;1140 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[1] }
            { 1000000012;TextBox;18480;750  ;1140 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[2] }
            { 1000000016;TextBox;19890;240  ;3180 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[1] }
            { 1000000011;TextBox;19890;750  ;3180 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[2] }
            { 1000000003;TextBox;23280;240  ;2910 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[1] }
            { 1000000002;TextBox;23280;750  ;2910 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[2] }
            { 1000000001;TextBox;26420;240  ;1170 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTTerm }
            { 1000000084;TextBox;2250 ;450  ;10230;510  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Name }
            { 1000000032;TextBox;14710;1290 ;3570 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTExpenseText[3] }
            { 1000000033;TextBox;18480;1290 ;1140 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[3] }
            { 1000000034;TextBox;19890;1290 ;3180 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[3] }
            { 1000000035;TextBox;23280;1290 ;2910 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[3] }
            { 1000000038;Label  ;2130 ;1350 ;10500;420  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000078;TextBox;210  ;0    ;6000 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TestText }
            { 1000000094;TextBox;10827;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[10] }
            { 1000000096;Shape  ;10827;0    ;423  ;423   }
            { 1000000097;Shape  ;10677;0    ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000099;Shape  ;8985 ;0    ;1692 ;423   }
            { 1000000102;TextBox;10254;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[9] }
            { 1000000104;Shape  ;10254;0    ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000106;TextBox;9831 ;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[8] }
            { 1000000108;Shape  ;9831 ;0    ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000112;TextBox;9408 ;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[7] }
            { 1000000113;TextBox;8985 ;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[6] }
            { 1000000118;Shape  ;9408 ;0    ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000119;Shape  ;8835 ;0    ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000120;Shape  ;7143 ;0    ;1692 ;423   }
            { 1000000121;TextBox;8412 ;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[5] }
            { 1000000122;Shape  ;8412 ;0    ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000123;TextBox;7989 ;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[4] }
            { 1000000124;Shape  ;7989 ;0    ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000125;TextBox;7566 ;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[3] }
            { 1000000126;Shape  ;7566 ;0    ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000127;TextBox;7143 ;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[2] }
            { 1000000128;Shape  ;6993 ;0    ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000129;Shape  ;6570 ;0    ;423  ;423   }
            { 1000000130;TextBox;6570 ;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[1] }
            { 1000000090;TextBox;5760 ;540  ;210  ;30   ;SourceExpr="Entry No." }
            { 1000000095;Label  ;5760 ;450  ;210  ;60   ;ParentControl=1000000090;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000098;Shape  ;11190;0    ;423  ;423   }
            { 1000000100;Shape  ;11580;0    ;423  ;423   }
            { 1000000101;Shape  ;12000;0    ;423  ;423   }
            { 1000000103;TextBox;11220;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[11] }
            { 1000000107;TextBox;11610;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[12] }
            { 1000000109;TextBox;12000;0    ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[13] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27810;
            SectionHeight=30;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           IF i > 3 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           IF OldData THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000030;Shape  ;15   ;0    ;27675;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=No;
            SectionWidth=27810;
            SectionHeight=4260;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE
                           IF CurrReport.PAGENO = pNO THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 15  ;Shape        ;27650;0    ;30   ;4230 ;ShapeStyle=VertLine }
            { 16  ;Shape        ;26310;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 17  ;Label        ;13920;0    ;5610 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=รวมยอดเงินได้และภาษีที่นำส่ง }
            { 136 ;Shape        ;19680;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 137 ;Shape        ;19680;500  ;6640 ;30   ;ShapeStyle=HorzLine }
            { 138 ;Shape        ;12780;0    ;30   ;4260 ;ShapeStyle=VertLine }
            { 139 ;Label        ;240  ;420  ;10050;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(1) ให้ระบุว่าจ่ายเป็นค่าอะไร เช่น ค่าเช่าอาคาร ค่าสอบบัญชี }
            { 140 ;Label        ;870  ;840  ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ค่าออกแบบ  ค่าก่อสร้างโรงเรียน  ค่าซื้อเครื่องพิมพ์ดีด }
            { 141 ;Label        ;870  ;1260 ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU="ค่าซื้อพืชผลทางการเกษตร  ( ยางพารา มันสำปะหลัง ปอ ข้าว ฯลฯ) " }
            { 142 ;Label        ;360  ;0    ;3540 ;450  ;FontName=Tahoma;
                                                         FontSize=10;
                                                         CaptionML=ENU=หมายเหตุ }
            { 143 ;Shape        ;0    ;0    ;30   ;4260 ;ShapeStyle=VertLine }
            { 144 ;Label        ;870  ;1680 ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU="ค่าจ้างทำของ ค่าจ้างโฆษณา ดอกเบี้ยเงินฝาก ดอกเบี้ยตั๋วเงิน " }
            { 145 ;Label        ;870  ;2100 ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU="เงินปันผล เงินส่วนแบ่งของกำไร รางวัลใน การประกวด  การแข่งขัน  " }
            { 146 ;Label        ;870  ;2520 ;9870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=การชิงโชค  ฯลฯ }
            { 147 ;Label        ;17080;1680 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ลงชื่อ }
            { 148 ;Label        ;23880;1620 ;1590 ;510  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 149 ;Label        ;18420;1680 ;5400 ;423  ;HorzAlign=General;
                                                         VertAlign=Bottom;
                                                         CaptionML=ENU=..................................................................... }
            { 151 ;Label        ;240  ;3180 ;10020;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(2) เงื่อนไขการหักภาษี ณ ที่จ่ายให้กรอกดังนี้ }
            { 154 ;Label        ;810  ;3603 ;9450 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=- หัก ณ ที่จ่าย กรอก 1     - ออกภาษีให้ กรอก 2 }
            { 155 ;Label        ;17120;2970 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ตำแหน่ง }
            { 156 ;Label        ;18460;2970 ;6810 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................. }
            { 158 ;Label        ;17100;3582 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ยื่นวันที่ }
            { 159 ;Label        ;19670;3582 ;930  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เดือน }
            { 160 ;Label        ;22730;3582 ;870  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=พ.ศ. }
            { 161 ;Label        ;18440;3582 ;1230 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.............. }
            { 162 ;Label        ;20600;3582 ;2130 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................... }
            { 163 ;Label        ;23600;3582 ;1650 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................... }
            { 164 ;Shape        ;15   ;4230 ;27675;30   ;ShapeStyle=HorzLine }
            { 168 ;TextBox      ;19890;0    ;3150 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 169 ;TextBox      ;23310;0    ;2910 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 172 ;Shape        ;23160;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000007;Shape  ;14820;2130 ;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000008;Label  ;14870;2330 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000009;Label  ;14870;2646 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000010;Label  ;14870;2930 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000037;Label  ;18420;2310 ;5490 ;423  ;HorzAlign=General;
                                                         VertAlign=Bottom;
                                                         CaptionML=ENU=(..................................................................) }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(4..));
        OnPreDataItem=BEGIN
                        IF OldData THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > i THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27810;
            SectionHeight=450;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN BEGIN
                             CurrReport.SHOWOUTPUT(FALSE);
                             PageHeight := PageHeight + 450;
                             IF (8670  - PageHeight) < 450 THEN BEGIN
                               PageHeight := 0;
                               pNO := pNO + 1;
                             END;
                           END;
                         END;

            OnPostSection=BEGIN
                            IF Integer1.Number <> 1 THEN BEGIN
                              TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT +
                                        WHTBaseAmtLCYExcVAT[Number];
                              TotWHTAmtLCY := TotWHTAmtLCY +
                                        WHTAmtLCY[Number];
                              TotWHTBaseAmtLCYExcVAT2 := TotWHTBaseAmtLCYExcVAT2 +
                                        WHTBaseAmtLCYExcVAT[Number];
                              TotWHTAmtLCY2 := TotWHTAmtLCY2 +
                                        WHTAmtLCY[Number];
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000000;Shape  ;27650;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000014;Shape  ;26310;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000015;Shape  ;23160;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000019;Shape  ;19680;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000020;Shape  ;18330;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000021;Shape  ;14610;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000022;Shape  ;12780;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000023;Shape  ;1260 ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000024;Shape  ;0    ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000025;TextBox;23310;0    ;2910 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[Number] }
            { 1000000026;TextBox;19890;0    ;3150 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[Number] }
            { 1000000027;TextBox;18480;0    ;1140 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[Number] }
            { 1000000028;TextBox;14710;0    ;3570 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTExpenseText[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27810;
            SectionHeight=30;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000029;Shape  ;15   ;0    ;27675;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..4));
        DataItemVarName=Line Space;
        OnPreDataItem=BEGIN
                        IF SNo MOD 4 = 0 THEN
                          CurrReport.BREAK
                        ELSE
                          SETRANGE(Number,1,4 - (SNo MOD 4));
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27810;
            SectionHeight=1830;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000079;Label  ;2130 ;450  ;10500;501  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000081;Shape  ;27650;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000085;Shape  ;26310;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000086;Shape  ;23160;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000087;Shape  ;19680;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000088;Shape  ;18330;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000089;Shape  ;14610;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000092;Shape  ;12780;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000093;Label  ;2130 ;960  ;10500;480  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000105;Label  ;1380 ;960  ;750  ;480  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000115;Label  ;1380 ;450  ;780  ;510  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000116;Shape  ;1260 ;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000117;Shape  ;0    ;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000134;Label  ;2130 ;1350 ;10500;420  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000091;Shape  ;0    ;1800 ;27675;30   ;ShapeStyle=HorzLine }
            { 1000000131;Shape  ;7860 ;30   ;423  ;423   }
            { 1000000132;Shape  ;8283 ;30   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000133;Shape  ;8433 ;30   ;1692 ;423   }
            { 1000000135;Shape  ;8856 ;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000136;Shape  ;9279 ;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000137;Shape  ;9702 ;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000138;Shape  ;10275;30   ;1692 ;423   }
            { 1000000139;Shape  ;10125;30   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000140;Shape  ;10698;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000141;Shape  ;11121;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000142;Shape  ;11544;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000143;Shape  ;11967;30   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000144;Shape  ;12117;30   ;423  ;423   }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=4620;
      Height=1100;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1000000000;TextBox;2640 ;110  ;1700 ;440  ;CaptionML=ENU=Branch;
                                                   SourceExpr=BranchNo }
      { 1000000001;Label  ;0    ;110  ;2530 ;440  ;ParentControl=1000000000 }
      { 1000000002;CheckBox;2640;660  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Test Report;
                                                   SourceExpr=PrintTest }
      { 1000000003;Label  ;0    ;660  ;2530 ;440  ;ParentControl=1000000002 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLSetup@1000000032 : Record 98;
      CompanyInfo@1000000000 : Record 79;
      Vendor@1000000001 : Record 23;
      WHTRevType@1000000002 : Record 28042;
      WHTBusPostinGrp@1000000041 : Record 28040;
      WHTEntry@1000000035 : Record 28044;
      WHTEntry2@1000000040 : Record 28044;
      NewDocNo@1000000010 : Code[20];
      Name@1000000003 : Text[150];
      Address@1000000004 : Text[250];
      Address2@1000000005 : Text[250];
      City@1000000006 : Text[30];
      VAT@1000000014 : ARRAY [20] OF Code[1];
      SNo@1000000013 : Integer;
      CId@1000000012 : ARRAY [20] OF Code[1];
      i@1000000011 : Integer;
      pNO@1000000008 : Integer;
      PostingDate@1000000009 : Date;
      WHTExpenseText@1000000024 : ARRAY [100] OF Text[30];
      "WHT%"@1000000023 : ARRAY [100] OF Decimal;
      WHTBaseAmtLCYExcVAT@1000000020 : ARRAY [100] OF Decimal;
      WHTAmtLCY@1000000019 : ARRAY [100] OF Decimal;
      TotWHTBaseAmtLCYExcVAT@1000000037 : Decimal;
      TotWHTAmtLCY@1000000036 : Decimal;
      TotWHTBaseAmtLCYExcVAT2@1000000016 : Decimal;
      TotWHTAmtLCY2@1000000015 : Decimal;
      WHTTerm@1000000018 : Text[1];
      PageHeight@1000000028 : Integer;
      OldData@1000000033 : Boolean;
      Branch@1000000038 : ARRAY [4] OF Code[1];
      BranchNo@1000000039 : Text[4];
      MatchType@1000000042 : Boolean;
      ShowData@1000000007 : Boolean;
      PrintTest@1000000021 : Boolean;
      TestText@1000000017 : Text[70];
      PurchInvHeader@1000000022 : Record 122;
      NewVendor@1000000025 : Code[20];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   Update for version 4.0 TH.
      002   20.06.2005   KKE   Update for 'Dummy Vendor' and 'VAT Registration No. (Dummy)'.
      003   09.08.2006   KKE   Sorting data by Posting Date.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50001 FORM 3
{
  OBJECT-PROPERTIES
  {
    Date=03/12/12;
    Time=[ 2:43:51 PM];
    Modified=Yes;
    Version List=AVATHA4.02;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=800;
    OnPreReport=BEGIN
                  IF CompanyInfo.GET THEN
                    FOR i := 1 TO STRLEN(CompanyInfo."VAT Registration No.") DO
                      CId[i] := COPYSTR(CompanyInfo."VAT Registration No.",i,1);

                  FOR i := 1 TO STRLEN(BranchNo) DO
                    Branch[i] := COPYSTR(BranchNo,i,1);

                  GLSetup.FIND('-');

                  WHTTerm := '1';
                END;

    Orientation=Landscape;
    PaperSize=A4 210 x 297 mm;
    HorzGrid=100;
    VertGrid=30;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..2));
        DataItemVarName=Integer1;
        OnPreDataItem=BEGIN
                        pNO := 1;
                      END;

        OnAfterGetRecord=BEGIN
                           IF (pNO >= 2) AND (Number > 1) AND (PageHeight = 0) THEN
                             pNO := pNO - 1;

                           PageHeight := 0;
                           SNo := 0;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27930;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27930;
            SectionHeight=4590;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(SNo <> 0);
                         END;

          }
          CONTROLS
          {
            { 1000000022;Label  ;108  ;978  ;2826 ;476  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000024;Label  ;300  ;1692 ;16290;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(1) ให้ระบุว่าจ่ายเป็นค่าอะไร เช่น ค่าเช่าอาคาร ค่าสอบบัญชี ค่าทนายความ ค่าวิชาชีพของแพทย์ ค่าก่อสร้าง รางวัลในการ }
            { 1000000027;Label  ;828  ;2115 ;15768;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ประกวด การแข่งขัน การชิงโชค ค่าจ้างแสดงภาพยนตร์ ร้องเพลง ดนตรี ค่าจ้างทำของ ค่าจ้างโฆษณา ฯลฯ }
            { 1000000036;Label  ;300  ;2961 ;10584;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(2)  เงื่อนไขการหักภาษี ให้กรอกดังนี้    - หัก ณ ที่จ่าย     กรอก 1 }
            { 1000000040;Label  ;5490 ;3384 ;5346 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=- ออกให้ตลอดไป  กรอก 2 }
            { 1000000041;Label  ;5490 ;3807 ;5364 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=- ออกให้ครั้งเดียว  กรอก 3 }
            { 1000000042;Label  ;8316 ;0    ;11070;480  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมยอดเงินได้และภาษีที่นำส่ง (นำไปรวมกับใบต่อ ภ.ง.ด.3  ฉบับอื่น (ถ้ามี)) }
            { 1000000043;Label  ;414  ;0    ;5706 ;480  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(ให้กรอกลำดับที่ต่อเนื่องกันไปทุกแผ่น) }
            { 1000000044;Label  ;19428;1692 ;900  ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ลงชื่อ }
            { 1000000046;Label  ;19428;2961 ;1290 ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ตำแหน่ง }
            { 1000000047;Label  ;19386;3750 ;1200 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ยื่นวันที่ }
            { 1000000048;Label  ;22086;3750 ;900  ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เดือน }
            { 1000000049;Label  ;25086;3750 ;750  ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=พ.ศ. }
            { 1000000050;Label  ;25728;1692 ;1650 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 1000000051;Shape  ;16770;425  ;30   ;4015 ;ShapeStyle=VertLine }
            { 1000000052;Label  ;19428;2300 ;7950 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=(.................................................................................................) }
            { 1000000053;Shape  ;20500;0    ;30   ;1010 ;ShapeStyle=VertLine }
            { 1000000054;Shape  ;17895;423  ;6300 ;30   ;ShapeStyle=HorzLine }
            { 1000000055;Shape  ;26385;0    ;30   ;1010 ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;23400;0    ;30   ;1010 ;ShapeStyle=VertLine }
            { 1000000057;Shape  ;0    ;0    ;30   ;4410 ;ShapeStyle=VertLine }
            { 1000000058;Shape  ;15   ;423  ;27846;30   ;ShapeStyle=HorzLine }
            { 1000000059;Shape  ;27840;0    ;30   ;4410 ;ShapeStyle=VertLine }
            { 1000000060;Shape  ;15   ;4410 ;27846;30   ;ShapeStyle=HorzLine }
            { 1000000061;Label  ;20328;1692 ;5400 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................................................................ }
            { 1000000062;Label  ;20670;2961 ;6708 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................... }
            { 1000000063;Label  ;20586;3750 ;1500 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=........................... }
            { 1000000064;Label  ;22986;3750 ;2100 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................... }
            { 1000000065;Label  ;25836;3750 ;1500 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=......................... }
            { 1000000066;TextBox;20600;0    ;2700 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 1000000067;TextBox;23600;0    ;2700 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000068;Shape  ;17508;1923 ;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000069;Label  ;17558;2123 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000070;Label  ;17558;2439 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000071;Label  ;17558;2723 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000072;Shape  ;15   ;0    ;27846;30   ;ShapeStyle=HorzLine }
            { 1000000073;Shape  ;20500;900  ;5910 ;30   ;ShapeStyle=HorzLine }
            { 1000000074;TextBox;20600;450  ;2700 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT2 }
            { 1000000075;TextBox;23600;470  ;2700 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY2 }
            { 1000000076;Label  ;17800;450  ;2500 ;480  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=รวมทั้งหมด }
            { 1000000077;Shape  ;20500;980  ;5910 ;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table28044;
        DataItemTableView=SORTING(Document Type,Posting Date,WHT Certificate No.)
                          WHERE(Transaction Type=CONST(Purchase),
                                Document Type=CONST(Payment),
                                Amount=FILTER(<>0),
                                WHT Report=CONST(Por Ngor Dor 3),
                                Cancelled=CONST(No));
        OnPreDataItem=BEGIN
                        WHTEntry.COPYFILTERS("WHT Entry");
                        IF WHTEntry.FIND('-') THEN;

                        CLEAR(NewDocNo);
                        CLEAR(Name);
                        CLEAR(Address);
                        CLEAR(VAT);
                        CLEAR(PostingDate);
                        CLEAR(WHTExpenseText);
                        CLEAR("WHT%");
                        CLEAR(WHTBaseAmtLCYExcVAT);
                        CLEAR(WHTAmtLCY);
                      END;

        OnAfterGetRecord=BEGIN
                           IF NewDocNo <> "WHT Certificate No." THEN BEGIN
                             NewDocNo := "WHT Certificate No.";
                             CLEAR(Name);
                             CLEAR(Address);
                             CLEAR(VAT);
                             CLEAR(PId);
                             CLEAR(PostingDate);
                             CLEAR(WHTExpenseText);
                             CLEAR("WHT%");
                             CLEAR(WHTBaseAmtLCYExcVAT);
                             CLEAR(WHTAmtLCY);
                           END;

                           IF "Actual Vendor No." <> '' THEN
                             Vendor.GET("Actual Vendor No.")
                           ELSE
                             Vendor.GET("Bill-to/Pay-to No.");

                           //KKE : #002 +
                           IF "Dummy Vendor" AND PurchInvHeader.GET("Document No.") THEN BEGIN
                             IF PurchInvHeader."Pay-to Name (Thai)" <> '' THEN BEGIN
                               Name := PurchInvHeader."Pay-to Name (Thai)";
                               Address := PurchInvHeader."Pay-to Address (Thai)";
                             END ELSE BEGIN
                               Name := PurchInvHeader."Pay-to Name" + PurchInvHeader."Pay-to Name 2";
                               Address := PurchInvHeader."Pay-to Address" + ' ' +
                                          PurchInvHeader."Pay-to Address 2" + ' ' + PurchInvHeader."Pay-to Address 3";
                             END;
                             FOR i := 1 TO STRLEN("VAT Registration No.(Dummy)") DO
                               VAT[i] := COPYSTR("VAT Registration No.(Dummy)",i,1);
                           END ELSE BEGIN
                           //KKE : #002 -
                             IF Vendor."Name (Thai)" <> '' THEN BEGIN
                               Name := Vendor."Name (Thai)";
                               Address := Vendor."Address (Thai)";
                             END ELSE BEGIN
                               Name := Vendor.Name + Vendor."Name 2";
                               Address := Vendor.Address + ' ' + Vendor."Address 2" + ' ' + Vendor."Address 3";
                             END;
                             FOR i := 1 TO STRLEN(Vendor."VAT Registration No.") DO
                               VAT[i] := COPYSTR(Vendor."VAT Registration No.",i,1);
                           END;

                           FOR i := 1 TO STRLEN(Vendor."ID No.") DO
                             PId[i] := COPYSTR(Vendor."ID No.",i,1);

                           PostingDate := "Posting Date";

                           IF WHTRevType.GET("WHT Revenue Type") THEN BEGIN
                             i := 0;
                             MatchType := FALSE;
                             REPEAT
                               i := i + 1;
                               IF (WHTExpenseText[i] = '') OR (WHTExpenseText[i] = WHTRevType.Description) THEN
                                 MatchType := TRUE;
                             UNTIL (i=12) OR (MatchType);
                             WHTExpenseText[i] := WHTRevType.Description;
                             "WHT%"[i] := "WHT %";

                             WHTAmtLCY[i] := WHTAmtLCY[i] + "Amount (LCY)";
                             WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + "Base (LCY)";
                           END;

                           IF PrintTest THEN
                             TestText := "Original Document No." + '/ ' + "WHT Certificate No.";
                         END;

        ReqFilterFields=Transaction Type,Document Type,Document No.,WHT Certificate No.,Posting Date;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27930;
            SectionHeight=5183;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           TotWHTBaseAmtLCYExcVAT := 0;
                           TotWHTAmtLCY := 0;
                         END;

          }
          CONTROLS
          {
            { 8   ;Label        ;2830 ;966  ;6894 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ของผู้มีหน้าที่หักภาษี ณ ที่จ่าย กรณีเป็นบุคคลธรรมดา) }
            { 7   ;Label        ;2800 ;360  ;6156 ;633  ;FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขประจำตัวประชาชน }
            { 54  ;Label        ;900  ;1770 ;3168 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=20;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด. 3 }
            { 55  ;Label        ;0    ;2035 ;900  ;581  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบต่อ }
            { 1   ;Shape        ;9724 ;966  ;4500 ;423   }
            { 4   ;Shape        ;13774;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 6   ;Shape        ;13324;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 57  ;Shape        ;12874;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 59  ;Shape        ;12424;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 61  ;Shape        ;11974;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 63  ;Shape        ;11524;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 64  ;Shape        ;11074;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 65  ;Shape        ;11074;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 68  ;Shape        ;10624;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 70  ;Shape        ;10174;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 9   ;Label        ;14602;360  ;4260 ;607  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 10  ;Label        ;14602;966  ;4044 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ของผู้มีหน้าที่หักภาษี ณ ที่จ่าย) }
            { 72  ;Shape        ;18646;966  ;5700 ;423   }
            { 73  ;TextBox      ;22700;960  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[10] }
            { 74  ;TextBox      ;22300;960  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[9] }
            { 75  ;Shape        ;22696;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 76  ;TextBox      ;21796;966  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[8] }
            { 77  ;Shape        ;22246;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 78  ;TextBox      ;21346;966  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[7] }
            { 79  ;Shape        ;21796;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 80  ;TextBox      ;20896;966  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[6] }
            { 81  ;Shape        ;21346;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 82  ;TextBox      ;20446;966  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[5] }
            { 83  ;Shape        ;20896;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 84  ;TextBox      ;19996;966  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[4] }
            { 85  ;Shape        ;20446;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 86  ;Shape        ;19996;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 87  ;Shape        ;19996;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 89  ;TextBox      ;19546;966  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[3] }
            { 90  ;Shape        ;19546;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 91  ;TextBox      ;19096;966  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[2] }
            { 92  ;Shape        ;19096;966  ;30   ;423  ;ShapeStyle=VertLine }
            { 93  ;TextBox      ;18646;966  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[1] }
            { 14  ;Label        ;24912;966  ;1044 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=สาขาที่ }
            { 13  ;Label        ;26346;2352 ;1200 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=แผ่น }
            { 12  ;Label        ;23544;2352 ;1500 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ในจำนวน }
            { 11  ;Label        ;20844;2352 ;1200 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=แผ่นที่ }
            { 94  ;Label        ;22044;2352 ;1500 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=......................... }
            { 95  ;Label        ;25020;2352 ;1326 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.................. }
            { 96  ;TextBox      ;5922 ;1800 ;10500;816  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 98  ;Shape        ;10   ;3040 ;27846;30   ;ShapeStyle=HorzLine }
            { 99  ;Shape        ;0    ;3045 ;30   ;2130 ;ShapeStyle=VertLine }
            { 101 ;Shape        ;27840;3045 ;30   ;2130 ;ShapeStyle=VertLine }
            { 15  ;Label        ;36   ;3362 ;1200 ;1533 ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ลำดับที่ }
            { 97  ;Shape        ;1200 ;3045 ;30   ;2130 ;ShapeStyle=VertLine }
            { 16  ;Label        ;1350 ;3207 ;5880 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขประจำตัวประชาชน (ของผู้มีเงินได้) }
            { 17  ;Label        ;7320 ;3207 ;6030 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร (ของผู้มีเงินได้) }
            { 18  ;Label        ;1350 ;3957 ;10800;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อผู้มีเงินได้ }
            { 19  ;Label        ;1350 ;4507 ;2430 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ของผู้มีเงินได้ }
            { 23  ;Label        ;26460;4419 ;1332 ;688  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เงื่อนไข }
            { 38  ;Label        ;23400;3101 ;4422 ;582  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=รวมเงินภาษีที่หักและนำส่งในครั้งนี้ }
            { 103 ;Shape        ;22950;3757 ;4896 ;30   ;ShapeStyle=HorzLine }
            { 25  ;Label        ;23800;4137 ;2550 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 106 ;Shape        ;26385;3759 ;30   ;1424 ;ShapeStyle=VertLine }
            { 26  ;Label        ;23800;4737 ;2500 ;397  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=บาท }
            { 30  ;Label        ;14700;3045 ;7800 ;754  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=รายละเอียดเกี่ยวกับการจ่ายเงิน }
            { 27  ;Label        ;20500;3841 ;2700 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=จำนวนเงินที่จ่าย }
            { 37  ;Label        ;20500;4257 ;2800 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=แต่ละประเภทในครั้งนี้ }
            { 112 ;Shape        ;14100;3757 ;8862 ;30   ;ShapeStyle=HorzLine }
            { 113 ;Shape        ;14100;3045 ;30   ;2130 ;ShapeStyle=VertLine }
            { 117 ;Shape        ;20500;3783 ;30   ;1400 ;ShapeStyle=VertLine }
            { 32  ;Label        ;19552;3891 ;936  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=อัตรา }
            { 35  ;Label        ;14300;3944 ;1600 ;581  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=วัน เดือน ปี }
            { 118 ;Shape        ;15960;3783 ;30   ;1400 ;ShapeStyle=VertLine }
            { 29  ;Label        ;20800;4737 ;2400 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=บาท }
            { 119 ;Shape        ;19470;3783 ;30   ;1400 ;ShapeStyle=VertLine }
            { 33  ;Label        ;16132;4314 ;3258 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ถ้ามากกว่าหนึ่งประเภท }
            { 34  ;Label        ;16132;3891 ;3276 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(1) ประเภทเงินได้ }
            { 36  ;Label        ;16132;4737 ;3276 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=ให้กรอกเรียงลงไป) }
            { 189 ;Label        ;26460;3864 ;1314 ;555  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(2) }
            { 190 ;Label        ;19534;4314 ;954  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ภาษี }
            { 191 ;Label        ;19486;4737 ;1050 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ร้อยละ }
            { 141 ;TextBox      ;22044;2352 ;1350 ;423  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000000;Label  ;14300;4473 ;1600 ;554  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่จ่าย }
            { 1000000001;Shape  ;23400;3045 ;30   ;2130 ;ShapeStyle=VertLine }
            { 1000000002;Shape  ;19500;4713 ;6915 ;30   ;ShapeStyle=HorzLine }
            { 1000000003;TextBox;25002;2353 ;1350 ;423  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         SourceExpr=pNO }
            { 1000000004;Label  ;3762 ;4508 ;9450 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุเลขที่ ตรอก/ซอย ถนนตำบล/แขวง อำเภอ/เขต จังหวัด) }
            { 100 ;Shape        ;15   ;5127 ;27846;30   ;ShapeStyle=HorzLine }
            { 1000000009;TextBox;27300;960  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[4] }
            { 1000000012;TextBox;26850;960  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[3] }
            { 1000000014;Shape  ;27300;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000016;TextBox;26400;960  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[2] }
            { 1000000017;Shape  ;26850;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000018;TextBox;25950;960  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[1] }
            { 1000000019;Shape  ;26400;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000020;Shape  ;25950;960  ;1800 ;423   }
            { 1000000090;Shape  ;23100;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000093;TextBox;23100;960  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[11] }
            { 1000000094;TextBox;23500;990  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[12] }
            { 1000000097;TextBox;23900;990  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[13] }
            { 1000000098;Shape  ;23900;990  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000100;Shape  ;23500;960  ;30   ;423  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27930;
            SectionHeight=1800;
            OnPreSection=BEGIN
                           CLEAR(OldData);
                           WHTEntry := "WHT Entry";
                           //WHTEntry.SETCURRENTKEY("Entry Type","WHT Slip No.","Pay-to/Bill-to Account Type","Pay-to/Bill-to Account No.","Open Entry");
                           //KK : #1 +
                             //WHTEntry.SETCURRENTKEY("Entry Type","Posting Date","WHT Certificate No.","Pay-to/Bill-to Account Type",
                             //  "Pay-to/Bill-to Account No.","Open Entry");
                           //WHTEntry.SETCURRENTKEY("Transaction Type","Document Type","Document No.","Bill-to/Pay-to No.");
                           WHTEntry.SETCURRENTKEY("Document Type","Posting Date","WHT Certificate No.");  //KKE : #003
                           //KK : #1 -
                           IF WHTEntry.NEXT <> 0 THEN BEGIN
                             IF NewDocNo = WHTEntry."WHT Certificate No." THEN
                               OldData := TRUE;
                           END;

                           IF OldData THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE BEGIN
                             IF Integer1.Number = 1 THEN BEGIN
                               CurrReport.SHOWOUTPUT(FALSE);
                               PageHeight := PageHeight + 1830;
                               IF ((8670 - PageHeight) < 1830) AND (i <= 3) THEN BEGIN
                                 PageHeight := 0;
                                 IF Integer1.Number = 1 THEN
                                 pNO := pNO + 1;
                               END;
                             END ELSE
                               SNo := SNo + 1;
                           END;
                         END;

            OnPostSection=BEGIN
                            IF NOT OldData THEN BEGIN
                              IF Integer1.Number <> 1 THEN BEGIN
                                TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT +
                                          WHTBaseAmtLCYExcVAT[1] + WHTBaseAmtLCYExcVAT[2] + WHTBaseAmtLCYExcVAT[3];
                                TotWHTAmtLCY := TotWHTAmtLCY +
                                          WHTAmtLCY[1] + WHTAmtLCY[2] + WHTAmtLCY[3];
                                TotWHTBaseAmtLCYExcVAT2 := TotWHTBaseAmtLCYExcVAT2 +
                                          WHTBaseAmtLCYExcVAT[1] + WHTBaseAmtLCYExcVAT[2] + WHTBaseAmtLCYExcVAT[3];
                                TotWHTAmtLCY2 := TotWHTAmtLCY2 +
                                          WHTAmtLCY[1] + WHTAmtLCY[2] + WHTAmtLCY[3];
                              END;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000107;TextBox;26580;210  ;1170 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTTerm }
            { 1000000112;TextBox;23600;750  ;2664 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[2] }
            { 1000000113;TextBox;23600;210  ;2664 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[1] }
            { 1000000119;TextBox;20650;750  ;2600 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[2] }
            { 1000000121;TextBox;19510;750  ;900  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[2] }
            { 1000000124;Label  ;17542;1329 ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000127;Label  ;16822;761  ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000128;Label  ;16696;708  ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000129;TextBox;20650;210  ;2600 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[1] }
            { 1000000130;TextBox;19510;210  ;900  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[1] }
            { 1000000169;Label  ;1350 ;516  ;1440 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ - สกุล }
            { 1000000170;Label  ;2730 ;510  ;11300;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000171;TextBox;2880 ;516  ;10900;423  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Name }
            { 1000000174;TextBox;0    ;690  ;1080 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=SNo }
            { 1000000181;Label  ;1350 ;990  ;750  ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000182;Label  ;2100 ;990  ;11900;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=...................................................................................................................................................................................................... }
            { 1000000183;TextBox;2250 ;990  ;11500;690  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         MultiLine=Yes;
                                                         SourceExpr=Address + '  ' + Address2 }
            { 1000000185;Shape  ;0    ;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000186;Shape  ;14100;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000188;Shape  ;23400;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000190;Shape  ;26385;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000191;Shape  ;27840;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000193;Shape  ;19470;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000194;Shape  ;20500;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000195;Shape  ;1200 ;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000196;TextBox;14300;210  ;1600 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PostingDate }
            { 1000000197;Shape  ;15960;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000198;TextBox;16060;750  ;3330 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTExpenseText[2] }
            { 1000000199;TextBox;16060;210  ;3330 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTExpenseText[1] }
            { 1000000010;TextBox;16060;1280 ;3330 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTExpenseText[3] }
            { 1000000011;TextBox;19510;1280 ;900  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[3] }
            { 1000000013;TextBox;20650;1280 ;2600 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[3] }
            { 1000000015;TextBox;23600;1280 ;2664 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[3] }
            { 1000000021;Label  ;2100 ;1350 ;11900;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=...................................................................................................................................................................................................... }
            { 1000000078;TextBox;8200 ;1320 ;5800 ;423  ;HorzAlign=Right;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TestText }
            { 1000000081;Shape  ;1400 ;60   ;423  ;423   }
            { 1000000082;TextBox;1400 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[1] }
            { 1000000083;Shape  ;1823 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000084;Shape  ;1943 ;60   ;1692 ;423   }
            { 1000000086;TextBox;1943 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[2] }
            { 1000000087;TextBox;2366 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[3] }
            { 1000000088;Shape  ;2366 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000089;TextBox;2789 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[4] }
            { 1000000091;Shape  ;2789 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000092;Shape  ;2789 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000095;TextBox;3212 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[5] }
            { 1000000096;Shape  ;3212 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000099;Shape  ;3755 ;60   ;2115 ;423   }
            { 1000000101;TextBox;3755 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[6] }
            { 1000000103;Shape  ;3635 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000104;TextBox;4178 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[7] }
            { 1000000106;Shape  ;4178 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000109;TextBox;4601 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[8] }
            { 1000000111;Shape  ;4601 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000116;TextBox;5024 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[9] }
            { 1000000117;Shape  ;5024 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000120;TextBox;5447 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[10] }
            { 1000000123;Shape  ;5447 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000131;Shape  ;5870 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000133;Shape  ;5990 ;60   ;846  ;423   }
            { 1000000134;TextBox;5990 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[11] }
            { 1000000135;TextBox;6410 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[12] }
            { 1000000136;Shape  ;6410 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000137;Shape  ;6833 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000138;Shape  ;6953 ;60   ;423  ;423   }
            { 1000000139;TextBox;6953 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[13] }
            { 1000000140;Shape  ;9300 ;60   ;423  ;423   }
            { 1000000141;TextBox;9300 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[1] }
            { 1000000142;Shape  ;9723 ;60   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000143;Shape  ;9873 ;60   ;1692 ;423   }
            { 1000000144;TextBox;9873 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[2] }
            { 1000000145;TextBox;10296;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[3] }
            { 1000000146;Shape  ;10296;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000147;TextBox;10719;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[4] }
            { 1000000148;Shape  ;10719;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000149;TextBox;11142;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[5] }
            { 1000000150;Shape  ;11142;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000151;Shape  ;11565;60   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000152;Shape  ;11715;60   ;1692 ;423   }
            { 1000000153;TextBox;11715;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[6] }
            { 1000000154;TextBox;12138;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[7] }
            { 1000000155;Shape  ;12138;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000156;TextBox;12561;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[8] }
            { 1000000157;Shape  ;12561;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000158;TextBox;12984;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[9] }
            { 1000000159;Shape  ;12984;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000160;Shape  ;13407;60   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000161;Shape  ;13557;60   ;423  ;423   }
            { 1000000162;TextBox;13557;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[10] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27930;
            SectionHeight=30;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           IF i > 3 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           IF OldData THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000045;Shape  ;15   ;0    ;27846;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=No;
            SectionWidth=27930;
            SectionHeight=4560;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE
                           IF CurrReport.PAGENO = pNO THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 39  ;Label        ;108  ;978  ;2826 ;476  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 40  ;Label        ;300  ;1692 ;16290;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(1) ให้ระบุว่าจ่ายเป็นค่าอะไร เช่น ค่าเช่าอาคาร ค่าสอบบัญชี ค่าทนายความ ค่าวิชาชีพของแพทย์ ค่าก่อสร้าง รางวัลในการ }
            { 41  ;Label        ;828  ;2115 ;15768;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ประกวด การแข่งขัน การชิงโชค ค่าจ้างแสดงภาพยนตร์ ร้องเพลง ดนตรี ค่าจ้างทำของ ค่าจ้างโฆษณา ฯลฯ }
            { 42  ;Label        ;300  ;2961 ;10584;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(2)  เงื่อนไขการหักภาษี ให้กรอกดังนี้    - หัก ณ ที่จ่าย     กรอก 1 }
            { 43  ;Label        ;5490 ;3384 ;5346 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=- ออกให้ตลอดไป  กรอก 2 }
            { 44  ;Label        ;5490 ;3807 ;5364 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=- ออกให้ครั้งเดียว  กรอก 3 }
            { 46  ;Label        ;8316 ;0    ;11070;480  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมยอดเงินได้และภาษีที่นำส่ง (นำไปรวมกับใบต่อ ภ.ง.ด.3  ฉบับอื่น (ถ้ามี)) }
            { 47  ;Label        ;414  ;0    ;5706 ;480  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=(ให้กรอกลำดับที่ต่อเนื่องกันไปทุกแผ่น) }
            { 31  ;Label        ;19428;1692 ;900  ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ลงชื่อ }
            { 45  ;Label        ;19428;2961 ;1290 ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ตำแหน่ง }
            { 48  ;Label        ;19386;3750 ;1200 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ยื่นวันที่ }
            { 49  ;Label        ;22086;3750 ;900  ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เดือน }
            { 50  ;Label        ;25086;3750 ;750  ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=พ.ศ. }
            { 51  ;Label        ;25728;1692 ;1650 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 52  ;Shape        ;16770;425  ;30   ;4015 ;ShapeStyle=VertLine }
            { 53  ;Label        ;19428;2300 ;7950 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=(.................................................................................................) }
            { 105 ;Shape        ;20500;0    ;30   ;430  ;ShapeStyle=VertLine }
            { 108 ;Shape        ;17895;423  ;6300 ;30   ;ShapeStyle=HorzLine }
            { 111 ;Shape        ;26385;0    ;30   ;430  ;ShapeStyle=VertLine }
            { 115 ;Shape        ;23400;0    ;30   ;430  ;ShapeStyle=VertLine }
            { 122 ;Shape        ;0    ;0    ;30   ;4410 ;ShapeStyle=VertLine }
            { 133 ;Shape        ;15   ;423  ;27846;30   ;ShapeStyle=HorzLine }
            { 134 ;Shape        ;27840;0    ;30   ;4410 ;ShapeStyle=VertLine }
            { 135 ;Shape        ;15   ;4410 ;27846;30   ;ShapeStyle=HorzLine }
            { 183 ;Label        ;20328;1692 ;5400 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................................................................ }
            { 184 ;Label        ;20670;2961 ;6708 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................... }
            { 185 ;Label        ;20586;3750 ;1500 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=........................... }
            { 186 ;Label        ;22986;3750 ;2100 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................... }
            { 187 ;Label        ;25836;3750 ;1500 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=......................... }
            { 203 ;TextBox      ;20600;0    ;2700 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 204 ;TextBox      ;23600;0    ;2700 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000005;Shape  ;17508;1923 ;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000006;Label  ;17558;2123 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000007;Label  ;17558;2439 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000008;Label  ;17558;2723 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 123 ;Shape        ;15   ;0    ;27846;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(4..));
        OnPreDataItem=BEGIN
                        IF OldData THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > i THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27930;
            SectionHeight=450;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN BEGIN
                             CurrReport.SHOWOUTPUT(FALSE);
                             PageHeight := PageHeight + 450;
                             IF (8670 - PageHeight) < 450 THEN BEGIN
                               PageHeight := 0;
                               pNO := pNO + 1;
                             END;
                           END;
                         END;

            OnPostSection=BEGIN
                            IF Integer1.Number <> 1 THEN BEGIN
                              TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT +
                                        WHTBaseAmtLCYExcVAT[Number];
                              TotWHTAmtLCY := TotWHTAmtLCY +
                                        WHTAmtLCY[Number];
                              TotWHTBaseAmtLCYExcVAT2 := TotWHTBaseAmtLCYExcVAT2 +
                                        WHTBaseAmtLCYExcVAT[Number];
                              TotWHTAmtLCY2 := TotWHTAmtLCY2 +
                                        WHTAmtLCY[Number];
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000023;Shape  ;27840;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000025;Shape  ;26385;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000026;Shape  ;23400;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000028;Shape  ;20500;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000029;Shape  ;19470;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000030;Shape  ;15960;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000031;Shape  ;14100;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000032;Shape  ;1200 ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000033;Shape  ;0    ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000034;TextBox;23600;0    ;2704 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[Number] }
            { 1000000035;TextBox;20650;0    ;2600 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[Number] }
            { 1000000037;TextBox;19510;0    ;900  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[Number] }
            { 1000000038;TextBox;16060;0    ;3330 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTExpenseText[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27930;
            SectionHeight=30;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000039;Shape  ;15   ;0    ;27846;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..4));
        DataItemVarName=Line Space;
        OnPreDataItem=BEGIN
                        IF SNo MOD 4 = 0 THEN
                          CurrReport.BREAK
                        ELSE
                          SETRANGE(Number,1,4 - (SNo MOD 4));
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27930;
            SectionHeight=1830;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000079;Label  ;14314;364  ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000085;Label  ;17542;1329 ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000184;Label  ;1350 ;516  ;1440 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ - สกุล }
            { 1000000187;Label  ;2730 ;510  ;11300;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000208;Label  ;1350 ;990  ;750  ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000209;Label  ;2100 ;990  ;11900;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=...................................................................................................................................................................................................... }
            { 1000000211;Shape  ;0    ;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000212;Shape  ;14100;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000213;Shape  ;23400;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000214;Shape  ;26385;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000215;Shape  ;27840;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000216;Shape  ;19470;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000217;Shape  ;20500;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000218;Shape  ;1200 ;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000220;Shape  ;15960;0    ;30   ;1800 ;ShapeStyle=VertLine }
            { 1000000227;Label  ;2100 ;1350 ;11900;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=...................................................................................................................................................................................................... }
            { 1000000080;Shape  ;15   ;1800 ;27846;30   ;ShapeStyle=HorzLine }
            { 1000000163;Shape  ;1400 ;60   ;423  ;423   }
            { 1000000165;Shape  ;1823 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000166;Shape  ;1943 ;60   ;1692 ;423   }
            { 1000000172;Shape  ;2366 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000175;Shape  ;2789 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000176;Shape  ;2789 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000178;Shape  ;3212 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000179;Shape  ;3755 ;60   ;2115 ;423   }
            { 1000000189;Shape  ;3635 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000200;Shape  ;4178 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000202;Shape  ;4601 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000204;Shape  ;5024 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000206;Shape  ;5447 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000207;Shape  ;5870 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000210;Shape  ;5990 ;60   ;846  ;423   }
            { 1000000222;Shape  ;6410 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000223;Shape  ;6833 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000224;Shape  ;6953 ;60   ;423  ;423   }
            { 1000000226;Shape  ;9300 ;60   ;423  ;423   }
            { 1000000229;Shape  ;9723 ;60   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000230;Shape  ;9873 ;60   ;1692 ;423   }
            { 1000000233;Shape  ;10296;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000235;Shape  ;10719;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000237;Shape  ;11142;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000238;Shape  ;11565;60   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000239;Shape  ;11715;60   ;1692 ;423   }
            { 1000000242;Shape  ;12138;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000244;Shape  ;12561;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000246;Shape  ;12984;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000247;Shape  ;13407;60   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000248;Shape  ;13557;60   ;423  ;423   }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1000000000;TextBox;2640 ;110  ;1700 ;440  ;CaptionML=ENU=Branch;
                                                   SourceExpr=BranchNo }
      { 1000000001;Label  ;0    ;110  ;2530 ;440  ;ParentControl=1000000000 }
      { 1000000002;CheckBox;2640;660  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Test Report;
                                                   SourceExpr=PrintTest }
      { 1000000003;Label  ;0    ;660  ;2530 ;440  ;ParentControl=1000000002 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLSetup@1000000032 : Record 98;
      CompanyInfo@1000000007 : Record 79;
      Vendor@1000000006 : Record 23;
      WHTRevType@1000000044 : Record 28042;
      WHTBusPostinGrp@1000000043 : Record 28040;
      WHTEntry@1000000040 : Record 28044;
      WHTEntry2@1000000005 : Record 28044;
      NewDocNo@1000000011 : Code[20];
      Name@1000000003 : Text[150];
      Address@1000000002 : Text[250];
      Address2@1000000001 : Text[250];
      City@1000000000 : Text[30];
      VAT@1000 : ARRAY [20] OF Code[1];
      SNo@1007 : Integer;
      CId@1011 : ARRAY [20] OF Code[1];
      PId@1012 : ARRAY [20] OF Code[10];
      i@1000000004 : Integer;
      pNO@1000000008 : Integer;
      WHTTerm@1000000009 : Text[1];
      WHTExpenseType@1000000030 : ARRAY [12] OF Integer;
      WHTExpenseText@1000000010 : ARRAY [100] OF Text[30];
      "WHT%"@1000000014 : ARRAY [100] OF Decimal;
      WHTBaseAmtLCYExcVAT@1000000016 : ARRAY [100] OF Decimal;
      WHTAmtLCY@1000000015 : ARRAY [100] OF Decimal;
      TotWHTBaseAmtLCYExcVAT@1000000037 : Decimal;
      TotWHTAmtLCY@1000000036 : Decimal;
      TotWHTBaseAmtLCYExcVAT2@1000000013 : Decimal;
      TotWHTAmtLCY2@1000000012 : Decimal;
      PostingDate@1000000018 : Date;
      PageHeight@1000000028 : Integer;
      OldData@1000000035 : Boolean;
      Branch@1000000039 : ARRAY [4] OF Code[1];
      BranchNo@1000000038 : Text[4];
      MatchType@1000000034 : Boolean;
      PrintTest@1000000019 : Boolean;
      TestText@1000000017 : Text[70];
      PurchInvHeader@1000000020 : Record 122;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   Update for version 4.0 TH.
      002   20.06.2005   KKE   Update for 'Dummy Vendor' and 'VAT Registration No. (Dummy)'.
      003   09.08.2006   KKE   Sorting data by Posting Date.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50002 FORM 50 BIS
{
  OBJECT-PROPERTIES
  {
    Date=03/12/12;
    Time=[ 3:56:51 PM];
    Modified=Yes;
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=500;
    BottomMargin=500;
    LeftMargin=500;
    RightMargin=200;
    OnInitReport=BEGIN
                   NumberOfCopy := 1;
                   IF WHTEntry.FIND('-') THEN;

                   PaymentOption := 2 ; //TSA003
                 END;

    OnPreReport=BEGIN
                  IF CompanyInfo.GET THEN BEGIN
                    FOR i := 1 TO STRLEN(CompanyInfo."VAT Registration No.") DO
                      CID[i] := COPYSTR(CompanyInfo."VAT Registration No.",i,1);
                    //KKE : #004 +
                    IF CompanyInfo."Phone No." <> '' THEN
                      CompanyPhone := 'Tel. ' + CompanyInfo."Phone No.";
                    //KKE : #004 -
                    CompanyInfo.CALCFIELDS(Picture);
                  END;

                  //KKE : #004 +
                  FOR i := 1 TO STRLEN(ConductVATID) DO
                    CCID[i] := COPYSTR(ConductVATID,i,1);

                  FOR i := 1 TO STRLEN(ConductID) DO
                    ID2[i] := COPYSTR(ConductID,i,1);

                  FOR i := 1 TO STRLEN(EmployerAccount) DO
                    EID[i] := COPYSTR(EmployerAccount,i,1);

                  FOR i := 1 TO STRLEN(SocialID) DO
                    SoID[i] := COPYSTR(SocialID,i,1);
                  //KKE : #004 -

                  IF NumberOfCopy > 4 THEN
                    ERROR('Number of copies shouldnot be more than 4.');

                  GLSetup.FIND('-');
                  //TSA003
                  CLEAR(WHTTerm);
                  CASE PaymentOption OF
                    0 : WHTTerm[1] := 'P';
                    1 : WHTTerm[2] := 'P';
                    2 : WHTTerm[3] := 'P';
                    3 : WHTTerm[4] := 'P';
                  END;
                  //TSA003
                END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=10;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table28044;
        DataItemTableView=SORTING(Document Type,Posting Date,WHT Certificate No.)
                          WHERE(Transaction Type=CONST(Purchase),
                                Document Type=CONST(Payment),
                                Amount=FILTER(<>0),
                                Cancelled=CONST(No));
        OnAfterGetRecord=BEGIN
                           IF NewDocNo <> WHTEntry."WHT Certificate No." THEN BEGIN
                             NewDocNo := "WHT Certificate No.";
                             CLEAR(Name);
                             CLEAR(Address);
                             CLEAR(Phone);  //KKE : #004
                             CLEAR(VAT);
                             CLEAR(WHTGroup);
                             CLEAR(WHTPostingDate);
                             CLEAR(WHTExpenseText);
                             CLEAR(WHTBaseAmtLCYExcVAT);
                             CLEAR(WHTAmtLCY);
                             CLEAR(TotWHTBaseAmtLCYExcVAT);
                             CLEAR(TotWHTAmtLCY);
                             CLEAR(PostingDate);
                           END;

                           IF "Actual Vendor No." <> '' THEN
                             Vendor.GET("Actual Vendor No.")
                           ELSE
                             Vendor.GET("Bill-to/Pay-to No.");

                           //KKE : #002 +
                           IF "Dummy Vendor" AND PurchInvHeader.GET("Document No.") THEN BEGIN
                             IF PurchInvHeader."Pay-to Name (Thai)" <> '' THEN BEGIN
                               Name := PurchInvHeader."Pay-to Name (Thai)";
                               Address := PurchInvHeader."Pay-to Address (Thai)";
                             END ELSE BEGIN
                               Name := PurchInvHeader."Pay-to Name" + PurchInvHeader."Pay-to Name 2";
                               Address := PurchInvHeader."Pay-to Address" + '  ' +
                                          PurchInvHeader."Pay-to Address 2" + '  ' + PurchInvHeader."Pay-to Address 3";
                             END;
                             FOR i := 1 TO STRLEN("VAT Registration No.(Dummy)") DO
                               VAT[i] := COPYSTR("VAT Registration No.(Dummy)",i,1);
                           END ELSE BEGIN
                           //KKE : #002 -
                             IF Vendor."Name (Thai)" <> '' THEN BEGIN
                               Name := Vendor."Name (Thai)";
                               Address := Vendor."Address (Thai)";
                             END ELSE BEGIN
                               Name := Vendor.Name + Vendor."Name 2";
                               Address := Vendor.Address + ' ' + Vendor."Address 2" + ' ' + Vendor."Address 3";
                             END;
                             //KKE : #004 +
                             IF Vendor."Phone No." <> '' THEN
                               Phone := 'Tel. ' + Vendor."Phone No.";
                             FOR i := 1 TO 13 DO
                               ID3[i] := COPYSTR(Vendor."ID No.",i,1);
                             //KKE : #004 -
                             FOR i := 1 TO STRLEN(Vendor."VAT Registration No.") DO
                               VAT[i] := COPYSTR(Vendor."VAT Registration No.",i,1);
                           END;

                           IF "WHT Report" = "WHT Report"::"Por Ngor Dor 3" THEN
                             WHTGroup[1] := 'P'
                           ELSE IF "WHT Report" = "WHT Report"::"Por Ngor Dor 53" THEN
                             WHTGroup[2] := 'P';

                           IF WHTRevType.GET("WHT Revenue Type") THEN BEGIN
                             IF WHTRevType.Sequence = 0 THEN
                               CurrReport.SKIP;
                             i := WHTRevType.Sequence;
                             IF (i = 99) OR (i = 19) THEN BEGIN  //KKE : #004
                               i := 19;
                               WHTExpenseText := WHTRevType.Description;
                               //WHTExpenseText := 'ค่าเช่า';
                             END;
                             WHTPostingDate[i] := "Posting Date";
                             PostingDate := "Posting Date";

                             WHTAmtLCY[i] := WHTAmtLCY[i] + Amount;
                             TotWHTAmtLCY := TotWHTAmtLCY + Amount;
                             WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + Base;
                             TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT + Base;
                           END;

                           WHTSlipNo := "WHT Certificate No.";

                           IF PrintTest THEN
                             TestText := "Original Document No." + '/ ' + "WHT Certificate No.";
                         END;

        ReqFilterFields=Transaction Type,Document Type,Document No.,WHT Certificate No.;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..4));
        OnPreDataItem=BEGIN
                        IF NewDocNo = '' THEN
                          NewDocNo := "WHT Entry"."WHT Certificate No.";

                        WHTEntry.COPY("WHT Entry");
                        IF WHTEntry.NEXT <> 0 THEN BEGIN
                          IF NewDocNo = WHTEntry."WHT Certificate No." THEN
                            CurrReport.BREAK;
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > NumberOfCopy THEN
                             CurrReport.BREAK;

                           WHTAmtLCYText := FormatNoThaiText(TotWHTAmtLCY);
                           IF WHTAmtLCYText <> '' THEN
                             WHTAmtLCYText := '(' + WHTAmtLCYText + ')';
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19950;
            SectionHeight=1400;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FALSE;
                         END;

          }
          CONTROLS
          {
            { 1000000432;PictureBox;0 ;0    ;3780 ;1400 ;HorzGlue=Both;
                                                         SourceExpr=CompanyInfo.Picture }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19950;
            SectionHeight=26000;
          }
          CONTROLS
          {
            { 1000000000;Shape  ;150  ;9150 ;19100;16000;Visible=Yes }
            { 1000000001;Shape  ;6627 ;22600;423  ;423   }
            { 1000000002;Shape  ;18703;5850 ;423  ;423   }
            { 1000000004;Shape  ;18703;3350 ;423  ;423   }
            { 1000000005;Shape  ;13150;900  ;423  ;423   }
            { 1000000006;TextBox;18703;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[13] }
            { 1000000007;Shape  ;13693;900  ;1692 ;423   }
            { 1000000008;Shape  ;15505;900  ;2115 ;423   }
            { 1000000015;Shape  ;0    ;0    ;19890;26000;ShapeStyle=Rectangle }
            { 1000000016;Shape  ;150  ;20100;19100;30   ;ShapeStyle=HorzLine }
            { 1000000017;Label  ;300  ;19627;1750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=6. อื่นๆ (ระบุ) }
            { 1000000018;Label  ;8590 ;20162;4430 ;538  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมเงินที่จ่ายและภาษีที่หักนำส่ง }
            { 1000000019;Label  ;1620 ;25550;17690;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ผู้มีหน้าที่ออกหนังสือรับรองการหักภาษี ณ ที่จ่าย ฝ่าฝืนไม่ปฏิบัติตามมาตรา 50 ทวิ แห่งประมวลรัษฎากร ต้องรับโทษทางอาญาตามมาตรา 35 แห่งประมวลรัษฎากร }
            { 1000000020;Shape  ;150  ;9990 ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000021;Shape  ;150  ;5700 ;19120;3350 ;ShapeStyle=Rectangle }
            { 1000000022;Shape  ;150  ;800  ;19140;2350 ;ShapeStyle=Rectangle }
            { 1000000023;Label  ;350  ;5750 ;5050 ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ผู้ถูกหักภาษี ณ ที่จ่าย : }
            { 1000000024;Label  ;400  ;8000 ;1200 ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ลำดับที่ }
            { 1000000025;Label  ;300  ;10050;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=1. เงินเดือน ค่าจ้าง เบี้ยเลี้ยง โบนัส ฯลฯ ตามมาตรา 40 (1) }
            { 1000000026;Label  ;300  ;10450;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=2. ค่าธรรมเนียม ค่านายหน้า ฯลฯ ตามมาตรา 40 (2) }
            { 1000000027;Label  ;300  ;10850;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=3. ค่าแห่งลิขสิทธิ์ฯลฯ ตามมาตรา 40 (3) }
            { 1000000028;Label  ;300  ;11250;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=4. (ก)  ค่าดอกเบี้ย ฯลฯ ตามมาตรา 40 (4) ก }
            { 1000000029;Label  ;650  ;11650;8850 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ข) เงินปันผล เงินส่วนแบ่งกำไร ฯลฯ ตามมาตรา 40 (4) (ข) ที่จ่ายจาก }
            { 1000000030;Label  ;300  ;18050;10050;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=5. การจ่ายเงินได้ที่ต้องหักภาษี ณ ที่จ่ายตามคำสั่งกรมสรรพากรที่ออกตามมาตรา }
            { 1000000031;Label  ;600  ;18450;9750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=3 เตรส เช่น รางวัล ส่วนลดหรือประโยชน์ใดๆ เนื่องจากการส่งเสริมการขาย }
            { 1000000032;Label  ;600  ;18850;9750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=รางวัลในการประกวด การแข่งขัน การชิงโชค ค่าแสดงของนักแสดงสาธารณะ }
            { 1000000033;Label  ;600  ;19250;9720 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ค่าจ้างทำของ ค่าโฆษณา ค่าเช่า ค่าขนส่ง ค่าบริการ ค่าเบี้ยประกันวินาศภัย ฯลฯ }
            { 1000000034;Label  ;400  ;850  ;5100 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU="ผู้มีหน้าที่หักภาษี ณ ที่จ่าย : " }
            { 1000000035;Label  ;400  ;1300 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000036;Label  ;400  ;2200 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000037;Label  ;1950 ;9156 ;5100 ;846  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ประเภทเงินได้ที่จ่าย }
            { 1000000038;Shape  ;1700 ;8000 ;1400 ;423   }
            { 1000000039;Label  ;3450 ;8000 ;1150 ;523  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ในแบบ }
            { 1000000040;Shape  ;4900 ;8000 ;450  ;423   }
            { 1000000041;Shape  ;4900 ;8500 ;450  ;423   }
            { 1000000042;Label  ;6050 ;8000 ;1650 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.1ก }
            { 1000000043;Label  ;6050 ;8500 ;1650 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.2ก }
            { 1000000044;Label  ;300  ;25150;1340 ;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000045;Shape  ;8100 ;8000 ;450  ;423   }
            { 1000000046;Shape  ;8100 ;8500 ;450  ;423   }
            { 1000000047;Label  ;6650 ;150  ;5250 ;500  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ตามมาตรา 50 ทวิ แห่งประมวลรัษฎากร }
            { 1000000048;Label  ;10800;9150 ;2400 ;444  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=วัน เดือน }
            { 1000000049;Shape  ;10750;9150 ;30   ;10950;ShapeStyle=VertLine }
            { 1000000050;Shape  ;13290;20605;5960 ;30   ;ShapeStyle=HorzLine }
            { 1000000051;Label  ;150  ;100  ;6500 ;600  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หนังสือรับรองการหักภาษี ณ ที่จ่าย }
            { 1000000052;Label  ;9200 ;8000 ;2550 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.1ก พิเศษ }
            { 1000000053;Label  ;9200 ;8500 ;2550 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.3ก }
            { 1000000054;Shape  ;150  ;21200;19100;30   ;ShapeStyle=HorzLine }
            { 1000000055;Shape  ;150  ;23100;19100;30   ;ShapeStyle=HorzLine }
            { 1000000056;Label  ;290  ;23100;1650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 1000000057;Label  ;5170 ;23150;10550;550  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ขอรับรองว่า ข้อความและตัวเลขดังกล่าวข้างต้นถูกต้องตรงกับความจริงทุกประการ }
            { 1000000058;Label  ;5180 ;23900;860  ;523  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(ลงชื่อ) }
            { 1000000059;Shape  ;12100;8000 ;450  ;423   }
            { 1000000060;Shape  ;12100;8500 ;450  ;423   }
            { 1000000061;Label  ;5170 ;24550;6000 ;473  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................... }
            { 1000000062;Label  ;13200;8000 ;1950 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.2 }
            { 1000000063;Label  ;13250;8500 ;1950 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.53 }
            { 1000000064;Label  ;6020 ;23900;6640 ;523  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.............................................................................................. }
            { 1000000065;Shape  ;13280;9150 ;30   ;11550;ShapeStyle=VertLine }
            { 1000000066;Label  ;13400;9150 ;2650 ;846  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=จำนวนเงินที่จ่าย }
            { 1000000067;Shape  ;500  ;23500;500  ;360   }
            { 1000000068;Shape  ;500  ;23900;500  ;360   }
            { 1000000069;Label  ;1110 ;23500;2960 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=หักภาษี ณ ที่จ่าย }
            { 1000000070;Label  ;1110 ;23900;2990 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ออกภาษีให้ตลอดไป }
            { 1000000071;Shape  ;15450;8000 ;450  ;423   }
            { 1000000072;Label  ;12400;150  ;900  ;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=เล่มที่ }
            { 1000000073;Label  ;16500;8000 ;1450 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.3 }
            { 1000000074;Label  ;13300;150  ;2200 ;500  ;VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................ }
            { 1000000075;Label  ;9390 ;1350 ;3790 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000076;Label  ;9450 ;6300 ;3730 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000077;Shape  ;500  ;24300;500  ;360   }
            { 1000000078;Shape  ;500  ;24700;500  ;360   }
            { 1000000079;Label  ;12640;23900;3590 ;523  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ผู้มีหน้าที่หักภาษี ณ ที่จ่าย }
            { 1000000080;Label  ;11160;24550;4220 ;423  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=วัน เดือน ปี ที่ออกหนังสือรับรอง }
            { 1000000081;Shape  ;16400;9150 ;30   ;11550;ShapeStyle=VertLine }
            { 1000000082;Label  ;1110 ;24300;3400 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ออกภาษีให้ครั้งเดียว }
            { 1000000083;Label  ;1110 ;24700;3450 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=อื่นๆ ให้ระบุ................ }
            { 1000000102;TextBox;13400;20100;2550 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 1000000103;TextBox;16450;20100;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000120;Shape  ;16750;23400;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000121;Label  ;16800;23600;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000122;Label  ;16800;23916;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000123;Label  ;16800;24200;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000124;Label  ;15600;150  ;900  ;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000125;Label  ;16500;150  ;2550 ;500  ;VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................ }
            { 1000000132;Label  ;1100 ;1800 ;10050;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000133;Label  ;900  ;1300 ;8400 ;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000134;TextBox;1000 ;1300 ;8310 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000135;Label  ;1150 ;2700 ;14570;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000136;Label  ;1000 ;2200 ;18100;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000137;TextBox;1100 ;2200 ;17550;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + ' ' + CompanyInfo."Address 2" + ' ' + CompanyPhone }
            { 1000000142;Label  ;350  ;6250 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000143;Label  ;1050 ;6700 ;10100;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000144;Label  ;850  ;6250 ;8530 ;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000145;TextBox;950  ;6250 ;8440 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Name }
            { 1000000146;Label  ;350  ;7100 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000147;Label  ;900  ;7100 ;18200;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000148;TextBox;1050 ;7100 ;17600;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Address + '  ' + Address2 + '  ' + City + ' ' + Phone }
            { 1000000149;Label  ;1050 ;7600 ;14710;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000150;Label  ;5500 ;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(1) }
            { 1000000151;Label  ;8650 ;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(2) }
            { 1000000152;Label  ;12700;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(3) }
            { 1000000153;Label  ;16000;8000 ;550  ;450  ;FontName=ms san seriff;
                                                         FontSize=8;
                                                         CaptionML=ENU=(4) }
            { 1000000154;Label  ;5500 ;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(5) }
            { 1000000155;Label  ;8650 ;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(6) }
            { 1000000156;Label  ;12700;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(7) }
            { 1000000157;Label  ;10800;9550 ;2400 ;450  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=หรือปีภาษี ที่จ่าย }
            { 1000000158;Label  ;16600;9150 ;2200 ;444  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ภาษีที่หัก }
            { 1000000159;Label  ;16600;9594 ;2200 ;450  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=และนำส่งไว้ }
            { 1000000160;Shape  ;16000;10000;30   ;10700;ShapeStyle=VertLine }
            { 1000000161;Shape  ;18800;10000;30   ;10700;ShapeStyle=VertLine }
            { 1000000162;Label  ;900  ;12050;7800 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1) กิจการที่ต้องเสียภาษีเงินได้นิติบุคคลในอัตราดังนี้ }
            { 1000000163;Label  ;1950 ;12450;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.1) อัตราร้อยละ 30 ของกำไรสุทธิ }
            { 1000000164;Label  ;1950 ;12850;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.2) อัตราร้อยละ 25 ของกำไรสุทธิ }
            { 1000000165;Label  ;1960 ;13250;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.3) อัตราร้อยละ 20 ของกำไรสุทธิ }
            { 1000000166;Label  ;1950 ;13650;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.4) อัตราอื่นๆ (ระบุ)................... ของกำไรสุทธิ }
            { 1000000167;Shape  ;1400 ;12450;450  ;360   }
            { 1000000168;Shape  ;1400 ;12850;450  ;360   }
            { 1000000169;Shape  ;1400 ;13250;450  ;360   }
            { 1000000170;Shape  ;1400 ;13650;450  ;360   }
            { 1000000171;Label  ;900  ;14050;9800 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2) กิจการที่ได้รับยกเว้นภาษีเงินได้นิติบุคคล ซึ่งผู้รับเงินปันผลไม่ได้รับเครดิตภาษี }
            { 1000000172;Label  ;1350 ;14450;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.1) กำไรสุทธิของกิจการที่ได้รับยกเว้นภาษีเงินได้นิติบุคคล }
            { 1000000173;Label  ;1350 ;14850;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.2) เงินปันผลหรือเงินส่วนแบ่งของกำไรที่ได้รับยกเว้นไม่ต้องนำมารวม }
            { 1000000174;Label  ;290  ;20700;4360 ;500  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมเงินภาษีที่หักนำส่ง (ตัวอักษร) }
            { 1000000175;Label  ;1620 ;25150;14930;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ให้สามารถอ้างอิงหรือสอบยันกันได้ระหว่างลำดับที่ตามหนังสือรับรองฯ กับแบบยื่นรายการภาษีหัก ณ ที่จ่าย }
            { 1000000176;Label  ;320  ;25550;1340 ;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=คำเตือน }
            { 1000000177;TextBox;15550;8000 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTGroup[1] }
            { 1000000178;TextBox;12200;8500 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTGroup[2] }
            { 1000000179;TextBox;600  ;24320;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         OptionCaptionML=ENU=1;
                                                         OptionString=1;
                                                         SourceExpr=WHTTerm[1] }
            { 1000000180;TextBox;600  ;23920;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[2] }
            { 1000000181;TextBox;600  ;23520;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[3] }
            { 1000000182;TextBox;600  ;24720;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[4] }
            { 1000000183;TextBox;10800;10050;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[1] }
            { 1000000184;TextBox;10800;10450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[2] }
            { 1000000185;TextBox;10800;10850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[3] }
            { 1000000186;TextBox;10800;11250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[4] }
            { 1000000187;TextBox;10800;12450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[5] }
            { 1000000188;TextBox;10800;12850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[6] }
            { 1000000189;TextBox;10800;13250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[7] }
            { 1000000190;TextBox;10800;13650;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[8] }
            { 1000000191;TextBox;10800;14450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[9] }
            { 1000000192;TextBox;10800;14850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[10] }
            { 1000000193;TextBox;10800;15650;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[11] }
            { 1000000194;TextBox;10800;16450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[12] }
            { 1000000195;TextBox;13400;10050;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[1] }
            { 1000000196;TextBox;13400;10450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[2] }
            { 1000000197;TextBox;13400;10850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[3] }
            { 1000000198;TextBox;13400;11250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[4] }
            { 1000000199;TextBox;13400;12450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[5] }
            { 1000000200;TextBox;13400;12850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[6] }
            { 1000000201;TextBox;13400;13250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[7] }
            { 1000000202;TextBox;13400;13650;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[8] }
            { 1000000203;TextBox;13400;14450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[9] }
            { 1000000204;TextBox;13400;14850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[10] }
            { 1000000205;TextBox;13400;15650;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[11] }
            { 1000000206;TextBox;13400;16450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[12] }
            { 1000000207;TextBox;16450;10050;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[1] }
            { 1000000208;TextBox;16450;10450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[2] }
            { 1000000209;TextBox;16450;10850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[3] }
            { 1000000210;TextBox;16450;11250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[4] }
            { 1000000211;TextBox;16450;12450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[5] }
            { 1000000212;TextBox;16450;12850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[6] }
            { 1000000213;TextBox;16450;13250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[7] }
            { 1000000214;TextBox;16450;13650;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[8] }
            { 1000000215;TextBox;16450;14450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[9] }
            { 1000000216;TextBox;16450;14850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[10] }
            { 1000000217;TextBox;16450;15650;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[11] }
            { 1000000218;TextBox;16450;16450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[12] }
            { 1000000219;TextBox;1500 ;12450;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[1] }
            { 1000000220;TextBox;1500 ;12850;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[2] }
            { 1000000221;TextBox;1500 ;13250;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[3] }
            { 1000000222;TextBox;1500 ;13650;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[4] }
            { 1000000223;TextBox;16600;150  ;2250 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=WHTSlipNo }
            { 1000000224;TextBox;4740 ;20700;13860;500  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=WHTAmtLCYText }
            { 1000000225;TextBox;13400;150  ;2000 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=FormBookNo }
            { 1000000226;Label  ;2050 ;19677;8530 ;400  ;VertAlign=Bottom;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=.......................................................................................................................... }
            { 1000000227;TextBox;2150 ;19627;6700 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText }
            { 1000000228;Shape  ;150  ;3250 ;19150;2350 ;ShapeStyle=Rectangle }
            { 1000000229;Label  ;400  ;3300 ;5100 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU="กระทำการแทน : " }
            { 1000000230;Label  ;9400 ;3800 ;3750 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000231;Label  ;900  ;3750 ;8500 ;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000232;TextBox;1000 ;3750 ;8370 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ConductName }
            { 1000000253;Label  ;400  ;3750 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000254;Label  ;1100 ;4250 ;10050;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000255;Label  ;400  ;4650 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000256;Label  ;1000 ;4650 ;18100;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000257;TextBox;1100 ;4650 ;17600;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ConductAddress }
            { 1000000258;Label  ;1150 ;5150 ;14610;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000259;TextBox;6220 ;24500;4600 ;473  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PostingDate }
            { 1000000260;TextBox;17197;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[10] }
            { 1000000261;Shape  ;18703;900  ;423  ;423   }
            { 1000000262;Shape  ;17620;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000263;TextBox;16774;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[9] }
            { 1000000264;Shape  ;16774;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000265;TextBox;15928;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[7] }
            { 1000000266;TextBox;16351;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[8] }
            { 1000000267;Shape  ;16351;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000268;TextBox;15505;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[6] }
            { 1000000269;Shape  ;15928;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000270;TextBox;14962;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[5] }
            { 1000000271;Shape  ;15385;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000272;TextBox;14539;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[4] }
            { 1000000273;Shape  ;14962;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000274;TextBox;14116;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[3] }
            { 1000000275;Shape  ;14539;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000276;Shape  ;14539;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000277;TextBox;13693;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[2] }
            { 1000000278;Shape  ;14116;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000279;Shape  ;13573;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000280;TextBox;13150;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[1] }
            { 1000000281;Label  ;9400 ;850  ;3780 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขที่ประจำตัวประชาชน }
            { 1000000282;Shape  ;13290;20685;5960 ;30   ;ShapeStyle=HorzLine }
            { 1000000283;Shape  ;17197;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000284;Shape  ;17740;900  ;846  ;423   }
            { 1000000285;TextBox;17740;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[11] }
            { 1000000286;Shape  ;18583;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000287;Shape  ;18160;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000288;TextBox;18160;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[12] }
            { 1000000289;Label  ;9370 ;3300 ;3810 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขที่ประจำตัวประชาชน }
            { 1000000290;TextBox;18703;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[13] }
            { 1000000291;Shape  ;17740;3350 ;846  ;423   }
            { 1000000292;Shape  ;18583;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000293;TextBox;18160;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[12] }
            { 1000000294;Shape  ;15505;3350 ;2115 ;423   }
            { 1000000295;TextBox;17197;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[10] }
            { 1000000296;Shape  ;17620;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000297;TextBox;17740;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[11] }
            { 1000000298;Shape  ;18160;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000299;TextBox;16774;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[9] }
            { 1000000300;Shape  ;16774;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000301;TextBox;15928;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[7] }
            { 1000000302;TextBox;16351;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[8] }
            { 1000000303;Shape  ;16351;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000304;Shape  ;17197;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000305;TextBox;15505;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[6] }
            { 1000000306;Shape  ;15928;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000307;Shape  ;13693;3350 ;1692 ;423   }
            { 1000000308;TextBox;14962;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[5] }
            { 1000000309;Shape  ;15385;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000310;TextBox;14539;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[4] }
            { 1000000311;Shape  ;14962;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000312;TextBox;14116;3350 ;420  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[3] }
            { 1000000313;Shape  ;14539;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000314;Shape  ;14539;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000315;TextBox;13693;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[2] }
            { 1000000316;Shape  ;14116;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000317;Shape  ;13573;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000318;Shape  ;13150;3350 ;423  ;423   }
            { 1000000319;TextBox;13150;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[1] }
            { 1000000320;Label  ;9450 ;5800 ;3730 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขที่ประจำตัวประชาชน }
            { 1000000321;TextBox;18703;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[13] }
            { 1000000322;Shape  ;17740;5850 ;846  ;423   }
            { 1000000323;Shape  ;18583;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000324;TextBox;18160;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[12] }
            { 1000000325;Shape  ;15505;5850 ;2115 ;423   }
            { 1000000326;TextBox;17197;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[10] }
            { 1000000327;Shape  ;17620;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000328;TextBox;17740;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[11] }
            { 1000000329;Shape  ;18160;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000330;TextBox;16774;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[9] }
            { 1000000331;Shape  ;16774;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000332;TextBox;15928;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[7] }
            { 1000000333;TextBox;16351;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[8] }
            { 1000000334;Shape  ;16351;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000335;Shape  ;17197;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000336;TextBox;15505;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[6] }
            { 1000000337;Shape  ;15928;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000338;Shape  ;13693;5850 ;1692 ;423   }
            { 1000000339;TextBox;14962;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[5] }
            { 1000000340;Shape  ;15385;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000341;TextBox;14539;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[4] }
            { 1000000342;Shape  ;14962;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000343;TextBox;14116;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[3] }
            { 1000000344;Shape  ;14539;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000345;Shape  ;14539;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000346;TextBox;13693;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[2] }
            { 1000000347;Shape  ;14116;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000348;Shape  ;13573;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000349;Shape  ;13150;5850 ;423  ;423   }
            { 1000000350;TextBox;13150;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[1] }
            { 1000000351;Shape  ;4640 ;23100;30   ;2050 ;ShapeStyle=VertLine }
            { 1000000352;Label  ;270  ;21250;18690;450  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เงินสะสมจ่ายเข้ากองทุนสำรองเลี้ยงชีพใบอนุญาตเลขที่........................................................จำนวนเงิน................................บาท }
            { 1000000353;Shape  ;150  ;21750;19100;30   ;ShapeStyle=HorzLine }
            { 1000000354;Label  ;3300 ;21800;12750;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เงินสมทบจ่ายเข้ากองทุนประกันสังคม จำนวนเงิน.........................................บาท }
            { 1000000355;Label  ;2400 ;22200;4620 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขที่บัญชีนายจ้าง }
            { 1000000356;Label  ;9610 ;22200;7010 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขที่บัตรประกันสังคม ของผู้ถูกหักภาษี ณ ที่จ่าย }
            { 1000000357;Shape  ;4785 ;22600;1692 ;423   }
            { 1000000358;TextBox;5631 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[8] }
            { 1000000359;Shape  ;2943 ;22600;1692 ;423   }
            { 1000000360;Shape  ;2370 ;22600;423  ;423   }
            { 1000000361;TextBox;2370 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[1] }
            { 1000000362;TextBox;2943 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[2] }
            { 1000000363;TextBox;3366 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[3] }
            { 1000000364;Shape  ;3366 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000365;TextBox;3789 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[4] }
            { 1000000366;Shape  ;3789 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000367;TextBox;4212 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[5] }
            { 1000000368;Shape  ;4212 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000369;TextBox;4785 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[6] }
            { 1000000370;TextBox;5208 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[7] }
            { 1000000371;Shape  ;5208 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000372;Shape  ;5631 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000373;TextBox;6054 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[9] }
            { 1000000374;Shape  ;6054 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000375;Shape  ;2793 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000376;Shape  ;4635 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000377;Shape  ;6477 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000378;TextBox;6627 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[10] }
            { 1000000379;Shape  ;15713;22600;423  ;423   }
            { 1000000380;TextBox;15713;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[13] }
            { 1000000381;Shape  ;15593;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000382;Shape  ;14750;22600;846  ;423   }
            { 1000000383;TextBox;15170;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[12] }
            { 1000000384;Shape  ;12515;22600;2115 ;423   }
            { 1000000385;TextBox;14207;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[10] }
            { 1000000386;Shape  ;14630;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000387;TextBox;14750;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[11] }
            { 1000000388;Shape  ;15170;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000389;TextBox;13784;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[9] }
            { 1000000390;Shape  ;14207;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000391;Shape  ;13784;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000392;TextBox;12938;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[7] }
            { 1000000393;TextBox;13361;22600;420  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[8] }
            { 1000000394;Shape  ;13361;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000395;TextBox;12515;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[6] }
            { 1000000396;Shape  ;12938;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000397;Shape  ;10703;22600;1692 ;423   }
            { 1000000398;TextBox;11972;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[5] }
            { 1000000399;Shape  ;12395;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000400;TextBox;11549;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[4] }
            { 1000000401;Shape  ;11972;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000402;TextBox;11126;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[3] }
            { 1000000403;Shape  ;11549;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000404;Shape  ;11549;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000405;TextBox;10703;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[2] }
            { 1000000406;Shape  ;11126;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000407;Shape  ;10583;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000408;Shape  ;10160;22600;423  ;423   }
            { 1000000409;TextBox;10160;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[1] }
            { 1000000410;Label  ;1350 ;17650;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ซึ่งผู้รับเงินปันผลไม่ได้รับเครดิตภาษี }
            { 1000000411;Label  ;900  ;17250;9600 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(3) กำไรเฉพาะส่วนที่ได้รับยกเว้นไม่ต้องนำมารวมคำนวณภาษีเงินได้นิติบุคคล }
            { 1000000412;Label  ;1940 ;15250;8560 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=คำนวณเป็นรายได้เพื่อเสียภาษีเงินได้นิติบุคคล }
            { 1000000413;Label  ;1350 ;15650;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.3) กำไรสุทธิส่วนที่ได้หักผลขาดทุนสุทธิยกมาไม่เกิน 5 ปี }
            { 1000000414;Label  ;1940 ;16050;8560 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ก่อนรอบระยะเวลาบัญชีปัจจุบัน }
            { 1000000415;Label  ;1380 ;16850;9120 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.5) อื่นๆ (ระบุ)....................................................................................................... }
            { 1000000416;Label  ;1390 ;16450;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.4) กำไรที่รับรู้ทางบัญชีโดยวิธีส่วนได้เสีย (equity method) }
            { 1000000417;TextBox;10800;16850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[13] }
            { 1000000418;TextBox;13400;16850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[13] }
            { 1000000419;TextBox;16450;16850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[13] }
            { 1000000420;TextBox;10800;17250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[14] }
            { 1000000421;TextBox;13400;17250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[14] }
            { 1000000422;TextBox;16450;17250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[14] }
            { 1000000423;TextBox;10800;18027;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[15] }
            { 1000000424;TextBox;13400;18027;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[15] }
            { 1000000425;TextBox;16450;18027;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[15] }
            { 1000000426;TextBox;10800;19604;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[19] }
            { 1000000427;TextBox;13400;19604;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[19] }
            { 1000000428;TextBox;16450;19604;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[19] }
            { 1000000429;TextBox;7630 ;21200;5190 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         SourceExpr=PFundNo }
            { 1000000430;TextBox;14530;21200;2760 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=PFundAmt }
            { 1000000431;TextBox;10930;21720;3500 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=SocialAmt }
            { 1000000433;TextBox;10800;18400;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[16] }
            { 1000000434;TextBox;13400;18400;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[16] }
            { 1000000435;TextBox;16450;18400;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[16] }
            { 1000000436;TextBox;10800;18800;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[17] }
            { 1000000437;TextBox;13400;18800;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[17] }
            { 1000000438;TextBox;16450;18800;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[17] }
            { 1000000439;TextBox;10800;19200;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[18] }
            { 1000000440;TextBox;13400;19200;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[18] }
            { 1000000441;TextBox;16450;19200;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[18] }
            { 1000000009;Shape  ;13150;6323 ;423  ;423   }
            { 1000000010;TextBox;13150;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[1] }
            { 1000000012;Shape  ;13573;6323 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000104;Shape  ;13693;6323 ;1692 ;423   }
            { 1000000105;TextBox;13693;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[2] }
            { 1000000106;TextBox;14116;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[3] }
            { 1000000107;Shape  ;14116;6323 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000108;TextBox;14539;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[4] }
            { 1000000109;Shape  ;14539;6323 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000110;Shape  ;14539;6323 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000111;TextBox;14962;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[5] }
            { 1000000112;Shape  ;14962;6323 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000113;Shape  ;15385;6323 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000114;Shape  ;15505;6323 ;2115 ;423   }
            { 1000000115;TextBox;15505;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[6] }
            { 1000000116;TextBox;15928;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[7] }
            { 1000000117;Shape  ;15928;6323 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000118;TextBox;16351;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[8] }
            { 1000000119;Shape  ;16351;6323 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000138;TextBox;16774;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[9] }
            { 1000000139;Shape  ;16774;6323 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000140;TextBox;17197;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[10] }
            { 1000000141;Shape  ;17197;6323 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000442;Shape  ;17620;6323 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000443;Shape  ;17740;6323 ;846  ;423   }
            { 1000000444;TextBox;17740;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[11] }
            { 1000000445;TextBox;18160;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[12] }
            { 1000000446;Shape  ;18160;6323 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000447;Shape  ;18583;6323 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000448;Shape  ;18703;6323 ;423  ;423   }
            { 1000000449;TextBox;18703;6323 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[13] }
            { 1000000450;Shape  ;18703;3823 ;423  ;423   }
            { 1000000451;TextBox;18703;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[13] }
            { 1000000452;Shape  ;18583;3823 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000453;Shape  ;17740;3823 ;846  ;423   }
            { 1000000454;TextBox;18160;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[12] }
            { 1000000455;Shape  ;18160;3823 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000456;TextBox;17740;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[11] }
            { 1000000457;Shape  ;17620;3823 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000458;Shape  ;15505;3823 ;2115 ;423   }
            { 1000000459;TextBox;17197;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[10] }
            { 1000000460;Shape  ;17197;3823 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000461;TextBox;16774;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[9] }
            { 1000000462;Shape  ;16774;3823 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000463;TextBox;16351;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[8] }
            { 1000000464;Shape  ;16351;3823 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000465;TextBox;15928;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[7] }
            { 1000000466;Shape  ;15928;3823 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000467;TextBox;15505;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[6] }
            { 1000000468;Shape  ;15385;3823 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000469;Shape  ;13693;3823 ;1692 ;423   }
            { 1000000470;TextBox;14962;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[5] }
            { 1000000471;Shape  ;14962;3823 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000472;TextBox;14539;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[4] }
            { 1000000473;Shape  ;14539;3823 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000474;Shape  ;14539;3823 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000475;TextBox;14116;3823 ;420  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[3] }
            { 1000000476;Shape  ;14116;3823 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000477;TextBox;13693;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[2] }
            { 1000000478;Shape  ;13573;3823 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000479;Shape  ;13150;3823 ;423  ;423   }
            { 1000000480;TextBox;13150;3823 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[1] }
            { 1000000481;Shape  ;13150;1373 ;423  ;423   }
            { 1000000482;TextBox;13150;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[1] }
            { 1000000483;Shape  ;13573;1373 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000484;Shape  ;13693;1373 ;1692 ;423   }
            { 1000000485;TextBox;13693;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[2] }
            { 1000000486;TextBox;14116;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[3] }
            { 1000000487;Shape  ;14116;1373 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000488;TextBox;14539;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[4] }
            { 1000000489;Shape  ;14539;1373 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000490;Shape  ;14539;1373 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000491;TextBox;14962;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[5] }
            { 1000000492;Shape  ;14962;1373 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000493;Shape  ;15385;1373 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000494;Shape  ;15505;1373 ;2115 ;423   }
            { 1000000495;TextBox;15505;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[6] }
            { 1000000496;TextBox;15928;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[7] }
            { 1000000497;Shape  ;15928;1373 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000498;TextBox;16351;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[1] }
            { 1000000499;Shape  ;16351;1373 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000500;TextBox;16774;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[9] }
            { 1000000501;Shape  ;16774;1373 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000502;TextBox;17197;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[10] }
            { 1000000503;Shape  ;17197;1373 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000504;Shape  ;17620;1373 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000505;Shape  ;17740;1373 ;846  ;423   }
            { 1000000506;TextBox;17740;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[11] }
            { 1000000507;Shape  ;18160;1373 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000508;TextBox;18160;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[12] }
            { 1000000509;Shape  ;18583;1373 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000510;TextBox;18703;1373 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[13] }
            { 1000000511;Shape  ;18690;1400 ;423  ;423   }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19950;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CASE Number OF
                             1: Heading := 'ฉบับที่ 1 (สำหรับผู้ถูกหักภาษี ณ ที่จ่าย ใช้แนบพร้อมกับแบบแสดงรายการภาษี)';
                             2: Heading := 'ฉบับที่ 2 (สำหรับผู้ถูกหักภาษี ณ ที่จ่าย เก็บไว้เป็นหลักฐาน)';
                             3: Heading := 'ฉบับที่ 3';
                             4: Heading := 'ฉบับที่ 4';
                           END;
                           CurrReport.SHOWOUTPUT(HeadingPrint);
                         END;

          }
          CONTROLS
          {
            { 1000000003;TextBox;140  ;0    ;11800;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         SourceExpr=Heading }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=16170;
      Height=9570;
      SaveValues=Yes;
      OnInit=BEGIN
               HeadingPrint := TRUE;
             END;

    }
    CONTROLS
    {
      { 1000000006;TextBox;4180 ;3190 ;7480 ;440  ;ParentControl=1000000015;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=ชื่อผู้กระทำการแทน;
                                                   SourceExpr=ConductName }
      { 1000000007;Label  ;330  ;3190 ;3740 ;440  ;ParentControl=1000000006 }
      { 1000000008;TextBox;4180 ;3740 ;11550;440  ;ParentControl=1000000015;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=ที่อยู่ผู้กระทำการแทน;
                                                   SourceExpr=ConductAddress }
      { 1000000009;Label  ;330  ;3740 ;3740 ;440  ;ParentControl=1000000008 }
      { 1000000011;TextBox;4180 ;4290 ;3630 ;440  ;ParentControl=1000000015;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=เลขประจำตัวผู้เสียภาษี;
                                                   SourceExpr=ConductVATID }
      { 1000000010;Label  ;330  ;4290 ;3740 ;440  ;ParentControl=1000000011 }
      { 1000000014;TextBox;4180 ;4840 ;3630 ;440  ;ParentControl=1000000015;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=เลขที่ประจำตัวประชาชน;
                                                   SourceExpr=ConductID }
      { 1000000016;Label  ;330  ;4840 ;3740 ;440  ;ParentControl=1000000014 }
      { 1000000000;TextBox;4070 ;1210 ;1650 ;440  ;CaptionML=ENU=Number of copies;
                                                   SourceExpr=NumberOfCopy }
      { 1000000001;Label  ;220  ;1210 ;3740 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;4070 ;660  ;1650 ;440  ;CaptionML=ENU=Form No.;
                                                   SourceExpr=FormBookNo }
      { 1000000003;Label  ;220  ;660  ;3740 ;440  ;ParentControl=1000000002;
                                                   CaptionML=ENU=Print Form 50 BIS Book No. }
      { 1000000004;CheckBox;4070;1760 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=พิมพ์ฉบับที่ (Heading Print);
                                                   SourceExpr=HeadingPrint }
      { 1000000005;Label  ;220  ;1760 ;3740 ;440  ;ParentControl=1000000004 }
      { 1000000012;CheckBox;4070;110  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Test Report;
                                                   SourceExpr=PrintTest }
      { 1000000013;Label  ;220  ;110  ;3740 ;440  ;ParentControl=1000000012 }
      { 1000000027;OptionButton;3190;8470;3740;440;CaptionML=ENU=ออกภาษีให้ครั้งเดียว;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=0 }
      { 1000000029;OptionButton;3190;8030;3740;440;CaptionML=ENU=ออกภาษีให้ตลอดไป;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=1 }
      { 1000000031;OptionButton;3190;7590;3740;440;CaptionML=ENU=หักภาษี ณ ที่จ่าย;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=2 }
      { 1000000033;OptionButton;3190;8910;3740;440;CaptionML=ENU=อื่นๆ ให้ระบุ................;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=3 }
      { 1000000035;Label  ;330  ;7590 ;2750 ;440  ;CaptionML=ENU=ผู้จ่ายเงิน }
      { 1000000015;Frame  ;110  ;2640 ;15840;2860 ;FontBold=Yes;
                                                   CaptionML=ENU=กระทำการแทนโดย }
      { 1000000017;TextBox;6930 ;5830 ;2530 ;440  ;CaptionML=ENU=เงินสะสมจ่ายเข้ากองทุนสำรองเลี้ยงชีพใบอนุญาตเลขที่;
                                                   SourceExpr=PFundNo }
      { 1000000018;Label  ;330  ;5830 ;6490 ;440  ;ParentControl=1000000017 }
      { 1000000019;TextBox;11440;5830 ;2530 ;440  ;CaptionML=ENU=จำนวนเงิน;
                                                   SourceExpr=PFundAmt }
      { 1000000020;Label  ;9900 ;5830 ;1430 ;440  ;ParentControl=1000000019 }
      { 1000000021;Label  ;14080;5830 ;1650 ;440  ;LeaderDots=No;
                                                   CaptionML=ENU=บาท }
      { 1000000022;TextBox;6930 ;6380 ;2530 ;440  ;CaptionML=ENU=เงินสมทบเข้ากองทุนประกันสังคม จำนวนเงิน;
                                                   SourceExpr=SocialAmt }
      { 1000000023;Label  ;1320 ;6380 ;5500 ;440  ;ParentControl=1000000022 }
      { 1000000024;Label  ;9570 ;6380 ;1650 ;440  ;LeaderDots=No;
                                                   CaptionML=ENU=บาท }
      { 1000000025;Label  ;1320 ;6930 ;2530 ;440  ;ParentControl=1000000026 }
      { 1000000026;TextBox;3960 ;6930 ;2530 ;440  ;CaptionML=ENU=เลขที่บัญชีนายจ้าง;
                                                   SourceExpr=EmployerAccount }
      { 1000000028;TextBox;12650;6930 ;2530 ;440  ;CaptionML=ENU=เลขที่บัตรประกันสังคม ของผู้ถูกหักภาษี ณ ที่จ่าย;
                                                   SourceExpr=SocialID }
      { 1000000030;Label  ;6600 ;6930 ;5940 ;440  ;ParentControl=1000000028 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLSetup@1000000018 : Record 98;
      CompanyInfo@1000000007 : Record 79;
      Vendor@1000000006 : Record 23;
      WHTBusPostinGrp@1000000005 : Record 28040;
      WHTRevType@1000000042 : Record 28042;
      WHTEntry@1000000020 : Record 28044;
      WHTEntry2@1000000043 : Record 28044;
      Name@1000000004 : Text[150];
      Address@1000000003 : Text[250];
      Address2@1000000002 : Text[250];
      City@1000000001 : Text[30];
      VAT@1000000008 : ARRAY [20] OF Code[1];
      SNo@1006 : Integer;
      Pdate@1007 : Date;
      CID@1009 : ARRAY [20] OF Code[1];
      i@1010 : Integer;
      ConductName@1000000022 : Text[250];
      ConductAddress@1000000015 : Text[250];
      ConductVATID@1000000026 : Text[20];
      ConductID@1000000037 : Text[20];
      CCID@1000000025 : ARRAY [20] OF Code[1];
      ID1@1000000033 : ARRAY [13] OF Code[1];
      ID2@1000000035 : ARRAY [13] OF Code[1];
      ID3@1000000034 : ARRAY [13] OF Code[1];
      PageNo@1000000009 : Integer;
      WHTGroup@1000000010 : ARRAY [2] OF Text[1];
      WHTTerm@1000000011 : ARRAY [4] OF Text[1];
      WHTPostingDate@1000000031 : ARRAY [19] OF Date;
      WHTBaseAmtLCYExcVAT@1000000013 : ARRAY [19] OF Decimal;
      WHTAmtLCY@1000000014 : ARRAY [19] OF Decimal;
      TotWHTBaseAmtLCYExcVAT@1000000023 : Decimal;
      TotWHTAmtLCY@1000000021 : Decimal;
      ExpenseType@1000000016 : ARRAY [4] OF Text[1];
      FormBookNo@1000000036 : Code[10];
      WHTAmtLCYText@1000000019 : Text[200];
      NumberOfCopy@1000000024 : Integer;
      NewDocNo@1000000038 : Code[20];
      WHTExpenseText@1000000040 : Text[30];
      HeadingPrint@1000000041 : Boolean;
      Heading@1000000000 : Text[100];
      WHTSlipNo@1000000027 : Code[20];
      PostingDate@1000000012 : Date;
      PrintTest@1000000017 : Boolean;
      TestText@1000000028 : Text[70];
      WHTPostingSetup@1000000029 : Record 28043;
      PurchInvHeader@1000000030 : Record 122;
      PaymentOption@1000000032 : '0,1,2,3';
      PFundNo@1000000045 : Code[20];
      PFundAmt@1000000046 : Decimal;
      SocialAmt@1000000047 : Decimal;
      EmployerAccount@1000000048 : Code[10];
      SocialID@1000000049 : Code[13];
      SoID@1000000044 : ARRAY [13] OF Code[1];
      EID@1000000039 : ARRAY [10] OF Code[1];
      CompanyPhone@1000000050 : Text[50];
      Phone@1000000051 : Text[50];

    PROCEDURE FormatNoThaiText@1000000000(Amount@1000000002 : Decimal) @1000000001 : Text[200];
    VAR
      AmountText@1000000000 : Text[30];
      x@1000000003 : Integer;
      l@1000000004 : Integer;
      p@1000000008 : Integer;
      adigit@1000000005 : Text[1];
      dflag@1000000006 : Boolean;
      WHTAmtThaiText@1000000007 : Text[200];
    BEGIN
      Amount := ROUND(Amount);
      AmountText := FORMAT(Amount,0);
      x := STRPOS(AmountText,'.');
      CASE TRUE OF
        x = 0:
          AmountText := AmountText + '.00';
        x = STRLEN(AmountText) - 1:
          AmountText := AmountText + '0';
        x > STRLEN(AmountText) - 2:
          AmountText := COPYSTR(AmountText,1,x + 2);
      END;
      l := STRLEN(AmountText);
      REPEAT
        dflag := FALSE;
        p := STRLEN(AmountText) - l + 1;
        adigit := COPYSTR(AmountText,p,1);
        IF (l IN [4,12,20]) AND (l < STRLEN(AmountText)) AND (adigit = '1') THEN
          dflag := TRUE;
        WHTAmtThaiText := WHTAmtThaiText + FormatDigitThai(adigit, l-3, dflag);
        l := l - 1;
      UNTIL l=3;

      IF COPYSTR(AmountText,STRLEN(AmountText)-2,3) = '.00' THEN
        WHTAmtThaiText := WHTAmtThaiText + 'บาทถ้วน'
      ELSE BEGIN
        IF WHTAmtThaiText <> '' THEN
          WHTAmtThaiText := WHTAmtThaiText + 'บาท';
        l := 2;
        REPEAT
          dflag := FALSE;
          p := STRLEN(AmountText) - l + 1;
          adigit := COPYSTR(AmountText,p,1);
          IF (l = 1) AND (adigit = '1') AND (COPYSTR(AmountText,p-1,1) <> '0') THEN
            dflag := TRUE;
          WHTAmtThaiText := WHTAmtThaiText + FormatDigitThai(adigit, l, dflag);
          l := l - 1;
        UNTIL l=0;
        WHTAmtThaiText := WHTAmtThaiText + 'สตางค์';
      END;

      EXIT(WHTAmtThaiText);
    END;

    PROCEDURE FormatDigitThai@1000000005(adigit@1000000002 : Text[1];pos@1000000001 : Integer;dflag@1000000000 : Boolean) : Text[100];
    VAR
      fdigit@1000000003 : Text[30];
      fcount@1000000005 : Text[30];
    BEGIN
      CASE adigit OF
        '1':
          BEGIN
            IF (pos IN [1,9,17]) AND dflag THEN
              fdigit := 'เอ็ด'
            ELSE
              IF pos IN [2,10,18] THEN
                fdigit := ''
              ELSE
                fdigit := 'หนึ่ง';
          END;
        '2':
          BEGIN
            IF pos IN [2,10,18] THEN
              fdigit := 'ยี่'
            ELSE
              fdigit := 'สอง';
          END;
        '3':
          fdigit := 'สาม';
        '4':
          fdigit := 'สี่';
        '5':
          fdigit := 'ห้า';
        '6':
          fdigit := 'หก';
        '7':
          fdigit := 'เจ็ด';
        '8':
          fdigit := 'แปด';
        '9':
          fdigit := 'เก้า';
        '0':
          BEGIN
            IF pos IN [9,17,25] THEN
              fdigit := 'ล้าน';
          END;
        '-':
          fdigit := 'ลบ';
      END;
      IF (adigit <> '0') AND (adigit <> '-') THEN BEGIN
        CASE pos OF
          2,10,18:
            fcount := 'สิบ';
          3,11,19:
            fcount := 'ร้อย';
          5,13,21:
            fcount := 'พัน';
          6,14,22:
            fcount := 'หมื่น';
          7,15,23:
            fcount := 'แสน';
          9,17,25:
            fcount := 'ล้าน';
        END;
      END;
      EXIT(fdigit+fcount);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut
      TSA : Theerasak Saenwiset

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   Update for version 4.0 TH.
      002   20.06.2005   KKE   Update for 'Dummy Vendor' and 'VAT Registration No. (Dummy)'.
      003   28.02.2006   TSA   Update for allow user to be able to select WHT Term before print.
      004   04.09.2006   KKE   Update for new format
                               Add 3 sub sequence in 5.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50003 FORM 50 BIS Before Post
{
  OBJECT-PROPERTIES
  {
    Date=05/21/12;
    Time=[ 2:38:33 PM];
    Modified=Yes;
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=500;
    BottomMargin=500;
    LeftMargin=500;
    RightMargin=200;
    OnInitReport=BEGIN
                   NumberOfCopy := 1;
                   IF WHTEntry.FIND('-') THEN;

                   PaymentOption := 2 ; //TSA005
                 END;

    OnPreReport=BEGIN
                  IF CompanyInfo.GET THEN BEGIN
                    FOR i := 1 TO STRLEN(CompanyInfo."VAT Registration No.") DO
                      ID1[i] := COPYSTR(CompanyInfo."VAT Registration No.",i,1);
                    //KKE : #006 +
                    IF CompanyInfo."Phone No." <> '' THEN
                      CompanyPhone := 'Tel. ' + CompanyInfo."Phone No.";
                    //KKE : #006 -
                    CompanyInfo.CALCFIELDS(Picture);
                  END;

                  //KKE : #006 +
                  FOR i := 1 TO STRLEN(ConductVATID) DO
                    CCID[i] := COPYSTR(ConductVATID,i,1);

                  FOR i := 1 TO STRLEN(ConductID) DO
                    ID2[i] := COPYSTR(ConductID,i,1);

                  FOR i := 1 TO STRLEN(EmployerAccount) DO
                    EID[i] := COPYSTR(EmployerAccount,i,1);

                  FOR i := 1 TO STRLEN(SocialID) DO
                    SoID[i] := COPYSTR(SocialID,i,1);
                  //KKE : #006 -

                  IF NumberOfCopy > 4 THEN
                    ERROR('Number of copies shouldnot be more than 4.');

                  GLSetup.GET;
                  PurchSetup.GET;

                  //TSA005
                  CLEAR(WHTTerm);
                  CASE PaymentOption OF
                    0 : WHTTerm[1] := 'P';
                    1 : WHTTerm[2] := 'P';
                    2 : WHTTerm[3] := 'P';
                    3 : WHTTerm[4] := 'P';
                  END;
                  //TSA005
                END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=50;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table81;
        DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Line No.);
        OnAfterGetRecord=BEGIN
                           TESTFIELD("Document Type","Document Type"::Payment); //KKE : #004

                           CLEAR(OneDocPerWHTSlip);
                           IF PayDocNo <> "Document No." THEN BEGIN
                             PayDocNo := "Document No.";
                             OneDocPerWHTSlip := "One Doc. Per WHT Slip";
                             //CLEAR(DocNoFilter);
                             CLEAR(Name);
                             CLEAR(Address);
                             CLEAR(Phone);  //KKE : #006
                             CLEAR(VAT);
                             CLEAR(WHTGroup);
                             CLEAR(WHTPostingDate);
                             CLEAR(WHTExpenseText);
                             CLEAR(WHTBaseAmtLCYExcVAT);
                             CLEAR(WHTAmtLCY);
                             CLEAR(TotWHTBaseAmtLCYExcVAT);
                             CLEAR(TotWHTAmtLCY);
                             CLEAR(PostingDate);
                           END ELSE
                             IF "One Doc. Per WHT Slip" THEN
                               CurrReport.SKIP;

                           PaymentAmount := 0;

                           IF OneDocPerWHTSlip THEN BEGIN
                             GenJnlLine.RESET;
                             GenJnlLine.COPYFILTERS("Gen. Journal Line");
                             GenJnlLine.SETRANGE("Document Type","Document Type");
                             GenJnlLine.SETRANGE("Document No.","Document No.");
                             IF NOT GenJnlLine.FIND('-') THEN
                               CurrReport.SKIP;

                             //CLEAR(DocNoFilter);
                             CLEAR(WHTSlipNo);
                             REPEAT
                               //KKE : #007 +
                               IF GenJnlLine."Skip WHT" THEN
                                 CurrReport.BREAK;
                               //KKE : #007 -
                               PaymentAmount := GenJnlLine.Amount;
                               PaymentAmount1 := GenJnlLine.Amount;
                               xWHTEntry.RESET;
                               xWHTEntry.SETCURRENTKEY("Transaction Type","Document No.","Document Type","Bill-to/Pay-to No.");
                               IF "Applies-to Doc. Type"="Applies-to Doc. Type"::Invoice THEN
                                 xWHTEntry.SETRANGE("Document Type",xWHTEntry."Document Type"::Invoice);
                               IF "Applies-to Doc. Type"="Applies-to Doc. Type"::"Credit Memo" THEN
                                 xWHTEntry.SETRANGE("Document Type",xWHTEntry."Document Type"::"Credit Memo");
                               //xWHTEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                               IF GenJnlLine."Applies-to Doc. No." <> '' THEN
                                 xWHTEntry.SETRANGE("Document No.",GenJnlLine."Applies-to Doc. No.")
                               ELSE BEGIN
                                 IF GenJnlLine."Applies-to ID" <> '' THEN BEGIN
                                   {
                                   VendLedgEntry.RESET;
                                   VendLedgEntry.SETRANGE("Applies-to ID",GenJnlLine."Applies-to ID");
                                   IF VendLedgEntry.FIND('-') THEN
                                   REPEAT
                                     IF DocNoFilter = '' THEN
                                       DocNoFilter := VendLedgEntry."Document No."
                                     ELSE
                                       DocNoFilter := DocNoFilter + '|' + VendLedgEntry."Document No.";
                                   UNTIL VendLedgEntry.NEXT=0;
                                   xWHTEntry.SETFILTER("Document No.",DocNoFilter);
                                   }
                                   xWHTEntry.SETFILTER("Applies-to ID",GenJnlLine."Applies-to ID");
                                 END;
                                 IF GenJnlLine."Account Type" = GenJnlLine."Account Type"::Vendor THEN
                                   xWHTEntry.SETRANGE("Bill-to/Pay-to No.",GenJnlLine."Account No.")
                                 ELSE IF GenJnlLine."Bal. Account Type" = GenJnlLine."Bal. Account Type"::Vendor THEN
                                   xWHTEntry.SETRANGE("Bill-to/Pay-to No.",GenJnlLine."Bal. Account No.");
                                 //IF DocNoFilter = '' THEN
                                 //  CurrReport.SKIP;
                               END;
                               xWHTEntry.SETFILTER("WHT %",'<>%1',0);
                               IF xWHTEntry.FIND('-') THEN BEGIN
                                 REPEAT
                                   GetWHTEntry(xWHTEntry);
                                 UNTIL xWHTEntry.NEXT=0;
                               END;

                               //Running No. WHT
                               IF (TotWHTAmtLCY <> 0) AND (xWHTEntry.COUNT <> 0) THEN
                                 IF GenJnlLine."WHT Certificate No." = '' THEN BEGIN
                                   IF WHTSlipNo = '' THEN
                                     IF WHTBusPostingGrp."WHT Certificate No. Series" <> '' THEN
                                       WHTSlipNo := NoSeriesMgt.GetNextNo(WHTBusPostingGrp."WHT Certificate No. Series",GenJnlLine."Posting Date",TRUE)
                                     ELSE
                                       WHTSlipNo := NoSeriesMgt.GetNextNo(PurchSetup."WHT Certificate No. Series",GenJnlLine."Posting Date",TRUE);
                                   GenJnlLine."WHT Certificate No." := WHTSlipNo;
                                   GenJnlLine."Certificate Printed" := TRUE;
                                   GenJnlLine.MODIFY(TRUE);
                                 END ELSE BEGIN
                                   WHTSlipNo := GenJnlLine."WHT Certificate No.";
                                   GenJnlLine."Certificate Printed" := TRUE;
                                   GenJnlLine.MODIFY(TRUE);
                                 END;
                               {
                               IF (TotWHTAmtLCY <> 0) AND (xWHTEntry.COUNT <> 0) AND (GenJnlLine."WHT Certificate No." = '') THEN BEGIN
                                 IF NOT WHTSlipPrinted THEN BEGIN
                                   IF WHTSlipNo = '' THEN
                                     WHTSlipNo := NoSeriesMgt.GetNextNo(PurchSetup."WHT Certificate No. Series",GenJnlLine."Posting Date",TRUE);
                                   GenJnlLine."WHT Certificate No." := WHTSlipNo;
                                   GenJnlLine."Certificate Printed" := TRUE;
                                   GenJnlLine.MODIFY(TRUE);
                                 END;
                               END ELSE BEGIN
                                 WHTSlipNo := GenJnlLine."WHT Certificate No.";
                                 GenJnlLine."Certificate Printed" := TRUE;
                                 GenJnlLine.MODIFY(TRUE);
                               END;
                               }
                             UNTIL GenJnlLine.NEXT=0;
                           END ELSE BEGIN
                             //CLEAR(DocNoFilter);
                             CLEAR(Name);
                             CLEAR(Address);
                             CLEAR(VAT);
                             CLEAR(WHTGroup);
                             CLEAR(WHTPostingDate);
                             CLEAR(WHTExpenseText);
                             CLEAR(WHTBaseAmtLCYExcVAT);
                             CLEAR(WHTAmtLCY);
                             CLEAR(TotWHTBaseAmtLCYExcVAT);
                             CLEAR(TotWHTAmtLCY);
                             CLEAR(PostingDate);

                             //KKE : #007 +
                             IF "Skip WHT" THEN
                               CurrReport.BREAK;
                             //KKE : #007 -

                             //KKE +
                             ApplyCreditAmount := 0;
                             ApplyInvoiceAmount := 0;
                             IF "Applies-to ID" <> '' THEN BEGIN
                               VendLedgEntry.RESET;
                               VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                               VendLedgEntry.SETRANGE("Document Type",VendLedgEntry."Document Type"::"Credit Memo");
                               IF VendLedgEntry.FIND('-') THEN
                                 REPEAT
                                   VendLedgEntry.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)");
                                   ApplyCreditAmount := ApplyCreditAmount + VendLedgEntry."Remaining Amt. (LCY)";
                                 UNTIL VendLedgEntry.NEXT=0;
                               VendLedgEntry.RESET;
                               VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                               VendLedgEntry.SETFILTER("Document Type",'<>%1',VendLedgEntry."Document Type"::"Credit Memo");
                               IF VendLedgEntry.FIND('-') THEN
                                 REPEAT
                                   VendLedgEntry.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)");
                                   ApplyInvoiceAmount := ApplyInvoiceAmount + VendLedgEntry."Remaining Amt. (LCY)";
                                 UNTIL VendLedgEntry.NEXT=0;
                             END;
                             IF (ApplyInvoiceAmount <> 0) AND (ApplyCreditAmount <> 0) THEN
                               PaymentAmount := ABS("Amount (LCY)") + ApplyCreditAmount
                             ELSE
                               PaymentAmount := "Amount (LCY)";
                             //KKE -

                             xWHTEntry.RESET;
                             xWHTEntry.SETCURRENTKEY("Transaction Type","Document No.","Document Type","Bill-to/Pay-to No.");
                             xWHTEntry.SETFILTER("Document Type",'<>%1',xWHTEntry."Document Type"::Payment);    //XXX
                             xWHTEntry.SETFILTER("WHT %",'<>%1',0);
                             IF "Applies-to Doc. Type"="Applies-to Doc. Type"::Invoice THEN
                               xWHTEntry.SETRANGE("Document Type",xWHTEntry."Document Type"::Invoice);
                             IF "Applies-to Doc. Type"="Applies-to Doc. Type"::"Credit Memo" THEN
                               xWHTEntry.SETRANGE("Document Type",xWHTEntry."Document Type"::"Credit Memo");
                             //xWHTEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                             IF "Applies-to Doc. No." <> '' THEN
                               xWHTEntry.SETRANGE("Document No.","Applies-to Doc. No.")
                             ELSE BEGIN
                               IF "Applies-to ID" <> '' THEN BEGIN
                                 {
                                 VendLedgEntry.RESET;
                                 VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                 IF VendLedgEntry.FIND('-') THEN
                                 REPEAT
                                   IF DocNoFilter = '' THEN
                                     DocNoFilter := VendLedgEntry."Document No."
                                   ELSE
                                     DocNoFilter := DocNoFilter + '|' + VendLedgEntry."Document No.";
                                 UNTIL VendLedgEntry.NEXT=0;
                                 xWHTEntry.SETFILTER("Document No.",DocNoFilter);
                                 }
                                 xWHTEntry.SETFILTER("Applies-to ID","Applies-to ID");
                               END;
                               IF "Account Type" = "Account Type"::Vendor THEN
                                 xWHTEntry.SETRANGE("Bill-to/Pay-to No.","Account No.")
                               ELSE IF "Bal. Account Type" = "Bal. Account Type"::Vendor THEN
                                 xWHTEntry.SETRANGE("Bill-to/Pay-to No.","Bal. Account No.");
                               //IF DocNoFilter = '' THEN
                               //  CurrReport.SKIP;
                             END;

                             IF xWHTEntry.FIND('-') THEN
                             REPEAT
                               IF (ApplyInvoiceAmount <> 0) AND (ApplyCreditAmount <> 0) THEN
                                 PaymentAmount1 := ABS("Amount (LCY)") + ApplyCreditAmount
                               ELSE
                                 PaymentAmount1 := "Amount (LCY)";

                               //PaymentAmount1 := Amount;
                               GetWHTEntry(xWHTEntry);
                             UNTIL xWHTEntry.NEXT=0;

                             //Running No. WHT
                             IF (TotWHTAmtLCY <> 0) AND (xWHTEntry.COUNT <> 0) THEN
                               IF "WHT Certificate No." = '' THEN BEGIN
                                 IF WHTSlipNo = '' THEN
                                   IF WHTBusPostingGrp."WHT Certificate No. Series" <> '' THEN
                                     WHTSlipNo := NoSeriesMgt.GetNextNo(WHTBusPostingGrp."WHT Certificate No. Series","Posting Date",TRUE)
                                   ELSE
                                     WHTSlipNo := NoSeriesMgt.GetNextNo(PurchSetup."WHT Certificate No. Series","Posting Date",TRUE);
                                 "WHT Certificate No." := WHTSlipNo;
                                 "Certificate Printed" := TRUE;
                                 MODIFY(TRUE);
                               END ELSE BEGIN
                                 WHTSlipNo := "WHT Certificate No.";
                                 IF NOT "Check Printed" THEN BEGIN
                                   "Certificate Printed" := TRUE;
                                   MODIFY(TRUE);
                                 END;
                               END;
                             {
                             IF (TotWHTAmtLCY <> 0) AND (xWHTEntry.COUNT <> 0) AND ("WHT Certificate No." = '') THEN BEGIN
                               IF NOT WHTSlipPrinted THEN BEGIN
                                 IF WHTBusPostingGrp."WHT Certificate No. Series" <> '' THEN
                                   WHTSlipNo := NoSeriesMgt.GetNextNo(WHTBusPostingGrp."WHT Certificate No. Series","Posting Date",TRUE)
                                 ELSE
                                   WHTSlipNo := NoSeriesMgt.GetNextNo(PurchSetup."WHT Certificate No. Series","Posting Date",TRUE);
                                 "WHT Certificate No." := WHTSlipNo;
                                 "Certificate Printed" := TRUE;
                                 MODIFY(TRUE);
                               END;
                             END ELSE BEGIN
                               WHTSlipNo := "WHT Certificate No.";
                               "Certificate Printed" := TRUE;
                               MODIFY(TRUE);
                             END;
                             }
                           END;
                         END;

        ReqFilterFields=Journal Template Name,Journal Batch Name,Document No.,Posting Date;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..4));
        OnPreDataItem=BEGIN
                        {iF NewDocNo = '' THEN
                          NewDocNo := "WHT Entry"."Document No.";

                        WHTEntry.COPY("WHT Entry");
                        IF WHTEntry.NEXT <> 0 THEN BEGIN
                          IF NewDocNo = WHTEntry."Document No." THEN
                            CurrReport.BREAK;
                        END;
                         }

                        //WHT1.01 21.04.04 START
                        IF TotWHTAmtLCY = 0 THEN
                          CurrReport.BREAK;
                        //WHT1.01 21.04.04 STOP
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > NumberOfCopy THEN
                             CurrReport.BREAK;

                           WHTAmtLCYText := FormatNoThaiText(TotWHTAmtLCY);
                           IF WHTAmtLCYText <> '' THEN
                             WHTAmtLCYText := '(' + WHTAmtLCYText + ')';
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=1400;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FALSE;
                         END;

          }
          CONTROLS
          {
            { 1000000041;PictureBox;0 ;0    ;3780 ;1400 ;HorzGlue=Both;
                                                         SourceExpr=CompanyInfo.Picture }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=26000;
          }
          CONTROLS
          {
            { 1000000000;Shape  ;150  ;9150 ;19100;16000;Visible=Yes }
            { 1000000001;Shape  ;6627 ;22600;423  ;423   }
            { 1000000002;Shape  ;18703;5850 ;423  ;423   }
            { 1000000004;Shape  ;18703;3350 ;423  ;423   }
            { 1000000005;Shape  ;13150;900  ;423  ;423   }
            { 1000000006;TextBox;18703;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[13] }
            { 1000000007;Shape  ;13693;900  ;1692 ;423   }
            { 1000000008;Shape  ;15505;900  ;2115 ;423   }
            { 1000000011;Shape  ;16865;3850 ;1692 ;423   }
            { 1000000012;Shape  ;14000;6350 ;5100 ;423   }
            { 1000000013;Shape  ;15023;3850 ;1692 ;423   }
            { 1000000014;Shape  ;14450;3850 ;423  ;423   }
            { 1000000015;Shape  ;0    ;0    ;19400;26000;ShapeStyle=Rectangle }
            { 1000000016;Shape  ;150  ;20100;19100;30   ;ShapeStyle=HorzLine }
            { 1000000017;Label  ;300  ;19627;1750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=6. อื่นๆ (ระบุ) }
            { 1000000018;Label  ;8590 ;20162;4430 ;538  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมเงินที่จ่ายและภาษีที่หักนำส่ง }
            { 1000000019;Label  ;1620 ;25550;17690;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ผู้มีหน้าที่ออกหนังสือรับรองการหักภาษี ณ ที่จ่าย ฝ่าฝืนไม่ปฏิบัติตามมาตรา 50 ทวิ แห่งประมวลรัษฎากร ต้องรับโทษทางอาญาตามมาตรา 35 แห่งประมวลรัษฎากร }
            { 1000000020;Shape  ;150  ;9990 ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000021;Shape  ;150  ;5800 ;19100;3350 ;ShapeStyle=Rectangle }
            { 1000000022;Shape  ;150  ;800  ;19100;2350 ;ShapeStyle=Rectangle }
            { 1000000023;Label  ;350  ;5750 ;5050 ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ผู้ถูกหักภาษี ณ ที่จ่าย : }
            { 1000000024;Label  ;400  ;8000 ;1200 ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ลำดับที่ }
            { 1000000025;Label  ;300  ;10050;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=1. เงินเดือน ค่าจ้าง เบี้ยเลี้ยง โบนัส ฯลฯ ตามมาตรา 40 (1) }
            { 1000000026;Label  ;300  ;10450;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=2. ค่าธรรมเนียม ค่านายหน้า ฯลฯ ตามมาตรา 40 (2) }
            { 1000000027;Label  ;300  ;10850;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=3. ค่าแห่งลิขสิทธิ์ฯลฯ ตามมาตรา 40 (3) }
            { 1000000028;Label  ;300  ;11250;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=4. (ก)  ค่าดอกเบี้ย ฯลฯ ตามมาตรา 40 (4) ก }
            { 1000000029;Label  ;650  ;11650;8850 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ข) เงินปันผล เงินส่วนแบ่งกำไร ฯลฯ ตามมาตรา 40 (4) (ข) ที่จ่ายจาก }
            { 1000000030;Label  ;300  ;18050;10050;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=5. การจ่ายเงินได้ที่ต้องหักภาษี ณ ที่จ่ายตามคำสั่งกรมสรรพากรที่ออกตามมาตรา }
            { 1000000031;Label  ;600  ;18450;9750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=3 เตรส เช่น รางวัล ส่วนลดหรือประโยชน์ใดๆ เนื่องจากการส่งเสริมการขาย }
            { 1000000032;Label  ;600  ;18850;9750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=รางวัลในการประกวด การแข่งขัน การชิงโชค ค่าแสดงของนักแสดงสาธารณะ }
            { 1000000033;Label  ;600  ;19250;9720 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ค่าจ้างทำของ ค่าโฆษณา ค่าเช่า ค่าขนส่ง ค่าบริการ ค่าเบี้ยประกันวินาศภัย ฯลฯ }
            { 1000000034;Label  ;400  ;850  ;5100 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU="ผู้มีหน้าที่หักภาษี ณ ที่จ่าย : " }
            { 1000000035;Label  ;400  ;1300 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000036;Label  ;400  ;2200 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000037;Label  ;1950 ;9156 ;5100 ;846  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ประเภทเงินได้ที่จ่าย }
            { 1000000038;Shape  ;1700 ;8000 ;1400 ;423   }
            { 1000000039;Label  ;3450 ;8000 ;1150 ;523  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ในแบบ }
            { 1000000040;Shape  ;4900 ;8000 ;450  ;423   }
            { 1000000042;Shape  ;4900 ;8500 ;450  ;423   }
            { 1000000043;Label  ;6050 ;8000 ;1650 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.1ก }
            { 1000000044;Label  ;6050 ;8500 ;1650 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.2ก }
            { 1000000045;Label  ;300  ;25150;1340 ;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000046;Shape  ;8100 ;8000 ;450  ;423   }
            { 1000000047;Shape  ;8100 ;8500 ;450  ;423   }
            { 1000000048;Label  ;6650 ;150  ;5250 ;500  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ตามมาตรา 50 ทวิ แห่งประมวลรัษฎากร }
            { 1000000049;Label  ;10800;9150 ;2400 ;444  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=วัน เดือน }
            { 1000000050;Shape  ;10750;9150 ;30   ;10950;ShapeStyle=VertLine }
            { 1000000051;Shape  ;13290;20605;5960 ;30   ;ShapeStyle=HorzLine }
            { 1000000052;Label  ;150  ;100  ;6500 ;600  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หนังสือรับรองการหักภาษี ณ ที่จ่าย }
            { 1000000053;Label  ;9200 ;8000 ;2550 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.1ก พิเศษ }
            { 1000000054;Label  ;9200 ;8500 ;2550 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.3ก }
            { 1000000055;Shape  ;150  ;21200;19100;30   ;ShapeStyle=HorzLine }
            { 1000000056;Shape  ;150  ;23100;19100;30   ;ShapeStyle=HorzLine }
            { 1000000057;Label  ;290  ;23100;1650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 1000000058;Label  ;5170 ;23150;10550;550  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ขอรับรองว่า ข้อความและตัวเลขดังกล่าวข้างต้นถูกต้องตรงกับความจริงทุกประการ }
            { 1000000059;Label  ;5180 ;23900;860  ;523  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(ลงชื่อ) }
            { 1000000060;Shape  ;12100;8000 ;450  ;423   }
            { 1000000061;Shape  ;12100;8500 ;450  ;423   }
            { 1000000062;Label  ;5170 ;24550;6000 ;473  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................... }
            { 1000000063;Label  ;13200;8000 ;1950 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.2 }
            { 1000000064;Label  ;13250;8500 ;1950 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.53 }
            { 1000000065;Label  ;6020 ;23900;6640 ;523  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.............................................................................................. }
            { 1000000066;Shape  ;13280;9150 ;30   ;11550;ShapeStyle=VertLine }
            { 1000000067;Label  ;13400;9150 ;2650 ;846  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=จำนวนเงินที่จ่าย }
            { 1000000068;Shape  ;500  ;23500;500  ;360   }
            { 1000000069;Shape  ;500  ;23900;500  ;360   }
            { 1000000070;Label  ;1110 ;23500;2960 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=หักภาษี ณ ที่จ่าย }
            { 1000000071;Label  ;1110 ;23900;2990 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ออกภาษีให้ตลอดไป }
            { 1000000072;Shape  ;15450;8000 ;450  ;423   }
            { 1000000073;Label  ;12400;150  ;900  ;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=เล่มที่ }
            { 1000000074;Label  ;16500;8000 ;1450 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.3 }
            { 1000000075;Label  ;13300;150  ;1450 ;500  ;VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................ }
            { 1000000076;Label  ;11250;1350 ;3200 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000077;Label  ;10150;6300 ;3800 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000078;Shape  ;500  ;24300;500  ;360   }
            { 1000000079;Shape  ;500  ;24700;500  ;360   }
            { 1000000080;Label  ;12640;23900;3590 ;523  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ผู้มีหน้าที่หักภาษี ณ ที่จ่าย }
            { 1000000081;Label  ;11160;24550;4220 ;423  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=วัน เดือน ปี ที่ออกหนังสือรับรอง }
            { 1000000082;Shape  ;16400;9150 ;30   ;11550;ShapeStyle=VertLine }
            { 1000000083;Label  ;1110 ;24300;3400 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ออกภาษีให้ครั้งเดียว }
            { 1000000084;Label  ;1110 ;24700;3450 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=อื่นๆ ให้ระบุ................ }
            { 1000000085;Shape  ;15023;1400 ;1692 ;423   }
            { 1000000086;TextBox;14450;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[1] }
            { 1000000087;TextBox;15023;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[2] }
            { 1000000088;TextBox;15446;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[3] }
            { 1000000089;Shape  ;15446;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000090;TextBox;15869;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[4] }
            { 1000000091;Shape  ;15869;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000092;Shape  ;15869;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000093;TextBox;16292;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[5] }
            { 1000000094;Shape  ;16292;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000095;TextBox;16865;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[6] }
            { 1000000096;TextBox;17288;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[7] }
            { 1000000097;Shape  ;17288;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000098;TextBox;17711;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[8] }
            { 1000000099;Shape  ;17711;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000100;TextBox;18134;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[9] }
            { 1000000101;Shape  ;18134;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000102;TextBox;18707;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[10] }
            { 1000000103;TextBox;13400;20100;2550 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 1000000104;TextBox;16450;20100;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000121;Shape  ;16750;23400;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000122;Label  ;16800;23600;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000123;Label  ;16800;23916;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000124;Label  ;16800;24200;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000125;Label  ;14850;150  ;900  ;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000126;Label  ;15750;150  ;3300 ;500  ;VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................ }
            { 1000000127;Shape  ;14450;1400 ;423  ;423   }
            { 1000000128;Shape  ;14873;1400 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000129;Shape  ;16715;1400 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000130;Shape  ;16865;1400 ;1692 ;423   }
            { 1000000131;Shape  ;18557;1400 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000132;Shape  ;18707;1400 ;423  ;423   }
            { 1000000133;Label  ;1100 ;1800 ;10050;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000134;Label  ;900  ;1300 ;10310;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000135;TextBox;1000 ;1300 ;10060;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000136;Label  ;1150 ;2700 ;14570;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000137;Label  ;1000 ;2200 ;18100;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000138;TextBox;1100 ;2200 ;17550;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=[CompanyInfo.Address + ' ' + CompanyInfo."Address 2" + ' ' + CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" + ' ' + CompanyPhone ] }
            { 1000000143;Label  ;350  ;6250 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000144;Label  ;1050 ;6700 ;9100 ;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000145;Label  ;850  ;6250 ;9300 ;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000146;TextBox;950  ;6250 ;9200 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Name }
            { 1000000147;Label  ;350  ;7100 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000148;Label  ;900  ;7100 ;18200;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000149;TextBox;1050 ;7100 ;17600;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Address + '  ' + Address2 + '  ' + City + ' ' + Phone }
            { 1000000150;Label  ;1050 ;7600 ;14710;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000151;Label  ;5500 ;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(1) }
            { 1000000152;Label  ;8650 ;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(2) }
            { 1000000153;Label  ;12700;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(3) }
            { 1000000154;Label  ;16000;8000 ;550  ;450  ;FontName=ms san seriff;
                                                         FontSize=8;
                                                         CaptionML=ENU=(4) }
            { 1000000155;Label  ;5500 ;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(5) }
            { 1000000156;Label  ;8650 ;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(6) }
            { 1000000157;Label  ;12700;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(7) }
            { 1000000158;Label  ;10800;9550 ;2400 ;450  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=หรือปีภาษี ที่จ่าย }
            { 1000000159;Label  ;16600;9150 ;2200 ;444  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ภาษีที่หัก }
            { 1000000160;Label  ;16600;9594 ;2200 ;450  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=และนำส่งไว้ }
            { 1000000161;Shape  ;16000;10000;30   ;10700;ShapeStyle=VertLine }
            { 1000000162;Shape  ;18800;10000;30   ;10700;ShapeStyle=VertLine }
            { 1000000163;Label  ;900  ;12050;7800 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1) กิจการที่ต้องเสียภาษีเงินได้นิติบุคคลในอัตราดังนี้ }
            { 1000000164;Label  ;1950 ;12450;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.1) อัตราร้อยละ 30 ของกำไรสุทธิ }
            { 1000000165;Label  ;1950 ;12850;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.2) อัตราร้อยละ 25 ของกำไรสุทธิ }
            { 1000000166;Label  ;1960 ;13250;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.3) อัตราร้อยละ 20 ของกำไรสุทธิ }
            { 1000000167;Label  ;1950 ;13650;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.4) อัตราอื่นๆ (ระบุ)................... ของกำไรสุทธิ }
            { 1000000168;Shape  ;1400 ;12450;450  ;360   }
            { 1000000169;Shape  ;1400 ;12850;450  ;360   }
            { 1000000170;Shape  ;1400 ;13250;450  ;360   }
            { 1000000171;Shape  ;1400 ;13650;450  ;360   }
            { 1000000172;Label  ;900  ;14050;9800 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2) กิจการที่ได้รับยกเว้นภาษีเงินได้นิติบุคคล ซึ่งผู้รับเงินปันผลไม่ได้รับเครดิตภาษี }
            { 1000000173;Label  ;1350 ;14450;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.1) กำไรสุทธิของกิจการที่ได้รับยกเว้นภาษีเงินได้นิติบุคคล }
            { 1000000174;Label  ;1350 ;14850;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.2) เงินปันผลหรือเงินส่วนแบ่งของกำไรที่ได้รับยกเว้นไม่ต้องนำมารวม }
            { 1000000175;Label  ;290  ;20700;4360 ;500  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมเงินภาษีที่หักนำส่ง (ตัวอักษร) }
            { 1000000176;Label  ;1620 ;25150;14930;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ให้สามารถอ้างอิงหรือสอบยันกันได้ระหว่างลำดับที่ตามหนังสือรับรองฯ กับแบบยื่นรายการภาษีหัก ณ ที่จ่าย }
            { 1000000177;Label  ;320  ;25550;1340 ;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=คำเตือน }
            { 1000000178;TextBox;15550;8000 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTGroup[1] }
            { 1000000179;TextBox;12200;8500 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTGroup[2] }
            { 1000000180;TextBox;600  ;24320;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         OptionCaptionML=ENU=1;
                                                         OptionString=1;
                                                         SourceExpr=WHTTerm[1] }
            { 1000000181;TextBox;600  ;23920;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[2] }
            { 1000000182;TextBox;600  ;23520;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[3] }
            { 1000000183;TextBox;600  ;24720;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[4] }
            { 1000000184;TextBox;10800;10050;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[1] }
            { 1000000185;TextBox;10800;10450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[2] }
            { 1000000186;TextBox;10800;10850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[3] }
            { 1000000187;TextBox;10800;11250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[4] }
            { 1000000188;TextBox;10800;12450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[5] }
            { 1000000189;TextBox;10800;12850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[6] }
            { 1000000190;TextBox;10800;13250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[7] }
            { 1000000191;TextBox;10800;13650;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[8] }
            { 1000000192;TextBox;10800;14450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[9] }
            { 1000000193;TextBox;10800;14850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[10] }
            { 1000000194;TextBox;10800;15650;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[11] }
            { 1000000195;TextBox;10800;16450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[12] }
            { 1000000196;TextBox;13400;10050;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[1] }
            { 1000000197;TextBox;13400;10450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[2] }
            { 1000000198;TextBox;13400;10850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[3] }
            { 1000000199;TextBox;13400;11250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[4] }
            { 1000000200;TextBox;13400;12450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[5] }
            { 1000000201;TextBox;13400;12850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[6] }
            { 1000000202;TextBox;13400;13250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[7] }
            { 1000000203;TextBox;13400;13650;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[8] }
            { 1000000204;TextBox;13400;14450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[9] }
            { 1000000205;TextBox;13400;14850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[10] }
            { 1000000206;TextBox;13400;15650;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[11] }
            { 1000000207;TextBox;13400;16450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[12] }
            { 1000000208;TextBox;16450;10050;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[1] }
            { 1000000209;TextBox;16450;10450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[2] }
            { 1000000210;TextBox;16450;10850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[3] }
            { 1000000211;TextBox;16450;11250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[4] }
            { 1000000212;TextBox;16450;12450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[5] }
            { 1000000213;TextBox;16450;12850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[6] }
            { 1000000214;TextBox;16450;13250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[7] }
            { 1000000215;TextBox;16450;13650;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[8] }
            { 1000000216;TextBox;16450;14450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[9] }
            { 1000000217;TextBox;16450;14850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[10] }
            { 1000000218;TextBox;16450;15650;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[11] }
            { 1000000219;TextBox;16450;16450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[12] }
            { 1000000220;TextBox;1500 ;12450;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[1] }
            { 1000000221;TextBox;1500 ;12850;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[2] }
            { 1000000222;TextBox;1500 ;13250;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[3] }
            { 1000000223;TextBox;1500 ;13650;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[4] }
            { 1000000224;TextBox;15850;150  ;3000 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=WHTSlipNo }
            { 1000000225;TextBox;4740 ;20700;13860;500  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=WHTAmtLCYText }
            { 1000000226;TextBox;13400;150  ;1250 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=FormBookNo }
            { 1000000227;Label  ;2050 ;19677;8530 ;400  ;VertAlign=Bottom;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=.......................................................................................................................... }
            { 1000000228;TextBox;2150 ;19627;6700 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText }
            { 1000000229;Shape  ;150  ;3250 ;19100;2350 ;ShapeStyle=Rectangle }
            { 1000000230;Label  ;400  ;3300 ;5100 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU="กระทำการแทน : " }
            { 1000000231;Label  ;11200;3800 ;3200 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000232;Label  ;900  ;3750 ;10250;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000233;TextBox;1000 ;3750 ;10040;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ConductName }
            { 1000000234;TextBox;14450;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[1] }
            { 1000000235;TextBox;15023;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[2] }
            { 1000000236;TextBox;15446;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[3] }
            { 1000000237;Shape  ;15446;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000238;TextBox;15869;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[4] }
            { 1000000239;Shape  ;15869;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000240;TextBox;16292;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[5] }
            { 1000000241;Shape  ;16250;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000242;TextBox;16865;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[6] }
            { 1000000243;TextBox;17288;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[7] }
            { 1000000244;Shape  ;17288;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000245;TextBox;17711;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[8] }
            { 1000000246;Shape  ;17711;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000247;TextBox;18134;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[9] }
            { 1000000248;Shape  ;18134;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000249;TextBox;18707;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[10] }
            { 1000000250;Shape  ;14873;3850 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000251;Shape  ;16715;3850 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000252;Shape  ;18557;3850 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000253;Shape  ;18707;3850 ;423  ;423   }
            { 1000000254;Label  ;400  ;3750 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000255;Label  ;1100 ;4250 ;10050;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000256;Label  ;400  ;4650 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000257;Label  ;1000 ;4650 ;18100;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000258;TextBox;1100 ;4650 ;17600;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ConductAddress }
            { 1000000259;Label  ;1150 ;5150 ;14610;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000260;TextBox;6220 ;24500;4600 ;473  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PostingDate }
            { 1000000261;TextBox;17197;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[10] }
            { 1000000262;Shape  ;18703;900  ;423  ;423   }
            { 1000000263;Shape  ;17620;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000264;TextBox;16774;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[9] }
            { 1000000265;Shape  ;16774;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000266;TextBox;15928;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[7] }
            { 1000000267;TextBox;16351;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[8] }
            { 1000000268;Shape  ;16351;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000269;TextBox;15505;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[6] }
            { 1000000270;Shape  ;15928;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000271;TextBox;14962;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[5] }
            { 1000000272;Shape  ;15385;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000273;TextBox;14539;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[4] }
            { 1000000274;Shape  ;14962;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000275;TextBox;14116;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[3] }
            { 1000000276;Shape  ;14539;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000277;Shape  ;14539;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000278;TextBox;13693;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[2] }
            { 1000000279;Shape  ;14116;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000280;Shape  ;13573;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000281;TextBox;13150;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[1] }
            { 1000000282;Label  ;8250 ;850  ;4850 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร (13 หลัก)* }
            { 1000000283;Shape  ;13290;20685;5960 ;30   ;ShapeStyle=HorzLine }
            { 1000000284;Shape  ;17197;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000285;Shape  ;17740;900  ;846  ;423   }
            { 1000000286;TextBox;17740;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[11] }
            { 1000000287;Shape  ;18583;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000288;Shape  ;18160;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000289;TextBox;18160;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[12] }
            { 1000000290;Label  ;8300 ;3300 ;4800 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร (13 หลัก)* }
            { 1000000291;TextBox;18703;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[13] }
            { 1000000292;Shape  ;17740;3350 ;846  ;423   }
            { 1000000293;Shape  ;18583;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000294;TextBox;18160;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[12] }
            { 1000000295;Shape  ;15505;3350 ;2115 ;423   }
            { 1000000296;TextBox;17197;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[10] }
            { 1000000297;Shape  ;17620;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000298;TextBox;17740;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[11] }
            { 1000000299;Shape  ;18160;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000300;TextBox;16774;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[9] }
            { 1000000301;Shape  ;16774;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000302;TextBox;15928;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[7] }
            { 1000000303;TextBox;16351;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[8] }
            { 1000000304;Shape  ;16351;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000305;Shape  ;17197;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000306;TextBox;15505;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[6] }
            { 1000000307;Shape  ;15928;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000308;Shape  ;13693;3350 ;1692 ;423   }
            { 1000000309;TextBox;14962;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[5] }
            { 1000000310;Shape  ;15385;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000311;TextBox;14539;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[4] }
            { 1000000312;Shape  ;14962;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000313;TextBox;14116;3350 ;420  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[3] }
            { 1000000314;Shape  ;14539;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000315;Shape  ;14539;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000316;TextBox;13693;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[2] }
            { 1000000317;Shape  ;14116;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000318;Shape  ;13573;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000319;Shape  ;13150;3350 ;423  ;423   }
            { 1000000320;TextBox;13150;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[1] }
            { 1000000321;Label  ;8300 ;5800 ;4880 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร (13 หลัก)* }
            { 1000000322;TextBox;18703;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[13] }
            { 1000000323;Shape  ;17740;5850 ;846  ;423   }
            { 1000000324;Shape  ;18583;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000325;TextBox;18160;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[12] }
            { 1000000326;Shape  ;15505;5850 ;2115 ;423   }
            { 1000000327;TextBox;17197;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[10] }
            { 1000000328;Shape  ;17620;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000329;TextBox;17740;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[11] }
            { 1000000330;Shape  ;18160;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000331;TextBox;16774;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[9] }
            { 1000000332;Shape  ;16774;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000333;TextBox;15928;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[7] }
            { 1000000334;TextBox;16351;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[8] }
            { 1000000335;Shape  ;16351;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000336;Shape  ;17197;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000337;TextBox;15505;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[6] }
            { 1000000338;Shape  ;15928;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000339;Shape  ;13693;5850 ;1692 ;423   }
            { 1000000340;TextBox;14962;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[5] }
            { 1000000341;Shape  ;15385;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000342;TextBox;14539;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[4] }
            { 1000000343;Shape  ;14962;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000344;TextBox;14116;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[3] }
            { 1000000345;Shape  ;14539;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000346;Shape  ;14539;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000347;TextBox;13693;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[2] }
            { 1000000348;Shape  ;14116;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000349;Shape  ;13573;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000350;Shape  ;13150;5850 ;423  ;423   }
            { 1000000351;TextBox;13150;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[1] }
            { 1000000352;Shape  ;4640 ;23100;30   ;2050 ;ShapeStyle=VertLine }
            { 1000000353;Label  ;270  ;21250;18690;450  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เงินสะสมจ่ายเข้ากองทุนสำรองเลี้ยงชีพใบอนุญาตเลขที่........................................................จำนวนเงิน................................บาท }
            { 1000000354;Shape  ;150  ;21750;19100;30   ;ShapeStyle=HorzLine }
            { 1000000355;Label  ;3300 ;21800;12750;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เงินสมทบจ่ายเข้ากองทุนประกันสังคม จำนวนเงิน.........................................บาท }
            { 1000000356;Label  ;2400 ;22200;4620 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขที่บัญชีนายจ้าง }
            { 1000000357;Label  ;9610 ;22200;7010 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขที่บัตรประกันสังคม ของผู้ถูกหักภาษี ณ ที่จ่าย }
            { 1000000358;Shape  ;4785 ;22600;1692 ;423   }
            { 1000000359;TextBox;5631 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[8] }
            { 1000000360;Shape  ;2943 ;22600;1692 ;423   }
            { 1000000361;Shape  ;2370 ;22600;423  ;423   }
            { 1000000362;TextBox;2370 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[1] }
            { 1000000363;TextBox;2943 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[2] }
            { 1000000364;TextBox;3366 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[3] }
            { 1000000365;Shape  ;3366 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000366;TextBox;3789 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[4] }
            { 1000000367;Shape  ;3789 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000368;TextBox;4212 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[5] }
            { 1000000369;Shape  ;4212 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000370;TextBox;4785 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[6] }
            { 1000000371;TextBox;5208 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[7] }
            { 1000000372;Shape  ;5208 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000373;Shape  ;5631 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000374;TextBox;6054 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[9] }
            { 1000000375;Shape  ;6054 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000376;Shape  ;2793 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000377;Shape  ;4635 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000378;Shape  ;6477 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000379;TextBox;6627 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[10] }
            { 1000000380;Shape  ;15713;22600;423  ;423   }
            { 1000000381;TextBox;15713;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[13] }
            { 1000000382;Shape  ;15593;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000383;Shape  ;14750;22600;846  ;423   }
            { 1000000384;TextBox;15170;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[12] }
            { 1000000385;Shape  ;12515;22600;2115 ;423   }
            { 1000000386;TextBox;14207;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[10] }
            { 1000000387;Shape  ;14630;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000388;TextBox;14750;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[11] }
            { 1000000389;Shape  ;15170;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000390;TextBox;13784;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[9] }
            { 1000000391;Shape  ;14207;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000392;Shape  ;13784;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000393;TextBox;12938;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[7] }
            { 1000000394;TextBox;13361;22600;420  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[8] }
            { 1000000395;Shape  ;13361;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000396;TextBox;12515;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[6] }
            { 1000000397;Shape  ;12938;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000398;Shape  ;10703;22600;1692 ;423   }
            { 1000000399;TextBox;11972;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[5] }
            { 1000000400;Shape  ;12395;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000401;TextBox;11549;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[4] }
            { 1000000402;Shape  ;11972;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000403;TextBox;11126;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[3] }
            { 1000000404;Shape  ;11549;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000405;Shape  ;11549;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000406;TextBox;10703;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[2] }
            { 1000000407;Shape  ;11126;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000408;Shape  ;10583;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000409;Shape  ;10160;22600;423  ;423   }
            { 1000000410;TextBox;10160;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[1] }
            { 1000000411;Label  ;1350 ;17650;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ซึ่งผู้รับเงินปันผลไม่ได้รับเครดิตภาษี }
            { 1000000412;Label  ;900  ;17250;9600 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(3) กำไรเฉพาะส่วนที่ได้รับยกเว้นไม่ต้องนำมารวมคำนวณภาษีเงินได้นิติบุคคล }
            { 1000000413;Label  ;1940 ;15250;8560 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=คำนวณเป็นรายได้เพื่อเสียภาษีเงินได้นิติบุคคล }
            { 1000000414;Label  ;1350 ;15650;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.3) กำไรสุทธิส่วนที่ได้หักผลขาดทุนสุทธิยกมาไม่เกิน 5 ปี }
            { 1000000415;Label  ;1940 ;16050;8560 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ก่อนรอบระยะเวลาบัญชีปัจจุบัน }
            { 1000000416;Label  ;1380 ;16850;9120 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.5) อื่นๆ (ระบุ)....................................................................................................... }
            { 1000000417;Label  ;1390 ;16450;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.4) กำไรที่รับรู้ทางบัญชีโดยวิธีส่วนได้เสีย (equity method) }
            { 1000000418;TextBox;10800;16850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[13] }
            { 1000000419;TextBox;13400;16850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[13] }
            { 1000000420;TextBox;16450;16850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[13] }
            { 1000000421;TextBox;10800;17250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[14] }
            { 1000000422;TextBox;13400;17250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[14] }
            { 1000000423;TextBox;16450;17250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[14] }
            { 1000000424;TextBox;10800;18027;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[15] }
            { 1000000425;TextBox;13400;18027;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[15] }
            { 1000000426;TextBox;16450;18027;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[15] }
            { 1000000427;TextBox;10800;19604;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[19] }
            { 1000000428;TextBox;13400;19604;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[19] }
            { 1000000429;TextBox;16450;19604;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[19] }
            { 1000000430;TextBox;7630 ;21200;5190 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         SourceExpr=PFundNo }
            { 1000000431;TextBox;14530;21200;2760 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=PFundAmt }
            { 1000000432;TextBox;10930;21720;3500 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=SocialAmt }
            { 1000000444;TextBox;10800;18450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[16] }
            { 1000000445;TextBox;13400;18450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[16] }
            { 1000000446;TextBox;16450;18450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[16] }
            { 1000000447;TextBox;10800;18850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[17] }
            { 1000000448;TextBox;13400;18850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[17] }
            { 1000000449;TextBox;16450;18850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[17] }
            { 1000000450;TextBox;10800;19250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[18] }
            { 1000000451;TextBox;13400;19250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[18] }
            { 1000000452;TextBox;16450;19250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[18] }
            { 1000000106;TextBox;13950;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[1] }
            { 1000000107;TextBox;14350;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[2] }
            { 1000000108;TextBox;14750;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[3] }
            { 1000000110;TextBox;15100;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[4] }
            { 1000000112;TextBox;15500;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[5] }
            { 1000000114;TextBox;15900;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[6] }
            { 1000000117;Shape  ;14350;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000113;Shape  ;14750;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000109;Shape  ;15100;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000116;Shape  ;15900;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000141;Shape  ;16300;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000115;TextBox;16300;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[7] }
            { 1000000119;Shape  ;16700;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000434;Shape  ;17100;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000010;TextBox;16700;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[8] }
            { 1000000118;TextBox;17100;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[9] }
            { 1000000435;Shape  ;17500;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000120;TextBox;17500;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[10] }
            { 1000000436;Shape  ;17900;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000140;TextBox;17900;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[11] }
            { 1000000433;Shape  ;18300;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000139;TextBox;18300;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[12] }
            { 1000000111;Shape  ;18700;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000009;TextBox;18700;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[13] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CASE Number OF
                             1: Heading := 'ฉบับที่ 1 (สำหรับผู้ถูกหักภาษี ณ ที่จ่าย ใช้แนบพร้อมกับแบบแสดงรายการภาษี)';
                             2: Heading := 'ฉบับที่ 2 (สำหรับผู้ถูกหักภาษี ณ ที่จ่าย เก็บไว้เป็นหลักฐาน)';
                             3: Heading := 'ฉบับที่ 3';
                             4: Heading := 'ฉบับที่ 4';
                           END;
                           CurrReport.SHOWOUTPUT(HeadingPrint);
                         END;

          }
          CONTROLS
          {
            { 1000000003;TextBox;150  ;0    ;16800;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         SourceExpr=Heading }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=16390;
      Height=9130;
      SaveValues=Yes;
      OnInit=BEGIN
               HeadingPrint := TRUE;
             END;

    }
    CONTROLS
    {
      { 1000000024;TextBox;4290 ;2640 ;7480 ;440  ;ParentControl=1000000006;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=ชื่อผู้กระทำการแทน;
                                                   SourceExpr=ConductName }
      { 1000000025;Label  ;440  ;2640 ;3740 ;440  ;ParentControl=1000000024 }
      { 1000000026;TextBox;4290 ;3190 ;11550;440  ;ParentControl=1000000006;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=ที่อยู่ผู้กระทำการแทน;
                                                   SourceExpr=ConductAddress }
      { 1000000027;Label  ;440  ;3190 ;3740 ;440  ;ParentControl=1000000026 }
      { 1000000028;TextBox;4290 ;3740 ;3630 ;440  ;ParentControl=1000000006;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=เลขประจำตัวผู้เสียภาษี;
                                                   SourceExpr=ConductVATID }
      { 1000000029;Label  ;440  ;3740 ;3740 ;440  ;ParentControl=1000000028 }
      { 1000000030;TextBox;4290 ;4290 ;3630 ;440  ;ParentControl=1000000006;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=เลขที่ประจำตัวประชาชน;
                                                   SourceExpr=ConductID }
      { 1000000031;Label  ;440  ;4290 ;3740 ;440  ;ParentControl=1000000030 }
      { 1000000006;Frame  ;220  ;2090 ;15840;2860 ;FontBold=Yes;
                                                   CaptionML=ENU=กระทำการแทนโดย }
      { 1000000007;TextBox;7040 ;5280 ;2530 ;440  ;CaptionML=ENU=เงินสะสมจ่ายเข้ากองทุนสำรองเลี้ยงชีพใบอนุญาตเลขที่;
                                                   SourceExpr=PFundNo }
      { 1000000008;TextBox;11550;5280 ;2530 ;440  ;CaptionML=ENU=จำนวนเงิน;
                                                   SourceExpr=PFundAmt }
      { 1000000009;Label  ;10010;5280 ;1430 ;440  ;ParentControl=1000000008 }
      { 1000000010;Label  ;14190;5280 ;1650 ;440  ;LeaderDots=No;
                                                   CaptionML=ENU=บาท }
      { 1000000011;TextBox;7040 ;5830 ;2530 ;440  ;CaptionML=ENU=เงินสมทบเข้ากองทุนประกันสังคม จำนวนเงิน;
                                                   SourceExpr=SocialAmt }
      { 1000000012;Label  ;9680 ;5830 ;1650 ;440  ;LeaderDots=No;
                                                   CaptionML=ENU=บาท }
      { 1000000013;Label  ;440  ;5280 ;6490 ;440  ;ParentControl=1000000007 }
      { 1000000014;Label  ;1430 ;5830 ;5500 ;440  ;ParentControl=1000000011 }
      { 1000000015;TextBox;4070 ;6380 ;2530 ;440  ;CaptionML=ENU=เลขที่บัญชีนายจ้าง;
                                                   SourceExpr=EmployerAccount }
      { 1000000016;TextBox;12760;6380 ;2530 ;440  ;CaptionML=ENU=เลขที่บัตรประกันสังคม ของผู้ถูกหักภาษี ณ ที่จ่าย;
                                                   SourceExpr=SocialID }
      { 1000000017;Label  ;6710 ;6380 ;5940 ;440  ;ParentControl=1000000016 }
      { 1000000018;OptionButton;3300;7040;3740;440;CaptionML=ENU=หักภาษี ณ ที่จ่าย;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=2 }
      { 1000000019;Label  ;1430 ;6380 ;2530 ;440  ;ParentControl=1000000015 }
      { 1000000020;OptionButton;3300;7480;3740;440;CaptionML=ENU=ออกภาษีให้ตลอดไป;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=1 }
      { 1000000021;Label  ;440  ;7040 ;2750 ;440  ;CaptionML=ENU=ผู้จ่ายเงิน }
      { 1000000022;OptionButton;3300;7920;3740;440;CaptionML=ENU=ออกภาษีให้ครั้งเดียว;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=0 }
      { 1000000023;OptionButton;3300;8360;3740;440;CaptionML=ENU=อื่นๆ ให้ระบุ................;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=3 }
      { 1000000002;TextBox;4070 ;220  ;1650 ;440  ;CaptionML=ENU=Form No.;
                                                   SourceExpr=FormBookNo }
      { 1000000003;Label  ;220  ;220  ;3740 ;440  ;ParentControl=1000000002;
                                                   CaptionML=ENU=Print Form 50 BIS Book No. }
      { 1000000000;TextBox;4070 ;770  ;1650 ;440  ;CaptionML=ENU=Number of copies;
                                                   SourceExpr=NumberOfCopy }
      { 1000000001;Label  ;220  ;770  ;3740 ;440  ;ParentControl=1000000000 }
      { 1000000004;CheckBox;4070;1320 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=พิมพ์ฉบับที่ (Heading Print);
                                                   SourceExpr=HeadingPrint }
      { 1000000005;Label  ;220  ;1320 ;3740 ;440  ;ParentControl=1000000004 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLSetup@1000000018 : Record 98;
      CompanyInfo@1000000007 : Record 79;
      PurchSetup@1000000034 : Record 312;
      GenJnlLine@1000000032 : Record 81;
      Vendor@1000000006 : Record 23;
      VendLedgEntry@1000000028 : Record 25;
      WHTBusPostingGrp@1000000005 : Record 28040;
      WHTRevType@1000000042 : Record 28042;
      xWHTEntry@1000000035 : Record 28044;
      WHTEntry@1000000020 : Record 28044;
      WHTEntry3@1000000047 : Record 28044;
      NoSeriesMgt@1000000033 : Codeunit 396;
      Name@1000000004 : Text[150];
      Address@1000000003 : Text[250];
      Address2@1000000002 : Text[250];
      City@1000000001 : Text[30];
      VAT@1000000008 : ARRAY [20] OF Code[1];
      SNo@1006 : Integer;
      Pdate@1007 : Date;
      CID@1009 : ARRAY [20] OF Code[1];
      i@1010 : Integer;
      ConductName@1000000022 : Text[250];
      ConductAddress@1000000015 : Text[250];
      ConductVATID@1000000080 : Text[20];
      ConductID@1000000026 : Text[20];
      CCID@1000000025 : ARRAY [20] OF Code[1];
      ID1@1000000079 : ARRAY [13] OF Code[1];
      ID2@1000000078 : ARRAY [13] OF Code[1];
      ID3@1000000077 : ARRAY [13] OF Code[1];
      PageNo@1000000009 : Integer;
      WHTGroup@1000000010 : ARRAY [2] OF Text[1];
      WHTTerm@1000000011 : ARRAY [4] OF Text[1];
      WHTPostingDate@1000000031 : ARRAY [19] OF Date;
      WHTBaseAmtLCYExcVAT@1000000013 : ARRAY [19] OF Decimal;
      WHTAmtLCY@1000000014 : ARRAY [19] OF Decimal;
      TotWHTBaseAmtLCYExcVAT@1000000023 : Decimal;
      TotWHTAmtLCY@1000000021 : Decimal;
      ExpenseType@1000000016 : ARRAY [4] OF Text[1];
      FormBookNo@1000000036 : Code[10];
      WHTAmtLCYText@1000000019 : Text[200];
      NumberOfCopy@1000000024 : Integer;
      NewDocNo@1000000038 : Code[20];
      WHTExpenseText@1000000040 : Text[30];
      HeadingPrint@1000000041 : Boolean;
      Heading@1000000000 : Text[100];
      DocNoFilter@1000000027 : Text[250];
      WHTSlipNo@1000000030 : Code[20];
      WHTSlipPrinted@1000000029 : Boolean;
      PayPer@1000000017 : Decimal;
      PostingDate@1000000012 : Date;
      PayDocNo@1000000037 : Code[20];
      OneDocPerWHTSlip@1000000044 : Boolean;
      PaymentAmount@1000000045 : Decimal;
      AppliedAmount@1000000048 : Decimal;
      TotalWHTAmount@1000000049 : Decimal;
      TotalWHTAmount2@1000000050 : Decimal;
      TotalWHTAmount3@1000000051 : Decimal;
      TempRemAmt@1000000053 : Decimal;
      TempRemAmtInclVAT@1000000052 : Decimal;
      TempVendLedgEntry@1000000046 : Record 25;
      PurchCrMemoHeader@1000000060 : Record 124;
      VendLedgEntry1@1000000059 : Record 25;
      VendLedgEntry2@1000000061 : Record 25;
      VendLedgEntry3@1000000067 : Record 25;
      WHTEntryTemp@1000000058 : Record 28044;
      PaymentAmount1@1000000056 : Decimal;
      MatchWHT@1000000055 : Boolean;
      EndRecord@1000000054 : Boolean;
      ExpectedAmount@1000000057 : Decimal;
      xOldDocNo@1000000063 : Code[20];
      WHTCreditAmount@1000000064 : Decimal;
      ApplyCreditAmount@1000000039 : Decimal;
      ApplyInvoiceAmount@1000000062 : Decimal;
      RespCenter@1000000066 : Record 5714;
      CompanyAddr@1000000065 : ARRAY [8] OF Text[50];
      FormatAddr@1000000068 : Codeunit 365;
      PaymentOption@1000000043 : '0,1,2,3';
      PFundNo@1000000076 : Code[20];
      PFundAmt@1000000075 : Decimal;
      SocialAmt@1000000074 : Decimal;
      EmployerAccount@1000000073 : Code[10];
      SocialID@1000000072 : Code[13];
      SoID@1000000071 : ARRAY [13] OF Code[1];
      EID@1000000070 : ARRAY [10] OF Code[1];
      CompanyPhone@1000000069 : Text[50];
      Phone@1000000081 : Text[50];

    PROCEDURE FormatNoThaiText@1000000000(Amount@1000000002 : Decimal) @1000000001 : Text[200];
    VAR
      AmountText@1000000000 : Text[30];
      x@1000000003 : Integer;
      l@1000000004 : Integer;
      p@1000000008 : Integer;
      adigit@1000000005 : Text[1];
      dflag@1000000006 : Boolean;
      WHTAmtThaiText@1000000007 : Text[200];
    BEGIN
      AmountText := FORMAT(Amount,0);
      x := STRPOS(AmountText,'.');
      CASE TRUE OF
        x = 0:
          AmountText := AmountText + '.00';
        x = STRLEN(AmountText) - 1:
          AmountText := AmountText + '0';
        x > STRLEN(AmountText) - 2:
          AmountText := COPYSTR(AmountText,1,x + 2);
      END;
      l := STRLEN(AmountText);
      REPEAT
        dflag := FALSE;
        p := STRLEN(AmountText) - l + 1;
        adigit := COPYSTR(AmountText,p,1);
        IF (l IN [4,12,20]) AND (l < STRLEN(AmountText)) AND (adigit = '1') THEN
          dflag := TRUE;
        WHTAmtThaiText := WHTAmtThaiText + FormatDigitThai(adigit, l-3, dflag);
        l := l - 1;
      UNTIL l=3;

      IF COPYSTR(AmountText,STRLEN(AmountText)-2,3) = '.00' THEN
        WHTAmtThaiText := WHTAmtThaiText + 'บาทถ้วน'
      ELSE BEGIN
        IF WHTAmtThaiText <> '' THEN
          WHTAmtThaiText := WHTAmtThaiText + 'บาท';
        l := 2;
        REPEAT
          dflag := FALSE;
          p := STRLEN(AmountText) - l + 1;
          adigit := COPYSTR(AmountText,p,1);
          IF (l = 1) AND (adigit = '1') AND (COPYSTR(AmountText,p-1,1) <> '0') THEN
            dflag := TRUE;
          WHTAmtThaiText := WHTAmtThaiText + FormatDigitThai(adigit, l, dflag);
          l := l - 1;
        UNTIL l=0;
        WHTAmtThaiText := WHTAmtThaiText + 'สตางค์';
      END;

      EXIT(WHTAmtThaiText);
    END;

    PROCEDURE FormatDigitThai@1000000005(adigit@1000000002 : Text[1];pos@1000000001 : Integer;dflag@1000000000 : Boolean) : Text[100];
    VAR
      fdigit@1000000003 : Text[30];
      fcount@1000000005 : Text[30];
    BEGIN
      CASE adigit OF
        '1':
          BEGIN
            IF (pos IN [1,9,17]) AND dflag THEN
              fdigit := 'เอ็ด'
            ELSE
              IF pos IN [2,10,18] THEN
                fdigit := ''
              ELSE
                fdigit := 'หนึ่ง';
          END;
        '2':
          BEGIN
            IF pos IN [2,10,18] THEN
              fdigit := 'ยี่'
            ELSE
              fdigit := 'สอง';
          END;
        '3':
          fdigit := 'สาม';
        '4':
          fdigit := 'สี่';
        '5':
          fdigit := 'ห้า';
        '6':
          fdigit := 'หก';
        '7':
          fdigit := 'เจ็ด';
        '8':
          fdigit := 'แปด';
        '9':
          fdigit := 'เก้า';
        '0':
          BEGIN
            IF pos IN [9,17,25] THEN
              fdigit := 'ล้าน';
          END;
        '-':
          fdigit := 'ลบ';
      END;
      IF (adigit <> '0') AND (adigit <> '-') THEN BEGIN
        CASE pos OF
          2,10,18:
            fcount := 'สิบ';
          3,11,19:
            fcount := 'ร้อย';
          5,13,21:
            fcount := 'พัน';
          6,14,22:
            fcount := 'หมื่น';
          7,15,23:
            fcount := 'แสน';
          9,17,25:
            fcount := 'ล้าน';
        END;
      END;
      EXIT(fdigit+fcount);
    END;

    PROCEDURE GetWHTEntry@1000000001(WHTEntry5@1000000000 : Record 28044);
    VAR
      WHTPostingSetup@1000000001 : Record 28043;
      PurchInvHeader@1000000002 : Record 122;
    BEGIN
      WITH WHTEntry5 DO BEGIN
        IF "Gen. Journal Line"."Actual Vendor No." <> '' THEN
          Vendor.GET("Gen. Journal Line"."Actual Vendor No.")
        ELSE
          IF NOT Vendor.GET("Actual Vendor No.") THEN
            Vendor.GET("Gen. Journal Line"."Account No.");

        //KKE : #002 +
        IF "Gen. Journal Line"."Dummy Vendor" AND PurchInvHeader.GET("Document No.") THEN BEGIN
          IF PurchInvHeader."Pay-to Name (Thai)" <> '' THEN BEGIN
            Name := PurchInvHeader."Pay-to Name (Thai)";
            Address := PurchInvHeader."Pay-to Address (Thai)";
          END ELSE BEGIN
            Name := PurchInvHeader."Pay-to Name" + PurchInvHeader."Pay-to Name 2";
            Address := PurchInvHeader."Pay-to Address" + ' ' +
                       PurchInvHeader."Pay-to Address 2" + ' ' + PurchInvHeader."Pay-to Address 3";
          END;
          FOR i := 1 TO STRLEN("Gen. Journal Line"."VAT Registration No.(Dummy)") DO
            VAT[i] := COPYSTR("Gen. Journal Line"."VAT Registration No.(Dummy)",i,1);
        END ELSE BEGIN
        //KKE : #002 -
          IF Vendor."Name (Thai)" <> '' THEN BEGIN
            Name := Vendor."Name (Thai)";
            Address := Vendor."Address (Thai)";
          END ELSE BEGIN
            Name := Vendor.Name + Vendor."Name 2";
            Address := Vendor.Address + ' ' + Vendor."Address 2" + ' ' + Vendor."Address 3";
          END;
          //KKE : #006 +
          IF Vendor."Phone No." <> '' THEN
            Phone := 'Tel. ' + Vendor."Phone No.";
          FOR i := 1 TO 13 DO
            ID3[i] := COPYSTR(Vendor."ID No.",i,1);
          //KKE : #006 -
          FOR i := 1 TO STRLEN(Vendor."VAT Registration No.") DO
            VAT[i] := COPYSTR(Vendor."VAT Registration No.",i,1);
        END;

        IF NOT WHTBusPostingGrp.GET(Vendor."WHT Business Posting Group") THEN
          WHTBusPostingGrp.INIT;

        IF WHTPostingSetup.GET("WHT Bus. Posting Group","WHT Prod. Posting Group") THEN
          CASE WHTPostingSetup."WHT Report" OF
            WHTPostingSetup."WHT Report"::"Por Ngor Dor 3":
              WHTGroup[1] := 'P';
            WHTPostingSetup."WHT Report"::"Por Ngor Dor 53":
              WHTGroup[2] := 'P';
          END;
        IF WHTRevType.GET("WHT Revenue Type") THEN BEGIN
          i := WHTRevType.Sequence;
          IF (i = 99) OR (i = 19) THEN BEGIN  //KKE : #006
            i := 19;
            WHTExpenseText := WHTRevType.Description;
            //WHTExpenseText := 'ค่าเช่า';
          END;
          WHTPostingDate[i] := "Gen. Journal Line"."Posting Date";
          PostingDate := "Gen. Journal Line"."Posting Date";

          //"Check Count" := "Open Entry";
          TempRemAmtInclVAT := 0;
          TempRemAmt := 0;
          WHTCreditAmount := 0;

          MatchWHT := FALSE;
          VendLedgEntry2.RESET;
          VendLedgEntry2.SETRANGE("Document Type",VendLedgEntry2."Document Type"::Invoice);
          VendLedgEntry2.SETRANGE("Document No.","Document No.");
          IF VendLedgEntry2.FIND('-') THEN BEGIN
            VendLedgEntry2.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)");

            MatchWHT := TRUE;
            PurchCrMemoHeader.SETRANGE("Applies-to Doc. Type",PurchCrMemoHeader."Applies-to Doc. Type"::Invoice);
            PurchCrMemoHeader.SETRANGE("Applies-to Doc. No.",VendLedgEntry2."Document No.");
            IF PurchCrMemoHeader.FIND('-') THEN BEGIN
              REPEAT
                VendLedgEntry1.SETRANGE("Document Type",VendLedgEntry1."Document Type"::"Credit Memo");
                VendLedgEntry1.SETRANGE("Document No.",PurchCrMemoHeader."No.");
                IF VendLedgEntry1.FIND('-') THEN BEGIN
                  VendLedgEntry1.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)");
                  WHTCreditAmount += VendLedgEntry1."Amount (LCY)";
                END;

                WHTEntryTemp.RESET;
                WHTEntryTemp.SETRANGE("Document Type","Document Type"::"Credit Memo");
                WHTEntryTemp.SETRANGE("Transaction Type","Transaction Type"::Purchase);
                //WHTEntryTemp.SETRANGE("Open Entry",TRUE);  //ESG 19.02.04
                WHTEntryTemp.SETRANGE("Document No.",PurchCrMemoHeader."No.");
                WHTEntryTemp.SETRANGE("WHT Bus. Posting Group","WHT Bus. Posting Group");
                WHTEntryTemp.SETRANGE("WHT Prod. Posting Group","WHT Prod. Posting Group");
      //          WHTEntryTemp.SETRANGE("Line No.","Line No.");
                IF WHTEntryTemp.FIND('-') THEN BEGIN
                  //TempRemAmtInclVAT += WHTEntryTemp."Base Amount Inc. VAT";
                  //TempRemAmt += WHTEntryTemp."Base (LCY)";
                  TempRemAmtInclVAT += WHTEntryTemp."Unrealized Base (LCY)";
                  TempRemAmt += WHTEntryTemp."Unrealized Base (LCY)";
                END;
              UNTIL PurchCrMemoHeader.NEXT=0;
            END;

            //KKE : #014 +
            IF WHTCreditAmount = 0 THEN BEGIN
              VendLedgEntry3.RESET;
              VendLedgEntry3.SETRANGE("Document Type",VendLedgEntry3."Document Type"::"Credit Memo");
              VendLedgEntry3.SETRANGE("Closed by Entry No.",VendLedgEntry2."Entry No.");
              IF VendLedgEntry3.FIND('-') THEN BEGIN
                VendLedgEntry3.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)");
                WHTCreditAmount += VendLedgEntry3."Amount (LCY)";

                WHTEntryTemp.RESET;
                WHTEntryTemp.SETRANGE("Document Type","Document Type"::"Credit Memo");
                WHTEntryTemp.SETRANGE("Transaction Type","Transaction Type"::Purchase);
                WHTEntryTemp.SETRANGE("Document No.",VendLedgEntry3."Document No.");
                WHTEntryTemp.SETRANGE("WHT Bus. Posting Group","WHT Bus. Posting Group");
                WHTEntryTemp.SETRANGE("WHT Prod. Posting Group","WHT Prod. Posting Group");
                IF WHTEntryTemp.FIND('-') THEN
                  REPEAT
                    TempRemAmtInclVAT += WHTEntryTemp."Unrealized Base (LCY)";
                    TempRemAmt += WHTEntryTemp."Unrealized Base (LCY)";
                  UNTIL WHTEntryTemp.NEXT=0;
              END;
            END;
            //KKE : #014 -
          END;

          ExpectedAmount := -(VendLedgEntry2."Amount (LCY)" + WHTCreditAmount);
          IF MatchWHT AND (ExpectedAmount <> 0) THEN BEGIN
            //"Check Count" := TRUE;
            IF PaymentAmount1 > ExpectedAmount THEN
              PaymentAmount1 := ExpectedAmount;
            //IF PaymentAmount1 > -VendLedgEntry2."Remaining Amt. (LCY)" THEN //kk ถ้ามีปัญหาแก้คืนตัวนี้
              //PaymentAmount1 := -VendLedgEntry2."Remaining Amt. (LCY)";    //kk ถ้ามีปัญหาแก้คืนตัวนี้
             IF PaymentAmount1 > -VendLedgEntry2."Amount to Apply" THEN
               PaymentAmount1 := -VendLedgEntry2."Amount to Apply"; //kittipong 03.10.2005
            AppliedAmount := ROUND((PaymentAmount1 * ("Unrealized Base (LCY)" + TempRemAmt)) / ExpectedAmount);
            PaymentAmount := PaymentAmount - AppliedAmount;
            IF "Rem Unrealized Amount (LCY)" + TempRemAmt = 0 THEN BEGIN
              //"Check Count" := FALSE;
              "Rem Unrealized Amount (LCY)" := 0;
            END;

            //KKE : #003 +
            IF ROUND(AppliedAmount * "WHT %" / 100) = "Rem Unrealized Amount (LCY)" THEN BEGIN
              TotalWHTAmount := ROUND(TotalWHTAmount + AppliedAmount * "WHT %" / 100) + "WHT Difference";
              TotalWHTAmount2 := TotalWHTAmount2 + "Amount (LCY)";
              WHTAmtLCY[i] := WHTAmtLCY[i] + ROUND(AppliedAmount * "WHT %" / 100) + "WHT Difference";
              WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + AppliedAmount;
              TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT + AppliedAmount;
              TotWHTAmtLCY := TotWHTAmtLCY + ROUND(AppliedAmount * "WHT %" / 100) + "WHT Difference";
            END ELSE BEGIN
            //KKE : #003 -
              TotalWHTAmount := ROUND(TotalWHTAmount + AppliedAmount * "WHT %" / 100);
              TotalWHTAmount2 := TotalWHTAmount2 + "Amount (LCY)";
              WHTAmtLCY[i] := WHTAmtLCY[i] + ROUND(AppliedAmount * "WHT %" / 100);
              WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + AppliedAmount;
              TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT + AppliedAmount;
              TotWHTAmtLCY := TotWHTAmtLCY + ROUND(AppliedAmount * "WHT %" / 100);
            END;
          END ELSE BEGIN
            IF ApplyCreditAmount <> 0 THEN BEGIN
              AppliedAmount := "Unrealized Base (LCY)";
              PaymentAmount := PaymentAmount - AppliedAmount;

              IF ROUND(AppliedAmount * "WHT %" / 100) = "Rem Unrealized Amount (LCY)" THEN BEGIN
                TotalWHTAmount := ROUND(TotalWHTAmount + AppliedAmount * "WHT %" / 100) + "WHT Difference";
                TotalWHTAmount2 := TotalWHTAmount2 + "Amount (LCY)";
                WHTAmtLCY[i] := WHTAmtLCY[i] + ROUND(AppliedAmount * "WHT %" / 100) + "WHT Difference";
                WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + AppliedAmount;
                TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT + AppliedAmount;
                TotWHTAmtLCY := TotWHTAmtLCY + ROUND(AppliedAmount * "WHT %" / 100) + "WHT Difference";
              END ELSE BEGIN
                TotalWHTAmount := ROUND(TotalWHTAmount + AppliedAmount * "WHT %" / 100);
                TotalWHTAmount2 := TotalWHTAmount2 + "Amount (LCY)";
                WHTAmtLCY[i] := WHTAmtLCY[i] + ROUND(AppliedAmount * "WHT %" / 100);
                WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + AppliedAmount;
                TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT + AppliedAmount;
                TotWHTAmtLCY := TotWHTAmtLCY + ROUND(AppliedAmount * "WHT %" / 100);
              END;
            END;
          END;
        END;
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut
      TSA : Theerasak Saenwiset

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   Update for version 4.0 TH.
      002   20.06.2005   KKE   Update 'Dummy Vendor'.
      003   04.08.2005   KKE   Correct WHT incase adjust wht amount.
      004   21.09.2005   KKE   Document Type must be specify when post payment.
      005   28.02.2006   TSA   Update for allow user to be able to select WHT Term before print.
      006   04.09.2006   KKE   Update for new format
      007   27.09.2007   KKE   Correct report for case Skip WHT.
                               Add 3 sub sequence in 5.
      014   16.11.2007   KKE   -fix bug WHT when use function apply entries on Purchase Credit Memo.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50004 Sales VAT
{
  OBJECT-PROPERTIES
  {
    Date=03/12/12;
    Time=[ 7:50:26 PM];
    Modified=Yes;
    Version List=AVATHA4.01,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sales VAT;
               THA=รายงานภาษีขาย];
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  IF "VAT Entry".GETFILTER("Submit Date") <> '' THEN
                    StartDate := "VAT Entry".GETRANGEMIN("Submit Date")
                  ELSE
                    StartDate := WORKDATE;

                  //ForMonth := FORMAT(StartDate,0,'<Month Text> <Year4>');
                  ForMonth := PurchaseVAT.FormatDateThai(1,StartDate);

                  VATEntryFilter := "VAT Entry".GETFILTERS;

                  CLEAR(HeadOffice);
                  CLEAR(Branch);
                  CASE TRUE OF
                    HB[1]: HeadOffice := 'P';
                    HB[2]: Branch := 'P';
                  END;

                  CompanyInfo.GET;
                  IF CompanyInfo."Company Name (Thai)" = '' THEN BEGIN
                    CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                    CompanyInfo."Company Address (Thai)" := CompanyInfo.Address + ' ' + CompanyInfo."Address 2" + ' ' + CompanyInfo."Address 3";
                  END;
                  IF CompanyInfo."VAT Registration No." <> '' THEN
                    FOR I := 1 TO 13 DO
                      TaxID[I] := COPYSTR(CompanyInfo."VAT Registration No.",I,1);

                  IF SendToExcel THEN BEGIN
                    Window.OPEN(
                      Text000 +
                      '@1@@@@@@@@@@@@@@@@@@@@@\');
                    Window.UPDATE(1,0);
                    TempExcelBuffer.DELETEALL;
                    CLEAR(TempExcelBuffer);

                    //Header
                    EnterCell(1,4,'รายงานภาษีขาย',TRUE,FALSE,FALSE,FALSE);
                    EnterCell(2,4,'สำหรับเดือน ' + ForMonth,TRUE,FALSE,FALSE,FALSE);
                    EnterCell(3,1,'ชื่อผู้ประกอบการ : ' + CompanyInfo."Company Name (Thai)",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(4,1,'ชื่อสถานประกอบการ : ',TRUE,FALSE,FALSE,FALSE);
                    EnterCell(5,2,CompanyInfo."Company Name (Thai)",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(6,2,CompanyInfo."Company Address (Thai)",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(7,2,'โทรศัพท์: '+ CompanyInfo."Phone No." + 'โทรสาร: ' + CompanyInfo."Fax No.",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(8,1,'เลขประจำตัวผู้เสียภาษี : ' + CompanyInfo."VAT Registration No.",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(6,6,HeadOffice,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(6,7,'สำนักงานใหญ่ 0000',FALSE,FALSE,FALSE,FALSE);
                    EnterCell(7,6,Branch,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(7,7,'สาขา '+BranchNo,FALSE,FALSE,FALSE,FALSE);
                    IF VATEntryFilter <> '' THEN
                      EnterCell(10,1,VATEntryFilter,FALSE,FALSE,TRUE,FALSE)
                    ELSE
                      EnterCell(10,1,'',FALSE,FALSE,TRUE,FALSE);
                    FOR I:= 2 TO 8 DO
                      EnterCell(10,I,'',FALSE,FALSE,TRUE,FALSE);
                    EnterCell(11,1,Text003,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,2,Text004,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,3,Text005,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,4,Text011,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,5,Text006,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,6,Text007,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,7,Text008,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,8,Text009,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,9,'',FALSE,FALSE,FALSE,TRUE);
                    RowNo := 11;
                  END;
                  I := 0;
                END;

    OnPostReport=BEGIN
                   IF SendToExcel THEN BEGIN
                     Window.CLOSE;
                     IF Option = Option::"Update Workbook" THEN BEGIN
                       TempExcelBuffer.OpenBook(FileName,SheetName);
                       TempExcelBuffer.CreateSheet(SheetName,'',COMPANYNAME,USERID);
                     END ELSE BEGIN
                       TempExcelBuffer.CreateBook;
                       TempExcelBuffer.CreateSheet('Sales VAT','Sales VAT',COMPANYNAME,USERID);
                     END;
                     TempExcelBuffer.GiveUserControl;
                   END;
                 END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table254;
        DataItemTableView=SORTING(Tax Invoice Date,Tax Invoice No.,Submit Date)
                          WHERE(Type=CONST(Sale));
        OnAfterGetRecord=BEGIN
                           IF VATProdPostingGrp.GET("VAT Prod. Posting Group") THEN
                             IF VATProdPostingGrp."No VAT" THEN
                               CurrReport.SKIP;

                           IF Amount <> 0 THEN BEGIN
                             VatBaseAmt := VatBaseAmt + Base;
                             VatAmt := VatAmt + Amount;
                           END ELSE
                             IF ("Unrealized Amount" <> 0) AND ("Unrealized Base" <> 0) THEN
                               CurrReport.SKIP;
                           {
                             ELSE
                               Base := 0;
                           } //burda 18.09.2007

                           //KKE : #003 +
                           //Insert VAT Entry temp and group by Tax Invoice No.
                           VATEntryTemp.RESET;
                           VATEntryTemp.SETCURRENTKEY("Tax Invoice Date","Tax Invoice No.");
                           VATEntryTemp.SETRANGE("Tax Invoice No.","Tax Invoice No.");
                           IF VATEntryTemp.FIND('-') THEN BEGIN
                             VATEntryTemp.Base += Base;
                             VATEntryTemp.Amount += Amount;
                             VATEntryTemp.MODIFY;
                           END ELSE BEGIN
                             VATEntryTemp := "VAT Entry";
                             VATEntryTemp.INSERT;
                           END;
                           //KKE : #003 -
                         END;

        OnPostDataItem=BEGIN
                         //KKE : #003 +
                         {
                         VATEntryTemp.RESET;
                         //VATEntryTemp.SETRANGE("Tax Invoice No.",'');
                         VATEntryTemp.SETRANGE(Amount,0);
                         VATEntryTemp.DELETEALL;
                         }//burda
                         //KKE : #003 -
                       END;

        ReqFilterFields=Submit Date,Tax Invoice No.,Tax Invoice Date,VAT Bus. Posting Group,VAT Prod. Posting Group;
        TotalFields=Base,Amount;
        GroupTotalFields=Tax Invoice No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=20000;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE); //KKE : #003
                           {
                           IF VatAmt <> 0 THEN BEGIN
                             I := I + 1;
                             IF SendToExcel THEN BEGIN
                               RowNo += 1;
                               EnterCell(RowNo,1,FORMAT(I),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,2,FORMAT("Posting Date"),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,3,"Document No.",FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,4,AccountName,FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,5,FORMAT(-VatBaseAmt),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,6,FORMAT(-VatAmt),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,7,FORMAT(-(VatBaseAmt + VatAmt)),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,8,'',FALSE,FALSE,FALSE,TRUE);
                             END;
                           END ELSE BEGIN
                             TotVatBaseAmt := TotVatBaseAmt - VatBaseAmt;
                             VatBaseAmt := 0;
                             CurrReport.SHOWOUTPUT(FALSE);
                           END;
                           }
                         END;

          }
          CONTROLS
          {
            { 1000000014;TextBox;1000 ;0    ;1300 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Tax Invoice Date" }
            { 1000000015;TextBox;12200;0    ;2250 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=-VatBaseAmt }
            { 1000000016;TextBox;2400 ;0    ;2500 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Tax Invoice No." }
            { 1000000018;TextBox;5100 ;0    ;6900 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=AccountName }
            { 1000000021;TextBox;14600;0    ;2100 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=-VatAmt }
            { 1000000022;TextBox;16850;0    ;2400 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=-(VatBaseAmt + VatAmt) }
            { 1000000026;TextBox;0    ;0    ;800  ;600  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=I }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=20000;
            SectionHeight=0;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           CLEAR(VatBaseAmt);
                           CLEAR(VatAmt);
                         END;

          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table50054;
        DataItemTableView=SORTING(Cancel Tax Invoice,Issued Tax Invoice/Receipt No.)
                          WHERE(Cancel Tax Invoice=CONST(Yes));
        DataItemVarName=Cancel Tax Invoice;
        OnPreDataItem=BEGIN
                        //KKE : #003 +
                        //Check cancel Tax Invoice No.
                        VATEntryTemp.RESET;
                        IF VATEntryTemp.FIND('+') THEN
                          EntryNo := VATEntryTemp."Entry No.";

                        IF "VAT Entry".GETFILTER("Submit Date") <> '' THEN
                          SETFILTER("Posting Date","VAT Entry".GETFILTER("Submit Date"))
                        ELSE IF "VAT Entry".GETFILTER("Tax Invoice Date") <> '' THEN
                          SETFILTER("Posting Date","VAT Entry".GETFILTER("Tax Invoice Date"));
                        //KKE : #003 -
                      END;

        OnAfterGetRecord=BEGIN
                           //KKE : #003 +
                           EntryNo += 1;
                           VATEntryTemp.INIT;
                           VATEntryTemp."Entry No." += EntryNo;
                           VATEntryTemp."Tax Invoice Date" := "Posting Date";
                           VATEntryTemp."Tax Invoice No." := "Issued Tax Invoice/Receipt No.";
                           VATEntryTemp."Reason Code" := 'CANCELLED';
                           VATEntryTemp.INSERT;
                           //KKE : #003 -
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        OnPreDataItem=BEGIN
                        //KKE : #003 +
                        VATEntryTemp.RESET;
                        IF VATEntryTemp.COUNT = 0 THEN
                          CurrReport.BREAK;

                        SETRANGE(Number,1,VATEntryTemp.COUNT);
                        VATEntryTemp.SETCURRENTKEY("Tax Invoice Date","Tax Invoice No.");
                        CurrReport.CREATETOTALS(VATEntryTemp.Base,VATEntryTemp.Amount);
                        //KKE : #003 -
                      END;

        OnAfterGetRecord=BEGIN
                           //KKE : #003 +
                           IF Number = 1 THEN
                             VATEntryTemp.FIND('-')
                           ELSE
                             IF VATEntryTemp.NEXT=0 THEN
                               CurrReport.BREAK;

                           CLEAR(CustNo);
                           CLEAR(AccountName);
                           IF VATEntryTemp."Real Customer/Vendor Name" <> '' THEN
                             AccountName := VATEntryTemp."Real Customer/Vendor Name"
                           ELSE BEGIN
                             IF SalesInvHeader.GET(VATEntryTemp."Document No.") THEN
                               IF SalesInvHeader."Bill-to Name (Thai)" <> '' THEN
                                 AccountName := SalesInvHeader."Bill-to Name (Thai)";
                           END;

                           IF AccountName = '' THEN BEGIN
                             CustLedgEntry.RESET;
                             CustLedgEntry.SETCURRENTKEY("Document No.","Document Type","Customer No.");
                             CustLedgEntry.SETRANGE("Document Type",VATEntryTemp."Document Type");
                             CustLedgEntry.SETRANGE("Document No.",VATEntryTemp."Document No.");
                             CustLedgEntry.SETRANGE("Posting Date",VATEntryTemp."Posting Date");
                             IF CustLedgEntry.FIND('-') THEN
                               CustNo := CustLedgEntry."Customer No."
                             ELSE
                               CustNo := VATEntryTemp."Bill-to/Pay-to No.";

                             IF Customer.GET(CustNo) THEN BEGIN
                               IF Customer."Name (Thai)" <> '' THEN
                                 AccountName := Customer."Name (Thai)"
                               ELSE
                                 AccountName := Customer.Name + Customer."Name 2";
                             END;
                           END;

                           IF VATEntryTemp."Reason Code" = 'CANCELLED' THEN
                             AccountName := 'CANCELLED';

                           IF VATEntryTemp."Document Type" <> VATEntryTemp."Document Type"::Invoice THEN
                             IF VATEntry.GET(VATEntryTemp."Unrealized VAT Entry No.") THEN
                               VATEntryTemp."Document No." := VATEntry."Document No.";
                           //KKE : #003 -
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=20000;
            SectionHeight=5500;
          }
          CONTROLS
          {
            { 1000000024;TextBox;4400 ;800  ;9800 ;700  ;HorzAlign=Center;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DateFormula=No;
                                                         SourceExpr='สำหรับเดือน ' + ForMonth }
            { 1000000032;Label  ;4400 ;0    ;9800 ;900  ;HorzAlign=Center;
                                                         FontName=AngsanaUPC;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รายงานภาษีขาย }
            { 1000000002;TextBox;18850;400  ;600  ;500  ;FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=หน้า;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000003;Label  ;18100;400  ;750  ;500  ;ParentControl=1000000002;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13 }
            { 1117700003;TextBox;16200;1000 ;3250 ;500  ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=11;
                                                         CaptionML=ENU=หน้า;
                                                         SourceExpr=FORMAT(TODAY,0,1) + ' / ' + FORMAT(TIME,0) }
            { 1000000067;Label  ;14000;1800 ;5700 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000068;TextBox;2900 ;1800 ;11000;600  ;FontName=AngsanaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         DateFormula=No;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000069;Shape  ;14000;2500 ;5700 ;423   }
            { 1000000070;TextBox;18000;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[10] }
            { 1000000071;Shape  ;18050;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000072;TextBox;17600;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[9] }
            { 1000000073;TextBox;17150;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[8] }
            { 1000000074;Shape  ;17600;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;17150;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000076;TextBox;16700;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[7] }
            { 1000000077;TextBox;16250;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[6] }
            { 1000000078;Shape  ;16700;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000079;TextBox;15800;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[5] }
            { 1000000080;Shape  ;16250;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000081;TextBox;15350;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[4] }
            { 1000000082;Shape  ;15800;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000083;Shape  ;15350;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000084;Shape  ;15350;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000085;TextBox;14900;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[3] }
            { 1000000086;Shape  ;14900;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000087;TextBox;14450;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[2] }
            { 1000000088;Shape  ;14450;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000089;TextBox;14000;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[1] }
            { 1000000091;Label  ;15700;3100 ;2200 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=สำนักงานใหญ่ }
            { 1000000092;TextBox;17900;3100 ;1800 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         SourceExpr='0000' }
            { 1000000093;TextBox;15200;3200 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=HeadOffice }
            { 1000000094;Shape  ;15100;3200 ;450  ;423   }
            { 1000000095;Label  ;0    ;2500 ;3100 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=ชื่อสถานประกอบการ }
            { 1000000096;Label  ;0    ;1800 ;2800 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=ชื่อผู้ประกอบการ }
            { 1000000097;TextBox;400  ;3100 ;13500;2400 ;VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DateFormula=No;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" +'\' + CompanyInfo."Company Address (Thai)" +'\' + 'โทรศัพท์: '+ CompanyInfo."Phone No." + '  โทรสาร: ' + CompanyInfo."Fax No." }
            { 1000000098;Label  ;15700;3800 ;1000 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=สาขา }
            { 1000000099;TextBox;16700;3800 ;3000 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         SourceExpr=BranchNo }
            { 1000000100;TextBox;15200;3900 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=Branch }
            { 1000000101;Shape  ;15100;3900 ;450  ;423   }
            { 1000000036;Shape  ;18400;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000037;TextBox;18400;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[11] }
            { 1000000038;TextBox;18800;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[12] }
            { 1000000040;TextBox;19200;2500 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[13] }
            { 1000000041;Shape  ;19200;2500 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000042;Shape  ;18800;2500 ;30   ;423  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=20000;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(VATEntryFilter <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000045;TextBox;0    ;0    ;19200;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DateFormula=No;
                                                         SourceExpr=VATEntryFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=20000;
            SectionHeight=1300;
          }
          CONTROLS
          {
            { 1000000056;Label  ;17900;100  ;2000 ;1100 ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รวม }
            { 1000000057;Label  ;15600;100  ;2000 ;1100 ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ภาษีมูลค่าเพิ่ม }
            { 1000000058;Shape  ;0    ;0    ;19900;100  ;ShapeStyle=HorzLine }
            { 1000000059;Label  ;2400 ;100  ;2500 ;1100 ;HorzAlign=General;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เลขที่ใบกำกับภาษี }
            { 1000000060;Label  ;7800 ;100  ;1850 ;1100 ;HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000061;Label  ;1100 ;100  ;1200 ;1100 ;HorzAlign=General;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000062;Label  ;0    ;0    ;900  ;700  ;HorzAlign=Center;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลำดับ }
            { 1000000063;Label  ;13200;0    ;2300 ;700  ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=มูลค่าสินค้า }
            { 1000000064;Shape  ;0    ;1200 ;19900;100  ;ShapeStyle=HorzLine }
            { 1000000065;Label  ;13200;600  ;2300 ;700  ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=และบริการ }
            { 1000000001;Label  ;0    ;600  ;900  ;700  ;HorzAlign=Center;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ที่ }
            { 1000000033;Label  ;5000 ;100  ;2400 ;1100 ;HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เลขที่ใบแจ้งหนี้ }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=20000;
            SectionHeight=600;
            OnPreSection=BEGIN
                           ShortName := FALSE;
                           IF STRLEN(AccountName) <= 40 THEN
                             ShortName := TRUE;
                           IF SendToExcel THEN BEGIN
                             RowNo += 1;
                             EnterCell(RowNo,1,FORMAT(Number),FALSE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,2,FORMAT(VATEntryTemp."Tax Invoice Date"),FALSE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,3,VATEntryTemp."Tax Invoice No.",FALSE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,4,VATEntryTemp."Document No.",FALSE,FALSE,TRUE,TRUE);//GKU:#005
                             EnterCell(RowNo,5,AccountName,FALSE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,6,FORMAT(-VATEntryTemp.Base),FALSE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,7,FORMAT(-VATEntryTemp.Amount),FALSE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,8,FORMAT(-(VATEntryTemp.Base + VATEntryTemp.Amount)),FALSE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,9,'',FALSE,FALSE,FALSE,TRUE);
                           END;
                           CurrReport.SHOWOUTPUT := ShortName;
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;1000 ;0    ;1300 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VATEntryTemp."Tax Invoice Date" }
            { 1000000004;TextBox;13000;0    ;2250 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-VATEntryTemp.Base }
            { 1000000010;TextBox;2400 ;0    ;2500 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VATEntryTemp."Tax Invoice No." }
            { 1000000011;TextBox;7500 ;0    ;5500 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=AccountName }
            { 1000000013;TextBox;15400;0    ;2000 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-VATEntryTemp.Amount }
            { 1000000017;TextBox;17500;0    ;2400 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-(VATEntryTemp.Base + VATEntryTemp.Amount) }
            { 1000000020;TextBox;0    ;0    ;800  ;600  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Number }
            { 1000000034;TextBox;5000 ;0    ;2400 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VATEntryTemp."Document No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=20000;
            SectionHeight=900;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := NOT ShortName;
                         END;

          }
          CONTROLS
          {
            { 1000000023;TextBox;1000 ;0    ;1300 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VATEntryTemp."Tax Invoice Date" }
            { 1000000025;TextBox;13000;0    ;2250 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-VATEntryTemp.Base }
            { 1000000027;TextBox;2400 ;0    ;2500 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VATEntryTemp."Tax Invoice No." }
            { 1000000028;TextBox;7500 ;100  ;5500 ;800  ;VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         MultiLine=Yes;
                                                         SourceExpr=AccountName }
            { 1000000029;TextBox;15400;0    ;2000 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-VATEntryTemp.Amount }
            { 1000000030;TextBox;17500;0    ;2400 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-(VATEntryTemp.Base + VATEntryTemp.Amount) }
            { 1000000031;TextBox;0    ;0    ;800  ;600  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Number }
            { 1000000035;TextBox;5000 ;0    ;2400 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VATEntryTemp."Document No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20000;
            SectionHeight=980;
            OnPreSection=BEGIN
                           IF SendToExcel THEN BEGIN
                             RowNo += 1;
                             EnterCell(RowNo,1,Text010,TRUE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,2,'',TRUE,FALSE,TRUE,FALSE);
                             EnterCell(RowNo,3,'',TRUE,FALSE,TRUE,FALSE);
                             EnterCell(RowNo,4,'',TRUE,FALSE,TRUE,FALSE);
                             EnterCell(RowNo,5,'',TRUE,FALSE,TRUE,FALSE);//GKU:#005
                             EnterCell(RowNo,6,FORMAT(-VATEntryTemp.Base),TRUE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,7,FORMAT(-VATEntryTemp.Amount),TRUE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,8,FORMAT(-(VATEntryTemp.Base + VATEntryTemp.Amount)),TRUE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,9,'',FALSE,FALSE,FALSE,TRUE);
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000005;Label  ;120  ;0    ;2100 ;800  ;HorzAlign=Center;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=No;
                                                         CaptionML=ENU=รวมทั้งสิ้น }
            { 1000000006;Shape  ;0    ;0    ;19900;100  ;ShapeStyle=HorzLine }
            { 1000000007;Shape  ;0    ;800  ;19900;100  ;ShapeStyle=HorzLine }
            { 1000000008;Shape  ;0    ;880  ;19900;100  ;ShapeStyle=HorzLine }
            { 1000000009;TextBox;17500;200  ;2400 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-(VATEntryTemp.Base + VATEntryTemp.Amount) }
            { 1000000012;TextBox;15400;200  ;2000 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-VATEntryTemp.Amount }
            { 1000000019;TextBox;13000;200  ;2250 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-VATEntryTemp.Base }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=12430;
      Height=3630;
      OnInit=BEGIN
               HB[1] := TRUE;
               HB[2] := FALSE;
             END;

      OnOpenForm=BEGIN
                   RequestOptionsForm.BLookup.ENABLED := FALSE;
                   UpdateRequestForm;
                 END;

    }
    CONTROLS
    {
      { 1000000000;CheckBox;3520;770  ;440  ;440  ;InPage=-1;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Branch;
                                                              THA=สาขา];
                                                   SourceExpr=HB[2];
                                                   OnPush=BEGIN
                                                            IF HB[2] THEN BEGIN
                                                              HB[1] := FALSE;
                                                              RequestOptionsForm.BLookup.ENABLED := TRUE;
                                                            END ELSE BEGIN
                                                              HB[1] := TRUE;
                                                              RequestOptionsForm.BLookup.ENABLED := FALSE;
                                                            END;
                                                          END;
                                                           }
      { 1000000001;Label  ;110  ;770  ;3300 ;440  ;ParentControl=1000000000 }
      { 1000000002;CheckBox;3520;220  ;440  ;440  ;InPage=-1;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Head Office;
                                                              THA=ไม่แยกสาขา];
                                                   SourceExpr=HB[1];
                                                   OnValidate=BEGIN
                                                                IF HB[1] THEN BEGIN
                                                                  HB[2] := FALSE;
                                                                  RequestOptionsForm.BLookup.ENABLED := FALSE;
                                                                END ELSE BEGIN
                                                                  HB[2] := TRUE;
                                                                  RequestOptionsForm.BLookup.ENABLED := TRUE;
                                                                END;
                                                              END;
                                                               }
      { 1000000003;Label  ;110  ;220  ;3300 ;440  ;ParentControl=1000000002 }
      { 1000000004;TextBox;4070 ;770  ;2420 ;440  ;Name=BLookup;
                                                   InPage=-1;
                                                   CaptionML=[ENU=No.;
                                                              THA=เลขที่];
                                                   SourceExpr=BranchNo }
      { 1000000005;CheckBox;3520;1540 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Send To Excel;
                                                   SourceExpr=SendToExcel }
      { 1000000006;Label  ;110  ;1540 ;3300 ;440  ;ParentControl=1000000005;
                                                   InPage=-1 }
      { 1000000007;TextBox;3520 ;2640 ;5500 ;440  ;Name=FileNamex;
                                                   CaptionML=[ENU=Workbook File Name;
                                                              THA=ชื่อแฟ้มสมุดงาน];
                                                   SourceExpr=FileName;
                                                   OnAssistEdit=BEGIN
                                                                  UploadFile;
                                                                  IF ISSERVICETIER AND (UploadedFileName <> '') THEN
                                                                    FileName := Text103;
                                                                END;

                                                   OnAfterValidate=BEGIN
                                                                     UploadFile;
                                                                     IF ISSERVICETIER AND (UploadedFileName <> '') THEN
                                                                       FileName := Text103;
                                                                   END;
                                                                    }
      { 1000000008;Label  ;110  ;2640 ;3300 ;440  ;ParentControl=1000000007;
                                                   InPage=-1 }
      { 1000000009;TextBox;3520 ;3190 ;5500 ;440  ;Name=SheetNamex;
                                                   CaptionML=[ENU=Worksheet Name;
                                                              THA=ชื่อแผ่นงาน];
                                                   SourceExpr=SheetName;
                                                   OnAssistEdit=VAR
                                                                  ExcelBuf@1001 : Record 370;
                                                                BEGIN
                                                                  IF ISSERVICETIER THEN
                                                                    SheetName := ExcelBuf.SelectSheetsName(UploadedFileName)
                                                                  ELSE
                                                                    SheetName := ExcelBuf.SelectSheetsName(FileName);
                                                                END;
                                                                 }
      { 1000000010;Label  ;110  ;3190 ;3300 ;440  ;ParentControl=1000000009;
                                                   InPage=-1 }
      { 1000000011;TextBox;3520 ;2090 ;2750 ;440  ;CaptionML=[ENU=Option;
                                                              THA=ตัวเลือก];
                                                   OptionCaptionML=[ENU=Create Workbook,Update Workbook;
                                                                    THA=สร้างสมุดงาน,ปรับปรุงสมุดงาน];
                                                   SourceExpr=Option;
                                                   OnValidate=BEGIN
                                                                UpdateRequestForm;
                                                              END;
                                                               }
      { 1000000012;Label  ;110  ;2090 ;3300 ;440  ;ParentControl=1000000011;
                                                   InPage=-1 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000031 : Record 79;
      Customer@1000000025 : Record 18;
      CustLedgEntry@1000000001 : Record 21;
      Vendor@1000000024 : Record 23;
      PurchaseVAT@1000000015 : Report 50005;
      VATProdPostingGrp@1000000018 : Record 324;
      SalesInvHeader@1000000017 : Record 112;
      StartDate@1000000019 : Date;
      CustNo@1000000016 : Code[20];
      AccountName@1000000014 : Text[150];
      HeadOffice@1000000011 : Text[1];
      Branch@1000000010 : Text[1];
      BranchNo@1000000009 : Text[30];
      VATEntryFilter@1000000008 : Text[250];
      ForMonth@1000000007 : Text[250];
      VatAmt@1000000006 : Decimal;
      VatBaseAmt@1000000005 : Decimal;
      TotVatAmt@1000000004 : Decimal;
      TotVatBaseAmt@1000000003 : Decimal;
      Text000@1000000027 : TextConst 'ENU=Analyzing Data...\\;THA=กำลังวิเคราะห์ข้อมูล...\\';
      Text001@1000000002 : TextConst 'ENU=สินค้าและบริการ';
      I@1000000013 : Integer;
      HB@1000000012 : ARRAY [2] OF Boolean;
      TempExcelBuffer@1000000026 : TEMPORARY Record 370;
      Window@1000000023 : Dialog;
      RowNo@1000000020 : Integer;
      SendToExcel@1000000028 : Boolean;
      FileName@1000000032 : Text[250];
      SheetName@1000000030 : Text[250];
      UploadedFileName@1000000045 : Text[1024];
      FileNameEnable@1000000047 : Boolean INDATASET;
      SheetNameEnable@1000000046 : Boolean INDATASET;
      Option@1000000029 : 'Create Workbook,Update Workbook';
      Text002@1000000033 : TextConst 'ENU=Update Workbook;THA=ปรับปรุงสมุดงาน';
      Text003@1000000034 : TextConst 'ENU=ลำดับที่';
      Text004@1000000035 : TextConst 'ENU=วันที่';
      Text005@1000000036 : TextConst 'ENU=เลขที่ใบกำกับภาษี';
      Text006@1000000037 : TextConst 'ENU=รายละเอียด';
      Text007@1000000038 : TextConst 'ENU=มูลค่าสินค้าและบริการ';
      Text008@1000000039 : TextConst 'ENU=ภาษีมูลค่าเพิ่ม';
      Text009@1000000040 : TextConst 'ENU=รวม';
      Text010@1000000041 : TextConst 'ENU=รวมทั้งสิ้น';
      TaxID@1000000000 : ARRAY [13] OF Text[1];
      VATEntryTemp@1000000021 : TEMPORARY Record 254;
      EntryNo@1000000022 : Integer;
      ShortName@1000000042 : Boolean;
      VATEntry@1000000043 : Record 254;
      Text011@1000000044 : TextConst 'ENU=เลขที่ใบแจ้งหนี้';
      Text103@1000000048 : TextConst 'ENU=The file was successfully uploaded to server;THA=อัพโหลดแฟ้มไปยังเซิร์ฟเวอร์เรียบร้อยแล้ว';

    PROCEDURE UpdateRequestForm@1000000000();
    BEGIN
      IF ISSERVICETIER THEN BEGIN
        PageUpdateRequestForm;
        EXIT;
      END;
      IF Option = Option::"Update Workbook" THEN BEGIN
        IF NOT ISSERVICETIER THEN BEGIN
          RequestOptionsForm.FileNamex.ENABLED(TRUE);
          RequestOptionsForm.SheetNamex.ENABLED(TRUE);
        END;
      END ELSE BEGIN
        FileName := '';
        UploadedFileName := '';
        SheetName := '';
        IF NOT ISSERVICETIER THEN BEGIN
          RequestOptionsForm.FileNamex.ENABLED(FALSE);
          RequestOptionsForm.SheetNamex.ENABLED(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE EnterCell@2(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Bold@1003 : Boolean;Italic@1004 : Boolean;UnderLine@1005 : Boolean;EdgeLeft@1000000000 : Boolean);
    BEGIN
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := Bold;
      TempExcelBuffer.Italic := Italic;
      TempExcelBuffer.Underline := UnderLine;
      IF UnderLine THEN
        TempExcelBuffer."Line Style" := 1;
      TempExcelBuffer.EdgeLeft := EdgeLeft;
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE UploadFile@6();
    VAR
      CommonDialogMgt@1000 : Codeunit 412;
    BEGIN
      UploadedFileName := CommonDialogMgt.OpenFile(Text002,FileName,2,'',0);
      FileName := UploadedFileName;
    END;

    LOCAL PROCEDURE PageUpdateRequestForm@19031953();
    BEGIN
      IF Option = Option::"Update Workbook" THEN BEGIN
        IF NOT ISSERVICETIER THEN BEGIN
          FileNameEnable := TRUE;
          SheetNameEnable := TRUE;
        END;
      END ELSE BEGIN
        FileName := '';
        UploadedFileName := '';
        SheetName := '';
        IF NOT ISSERVICETIER THEN BEGIN
          FileNameEnable := FALSE;
          SheetNameEnable := FALSE;
        END;
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   -Sales VAT Report.
      002   08.06.2005   KKE   -Send report to Excel.
      Project: Siam2You
      003   25.12.2005   KKE   -AR-002 -Change sorting by Tax Invoice No.,Tax Invoice Date
      Burda
      004   16.07.2007   KKE   -do not skip zero vat.
      005   31.10.2007   GKU   -Add document number to excel file
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50005 Purchase VAT
{
  OBJECT-PROPERTIES
  {
    Date=03/12/12;
    Time=[ 7:51:23 PM];
    Modified=Yes;
    Version List=AVATHA4.01,Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  IF "VAT Entry".GETFILTER("Submit Date") <> '' THEN
                    StartDate := "VAT Entry".GETRANGEMIN("Submit Date")
                  ELSE
                    StartDate := WORKDATE;

                  //ForMonth := FORMAT(StartDate,0,'<Month Text> <Year4>');
                  ForMonth := FormatDateThai(1,StartDate);

                  VATEntryFilter := "VAT Entry".GETFILTERS;

                  CLEAR(HeadOffice);
                  CLEAR(Branch);
                  CASE TRUE OF
                    HB[1]: HeadOffice := 'P';
                    HB[2]: Branch := 'P';
                  END;

                  CompanyInfo.GET;
                  IF CompanyInfo."Company Name (Thai)" = '' THEN BEGIN
                    CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                    CompanyInfo."Company Address (Thai)" := CompanyInfo.Address + ' ' + CompanyInfo."Address 2" + ' ' + CompanyInfo."Address 3";
                  END;
                  IF CompanyInfo."VAT Registration No." <> '' THEN
                    FOR I := 1 TO 13 DO
                      TaxID[I] := COPYSTR(CompanyInfo."VAT Registration No.",I,1);

                  IF SendToExcel THEN BEGIN
                    Window.OPEN(
                      Text000 +
                      '@1@@@@@@@@@@@@@@@@@@@@@\');
                    Window.UPDATE(1,0);
                    TempExcelBuffer.DELETEALL;
                    CLEAR(TempExcelBuffer);

                    //Header
                    EnterCell(1,4,'รายงานภาษีซื้อ',TRUE,FALSE,FALSE,FALSE);
                    EnterCell(2,4,'สำหรับเดือน ' + ForMonth,TRUE,FALSE,FALSE,FALSE);
                    EnterCell(3,1,'ชื่อผู้ประกอบการ : ' + CompanyInfo."Company Name (Thai)",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(4,1,'ชื่อสถานประกอบการ : ',TRUE,FALSE,FALSE,FALSE);
                    EnterCell(5,2,CompanyInfo."Company Name (Thai)",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(6,2,CompanyInfo."Company Address (Thai)",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(7,2,'โทรศัพท์: '+ CompanyInfo."Phone No." + 'โทรสาร: ' + CompanyInfo."Fax No.",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(8,1,'เลขประจำตัวผู้เสียภาษี : ' + CompanyInfo."VAT Registration No.",TRUE,FALSE,FALSE,FALSE);
                    EnterCell(6,6,HeadOffice,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(6,7,'สำนักงานใหญ่ 0000',FALSE,FALSE,FALSE,FALSE);
                    EnterCell(7,6,Branch,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(7,7,'สาขา '+BranchNo,FALSE,FALSE,FALSE,FALSE);
                    IF VATEntryFilter <> '' THEN
                      EnterCell(10,1,VATEntryFilter,FALSE,FALSE,TRUE,FALSE)
                    ELSE
                      EnterCell(10,1,'',FALSE,FALSE,TRUE,FALSE);
                    //FOR I:= 2 TO 8 DO
                    FOR I:= 2 TO 9 DO
                      EnterCell(10,I,'',FALSE,FALSE,TRUE,FALSE);
                    EnterCell(11,1,Text003,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,2,Text004,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,3,Text005,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,4,Text011,TRUE,FALSE,TRUE,TRUE);//GKU:#004
                    EnterCell(11,5,Text006,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,6,Text007,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,7,Text008,TRUE,FALSE,TRUE,TRUE);
                    //EnterCell(11,8,Text009,TRUE,FALSE,TRUE,TRUE);
                    //EnterCell(11,9,'',FALSE,FALSE,FALSE,TRUE);
                    //KKE : #006 +
                    EnterCell(11,8,Text012,TRUE,FALSE,TRUE,TRUE);
                    EnterCell(11,9,Text008,TRUE,FALSE,TRUE,TRUE);
                    //KKE : #006 -
                    EnterCell(11,10,'',FALSE,FALSE,FALSE,TRUE);
                    RowNo := 11;
                  END;
                  I := 0;
                END;

    OnPostReport=BEGIN
                   IF SendToExcel THEN BEGIN
                     Window.CLOSE;
                     IF Option = Option::"Update Workbook" THEN BEGIN
                       TempExcelBuffer.OpenBook(FileName,SheetName);
                       TempExcelBuffer.CreateSheet(SheetName,'',COMPANYNAME,USERID);
                     END ELSE BEGIN
                       TempExcelBuffer.CreateBook;
                       TempExcelBuffer.CreateSheet('Purchase VAT','Purchase VAT',COMPANYNAME,USERID);
                     END;
                     TempExcelBuffer.GiveUserControl;
                   END;
                 END;

    Orientation=Landscape;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table254;
        DataItemTableView=SORTING(Tax Invoice Date,Tax Invoice No.,Submit Date)
                          WHERE(Type=CONST(Purchase));
        OnAfterGetRecord=BEGIN
                           IF VATProdPostingGrp.GET("VAT Prod. Posting Group") THEN
                             IF VATProdPostingGrp."No VAT" THEN
                               CurrReport.SKIP;

                           IF NOT "Use Average VAT" THEN BEGIN  //TSA001
                             IF (Base = 0) AND (Amount <> 0) THEN BEGIN
                               VatBaseAmt := VatBaseAmt - Amount;
                               VatAmt := VatAmt + Amount;
                               TotVatBaseAmt := TotVatBaseAmt - Amount;
                               TotVatAmt := TotVatAmt + Amount;
                               //TSA001 +
                               VatBaseAmt2 := VatBaseAmt2 - Amount;
                               VatAmt2 := VatAmt2 + Amount;
                               TotVatBaseAmt2 := TotVatBaseAmt2 - Amount;
                               TotVatAmt2 := TotVatAmt2 + Amount;
                               //TSA001 -
                               //CurrReport.SKIP;  //KKE : #002
                             END ELSE BEGIN
                               IF "Unrealized VAT Entry No." <> 0 THEN BEGIN
                                 TaxInvoiceNo := "Tax Invoice No.";
                                 TaxInvoiceDate := "Tax Invoice Date";
                               END ELSE BEGIN
                                 TaxInvoiceNo := "External Document No.";
                                 TaxInvoiceDate := "Tax Invoice Date";
                               END;
                               {
                               IF TaxInvoiceNo = '' THEN
                                 CurrReport.SKIP;
                               }  //KKE : #002
                               IF Amount <> 0 THEN BEGIN
                                 VatBaseAmt := VatBaseAmt + Base;
                                 VatAmt := VatAmt + Amount;
                                 TotVatBaseAmt := TotVatBaseAmt + Base;
                                 TotVatAmt := TotVatAmt + Amount;

                                 //TSA001 +
                                 VatBaseAmt2 := VatBaseAmt2 + Base;
                                 VatAmt2 := VatAmt2 + Amount;
                                 TotVatBaseAmt2 := TotVatBaseAmt2 + Base;
                                 TotVatAmt2 := TotVatAmt2 + Amount;
                                 //TSA001 -
                               END;
                             END;
                           END ELSE BEGIN
                             //TSA001 +
                             IF (Base = 0) AND (Amount <> 0) THEN BEGIN
                               VatBaseAmt := VatBaseAmt - Amount;
                               VatAmt := VatAmt + Amount;
                               TotVatBaseAmt := TotVatBaseAmt - Amount;
                               TotVatAmt := TotVatAmt + Amount;

                               VatBaseAmt2 := VatBaseAmt2 - Amount;
                               VatAmt2 := VatAmt2 + Amount;
                               TotVatBaseAmt2 := TotVatBaseAmt2 - Amount;
                               TotVatAmt2 := TotVatAmt2 + Amount;
                               //CurrReport.SKIP;  //KKE : #002
                             END ELSE BEGIN
                               IF "Unrealized VAT Entry No." <> 0 THEN BEGIN
                                 TaxInvoiceNo := "Tax Invoice No.";
                                 TaxInvoiceDate := "Tax Invoice Date";
                               END ELSE BEGIN
                                 TaxInvoiceNo := "External Document No.";
                                 TaxInvoiceDate := "Tax Invoice Date";
                               END;
                               {
                               IF TaxInvoiceNo = '' THEN
                                 CurrReport.SKIP;
                               }  //KKE : #002

                               IF Amount <> 0 THEN BEGIN
                                 VATPostingSetup.GET("VAT Bus. Posting Group","VAT Prod. Posting Group");
                                 NewBase := (Base + Amount)* 100 / (100 + VATPostingSetup."VAT %") - "VAT Difference";
                                 NewAmount := (Base + Amount) - NewBase;

                                 VatBaseAmt := VatBaseAmt + NewBase;
                                 VatAmt := VatAmt + NewAmount;
                                 TotVatBaseAmt := TotVatBaseAmt + NewBase;
                                 TotVatAmt := TotVatAmt + NewAmount;

                                 IF VATPostingSetup."VAT %" = 0 THEN BEGIN
                                   VatBaseAmt2 := VatBaseAmt2 + NewBase * "VAT Claim Percentage"/100;
                                   TotVatBaseAmt2 := TotVatBaseAmt2 + NewBase * "VAT Claim Percentage"/100;
                                 END ELSE BEGIN
                                   VatBaseAmt2 := VatBaseAmt2 + Amount * 100 / VATPostingSetup."VAT %";
                                   TotVatBaseAmt2 := TotVatBaseAmt2 + Amount * 100 / VATPostingSetup."VAT %";
                                 END;
                                 VatAmt2 := VatAmt2 + Amount;
                                 TotVatAmt2 := TotVatAmt2 + Amount;
                               END;
                             END;
                             //TSA001 -
                           END;

                           CLEAR(AccountName);
                           IF "Real Customer/Vendor Name" <> '' THEN
                             AccountName := "Real Customer/Vendor Name"
                           ELSE
                             IF VATEntry2.GET("Unrealized VAT Entry No.") THEN
                               AccountName := VATEntry2."Real Customer/Vendor Name";

                           IF AccountName = '' THEN BEGIN
                             VendLedgEntry.RESET;
                             VendLedgEntry.SETCURRENTKEY("Document No.","Document Type","Vendor No.");
                             VendLedgEntry.SETRANGE("Document Type","Document Type");
                             VendLedgEntry.SETRANGE("Document No.","Document No.");
                             VendLedgEntry.SETRANGE("Posting Date","Posting Date");
                             IF VendLedgEntry.FIND('-') THEN BEGIN
                               IF Vendor.GET(VendLedgEntry."Vendor No.") THEN
                                 IF Vendor."Name (Thai)" <> '' THEN
                                   AccountName := Vendor."Name (Thai)"
                                 ELSE
                                   AccountName := Vendor.Name + Vendor."Name 2";
                             END;
                             IF AccountName = '' THEN
                               IF Vendor.GET("Bill-to/Pay-to No.") THEN
                                 IF Vendor."Name (Thai)" <> '' THEN
                                   AccountName := Vendor."Name (Thai)"
                                 ELSE
                                   AccountName := Vendor.Name + Vendor."Name 2";
                           END;
                         END;

        ReqFilterFields=Submit Date,Posting Date,Document No.,Tax Invoice No.,Tax Invoice Date,VAT Bus. Posting Group,VAT Prod. Posting Group;
        TotalFields=Base,Amount;
        GroupTotalFields=Tax Invoice No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25800;
            SectionHeight=5200;
          }
          CONTROLS
          {
            { 1000000004;TextBox;4400 ;800  ;9800 ;700  ;HorzAlign=Center;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DateFormula=No;
                                                         SourceExpr='สำหรับเดือน ' + ForMonth }
            { 1000000010;Label  ;4400 ;0    ;9800 ;900  ;HorzAlign=Center;
                                                         FontName=AngsanaUPC;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รายงานภาษีซื้อ }
            { 1000000001;TextBox;21250;200  ;600  ;500  ;FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=หน้า;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;20500;200  ;750  ;500  ;ParentControl=1000000001;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13 }
            { 1000000006;Label  ;18200;3600 ;1000 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=สาขา }
            { 1000000007;TextBox;19200;3600 ;2900 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         SourceExpr=BranchNo }
            { 1000000008;TextBox;17700;3700 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=Branch }
            { 1000000009;Shape  ;17600;3700 ;450  ;423   }
            { 1000000012;Label  ;18200;2900 ;2200 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=สำนักงานใหญ่ }
            { 1000000013;TextBox;17700;3000 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=HeadOffice }
            { 1000000019;Shape  ;17600;3000 ;450  ;423   }
            { 1000000015;TextBox;18600;800  ;3250 ;500  ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=11;
                                                         CaptionML=ENU=หน้า;
                                                         SourceExpr=FORMAT(TODAY,0,1) + ' / ' + FORMAT(TIME,0) }
            { 1000000021;Label  ;0    ;1600 ;2800 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=ชื่อผู้ประกอบการ }
            { 1000000022;Label  ;0    ;2200 ;3100 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=ชื่อสถานประกอบการ }
            { 1000000024;TextBox;2900 ;1600 ;11000;600  ;FontName=AngsanaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         DateFormula=No;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000026;TextBox;20400;2900 ;1700 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         SourceExpr='0000' }
            { 1000000016;Shape  ;17600;2246 ;5700 ;423   }
            { 1000000018;TextBox;21600;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[10] }
            { 1000000030;Shape  ;21600;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000035;TextBox;21200;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[9] }
            { 1000000036;TextBox;20750;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[8] }
            { 1000000038;Shape  ;21200;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000039;Shape  ;20750;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000040;TextBox;20300;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[7] }
            { 1000000041;TextBox;19850;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[6] }
            { 1000000042;Shape  ;20300;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000043;TextBox;19400;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[5] }
            { 1000000044;Shape  ;19850;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000046;TextBox;18950;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[4] }
            { 1000000047;Shape  ;19400;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000049;Shape  ;18950;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000050;Shape  ;18950;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000052;TextBox;18500;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[3] }
            { 1000000053;Shape  ;18500;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000054;TextBox;18050;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[2] }
            { 1000000055;Shape  ;18050;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000056;TextBox;17600;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[1] }
            { 1000000002;Label  ;17600;1600 ;4500 ;600  ;FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000029;TextBox;400  ;2800 ;13800;2400 ;VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         DateFormula=No;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" +'\' + CompanyInfo."Company Address (Thai)" +'\' + 'โทรศัพท์: '+ CompanyInfo."Phone No." + '  โทรสาร: ' + CompanyInfo."Fax No." }
            { 1000000073;Shape  ;22400;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;22000;2246 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000075;TextBox;22000;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[11] }
            { 1000000076;TextBox;22400;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[12] }
            { 1000000077;TextBox;22800;2246 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[13] }
            { 1000000078;Shape  ;22800;2246 ;30   ;423  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25800;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(VATEntryFilter <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000045;TextBox;0    ;0    ;19200;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DateFormula=No;
                                                         SourceExpr=VATEntryFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=25800;
            SectionHeight=1300;
          }
          CONTROLS
          {
            { 1000000023;Label  ;18800;100  ;2100 ;1100 ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ภาษีมูลค่าเพิ่ม }
            { 1000000017;Shape  ;0    ;0    ;25800;100  ;ShapeStyle=HorzLine }
            { 1000000011;Label  ;3000 ;100  ;2700 ;1100 ;HorzAlign=General;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เลขที่ใบกำกับภาษี }
            { 1000000033;Label  ;9600 ;100  ;3950 ;1100 ;HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000000;Label  ;1300 ;100  ;1500 ;1100 ;HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000037;Label  ;0    ;100  ;1200 ;1100 ;HorzAlign=Center;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลำดับที่ }
            { 1000000003;Label  ;16100;0    ;2600 ;700  ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=มูลค่าสินค้า }
            { 1000000031;Shape  ;0    ;1200 ;25800;100  ;ShapeStyle=HorzLine }
            { 1000000025;Label  ;16100;600  ;2600 ;700  ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=และบริการ }
            { 1000000063;Label  ;23700;100  ;2100 ;1100 ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ภาษีมูลค่าเพิ่ม }
            { 1000000065;Label  ;21000;0    ;2600 ;700  ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=มูลค่าสินค้า/บริการ }
            { 1000000066;Label  ;21000;600  ;2600 ;700  ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ที่เฉลี่ยได้ }
            { 1000000072;Label  ;6300 ;100  ;2700 ;1100 ;HorzAlign=General;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เลขที่ใบสำคัญ }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=25800;
            SectionHeight=600;
            OnPreSection=BEGIN
                           Shortname := FALSE;
                           IF STRLEN(AccountName) <= 50 THEN
                             Shortname := TRUE;

                           //KKE : #005 +
                           DocNo := '';
                           CheckLedgEntry.RESET;
                           CheckLedgEntry.SETCURRENTKEY("Document No.","Posting Date");
                           CheckLedgEntry.SETRANGE("Document No.","Document No.");
                           CheckLedgEntry.SETRANGE("Posting Date","Posting Date");
                           IF CheckLedgEntry.FIND('-') THEN
                             DocNo := "External Document No.";
                           IF DocNo = '' THEN BEGIN
                             IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                               VendLedgEntry.RESET;
                               VendLedgEntry.SETCURRENTKEY("Document No.","Document Type","Vendor No.");
                               VendLedgEntry.SETRANGE("Document No.","Document No.");
                               VendLedgEntry.SETRANGE("Document Type","Document Type");
                               VendLedgEntry.SETRANGE("Posting Date","Posting Date");
                               IF VendLedgEntry.FIND('-') THEN BEGIN
                                 DetailVendLedg.SETRANGE("Vendor Ledger Entry No.",VendLedgEntry."Entry No.");
                                 DetailVendLedg.SETRANGE("Document Type",DetailVendLedg."Document Type"::Payment);
                                 IF DetailVendLedg.FIND('-') THEN BEGIN
                                   VendLedgEntry2.GET(DetailVendLedg."Applied Vend. Ledger Entry No.");
                                   IF VendLedgEntry2."External Document No." <> '' THEN
                                     DocNo := VendLedgEntry2."External Document No."
                                   ELSE
                                     DocNo := VendLedgEntry2."Document No.";
                                 END;
                               END;
                             END;
                             IF DocNo = '' THEN
                               DocNo := "Document No.";
                           END;

                           IF VatAmt = 0 THEN BEGIN
                             IF Base = 0 THEN BEGIN
                               CurrReport.SHOWOUTPUT(FALSE);
                             END ELSE BEGIN
                               TotVatBaseAmt := TotVatBaseAmt - VatBaseAmt;
                               VatBaseAmt := 0;
                               TotVatBaseAmt2 := TotVatBaseAmt2 - VatBaseAmt2;
                               VatBaseAmt2 := 0;
                             END;
                           END;
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             I := I + 1;
                             CurrReport.SHOWOUTPUT(Shortname);
                             IF SendToExcel THEN BEGIN
                               RowNo += 1;
                               EnterCell(RowNo,1,FORMAT(I),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,2,FORMAT(TaxInvoiceDate),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,3,TaxInvoiceNo,FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,4,DocNo,FALSE,FALSE,TRUE,TRUE); //KKE : #005
                               EnterCell(RowNo,5,AccountName,FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,6,FORMAT(VatBaseAmt),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,7,FORMAT(VatAmt),FALSE,FALSE,TRUE,TRUE);
                               {---
                               EnterCell(RowNo,8,FORMAT(VatBaseAmt + VatAmt),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,9,'',FALSE,FALSE,FALSE,TRUE);
                               ---}
                               //KKE : #006 +
                               EnterCell(RowNo,8,FORMAT(VatBaseAmt2),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,9,FORMAT(VatAmt2),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,10,'',FALSE,FALSE,FALSE,TRUE);
                               //KKE : #006 -
                             END;
                           END;
                           //KKE : #005 -

                           {---
                           IF VatAmt <> 0 THEN BEGIN
                             //I := I + 1;//GKU:#004
                             IF SendToExcel THEN BEGIN
                               RowNo += 1;
                               EnterCell(RowNo,1,FORMAT(I),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,2,FORMAT(TaxInvoiceDate),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,3,TaxInvoiceNo,FALSE,FALSE,TRUE,TRUE);
                               //EnterCell(RowNo,4,"Document No.",FALSE,FALSE,TRUE,TRUE); //GKU : #004
                               EnterCell(RowNo,4,DocNo,FALSE,FALSE,TRUE,TRUE); //KKE : #005
                               EnterCell(RowNo,5,AccountName,FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,6,FORMAT(VatBaseAmt),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,7,FORMAT(VatAmt),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,8,FORMAT(VatBaseAmt + VatAmt),FALSE,FALSE,TRUE,TRUE);
                               EnterCell(RowNo,9,'',FALSE,FALSE,FALSE,TRUE);
                             END;
                             CurrReport.SHOWOUTPUT(Shortname);
                           END ELSE BEGIN
                             //I := I + 1;  //burda //GKU:#004
                             TotVatBaseAmt := TotVatBaseAmt - VatBaseAmt;
                             VatBaseAmt := 0;
                             //TSA001
                             TotVatBaseAmt2 := TotVatBaseAmt2 - VatBaseAmt2;
                             VatBaseAmt2 := 0;
                             //TSA001
                             //CurrReport.SHOWOUTPUT(FALSE);  //burda
                           END;

                           IF (Base = 0) AND (VatAmt = 0) THEN CurrReport.SHOWOUTPUT(FALSE);//GKU:#004
                           IF CurrReport.SHOWOUTPUT THEN I += 1 ;//GKU:#004
                           ---}   //KKE : #005
                         END;

          }
          CONTROLS
          {
            { 1   ;TextBox      ;1300 ;0    ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TaxInvoiceDate }
            { 2   ;TextBox      ;16100;0    ;2600 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VatBaseAmt }
            { 3   ;TextBox      ;3000 ;0    ;3100 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TaxInvoiceNo }
            { 4   ;TextBox      ;9600 ;0    ;6400 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=AccountName }
            { 5   ;TextBox      ;18800;0    ;2100 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VatAmt }
            { 7   ;TextBox      ;0    ;0    ;1200 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=I }
            { 1000000014;TextBox;23700;0    ;2100 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VatAmt2 }
            { 1000000020;TextBox;21000;0    ;2600 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VatBaseAmt2 }
            { 1000000070;TextBox;6300 ;0    ;3100 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DocNo }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=25800;
            SectionHeight=900;
            OnPreSection=BEGIN
                           //KKE : #005 +
                           IF (Base = 0) AND (VatAmt = 0) THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE
                             CurrReport.SHOWOUTPUT(NOT Shortname);
                           //KKE : #005 -

                           {---
                           IF VatAmt <> 0 THEN
                             CurrReport.SHOWOUTPUT(NOT Shortname)
                           ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                           IF (Base = 0) AND (VatAmt = 0) THEN CurrReport.SHOWOUTPUT(FALSE);//GKU:#004
                           IF CurrReport.SHOWOUTPUT THEN I += 1 ;//GKU:#004
                           ---}  //KKE : #005
                         END;

          }
          CONTROLS
          {
            { 1000000057;TextBox;1300 ;0    ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TaxInvoiceDate }
            { 1000000058;TextBox;16100;0    ;2600 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VatBaseAmt }
            { 1000000060;TextBox;3000 ;0    ;3100 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TaxInvoiceNo }
            { 1000000061;TextBox;9600 ;100  ;6400 ;800  ;VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         MultiLine=Yes;
                                                         SourceExpr=AccountName }
            { 1000000062;TextBox;18800;0    ;2100 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VatAmt }
            { 1000000064;TextBox;0    ;0    ;1200 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=I }
            { 1000000027;TextBox;23700;0    ;2100 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VatAmt2 }
            { 1000000028;TextBox;21000;0    ;2600 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VatBaseAmt2 }
            { 1000000071;TextBox;6300 ;0    ;3100 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DocNo }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=25800;
            SectionHeight=0;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           CLEAR(VatBaseAmt);
                           CLEAR(VatAmt);
                           //TSA001
                           CLEAR(VatBaseAmt2);
                           CLEAR(VatAmt2);
                           //TSA001
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=25800;
            SectionHeight=1200;
            OnPreSection=BEGIN
                           IF SendToExcel THEN BEGIN
                             RowNo += 1;
                             EnterCell(RowNo,1,Text010,TRUE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,2,'',TRUE,FALSE,TRUE,FALSE);
                             EnterCell(RowNo,3,'',TRUE,FALSE,TRUE,FALSE);
                             EnterCell(RowNo,4,'',TRUE,FALSE,TRUE,FALSE);
                             EnterCell(RowNo,5,'',TRUE,FALSE,TRUE,FALSE);
                             EnterCell(RowNo,6,FORMAT(TotVatBaseAmt),TRUE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,7,FORMAT(TotVatAmt),TRUE,FALSE,TRUE,TRUE);
                             {---
                             EnterCell(RowNo,8,FORMAT(TotVatBaseAmt + TotVatAmt),TRUE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,9,'',FALSE,FALSE,FALSE,TRUE);
                             ---}
                             //KKE : #006 +
                             EnterCell(RowNo,8,FORMAT(TotVatBaseAmt2),TRUE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,9,FORMAT(TotVatAmt2),TRUE,FALSE,TRUE,TRUE);
                             EnterCell(RowNo,10,'',FALSE,FALSE,FALSE,TRUE);
                             //KKE : #006 -
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000034;Label  ;420  ;100  ;2100 ;800  ;HorzAlign=Center;
                                                         FontName=AngsanaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมทั้งสิ้น }
            { 1000000048;Shape  ;0    ;800  ;25800;100  ;ShapeStyle=HorzLine }
            { 1000000051;Shape  ;0    ;880  ;25800;100  ;ShapeStyle=HorzLine }
            { 1000000032;Shape  ;0    ;0    ;25800;100  ;ShapeStyle=HorzLine }
            { 1000000059;TextBox;16000;200  ;2700 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotVatBaseAmt }
            { 1000000067;TextBox;18800;200  ;2100 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotVatAmt }
            { 1000000068;TextBox;23700;200  ;2100 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotVatAmt2 }
            { 1000000069;TextBox;21000;200  ;2600 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotVatBaseAmt2 }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9570;
      Height=3520;
      OnInit=BEGIN
               HB[1] := TRUE;
               HB[2] := FALSE;
             END;

      OnOpenForm=BEGIN
                   RequestOptionsForm.BLookup.ENABLED := FALSE;
                   UpdateRequestForm;
                 END;

    }
    CONTROLS
    {
      { 1000000000;CheckBox;3520;770  ;440  ;440  ;InPage=-1;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Branch;
                                                              THA=สาขา];
                                                   SourceExpr=HB[2];
                                                   OnPush=BEGIN
                                                            IF HB[2] THEN BEGIN
                                                              HB[1] := FALSE;
                                                              RequestOptionsForm.BLookup.ENABLED := TRUE;
                                                            END ELSE BEGIN
                                                              HB[1] := TRUE;
                                                              RequestOptionsForm.BLookup.ENABLED := FALSE;
                                                            END;
                                                          END;
                                                           }
      { 1000000001;Label  ;110  ;770  ;3300 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;4070 ;770  ;2420 ;440  ;Name=BLookup;
                                                   InPage=-1;
                                                   CaptionML=[ENU=No.;
                                                              THA=เลขที่];
                                                   SourceExpr=BranchNo }
      { 1000000003;CheckBox;3520;220  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Head Office;
                                                              THA=ไม่แยกสาขา];
                                                   SourceExpr=HB[1];
                                                   OnValidate=BEGIN
                                                                IF HB[1] THEN BEGIN
                                                                  HB[2] := FALSE;
                                                                  RequestOptionsForm.BLookup.ENABLED := FALSE;
                                                                END ELSE BEGIN
                                                                  HB[2] := TRUE;
                                                                  RequestOptionsForm.BLookup.ENABLED := TRUE;
                                                                END;
                                                              END;
                                                               }
      { 1000000004;Label  ;110  ;220  ;3300 ;440  ;ParentControl=1000000003;
                                                   InPage=-1 }
      { 1000000011;CheckBox;3520;1430 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Send To Excel;
                                                   SourceExpr=SendToExcel }
      { 1000000012;Label  ;110  ;1430 ;3300 ;440  ;ParentControl=1000000011;
                                                   InPage=-1 }
      { 1000000005;TextBox;3520 ;2530 ;5500 ;440  ;Name=FileNamex;
                                                   CaptionML=[ENU=Workbook File Name;
                                                              THA=ชื่อแฟ้มสมุดงาน];
                                                   SourceExpr=FileName;
                                                   OnAssistEdit=BEGIN
                                                                  UploadFile;
                                                                  IF ISSERVICETIER AND (UploadedFileName <> '') THEN
                                                                    FileName := Text103;
                                                                END;

                                                   OnAfterValidate=BEGIN
                                                                     UploadFile;
                                                                     IF ISSERVICETIER AND (UploadedFileName <> '') THEN
                                                                       FileName := Text103;
                                                                   END;
                                                                    }
      { 1000000006;TextBox;3520 ;1980 ;2750 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=Option;
                                                              THA=ตัวเลือก];
                                                   OptionCaptionML=[ENU=Create Workbook,Update Workbook;
                                                                    THA=สร้างสมุดงาน,ปรับปรุงสมุดงาน];
                                                   SourceExpr=Option;
                                                   OnValidate=BEGIN
                                                                UpdateRequestForm;
                                                              END;
                                                               }
      { 1000000007;TextBox;3520 ;3080 ;5500 ;440  ;Name=SheetNamex;
                                                   CaptionML=[ENU=Worksheet Name;
                                                              THA=ชื่อแผ่นงาน];
                                                   SourceExpr=SheetName;
                                                   OnAssistEdit=VAR
                                                                  ExcelBuf@1001 : Record 370;
                                                                BEGIN
                                                                  IF ISSERVICETIER THEN
                                                                    SheetName := ExcelBuf.SelectSheetsName(UploadedFileName)
                                                                  ELSE
                                                                    SheetName := ExcelBuf.SelectSheetsName(FileName);
                                                                END;
                                                                 }
      { 1000000008;Label  ;110  ;2530 ;3300 ;440  ;ParentControl=1000000005;
                                                   InPage=-1 }
      { 1000000009;Label  ;110  ;3080 ;3300 ;440  ;ParentControl=1000000007 }
      { 1000000010;Label  ;110  ;1980 ;3300 ;440  ;ParentControl=1000000006;
                                                   InPage=-1 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000031 : Record 79;
      Location@1000000020 : Record 14;
      VATEntry@1117700000 : Record 254;
      VATEntry2@1000000048 : Record 254;
      VATProdPostingGrp@1000000015 : Record 324;
      Vendor@1000000024 : Record 23;
      VendLedgEntry@1000000001 : Record 25;
      ShipToAddress@1000000018 : Record 222;
      StartDate@1000000019 : Date;
      AccountName@1000000014 : Text[150];
      I@1000000013 : Integer;
      HB@1000000012 : ARRAY [2] OF Boolean;
      HeadOffice@1000000011 : Text[1];
      Branch@1000000010 : Text[1];
      BranchNo@1000000009 : Text[30];
      VATEntryFilter@1000000008 : Text[250];
      ForMonth@1000000007 : Text[250];
      VatAmt@1000000006 : Decimal;
      VatBaseAmt@1000000005 : Decimal;
      TotVatAmt@1000000004 : Decimal;
      TotVatBaseAmt@1000000003 : Decimal;
      Text000@1000000027 : TextConst 'ENU=Analyzing Data...\\;THA=กำลังวิเคราะห์ข้อมูล...\\';
      Text001@1000000002 : TextConst 'ENU=สินค้าและบริการ';
      TaxInvoiceNo@1000000016 : Code[20];
      TaxInvoiceDate@1000000017 : Date;
      TempExcelBuffer@1000000029 : TEMPORARY Record 370;
      Window@1000000028 : Dialog;
      RowNo@1000000026 : Integer;
      SendToExcel@1000000025 : Boolean;
      FileName@1000000023 : Text[250];
      SheetName@1000000022 : Text[250];
      UploadedFileName@1000000057 : Text[1024];
      FileNameEnable@1000000056 : Boolean INDATASET;
      SheetNameEnable@1000000053 : Boolean INDATASET;
      Option@1000000021 : 'Create Workbook,Update Workbook';
      Text002@1000000039 : TextConst 'ENU=Update Workbook;THA=ปรับปรุงสมุดงาน';
      Text003@1000000038 : TextConst 'ENU=ลำดับที่';
      Text004@1000000037 : TextConst 'ENU=วันที่';
      Text005@1000000036 : TextConst 'ENU=เลขที่ใบกำกับภาษี';
      Text006@1000000035 : TextConst 'ENU=รายการ';
      Text007@1000000034 : TextConst 'ENU=มูลค่าสินค้าและบริการ';
      Text008@1000000033 : TextConst 'ENU=ภาษีมูลค่าเพิ่ม';
      Text009@1000000032 : TextConst 'ENU=รวม';
      Text010@1000000030 : TextConst 'ENU=รวมทั้งสิ้น';
      TaxID@1000000000 : ARRAY [13] OF Text[1];
      Shortname@1000000040 : Boolean;
      VatAmt2@1000000044 : Decimal;
      VatBaseAmt2@1000000043 : Decimal;
      TotVatAmt2@1000000042 : Decimal;
      TotVatBaseAmt2@1000000041 : Decimal;
      VATPostingSetup@1000000045 : Record 325;
      NewBase@1000000046 : Decimal;
      NewAmount@1000000047 : Decimal;
      DocNo@1000000049 : Code[20];
      Text011@1000000050 : TextConst 'ENU=เลขที่ใบสำคัญ';
      CheckLedgEntry@1000000051 : Record 272;
      Text012@1000000052 : TextConst 'ENU=มูลค่าสินค้า/บริการที่เฉลี่ยได้';
      VendLedgEntry2@1000000055 : Record 25;
      DetailVendLedg@1000000054 : Record 380;
      Text103@1000000058 : TextConst 'ENU=The file was successfully uploaded to server;THA=อัพโหลดแฟ้มไปยังเซิร์ฟเวอร์เรียบร้อยแล้ว';

    PROCEDURE FormatDateThai@1000000000(FormatOption@1000000000 : 'DMY,MY';xDate@1000000001 : Date) : Text[30];
    VAR
      DD@1000000002 : Integer;
      MM@1000000003 : Integer;
      YY@1000000004 : Integer;
      DateTextThai@1000000005 : Text[30];
      Text001@1000000006 : TextConst 'ENU=%1 %2 %3';
      Text002@1000000008 : TextConst 'ENU=%1 %2';
    BEGIN
      DD := DATE2DMY(xDate,1);
      MM := DATE2DMY(xDate,2);
      YY := DATE2DMY(xDate,3);
      CASE FormatOption OF
        FormatOption::DMY:
          DateTextThai := STRSUBSTNO(Text001,DD,GetMonthThai(MM),YY+543);
        FormatOption::MY:
          DateTextThai := STRSUBSTNO(Text002,GetMonthThai(MM),YY+543);
      END;
      EXIT(DateTextThai);
    END;

    PROCEDURE GetMonthThai@1000000001(MM@1000000000 : Integer) : Text[30];
    BEGIN
      CASE MM OF
        1: EXIT('มกราคม');
        2: EXIT('กุมภาพันธ์');
        3: EXIT('มีนาคม');
        4: EXIT('เมษายน');
        5: EXIT('พฤษภาคม');
        6: EXIT('มิถุนายน');
        7: EXIT('กรกฎาคม');
        8: EXIT('สิงหาคม');
        9: EXIT('กันยายน');
        10: EXIT('ตุลาคม');
        11: EXIT('พฤศจิกายน');
        12: EXIT('ธันวาคม');
      END;
    END;

    LOCAL PROCEDURE EnterCell@2(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Bold@1003 : Boolean;Italic@1004 : Boolean;UnderLine@1005 : Boolean;EdgeLeft@1000000000 : Boolean);
    BEGIN
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := Bold;
      TempExcelBuffer.Italic := Italic;
      TempExcelBuffer.Underline := UnderLine;
      IF UnderLine THEN
        TempExcelBuffer."Line Style" := 1;
      TempExcelBuffer.EdgeLeft := EdgeLeft;
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE UploadFile@6();
    VAR
      CommonDialogMgt@1000 : Codeunit 412;
    BEGIN
      UploadedFileName := CommonDialogMgt.OpenFile(Text002,FileName,2,'',0);
      FileName := UploadedFileName;
    END;

    PROCEDURE UpdateRequestForm@1000000002();
    BEGIN
      IF ISSERVICETIER THEN BEGIN
        PageUpdateRequestForm;
        EXIT;
      END;
      IF Option = Option::"Update Workbook" THEN BEGIN
        IF NOT ISSERVICETIER THEN BEGIN
          RequestOptionsForm.FileNamex.ENABLED(TRUE);
          RequestOptionsForm.SheetNamex.ENABLED(TRUE);
        END;
      END ELSE BEGIN
        FileName := '';
        UploadedFileName := '';
        SheetName := '';
        IF NOT ISSERVICETIER THEN BEGIN
          RequestOptionsForm.FileNamex.ENABLED(FALSE);
          RequestOptionsForm.SheetNamex.ENABLED(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE PageUpdateRequestForm@19031953();
    BEGIN
      IF Option = Option::"Update Workbook" THEN BEGIN
        IF NOT ISSERVICETIER THEN BEGIN
          FileNameEnable := TRUE;
          SheetNameEnable := TRUE;
        END;
      END ELSE BEGIN
        FileName := '';
        UploadedFileName := '';
        SheetName := '';
        IF NOT ISSERVICETIER THEN BEGIN
          FileNameEnable := FALSE;
          SheetNameEnable := FALSE;
        END;
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut
      GKU : Goragot Kuanmuang

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   -Purchase VAT Report.
      003   25.12.2005   KKE   -Change sorting by Tax Invoice Date,Tax Invoice No.
      Burda
      002   16.07.2007   KKE   -do not skip zero vat.
      003   16.07.2007   TSA   -average VAT
      004   06.10.2007   GKU   -Do not show vat case "VAT Entry".Base = 0 and  vatamt = 0
      004   31.10.2007   GKU   -Modify add document number to excel file
      005   06.12.2007   KKE   -if "Document No." = "Check No.", system must show "Document No." from "External Doc No."
      006   07.01.2008   KKE   -Correct column on excel file
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50006 Receipt Voucher
{
  OBJECT-PROPERTIES
  {
    Date=01/17/20;
    Time=11:36:56 AM;
    Modified=Yes;
    Version List=AVATHA4.00,Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   CompanyInfo.GET;
                   CompanyInfo.CALCFIELDS(Picture);
                 END;

    OnPreReport=BEGIN
                  DebitTotalLCY := 0;
                  CreditTotalLCY := 0;
                END;

    PaperSize=A4 210 x 297 mm;
    HorzGrid=50;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table81;
        DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Posting Date,Document No.);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        CASE TRUE OF
                          Cash: xCash := 'P';
                          Cheque: xCheque := 'P';
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           IF "Document No." = GenJnlLine."Document No." THEN
                             CurrReport.SKIP
                           ELSE
                             GenJnlLine := "Gen. Journal Line";

                           VATAmt := 0;
                           CreditVATAmt := 0;

                           CLEAR(CustName);
                           CLEAR(Bank);
                           CLEAR(DebitAccNo);
                           CLEAR(DebitAccName);
                           CLEAR(DebitDimValue);
                           CLEAR(DebitAmount);
                           CLEAR(CreditAccNo);
                           CLEAR(CreditAccName);
                           CLEAR(CreditDimValue);
                           CLEAR(CreditAmount);
                           CLEAR(VATAccountNo);
                           CLEAR(VATAccountName);
                           CLEAR(BankAccNo);
                           CLEAR(CustLedgerEntrybuffer);
                           I := 0;
                           GenJnlLine2.RESET;
                           GenJnlLine2.SETRANGE("Journal Template Name","Journal Template Name");
                           GenJnlLine2.SETRANGE("Journal Batch Name","Journal Batch Name");
                           GenJnlLine2.SETRANGE("Document No.","Document No.");
                           IF GenJnlLine2.FIND('-') THEN BEGIN
                             REPEAT
                               WITH GenJnlLine2 DO BEGIN
                                 IF "Debit Amount" <> 0 THEN BEGIN
                                   CLEAR(DebitAccount);
                                   CASE "Account Type" OF
                                     "Account Type"::"G/L Account":
                                       BEGIN
                                         DebitAccount := "Account No.";
                                       END;
                                     "Account Type"::Customer:
                                       BEGIN
                                         CustPostingGroup.GET("Posting Group");
                                         DebitAccount := CustPostingGroup."Receivables Account";
                                       END;
                                     "Account Type"::Vendor:
                                       BEGIN
                                         VendPostingGroup.GET("Posting Group");
                                         DebitAccount := VendPostingGroup."Payables Account";
                                       END;
                                     "Account Type"::"Bank Account":
                                       BEGIN
                                         BankAcc.GET("Account No.");
                                         BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                         DebitAccount := BankAccPostingGroup."G/L Bank Account No.";
                                       END;
                                   END;
                                   I := 0;
                                   MatchAcc := FALSE;
                                   IF DebitAccount <> '' THEN BEGIN
                                     REPEAT
                                       I := I + 1;
                                       IF ((DebitAccNo[I] = DebitAccount) AND (DebitDimValue[I] = "Shortcut Dimension 1 Code"))
                                          OR (DebitAccNo[I] = '')
                                       THEN BEGIN
                                         DebitAccNo[I] := DebitAccount;
                                         GLAcc.GET(DebitAccNo[I]);
                                         DebitAccName[I] := GLAcc.Name;
                                         //DebitAmount[I] := DebitAmount[I] + "Debit Amount";
                                         DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)");

                                         DebitDimValue[I] := "Shortcut Dimension 1 Code";
                                         MatchAcc := TRUE;
                                         IF "Account Type" = "Account Type"::"Bank Account" THEN
                                           BankAccNo := DebitAccount;
                                       END;
                                     UNTIL (I>=100) OR MatchAcc;
                                   END;

                                   IF "Bal. Account No." <> '' THEN BEGIN
                                     CLEAR(CreditAccount);
                                     CASE "Bal. Account Type" OF
                                       "Bal. Account Type"::"G/L Account":
                                         BEGIN
                                           CreditAccount := "Bal. Account No.";
                                         END;
                                       "Bal. Account Type"::Customer:
                                         BEGIN
                                           CustPostingGroup.GET("Posting Group");
                                           CreditAccount := CustPostingGroup."Receivables Account";
                                         END;
                                       "Bal. Account Type"::Vendor:
                                         BEGIN
                                           VendPostingGroup.GET("Posting Group");
                                           CreditAccount := VendPostingGroup."Payables Account";
                                         END;
                                       "Bal. Account Type"::"Bank Account":
                                         BEGIN
                                           BankAcc.GET("Bal. Account No.");
                                           BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                           CreditAccount := BankAccPostingGroup."G/L Bank Account No.";
                                         END;
                                     END;
                                     I := 0;
                                     MatchAcc := FALSE;
                                     IF CreditAccount <> '' THEN BEGIN
                                       REPEAT
                                         I := I + 1;
                                         IF ((CreditAccNo[I] = CreditAccount) AND (CreditDimValue[I] = "Shortcut Dimension 1 Code"))
                                            OR (CreditAccNo[I] = '')
                                         THEN BEGIN
                                           CreditAccNo[I] := CreditAccount;
                                           GLAcc.GET(CreditAccNo[I]);
                                           CreditAccName[I] := GLAcc.Name;
                                           //CreditAmount[I] := CreditAmount[I] + "Debit Amount";
                                           CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)");

                                           CreditDimValue[I] := "Shortcut Dimension 1 Code";
                                           MatchAcc := TRUE;
                                           IF "Bal. Account Type" = "Bal. Account Type"::"Bank Account" THEN
                                             BankAccNo := CreditAccount;
                                         END;
                                       UNTIL (I>=100) OR MatchAcc;
                                     END;
                                   END;
                                 END ELSE
                                 IF "Credit Amount" <> 0 THEN BEGIN
                                   CLEAR(CreditAccount);
                                   CASE "Account Type" OF
                                     "Account Type"::"G/L Account":
                                       BEGIN
                                         CreditAccount := "Account No.";
                                       END;
                                     "Account Type"::Customer:
                                       BEGIN
                                         CustPostingGroup.GET("Posting Group");
                                         CreditAccount := CustPostingGroup."Receivables Account";
                                       END;
                                     "Account Type"::Vendor:
                                       BEGIN
                                         VendPostingGroup.GET("Posting Group");
                                         CreditAccount := VendPostingGroup."Payables Account";
                                       END;
                                     "Account Type"::"Bank Account":
                                       BEGIN
                                         BankAcc.GET("Account No.");
                                         BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                         CreditAccount := BankAccPostingGroup."G/L Bank Account No.";
                                       END;
                                   END;
                                   I := 0;
                                   MatchAcc := FALSE;
                                   IF CreditAccount <> '' THEN BEGIN
                                     REPEAT
                                       I := I + 1;
                                       IF ((CreditAccNo[I] = CreditAccount) AND (CreditDimValue[I] = "Shortcut Dimension 1 Code"))
                                          OR (CreditAccNo[I] = '')
                                       THEN BEGIN
                                         CreditAccNo[I] := CreditAccount;
                                         GLAcc.GET(CreditAccNo[I]);
                                         CreditAccName[I] := GLAcc.Name;
                                         //CreditAmount[I] := CreditAmount[I] + "Credit Amount";
                                         CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)");

                                         CreditDimValue[I] := "Shortcut Dimension 1 Code";
                                         IF "Account Type" = "Account Type"::"Bank Account" THEN
                                           BankAccNo := CreditAccount;
                                         MatchAcc := TRUE;
                                       END;
                                     UNTIL (I>=100) OR MatchAcc;
                                   END;

                                   IF "Bal. Account No." <> '' THEN BEGIN
                                     CLEAR(DebitAccount);
                                     CASE "Bal. Account Type" OF
                                       "Bal. Account Type"::"G/L Account":
                                         BEGIN
                                           DebitAccount := "Bal. Account No.";
                                         END;
                                       "Bal. Account Type"::Customer:
                                         BEGIN
                                           CustPostingGroup.GET("Posting Group");
                                           DebitAccount := CustPostingGroup."Receivables Account";
                                         END;
                                       "Bal. Account Type"::Vendor:
                                         BEGIN
                                           VendPostingGroup.GET("Posting Group");
                                           DebitAccount := VendPostingGroup."Payables Account";
                                         END;
                                       "Bal. Account Type"::"Bank Account":
                                         BEGIN
                                           BankAcc.GET("Bal. Account No.");
                                           BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                           DebitAccount := BankAccPostingGroup."G/L Bank Account No.";
                                         END;
                                     END;
                                     I := 0;
                                     MatchAcc := FALSE;
                                     IF DebitAccount <> '' THEN BEGIN
                                       REPEAT
                                         I := I + 1;
                                         IF ((DebitAccNo[I] = DebitAccount) AND (DebitDimValue[I] = "Shortcut Dimension 1 Code"))
                                            OR (DebitAccNo[I] = '')
                                         THEN BEGIN
                                           DebitAccNo[I] := DebitAccount;
                                           GLAcc.GET(DebitAccNo[I]);
                                           DebitAccName[I] := GLAcc.Name;
                                           //DebitAmount[I] := DebitAmount[I] + "Credit Amount";
                                           DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)");

                                           DebitDimValue[I] := "Shortcut Dimension 1 Code";
                                           MatchAcc := TRUE;
                                           IF "Bal. Account Type" = "Bal. Account Type"::"Bank Account" THEN
                                             BankAccNo := DebitAccount;
                                         END;
                                       UNTIL (I>=100) OR MatchAcc;
                                     END;
                                   END;
                                 END;

                           //Applies to ID
                           IF "Applies-to ID" <> '' THEN BEGIN
                             CustLedgerEntry.RESET;
                             CustLedgerEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open,Positive,"Due Date");
                             IF "Account Type" = "Account Type"::Customer THEN
                               CustLedgerEntry.SETRANGE("Customer No.","Account No.");
                             IF "Bal. Account Type" = "Bal. Account Type"::Customer THEN
                               CustLedgerEntry.SETRANGE("Customer No.","Bal. Account No.");
                             CustLedgerEntry.SETRANGE("Applies-to ID","Applies-to ID");
                             IF CustLedgerEntry.FIND('-') THEN
                               REPEAT
                                 CustLedgerEntrybuffer := CustLedgerEntry;
                                 CustLedgerEntrybuffer.MARK(TRUE);
                               UNTIL CustLedgerEntry.NEXT = 0 ;
                           END;

                           //Apply to Doc no.
                           IF "Applies-to Doc. No." <> '' THEN BEGIN
                             CustLedgerEntry.RESET;
                             CustLedgerEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open,Positive,"Due Date");
                             IF "Account Type" = "Account Type"::Customer THEN
                               CustLedgerEntry.SETRANGE("Customer No.","Account No.");
                             IF "Bal. Account Type" = "Bal. Account Type"::Customer THEN
                               CustLedgerEntry.SETRANGE("Customer No.","Bal. Account No.");
                               CustLedgerEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                               CustLedgerEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                             IF CustLedgerEntry.FIND('-') THEN
                               REPEAT
                                 CustLedgerEntrybuffer := CustLedgerEntry;
                                 CustLedgerEntrybuffer.MARK(TRUE);
                               UNTIL CustLedgerEntry.NEXT = 0 ;
                           END;

                               END;
                             UNTIL GenJnlLine2.NEXT=0;

                             // Unrealized VAT
                             //Applies-to ID
                             GenJnlLine3.COPYFILTERS(GenJnlLine2);
                             GenJnlLine3.SETFILTER("Applies-to ID",'<>%1','');
                             IF GenJnlLine3.FIND('-') THEN
                             REPEAT
                               WITH GenJnlLine3 DO BEGIN
                                 CustLedgEntry.RESET;
                                 CustLedgEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open,Positive,"Due Date");
                                 IF "Account Type" = "Account Type"::Customer THEN
                                   CustLedgEntry.SETRANGE("Customer No.","Account No.");
                                 IF "Bal. Account Type" = "Bal. Account Type"::Customer THEN
                                   CustLedgEntry.SETRANGE("Customer No.","Bal. Account No.");
                                 CustLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                 IF CustLedgEntry.FIND('-') THEN
                                 REPEAT
                                   RemAmtVAT := 0;
                                   RemAmtBase := 0;
                                   VATEntry.RESET;
                                   VATEntry.SETRANGE("Document No.",CustLedgEntry."Document No.");
                                   VATEntry.SETRANGE("Posting Date",CustLedgEntry."Posting Date");
                                   VATEntry.SETFILTER("Remaining Unrealized Amount",'<>%1',0);
                                   IF VATEntry.FIND('-') THEN
                                   REPEAT
                                     RemAmtVAT := RemAmtVAT + VATEntry."Remaining Unrealized Amount";
                                     RemAmtBase := RemAmtBase + VATEntry."Remaining Unrealized Base";
                                   UNTIL VATEntry.NEXT=0;
                                     PayPer := 1;
                                     IF VATPostingSetup.GET(VATEntry."VAT Bus. Posting Group",VATEntry."VAT Prod. Posting Group") AND
                                        (VATPostingSetup."Unrealized VAT Type" <> VATPostingSetup."Unrealized VAT Type"::" ")
                                     THEN BEGIN
                                       VATAccountNo := VATPostingSetup."Sales VAT Unreal. Account";
                                       VATAccountNo2 := VATPostingSetup."Sales VAT Account";
                                       IF (ABS(Amount) < ABS(RemAmtBase + RemAmtVAT)) AND
                                          (RemAmtBase + RemAmtVAT <> 0)
                                       THEN BEGIN
                                         PayPer := ABS(Amount / (RemAmtBase + RemAmtVAT));
                                         IF PayPer > 1 THEN
                                           PayPer := 1;
                                       END;
                                       VATAmt := -RemAmtVAT * PayPer;
                                       //VAT Unreal
                                       I := 0;
                                       MatchAcc := FALSE;
                                       REPEAT
                                         I := I + 1;
                                         IF (DebitAccNo[I] = VATAccountNo) OR (DebitAccNo[I] = '') THEN BEGIN
                                           DebitAccNo[I] := VATAccountNo;
                                           IF GLAcc.GET(VATAccountNo) THEN
                                             DebitAccName[I] := GLAcc.Name;
                                           DebitAmount[I] := DebitAmount[I] + VATAmt;
                                           MatchAcc := TRUE;
                                         END;
                                       UNTIL (I>=100) OR MatchAcc;
                                       //VAT Real
                                       I := 0;
                                       MatchAcc := FALSE;
                                       REPEAT
                                         I := I + 1;
                                         IF (CreditAccNo[I] = VATAccountNo2) OR (CreditAccNo[I] = '') THEN BEGIN
                                           CreditAccNo[I] := VATAccountNo2;
                                           IF GLAcc.GET(VATAccountNo2) THEN
                                             CreditAccName[I] := GLAcc.Name;
                                           CreditAmount[I] := CreditAmount[I] + VATAmt;
                                           MatchAcc := TRUE;
                                         END;
                                       UNTIL (I>=100) OR MatchAcc;
                                     END;
                                   //UNTIL VATEntry.NEXT=0;
                                 UNTIL CustLedgEntry.NEXT=0;
                               END;
                             UNTIL GenJnlLine3.NEXT=0;

                             //Applies-to Doc No.
                             GenJnlLine3.COPYFILTERS(GenJnlLine2);
                             GenJnlLine3.SETFILTER("Applies-to Doc. No.",'<>%1','');
                             IF GenJnlLine3.FIND('-') THEN
                             REPEAT
                               WITH GenJnlLine3 DO BEGIN
                                 CustLedgEntry.RESET;
                                 CustLedgEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open,Positive,"Due Date");
                                 IF "Account Type" = "Account Type"::Customer THEN
                                   CustLedgEntry.SETRANGE("Customer No.","Account No.");
                                 IF "Bal. Account Type" = "Bal. Account Type"::Customer THEN
                                   CustLedgEntry.SETRANGE("Customer No.","Bal. Account No.");
                                 CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                 CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                 IF CustLedgEntry.FIND('-') THEN
                                 REPEAT
                                   RemAmtVAT := 0;
                                   RemAmtBase := 0;
                                   VATEntry.RESET;
                                   VATEntry.SETRANGE("Document No.",CustLedgEntry."Document No.");
                                   VATEntry.SETRANGE("Posting Date",CustLedgEntry."Posting Date");
                                   VATEntry.SETFILTER("Remaining Unrealized Amount",'<>%1',0);
                                   IF VATEntry.FIND('-') THEN
                                   REPEAT
                                     RemAmtVAT := RemAmtVAT + VATEntry."Remaining Unrealized Amount";
                                     RemAmtBase := RemAmtBase + VATEntry."Remaining Unrealized Base";
                                   UNTIL VATEntry.NEXT=0;
                                     PayPer := 1;
                                     IF VATPostingSetup.GET(VATEntry."VAT Bus. Posting Group",VATEntry."VAT Prod. Posting Group") THEN BEGIN
                                       VATAccountNo := VATPostingSetup."Sales VAT Unreal. Account";
                                       VATAccountNo2 := VATPostingSetup."Sales VAT Account";
                                       IF (ABS(Amount) < ABS(RemAmtBase + RemAmtVAT)) AND
                                          (RemAmtBase + RemAmtVAT <> 0)
                                       THEN BEGIN
                                         PayPer := ABS(Amount / (RemAmtBase + RemAmtVAT));
                                         IF PayPer > 1 THEN
                                           PayPer := 1;
                                       END;
                                       VATAmt := -RemAmtVAT * PayPer;
                                       //VAT Unreal
                                       I := 0;
                                       MatchAcc := FALSE;
                                       REPEAT
                                         I := I + 1;
                                         IF (DebitAccNo[I] = VATAccountNo) OR (DebitAccNo[I] = '') THEN BEGIN
                                           DebitAccNo[I] := VATAccountNo;
                                           IF GLAcc.GET(VATAccountNo) THEN
                                             DebitAccName[I] := GLAcc.Name;
                                           DebitAmount[I] := DebitAmount[I] + VATAmt;
                                           MatchAcc := TRUE;
                                         END;
                                       UNTIL (I>=100) OR MatchAcc;
                                       //VAT Real
                                       I := 0;
                                       MatchAcc := FALSE;
                                       REPEAT
                                         I := I + 1;
                                         IF (CreditAccNo[I] = VATAccountNo2) OR (CreditAccNo[I] = '') THEN BEGIN
                                           CreditAccNo[I] := VATAccountNo2;
                                           IF GLAcc.GET(VATAccountNo2) THEN
                                             CreditAccName[I] := GLAcc.Name;
                                           CreditAmount[I] := CreditAmount[I] + VATAmt;
                                           MatchAcc := TRUE;
                                         END;
                                       UNTIL (I>=100) OR MatchAcc;
                                     END;
                                   //UNTIL VATEntry.NEXT=0;
                                 UNTIL CustLedgEntry.NEXT=0;
                               END;
                             UNTIL GenJnlLine3.NEXT=0;

                             //CalcWHT
                               IF ("Applies-to Doc. No." <> '') OR ("Applies-to ID" <> '') THEN BEGIN
                                 WHTEntry.RESET;
                                 WHTEntry.SETCURRENTKEY("Transaction Type","Document No.","Document Type","Bill-to/Pay-to No.");
                                 IF "Applies-to Doc. Type" = "Applies-to Doc. Type"::Invoice THEN
                                   WHTEntry.SETRANGE("Document Type",WHTEntry."Document Type"::Invoice);
                                 IF "Applies-to Doc. Type" = "Applies-to Doc. Type"::"Credit Memo" THEN
                                   WHTEntry.SETRANGE("Document Type",WHTEntry."Document Type"::"Credit Memo");
                                 //WHTEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                 IF "Applies-to Doc. No." <> '' THEN
                                   WHTEntry.SETRANGE("Document No.","Applies-to Doc. No.")
                                 ELSE BEGIN
                                   IF "Applies-to ID" <> '' THEN BEGIN
                                     {---
                                     CustLedgEntry.RESET;
                                     CustLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                     IF CustLedgEntry.FIND('-') THEN
                                     REPEAT
                                       IF DocNoFilter = '' THEN
                                         DocNoFilter := CustLedgEntry."Document No."
                                       ELSE BEGIN
                                         IF STRLEN(DocNoFilter + '|' + CustLedgEntry."Document No.") <= 250 THEN
                                           DocNoFilter := DocNoFilter + '|' + CustLedgEntry."Document No."
                                         ELSE
                                           DocNoFilter2 := DocNoFilter2 + '|' + CustLedgEntry."Document No.";
                                       END;
                                     UNTIL CustLedgEntry.NEXT=0;
                                     IF DocNoFilter <> '' THEN BEGIN
                                       IF DocNoFilter2 = '' THEN
                                         WHTEntry.SETFILTER("Document No.",DocNoFilter)
                                       ELSE
                                         WHTEntry.SETFILTER("Document No.",'%1|%2',DocNoFilter,DocNoFilter2);
                                     END;
                                     ---}
                                     WHTEntry.SETFILTER("Applies-to ID","Applies-to ID");  //KKE : #003
                                   END;
                                   IF "Account Type" = "Account Type"::Customer THEN
                                     WHTEntry.SETRANGE("Bill-to/Pay-to No.","Account No.")
                                   ELSE IF "Bal. Account Type" = "Bal. Account Type"::Customer THEN
                                     WHTEntry.SETRANGE("Bill-to/Pay-to No.","Bal. Account No.");
                                 END;
                                 IF WHTEntry.FIND('-') THEN
                                   REPEAT
                                     IF WHTPostingSetup.GET(WHTEntry."WHT Bus. Posting Group",WHTEntry."WHT Prod. Posting Group") THEN BEGIN
                                       WHTAccountNo := WHTPostingSetup."Prepaid WHT Account Code";
                                       IF GLAcc.GET(WHTAccountNo) THEN
                                         WHTAccountName := GLAcc.Name;
                                     END;
                                     {PayPer := 0;
                                     IF WHTEntry."Base Amount Inc. VAT (LCY)" <> 0 THEN
                                       PayPer := ABS("Amount (LCY)"/ WHTEntry."Base Amount Inc. VAT (LCY)");
                                     IF PayPer > 1 THEN
                                       PayPer := 1;
                                     //CreditWHTAmt := CreditWHTAmt + -(WHTEntry."WHT Amount (LCY)" * PayPer);
                                     }
                                   UNTIL WHTEntry.NEXT=0;

                                 IF "WHT Payment" THEN BEGIN
                                   IF "Account Type" = "Account Type"::Customer THEN BEGIN
                                     CustLedgEntry.RESET;
                                     CustLedgEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open,Positive,"Due Date");
                                     CustLedgEntry.SETRANGE("Customer No.","Account No.");
                                     IF "Applies-to ID" <> '' THEN
                                       CustLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                     IF ("Applies-to Doc. Type" <> 0) AND ("Applies-to Doc. No." <> '') THEN BEGIN
                                       CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                       CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                     END;
                                     IF CustLedgEntry.FIND('-') THEN BEGIN
                                       SalesInvLine.RESET;
                                       SalesInvLine.SETRANGE("Document No.",CustLedgEntry."Document No.");
                                       SalesInvLine.SETFILTER("WHT Product Posting Group",'<>%1','');
                                       IF SalesInvLine.FIND('-') THEN
                                         IF WHTPostingSetup.GET(SalesInvLine."WHT Business Posting Group",SalesInvLine."WHT Product Posting Group") THEN BEGIN
                                           WHTAccountNo := WHTPostingSetup."Prepaid WHT Account Code";
                                         IF GLAcc.GET(WHTAccountNo) THEN
                                           WHTAccountName := GLAcc.Name;
                                       END;
                                     END;
                                   END ELSE
                                     IF "Bal. Account Type"::Customer = "Bal. Account Type"::Customer THEN BEGIN
                                       CustLedgEntry.RESET;
                                       CustLedgEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open,Positive,"Due Date");
                                       CustLedgEntry.SETRANGE("Customer No.","Bal. Account No.");
                                       IF "Applies-to ID" <> '' THEN
                                         CustLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                       IF ("Applies-to Doc. Type" <> 0) AND ("Applies-to Doc. No." <> '') THEN BEGIN
                                         CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                         CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                       END;
                                       IF CustLedgEntry.FIND('-') THEN BEGIN
                                         SalesInvLine.RESET;
                                         SalesInvLine.SETRANGE("Document No.",CustLedgEntry."Document No.");
                                         SalesInvLine.SETFILTER("WHT Product Posting Group",'<>%1','');
                                         IF SalesInvLine.FIND('-') THEN
                                           IF WHTPostingSetup.GET(SalesInvLine."WHT Business Posting Group",SalesInvLine."WHT Product Posting Group")
                                           THEN BEGIN
                                             WHTAccountNo := WHTPostingSetup."Prepaid WHT Account Code";
                                             IF GLAcc.GET(WHTAccountNo) THEN
                                               WHTAccountName := GLAcc.Name;
                                           END;
                                       END;
                                     END;
                                   WHTAmt := ABS(Amount);
                                 END;
                                 //CreditWHTAmt := CreditWHTAmt + ABS(WHTManagement.WHTAmountJournal(GenJnlLine2,FALSE));

                                 CLEAR(WHTManagement);
                                 GenJnlLine3 := GenJnlLine2;
                                 GenJnlLine3.VALIDATE(Amount,-GenJnlLine3.Amount);
                                 //CreditWHTAmt := CreditWHTAmt - WHTManagement.ApplyCustCalcWHT(GenJnlLine3);
                               END;

                           END;
                         END;

        ReqFilterFields=Journal Template Name,Journal Batch Name,Document No.;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19265;
            SectionHeight=4250;
            OnPreSection=BEGIN
                           Line := 0;
                           IF CurrReport.PAGENO > 1 THEN
                             TextPageNo := STRSUBSTNO('Page %1',CurrReport.PAGENO);
                         END;

          }
          CONTROLS
          {
            { 1000000135;Label  ;13950;2400 ;5100 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=NO............................................. }
            { 1000000136;TextBox;15000;2400 ;3000 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Document No." }
            { 1000000141;Label  ;13950;2950 ;5100 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DATE.......................................... }
            { 1000000142;TextBox;15000;2950 ;3000 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Posting Date" }
            { 1000000062;Label  ;4300 ;3250 ;9550 ;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=RECEIPT VOUCHER }
            { 1000000003;Label  ;13950;3500 ;5090 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PRINTED DATE.......................... }
            { 1000000008;TextBox;16450;3500 ;2350 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=TODAY }
            { 1000000060;TextBox;11400;150  ;7450 ;500  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tax ID ' + CompanyInfo."VAT Registration No." }
            { 1000000086;TextBox;0    ;0    ;9700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000087;TextBox;0    ;600  ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" }
            { 1000000113;TextBox;14800;950  ;4050 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextPageNo }
            { 1000000114;TextBox;0    ;1200 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000115;TextBox;0    ;1800 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr='Tel: ' + CompanyInfo."Phone No." + ' Fax: ' + CompanyInfo."Fax No." }
            { 1000000116;TextBox;4300 ;2400 ;9550 ;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19265;
            SectionHeight=3880;
            OnPreSection=BEGIN

                           xGenJnlLine.RESET;
                           xGenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                           xGenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                           xGenJnlLine.SETRANGE("Document No.","Document No.");
                           IF xGenJnlLine.FIND('-') THEN BEGIN
                             //TSA001
                             //ChequeNo := xGenJnlLine."External Document No.";
                             //ChequeDate := xGenJnlLine."Cheque Date";
                             //TSA001
                             REPEAT
                               IF ((xGenJnlLine."Account Type" = xGenJnlLine."Account Type"::"Bank Account") AND
                                   (xGenJnlLine."Account No." <> ''))
                                  OR
                                  ((xGenJnlLine."Bal. Account Type" = xGenJnlLine."Bal. Account Type"::"Bank Account") AND
                                   (xGenJnlLine."Bal. Account No." <> ''))
                               THEN BEGIN
                                 DebitTotalLCY := DebitTotalLCY + xGenJnlLine."Debit Amount";
                                 CreditTotalLCY := CreditTotalLCY + xGenJnlLine."Credit Amount";
                                 ChequeNo := xGenJnlLine."Check No.";
                                 ChequeDate := xGenJnlLine."Cheque Date";
                                 BankBranchNo := xGenJnlLine."Bank Branch No.";
                               END;
                               IF xGenJnlLine."Account Type" = xGenJnlLine."Account Type"::Customer THEN BEGIN
                                 Customer.GET(xGenJnlLine."Account No.");
                                 CustName := xGenJnlLine."Account No." + '   ' + Customer.Name;
                               END ELSE
                               IF xGenJnlLine."Bal. Account Type" = xGenJnlLine."Bal. Account Type"::Customer THEN BEGIN
                                 Customer.GET(xGenJnlLine."Bal. Account No.");
                                 CustName := xGenJnlLine."Bal. Account No." + '   ' + Customer.Name;
                               END;
                               IF xGenJnlLine."Real Customer/Vendor Name" <> '' THEN
                                 CustName := xGenJnlLine."Real Customer/Vendor Name";
                             UNTIL xGenJnlLine.NEXT=0;
                             IF DebitTotalLCY = 0 THEN
                               TotalAmt := CreditTotalLCY
                             ELSE
                               TotalAmt := DebitTotalLCY;
                             DebitTotalLCY := 0;
                             CreditTotalLCY := 0;
                           END;

                           CheckReport.InitTextVariable;
                           CheckReport.FormatNoText(TextAmount,ABS(TotalAmt),"Currency Code");

                           IF TextAmount[1] <> '' THEN
                             TextAmount[1] := FORMAT(ABS(TotalAmt),0,'<Precision,2:2><Standard Format,0>') + '   (' + TextAmount[1] + ')';

                           IF xCash = 'P' THEN BEGIN
                             "Bank Name" := '';
                             "Bank Branch" := '';
                             ChequeNo := '';
                             CLEAR(ChequeDate);
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000090;Label  ;2430 ;150  ;16590;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=........................................................................................................................................................................................ }
            { 1000000147;TextBox;2630 ;150  ;16300;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CustName }
            { 1000000092;Label  ;1950 ;850  ;17070;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=....................................................................................................................................................................................................... }
            { 1000000065;TextBox;2150 ;850  ;16780;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Description }
            { 1000000101;Label  ;1530 ;1600 ;17490;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=....................................................................................................................................................................................................... }
            { 1000000088;Label  ;10450;2350 ;4550 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=No........................................................ }
            { 1000000150;Label  ;4860 ;2350 ;5400 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Bank.......................................................................................... }
            { 1000000151;TextBox;5750 ;2350 ;4300 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=BankBranchNo }
            { 1000000152;TextBox;11200;2350 ;3570 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ChequeNo }
            { 1000000089;Label  ;15150;2350 ;3750 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Date.................................................... }
            { 1000000084;TextBox;16020;2350 ;2750 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ChequeDate }
            { 1000000148;Label  ;2920 ;2450 ;1770 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Check/ Draft }
            { 1000000157;TextBox;2450 ;2500 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCheque }
            { 1000000156;Shape  ;2350 ;2500 ;450  ;423   }
            { 1000000149;Label  ;1420 ;2450 ;900  ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CASH }
            { 1000000063;Label  ;150  ;150  ;2280 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Received From : }
            { 1000000082;Label  ;150  ;850  ;1800 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description : }
            { 1000000100;Label  ;150  ;1600 ;1350 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Amount : }
            { 1000000154;Shape  ;900  ;2500 ;450  ;423   }
            { 1000000083;TextBox;960  ;2500 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCash }
            { 1000000085;Label  ;150  ;2450 ;660  ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=By : }
            { 1000000010;TextBox;1750 ;1600 ;17150;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotalAmt;
                                                         AutoFormatType=1 }
            { 1000000041;Label  ;12800;3200 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Input VAT }
            { 1000000042;Label  ;16100;3200 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (RM) }
            { 1000000098;Label  ;10000;3200 ;2320 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Goods/Service }
            { 1000000103;Label  ;1450 ;3200 ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description }
            { 1000000106;Shape  ;19200;0    ;30   ;3850 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000108;Shape  ;15850;3150 ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000109;Shape  ;12600;3150 ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000110;Shape  ;9600 ;3150 ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000111;Shape  ;15   ;3850 ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000112;Shape  ;0    ;0    ;30   ;3850 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000096;Shape  ;15   ;3150 ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000118;Shape  ;15   ;0    ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19265;
            SectionHeight=1330;
            OnPreSection=BEGIN
                           CheckReport.InitTextVariable;
                           CheckReport.FormatNoText(AmountLangA, DebitTotalLCY,"Gen. Journal Line"."Currency Code");
                         END;

          }
          CONTROLS
          {
            { 1000000091;Label  ;11650;200  ;900  ;700  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total }
            { 1000000093;TextBox;12750;200  ;3070 ;700  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitTotalLCY }
            { 1000000094;TextBox;16000;200  ;3110 ;700  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditTotalLCY }
            { 1000000095;Shape  ;0    ;0    ;30   ;1315 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000097;Shape  ;19200;0    ;30   ;1315 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000099;Shape  ;12600;0    ;150  ;1315 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000102;Shape  ;15850;0    ;150  ;1315 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000186;Shape  ;15   ;1300 ;19215;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000033;Shape  ;15   ;0    ;19215;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19265;
            SectionHeight=450;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           DebitTotalLCY := 0;
                           CreditTotalLCY := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000061;Label  ;0    ;0    ;5500 ;450  ;HorzAlign=Center;
                                                         ForeColor=255;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19265;
            SectionHeight=2789;
          }
          CONTROLS
          {
            { 1000000167;Shape  ;19200;0    ;30   ;2760 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000064;Shape  ;15   ;2759 ;19215;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000004;Shape  ;12885;950  ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000013;Label  ;10700;650  ;2275 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Acct.Entry By : }
            { 1000000037;Shape  ;3135 ;920  ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000046;Label  ;10700;2000 ;2335 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved By : }
            { 1000000055;Label  ;1170 ;620  ;2075 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By : }
            { 1000000066;Label  ;1150 ;2000 ;2045 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Checked By : }
            { 1000000067;Shape  ;12885;2300 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000068;Shape  ;3065 ;2300 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000069;Shape  ;0    ;0    ;30   ;2760 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000009;Shape  ;15   ;0    ;19215;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table21;
        DataItemTableView=SORTING(Entry No.);
        DataItemVarName=CustLedgerEntrybuffer2;
        OnPreDataItem=BEGIN
                        //TSA
                        CustLedgerEntrybuffer.MARKEDONLY(TRUE);
                        IF CustLedgerEntrybuffer.FIND('-') THEN
                        REPEAT
                           CustLedgerEntrybuffer2 := CustLedgerEntrybuffer ;
                           CustLedgerEntrybuffer2.MARK(TRUE);
                        UNTIL CustLedgerEntrybuffer.NEXT = 0
                        ELSE
                          ShowBlank := TRUE;
                        MARKEDONLY(TRUE);
                        //TSA

                        totCreditVATAmtTmp := 0 ;
                        totAmounttoApply := 0;
                      END;

        OnAfterGetRecord=BEGIN
                                   CustLedgerEntrybuffer2.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)","Remaining Amount",
                                     "Original Amt. (LCY)");
                                   CreditAppliedVATAmtTmp := 0;
                                   CreditVATAmtTmp := 0 ;
                                   PayPer := 1 ;
                                   VATEntry.RESET;
                                   VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                                   VATEntry.SETRANGE("Posting Date",CustLedgerEntrybuffer2."Posting Date");
                                   VATEntry.SETRANGE("Document No.",CustLedgerEntrybuffer2."Document No.");
                                   //VATEntry.SETFILTER("Remaining Unrealized Amount",'<>0');
                                   IF VATEntry.FIND('-') THEN
                                   REPEAT
                                     IF VATEntry.Amount <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp + VATEntry.Amount;

                                         CreditAppliedVATAmtTmp := 0;
                                     END;
                                     IF VATEntry."Remaining Unrealized Amount" <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp + VATEntry."Remaining Unrealized Amount";
                                         CreditAppliedVATAmtTmp := 0;
                                     END;

                                   UNTIL VATEntry.NEXT=0;

                           CreditMemoCustLedgerEntry.SETRANGE("Closed by Entry No.",CustLedgerEntrybuffer2."Entry No.");

                           IF CreditMemoCustLedgerEntry.FIND('-') THEN
                           REPEAT
                                   VATEntry.RESET;
                                   VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                                   VATEntry.SETRANGE("Posting Date",CreditMemoCustLedgerEntry."Posting Date");
                                   VATEntry.SETRANGE("Document No.",CreditMemoCustLedgerEntry."Document No.");
                                   IF VATEntry.FIND('-') THEN
                                   REPEAT
                                     IF VATEntry.Amount <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp + VATEntry.Amount;
                                         CreditAppliedVATAmtTmp := 0;
                                     END;
                                     IF VATEntry."Remaining Unrealized Amount" <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp + VATEntry."Remaining Unrealized Amount";
                                         CreditAppliedVATAmtTmp := 0;
                                     END;

                                   UNTIL VATEntry.NEXT=0;

                           UNTIL CreditMemoCustLedgerEntry.NEXT=0;

                           CreditVATAmtTmp := ABS(CreditVATAmtTmp);

                                   totAmounttoApply +=   CustLedgerEntrybuffer2."Amount to Apply" ;
                                   totCreditVATAmtTmp := totCreditVATAmtTmp + CreditVATAmtTmp ;
                         END;

        TotalFields=Amount to Apply;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19265;
            SectionHeight=3880;
          }
          CONTROLS
          {
            { 1000000120;Label  ;2430 ;150  ;16590;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=........................................................................................................................................................................................ }
            { 1000000121;TextBox;2630 ;150  ;16300;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CustName }
            { 1000000122;Label  ;1950 ;850  ;17070;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=....................................................................................................................................................................................................... }
            { 1000000123;TextBox;2150 ;850  ;16780;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Description }
            { 1000000124;Label  ;1530 ;1600 ;17490;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=....................................................................................................................................................................................................... }
            { 1000000125;Label  ;10450;2350 ;4550 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=No........................................................ }
            { 1000000126;Label  ;4860 ;2350 ;5400 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Bank.......................................................................................... }
            { 1000000127;TextBox;5750 ;2350 ;4300 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=BankBranchNo }
            { 1000000128;TextBox;11200;2350 ;3570 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ChequeNo }
            { 1000000129;Label  ;15150;2350 ;3750 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Date.................................................... }
            { 1000000130;TextBox;16020;2350 ;2750 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ChequeDate }
            { 1000000131;Label  ;2920 ;2450 ;1770 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Check/ Draft }
            { 1000000132;TextBox;2450 ;2500 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCheque }
            { 1000000133;Shape  ;2350 ;2500 ;450  ;423   }
            { 1000000134;Label  ;1420 ;2450 ;900  ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CASH }
            { 1000000137;Label  ;150  ;150  ;2280 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Received From : }
            { 1000000138;Label  ;150  ;850  ;1800 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description : }
            { 1000000139;Label  ;150  ;1600 ;1350 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Amount : }
            { 1000000153;Shape  ;900  ;2500 ;450  ;423   }
            { 1000000158;TextBox;960  ;2500 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCash }
            { 1000000159;Label  ;150  ;2450 ;660  ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=By : }
            { 1000000160;TextBox;1750 ;1600 ;17150;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotalAmt;
                                                         AutoFormatType=1 }
            { 1000000161;Label  ;12800;3200 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Input VAT }
            { 1000000162;Label  ;16100;3200 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000163;Label  ;10000;3200 ;2320 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Goods/Service }
            { 1000000164;Label  ;1450 ;3200 ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description }
            { 1000000165;Shape  ;19200;0    ;30   ;3850 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000166;Shape  ;15850;3150 ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000168;Shape  ;12600;3150 ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000169;Shape  ;9600 ;3150 ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000170;Shape  ;15   ;3850 ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000171;Shape  ;0    ;0    ;30   ;3850 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000172;Shape  ;15   ;3150 ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000173;Shape  ;15   ;0    ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19265;
            SectionHeight=730;
            OnPreSection=BEGIN
                           Line += 1;
                         END;

          }
          CONTROLS
          {
            { 1000000012;TextBox;400  ;50   ;9050 ;600  ;FontSize=8;
                                                         SourceExpr=["Document No."+ '   #' +Description ] }
            { 1000000034;TextBox;9650 ;50   ;2850 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CustLedgerEntrybuffer2."Amount to Apply"-CreditVATAmtTmp }
            { 1000000035;TextBox;12800;50   ;2900 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATAmtTmp }
            { 1000000036;TextBox;16050;50   ;3050 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CustLedgerEntrybuffer2."Amount to Apply" }
            { 1000000038;Shape  ;19200;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000039;Shape  ;15   ;700  ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000043;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000079;Shape  ;15850;0    ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000080;Shape  ;12600;0    ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000081;Shape  ;9600 ;0    ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19265;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000174;Label  ;17050;0    ;2050 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=CustLEFooter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19265;
            SectionHeight=730;
            OnPreSection=BEGIN
                           IF ShowBlank = TRUE THEN
                           BEGIN
                             CurrReport.SHOWOUTPUT(TRUE);
                             Line += 1;
                           END
                           ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000051;Shape  ;19200;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000056;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000057;Shape  ;15   ;685  ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000052;Shape  ;9600 ;0    ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000053;Shape  ;12600;0    ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000054;Shape  ;15850;0    ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19265;
            SectionHeight=850;
          }
          CONTROLS
          {
            { 1000000059;Label  ;4000 ;0    ;1950 ;650  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (RM) }
            { 1000000072;TextBox;6000 ;0    ;3450 ;650  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CustLedgerEntrybuffer2."Amount to Apply" }
            { 1000000073;TextBox;9650 ;0    ;2850 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=totAmounttoApply-totCreditVATAmtTmp }
            { 1000000074;TextBox;12800;0    ;2900 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=totCreditVATAmtTmp }
            { 1000000075;TextBox;16050;0    ;3050 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=totAmounttoApply }
            { 1000000076;TextBox;150  ;0    ;3750 ;650  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotalItemText }
            { 1000000104;Shape  ;12600;0    ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000105;Shape  ;9600 ;0    ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000107;Shape  ;0    ;700  ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000117;Shape  ;15850;0    ;150  ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000119;Shape  ;19200;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000040;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        OnPreDataItem=BEGIN
                        IF Line > 11 THEN BEGIN
                          CurrReport.NEWPAGE;
                          Line := 0;
                        END;
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19265;
            SectionHeight=935;
          }
          CONTROLS
          {
            { 1000000005;Shape  ;15   ;0    ;19215;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000006;Shape  ;19200;20   ;30   ;915  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000007;Label  ;16040;150  ;3115 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CREDIT }
            { 1000000044;Shape  ;15850;20   ;150  ;915  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000045;Label  ;12750;150  ;3065 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DEBIT }
            { 1000000047;Shape  ;12600;20   ;150  ;915  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;Label  ;9850 ;150  ;2750 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=PROJECT CODE }
            { 1000000049;Shape  ;9600 ;20   ;150  ;915  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000050;Label  ;3160 ;150  ;5750 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DESCRIPTION }
            { 1000000058;Shape  ;15   ;900  ;19215;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000070;Shape  ;2750 ;20   ;150  ;915  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000077;Label  ;300  ;150  ;2400 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CODE }
            { 1000000078;Shape  ;0    ;20   ;30   ;915  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitDetail;
        OnPreDataItem=BEGIN
                        I := 0;
                        MatchAcc := FALSE;
                        REPEAT
                          I := I + 1;
                          IF (DebitAccNo[I] = BankAccNo) AND (DebitAmount[I] <> 0) THEN BEGIN
                            DebitAmount[I] := DebitAmount[I] - CreditWHTAmt;
                            MatchAcc := TRUE;
                          END;
                        UNTIL (I>=100) OR MatchAcc;
                      END;

        OnAfterGetRecord=BEGIN
                           IF DebitAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             IF DebitAmount[Number] = 0 THEN
                               CurrReport.SKIP
                             ELSE
                               Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19265;
            SectionHeight=600;
            OnPreSection=BEGIN

                           DebitTotalLCY := DebitTotalLCY + DebitAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;9850 ;50   ;2750 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitDimValue[Number] }
            { 1000000001;TextBox;2950 ;50   ;6650 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccName[Number] }
            { 1000000002;TextBox;12750;50   ;3050 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000071;TextBox;150  ;50   ;2550 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccNo[Number] }
            { 1000000140;Shape  ;19200;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000143;Shape  ;15850;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000144;Shape  ;12600;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000145;Shape  ;9600 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000146;Shape  ;2750 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000155;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditDetail;
        OnAfterGetRecord=BEGIN
                           IF CreditAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             IF CreditAmount[Number] = 0 THEN
                               CurrReport.SKIP
                             ELSE
                               Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19265;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CreditTotalLCY := CreditTotalLCY + CreditAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000018;TextBox;9850 ;50   ;2750 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditDimValue[Number] }
            { 1000000019;TextBox;2950 ;50   ;6650 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccName[Number] }
            { 1000000020;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000195;Shape  ;19200;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000199;Shape  ;15850;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000200;Shape  ;12600;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000201;Shape  ;9600 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000202;Shape  ;2750 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000204;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000016;TextBox;150  ;50   ;2550 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccNo[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=WHTDetail;
        OnAfterGetRecord=BEGIN
                           IF CreditWHTAmt = 0 THEN
                             CurrReport.SKIP;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19265;
            SectionHeight=600;
            OnPreSection=BEGIN
                           DebitTotalLCY := DebitTotalLCY + CreditWHTAmt;
                         END;

          }
          CONTROLS
          {
            { 1000000014;TextBox;3150 ;50   ;6300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000015;TextBox;12750;50   ;3050 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditWHTAmt;
                                                         AutoFormatType=1 }
            { 1000000017;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000022;Shape  ;19200;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000027;Shape  ;15850;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000028;Shape  ;12600;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000029;Shape  ;9600 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000030;Shape  ;2750 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000031;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=LineLoop;
        OnAfterGetRecord=BEGIN
                           IF Line + Number > 18 THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19265;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000021;Shape  ;19200;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000023;Shape  ;15850;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000024;Shape  ;12600;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000025;Shape  ;9600 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000026;Shape  ;2750 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000032;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=11440;
      Height=1540;
      SaveValues=Yes;
      OnInit=BEGIN
               Cash := FALSE;
               Cheque := TRUE;
             END;

    }
    CONTROLS
    {
      { 1000000000;CheckBox;3410;110  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Cash;
                                                   SourceExpr=Cash;
                                                   OnValidate=BEGIN
                                                                IF Cash THEN
                                                                  Cheque := FALSE;
                                                              END;
                                                               }
      { 1000000001;Label  ;110  ;110  ;3190 ;440  ;ParentControl=1000000000 }
      { 1000000002;Label  ;110  ;660  ;3190 ;440  ;ParentControl=1000000003 }
      { 1000000003;CheckBox;3410;660  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Cheque;
                                                   SourceExpr=Cheque;
                                                   OnPush=BEGIN
                                                            IF Cheque THEN
                                                              Cash := FALSE;
                                                          END;
                                                           }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000003 : Record 79;
      Vendor@1000000025 : Record 23;
      VendPostingGroup@1000000009 : Record 93;
      Customer@1000000026 : Record 18;
      CustPostingGroup@1000000008 : Record 92;
      CustLedgEntry@1000000081 : Record 21;
      CustLedgerEntry@1000000060 : Record 21;
      CustLedgerEntrybuffer@1000000058 : Record 21;
      CreditMemoCustLedgerEntry@1000000069 : Record 25;
      GLAcc@1000000022 : Record 15;
      BankAcc@1000000030 : Record 270;
      BankAccPostingGroup@1000000006 : Record 277;
      WHTPostingSetup@1000000085 : Record 28043;
      SalesInvLine@1000000084 : Record 113;
      VATEntry@1000000016 : Record 254;
      VATPostingSetup@1000000023 : Record 325;
      GenJnlLine@1000000045 : Record 81;
      GenJnlLine2@1000000065 : Record 81;
      GenJnlLine3@1000000020 : Record 81;
      xGenJnlLine@1000000086 : Record 81;
      CheckReport@1000000004 : Report 1401;
      VATAccountNo@1000000007 : Code[20];
      VATAccountName@1000000002 : Text[150];
      VATAccountNo2@1000000033 : Code[20];
      VATAccountName2@1000000031 : Text[150];
      DebitTotalLCY@1000000000 : Decimal;
      CreditTotalLCY@1000000001 : Decimal;
      VATAmt@1000000019 : Decimal;
      Bank@1000000029 : Text[30];
      Cash@1000000005 : Boolean;
      Cheque@1000000010 : Boolean;
      xCash@1000000027 : Text[1];
      xCheque@1000000028 : Text[1];
      ChequeNo@1000000032 : Code[20];
      ChequeDate@1000000015 : Date;
      CustName@1000000038 : Text[150];
      DebitVATAmt@1000000055 : Decimal;
      CreditVATAmt@1000000056 : Decimal;
      TextAmount@1000000063 : ARRAY [2] OF Text[250];
      TotalVATAmt@1000000091 : ARRAY [20] OF Decimal;
      TotalAmt@1000000017 : Decimal;
      Line@1000000034 : Integer;
      DebitAccount@1000000014 : Code[20];
      CreditAccount@1000000011 : Code[20];
      DebitAccNo@1000000035 : ARRAY [100] OF Code[20];
      CreditAccNo@1000000036 : ARRAY [100] OF Code[20];
      DebitAccName@1000000044 : ARRAY [100] OF Text[150];
      CreditAccName@1000000043 : ARRAY [100] OF Text[150];
      DebitAmount@1000000067 : ARRAY [100] OF Decimal;
      CreditAmount@1000000071 : ARRAY [100] OF Decimal;
      DebitDimValue@1000000012 : ARRAY [100] OF Code[20];
      CreditDimValue@1000000013 : ARRAY [100] OF Code[20];
      MatchAcc@1000000037 : Boolean;
      I@1000000042 : Integer;
      PayPer@1000000018 : Decimal;
      RemAmtVAT@1000000021 : Decimal;
      RemAmtBase@1000000024 : Decimal;
      AmountLangA@1000000039 : ARRAY [2] OF Text[80];
      WHTEntry@1000000040 : Record 28044;
      WHTManagement@1000000041 : Codeunit 28040;
      WHTAccountNo@1000000049 : Code[20];
      WHTAccountName@1000000048 : Text[150];
      WHTAmt@1000000053 : Decimal;
      WHTBaseAmt@1000000052 : Decimal;
      CreditWHTAmt@1000000051 : Decimal;
      CreditWHTBaseAmt@1000000050 : Decimal;
      BankAccNo@1000000054 : Code[20];
      BankBranchNo@1000000057 : Text[50];
      ShowBlank@1000000059 : Boolean;
      CreditVATAmtTmp@1000000061 : Decimal;
      totAmounttoApply@1000000062 : Decimal;
      totCreditVATAmtTmp@1000000064 : Decimal;
      TotalItemText@1000000066 : Text[30];
      CreditAppliedVATAmtTmp@1000000068 : Decimal;
      TextPageNo@1000000046 : Text[30];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Receipt Voucher Report.
      Burda
      002   11.07.2007   KKE   -Amount on Header get value from bank.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50007 Payment Voucher
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=[ 4:20:17 PM];
    Version List=AVATHA4.01,Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   CompanyInfo.GET;
                   //CompanyInfo.CALCFIELDS(Picture);
                 END;

    OnPreReport=BEGIN
                  DebitTotalLCY := 0;
                  CreditTotalLCY := 0;

                  //KKE : #006 +
                  VendEntryEdit.ResetAppliestoIDOnCloseEntry;
                  CLEAR(VendEntryEdit);
                  //KKE : #006 -
                END;

    PaperSize=A4 210 x 297 mm;
    HorzGrid=50;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table81;
        DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Posting Date,Document No.,Shortcut Dimension 1 Code);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        CASE TRUE OF
                          Cash: xCash := 'P';
                          Cheque: xCheque := 'P';
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           IF "Document No." = GenJnlLine."Document No." THEN
                             CurrReport.SKIP
                           ELSE
                             GenJnlLine := "Gen. Journal Line";

                           CLEAR(DebitAccNo);
                           CLEAR(DebitAccName);
                           CLEAR(DebitDimValue);
                           CLEAR(DebitVATDimValue);
                           CLEAR(DebitAmount);
                           CLEAR(CreditAccNo);
                           CLEAR(CreditAccName);
                           CLEAR(CreditDimValue);
                           CLEAR(CreditVATDimValue);
                           CLEAR(CreditAmount);
                           CLEAR(BankAccNo);
                           CLEAR(WHTAmt);
                           CLEAR(CreditWHTAmt);
                           CLEAR(DebitVATNo);
                           CLEAR(CreditVATNo);
                           CLEAR(DebitVATName);
                           CLEAR(CreditVATName);
                           CLEAR(DebitVATAmt);
                           CLEAR(CreditVATAmt);
                           //CLEAR(DocNoFilter);
                           //CLEAR(DocNoFilter2);
                           SkipWHT := FALSE;  //KKE : #004
                           CntLine := 0;
                           CLEAR(VendLedgerEntrybuffer);

                           GenJnlLine2.RESET;
                           GenJnlLine2.SETCURRENTKEY("Journal Template Name","Journal Batch Name","Posting Date","Document No.",
                                  "Shortcut Dimension 1 Code");
                           GenJnlLine2.SETRANGE("Journal Template Name","Journal Template Name");
                           GenJnlLine2.SETRANGE("Journal Batch Name","Journal Batch Name");
                           GenJnlLine2.SETRANGE("Document No.","Document No.");
                           IF GenJnlLine2.FIND('-') THEN
                           REPEAT
                             WITH GenJnlLine2 DO BEGIN
                               //KKE : #004 +
                               IF "Skip WHT" THEN
                                 SkipWHT := TRUE;
                               //KKE : #004 -
                               IF "Debit Amount" <> 0 THEN BEGIN
                                 //xxx +
                                 CLEAR(VATAccount);
                                 CLEAR(VATAmount);
                                 //xxx -
                                 CLEAR(DebitAccount);
                                 CASE "Account Type" OF
                                   "Account Type"::"G/L Account":
                                     BEGIN
                                       DebitAccount := "Account No.";
                                       //xxx +
                                       IF VATPostSetup.GET("VAT Bus. Posting Group","VAT Prod. Posting Group") THEN BEGIN
                                         VATAccount := VATPostSetup."Purchase VAT Account";
                                         //VATAmount := ROUND(VATPostSetup."VAT %" * (100 + VATPostSetup."VAT %") / "Debit Amount");
                                         VATAmount := ROUND(VATPostSetup."VAT %" * "Debit Amount" / (100 + VATPostSetup."VAT %"));
                                       END;
                                       //xxx -
                                     END;
                                   "Account Type"::Customer:
                                     BEGIN
                                       CustPostingGroup.GET("Posting Group");
                                       DebitAccount := CustPostingGroup."Receivables Account";
                                     END;
                                   "Account Type"::Vendor:
                                     BEGIN
                                       VendPostingGroup.GET("Posting Group");
                                       DebitAccount := VendPostingGroup."Payables Account";
                                     END;
                                   "Account Type"::"Bank Account":
                                     BEGIN
                                       BankAcc.GET("Account No.");
                                       BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                       DebitAccount := BankAccPostingGroup."G/L Bank Account No.";
                                     END;
                                 END;
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                  I := I + 1;
                                   IF ((DebitAccNo[I] = DebitAccount)) //AND (DebitDimValue[I] = "Shortcut Dimension 1 Code"))
                                      OR (DebitAccNo[I] = '')
                                   THEN BEGIN
                                     DebitAccNo[I] := DebitAccount;
                                     GLAcc.GET(DebitAccNo[I]);
                                     DebitAccName[I] := GLAcc.Name;
                                     DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)");
                                     DebitDimValue[I] := "Shortcut Dimension 1 Code";
                                     MatchAcc := TRUE;
                                     //xxx +
                                     IF VATAccount <> '' THEN BEGIN
                                       DebitAmount[I] := DebitAmount[I] - VATAmount;
                                       GLAcc.GET(VATAccount);
                                       DebitVATName[I] := GLAcc.Name;
                                       DebitVATNo[I] := VATAccount;
                                       DebitVATAmt[I] += VATAmount;
                                     END;
                                     //xxx -
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;

                                 IF "Bal. Account No." <> '' THEN BEGIN
                                   //xxx +
                                   CLEAR(VATAccount);
                                   CLEAR(VATAmount);
                                   //xxx -
                                   CLEAR(CreditAccount);
                                   CASE "Bal. Account Type" OF
                                     "Bal. Account Type"::"G/L Account":
                                       BEGIN
                                         CreditAccount := "Bal. Account No.";
                                         //xxx +
                                         IF VATPostSetup.GET("Bal. VAT Bus. Posting Group","Bal. VAT Prod. Posting Group") THEN BEGIN
                                           VATAccount := VATPostSetup."Purchase VAT Account";
                                           //VATAmount := ROUND(VATPostSetup."VAT %" * (100 + VATPostSetup."VAT %") / "Debit Amount");
                                           VATAmount := ROUND(VATPostSetup."VAT %" * "Debit Amount" / (100 + VATPostSetup."VAT %"));
                                         END;
                                         //xxx -
                                       END;
                                     "Bal. Account Type"::Customer:
                                       BEGIN
                                         CustPostingGroup.GET("Posting Group");
                                         CreditAccount := CustPostingGroup."Receivables Account";
                                       END;
                                     "Bal. Account Type"::Vendor:
                                       BEGIN
                                         VendPostingGroup.GET("Posting Group");
                                         CreditAccount := VendPostingGroup."Payables Account";
                                       END;
                                     "Bal. Account Type"::"Bank Account":
                                       BEGIN
                                         BankAcc.GET("Bal. Account No.");
                                         BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                         CreditAccount := BankAccPostingGroup."G/L Bank Account No.";
                                       END;
                                   END;
                                   I := 0;
                                   MatchAcc := FALSE;
                                   REPEAT
                                     I := I + 1;
                                     IF "Bal. Account Type" = "Bal. Account Type"::"Bank Account" THEN BEGIN
                                       IF (CreditAccNo[I] = CreditAccount) OR (CreditAccNo[I] = '')
                                       THEN BEGIN
                                         CreditAccNo[I] := CreditAccount;
                                         GLAcc.GET(CreditAccNo[I]);
                                         CreditAccName[I] := GLAcc.Name;
                                         CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)");
                                         BankAccNo := CreditAccount;
                                         MatchAcc := TRUE;
                                       END;
                                     END ELSE BEGIN
                                       IF ((CreditAccNo[I] = CreditAccount)) //AND (CreditDimValue[I] = "Shortcut Dimension 1 Code"))
                                          OR (CreditAccNo[I] = '')
                                       THEN BEGIN
                                         CreditAccNo[I] := CreditAccount;
                                         GLAcc.GET(CreditAccNo[I]);
                                         CreditAccName[I] := GLAcc.Name;
                                         CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)");
                                         BankAccNo := CreditAccount;
                                         CreditDimValue[I] := "Shortcut Dimension 1 Code";
                                         MatchAcc := TRUE;
                                         //xxx +
                                         IF VATAccount <> '' THEN BEGIN
                                           CreditAmount[I] := CreditAmount[I] - VATAmount;
                                           GLAcc.GET(VATAccount);
                                           CreditVATName[I] := GLAcc.Name;
                                           CreditVATNo[I] := VATAccount;
                                           CreditVATAmt[I] += VATAmount;
                                         END;
                                         //xxx -
                                       END;
                                     END;
                                   UNTIL (I>=300) OR MatchAcc;
                                 END;
                               END ELSE
                               IF "Credit Amount" <> 0 THEN BEGIN
                                 //xxx +
                                 CLEAR(VATAccount);
                                 CLEAR(VATAmount);
                                 //xxx -
                                 CLEAR(CreditAccount);
                                 CASE "Account Type" OF
                                   "Account Type"::"G/L Account":
                                     BEGIN
                                       CreditAccount := "Account No.";
                                       //xxx +
                                       IF VATPostSetup.GET("VAT Bus. Posting Group","VAT Prod. Posting Group") THEN BEGIN
                                         VATAccount := VATPostSetup."Purchase VAT Account";
                                         //VATAmount := ROUND(VATPostSetup."VAT %" * (100 + VATPostSetup."VAT %") / "Credit Amount");
                                         VATAmount := ROUND(VATPostSetup."VAT %" * "Credit Amount" / (100 + VATPostSetup."VAT %"));
                                       END;
                                       //xxx -
                                     END;
                                   "Account Type"::Customer:
                                     BEGIN
                                       CustPostingGroup.GET("Posting Group");
                                       CreditAccount := CustPostingGroup."Receivables Account";
                                     END;
                                   "Account Type"::Vendor:
                                     BEGIN
                                       VendPostingGroup.GET("Posting Group");
                                       CreditAccount := VendPostingGroup."Payables Account";
                                      // DebitAccount := VendPostingGroup."Payables Account"; //vvv
                                     END;
                                   "Account Type"::"Bank Account":
                                     BEGIN
                                       BankAcc.GET("Account No.");
                                       BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                       CreditAccount := BankAccPostingGroup."G/L Bank Account No.";
                                     END;
                                 END;
                                 I := 0;
                                 MatchAcc := FALSE;
                                 {
                                 REPEAT
                                   I := I + 1;
                                   IF ((DebitAccNo[I] = DebitAccount)) //AND (DebitDimValue[I] = "Shortcut Dimension 1 Code"))
                                      OR (DebitAccNo[I] = '')
                                   THEN BEGIN
                                     DebitAccNo[I] := DebitAccount;
                                     GLAcc.GET(DebitAccNo[I]);
                                     DebitAccName[I] := GLAcc.Name;
                                     DebitAmount[I] := DebitAmount[I] - ABS("Amount (LCY)");
                                     DebitDimValue[I] := "Shortcut Dimension 1 Code";
                                     MatchAcc := TRUE;
                                     //xxx +
                                     IF VATAccount <> '' THEN BEGIN
                                       CreditAmount[I] := CreditAmount[I] - VATAmount;
                                       GLAcc.GET(VATAccount);
                                       CreditVATName[I] := GLAcc.Name;
                                       CreditVATNo[I] := VATAccount;
                                       CreditVATAmt[I] += VATAmount;
                                     END;
                                     //xxx -
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                                 }
                                 //{
                                 REPEAT
                                   I := I + 1;
                                   IF ((CreditAccNo[I] = CreditAccount)) //AND (CreditDimValue[I] = "Shortcut Dimension 1 Code"))
                                      OR (CreditAccNo[I] = '')
                                   THEN BEGIN
                                     CreditAccNo[I] := CreditAccount;
                                     GLAcc.GET(CreditAccNo[I]);
                                     CreditAccName[I] := GLAcc.Name;
                                     CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)");
                                     CreditDimValue[I] := "Shortcut Dimension 1 Code";
                                     MatchAcc := TRUE;
                                     //xxx +
                                     IF VATAccount <> '' THEN BEGIN
                                       CreditAmount[I] := CreditAmount[I] - VATAmount;
                                       GLAcc.GET(VATAccount);
                                       CreditVATName[I] := GLAcc.Name;
                                       CreditVATNo[I] := VATAccount;
                                       CreditVATAmt[I] += VATAmount;
                                     END;
                                     //xxx -
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                                 //}

                                 IF "Bal. Account No." <> '' THEN BEGIN
                                   //xxx +
                                   CLEAR(VATAccount);
                                   CLEAR(VATAmount);
                                   //xxx -
                                   CLEAR(DebitAccount);
                                   CASE "Bal. Account Type" OF
                                     "Bal. Account Type"::"G/L Account":
                                       BEGIN
                                         DebitAccount := "Bal. Account No.";
                                         //xxx +
                                         IF VATPostSetup.GET("Bal. VAT Bus. Posting Group","Bal. VAT Prod. Posting Group") THEN BEGIN
                                           VATAccount := VATPostSetup."Purchase VAT Account";
                                           //VATAmount := ROUND(VATPostSetup."VAT %" * (100 + VATPostSetup."VAT %") / "Credit Amount");
                                           VATAmount := ROUND(VATPostSetup."VAT %" * "Credit Amount" / (100 + VATPostSetup."VAT %"));
                                         END;
                                         //xxx -
                                       END;
                                     "Bal. Account Type"::Customer:
                                       BEGIN
                                         CustPostingGroup.GET("Posting Group");
                                         DebitAccount := CustPostingGroup."Receivables Account";
                                       END;
                                     "Bal. Account Type"::Vendor:
                                       BEGIN
                                         VendPostingGroup.GET("Posting Group");
                                         DebitAccount := VendPostingGroup."Payables Account";
                                       END;
                                     "Bal. Account Type"::"Bank Account":
                                       BEGIN
                                         BankAcc.GET("Bal. Account No.");
                                         BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                         DebitAccount := BankAccPostingGroup."G/L Bank Account No.";
                                       END;
                                   END;
                                   I := 0;
                                   MatchAcc := FALSE;
                                   REPEAT
                                     I := I + 1;
                                     IF ((CreditAccNo[I] = DebitAccount)) //AND (CreditDimValue[I] = "Shortcut Dimension 1 Code"))
                                        OR (CreditAccNo[I] = '')
                                     THEN BEGIN
                                       CreditAccNo[I] := DebitAccount;
                                       GLAcc.GET(CreditAccNo[I]);
                                       CreditAccName[I] := GLAcc.Name;
                                       CreditAmount[I] := CreditAmount[I] - ABS("Amount (LCY)") + VATAmount; //xxx
                                       CreditDimValue[I] := "Shortcut Dimension 1 Code";
                                       MatchAcc := TRUE;
                                     END;
                                   UNTIL (I>=300) OR MatchAcc;
                                   //xxx +
                                   IF MatchAcc AND (VATAccount <> '') THEN BEGIN
                                     I := 0;
                                     MatchAcc := FALSE;
                                     REPEAT
                                       I := I + 1;
                                       IF (DebitVATNo[I] = VATAccount) OR (DebitVATNo[I] = '') THEN BEGIN
                                         GLAcc.GET(VATAccount);
                                         DebitVATName[I] := GLAcc.Name;
                                         DebitVATNo[I] := VATAccount;
                                         DebitVATAmt[I] += VATAmount;
                                         MatchAcc := TRUE;
                                       END;
                                     UNTIL (I>=300) OR MatchAcc;
                                   END;
                                   //xxx -
                                 END;
                               END;

                               IF ("Applies-to Doc. No." <> '') OR ("Applies-to ID" <> '') THEN BEGIN
                                 WHTEntry.RESET;
                                 WHTEntry.SETCURRENTKEY("Transaction Type","Document No.","Document Type","Bill-to/Pay-to No.");
                                 IF "Applies-to Doc. Type"="Applies-to Doc. Type"::Invoice THEN
                                   WHTEntry.SETRANGE("Document Type",WHTEntry."Document Type"::Invoice);
                                 IF "Applies-to Doc. Type"="Applies-to Doc. Type"::"Credit Memo" THEN
                                   WHTEntry.SETRANGE("Document Type",WHTEntry."Document Type"::"Credit Memo");
                                 //WHTEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                 IF "Applies-to Doc. No." <> '' THEN
                                   WHTEntry.SETRANGE("Document No.","Applies-to Doc. No.")
                                 ELSE BEGIN
                                   IF "Applies-to ID" <> '' THEN BEGIN
                                     {---
                                     VendLedgEntry.RESET;
                                     VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                     IF VendLedgEntry.FIND('-') THEN
                                     REPEAT
                                       IF DocNoFilter = '' THEN
                                         DocNoFilter := VendLedgEntry."Document No."
                                       ELSE BEGIN
                                         IF STRLEN(DocNoFilter + '|' + VendLedgEntry."Document No.") <= 250 THEN
                                           DocNoFilter := DocNoFilter + '|' + VendLedgEntry."Document No."
                                         ELSE
                                           DocNoFilter2 := DocNoFilter2 + '|' + VendLedgEntry."Document No.";
                                       END;
                                     UNTIL VendLedgEntry.NEXT=0;
                                     IF DocNoFilter <> '' THEN BEGIN
                                       IF DocNoFilter2 = '' THEN
                                         WHTEntry.SETFILTER("Document No.",DocNoFilter)
                                       ELSE
                                         WHTEntry.SETFILTER("Document No.",'%1|%2',DocNoFilter,DocNoFilter2);
                                     END;
                                     ---}
                                     WHTEntry.SETFILTER("Applies-to ID","Applies-to ID");  //KKE : #003
                                   END;
                                   IF "Account Type" = "Account Type"::Vendor THEN
                                     WHTEntry.SETRANGE("Bill-to/Pay-to No.","Account No.")
                                   ELSE IF "Bal. Account Type" = "Bal. Account Type"::Vendor THEN
                                     WHTEntry.SETRANGE("Bill-to/Pay-to No.","Bal. Account No.");
                                 END;
                                 IF WHTEntry.FIND('-') THEN
                                   REPEAT
                                     IF WHTPostingSetup.GET(WHTEntry."WHT Bus. Posting Group",WHTEntry."WHT Prod. Posting Group") THEN BEGIN
                                       IF GLAcc.GET(WHTPostingSetup."Payable WHT Account Code") THEN BEGIN //GKU : #005
                                         WHTAccountNo := WHTPostingSetup."Payable WHT Account Code";
                                         WHTAccountName := GLAcc.Name;
                                       END;
                                     END;
                                     {PayPer := 0;
                                     IF WHTEntry."Base Amount Inc. VAT (LCY)" <> 0 THEN
                                       PayPer := ABS("Amount (LCY)"/ WHTEntry."Base Amount Inc. VAT (LCY)");
                                     IF PayPer > 1 THEN
                                       PayPer := 1;
                                     //CreditWHTAmt := CreditWHTAmt + -(WHTEntry."WHT Amount (LCY)" * PayPer);
                                     }
                                   UNTIL WHTEntry.NEXT=0;

                                 IF "WHT Payment" THEN BEGIN
                                   IF "Account Type" = "Account Type"::Customer THEN BEGIN
                                     CustLedgEntry.RESET;
                                     CustLedgEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open,Positive,"Due Date");
                                     CustLedgEntry.SETRANGE("Customer No.","Account No.");
                                     IF "Applies-to ID" <> '' THEN
                                       CustLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                     IF ("Applies-to Doc. Type" <> 0) AND ("Applies-to Doc. No." <> '') THEN BEGIN
                                       CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                       CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                     END;
                                     IF CustLedgEntry.FIND('-') THEN BEGIN
                                       SalesInvLine.RESET;
                                       SalesInvLine.SETRANGE("Document No.",CustLedgEntry."Document No.");
                                       SalesInvLine.SETFILTER("WHT Product Posting Group",'<>%1','');
                                       IF SalesInvLine.FIND('-') THEN
                                         IF WHTPostingSetup.GET(SalesInvLine."WHT Business Posting Group",SalesInvLine."WHT Product Posting Group") THEN BEGIN
                                           WHTAccountNo := WHTPostingSetup."Prepaid WHT Account Code";
                                         IF GLAcc.GET(WHTAccountNo) THEN
                                           WHTAccountName := GLAcc.Name;
                                       END;
                                     END;
                                   END ELSE
                                     IF "Bal. Account Type"::Customer = "Bal. Account Type"::Customer THEN BEGIN
                                       CustLedgEntry.RESET;
                                       CustLedgEntry.SETCURRENTKEY("Customer No.","Applies-to ID",Open,Positive,"Due Date");
                                       CustLedgEntry.SETRANGE("Customer No.","Bal. Account No.");
                                       IF "Applies-to ID" <> '' THEN
                                         CustLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                       IF ("Applies-to Doc. Type" <> 0) AND ("Applies-to Doc. No." <> '') THEN BEGIN
                                         CustLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                         CustLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                       END;
                                       IF CustLedgEntry.FIND('-') THEN BEGIN
                                         SalesInvLine.RESET;
                                         SalesInvLine.SETRANGE("Document No.",CustLedgEntry."Document No.");
                                         SalesInvLine.SETFILTER("WHT Product Posting Group",'<>%1','');
                                         IF SalesInvLine.FIND('-') THEN
                                           IF WHTPostingSetup.GET(SalesInvLine."WHT Business Posting Group",SalesInvLine."WHT Product Posting Group")
                                           THEN BEGIN
                                             WHTAccountNo := WHTPostingSetup."Prepaid WHT Account Code";
                                             IF GLAcc.GET(WHTAccountNo) THEN
                                               WHTAccountName := GLAcc.Name;
                                           END;
                                       END;
                                     END;
                                   WHTAmt := ABS(Amount);
                                 END;
                                 //CreditWHTAmt := CreditWHTAmt + ABS(WHTManagement.WHTAmountJournal(GenJnlLine2,FALSE));

                                 CLEAR(WHTManagement);
                                 GenJnlLine3 := GenJnlLine2;
                                 GenJnlLine3.VALIDATE(Amount,-GenJnlLine3.Amount);
                                 CreditWHTAmt := CreditWHTAmt + WHTManagement.WHTAmountJournal(GenJnlLine3,FALSE);
                               END;

                               // Unrealize VAT
                               //KKE +
                               ApplyCreditAmount := 0;
                               ApplyInvoiceAmount := 0;
                               IF "Applies-to ID" <> '' THEN BEGIN
                                 VendLedgEntry.RESET;
                                 VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                 VendLedgEntry.SETRANGE("Document Type",VendLedgEntry."Document Type"::"Credit Memo");
                                 IF VendLedgEntry.FIND('-') THEN
                                 REPEAT
                                   VendLedgEntry.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)");
                                   ApplyCreditAmount := ApplyCreditAmount + VendLedgEntry."Remaining Amt. (LCY)";
                                 UNTIL VendLedgEntry.NEXT=0;
                                 VendLedgEntry.RESET;
                                 VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                 VendLedgEntry.SETFILTER("Document Type",'<>%1',VendLedgEntry."Document Type"::"Credit Memo");
                                 IF VendLedgEntry.FIND('-') THEN
                                 REPEAT
                                   VendLedgEntry.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)");
                                   ApplyInvoiceAmount := ApplyInvoiceAmount + VendLedgEntry."Remaining Amt. (LCY)";
                                 UNTIL VendLedgEntry.NEXT=0;
                               END;

                               IF (ApplyInvoiceAmount <> 0) AND (ApplyCreditAmount <> 0) THEN
                                 PaymentAmount := ABS("Amount (LCY)") + ApplyCreditAmount
                               ELSE
                                 PaymentAmount := "Amount (LCY)";
                               //KKE -

                               IF ("Applies-to Doc. No." <> '') OR ("Applies-to ID" <> '') THEN BEGIN
                                 VendLedgEntry.RESET;
                                 IF "Applies-to Doc. No." <> '' THEN
                                   VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.")
                                 ELSE IF "Applies-to ID" <> '' THEN
                                   VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                                 IF VendLedgEntry.FIND('-') THEN
                                 REPEAT
                                   PayPer := 0;
                                   VendLedgEntry.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)","Remaining Amount");
                                   IF VendLedgEntry."Remaining Amt. (LCY)" <> 0 THEN
                                     IF VendLedgEntry."Amount to Apply" <> VendLedgEntry."Remaining Amount" THEN BEGIN
                                       g_intPatial := 9;
                                       g_decRatioPatial := VendLedgEntry."Amount to Apply"/ VendLedgEntry."Remaining Amount";
                                       PayPer := VendLedgEntry."Amount to Apply"/ VendLedgEntry."Remaining Amount";
                                     END ELSE
                                       PayPer := ABS(PaymentAmount / VendLedgEntry."Remaining Amt. (LCY)");

                                   IF PayPer > 1 THEN
                                     PayPer := 1;

                                   //VAT unrealize for applied entry  ESG-19.02.04 Start
                                   DebitAppliedVATAmt := 0;
                                   CreditAppliedVATAmt := 0;
                                   IF VendLedgEntry."Amount (LCY)" <> VendLedgEntry."Remaining Amt. (LCY)" THEN BEGIN
                                     VendLedgEntry2.RESET;
                                     VendLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                                     VendLedgEntry2.SETRANGE("Closed by Entry No.",VendLedgEntry."Entry No.");
                                     IF VendLedgEntry2.FIND('-') THEN
                                     REPEAT
                                       VATEntry.RESET;
                                       VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                                       VATEntry.SETRANGE("Posting Date",VendLedgEntry2."Posting Date");
                                       VATEntry.SETRANGE("Document No.",VendLedgEntry2."Document No.");
                                       VATEntry.SETFILTER("Remaining Unrealized Amount",'<>0');
                                       IF VATEntry.FIND('-') THEN
                                       REPEAT
                                        DebitAppliedVATAmt := DebitAppliedVATAmt + VATEntry."Remaining Unrealized Amount";
                                        CreditAppliedVATAmt := CreditAppliedVATAmt + VATEntry."Remaining Unrealized Amount";

                                       UNTIL VATEntry.NEXT=0;
                                     UNTIL VendLedgEntry2.NEXT=0;
                                   END;
                                   //VAT unrealize for applied entry  ESG-19.02.04 End.

                                   VATEntry.RESET;
                                   VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                                   VATEntry.SETRANGE("Posting Date",VendLedgEntry."Posting Date");
                                   VATEntry.SETRANGE("Document No.",VendLedgEntry."Document No.");
                                   VATEntry.SETFILTER("Remaining Unrealized Amount",'<>0');
                                   IF VATEntry.FIND('-') THEN
                                   REPEAT
                                     VATPostSetup.GET(VATEntry."VAT Bus. Posting Group",VATEntry."VAT Prod. Posting Group");
                                     DebitAccount := VATPostSetup."Purchase VAT Account";
                                     CreditAccount := VATPostSetup."Purch. VAT Unreal. Account";
                                     I := 0;
                                     MatchAcc := FALSE;
                                     REPEAT
                                     I := I + 1;
                                       IF ((DebitVATNo[I] = DebitAccount)) //AND (DebitVATDimValue[I] = "Shortcut Dimension 1 Code"))
                                          OR (DebitVATNo[I] = '')
                                       THEN BEGIN
                                         DebitVATNo[I] := DebitAccount;
                                         GLAcc.GET(DebitVATNo[I]);
                                         DebitVATName[I] := GLAcc.Name;

                                        {---
                                         IF g_intPatial = 9 THEN
                                           DebitVATAmt[I] := DebitVATAmt[I] +
                                                (VATEntry."Remaining Unrealized Amount" + DebitAppliedVATAmt) * g_decRatioPatial
                                         ELSE
                                         ---}
                                           DebitVATAmt[I] := DebitVATAmt[I] +
                                                (VATEntry."Remaining Unrealized Amount" + DebitAppliedVATAmt) * PayPer;

                                         DebitAppliedVATAmt := 0;
                                         DebitVATDimValue[I] := "Shortcut Dimension 1 Code";
                                         MatchAcc := TRUE;
                                       END;
                                       IF ((CreditVATNo[I] = CreditAccount)) //AND (CreditVATDimValue[I] = "Shortcut Dimension 1 Code"))
                                          OR (CreditVATNo[I] = '')
                                       THEN BEGIN
                                         CreditVATNo[I] := CreditAccount;
                                         GLAcc.GET(CreditVATNo[I]);
                                         CreditVATName[I] := GLAcc.Name;
                                         {---
                                         IF g_intPatial = 9 THEN
                                           CreditVATAmt[I] := CreditVATAmt[I] +
                                               (VATEntry."Remaining Unrealized Amount" + CreditAppliedVATAmt) * g_decRatioPatial
                                         ELSE
                                         ---}
                                           CreditVATAmt[I] := CreditVATAmt[I] +
                                               (VATEntry."Remaining Unrealized Amount" + CreditAppliedVATAmt) * PayPer;
                                         CreditAppliedVATAmt := 0;
                                         CreditVATDimValue[I] := "Shortcut Dimension 1 Code";
                                         MatchAcc := TRUE;
                                       END;
                                     UNTIL (I>=300) OR MatchAcc;
                                   UNTIL VATEntry.NEXT=0;
                                 UNTIL VendLedgEntry.NEXT = 0;
                               END;


                           //Applies to ID
                           IF "Applies-to ID" <> '' THEN BEGIN
                             VendLedgerEntry.RESET;
                             VendLedgerEntry.SETCURRENTKEY("Vendor No.","Applies-to ID",Open,Positive,"Due Date");
                             IF "Account Type" = "Account Type"::Vendor THEN
                               VendLedgerEntry.SETRANGE("Vendor No.","Account No.");
                             IF "Bal. Account Type" = "Bal. Account Type"::Vendor THEN
                               VendLedgerEntry.SETRANGE("Vendor No.","Bal. Account No.");
                             VendLedgerEntry.SETRANGE("Applies-to ID","Applies-to ID");
                             IF VendLedgerEntry.FIND('-') THEN
                               REPEAT
                                 VendLedgerEntrybuffer := VendLedgerEntry;
                                 VendLedgerEntrybuffer.MARK(TRUE);
                               UNTIL VendLedgerEntry.NEXT = 0 ;
                           END;

                           //Apply to Doc no.
                           IF "Applies-to Doc. No." <> '' THEN BEGIN
                             VendLedgerEntry.RESET;
                             VendLedgerEntry.SETCURRENTKEY("Vendor No.","Applies-to ID",Open,Positive,"Due Date");
                             IF "Account Type" = "Account Type"::Vendor THEN
                               VendLedgerEntry.SETRANGE("Vendor No.","Account No.");
                             IF "Bal. Account Type" = "Bal. Account Type"::Vendor THEN
                               VendLedgerEntry.SETRANGE("Vendor No.","Bal. Account No.");
                               VendLedgerEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                               VendLedgerEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                             IF VendLedgerEntry.FIND('-') THEN
                               REPEAT
                                 VendLedgerEntrybuffer := VendLedgerEntry;
                                 VendLedgerEntrybuffer.MARK(TRUE);
                               UNTIL VendLedgerEntry.NEXT = 0 ;
                           END;
                             END;
                           UNTIL GenJnlLine2.NEXT=0;

                           IF "Check Printed" THEN BEGIN
                             DocumentNo := "External Document No.";
                             CheckNo := "Document No.";
                             CheckDate := "Posting Date";
                           END ELSE BEGIN
                             DocumentNo := "Document No.";
                             CheckNo := StartingChequeNo;
                             CheckDate := 0D;
                             IF StartingChequeNo <> '' THEN
                               CheckDate := "Posting Date";
                           END;
                         END;

        ReqFilterFields=Journal Template Name,Journal Batch Name,Document No.;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=3800;
            OnPreSection=BEGIN
                           Line := 0;
                           IF CurrReport.PAGENO > 1 THEN
                             TextPageNo := STRSUBSTNO('Page %1',CurrReport.PAGENO);
                         END;

          }
          CONTROLS
          {
            { 1000000061;TextBox;11400;50   ;7450 ;850  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000135;Label  ;14700;2600 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=No......................................... }
            { 1000000136;TextBox;15450;2500 ;3500 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=DocumentNo }
            { 1000000141;Label  ;14700;3150 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Date...................................... }
            { 1000000142;TextBox;15500;3150 ;3250 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TODAY }
            { 1000000062;Label  ;7700 ;1650 ;4900 ;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=PAYMENT VOUCHER }
            { 1000000047;TextBox;0    ;0    ;9700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000055;TextBox;0    ;600  ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" }
            { 1000000060;TextBox;0    ;1200 ;7550 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000064;TextBox;0    ;1800 ;7550 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr='Tel: ' + CompanyInfo."Phone No." + ' Fax: ' + CompanyInfo."Fax No." }
            { 1000000143;TextBox;14800;1900 ;4050 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextPageNo }
            { 1000000145;TextBox;11400;1100 ;7450 ;500  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19400;
            SectionHeight=4330;
            OnPreSection=BEGIN
                           DebitAmt := 0;
                           CreditAmt := 0;
                           xGenJnlLine.RESET;
                           xGenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                           xGenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                           xGenJnlLine.SETRANGE("Document No.","Document No.");
                           IF xGenJnlLine.FIND('-') THEN BEGIN
                             REPEAT
                               IF (xGenJnlLine."Account Type" = xGenJnlLine."Account Type"::"Bank Account") OR
                                  ((xGenJnlLine."Bal. Account Type" = xGenJnlLine."Bal. Account Type"::"Bank Account") AND
                                  (xGenJnlLine."Bal. Account No." <> ''))
                               THEN BEGIN
                                 DebitAmt := DebitAmt + xGenJnlLine."Debit Amount";
                                 CreditAmt := CreditAmt + xGenJnlLine."Credit Amount";

                                 IF (xGenJnlLine."Account Type" = xGenJnlLine."Account Type"::Vendor) OR
                                    (xGenJnlLine."Bal. Account Type" = xGenJnlLine."Bal. Account Type"::Vendor)
                                 THEN BEGIN
                                   IF NOT Vendor.GET(xGenJnlLine."Account No.") THEN
                                     IF NOT Vendor.GET(xGenJnlLine."Bal. Account No.") THEN
                                       CLEAR(Vendor);
                                   IF Vendor."Name (Thai)" <> '' THEN
                                     VendName := Vendor."No." + '   ' + Vendor."Name (Thai)"
                                   ELSE
                                     VendName := Vendor."No." + '   ' + Vendor.Name + Vendor."Name 2";
                                   PayeeName := "Payee Name";
                                 END ELSE BEGIN
                                   VendName := "Payee Name";
                                   PayeeName := "Payee Name";
                                 END;

                                 IF xGenJnlLine."Account Type" = xGenJnlLine."Account Type"::"Bank Account" THEN BEGIN
                                   BankName := xGenJnlLine."Account No.";
                                   BankAcc.GET(xGenJnlLine."Account No.");
                                   BankBranch := BankAcc."Bank Branch No.";
                                 END;
                                 IF xGenJnlLine."Bal. Account Type" = xGenJnlLine."Bal. Account Type"::"Bank Account" THEN BEGIN
                                   BankName := xGenJnlLine."Bal. Account No.";
                                   BankAcc.GET(xGenJnlLine."Bal. Account No.");
                                   BankBranch := BankAcc."Bank Branch No.";
                                 END;
                               END;
                             UNTIL xGenJnlLine.NEXT=0;

                             IF DebitAmt = 0 THEN
                               TotalAmt := CreditAmt + CreditWHTAmt + WHTAmt
                             ELSE
                               TotalAmt := (DebitAmt - CreditAmt) + CreditWHTAmt + WHTAmt;
                             DebitAmt := 0;
                             CreditAmt := 0;
                           END;

                           CheckReport.InitTextVariable;
                           CheckReport.FormatNoText(TextAmount,ABS(TotalAmt),"Currency Code");

                           IF TextAmount[1] <> '' THEN
                             TextAmount[1] := FORMAT(ABS(TotalAmt),0,'<Precision,2:2><Standard Format,0>') + '   (' + TextAmount[1] + ')';
                         END;

          }
          CONTROLS
          {
            { 1000000096;Shape  ;0    ;0    ;30   ;4330 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000063;Label  ;150  ;150  ;10350;550  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Paid to................................................................................................................... }
            { 1000000147;TextBox;1250 ;100  ;9100 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VendName }
            { 1000000119;Label  ;13450;850  ;5600 ;550  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Payment Date........................................ }
            { 1000000120;TextBox;15600;800  ;3300 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Posting Date" }
            { 1000000033;Shape  ;19230;0    ;30   ;4330 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000083;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000085;Shape  ;0    ;3600 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000125;Label  ;16100;3650 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000127;Label  ;12800;3650 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Input VAT }
            { 1000000129;Label  ;10000;3650 ;2320 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Goods/Service }
            { 1000000131;Label  ;1450 ;3650 ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description }
            { 1000000090;Shape  ;0    ;4300 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000110;Shape  ;9500 ;3600 ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000115;Shape  ;12630;3600 ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000116;Shape  ;15850;3600 ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000017;Label  ;10750;150  ;8320 ;550  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Payee Name....................................................................................... }
            { 1000000180;TextBox;12450;100  ;6410 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PayeeName }
            { 1000000234;Label  ;150  ;850  ;13150;550  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=For Payment of ................................................................................................................................ }
            { 1000000235;TextBox;2450 ;800  ;10500;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Description }
            { 1000000000;Label  ;150  ;1500 ;18870;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Amount ..................................................................................................................................................................................................... }
            { 1000000004;TextBox;1450 ;1500 ;17480;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextAmount[1] }
            { 1000000069;Label  ;150  ;2300 ;660  ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=By : }
            { 1000000087;Shape  ;900  ;2350 ;450  ;423   }
            { 1000000088;TextBox;960  ;2350 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCash }
            { 1000000068;Label  ;1420 ;2300 ;900  ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CASH }
            { 1000000084;TextBox;2450 ;2350 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCheque }
            { 1000000086;Shape  ;2350 ;2350 ;450  ;423   }
            { 1000000067;Label  ;2920 ;2300 ;1770 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Check/ Draft }
            { 1000000095;Label  ;5100 ;2200 ;7000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Bank.......................................................................................... }
            { 1000000100;TextBox;5950 ;2200 ;5550 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=BankName }
            { 1000000097;Label  ;5100 ;2850 ;7000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Branch........................................................................ }
            { 1000000101;TextBox;6200 ;2850 ;5300 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=BankBranch }
            { 1000000122;Label  ;12950;2850 ;6000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Date................................................................. }
            { 1000000124;TextBox;14000;2850 ;2900 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CheckDate }
            { 1000000103;Label  ;12950;2200 ;6000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Check No........................................................ }
            { 1000000121;TextBox;14450;2200 ;4050 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CheckNo }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=700;
            OnPreSection=BEGIN
                           CheckReport.InitTextVariable;
                           CheckReport.FormatNoText(TextAmount,ABS(DebitTotalLCY),"Currency Code");

                           IF TextAmount[1] <> '' THEN
                             TextAmount[1] := '(' + TextAmount[1] + ')';
                         END;

          }
          CONTROLS
          {
            { 1000000093;TextBox;12750;100  ;3000 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitTotalLCY }
            { 1000000094;TextBox;16000;100  ;3110 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditTotalLCY }
            { 1000000099;Shape  ;12580;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000102;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000153;Label  ;11300;100  ;1150 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total }
            { 1000000019;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000034;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000036;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000046;TextBox;100  ;100  ;11150;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextAmount[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=4580;
            OnPreSection=BEGIN
                           DebitTotalLCY := 0;
                           CreditTotalLCY := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000158;Label  ;150  ;150  ;2075 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Remark }
            { 1000000201;Label  ;6750 ;2650 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000210;Label  ;6750 ;3800 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000078;Label  ;16000;3800 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000050;Shape  ;0    ;0    ;30   ;4550 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000051;Shape  ;19230;0    ;30   ;4550 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000065;Shape  ;0    ;4550 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000107;Shape  ;0    ;2150 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000172;Shape  ;0    ;3350 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000175;Shape  ;9625 ;2150 ;30   ;2400 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000013;Label  ;10200;2650 ;2275 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Checked By : }
            { 1000000022;Label  ;10200;3800 ;2335 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved By : }
            { 1000000025;Label  ;550  ;3800 ;2045 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Received By : }
            { 1000000035;Label  ;550  ;2650 ;2075 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By : }
            { 1000000042;Label  ;16000;2650 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000037;Shape  ;15   ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table25;
        DataItemTableView=SORTING(Entry No.);
        DataItemVarName=VendLedgerEntrybuffer2;
        OnPreDataItem=BEGIN
                        //TSA
                        VendLedgerEntrybuffer.MARKEDONLY(TRUE);
                        IF VendLedgerEntrybuffer.FIND('-') THEN
                        REPEAT
                           VendLedgerEntrybuffer2 := VendLedgerEntrybuffer ;
                           VendLedgerEntrybuffer2.MARK(TRUE);
                        UNTIL VendLedgerEntrybuffer.NEXT = 0
                        ELSE
                          ShowBlank := TRUE;
                        MARKEDONLY(TRUE);
                        //TSA

                        totCreditVATAmtTmp := 0 ;
                        totAmounttoApply := 0;
                      END;

        OnAfterGetRecord=VAR
                           DebitAppliedVATAmtTmp@1000000000 : Decimal;
                           CreditAppliedVATAmtTmp@1000000001 : Decimal;
                         BEGIN
                                  {--- Not Delete
                                   PayPer := 0;
                                   VendLedgerEntrybuffer2.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)","Remaining Amount");
                                   IF VendLedgerEntrybuffer2."Remaining Amt. (LCY)" <> 0 THEN
                                     IF (VendLedgerEntrybuffer2."Amount to Apply" <> VendLedgerEntrybuffer2."Remaining Amt. (LCY)") AND
                                        (VendLedgerEntrybuffer2."Amount to Apply" <> 0)THEN BEGIN
                                       PayPer := VendLedgerEntrybuffer2."Amount to Apply"/ VendLedgerEntrybuffer2."Remaining Amt. (LCY)"
                                     END ELSE
                                       PayPer := 1;

                                   IF PayPer > 1 THEN
                                     PayPer := 1;

                                   //VAT unrealize for applied entry

                                   CreditAppliedVATAmtTmp := 0;
                                   CreditVATAmtTmp := 0 ;

                                   IF VendLedgerEntrybuffer2."Amount (LCY)" <> VendLedgerEntrybuffer2."Remaining Amt. (LCY)" THEN BEGIN
                                     VendLedgEntry2.RESET;
                                     VendLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                                     VendLedgEntry2.SETRANGE("Closed by Entry No.",VendLedgerEntrybuffer2."Entry No.");
                                     IF VendLedgEntry2.FIND('-') THEN
                                     REPEAT
                                       VATEntry.RESET;
                                       VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                                       VATEntry.SETRANGE("Posting Date",VendLedgEntry2."Posting Date");
                                       VATEntry.SETRANGE("Document No.",VendLedgEntry2."Document No.");
                                       //VATEntry.SETFILTER("Remaining Unrealized Amount",'<>0');
                                       IF VATEntry.FIND('-') THEN
                                       REPEAT
                                        //DebitAppliedVATAmtTmp := DebitAppliedVATAmtTmp + VATEntry."Remaining Unrealized Amount";
                                        CreditAppliedVATAmtTmp := CreditAppliedVATAmtTmp + VATEntry."Remaining Unrealized Amount";
                                       UNTIL VATEntry.NEXT=0;
                                     UNTIL VendLedgEntry2.NEXT=0;
                                   END;
                                   //VAT unrealize for applied entry

                                   VATEntry.RESET;
                                   VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                                   VATEntry.SETRANGE("Posting Date",VendLedgerEntrybuffer2."Posting Date");
                                   VATEntry.SETRANGE("Document No.",VendLedgerEntrybuffer2."Document No.");
                                   //VATEntry.SETFILTER("Remaining Unrealized Amount",'<>0');
                                   IF VATEntry.FIND('-') THEN
                                   REPEAT
                                     IF VATEntry."Remaining Unrealized Amount" <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp +
                                               (VATEntry."Remaining Unrealized Amount" + CreditAppliedVATAmtTmp) * PayPer;
                                         CreditAppliedVATAmtTmp := 0;
                                     END;
                                     IF VATEntry.Amount <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp +
                                               (VATEntry.Amount + CreditAppliedVATAmtTmp) * PayPer;
                                         CreditAppliedVATAmtTmp := 0;
                                     END;

                                   UNTIL VATEntry.NEXT=0;

                                   CLEAR(AmounttoApply);
                                   IF VendLedgerEntrybuffer2."Amount to Apply" <> 0 THEN
                                     AmounttoApply := (-1) * VendLedgerEntrybuffer2."Amount to Apply"
                                   ELSE
                                     AmounttoApply := (-1) * VendLedgerEntrybuffer2."Remaining Amt. (LCY)" ;

                                   totAmounttoApply +=  AmounttoApply ;
                                   totCreditVATAmtTmp := totCreditVATAmtTmp + CreditVATAmtTmp ;

                                   ---Not Delete}


                                   VendLedgerEntrybuffer2.CALCFIELDS("Amount (LCY)","Remaining Amt. (LCY)","Remaining Amount",
                                     "Original Amt. (LCY)");
                                   CreditAppliedVATAmtTmp := 0;
                                   CreditVATAmtTmp := 0 ;
                                   PayPer := 1 ;
                                   VATEntry.RESET;
                                   VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                                   VATEntry.SETRANGE("Posting Date",VendLedgerEntrybuffer2."Posting Date");
                                   VATEntry.SETRANGE("Document No.",VendLedgerEntrybuffer2."Document No.");
                                   //VATEntry.SETFILTER("Remaining Unrealized Amount",'<>0');
                                   IF VATEntry.FIND('-') THEN
                                   REPEAT
                                     IF VATEntry.Amount <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp + VATEntry.Amount;

                                         CreditAppliedVATAmtTmp := 0;
                                     END;
                                     IF VATEntry."Remaining Unrealized Amount" <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp + VATEntry."Remaining Unrealized Amount";
                                         CreditAppliedVATAmtTmp := 0;
                                     END;

                                   UNTIL VATEntry.NEXT=0;

                           CreditMemoVendLedgerEntry.SETRANGE("Closed by Entry No.",VendLedgerEntrybuffer2."Entry No.");
                           IF CreditMemoVendLedgerEntry.FIND('-') THEN
                           REPEAT
                                   VATEntry.RESET;
                                   VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                                   VATEntry.SETRANGE("Posting Date",CreditMemoVendLedgerEntry."Posting Date");
                                   VATEntry.SETRANGE("Document No.",CreditMemoVendLedgerEntry."Document No.");
                                   IF VATEntry.FIND('-') THEN
                                   REPEAT
                                     IF VATEntry.Amount <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp + VATEntry.Amount;
                                         CreditAppliedVATAmtTmp := 0;
                                     END;
                                     IF VATEntry."Remaining Unrealized Amount" <> 0 THEN
                                     BEGIN
                                         CreditVATAmtTmp := CreditVATAmtTmp + VATEntry."Remaining Unrealized Amount";
                                         CreditAppliedVATAmtTmp := 0;
                                     END;

                                   UNTIL VATEntry.NEXT=0;

                           UNTIL CreditMemoVendLedgerEntry.NEXT=0;

                                   //totAmounttoApply += (-1) * VendLedgerEntrybuffer2."Original Amt. (LCY)" ;
                                   totAmounttoApply += (-1) * VendLedgerEntrybuffer2."Amount to Apply" ;
                                   totCreditVATAmtTmp := totCreditVATAmtTmp + CreditVATAmtTmp ;
                         END;

        TotalFields=Amount to Apply;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19400;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000140;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000150;Label  ;1450 ;50   ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description }
            { 1000000151;Label  ;10000;50   ;2320 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Goods/Service }
            { 1000000152;Label  ;12800;50   ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Input VAT }
            { 1000000155;Label  ;16100;50   ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000161;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000167;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000168;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000169;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000170;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000171;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=730;
            OnPreSection=BEGIN
                           IF CntLine > 25 THEN
                             CntLine := 1
                           ELSE
                             CntLine += 1;
                         END;

          }
          CONTROLS
          {
            { 1000000123;TextBox;400  ;50   ;9050 ;600  ;FontSize=8;
                                                         SourceExpr=Description + '   #' +"External Document No." }
            { 1000000138;TextBox;9650 ;50   ;2850 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-VendLedgerEntrybuffer2."Amount to Apply"-CreditVATAmtTmp }
            { 1000000074;TextBox;12800;50   ;2900 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATAmtTmp }
            { 1000000076;TextBox;16050;50   ;3050 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-VendLedgerEntrybuffer2."Amount to Apply" }
            { 1000000149;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000154;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000156;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000157;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000159;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000160;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=VendLEFooter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=730;
            OnPreSection=BEGIN
                           IF ShowBlank = TRUE THEN
                             CurrReport.SHOWOUTPUT(TRUE)
                           ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000077;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000082;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000089;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000092;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000132;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000133;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=2180;
          }
          CONTROLS
          {
            { 1000000066;Label  ;150  ;850  ;12900;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Case of Witholding tax.............................Rate........%.....................From.............................. }
            { 1000000071;Label  ;4650 ;0    ;1950 ;650  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000091;Label  ;150  ;1450 ;8250 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=(No. Letter of Witholding tax.......................................) }
            { 1000000126;TextBox;6600 ;0    ;2800 ;650  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-VendLedgerEntrybuffer2."Amount to Apply" }
            { 1000000128;TextBox;9650 ;0    ;2850 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=totAmounttoApply-totCreditVATAmtTmp }
            { 1000000130;TextBox;12800;0    ;2900 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=totCreditVATAmtTmp }
            { 1000000134;TextBox;16050;0    ;3050 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=totAmounttoApply }
            { 1000000137;TextBox;150  ;0    ;4400 ;650  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotalItemText }
            { 1000000139;Label  ;13100;850  ;2320 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=WHT Amount }
            { 1000000144;TextBox;16050;750  ;3050 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-CreditWHTAmt;
                                                         AutoFormatType=1 }
            { 1000000148;TextBox;16050;1450 ;3050 ;550  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=[ FORMAT(ABS(TotalAmt),0,'<Precision,2:2><Standard Format,0>')] }
            { 1000000162;Label  ;12850;1550 ;2770 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Net Payment (Baht) }
            { 1000000163;Shape  ;0    ;0    ;30   ;2150 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000165;Shape  ;19230;0    ;30   ;2150 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000185;Shape  ;15850;0    ;30   ;2150 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000186;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000188;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000189;Shape  ;0    ;2150 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000190;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000191;Shape  ;15850;1400 ;3400 ;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000111;Label  ;16050;50   ;3050 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CREDIT }
            { 1000000112;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000113;Label  ;12750;50   ;3000 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DEBIT }
            { 1000000114;Shape  ;12580;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000164;Label  ;3400 ;50   ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Account Name }
            { 1000000118;Shape  ;3000 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000109;Label  ;150  ;50   ;2700 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Account Code }
            { 1000000029;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000031;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000008;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000011;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19400;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000146;Label  ;15450;0    ;3600 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue Next Page. }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitDetail;
        OnPreDataItem=BEGIN
                        //Clear credit amount less than zero.
                        I := 0;
                        REPEAT
                          I := I + 1;
                          IF CreditAmount[I] < 0 THEN BEGIN
                            MatchAcc := FALSE;
                            J := 0;
                            REPEAT
                              J := J + 1;
                              IF DebitAccNo[J] = '' THEN
                                MatchAcc := TRUE;
                            UNTIL (J>=300) OR MatchAcc;
                            IF MatchAcc THEN BEGIN
                              DebitAccNo[J] := CreditAccNo[I];
                              DebitAccName[J] := CreditAccName[I];
                              DebitAmount[J] := -CreditAmount[I];
                              DebitDimValue[J] := CreditDimValue[I];
                              CreditAmount[I] := 0;
                            END;
                          END;
                        UNTIL (I>=300) OR (CreditAccNo[I] = '');

                        //Clear debit amount less than zero.
                        I := 0;
                        REPEAT
                          I := I + 1;
                          IF DebitAmount[I] < 0 THEN BEGIN
                            MatchAcc := FALSE;
                            J := 0;
                            REPEAT
                              J := J + 1;
                              IF CreditAccNo[J] = '' THEN
                                MatchAcc := TRUE;
                            UNTIL (J>=300) OR MatchAcc;
                            IF MatchAcc THEN BEGIN
                              CreditAccNo[J] := DebitAccNo[I];
                              CreditAccName[J] := DebitAccName[I];
                              CreditAmount[J] := -DebitAmount[I];
                              CreditDimValue[J] := DebitDimValue[I];
                              DebitAmount[I] := 0;
                            END;
                          END;
                        UNTIL (I>=300) OR (DebitAccNo[I] = '');

                        //Check balance debit/credit with same g/l account.
                        I := 0;
                        REPEAT
                          I := I + 1;
                          IF DebitAmount[I] > 0 THEN BEGIN
                            MatchAcc := FALSE;
                            J := 0;
                            REPEAT
                              J := J + 1;
                              IF DebitAccNo[I] = CreditAccNo[J] THEN
                                MatchAcc := TRUE;
                            UNTIL (J>=300) OR MatchAcc;
                            IF MatchAcc THEN BEGIN
                              IF DebitAmount[I] >= CreditAmount[J] THEN BEGIN
                                DebitAmount[I] := DebitAmount[I] - CreditAmount[J];
                                CreditAmount[J] := 0;
                              END ELSE BEGIN
                                CreditAmount[J] := CreditAmount[J] - DebitAmount[I];
                                DebitAmount[I] := 0;
                              END;
                            END;
                          END;
                        UNTIL (I>=300) OR (DebitAccNo[I] = '');
                      END;

        OnAfterGetRecord=BEGIN
                           IF DebitAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                           IF DebitAmount[Number] <= 0 THEN
                             CurrReport.SKIP;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           DebitTotalLCY := DebitTotalLCY + DebitAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000001;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccName[Number] }
            { 1000000002;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000003;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccNo[Number] }
            { 1000000005;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000006;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000007;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000009;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000010;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitVATDetail;
        OnAfterGetRecord=BEGIN
                           IF DebitVATNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := DebitVATAmt[Number] <> 0;
                           DebitTotalLCY := DebitTotalLCY + DebitVATAmt[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000030;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVATName[Number] }
            { 1000000038;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVATAmt[Number];
                                                         AutoFormatType=1 }
            { 1000000039;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVATNo[Number] }
            { 1000000040;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000041;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000045;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000049;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=WHTDetail;
        OnAfterGetRecord=BEGIN
                           //KKE : #004 +
                           IF SkipWHT THEN BEGIN
                             WHTAmt := 0;
                             CreditWHTAmt := 0;
                           END;
                           //KKE : #004 -
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(WHTAmt <> 0);
                           IF WHTAmt <> 0 THEN BEGIN
                             Line := Line + 1;
                             DebitTotalLCY := DebitTotalLCY + WHTAmt;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000043;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000044;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAmt;
                                                         AutoFormatType=1 }
            { 1000000075;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000166;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000178;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000179;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000181;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000184;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(CreditWHTAmt > 0);
                           IF CreditWHTAmt > 0 THEN BEGIN
                             Line := Line + 1;
                             DebitTotalLCY := DebitTotalLCY + CreditWHTAmt;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000079;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000080;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditWHTAmt;
                                                         AutoFormatType=1 }
            { 1000000081;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000098;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000105;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000106;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000108;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000117;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(CreditWHTAmt < 0);
                           IF CreditWHTAmt < 0 THEN BEGIN
                             Line := Line + 1;
                             CreditTotalLCY := CreditTotalLCY - CreditWHTAmt;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000052;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000053;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-CreditWHTAmt;
                                                         AutoFormatType=1 }
            { 1000000104;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000212;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000213;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000214;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000216;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000218;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditVATDetail;
        OnAfterGetRecord=BEGIN
                           IF CreditVATNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := CreditVATAmt[Number] <> 0;
                           CreditTotalLCY := CreditTotalLCY + CreditVATAmt[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000054;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATName[Number] }
            { 1000000056;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATAmt[Number];
                                                         AutoFormatType=1 }
            { 1000000057;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATNo[Number] }
            { 1000000058;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000059;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000070;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000072;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000073;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditDetail;
        OnPreDataItem=BEGIN
                        I := 0;
                        MatchAcc := FALSE;
                        REPEAT
                          I := I + 1;
                          IF (CreditAccNo[I] = BankAccNo) AND (CreditAmount[I] <> 0) THEN BEGIN
                            CreditAmount[I] := CreditAmount[I] + CreditWHTAmt;
                            MatchAcc := TRUE;
                          END;
                        UNTIL (I>=300) OR MatchAcc;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number >= 300 THEN
                             CurrReport.BREAK;

                           IF CreditAmount[Number] <= 0 THEN
                             CurrReport.SKIP;
                           IF CreditAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE BEGIN
                             IF NOT MatchAcc THEN BEGIN
                               CreditAmount[Number] := CreditAmount[Number] + CreditWHTAmt;
                               MatchAcc := TRUE;
                             END;
                             Line := Line + 1;
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CreditTotalLCY := CreditTotalLCY + CreditAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000012;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccName[Number] }
            { 1000000014;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000015;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000016;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000018;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000020;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000027;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000028;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccNo[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=LineLoop;
        OnPreDataItem=BEGIN
                        {GenJnlLine3.COPY("Gen. Journal Line");
                        IF GenJnlLine3.NEXT <> 0 THEN
                        IF (GenJnlLine3."Document No." = GenJnlLine2."Document No.") THEN
                          CurrReport.BREAK;  }
                        IF CurrReport.PAGENO = 1 THEN
                          LineSpace := 15
                        ELSE
                          LineSpace := 25;
                      END;

        OnAfterGetRecord=BEGIN
                           IF CntLine + Line + Number > 15 THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000021;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000023;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000024;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000026;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000032;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=11440;
      Height=2200;
      SaveValues=Yes;
      OnInit=BEGIN
               Cash := FALSE;
               Cheque := TRUE;
             END;

    }
    CONTROLS
    {
      { 1000000000;CheckBox;3410;110  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Cash;
                                                   SourceExpr=Cash;
                                                   OnValidate=BEGIN
                                                                IF Cash THEN
                                                                  Cheque := FALSE;
                                                              END;
                                                               }
      { 1000000001;Label  ;110  ;110  ;3190 ;440  ;ParentControl=1000000000 }
      { 1000000002;Label  ;110  ;660  ;3190 ;440  ;ParentControl=1000000003 }
      { 1000000003;CheckBox;3410;660  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Cheque;
                                                   SourceExpr=Cheque;
                                                   OnPush=BEGIN
                                                            IF Cheque THEN
                                                              Cash := FALSE;
                                                          END;
                                                           }
      { 1000000004;TextBox;3410 ;1210 ;3300 ;440  ;CaptionML=ENU=Starting Cheque No.;
                                                   SourceExpr=StartingChequeNo }
      { 1000000005;Label  ;110  ;1210 ;3190 ;440  ;ParentControl=1000000004 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000003 : Record 79;
      Vendor@1000000025 : Record 23;
      VendPostingGroup@1000000036 : Record 93;
      VendLedgEntry@1000000016 : Record 25;
      VendLedgEntry2@1000000075 : Record 25;
      VendLedgerEntrybuffer@1000000028 : Record 25;
      VendLedgerEntry@1000000027 : Record 25;
      CreditMemoVendLedgerEntry@1000000010 : Record 25;
      Customer@1000000026 : Record 18;
      CustPostingGroup@1000000035 : Record 92;
      CustLedgEntry@1000000081 : Record 21;
      GLAcc@1000000022 : Record 15;
      BankAcc@1000000030 : Record 270;
      BankAccPostingGroup@1000000034 : Record 277;
      WHTPostingSetup@1000000085 : Record 28043;
      WHTEntry@1000000015 : Record 28044;
      SalesInvLine@1000000084 : Record 113;
      GenJnlLine@1000000045 : Record 81;
      GenJnlLine2@1000000065 : Record 81;
      GenJnlLine3@1000000042 : Record 81;
      xGenJnlLine@1000000086 : Record 81;
      VATEntry@1000000074 : Record 254;
      VATPostSetup@1000000055 : Record 325;
      CheckReport@1000000004 : Report 1401;
      WHTManagement@1000000005 : Codeunit 28040;
      DebitAccount@1000000054 : Code[20];
      CreditAccount@1000000053 : Code[20];
      DebitAccNo@1000000052 : ARRAY [300] OF Code[20];
      CreditAccNo@1000000051 : ARRAY [300] OF Code[20];
      DebitAccName@1000000050 : ARRAY [300] OF Text[150];
      CreditAccName@1000000049 : ARRAY [300] OF Text[150];
      DebitAmount@1000000021 : ARRAY [300] OF Decimal;
      CreditAmount@1000000020 : ARRAY [300] OF Decimal;
      DebitDimValue@1000000013 : ARRAY [300] OF Code[20];
      CreditDimValue@1000000012 : ARRAY [300] OF Code[20];
      DebitVATDimValue@1000000079 : ARRAY [300] OF Code[20];
      CreditVATDimValue@1000000078 : ARRAY [300] OF Code[20];
      DebitVATNo@1000000067 : ARRAY [300] OF Code[20];
      CreditVATNo@1000000062 : ARRAY [300] OF Code[20];
      DebitVATName@1000000060 : ARRAY [300] OF Text[150];
      CreditVATName@1000000059 : ARRAY [300] OF Text[150];
      DebitVATAmt@1000000040 : ARRAY [300] OF Decimal;
      CreditVATAmt@1000000039 : ARRAY [300] OF Decimal;
      VATAccountNo@1000000007 : Code[20];
      VATAccountName@1000000002 : Text[150];
      WHTAccountNo@1000000018 : Code[20];
      WHTAccountName@1000000011 : Text[150];
      DebitTotalLCY@1000000000 : Decimal;
      CreditTotalLCY@1000000001 : Decimal;
      VendName@1000000038 : Text[150];
      DimentionValue@1000000046 : Code[20];
      TextAmount@1000000063 : ARRAY [2] OF Text[250];
      WHTAmt@1000000024 : Decimal;
      WHTBaseAmt@1000000008 : Decimal;
      CreditWHTAmt@1000000068 : Decimal;
      CreditWHTBaseAmt@1000000009 : Decimal;
      TotalAmt@1000000017 : Decimal;
      CntLine@1000000087 : Integer;
      Line@1000000066 : Integer;
      DocumentNo@1000000029 : Code[20];
      Cash@1000000072 : Boolean;
      Cheque@1000000071 : Boolean;
      xCash@1000000070 : Text[1];
      xCheque@1000000069 : Text[1];
      BankAccNo@1000000014 : Code[20];
      BankName@1000000031 : Text[50];
      BankBranch@1000000032 : Text[30];
      StartingChequeNo@1000000064 : Code[20];
      CheckNo@1000000023 : Code[20];
      CheckDate@1000000019 : Date;
      PayPer@1000000033 : Decimal;
      DebitAmt@1000000037 : Decimal;
      CreditAmt@1000000041 : Decimal;
      DebitAmt2@1000000044 : Decimal;
      CreditAmt2@1000000043 : Decimal;
      MatchAcc@1000000057 : Boolean;
      I@1000000048 : Integer;
      J@1000000058 : Integer;
      DebitAppliedVATAmt@1000000076 : Decimal;
      CreditAppliedVATAmt@1000000077 : Decimal;
      PayeeName@1000000080 : Text[250];
      PaymentAmount@1000000082 : Decimal;
      ApplyCreditAmount@1000000083 : Decimal;
      ApplyInvoiceAmount@1000000089 : Decimal;
      g_intPatial@1000000093 : Integer;
      g_decRatioPatial@1000000094 : Decimal;
      g_decVATApplCrd@1000000095 : Decimal;
      FlagStatus@1000000096 : Integer;
      VATAccount@1000000098 : Code[20];
      VATAmount@1000000097 : Decimal;
      CreditVATAmtTmp@1000000102 : Decimal;
      CreditAppliedVATAmtTmp@1000000103 : Decimal;
      totCreditVATAmtTmp@1000000104 : Decimal;
      AmounttoApply@1000000105 : Decimal;
      totAmounttoApply@1000000106 : Decimal;
      ShowBlank@1000000109 : Boolean;
      TotalItemText@1000000047 : Text[30];
      LineSpace@1000000061 : Integer;
      TextPageNo@1000000073 : Text[30];
      SkipWHT@1000000006 : Boolean;
      VendEntryEdit@1000000056 : Codeunit 113;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut
      GKU : Goragot Kuanmuang

      No.   Date         Sign  Description
      ----------------------------------------
      001   14.02.2006   KKE   Payment Voucher Report localization.
      Burda
      002   30.08.2007   KKE   Change format report. (Name+Address, Page No.)
      003   13.09.2007   KKE   fix bug overflow.
      004   27.09.2007   KKE   Correct Report for case Skip WHT.
      005   28.09.2007   GKU   Edit case last line has NOWHT
      006   27.11.2007   KKE   -Reset Applies-to ID on Closed Vendor Ledger Entries.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50008 Get Cash Advance
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=[ 4:21:08 PM];
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnInitReport=BEGIN
                   IF NewGenLine2.FIND('-') THEN
                    // VoucherNo := NewGenLine2."Document No." ;
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table81;
        DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Line No.);
        OnAfterGetRecord=BEGIN
                           WHTAmount := WHTManagement.WHTAmountJournal("Gen. Journal Line",FALSE);

                           GenJnL1.TRANSFERFIELDS("Gen. Journal Line");
                           GenJnL1."Line No." := "Line No." + 100;
                           GenJnL1.VALIDATE("Account No.","Account No.");
                           IF VoucherNo <> '' THEN BEGIN
                             IF NOT VendLedgEnt.GET(EntryNo) THEN
                               CLEAR(VendLedgEnt);
                             GenJnL1."Document Type" := GenJnL1."Document Type"::Invoice;
                             GenJnL1."External Document No." := "Applies-to Doc. No.";
                             GenJnL1.VALIDATE("Applies-to Doc. Type",VendLedgEnt."Document Type");
                             GenJnL1.VALIDATE("Applies-to Doc. No.",VendLedgEnt."Document No.");
                             VendLedgEnt.CALCFIELDS(Amount);
                             GenJnL1.VALIDATE("WHT Business Posting Group",'');
                             GenJnL1.VALIDATE(Amount,(-1) * VendLedgEnt.Amount);
                             RevAmt := (-1) * VendLedgEnt.Amount;
                           END;
                           GenJnL1.INSERT;

                           GenJnL2.TRANSFERFIELDS("Gen. Journal Line");
                           GenJnL2."Line No." := "Line No." + 200;
                           IF BalType = BalType::Vendor THEN BEGIN
                             GenJnL2."Document Type" := GenJnL2."Document Type"::Invoice;
                             GenJnL2."External Document No." := "Applies-to Doc. No.";
                             GenJnL2.VALIDATE("Account Type","Account Type"::Vendor);
                             GenJnL2.VALIDATE("Account No.",BalNo);
                             GenJnL1.VALIDATE("WHT Business Posting Group",'');
                             GenJnL2.VALIDATE(Amount,((-1) * (RevAmt + Amount - WHTAmount)));
                           END ELSE IF BalType = BalType::"Bank Account" THEN BEGIN
                             GenJnL2."Document Type" := GenJnL2."Document Type"::Payment;
                             GenJnL2.VALIDATE("Account Type","Account Type"::"Bank Account");
                             GenJnL2.VALIDATE("Account No.","Bal. Account No.");
                             GenJnL2.VALIDATE("Bal. Account Type","Bal. Account Type"::"Bank Account");
                             GenJnL2.VALIDATE("Bal. Account No.",BalNo);
                             GenJnL2.VALIDATE(Amount,(RevAmt + Amount - WHTAmount));
                           END;

                           GenJnL2.VALIDATE("Applies-to Doc. Type",GenJnL2."Applies-to Doc. Type"::" ");
                           GenJnL2.VALIDATE("Applies-to Doc. No.",'');
                           GenJnL2.INSERT;
                           COMMIT;
                           MODIFY;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=8250;
      Height=2640;
    }
    CONTROLS
    {
      { 1000000000;TextBox;4620 ;1210 ;2860 ;440  ;CaptionML=[ENU=Balance Type;
                                                              THA=ประเภทบัญชีดุล];
                                                   OptionCaptionML=[ENU=Vendor,Bank Account;
                                                                    THA=ผู้ขาย,บัญชีธนาคาร];
                                                   OptionString=Vendor,Bank Account;
                                                   SourceExpr=BalType }
      { 1000000001;Label  ;220  ;1210 ;4290 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;4620 ;1760 ;2860 ;440  ;CaptionML=[ENU=Balance No.;
                                                              THA=รหัสบัญชีดุล];
                                                   SourceExpr=BalNo;
                                                   OnLookup=VAR
                                                              GL@1000000006 : Record 15;
                                                              Cust@1000000005 : Record 18;
                                                              Vendor@1000000004 : Record 23;
                                                              BankAccount@1000000003 : Record 270;
                                                              FixedAsset@1000000002 : Record 5600;
                                                            BEGIN
                                                              IF BalType = BalType::Vendor THEN BEGIN
                                                                IF FORM.RUNMODAL(FORM::"Vendor List",Vendor) = ACTION::LookupOK THEN
                                                                  BalNo := Vendor."No."
                                                              END ELSE IF BalType = BalType::"Bank Account" THEN BEGIN
                                                                IF FORM.RUNMODAL(FORM::"Bank Account List",BankAccount) = ACTION::LookupOK THEN
                                                                  BalNo := BankAccount."No."
                                                              END;
                                                            END;
                                                             }
      { 1000000003;Label  ;220  ;1760 ;4290 ;440  ;ParentControl=1000000002 }
      { 1000000004;TextBox;4620 ;330  ;2860 ;440  ;CaptionML=[ENU=Cash Advance Payment Voucher;
                                                              THA=ใบสำคัญจ่าย เงินทดรองจ่าย];
                                                   SourceExpr=VoucherNo;
                                                   OnLookup=VAR
                                                              VendLedgEntry@1000000000 : Record 25;
                                                            BEGIN
                                                              VendLedgEntry.SETRANGE("Document Type",VendLedgEntry."Document Type"::Payment);
                                                              VendLedgEntry.SETRANGE("Vendor No.",NewGenLine2."Account No.");
                                                              VendLedgEntry.SETRANGE(Open,TRUE);
                                                              IF FORM.RUNMODAL(FORM::"Vendor Ledger Entries",VendLedgEntry) = ACTION::LookupOK THEN BEGIN
                                                                VoucherNo := VendLedgEntry."Document No.";
                                                                EntryNo := VendLedgEntry."Entry No.";
                                                              END;
                                                            END;
                                                             }
      { 1000000005;Label  ;220  ;330  ;4290 ;440  ;ParentControl=1000000004 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GenJnL1@1000000002 : Record 81;
      GenJnL2@1000000003 : Record 81;
      NewGenLine2@1000000011 : Record 81;
      VendLedgEnt@1000000004 : Record 25;
      VendorLedFrm@1000000008 : Form 29;
      WHTManagement@1000000009 : Codeunit 28040;
      WHTAmount@1000000010 : Decimal;
      Temp@1117700000 : Code[20];
      BalType@1000000007 : 'Vendor,Bank Account';
      BalNo@1000000001 : Code[20];
      VoucherNo@1000000000 : Code[20];
      EntryNo@1000000006 : Integer;
      RevAmt@1000000005 : Decimal;

    PROCEDURE GetGenJnlLine@1000000000(NewGenLine@1000000000 : Record 81);
    BEGIN
      NewGenLine.COPY("Gen. Journal Line");
    END;

    PROCEDURE GetGenJnlLine2@1117700000(NewGenLine@1117700000 : Record 81);
    BEGIN
      NewGenLine2.COPY(NewGenLine);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2004   KKE   -Automatically get payment journal for cash advance..
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50009 General Journals
{
  OBJECT-PROPERTIES
  {
    Date=08/21/07;
    Time=10:24:34 AM;
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=800;
    OnPreReport=BEGIN
                  GLRegFilter := "G/L Entry".GETFILTERS;
                END;

    VertGrid=150;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table17;
        DataItemTableView=SORTING(Document No.,Posting Date)
                          WHERE(Source Code=CONST(GENJNL));
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS("Debit Amount","Credit Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF NOT GLAcc.GET("G/L Account No.") THEN
                             GLAcc.INIT;

                           GLRegister.RESET;
                           GLRegister.SETFILTER("From Entry No.",'%1..',"Entry No.");
                           IF NOT GLRegister.FIND('-') THEN
                             GLRegister.INIT;
                         END;

        ReqFilterFields=Posting Date,Document No.;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=General Journals }
            { 2   ;TextBox      ;16050;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 5   ;TextBox      ;18750;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    THA=หน้า];
                                                         SourceExpr=CurrReport.PAGENO }
            { 4   ;Label        ;18000;423  ;750  ;423  ;ParentControl=5 }
            { 6   ;TextBox      ;16950;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (GLRegFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 11  ;TextBox      ;0    ;0    ;19350;423  ;SourceExpr="G/L Entry".TABLECAPTION + ': ' + GLRegFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 12  ;Label        ;0    ;0    ;1200 ;846  ;ParentControl=28;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 13  ;Label        ;1350 ;0    ;300  ;846  ;ParentControl=29;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 14  ;Label        ;3300 ;0    ;1650 ;900  ;ParentControl=30;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;5100 ;0    ;1050 ;846  ;ParentControl=31;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 16  ;Label        ;6300 ;0    ;2550 ;846  ;ParentControl=32;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 17  ;Label        ;9000 ;0    ;3150 ;846  ;ParentControl=33;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 23  ;Label        ;18150;0    ;1200 ;846  ;ParentControl=39;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000001;Label  ;1800 ;0    ;1350 ;846  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000009;Label  ;15900;0    ;2100 ;846  ;ParentControl=1000000008;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000007;Label  ;13650;0    ;2100 ;846  ;ParentControl=1000000006;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 25  ;TextBox      ;1950 ;0    ;1200 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Register No.;
                                                                    THA=หมายเลขทะเบียน];
                                                         SourceExpr=GLRegister."No." }
            { 24  ;Label        ;0    ;0    ;1800 ;423  ;ParentControl=25;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19350;
            SectionHeight=450;
          }
          CONTROLS
          {
            { 28  ;TextBox      ;0    ;0    ;1200 ;423  ;SourceExpr="Posting Date" }
            { 29  ;TextBox      ;1350 ;0    ;300  ;423  ;CaptionML=[ENU=Document Type;
                                                                    THA=ชนิดเอกสาร];
                                                         SourceExpr="Document Type" }
            { 30  ;TextBox      ;3300 ;0    ;1650 ;423  ;SourceExpr="Document No." }
            { 31  ;TextBox      ;5100 ;0    ;1050 ;423  ;SourceExpr="G/L Account No." }
            { 32  ;TextBox      ;6300 ;0    ;2550 ;423  ;CaptionML=[ENU=Name;
                                                                    THA=ชื่อ];
                                                         SourceExpr=GLAcc.Name }
            { 33  ;TextBox      ;9000 ;0    ;3150 ;423  ;SourceExpr=Description }
            { 39  ;TextBox      ;18150;0    ;1200 ;423  ;SourceExpr="Entry No." }
            { 1000000000;TextBox;1800 ;0    ;1350 ;423  ;SourceExpr="External Document No." }
            { 1000000006;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000008;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
            { 1000000023;TextBox;12300;0    ;1200 ;450  ;SourceExpr="Global Dimension 1 Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=800;
            OnPreSection=BEGIN
                           CLEAR(ApplyDoc);

                           // Find Applied Doc. No. on Cust. Ledger Entry
                           CustLedgEntry.RESET;
                           CustLedgEntry.SETCURRENTKEY("Document No.");
                           CustLedgEntry.SETRANGE("Posting Date","Posting Date");
                           CustLedgEntry.SETRANGE("Document No.","Document No.");
                           IF CustLedgEntry.FIND('-') THEN
                           REPEAT
                             CustLedgEntry2.RESET;
                           {  IF CustLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF CustLedgEntry2.GET(CustLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := CustLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                               END;
                             END; }

                             CustLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             CustLedgEntry2.SETRANGE("Closed by Entry No.",CustLedgEntry."Entry No.");
                             IF CustLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := CustLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                             UNTIL CustLedgEntry2.NEXT=0;

                           UNTIL CustLedgEntry.NEXT=0;

                           // Find Applied Doc. No. on Vendor Ledger Entry
                           VendLedgEntry.RESET;
                           VendLedgEntry.SETCURRENTKEY("Document No.");
                           VendLedgEntry.SETRANGE("Posting Date","Posting Date");
                           VendLedgEntry.SETRANGE("Document No.","Document No.");
                           IF VendLedgEntry.FIND('-') THEN
                           REPEAT
                             VendLedgEntry2.RESET;
                           {  IF VendLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF VendLedgEntry2.GET(VendLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := VendLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                               END;
                             END; }

                             VendLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             VendLedgEntry2.SETRANGE("Closed by Entry No.",VendLedgEntry."Entry No.");
                             IF VendLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := VendLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                             UNTIL VendLedgEntry2.NEXT=0;

                           UNTIL VendLedgEntry.NEXT=0;

                           CurrReport.SHOWOUTPUT(ApplyDoc[1] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000015;TextBox;2550 ;150  ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[1] }
            { 1000000016;Label  ;0    ;150  ;2400 ;650  ;VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Apply to Doc. No. }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[2] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000017;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[2] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[3] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000018;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[3] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[4] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000019;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[4] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[5] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000020;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[5] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=750;
          }
          CONTROLS
          {
            { 1000000002;Label  ;9450 ;0    ;1050 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000004;Shape  ;0    ;423  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000005;TextBox;10650;0    ;2850 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="Document No." }
            { 1000000010;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000011;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 26  ;Label        ;0    ;0    ;2850 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Grand Total;
                                                                    THA=ยอดรวม] }
            { 1000000012;Shape  ;0    ;440  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000013;Shape  ;0    ;500  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000003;TextBox;15900;0    ;2100 ;423  ;FontBold=No;
                                                         SourceExpr="Credit Amount" }
            { 1000000014;TextBox;13050;0    ;2700 ;423  ;FontBold=No;
                                                         FontItalic=No;
                                                         SourceExpr="Debit Amount" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLRegister@1000000000 : Record 45;
      GLAcc@1000 : Record 15;
      GLRegFilter@1001 : Text[250];
      CustLedgEntry@1000000006 : Record 21;
      CustLedgEntry2@1000000005 : Record 21;
      VendLedgEntry@1000000004 : Record 25;
      VendLedgEntry2@1000000003 : Record 25;
      ApplyDoc@1000000002 : ARRAY [5] OF Text[250];
      i@1000000001 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -General Journals Report.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50010 Purchase Journals
{
  OBJECT-PROPERTIES
  {
    Date=03/01/06;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=800;
    OnPreReport=BEGIN
                  GLRegFilter := "G/L Entry".GETFILTERS;
                END;

    VertGrid=150;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table17;
        DataItemTableView=SORTING(Document No.,Posting Date);
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS("Debit Amount","Credit Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF OldDocNo <> "Document No." THEN BEGIN
                             OldDocNo := "Document No.";
                             GLEntry.RESET;
                             GLEntry.SETCURRENTKEY("Document No.","Posting Date");
                             GLEntry.SETRANGE("Document No.","Document No.");
                             GLEntry.SETRANGE("Posting Date","Posting Date");
                             GLEntry.SETFILTER("Source Code",'%1|%2','PURCHASES','PURCHJNL');
                             IF NOT GLEntry.FIND('-') THEN
                               CurrReport.SKIP;
                           END;

                           IF NOT GLAcc.GET("G/L Account No.") THEN
                             GLAcc.INIT;

                           GLRegister.RESET;
                           GLRegister.SETFILTER("From Entry No.",'%1..',"Entry No.");
                           IF NOT GLRegister.FIND('-') THEN
                             GLRegister.INIT;
                         END;

        ReqFilterFields=Posting Date,Document No.;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Purchase Journals }
            { 2   ;TextBox      ;16050;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 5   ;TextBox      ;18750;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    THA=หน้า];
                                                         SourceExpr=CurrReport.PAGENO }
            { 4   ;Label        ;18000;423  ;750  ;423  ;ParentControl=5 }
            { 6   ;TextBox      ;16950;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (GLRegFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 1000000004;TextBox;0    ;0    ;19350;423  ;SourceExpr="G/L Entry".TABLECAPTION + ': ' + GLRegFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 12  ;Label        ;0    ;0    ;1200 ;846  ;ParentControl=28;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 13  ;Label        ;1350 ;0    ;300  ;846  ;ParentControl=29;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 14  ;Label        ;3450 ;0    ;1536 ;846  ;ParentControl=30;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;5188 ;0    ;1341 ;846  ;ParentControl=31;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 16  ;Label        ;6733 ;0    ;2427 ;846  ;ParentControl=32;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 17  ;Label        ;9309 ;0    ;3185 ;846  ;ParentControl=33;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 23  ;Label        ;18469;0    ;829  ;846  ;ParentControl=39;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000001;Label  ;1800 ;0    ;1342 ;846  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000010;Label  ;16324;0    ;2100 ;846  ;ParentControl=1000000009;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000006;Label  ;14179;0    ;2100 ;846  ;ParentControl=1000000003;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000014;TextBox;1950 ;0    ;1200 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Register No.;
                                                                    THA=หมายเลขทะเบียน];
                                                         SourceExpr=GLRegister."No." }
            { 1000000015;Label  ;0    ;0    ;1800 ;423  ;ParentControl=1000000014;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 28  ;TextBox      ;0    ;0    ;1200 ;423  ;SourceExpr="Posting Date" }
            { 29  ;TextBox      ;1350 ;0    ;300  ;423  ;CaptionML=[ENU=Document Type;
                                                                    THA=ชนิดเอกสาร];
                                                         SourceExpr="Document Type" }
            { 30  ;TextBox      ;3450 ;0    ;1536 ;423  ;SourceExpr="Document No." }
            { 31  ;TextBox      ;5135 ;0    ;1447 ;423  ;SourceExpr="G/L Account No." }
            { 32  ;TextBox      ;6785 ;0    ;2321 ;423  ;CaptionML=[ENU=Name;
                                                                    THA=ชื่อ];
                                                         SourceExpr=GLAcc.Name }
            { 33  ;TextBox      ;9309 ;0    ;3186 ;423  ;SourceExpr=Description }
            { 39  ;TextBox      ;18467;0    ;883  ;423  ;SourceExpr="Entry No." }
            { 1000000000;TextBox;1800 ;0    ;1395 ;423  ;SourceExpr="External Document No." }
            { 1000000003;TextBox;14232;0    ;1994 ;423  ;SourceExpr="Debit Amount" }
            { 1000000009;TextBox;16350;0    ;1994 ;423  ;SourceExpr="Credit Amount" }
            { 1000000025;TextBox;12530;0    ;1658 ;423  ;SourceExpr="Global Dimension 1 Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=800;
            OnPreSection=BEGIN
                           CLEAR(ApplyDoc);

                           // Find Applied Doc. No. on Cust. Ledger Entry
                           CustLedgEntry.RESET;
                           CustLedgEntry.SETCURRENTKEY("Document No.");
                           CustLedgEntry.SETRANGE("Posting Date","Posting Date");
                           CustLedgEntry.SETRANGE("Document No.","Document No.");
                           IF CustLedgEntry.FIND('-') THEN
                           REPEAT
                             CustLedgEntry2.RESET;
                           {  IF CustLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF CustLedgEntry2.GET(CustLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := CustLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                               END;
                             END;   }

                             CustLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             CustLedgEntry2.SETRANGE("Closed by Entry No.",CustLedgEntry."Entry No.");
                             IF CustLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := CustLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                             UNTIL CustLedgEntry2.NEXT=0;

                           UNTIL CustLedgEntry.NEXT=0;

                           // Find Applied Doc. No. on Vendor Ledger Entry
                           VendLedgEntry.RESET;
                           VendLedgEntry.SETCURRENTKEY("Document No.");
                           VendLedgEntry.SETRANGE("Posting Date","Posting Date");
                           VendLedgEntry.SETRANGE("Document No.","Document No.");
                           IF VendLedgEntry.FIND('-') THEN
                           REPEAT
                             VendLedgEntry2.RESET;
                            { IF VendLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF VendLedgEntry2.GET(VendLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := VendLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                               END;
                             END; }

                             VendLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             VendLedgEntry2.SETRANGE("Closed by Entry No.",VendLedgEntry."Entry No.");
                             IF VendLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := VendLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                             UNTIL VendLedgEntry2.NEXT=0;

                           UNTIL VendLedgEntry.NEXT=0;

                           CurrReport.SHOWOUTPUT(ApplyDoc[1] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000019;TextBox;2550 ;150  ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[1] }
            { 1000000020;Label  ;0    ;150  ;2400 ;650  ;VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Apply to Doc. No. }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[2] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000021;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[2] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[3] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000022;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[3] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[4] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000023;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[4] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[5] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000024;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[5] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=750;
          }
          CONTROLS
          {
            { 1000000005;Label  ;9450 ;0    ;1050 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000007;Shape  ;0    ;423  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000008;TextBox;10650;0    ;2850 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="Document No." }
            { 1000000011;TextBox;13800;0    ;2400 ;423  ;SourceExpr="Debit Amount" }
            { 1000000012;TextBox;16200;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000002;Label  ;0    ;0    ;2850 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Grand Total;
                                                                    THA=ยอดรวม] }
            { 1000000013;Shape  ;0    ;440  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000016;Shape  ;0    ;500  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000017;TextBox;16200;0    ;2120 ;423  ;SourceExpr="Credit Amount" }
            { 1000000018;TextBox;13800;0    ;2400 ;423  ;SourceExpr="Debit Amount" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLRegister@1000000002 : Record 45;
      GLAcc@1000000001 : Record 15;
      GLEntry@1000000009 : Record 17;
      GLRegFilter@1000000000 : Text[250];
      CustLedgEntry@1000000008 : Record 21;
      CustLedgEntry2@1000000007 : Record 21;
      VendLedgEntry@1000000006 : Record 25;
      VendLedgEntry2@1000000005 : Record 25;
      ApplyDoc@1000000004 : ARRAY [5] OF Text[250];
      i@1000000003 : Integer;
      OldDocNo@1000000010 : Code[20];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Purchase Journals Report.

      Source Code=FILTER(PURCHASES|PURCHJNL)
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50011 Payment Journals
{
  OBJECT-PROPERTIES
  {
    Date=03/01/06;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=800;
    OnPreReport=BEGIN
                  GLRegFilter := "G/L Entry".GETFILTERS;
                END;

    VertGrid=150;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table17;
        DataItemTableView=SORTING(Document No.,Posting Date)
                          WHERE(Source Code=CONST(PAYMENTJNL));
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS("Debit Amount","Credit Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF NOT GLAcc.GET("G/L Account No.") THEN
                             GLAcc.INIT;

                           GLRegister.RESET;
                           GLRegister.SETFILTER("From Entry No.",'%1..',"Entry No.");
                           IF NOT GLRegister.FIND('-') THEN
                             GLRegister.INIT;
                         END;

        ReqFilterFields=Document No.,Posting Date;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Payment Journals }
            { 2   ;TextBox      ;16050;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 5   ;TextBox      ;18750;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    THA=หน้า];
                                                         SourceExpr=CurrReport.PAGENO }
            { 4   ;Label        ;18000;423  ;750  ;423  ;ParentControl=5 }
            { 6   ;TextBox      ;16950;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (GLRegFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 1000000002;TextBox;0    ;0    ;19350;423  ;SourceExpr="G/L Entry".TABLECAPTION + ': ' + GLRegFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 12  ;Label        ;0    ;0    ;1200 ;846  ;ParentControl=28;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 13  ;Label        ;1350 ;0    ;300  ;846  ;ParentControl=29;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 14  ;Label        ;3450 ;0    ;1800 ;846  ;ParentControl=30;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;5400 ;0    ;1500 ;846  ;ParentControl=31;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 16  ;Label        ;7050 ;0    ;2057 ;846  ;ParentControl=32;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 17  ;Label        ;9257 ;0    ;2708 ;846  ;ParentControl=33;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 23  ;Label        ;18150;0    ;1200 ;846  ;ParentControl=39;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000001;Label  ;1800 ;0    ;1500 ;846  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000010;Label  ;13650;0    ;2100 ;846  ;ParentControl=1000000006;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000012;Label  ;15900;0    ;2100 ;846  ;ParentControl=1000000011;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000003;TextBox;1950 ;0    ;1200 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Register No.;
                                                                    THA=หมายเลขทะเบียน];
                                                         SourceExpr=GLRegister."No." }
            { 1000000004;Label  ;0    ;0    ;1800 ;423  ;ParentControl=1000000003;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 28  ;TextBox      ;0    ;0    ;1200 ;423  ;SourceExpr="Posting Date" }
            { 29  ;TextBox      ;1350 ;0    ;300  ;423  ;CaptionML=[ENU=Document Type;
                                                                    THA=ชนิดเอกสาร];
                                                         SourceExpr="Document Type" }
            { 30  ;TextBox      ;3450 ;0    ;1800 ;423  ;SourceExpr="Document No." }
            { 31  ;TextBox      ;5400 ;0    ;1500 ;423  ;SourceExpr="G/L Account No." }
            { 32  ;TextBox      ;7050 ;0    ;2056 ;423  ;CaptionML=[ENU=Name;
                                                                    THA=ชื่อ];
                                                         SourceExpr=GLAcc.Name }
            { 33  ;TextBox      ;9256 ;0    ;2709 ;423  ;SourceExpr=Description }
            { 39  ;TextBox      ;18150;0    ;1200 ;423  ;SourceExpr="Entry No." }
            { 1000000000;TextBox;1800 ;0    ;1500 ;423  ;SourceExpr="External Document No." }
            { 1000000006;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000011;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
            { 1000000025;TextBox;12142;17   ;1341 ;406  ;SourceExpr="Global Dimension 1 Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=800;
            OnPreSection=BEGIN
                           CLEAR(ApplyDoc);

                           // Find Applied Doc. No. on Cust. Ledger Entry
                           CustLedgEntry.RESET;
                           CustLedgEntry.SETCURRENTKEY("Document No.");
                           CustLedgEntry.SETRANGE("Posting Date","Posting Date");
                           CustLedgEntry.SETRANGE("Document No.","Document No.");
                           IF CustLedgEntry.FIND('-') THEN
                           REPEAT
                           {  CustLedgEntry2.RESET;
                             IF CustLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF CustLedgEntry2.GET(CustLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := CustLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                               END;
                             END; }

                             CustLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             CustLedgEntry2.SETRANGE("Closed by Entry No.",CustLedgEntry."Entry No.");
                             IF CustLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := CustLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                             UNTIL CustLedgEntry2.NEXT=0;

                           UNTIL CustLedgEntry.NEXT=0;

                           // Find Applied Doc. No. on Vendor Ledger Entry
                           VendLedgEntry.RESET;
                           VendLedgEntry.SETCURRENTKEY("Document No.");
                           VendLedgEntry.SETRANGE("Posting Date","Posting Date");
                           VendLedgEntry.SETRANGE("Document No.","Document No.");
                           IF VendLedgEntry.FIND('-') THEN
                           REPEAT
                             VendLedgEntry2.RESET;
                           {  IF VendLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF VendLedgEntry2.GET(VendLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := VendLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                               END;
                             END; }

                             VendLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             VendLedgEntry2.SETRANGE("Closed by Entry No.",VendLedgEntry."Entry No.");
                             IF VendLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := VendLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                             UNTIL VendLedgEntry2.NEXT=0;

                           UNTIL VendLedgEntry.NEXT=0;

                           CurrReport.SHOWOUTPUT(ApplyDoc[1] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000019;TextBox;2550 ;150  ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[1] }
            { 1000000021;Label  ;0    ;150  ;2400 ;650  ;VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Apply to Doc. No. }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[2] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000020;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[2] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[3] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000022;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[3] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[4] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000023;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[4] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[5] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000024;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[5] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=750;
          }
          CONTROLS
          {
            { 1000000005;Label  ;9450 ;0    ;1050 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000007;Shape  ;0    ;423  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000008;TextBox;10650;0    ;2850 ;423  ;FontBold=Yes;
                                                         SourceExpr="Document No." }
            { 1000000015;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000016;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19350;
            SectionHeight=906;
          }
          CONTROLS
          {
            { 1000000009;Label  ;0    ;0    ;2850 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Grand Total;
                                                                    THA=ยอดรวม] }
            { 1000000013;Shape  ;0    ;440  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000014;Shape  ;0    ;500  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000017;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000018;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLRegister@1000000002 : Record 45;
      GLAcc@1000000001 : Record 15;
      GLRegFilter@1000000000 : Text[250];
      CustLedgEntry@1000000003 : Record 21;
      CustLedgEntry2@1000000008 : Record 21;
      VendLedgEntry@1000000004 : Record 25;
      VendLedgEntry2@1000000007 : Record 25;
      ApplyDoc@1000000005 : ARRAY [5] OF Text[250];
      i@1000000009 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Payment Journals Report.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50012 Sales Journals
{
  OBJECT-PROPERTIES
  {
    Date=03/01/06;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=800;
    OnPreReport=BEGIN
                  GLRegFilter := "G/L Entry".GETFILTERS;
                END;

    VertGrid=150;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table17;
        DataItemTableView=SORTING(Document No.,Posting Date)
                          WHERE(Source Code=FILTER(SALES|SALESJNL));
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS("Debit Amount","Credit Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF NOT GLAcc.GET("G/L Account No.") THEN
                             GLAcc.INIT;

                           GLRegister.RESET;
                           GLRegister.SETFILTER("From Entry No.",'%1..',"Entry No.");
                           IF NOT GLRegister.FIND('-') THEN
                             GLRegister.INIT;
                         END;

        ReqFilterFields=Document No.,Posting Date;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Sales Journals }
            { 2   ;TextBox      ;16050;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 5   ;TextBox      ;18750;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    THA=หน้า];
                                                         SourceExpr=CurrReport.PAGENO }
            { 4   ;Label        ;18000;423  ;750  ;423  ;ParentControl=5 }
            { 6   ;TextBox      ;16950;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (GLRegFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 1000000002;TextBox;0    ;0    ;19350;423  ;SourceExpr="G/L Entry".TABLECAPTION + ': ' + GLRegFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 12  ;Label        ;0    ;0    ;1200 ;846  ;ParentControl=28;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 13  ;Label        ;1350 ;0    ;300  ;846  ;ParentControl=29;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 14  ;Label        ;3450 ;0    ;1800 ;846  ;ParentControl=30;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;5400 ;0    ;1500 ;846  ;ParentControl=31;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 16  ;Label        ;7050 ;0    ;1897 ;846  ;ParentControl=32;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 17  ;Label        ;9098 ;0    ;2761 ;846  ;ParentControl=33;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 23  ;Label        ;18150;0    ;1200 ;846  ;ParentControl=39;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000001;Label  ;1800 ;0    ;1500 ;846  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000010;Label  ;13650;0    ;2100 ;846  ;ParentControl=1000000006;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000012;Label  ;15900;0    ;2100 ;846  ;ParentControl=1000000011;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000003;TextBox;1950 ;0    ;1200 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Register No.;
                                                                    THA=หมายเลขทะเบียน];
                                                         SourceExpr=GLRegister."No." }
            { 1000000004;Label  ;0    ;0    ;1800 ;423  ;ParentControl=1000000003;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 28  ;TextBox      ;0    ;0    ;1200 ;423  ;SourceExpr="Posting Date" }
            { 29  ;TextBox      ;1350 ;0    ;300  ;423  ;CaptionML=[ENU=Document Type;
                                                                    THA=ชนิดเอกสาร];
                                                         SourceExpr="Document Type" }
            { 30  ;TextBox      ;3450 ;0    ;1800 ;423  ;SourceExpr="Document No." }
            { 31  ;TextBox      ;5400 ;0    ;1500 ;423  ;SourceExpr="G/L Account No." }
            { 32  ;TextBox      ;7050 ;0    ;1950 ;423  ;CaptionML=[ENU=Name;
                                                                    THA=ชื่อ];
                                                         SourceExpr=GLAcc.Name }
            { 33  ;TextBox      ;9150 ;0    ;2762 ;423  ;SourceExpr=Description }
            { 39  ;TextBox      ;18150;0    ;1200 ;423  ;SourceExpr="Entry No." }
            { 1000000000;TextBox;1800 ;0    ;1500 ;423  ;SourceExpr="External Document No." }
            { 1000000006;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000011;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
            { 1000000029;TextBox;11938;0    ;1659 ;415  ;SourceExpr="Global Dimension 1 Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=800;
            OnPreSection=BEGIN
                           CLEAR(ApplyDoc);

                           // Find Applied Doc. No. on Cust. Ledger Entry
                           CustLedgEntry.RESET;
                           CustLedgEntry.SETCURRENTKEY("Document No.");
                           CustLedgEntry.SETRANGE("Posting Date","Posting Date");
                           CustLedgEntry.SETRANGE("Document No.","Document No.");
                           IF CustLedgEntry.FIND('-') THEN
                           REPEAT
                             CustLedgEntry2.RESET;
                           {  IF CustLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF CustLedgEntry2.GET(CustLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := CustLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                               END;
                             END; }

                             CustLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             CustLedgEntry2.SETRANGE("Closed by Entry No.",CustLedgEntry."Entry No.");
                             IF CustLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := CustLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                             UNTIL CustLedgEntry2.NEXT=0;

                           UNTIL CustLedgEntry.NEXT=0;

                           // Find Applied Doc. No. on Vendor Ledger Entry
                           VendLedgEntry.RESET;
                           VendLedgEntry.SETCURRENTKEY("Document No.");
                           VendLedgEntry.SETRANGE("Posting Date","Posting Date");
                           VendLedgEntry.SETRANGE("Document No.","Document No.");
                           IF VendLedgEntry.FIND('-') THEN
                           REPEAT
                             VendLedgEntry2.RESET;
                           {  IF VendLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF VendLedgEntry2.GET(VendLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := VendLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                               END;
                             END; }

                             VendLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             VendLedgEntry2.SETRANGE("Closed by Entry No.",VendLedgEntry."Entry No.");
                             IF VendLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := VendLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                             UNTIL VendLedgEntry2.NEXT=0;

                           UNTIL VendLedgEntry.NEXT=0;

                           CurrReport.SHOWOUTPUT(ApplyDoc[1] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000019;TextBox;2550 ;150  ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[1] }
            { 1000000020;Label  ;0    ;150  ;2400 ;650  ;VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Apply to Doc. No. }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[2] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000021;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[2] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[3] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000022;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[3] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[4] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000023;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[4] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[5] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000024;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[5] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=750;
          }
          CONTROLS
          {
            { 1000000005;Label  ;9450 ;0    ;1050 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000007;Shape  ;0    ;423  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000008;TextBox;10650;0    ;2850 ;423  ;FontBold=Yes;
                                                         SourceExpr="Document No." }
            { 1000000015;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000016;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000009;Label  ;0    ;0    ;2850 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Grand Total;
                                                                    THA=ยอดรวม] }
            { 1000000013;Shape  ;0    ;440  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000014;Shape  ;0    ;500  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000017;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLRegister@1000000002 : Record 45;
      GLAcc@1000000001 : Record 15;
      GLRegFilter@1000000000 : Text[250];
      CustLedgEntry@1000000008 : Record 21;
      CustLedgEntry2@1000000007 : Record 21;
      VendLedgEntry@1000000006 : Record 25;
      VendLedgEntry2@1000000005 : Record 25;
      ApplyDoc@1000000004 : ARRAY [5] OF Text[250];
      i@1000000003 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Sales Journals Report.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50013 Receipt Journals
{
  OBJECT-PROPERTIES
  {
    Date=03/01/06;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=800;
    OnPreReport=BEGIN
                  GLRegFilter := "G/L Entry".GETFILTERS;
                END;

    VertGrid=150;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table17;
        DataItemTableView=SORTING(Document No.,Posting Date)
                          WHERE(Source Code=CONST(CASHRECJNL));
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS("Debit Amount","Credit Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF NOT GLAcc.GET("G/L Account No.") THEN
                             GLAcc.INIT;

                           GLRegister.RESET;
                           GLRegister.SETFILTER("From Entry No.",'%1..',"Entry No.");
                           IF NOT GLRegister.FIND('-') THEN
                             GLRegister.INIT;
                         END;

        ReqFilterFields=Document No.,Posting Date;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Receipt Journals }
            { 2   ;TextBox      ;16200;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 5   ;TextBox      ;18900;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    THA=หน้า];
                                                         SourceExpr=CurrReport.PAGENO }
            { 4   ;Label        ;18150;423  ;750  ;423  ;ParentControl=5 }
            { 6   ;TextBox      ;17100;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (GLRegFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 1000000002;TextBox;0    ;0    ;19350;423  ;SourceExpr="G/L Entry".TABLECAPTION + ': ' + GLRegFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 12  ;Label        ;0    ;0    ;1200 ;846  ;ParentControl=28;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 13  ;Label        ;1350 ;0    ;300  ;846  ;ParentControl=29;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 14  ;Label        ;3450 ;0    ;1800 ;846  ;ParentControl=30;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;5400 ;0    ;1500 ;846  ;ParentControl=31;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 16  ;Label        ;7050 ;0    ;2373 ;846  ;ParentControl=32;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 17  ;Label        ;9468 ;0    ;2339 ;846  ;ParentControl=33;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 23  ;Label        ;18150;0    ;1200 ;846  ;ParentControl=39;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000001;Label  ;1800 ;0    ;1500 ;846  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000010;Label  ;13650;0    ;2100 ;846  ;ParentControl=1000000006;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000012;Label  ;15900;0    ;2100 ;846  ;ParentControl=1000000011;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000003;TextBox;1950 ;0    ;1200 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Register No.;
                                                                    THA=หมายเลขทะเบียน];
                                                         SourceExpr=GLRegister."No." }
            { 1000000004;Label  ;0    ;0    ;1800 ;423  ;ParentControl=1000000003;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 28  ;TextBox      ;0    ;0    ;1200 ;423  ;SourceExpr="Posting Date" }
            { 29  ;TextBox      ;1350 ;0    ;300  ;423  ;CaptionML=[ENU=Document Type;
                                                                    THA=ชนิดเอกสาร];
                                                         SourceExpr="Document Type" }
            { 30  ;TextBox      ;3450 ;0    ;1800 ;423  ;SourceExpr="Document No." }
            { 31  ;TextBox      ;5400 ;0    ;1500 ;423  ;SourceExpr="G/L Account No." }
            { 32  ;TextBox      ;7050 ;0    ;2321 ;423  ;CaptionML=[ENU=Name;
                                                                    THA=ชื่อ];
                                                         SourceExpr=GLAcc.Name }
            { 33  ;TextBox      ;9468 ;0    ;2392 ;423  ;SourceExpr=Description }
            { 39  ;TextBox      ;18150;0    ;1200 ;423  ;SourceExpr="Entry No." }
            { 1000000000;TextBox;1800 ;0    ;1500 ;423  ;SourceExpr="External Document No." }
            { 1000000006;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000011;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
            { 1000000025;TextBox;12072;0    ;1500 ;423  ;SourceExpr="Global Dimension 1 Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=800;
            OnPreSection=BEGIN
                           CLEAR(ApplyDoc);

                           // Find Applied Doc. No. on Cust. Ledger Entry
                           CustLedgEntry.RESET;
                           CustLedgEntry.SETCURRENTKEY("Document No.");
                           CustLedgEntry.SETRANGE("Posting Date","Posting Date");
                           CustLedgEntry.SETRANGE("Document No.","Document No.");
                           IF CustLedgEntry.FIND('-') THEN
                           REPEAT
                             CustLedgEntry2.RESET;
                           {  IF CustLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF CustLedgEntry2.GET(CustLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := CustLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                               END;
                             END; }

                             CustLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             CustLedgEntry2.SETRANGE("Closed by Entry No.",CustLedgEntry."Entry No.");
                             IF CustLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := CustLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + CustLedgEntry2."Document No.";
                             UNTIL CustLedgEntry2.NEXT=0;

                           UNTIL CustLedgEntry.NEXT=0;

                           // Find Applied Doc. No. on Vendor Ledger Entry
                           VendLedgEntry.RESET;
                           VendLedgEntry.SETCURRENTKEY("Document No.");
                           VendLedgEntry.SETRANGE("Posting Date","Posting Date");
                           VendLedgEntry.SETRANGE("Document No.","Document No.");
                           IF VendLedgEntry.FIND('-') THEN
                           REPEAT
                             VendLedgEntry2.RESET;
                           {  IF VendLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
                               IF VendLedgEntry2.GET(VendLedgEntry."Closed by Entry No.") THEN BEGIN
                                 i := 0;
                                 REPEAT
                                   i := i + 1;
                                 UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                                 IF ApplyDoc[i] = '' THEN
                                   ApplyDoc[i] := VendLedgEntry2."Document No."
                                 ELSE
                                   ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                               END;
                             END;  }

                             VendLedgEntry2.SETCURRENTKEY("Closed by Entry No.");
                             VendLedgEntry2.SETRANGE("Closed by Entry No.",VendLedgEntry."Entry No.");
                             IF VendLedgEntry2.FIND('-') THEN
                             REPEAT
                               i := 0;
                               REPEAT
                                 i := i + 1;
                               UNTIL (i=5) OR (ApplyDoc[i] = '') OR (STRLEN(ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.") <= 250);
                               IF ApplyDoc[i] = '' THEN
                                 ApplyDoc[i] := VendLedgEntry2."Document No."
                               ELSE
                                 ApplyDoc[i] := ApplyDoc[i] + ', ' + VendLedgEntry2."Document No.";
                             UNTIL VendLedgEntry2.NEXT=0;

                           UNTIL VendLedgEntry.NEXT=0;

                           CurrReport.SHOWOUTPUT(ApplyDoc[1] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000019;TextBox;2550 ;150  ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[1] }
            { 1000000020;Label  ;0    ;150  ;2400 ;650  ;VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Apply to Doc. No. }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[2] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000021;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[2] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[3] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000022;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[3] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[4] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000023;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[4] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ApplyDoc[5] <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000024;TextBox;2550 ;0    ;16800;650  ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         SourceExpr=ApplyDoc[5] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=750;
          }
          CONTROLS
          {
            { 1000000005;Label  ;9450 ;0    ;1050 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000007;Shape  ;0    ;423  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000008;TextBox;10650;0    ;2850 ;423  ;FontBold=Yes;
                                                         SourceExpr="Document No." }
            { 1000000015;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000016;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000009;Label  ;0    ;0    ;2850 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Grand Total;
                                                                    THA=ยอดรวม] }
            { 1000000013;Shape  ;0    ;500  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000014;Shape  ;0    ;440  ;19350;30   ;ShapeStyle=HorzLine }
            { 1000000017;TextBox;13650;0    ;2100 ;423  ;SourceExpr="Debit Amount" }
            { 1000000018;TextBox;15900;0    ;2100 ;423  ;SourceExpr="Credit Amount" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLRegister@1000000002 : Record 45;
      GLAcc@1000000001 : Record 15;
      GLRegFilter@1000000000 : Text[250];
      CustLedgEntry@1000000008 : Record 21;
      CustLedgEntry2@1000000007 : Record 21;
      VendLedgEntry@1000000006 : Record 25;
      VendLedgEntry2@1000000005 : Record 25;
      ApplyDoc@1000000004 : ARRAY [5] OF Text[250];
      i@1000000003 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Receipt Journals Report.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50014 Journal Voucher
{
  OBJECT-PROPERTIES
  {
    Date=01/15/08;
    Time=10:31:11 AM;
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   CompanyInfo.GET;
                   CompanyInfo.CALCFIELDS(Picture);
                 END;

    OnPreReport=BEGIN
                  DebitTotalLCY := 0;
                  CreditTotalLCY := 0;

                  GLSetup.GetShortcutDimCode(ShortcutDimCode);
                END;

    Orientation=Landscape;
    HorzGrid=50;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table81;
        DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Posting Date,Document No.);
        NewPagePerGroup=Yes;
        OnAfterGetRecord=BEGIN
                           IF "Document No." = GenJnlLine."Document No." THEN
                             CurrReport.SKIP
                           ELSE
                             GenJnlLine := "Gen. Journal Line";

                           CLEAR(DebitType);
                           CLEAR(DebitAccNo);
                           CLEAR(DebitAccName);
                           CLEAR(DebitDimValue1);
                           CLEAR(DebitDimValue2);
                           CLEAR(DebitDimValue3);
                           CLEAR(DebitDimValue4);
                           CLEAR(DebitDimValue5);
                           CLEAR(DebitAmount);
                           CLEAR(CreditType);
                           CLEAR(CreditAccNo);
                           CLEAR(CreditAccName);
                           CLEAR(CreditDimValue1);
                           CLEAR(CreditDimValue2);
                           CLEAR(CreditDimValue3);
                           CLEAR(CreditDimValue4);
                           CLEAR(CreditDimValue5);
                           CLEAR(CreditAmount);
                           CLEAR(Remark);

                           GenJnlLine2.RESET;
                           GenJnlLine2.SETRANGE("Journal Template Name","Journal Template Name");
                           GenJnlLine2.SETRANGE("Journal Batch Name","Journal Batch Name");
                           GenJnlLine2.SETRANGE("Document No.","Document No.");
                           IF GenJnlLine2.FIND('-') THEN
                           REPEAT
                             WITH GenJnlLine2 DO BEGIN
                               //VAT Calculation
                               CLEAR(VATAmount);
                               CLEAR(BalVATAmount);
                               CLEAR(GenJnlPostLine);
                               IF GLEntryTemp.COUNT <> 0 THEN
                                 GLEntryTemp.DELETEALL;
                               GenJnlPostLine.CheckVATGLEntry(GenJnlLine2,GLEntryTemp);
                               IF GLEntryTemp.FIND('-') THEN
                               REPEAT
                                 IF GLEntryTemp."Entry No." = 1 THEN
                                   VATAmount := GLEntryTemp.Amount
                                 ELSE
                                   BalVATAmount := GLEntryTemp.Amount;
                               UNTIL GLEntryTemp.NEXT=0;

                               //Get Dimension3-5
                               CLEAR(ShortcutDim3Code);
                               CLEAR(ShortcutDim4Code);
                               CLEAR(ShortcutDim5Code);
                               IF JournalLineDim.GET(81,"Journal Template Name","Journal Batch Name","Line No.",0,ShortcutDimCode[3]) THEN
                                 ShortcutDim3Code := JournalLineDim."Dimension Value Code";
                               IF JournalLineDim.GET(81,"Journal Template Name","Journal Batch Name","Line No.",0,ShortcutDimCode[4]) THEN
                                 ShortcutDim4Code := JournalLineDim."Dimension Value Code";
                               IF JournalLineDim.GET(81,"Journal Template Name","Journal Batch Name","Line No.",0,ShortcutDimCode[5]) THEN
                                 ShortcutDim5Code := JournalLineDim."Dimension Value Code";

                               //Insert Line
                               IF "Debit Amount" <> 0 THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   CLEAR(DebitAccount);
                                   CASE "Account Type" OF
                                     "Account Type"::"G/L Account":
                                       BEGIN
                                         DebitAccount := "Account No.";
                                       END;
                                     "Account Type"::Customer:
                                       BEGIN
                                         CustPostingGroup.GET("Posting Group");
                                         DebitAccount := CustPostingGroup."Receivables Account";
                                       END;
                                     "Account Type"::Vendor:
                                       BEGIN
                                         VendPostingGroup.GET("Posting Group");
                                         DebitAccount := VendPostingGroup."Payables Account";
                                       END;
                                     "Account Type"::"Bank Account":
                                       BEGIN
                                         BankAcc.GET("Account No.");
                                         BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                         DebitAccount := BankAccPostingGroup."G/L Bank Account No.";
                                       END;
                                     //TSA001
                                     "Account Type"::"Fixed Asset":
                                       BEGIN
                                         FADepreciationBook.RESET;
                                         FADepreciationBook.SETRANGE("FA No.","Account No.");
                                         IF FADepreciationBook.FIND('-') THEN
                                           BEGIN
                                             FAPostingGroup.GET(FADepreciationBook."FA Posting Group");
                                             CreditAccount := FAPostingGroup."Accum. Depreciation Account";
                                           END;
                                       END;
                                     //TSA001

                                   END;
                                   IF ((DebitAccNo[I] = DebitAccount) AND
                                       (DebitAccName[I] = Description) AND //KKE : #003
                                       (DebitDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                       (DebitDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                       (DebitDimValue3[I] = ShortcutDim3Code) AND
                                       (DebitDimValue4[I] = ShortcutDim4Code) AND
                                       (DebitDimValue5[I] = ShortcutDim5Code))
                                      OR (DebitAccNo[I] = '')
                                   THEN BEGIN
                                     DebitAccNo[I] := DebitAccount;
                                     GLAcc.GET(DebitAccNo[I]);
                                     //DebitAccName[I] := GLAcc.Name;
                                     DebitAccName[I] := Description;  //KKE: #003
                                     //DebitAmount[I] := DebitAmount[I] + "Debit Amount";
                                     IF VATAmount > 0 THEN
                                       DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)" - VATAmount)
                                     ELSE
                                       DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)");

                                     DebitDimValue1[I] := "Shortcut Dimension 1 Code";
                                     DebitDimValue2[I] := "Shortcut Dimension 2 Code";
                                     DebitDimValue3[I] := ShortcutDim3Code;
                                     DebitDimValue4[I] := ShortcutDim4Code;
                                     DebitDimValue5[I] := ShortcutDim5Code;
                                     MatchAcc := TRUE;
                                   END;

                                   IF "Bal. Account No." <> '' THEN BEGIN
                                     CLEAR(CreditAccount);
                                     CASE "Bal. Account Type" OF
                                       "Bal. Account Type"::"G/L Account":
                                         BEGIN
                                           CreditAccount := "Bal. Account No.";
                                         END;
                                       "Bal. Account Type"::Customer:
                                         BEGIN
                                           CustPostingGroup.GET("Posting Group");
                                           CreditAccount := CustPostingGroup."Receivables Account";
                                         END;
                                       "Bal. Account Type"::Vendor:
                                         BEGIN
                                           VendPostingGroup.GET("Posting Group");
                                           CreditAccount := VendPostingGroup."Payables Account";
                                         END;
                                       "Bal. Account Type"::"Bank Account":
                                         BEGIN
                                           BankAcc.GET("Bal. Account No.");
                                           BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                           CreditAccount := BankAccPostingGroup."G/L Bank Account No.";
                                         END;
                                       //TSA001
                                       "Bal. Account Type"::"Fixed Asset":
                                         BEGIN
                                           FADepreciationBook.RESET;
                                           FADepreciationBook.SETRANGE("FA No.","Bal. Account No.");
                                           IF FADepreciationBook.FIND('-') THEN
                                             BEGIN
                                               FAPostingGroup.GET(FADepreciationBook."FA Posting Group");
                                               CreditAccount := FAPostingGroup."Accum. Depreciation Account";
                                             END;
                                         END;
                                       //TSA001

                                     END;
                                     IF ((CreditAccNo[I] = CreditAccount) AND
                                         (CreditAccName[I] = Description) AND //KKE : #003
                                         (CreditDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                         (CreditDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                         (CreditDimValue3[I] = ShortcutDim3Code) AND
                                         (CreditDimValue4[I] = ShortcutDim4Code) AND
                                         (CreditDimValue5[I] = ShortcutDim5Code))
                                        OR (CreditAccNo[I] = '')
                                     THEN BEGIN
                                       CreditAccNo[I] := CreditAccount;
                                       GLAcc.GET(CreditAccNo[I]);
                                       //CreditAccName[I] := GLAcc.Name;
                                       CreditAccName[I] := Description;  //KKE : #003
                                       //CreditAmount[I] := CreditAmount[I] + "Debit Amount";
                                       IF BalVATAmount < 0 THEN
                                         CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)" + BalVATAmount)
                                       ELSE
                                         CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)");

                                       CreditDimValue1[I] := "Shortcut Dimension 1 Code";
                                       CreditDimValue2[I] := "Shortcut Dimension 2 Code";
                                       CreditDimValue3[I] := ShortcutDim3Code;
                                       CreditDimValue4[I] := ShortcutDim4Code;
                                       CreditDimValue5[I] := ShortcutDim5Code;
                                       MatchAcc := TRUE;
                                     END;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                               END ELSE
                               IF "Credit Amount" <> 0 THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   CLEAR(CreditAccount);
                                   CASE "Account Type" OF
                                     "Account Type"::"G/L Account":
                                       BEGIN
                                         CreditAccount := "Account No.";
                                       END;
                                     "Account Type"::Customer:
                                       BEGIN
                                         CustPostingGroup.GET("Posting Group");
                                         CreditAccount := CustPostingGroup."Receivables Account";
                                       END;
                                     "Account Type"::Vendor:
                                       BEGIN
                                         VendPostingGroup.GET("Posting Group");
                                         CreditAccount := VendPostingGroup."Payables Account";
                                       END;
                                     "Account Type"::"Bank Account":
                                       BEGIN
                                         BankAcc.GET("Account No.");
                                         BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                         CreditAccount := BankAccPostingGroup."G/L Bank Account No.";
                                       END;
                                     //TSA001
                                     "Account Type"::"Fixed Asset":
                                       BEGIN
                                         FADepreciationBook.RESET;
                                         FADepreciationBook.SETRANGE("FA No.","Account No.");
                                         IF FADepreciationBook.FIND('-') THEN
                                           BEGIN
                                             FAPostingGroup.GET(FADepreciationBook."FA Posting Group");
                                             CreditAccount := FAPostingGroup."Accum. Depreciation Account";
                                           END;
                                       END;
                                     //TSA001
                                   END;
                                   IF ((CreditAccNo[I] = CreditAccount) AND
                                       (CreditAccName[I] = Description) AND //KKE : #003
                                       (CreditDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                       (CreditDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                       (CreditDimValue3[I] = ShortcutDim3Code) AND
                                       (CreditDimValue4[I] = ShortcutDim4Code) AND
                                       (CreditDimValue5[I] = ShortcutDim5Code))
                                      OR (CreditAccNo[I] = '')
                                   THEN BEGIN
                                     CreditAccNo[I] := CreditAccount;
                                     GLAcc.GET(CreditAccNo[I]);
                                     //CreditAccName[I] := GLAcc.Name;
                                     CreditAccName[I] := Description;  //KKE : #003
                                     //CreditAmount[I] := CreditAmount[I] + "Credit Amount";
                                     IF VATAmount < 0 THEN
                                       CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)" - VATAmount)
                                     ELSE
                                       CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)");

                                     CreditDimValue1[I] := "Shortcut Dimension 1 Code";
                                     CreditDimValue2[I] := "Shortcut Dimension 2 Code";
                                     CreditDimValue3[I] := ShortcutDim3Code;
                                     CreditDimValue4[I] := ShortcutDim4Code;
                                     CreditDimValue5[I] := ShortcutDim5Code;
                                     MatchAcc := TRUE;
                                   END;

                                   IF "Bal. Account No." <> '' THEN BEGIN
                                     CLEAR(DebitAccount);
                                     CASE "Bal. Account Type" OF
                                       "Bal. Account Type"::"G/L Account":
                                         BEGIN
                                           DebitAccount := "Bal. Account No.";
                                         END;
                                       "Bal. Account Type"::Customer:
                                         BEGIN
                                           CustPostingGroup.GET("Posting Group");
                                           DebitAccount := CustPostingGroup."Receivables Account";
                                         END;
                                       "Bal. Account Type"::Vendor:
                                         BEGIN
                                           VendPostingGroup.GET("Posting Group");
                                           DebitAccount := VendPostingGroup."Payables Account";
                                         END;
                                       "Bal. Account Type"::"Bank Account":
                                         BEGIN
                                           BankAcc.GET("Bal. Account No.");
                                           BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                           DebitAccount := BankAccPostingGroup."G/L Bank Account No.";
                                         END;
                                       //TSA001
                                       "Bal. Account Type"::"Fixed Asset":
                                         BEGIN
                                           FADepreciationBook.RESET;
                                           FADepreciationBook.SETRANGE("FA No.","Bal. Account No.");
                                           IF FADepreciationBook.FIND('-') THEN
                                             BEGIN
                                               FAPostingGroup.GET(FADepreciationBook."FA Posting Group");
                                               CreditAccount := FAPostingGroup."Accum. Depreciation Account";
                                             END;
                                         END;
                                       //TSA001

                                     END;
                                     IF ((DebitAccNo[I] = DebitAccount) AND
                                         (DebitAccName[I] = Description) AND //KKE : #003
                                         (DebitDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                         (DebitDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                         (DebitDimValue3[I] = ShortcutDim3Code) AND
                                         (DebitDimValue4[I] = ShortcutDim4Code) AND
                                         (DebitDimValue5[I] = ShortcutDim5Code))
                                        OR (DebitAccNo[I] = '')
                                     THEN BEGIN
                                       DebitAccNo[I] := DebitAccount;
                                       GLAcc.GET(DebitAccNo[I]);
                                       //DebitAccName[I] := GLAcc.Name;
                                       DebitAccName[I] := Description;  //KKE : #003
                                       //DebitAmount[I] := DebitAmount[I] + "Credit Amount";
                                       IF BalVATAmount > 0 THEN
                                         DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)" + BalVATAmount)
                                       ELSE
                                         DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)");

                                       DebitDimValue1[I] := "Shortcut Dimension 1 Code";
                                       DebitDimValue2[I] := "Shortcut Dimension 2 Code";
                                       DebitDimValue3[I] := ShortcutDim3Code;
                                       DebitDimValue4[I] := ShortcutDim4Code;
                                       DebitDimValue5[I] := ShortcutDim5Code;
                                       MatchAcc := TRUE;
                                     END;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                               END;

                               //Insert VAT Line
                               IF GLEntryTemp.FIND('-') THEN
                               REPEAT
                               IF (GLEntryTemp."G/L Account No." <> '') AND (GLEntryTemp.Amount > 0) THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   DebitAccount := GLEntryTemp."G/L Account No.";
                                   IF ((DebitAccNo[I] = DebitAccount) AND
                                       (DebitDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                       (DebitDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                       (DebitDimValue3[I] = ShortcutDim3Code) AND
                                       (DebitDimValue4[I] = ShortcutDim4Code) AND
                                       (DebitDimValue5[I] = ShortcutDim5Code))
                                      OR (DebitAccNo[I] = '')
                                   THEN BEGIN
                                     DebitAccNo[I] := DebitAccount;
                                     GLAcc.GET(DebitAccNo[I]);
                                     DebitAccName[I] := GLAcc.Name;
                                     DebitAmount[I] := DebitAmount[I] + GLEntryTemp.Amount;

                                     DebitDimValue1[I] := "Shortcut Dimension 1 Code";
                                     DebitDimValue2[I] := "Shortcut Dimension 2 Code";
                                     DebitDimValue3[I] := ShortcutDim3Code;
                                     DebitDimValue4[I] := ShortcutDim4Code;
                                     DebitDimValue5[I] := ShortcutDim5Code;
                                     MatchAcc := TRUE;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                               END;

                               IF (GLEntryTemp."G/L Account No." <> '') AND (GLEntryTemp.Amount < 0) THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   CreditAccount := GLEntryTemp."G/L Account No.";
                                   IF ((CreditAccNo[I] = CreditAccount) AND
                                       (CreditDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                       (CreditDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                       (CreditDimValue3[I] = ShortcutDim3Code) AND
                                       (CreditDimValue4[I] = ShortcutDim4Code) AND
                                       (CreditDimValue5[I] = ShortcutDim5Code))
                                      OR (CreditAccNo[I] = '')
                                   THEN BEGIN
                                     CreditAccNo[I] := CreditAccount;
                                     GLAcc.GET(CreditAccNo[I]);
                                     CreditAccName[I] := GLAcc.Name;
                                     CreditAmount[I] := CreditAmount[I] - GLEntryTemp.Amount;

                                     CreditDimValue1[I] := "Shortcut Dimension 1 Code";
                                     CreditDimValue2[I] := "Shortcut Dimension 2 Code";
                                     CreditDimValue3[I] := ShortcutDim3Code;
                                     CreditDimValue4[I] := ShortcutDim4Code;
                                     CreditDimValue5[I] := ShortcutDim5Code;
                                     MatchAcc := TRUE;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;

                               END;
                               UNTIL GLEntryTemp.NEXT=0;
                             END;
                             //KK : #1 +
                             IF Remark[1] = '' THEN
                               //Remark[1] := GenJnlLine2.Description;
                               //002
                               Remark[1] := GenJnlLine2."Description 2";
                             //KK : #1 -

                           UNTIL GenJnlLine2.NEXT=0;
                         END;

        ReqFilterFields=Journal Template Name,Journal Batch Name,Document No.;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=28600;
            SectionHeight=4000;
          }
          CONTROLS
          {
            { 1000000061;TextBox;150  ;200  ;9700 ;565  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000135;Label  ;22850;1685 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=NO...................................... }
            { 1000000136;TextBox;23900;1685 ;3150 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Document No." }
            { 1000000141;Label  ;22850;2235 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DATE................................... }
            { 1000000142;TextBox;23900;2235 ;3150 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Posting Date" }
            { 1000000062;Label  ;11000;950  ;7600 ;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=JOURNAL VOUCHER }
            { 1000000110;Shape  ;15   ;2885 ;27860;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000111;Label  ;24700;3150 ;3115 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CREDIT }
            { 1000000112;Shape  ;24400;2900 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000113;Label  ;21100;3150 ;3065 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DEBIT }
            { 1000000114;Shape  ;13150;2900 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000116;Shape  ;10700;2900 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000118;Shape  ;2650 ;2885 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000042;Label  ;2800 ;3150 ;7900 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=ACCOUNT NAME }
            { 1000000044;Label  ;150  ;3150 ;2500 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=ACCOUNT NO. }
            { 1000000036;Shape  ;15   ;3970 ;27860;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000037;Shape  ;27860;2900 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000038;Shape  ;0    ;2900 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000074;Shape  ;15650;2900 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000012;TextBox;10850;3150 ;2300 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ShortcutDimCode[1] }
            { 1000000014;TextBox;13350;3150 ;2300 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ShortcutDimCode[2] }
            { 1000000015;TextBox;15800;3150 ;2300 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ShortcutDimCode[3] }
            { 1000000017;TextBox;18350;3150 ;2300 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ShortcutDimCode[4] }
            { 1000000028;Shape  ;18100;2900 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000031;Shape  ;20750;2900 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000034;TextBox;22850;300  ;5200 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr='Tax ID No. ' + CompanyInfo."VAT Registration No." }
            { 1000000053;TextBox;150  ;2150 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr='Tel: ' + CompanyInfo."Phone No." + ' Fax: ' + CompanyInfo."Fax No." }
            { 1000000055;TextBox;150  ;1500 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000057;TextBox;150  ;850  ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" }
            { 1000000059;Label  ;22850;1000 ;1450 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Batch No : }
            { 1000000060;TextBox;24300;1000 ;3750 ;550  ;SourceExpr=GenJnlLine."Journal Batch Name" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=28600;
            SectionHeight=900;
          }
          CONTROLS
          {
            { 1000000091;Label  ;19700;50   ;1000 ;700  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total }
            { 1000000093;TextBox;21000;50   ;3070 ;700  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitTotalLCY }
            { 1000000094;TextBox;24550;50   ;3200 ;700  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditTotalLCY }
            { 1000000095;Shape  ;0    ;0    ;30   ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000097;Shape  ;27860;0    ;30   ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000099;Shape  ;20750;0    ;150  ;850  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000102;Shape  ;24400;0    ;150  ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000186;Shape  ;15   ;820  ;27860;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000033;Shape  ;15   ;0    ;27860;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=28600;
            SectionHeight=0;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           DebitTotalLCY := 0;
                           CreditTotalLCY := 0;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=28600;
            SectionHeight=4730;
          }
          CONTROLS
          {
            { 1000000104;Shape  ;27860;0    ;30   ;4700 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000105;TextBox;1185 ;850  ;16080;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Remark[1] }
            { 1000000106;TextBox;1185 ;1450 ;16080;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Remark[2] }
            { 1000000107;TextBox;1185 ;2050 ;16080;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Remark[3] }
            { 1000000108;Shape  ;15   ;2700 ;27860;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000109;Label  ;135  ;200  ;2550 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=DESCRIPTION }
            { 1000000115;Shape  ;0    ;4700 ;27860;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000117;Shape  ;0    ;0    ;30   ;4700 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000119;Shape  ;15   ;0    ;27860;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000003;Label  ;1750 ;3050 ;2075 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By : }
            { 1000000004;Shape  ;3715 ;3350 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000005;Label  ;11280;3050 ;2275 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Acct.Entry By : }
            { 1000000006;Shape  ;13465;3350 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000007;Label  ;11300;4000 ;2335 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved By : }
            { 1000000009;Label  ;1750 ;4000 ;2045 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Checked By : }
            { 1000000010;Shape  ;13485;4300 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000011;Shape  ;3665 ;4300 ;5200 ;150  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            SectionWidth=28600;
            SectionHeight=0;
            OnPreSection=BEGIN
                           Line := 1;
                         END;

          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitDetail;
        OnPreDataItem=BEGIN
                        // KK : #2 +
                        Line := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF DebitAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=28600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           DebitTotalLCY := DebitTotalLCY + DebitAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;10850;50   ;2300 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitDimValue1[Number] }
            { 1000000001;TextBox;2800 ;50   ;7900 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccName[Number] }
            { 1000000002;TextBox;13350;50   ;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitDimValue2[Number];
                                                         AutoFormatType=1 }
            { 1000000071;TextBox;150  ;50   ;2500 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccNo[Number] }
            { 1000000140;Shape  ;27860;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000143;Shape  ;15650;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000144;Shape  ;13150;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000145;Shape  ;10700;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000146;Shape  ;2650 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000155;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000008;Shape  ;18100;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000013;TextBox;15800;50   ;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitDimValue3[Number];
                                                         AutoFormatType=1 }
            { 1000000030;TextBox;18350;50   ;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitDimValue4[Number];
                                                         AutoFormatType=1 }
            { 1000000035;Shape  ;20750;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000040;Shape  ;24400;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000051;TextBox;21100;50   ;3100 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAmount[Number];
                                                         AutoFormatType=1 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditDetail;
        OnAfterGetRecord=BEGIN
                           IF CreditAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=28600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CreditTotalLCY := CreditTotalLCY + CreditAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000018;TextBox;10850;50   ;2300 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditDimValue1[Number] }
            { 1000000019;TextBox;2800 ;50   ;7900 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccName[Number] }
            { 1000000020;TextBox;24550;50   ;3200 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000195;Shape  ;27860;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000199;Shape  ;24400;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000200;Shape  ;13150;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000201;Shape  ;10700;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000202;Shape  ;2650 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000204;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000016;TextBox;150  ;50   ;2500 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccNo[Number] }
            { 1000000041;Shape  ;20750;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000046;TextBox;18350;50   ;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditDimValue4[Number];
                                                         AutoFormatType=1 }
            { 1000000047;Shape  ;18100;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;TextBox;15800;50   ;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditDimValue3[Number];
                                                         AutoFormatType=1 }
            { 1000000049;Shape  ;15650;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000050;TextBox;13350;50   ;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditDimValue2[Number];
                                                         AutoFormatType=1 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=LineLoop;
        OnAfterGetRecord=BEGIN
                           IF Line + Number > 15 THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=28600;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000021;Shape  ;27860;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000024;Shape  ;13150;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000025;Shape  ;10700;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000026;Shape  ;2650 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000032;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000023;Shape  ;24400;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000052;Shape  ;20750;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000056;Shape  ;18100;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000058;Shape  ;15650;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=11440;
      Height=3960;
      SaveValues=Yes;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000003 : Record 79;
      Vendor@1000000025 : Record 23;
      VendPostingGroup@1000000005 : Record 93;
      Customer@1000000026 : Record 18;
      CustLedgEntry@1000000081 : Record 21;
      CustPostingGroup@1000000004 : Record 92;
      GLSetup@1000000008 : Record 98;
      GLAcc@1000000022 : Record 15;
      BankAcc@1000000030 : Record 270;
      BankAccPostingGroup@1000000002 : Record 277;
      WHTPostingSetup@1000000085 : Record 28043;
      SalesInvLine@1000000084 : Record 113;
      GenJnlLine@1000000045 : Record 81;
      GenJnlLine2@1000000065 : Record 81;
      JournalLineDim@1000000028 : Record 356;
      GLEntryTemp@1000000031 : TEMPORARY Record 17;
      GenJnlPostLine@1000000029 : Codeunit 12;
      DebitTotalLCY@1000000000 : Decimal;
      CreditTotalLCY@1000000001 : Decimal;
      Remark@1000000048 : ARRAY [3] OF Text[50];
      Line@1000000034 : Integer;
      DebitType@1000000064 : ARRAY [30] OF Code[1];
      CreditType@1000000061 : ARRAY [30] OF Code[1];
      DebitAccount@1000000006 : Code[20];
      CreditAccount@1000000007 : Code[20];
      DebitAccNo@1000000035 : ARRAY [300] OF Code[20];
      CreditAccNo@1000000036 : ARRAY [300] OF Code[20];
      DebitAccName@1000000044 : ARRAY [300] OF Text[50];
      CreditAccName@1000000043 : ARRAY [300] OF Text[50];
      DebitAmount@1000000067 : ARRAY [300] OF Decimal;
      CreditAmount@1000000071 : ARRAY [300] OF Decimal;
      DebitDimValue1@1000000010 : ARRAY [300] OF Code[20];
      DebitDimValue2@1000000011 : ARRAY [300] OF Code[20];
      DebitDimValue3@1000000012 : ARRAY [300] OF Code[20];
      DebitDimValue4@1000000014 : ARRAY [300] OF Code[20];
      DebitDimValue5@1000000015 : ARRAY [300] OF Code[20];
      CreditDimValue1@1000000013 : ARRAY [300] OF Code[20];
      CreditDimValue2@1000000017 : ARRAY [300] OF Code[20];
      CreditDimValue3@1000000018 : ARRAY [300] OF Code[20];
      CreditDimValue4@1000000019 : ARRAY [300] OF Code[20];
      CreditDimValue5@1000000020 : ARRAY [300] OF Code[20];
      MatchAcc@1000000037 : Boolean;
      I@1000000042 : Integer;
      ShortcutDimCode@1000000009 : ARRAY [8] OF Code[20];
      ShortcutDim3Code@1000000021 : Code[20];
      ShortcutDim4Code@1000000024 : Code[20];
      ShortcutDim5Code@1000000027 : Code[20];
      VATAmount@1000000032 : Decimal;
      BalVATAmount@1000000016 : Decimal;
      FixedAsset@1000000033 : Record 5600;
      FAPostingGroup@1000000023 : Record 5606;
      FADepreciationBook@1000000038 : Record 5612;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut
      GKU : Goragot Kuanmuang

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Journal Voucher Report.
                               -Accounting user would like to add description on journal line into description in Journal voucher.
                               -User would like to show footer on every page.
      Project: Burda
      002   31.08.2007   GKU   -Edit Format report
                               -Add word total amount
                               -Edit footer Description use "Gen. Journal Line".description2
      003   17.09.2007   KKE   -add criteria to group data by description. (request by p'Nok)
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50015 Sales Voucher
{
  OBJECT-PROPERTIES
  {
    Date=09/15/06;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   CompanyInfo.GET;
                   CompanyInfo.CALCFIELDS(Picture);
                 END;

    OnPreReport=BEGIN
                  DebitTotalLCY := 0;
                  CreditTotalLCY := 0;

                  GLSetup.GetShortcutDimCode(ShortcutDimCode);
                END;

    Orientation=Landscape;
    HorzGrid=50;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table81;
        DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Posting Date,Document No.);
        NewPagePerGroup=Yes;
        OnAfterGetRecord=BEGIN
                           IF "Document No." = GenJnlLine."Document No." THEN
                             CurrReport.SKIP
                           ELSE
                             GenJnlLine := "Gen. Journal Line";

                           CLEAR(DebitType);
                           CLEAR(DebitAccNo);
                           CLEAR(DebitAccName);
                           CLEAR(DebitDimValue1);
                           CLEAR(DebitDimValue2);
                           CLEAR(DebitDimValue3);
                           CLEAR(DebitDimValue4);
                           CLEAR(DebitDimValue5);
                           CLEAR(DebitAmount);
                           CLEAR(DebitExtDocNo);
                           CLEAR(DebitVendName);
                           CLEAR(CreditType);
                           CLEAR(CreditAccNo);
                           CLEAR(CreditAccName);
                           CLEAR(CreditDimValue1);
                           CLEAR(CreditDimValue2);
                           CLEAR(CreditDimValue3);
                           CLEAR(CreditDimValue4);
                           CLEAR(CreditDimValue5);
                           CLEAR(CreditAmount);
                           CLEAR(CreditExtDocNo);
                           CLEAR(CreditVendName);
                           CLEAR(Remark);

                           GenJnlLine2.RESET;
                           GenJnlLine2.SETRANGE("Journal Template Name","Journal Template Name");
                           GenJnlLine2.SETRANGE("Journal Batch Name","Journal Batch Name");
                           GenJnlLine2.SETRANGE("Document No.","Document No.");
                           IF GenJnlLine2.FIND('-') THEN
                           REPEAT
                             WITH GenJnlLine2 DO BEGIN
                               //VAT Calculation
                               CLEAR(VATAmount);
                               CLEAR(BalVATAmount);
                               CLEAR(GenJnlPostLine);
                               IF GLEntryTemp.COUNT <> 0 THEN
                                 GLEntryTemp.DELETEALL;
                               GenJnlPostLine.CheckVATGLEntry(GenJnlLine2,GLEntryTemp);
                               IF GLEntryTemp.FIND('-') THEN
                               REPEAT
                                 IF GLEntryTemp."Entry No." = 1 THEN
                                   VATAmount := GLEntryTemp.Amount
                                 ELSE
                                   BalVATAmount := GLEntryTemp.Amount;
                               UNTIL GLEntryTemp.NEXT=0;

                               //Get Dimension3-5
                               CLEAR(ShortcutDim3Code);
                               CLEAR(ShortcutDim4Code);
                               CLEAR(ShortcutDim5Code);
                               IF JournalLineDim.GET(81,"Journal Template Name","Journal Batch Name","Line No.",0,ShortcutDimCode[3]) THEN
                                 ShortcutDim3Code := JournalLineDim."Dimension Value Code";
                               IF JournalLineDim.GET(81,"Journal Template Name","Journal Batch Name","Line No.",0,ShortcutDimCode[4]) THEN
                                 ShortcutDim4Code := JournalLineDim."Dimension Value Code";
                               IF JournalLineDim.GET(81,"Journal Template Name","Journal Batch Name","Line No.",0,ShortcutDimCode[5]) THEN
                                 ShortcutDim5Code := JournalLineDim."Dimension Value Code";

                               //Insert Line
                               IF "Debit Amount" <> 0 THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   CLEAR(DebitAccount);
                                   CASE "Account Type" OF
                                     "Account Type"::"G/L Account":
                                       BEGIN
                                         DebitAccount := "Account No.";
                                       END;
                                     "Account Type"::Customer:
                                       BEGIN
                                         CustPostingGroup.GET("Posting Group");
                                         DebitAccount := CustPostingGroup."Receivables Account";
                                       END;
                                     "Account Type"::Vendor:
                                       BEGIN
                                         VendPostingGroup.GET("Posting Group");
                                         DebitAccount := VendPostingGroup."Payables Account";
                                       END;
                                     "Account Type"::"Bank Account":
                                       BEGIN
                                         BankAcc.GET("Account No.");
                                         BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                         DebitAccount := BankAccPostingGroup."G/L Bank Account No.";
                                       END;
                                   END;
                                   IF ((DebitAccNo[I] = DebitAccount) AND
                                       (DebitDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                       (DebitDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                       (DebitDimValue3[I] = ShortcutDim3Code) AND
                                       (DebitDimValue4[I] = ShortcutDim4Code) AND
                                       (DebitDimValue5[I] = ShortcutDim5Code))
                                      OR (DebitAccNo[I] = '')
                                   THEN BEGIN
                                     DebitAccNo[I] := DebitAccount;
                                     GLAcc.GET(DebitAccNo[I]);
                                     DebitAccName[I] := GLAcc.Name;
                                     //DebitAmount[I] := DebitAmount[I] + "Debit Amount";
                                     IF VATAmount > 0 THEN
                                       DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)" - VATAmount)
                                     ELSE
                                       DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)");

                                     DebitDimValue1[I] := "Shortcut Dimension 1 Code";
                                     DebitDimValue2[I] := "Shortcut Dimension 2 Code";
                                     DebitDimValue3[I] := ShortcutDim3Code;
                                     DebitDimValue4[I] := ShortcutDim4Code;
                                     DebitDimValue5[I] := ShortcutDim5Code;
                                     IF "External Document No." <> '' THEN
                                       DebitExtDocNo[I] := "External Document No.";
                                     MatchAcc := TRUE;
                                   END;

                                   IF "Bal. Account No." <> '' THEN BEGIN
                                     CLEAR(CreditAccount);
                                     CASE "Bal. Account Type" OF
                                       "Bal. Account Type"::"G/L Account":
                                         BEGIN
                                           CreditAccount := "Bal. Account No.";
                                         END;
                                       "Bal. Account Type"::Customer:
                                         BEGIN
                                           CustPostingGroup.GET("Posting Group");
                                           CreditAccount := CustPostingGroup."Receivables Account";
                                         END;
                                       "Bal. Account Type"::Vendor:
                                         BEGIN
                                           VendPostingGroup.GET("Posting Group");
                                           CreditAccount := VendPostingGroup."Payables Account";
                                         END;
                                       "Bal. Account Type"::"Bank Account":
                                         BEGIN
                                           BankAcc.GET("Bal. Account No.");
                                           BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                           CreditAccount := BankAccPostingGroup."G/L Bank Account No.";
                                         END;
                                     END;
                                     IF ((CreditAccNo[I] = CreditAccount) AND
                                         (CreditDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                         (CreditDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                         (CreditDimValue3[I] = ShortcutDim3Code) AND
                                         (CreditDimValue4[I] = ShortcutDim4Code) AND
                                         (CreditDimValue5[I] = ShortcutDim5Code))
                                        OR (CreditAccNo[I] = '')
                                     THEN BEGIN
                                       CreditAccNo[I] := CreditAccount;
                                       GLAcc.GET(CreditAccNo[I]);
                                       CreditAccName[I] := GLAcc.Name;
                                       //CreditAmount[I] := CreditAmount[I] + "Debit Amount";
                                       IF BalVATAmount < 0 THEN
                                         CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)" + BalVATAmount)
                                       ELSE
                                         CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)");

                                       CreditDimValue1[I] := "Shortcut Dimension 1 Code";
                                       CreditDimValue2[I] := "Shortcut Dimension 2 Code";
                                       CreditDimValue3[I] := ShortcutDim3Code;
                                       CreditDimValue4[I] := ShortcutDim4Code;
                                       CreditDimValue5[I] := ShortcutDim5Code;
                                       IF "External Document No." <> '' THEN
                                         CreditExtDocNo[I] := "External Document No.";
                                       MatchAcc := TRUE;
                                     END;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                               END ELSE
                               IF "Credit Amount" <> 0 THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   CLEAR(CreditAccount);
                                   CASE "Account Type" OF
                                     "Account Type"::"G/L Account":
                                       BEGIN
                                         CreditAccount := "Account No.";
                                       END;
                                     "Account Type"::Customer:
                                       BEGIN
                                         CustPostingGroup.GET("Posting Group");
                                         CreditAccount := CustPostingGroup."Receivables Account";
                                       END;
                                     "Account Type"::Vendor:
                                       BEGIN
                                         VendPostingGroup.GET("Posting Group");
                                         CreditAccount := VendPostingGroup."Payables Account";
                                       END;
                                     "Account Type"::"Bank Account":
                                       BEGIN
                                         BankAcc.GET("Account No.");
                                         BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                         CreditAccount := BankAccPostingGroup."G/L Bank Account No.";
                                       END;
                                   END;
                                   IF ((CreditAccNo[I] = CreditAccount) AND
                                       (CreditDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                       (CreditDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                       (CreditDimValue3[I] = ShortcutDim3Code) AND
                                       (CreditDimValue4[I] = ShortcutDim4Code) AND
                                       (CreditDimValue5[I] = ShortcutDim5Code))
                                      OR (CreditAccNo[I] = '')
                                   THEN BEGIN
                                     CreditAccNo[I] := CreditAccount;
                                     GLAcc.GET(CreditAccNo[I]);
                                     CreditAccName[I] := GLAcc.Name;
                                     //CreditAmount[I] := CreditAmount[I] + "Credit Amount";
                                     IF VATAmount < 0 THEN
                                       CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)" - VATAmount)
                                     ELSE
                                       CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)");

                                     CreditDimValue1[I] := "Shortcut Dimension 1 Code";
                                     CreditDimValue2[I] := "Shortcut Dimension 2 Code";
                                     CreditDimValue3[I] := ShortcutDim3Code;
                                     CreditDimValue4[I] := ShortcutDim4Code;
                                     CreditDimValue5[I] := ShortcutDim5Code;
                                     IF "External Document No." <> '' THEN
                                       CreditExtDocNo[I] := "External Document No.";
                                     MatchAcc := TRUE;
                                   END;

                                   IF "Bal. Account No." <> '' THEN BEGIN
                                     CLEAR(DebitAccount);
                                     CASE "Bal. Account Type" OF
                                       "Bal. Account Type"::"G/L Account":
                                         BEGIN
                                           DebitAccount := "Bal. Account No.";
                                         END;
                                       "Bal. Account Type"::Customer:
                                         BEGIN
                                           CustPostingGroup.GET("Posting Group");
                                           DebitAccount := CustPostingGroup."Receivables Account";
                                         END;
                                       "Bal. Account Type"::Vendor:
                                         BEGIN
                                           VendPostingGroup.GET("Posting Group");
                                           DebitAccount := VendPostingGroup."Payables Account";
                                         END;
                                       "Bal. Account Type"::"Bank Account":
                                         BEGIN
                                           BankAcc.GET("Bal. Account No.");
                                           BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                           DebitAccount := BankAccPostingGroup."G/L Bank Account No.";
                                         END;
                                     END;
                                     IF ((DebitAccNo[I] = DebitAccount) AND
                                         (DebitDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                         (DebitDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                         (DebitDimValue3[I] = ShortcutDim3Code) AND
                                         (DebitDimValue4[I] = ShortcutDim4Code) AND
                                         (DebitDimValue5[I] = ShortcutDim5Code))
                                        OR (DebitAccNo[I] = '')
                                     THEN BEGIN
                                       DebitAccNo[I] := DebitAccount;
                                       GLAcc.GET(DebitAccNo[I]);
                                       DebitAccName[I] := GLAcc.Name;
                                       //DebitAmount[I] := DebitAmount[I] + "Credit Amount";
                                       IF BalVATAmount > 0 THEN
                                         DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)" + BalVATAmount)
                                       ELSE
                                         DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)");

                                       DebitDimValue1[I] := "Shortcut Dimension 1 Code";
                                       DebitDimValue2[I] := "Shortcut Dimension 2 Code";
                                       DebitDimValue3[I] := ShortcutDim3Code;
                                       DebitDimValue4[I] := ShortcutDim4Code;
                                       DebitDimValue5[I] := ShortcutDim5Code;
                                       IF "External Document No." <> '' THEN
                                         DebitExtDocNo[I] := "External Document No.";
                                       MatchAcc := TRUE;
                                     END;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                               END;

                               //Insert VAT Line
                               IF GLEntryTemp.FIND('-') THEN
                               REPEAT
                               IF (GLEntryTemp."G/L Account No." <> '') AND (GLEntryTemp.Amount > 0) THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   DebitAccount := GLEntryTemp."G/L Account No.";
                                   IF ((DebitAccNo[I] = DebitAccount) AND
                                       (DebitDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                       (DebitDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                       (DebitDimValue3[I] = ShortcutDim3Code) AND
                                       (DebitDimValue4[I] = ShortcutDim4Code) AND
                                       (DebitDimValue5[I] = ShortcutDim5Code))
                                      OR (DebitAccNo[I] = '')
                                   THEN BEGIN
                                     DebitAccNo[I] := DebitAccount;
                                     GLAcc.GET(DebitAccNo[I]);
                                     DebitAccName[I] := GLAcc.Name;
                                     DebitAmount[I] := DebitAmount[I] + GLEntryTemp.Amount;

                                     DebitDimValue1[I] := "Shortcut Dimension 1 Code";
                                     DebitDimValue2[I] := "Shortcut Dimension 2 Code";
                                     DebitDimValue3[I] := ShortcutDim3Code;
                                     DebitDimValue4[I] := ShortcutDim4Code;
                                     DebitDimValue5[I] := ShortcutDim5Code;
                                     MatchAcc := TRUE;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                               END;

                               IF (GLEntryTemp."G/L Account No." <> '') AND (GLEntryTemp.Amount < 0) THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   CreditAccount := GLEntryTemp."G/L Account No.";
                                   IF ((CreditAccNo[I] = CreditAccount) AND
                                       (CreditDimValue1[I] = "Shortcut Dimension 1 Code") AND
                                       (CreditDimValue2[I] = "Shortcut Dimension 2 Code") AND
                                       (CreditDimValue3[I] = ShortcutDim3Code) AND
                                       (CreditDimValue4[I] = ShortcutDim4Code) AND
                                       (CreditDimValue5[I] = ShortcutDim5Code))
                                      OR (CreditAccNo[I] = '')
                                   THEN BEGIN
                                     CreditAccNo[I] := CreditAccount;
                                     GLAcc.GET(CreditAccNo[I]);
                                     CreditAccName[I] := GLAcc.Name;
                                     CreditAmount[I] := CreditAmount[I] - GLEntryTemp.Amount;

                                     CreditDimValue1[I] := "Shortcut Dimension 1 Code";
                                     CreditDimValue2[I] := "Shortcut Dimension 2 Code";
                                     CreditDimValue3[I] := ShortcutDim3Code;
                                     CreditDimValue4[I] := ShortcutDim4Code;
                                     CreditDimValue5[I] := ShortcutDim5Code;
                                     MatchAcc := TRUE;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;

                               END;
                               UNTIL GLEntryTemp.NEXT=0;
                             END;
                             //KK : #1 +
                             IF Remark[1] = '' THEN
                               Remark[1] := GenJnlLine2.Description;
                             //KK : #1 -

                           UNTIL GenJnlLine2.NEXT=0;
                         END;

        ReqFilterFields=Journal Template Name,Journal Batch Name,Document No.;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=29600;
            SectionHeight=3765;
          }
          CONTROLS
          {
            { 1000000061;TextBox;7300 ;450  ;14300;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000135;Label  ;23450;1400 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=NO...................................... }
            { 1000000136;TextBox;24500;1400 ;3150 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Document No." }
            { 1000000141;Label  ;23450;1950 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DATE................................... }
            { 1000000142;TextBox;24500;1950 ;3150 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Posting Date" }
            { 1000000060;PictureBox;100;0   ;5850 ;2350 ;SourceExpr=CompanyInfo.Picture }
            { 1000000062;Label  ;10650;1450 ;7600 ;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=SALES VOUCHER }
            { 1000000110;Shape  ;15   ;2650 ;28100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000111;Label  ;17590;2915 ;3115 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CREDIT }
            { 1000000112;Shape  ;17400;2650 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000113;Label  ;14300;2915 ;3065 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DEBIT }
            { 1000000114;Shape  ;11650;2650 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000116;Shape  ;9200 ;2665 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000118;Shape  ;2650 ;2650 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000042;Label  ;2800 ;2915 ;6400 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=ACCOUNT NAME }
            { 1000000044;Label  ;150  ;2915 ;2500 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=ACCOUNT NO. }
            { 1000000036;Shape  ;15   ;3735 ;28100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000037;Shape  ;28100;2665 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000038;Shape  ;0    ;2665 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000012;TextBox;9350 ;2950 ;2300 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ShortcutDimCode[1] }
            { 1000000014;TextBox;11800;2950 ;2300 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=ShortcutDimCode[2] }
            { 1000000031;Shape  ;14100;2650 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000008;Label  ;23650;2900 ;3115 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=Customer Name }
            { 1000000013;Shape  ;23500;2650 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000015;Label  ;20900;2900 ;2600 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=External Doc. No. }
            { 1000000017;Shape  ;20750;2650 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=29600;
            SectionHeight=900;
          }
          CONTROLS
          {
            { 1000000091;Label  ;12400;50   ;1000 ;700  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total }
            { 1000000093;TextBox;14300;50   ;3070 ;700  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitTotalLCY }
            { 1000000094;TextBox;17550;50   ;3110 ;700  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditTotalLCY }
            { 1000000095;Shape  ;0    ;0    ;30   ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000097;Shape  ;28100;0    ;30   ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000099;Shape  ;14100;0    ;150  ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000102;Shape  ;17400;0    ;150  ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000186;Shape  ;15   ;820  ;28100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000033;Shape  ;15   ;0    ;28100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000047;Shape  ;23500;0    ;150  ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;Shape  ;20750;0    ;150  ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=29600;
            SectionHeight=0;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           DebitTotalLCY := 0;
                           CreditTotalLCY := 0;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            SectionWidth=29600;
            SectionHeight=4730;
            OnPreSection=BEGIN
                           Line := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000104;Shape  ;28100;0    ;30   ;4700 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000105;TextBox;1185 ;850  ;16080;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Remark[1] }
            { 1000000106;TextBox;1185 ;1450 ;16080;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Remark[2] }
            { 1000000107;TextBox;1185 ;2050 ;16080;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Remark[3] }
            { 1000000108;Shape  ;15   ;2700 ;28100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000109;Label  ;135  ;200  ;2550 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=DESCRIPTION }
            { 1000000115;Shape  ;0    ;4700 ;28100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000117;Shape  ;0    ;0    ;30   ;4700 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000119;Shape  ;15   ;0    ;28100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000003;Label  ;1750 ;3050 ;2075 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By : }
            { 1000000004;Shape  ;3715 ;3350 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000005;Label  ;11280;3050 ;2275 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Acct.Entry By : }
            { 1000000006;Shape  ;13465;3350 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000007;Label  ;11300;4000 ;2335 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved By : }
            { 1000000009;Label  ;1750 ;4000 ;2045 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Checked By : }
            { 1000000010;Shape  ;13485;4300 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000011;Shape  ;3665 ;4300 ;5200 ;150  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitDetail;
        OnPreDataItem=BEGIN
                        // KK : #2 +
                        Line := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF DebitAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=29600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           DebitTotalLCY := DebitTotalLCY + DebitAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;9350 ;50   ;2300 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitDimValue1[Number] }
            { 1000000001;TextBox;2800 ;50   ;6400 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccName[Number] }
            { 1000000002;TextBox;11800;50   ;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitDimValue2[Number];
                                                         AutoFormatType=1 }
            { 1000000071;TextBox;150  ;50   ;2500 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccNo[Number] }
            { 1000000140;Shape  ;28100;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000144;Shape  ;11650;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000145;Shape  ;9200 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000146;Shape  ;2650 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000155;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000035;Shape  ;14100;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000040;Shape  ;17400;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000051;TextBox;14250;50   ;3100 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000022;TextBox;20900;50   ;2600 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitExtDocNo[Number] }
            { 1000000027;Shape  ;20750;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000028;Shape  ;23500;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000029;TextBox;23700;50   ;4350 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVendName[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditDetail;
        OnAfterGetRecord=BEGIN
                           IF CreditAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=29600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CreditTotalLCY := CreditTotalLCY + CreditAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000018;TextBox;9350 ;50   ;2300 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditDimValue1[Number] }
            { 1000000019;TextBox;2800 ;50   ;6400 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccName[Number] }
            { 1000000020;TextBox;17600;50   ;3030 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000195;Shape  ;28100;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000199;Shape  ;17400;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000200;Shape  ;11650;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000201;Shape  ;9200 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000202;Shape  ;2650 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000204;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000016;TextBox;150  ;50   ;2500 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccNo[Number] }
            { 1000000041;Shape  ;14100;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000050;TextBox;11800;50   ;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditDimValue2[Number];
                                                         AutoFormatType=1 }
            { 1000000030;Shape  ;20750;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000034;TextBox;20900;50   ;2600 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditExtDocNo[Number] }
            { 1000000039;Shape  ;23500;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000043;TextBox;23700;50   ;4350 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVendName[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=LineLoop;
        OnAfterGetRecord=BEGIN
                           IF Line + Number > 15 THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=29600;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000021;Shape  ;28100;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000024;Shape  ;11650;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000025;Shape  ;9200 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000026;Shape  ;2650 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000032;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000023;Shape  ;17400;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000052;Shape  ;14100;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000045;Shape  ;20750;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000046;Shape  ;23500;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=11440;
      Height=3960;
      SaveValues=Yes;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000003 : Record 79;
      Vendor@1000000025 : Record 23;
      VendPostingGroup@1000000005 : Record 93;
      Customer@1000000026 : Record 18;
      CustLedgEntry@1000000081 : Record 21;
      CustPostingGroup@1000000004 : Record 92;
      GLSetup@1000000008 : Record 98;
      GLAcc@1000000022 : Record 15;
      BankAcc@1000000030 : Record 270;
      BankAccPostingGroup@1000000002 : Record 277;
      WHTPostingSetup@1000000085 : Record 28043;
      SalesInvLine@1000000084 : Record 113;
      GenJnlLine@1000000045 : Record 81;
      GenJnlLine2@1000000065 : Record 81;
      JournalLineDim@1000000028 : Record 356;
      GLEntryTemp@1000000031 : TEMPORARY Record 17;
      GenJnlPostLine@1000000029 : Codeunit 12;
      DebitTotalLCY@1000000000 : Decimal;
      CreditTotalLCY@1000000001 : Decimal;
      Remark@1000000048 : ARRAY [3] OF Text[50];
      Line@1000000034 : Integer;
      DebitType@1000000064 : ARRAY [30] OF Code[1];
      CreditType@1000000061 : ARRAY [30] OF Code[1];
      DebitAccount@1000000006 : Code[20];
      CreditAccount@1000000007 : Code[20];
      DebitAccNo@1000000035 : ARRAY [300] OF Code[20];
      CreditAccNo@1000000036 : ARRAY [300] OF Code[20];
      DebitAccName@1000000044 : ARRAY [300] OF Text[50];
      CreditAccName@1000000043 : ARRAY [300] OF Text[50];
      DebitAmount@1000000067 : ARRAY [300] OF Decimal;
      CreditAmount@1000000071 : ARRAY [300] OF Decimal;
      DebitDimValue1@1000000010 : ARRAY [300] OF Code[20];
      DebitDimValue2@1000000011 : ARRAY [300] OF Code[20];
      DebitDimValue3@1000000012 : ARRAY [300] OF Code[20];
      DebitDimValue4@1000000014 : ARRAY [300] OF Code[20];
      DebitDimValue5@1000000015 : ARRAY [300] OF Code[20];
      CreditDimValue1@1000000013 : ARRAY [300] OF Code[20];
      CreditDimValue2@1000000017 : ARRAY [300] OF Code[20];
      CreditDimValue3@1000000018 : ARRAY [300] OF Code[20];
      CreditDimValue4@1000000019 : ARRAY [300] OF Code[20];
      CreditDimValue5@1000000020 : ARRAY [300] OF Code[20];
      MatchAcc@1000000037 : Boolean;
      I@1000000042 : Integer;
      DebitExtDocNo@1000000033 : ARRAY [300] OF Code[20];
      CreditExtDocNo@1000000023 : ARRAY [300] OF Code[20];
      DebitVendName@1000000039 : ARRAY [300] OF Text[150];
      CreditVendName@1000000038 : ARRAY [300] OF Text[150];
      ShortcutDimCode@1000000009 : ARRAY [8] OF Code[20];
      ShortcutDim3Code@1000000021 : Code[20];
      ShortcutDim4Code@1000000024 : Code[20];
      ShortcutDim5Code@1000000027 : Code[20];
      VATAmount@1000000032 : Decimal;
      BalVATAmount@1000000016 : Decimal;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Sales Voucher Report.
                               -Accounting user would like to add description on journal line into description in Journal voucher.
                               -User would like to show footer on every page.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50016 Purchase Voucher
{
  OBJECT-PROPERTIES
  {
    Date=03/01/06;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   CompanyInfo.GET;
                   CompanyInfo.CALCFIELDS(Picture);
                 END;

    OnPreReport=BEGIN
                  DebitTotalLCY := 0;
                  CreditTotalLCY := 0;
                END;

    Orientation=Landscape;
    PaperSize=A4 210 x 297 mm;
    HorzGrid=100;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table81;
        DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Posting Date,Document No.);
        NewPagePerGroup=Yes;
        OnAfterGetRecord=BEGIN
                           IF "Document No." = GenJnlLine."Document No." THEN
                             CurrReport.SKIP
                           ELSE
                             GenJnlLine := "Gen. Journal Line";

                           CLEAR(DebitAccNo);
                           CLEAR(DebitAccName);
                           CLEAR(DebitDimValue);
                           CLEAR(DebitExtDocNo);
                           CLEAR(DebitVendName);
                           CLEAR(DebitAmount);
                           CLEAR(CreditAccNo);
                           CLEAR(CreditAccName);
                           CLEAR(CreditDimValue);
                           CLEAR(CreditExtDocNo);
                           CLEAR(CreditVendName);
                           CLEAR(CreditAmount);

                           GenJnlLine2.RESET;
                           GenJnlLine2.SETRANGE("Journal Template Name","Journal Template Name");
                           GenJnlLine2.SETRANGE("Journal Batch Name","Journal Batch Name");
                           GenJnlLine2.SETRANGE("Document No.","Document No.");
                           IF GenJnlLine2.FIND('-') THEN
                           REPEAT
                             WITH GenJnlLine2 DO BEGIN
                               IF "Debit Amount" <> 0 THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   //IF (DebitAccNo[I] = "Account No.") OR (DebitAccNo[I] = '') THEN BEGIN
                                   IF (DebitAccNo[I] = '') THEN BEGIN
                                     CASE "Account Type" OF
                                       "Account Type"::"G/L Account":
                                         BEGIN
                                           DebitAccNo[I] := "Account No.";
                                         END;
                                       "Account Type"::Customer:
                                         BEGIN
                                           CustPostingGroup.GET("Posting Group");
                                           DebitAccNo[I] := CustPostingGroup."Receivables Account";
                                         END;
                                       "Account Type"::Vendor:
                                         BEGIN
                                           VendPostingGroup.GET("Posting Group");
                                           DebitAccNo[I] := VendPostingGroup."Payables Account";
                                         END;
                                       "Account Type"::"Bank Account":
                                         BEGIN
                                           BankAcc.GET("Account No.");
                                           BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                           DebitAccNo[I] := BankAccPostingGroup."G/L Bank Account No.";
                                         END;
                                     END;
                                     GLAcc.GET(DebitAccNo[I]);
                                     DebitAccName[I] := GLAcc.Name + ' ' + Description;
                                     DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)") - ABS("VAT Amount");
                                     //DebitAmount[I] := DebitAmount[I] + "Debit Amount" - ABS("VAT Amount") - ABS("Bal. VAT Amount");

                                     IF "Shortcut Dimension 1 Code" <> '' THEN
                                       DebitDimValue[I] := "Shortcut Dimension 1 Code";
                                     IF "External Document No." <> '' THEN
                                       DebitExtDocNo[I] := "External Document No.";
                                     IF "WHT Certificate No." <> '' THEN
                                       DebitVendName[I] := "WHT Certificate No.";
                                     MatchAcc := TRUE;
                                   END;

                                   IF "Bal. Account No." <> '' THEN BEGIN
                                     //IF (CreditAccNo[I] = "Bal. Account No.") OR (CreditAccNo[I] = '') THEN BEGIN
                                     IF (CreditAccNo[I] = '') THEN BEGIN
                                       CASE "Bal. Account Type" OF
                                         "Bal. Account Type"::"G/L Account":
                                           BEGIN
                                             CreditAccNo[I] := "Bal. Account No.";
                                           END;
                                         "Bal. Account Type"::Customer:
                                           BEGIN
                                             CustPostingGroup.GET("Posting Group");
                                             CreditAccNo[I] := CustPostingGroup."Receivables Account";
                                           END;
                                         "Bal. Account Type"::Vendor:
                                           BEGIN
                                             VendPostingGroup.GET("Posting Group");
                                             CreditAccNo[I] := VendPostingGroup."Payables Account";
                                           END;
                                         "Bal. Account Type"::"Bank Account":
                                           BEGIN
                                             BankAcc.GET("Bal. Account No.");
                                             BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                             CreditAccNo[I] := BankAccPostingGroup."G/L Bank Account No.";
                                           END;
                                       END;
                                       GLAcc.GET(CreditAccNo[I]);
                                       CreditAccName[I] := GLAcc.Name;
                                       CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)") - ABS("Bal. VAT Amount");
                                       //CreditAmount[I] := CreditAmount[I] + "Debit Amount" - ABS("VAT Amount") - ABS("Bal. VAT Amount");

                                       IF "Shortcut Dimension 1 Code" <> '' THEN
                                         CreditDimValue[I] := "Shortcut Dimension 1 Code";
                                       IF "External Document No." <> '' THEN
                                         CreditExtDocNo[I] := "External Document No.";
                                       IF "WHT Certificate No." <> '' THEN
                                         CreditVendName[I] := "WHT Certificate No.";
                                       MatchAcc := TRUE;
                                     END;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                               END ELSE
                               IF "Credit Amount" <> 0 THEN BEGIN
                                 I := 0;
                                 MatchAcc := FALSE;
                                 REPEAT
                                   I := I + 1;
                                   //IF (CreditAccNo[I] = "Account No.") OR (CreditAccNo[I] = '') THEN BEGIN
                                   IF (CreditAccNo[I] = '') THEN BEGIN
                                     CASE "Account Type" OF
                                       "Account Type"::"G/L Account":
                                         BEGIN
                                           CreditAccNo[I] := "Account No.";
                                         END;
                                       "Account Type"::Customer:
                                         BEGIN
                                           CustPostingGroup.GET("Posting Group");
                                           CreditAccNo[I] := CustPostingGroup."Receivables Account";
                                         END;
                                       "Account Type"::Vendor:
                                         BEGIN
                                           VendPostingGroup.GET("Posting Group");
                                           CreditAccNo[I] := VendPostingGroup."Payables Account";
                                         END;
                                       "Account Type"::"Bank Account":
                                         BEGIN
                                           BankAcc.GET("Bal. Account No.");
                                           BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                           CreditAccNo[I] := BankAccPostingGroup."G/L Bank Account No.";
                                         END;
                                     END;
                                     GLAcc.GET(CreditAccNo[I]);
                                     CreditAccName[I] := GLAcc.Name;
                                     CreditAmount[I] := CreditAmount[I] + ABS("Amount (LCY)") - ABS("VAT Amount");
                                     //CreditAmount[I] := CreditAmount[I] + "Credit Amount" - ABS("VAT Amount") - ABS("Bal. VAT Amount");

                                     IF "Shortcut Dimension 1 Code" <> '' THEN
                                       CreditDimValue[I] := "Shortcut Dimension 1 Code";
                                     IF "External Document No." <> '' THEN
                                       CreditExtDocNo[I] := "External Document No.";
                                     IF "WHT Certificate No." <> '' THEN
                                       CreditVendName[I] := "WHT Certificate No.";
                                     MatchAcc := TRUE;
                                   END;

                                   IF "Bal. Account No." <> '' THEN BEGIN
                                     //IF (DebitAccNo[I] = "Bal. Account No.") OR (DebitAccNo[I] = '') THEN BEGIN
                                     IF (DebitAccNo[I] = '') THEN BEGIN
                                       CASE "Bal. Account Type" OF
                                         "Bal. Account Type"::"G/L Account":
                                           BEGIN
                                             DebitAccNo[I] := "Bal. Account No.";
                                           END;
                                         "Bal. Account Type"::Customer:
                                           BEGIN
                                             CustPostingGroup.GET("Posting Group");
                                             DebitAccNo[I] := CustPostingGroup."Receivables Account";
                                           END;
                                         "Bal. Account Type"::Vendor:
                                           BEGIN
                                             VendPostingGroup.GET("Posting Group");
                                             DebitAccNo[I] := VendPostingGroup."Payables Account";
                                           END;
                                         "Bal. Account Type"::"Bank Account":
                                           BEGIN
                                             BankAcc.GET("Bal. Account No.");
                                             BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                             DebitAccNo[I] := BankAccPostingGroup."G/L Bank Account No.";
                                           END;
                                       END;
                                       GLAcc.GET(DebitAccNo[I]);
                                       DebitAccName[I] := GLAcc.Name + ' ' + Description;
                                       DebitAmount[I] := DebitAmount[I] + ABS("Amount (LCY)") - ABS("Bal. VAT Amount");
                                       //DebitAmount[I] := DebitAmount[I] + "Credit Amount" - ABS("VAT Amount") - ABS("Bal. VAT Amount");

                                       IF "Shortcut Dimension 1 Code" <> '' THEN
                                         DebitDimValue[I] := "Shortcut Dimension 1 Code";
                                       IF "External Document No." <> '' THEN
                                         DebitExtDocNo[I] := "External Document No.";
                                       IF "WHT Certificate No." <> '' THEN
                                         DebitVendName[I] := "WHT Certificate No.";
                                       MatchAcc := TRUE;
                                     END;
                                   END;
                                 UNTIL (I>=300) OR MatchAcc;
                               END;

                               //VAT
                               IF "VAT Amount" <> 0 THEN BEGIN
                                 IF VATPostingSetup.GET("VAT Bus. Posting Group","VAT Prod. Posting Group") THEN BEGIN
                                   GLAcc.GET(VATPostingSetup."Purchase VAT Account");
                                   I := 0;
                                   MatchAcc := FALSE;
                                   REPEAT
                                     I := I + 1;
                                     IF "VAT Amount" > 0 THEN BEGIN
                                       //IF (DebitAccNo[I] = VATPostingSetup."Purchase VAT Account") OR (DebitAccNo[I] = '') THEN BEGIN
                                       IF (DebitAccNo[I] = '') THEN BEGIN
                                         DebitAccNo[I] := VATPostingSetup."Purchase VAT Account";
                                         DebitAccName[I] := GLAcc.Name;
                                         DebitAmount[I] := DebitAmount[I] + "VAT Amount";
                                         MatchAcc := TRUE;
                                       END;
                                     END ELSE
                                       //IF (CreditAccNo[I] = VATPostingSetup."Purchase VAT Account") OR (CreditAccNo[I] = '') THEN BEGIN
                                       IF (CreditAccNo[I] = '') THEN BEGIN
                                         CreditAccNo[I] := VATPostingSetup."Purchase VAT Account";
                                         CreditAccName[I] := GLAcc.Name;
                                         CreditAmount[I] := DebitAmount[I] + -"VAT Amount";
                                         MatchAcc := TRUE;
                                       END;
                                   UNTIL (I>=300) OR MatchAcc;
                                 END;
                               END;

                               IF "Bal. VAT Amount" <> 0 THEN BEGIN
                                 IF VATPostingSetup.GET("Bal. VAT Bus. Posting Group","Bal. VAT Prod. Posting Group") THEN BEGIN
                                   GLAcc.GET(VATPostingSetup."Purchase VAT Account");
                                   I := 0;
                                   MatchAcc := FALSE;
                                   REPEAT
                                     I := I + 1;
                                     IF "Bal. VAT Amount" > 0 THEN BEGIN
                                       //IF (DebitAccNo[I] = VATPostingSetup."Purchase VAT Account") OR (DebitAccNo[I] = '') THEN BEGIN
                                       IF (DebitAccNo[I] = '') THEN BEGIN
                                         DebitAccNo[I] := VATPostingSetup."Purchase VAT Account";
                                         DebitAccName[I] := GLAcc.Name;
                                         DebitAmount[I] := DebitAmount[I] + "Bal. VAT Amount";
                                         MatchAcc := TRUE;
                                       END;
                                     END ELSE
                                       //IF (CreditAccNo[I] = VATPostingSetup."Purchase VAT Account") OR (CreditAccNo[I] = '') THEN BEGIN
                                       IF (CreditAccNo[I] = '') THEN BEGIN
                                         CreditAccNo[I] := VATPostingSetup."Purchase VAT Account";
                                         CreditAccName[I] := GLAcc.Name;
                                         CreditAmount[I] := DebitAmount[I] + -"Bal. VAT Amount";
                                         MatchAcc := TRUE;
                                       END;
                                   UNTIL (I>=300) OR MatchAcc;
                                 END;
                               END;

                             END;
                           UNTIL GenJnlLine2.NEXT=0;
                         END;

        ReqFilterFields=Journal Template Name,Journal Batch Name,Document No.;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27490;
            SectionHeight=4570;
            OnPreSection=BEGIN
                           Line := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000062;Label  ;8100 ;2350 ;13400;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=PURCHASE VOUCHER }
            { 1000000036;TextBox;8100 ;1450 ;13400;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000037;Label  ;21700;1450 ;5020 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=NO............................................. }
            { 1000000038;TextBox;22800;1450 ;3820 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Document No." }
            { 1000000039;Label  ;21700;2050 ;5050 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DATE.......................................... }
            { 1000000040;TextBox;22800;2050 ;3820 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Posting Date" }
            { 1000000052;PictureBox;0 ;0    ;8000 ;2100 ;SourceExpr=CompanyInfo.Picture }
            { 1000000064;Label  ;100  ;3700 ;2400 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=ACCOUNT NO. }
            { 1000000065;Shape  ;2600 ;3450 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000066;Label  ;3050 ;3700 ;5500 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=ACCOUNT NAME }
            { 1000000067;Shape  ;9000 ;3450 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000068;Label  ;9180 ;3700 ;2520 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=PROJECT CODE }
            { 1000000069;Shape  ;11870;3450 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000070;Label  ;12050;3700 ;2800 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DEBIT }
            { 1000000072;Shape  ;14950;3450 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000073;Label  ;15110;3700 ;2900 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CREDIT }
            { 1000000074;Shape  ;18050;3450 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000075;Label  ;18210;3700 ;2500 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=External Doc. No. }
            { 1000000076;Shape  ;20700;3450 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000077;Label  ;20860;3700 ;3115 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Vendor Name }
            { 1000000026;Shape  ;15   ;3440 ;27000;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000030;Shape  ;15   ;4520 ;27000;50   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000032;Shape  ;0    ;3450 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000035;Shape  ;27000;3470 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000008;Label  ;21700;2600 ;5090 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PRINTED DATE.......................... }
            { 1000000025;TextBox;24200;2600 ;2350 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=TODAY }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=27490;
            SectionHeight=910;
          }
          CONTROLS
          {
            { 1000000091;Label  ;10900;50   ;840  ;700  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total }
            { 1000000093;TextBox;12000;50   ;2900 ;700  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitTotalLCY }
            { 1000000094;TextBox;15110;50   ;2900 ;700  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditTotalLCY }
            { 1000000095;Shape  ;0    ;0    ;30   ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000097;Shape  ;27000;0    ;30   ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000099;Shape  ;14950;0    ;150  ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000186;Shape  ;15   ;820  ;27000;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000033;Shape  ;15   ;0    ;27000;50   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000112;Shape  ;20700;10   ;150  ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000113;Shape  ;18050;0    ;150  ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000013;Shape  ;11870;0    ;150  ;900  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=27490;
            SectionHeight=0;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           DebitTotalLCY := 0;
                           CreditTotalLCY := 0;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            SectionWidth=27490;
            SectionHeight=5700;
          }
          CONTROLS
          {
            { 1000000004;Shape  ;27000;0    ;30   ;5470 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000005;TextBox;1185 ;850  ;16080;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Remark[1] }
            { 1000000006;TextBox;1185 ;1450 ;16080;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Remark[2] }
            { 1000000007;TextBox;1185 ;2050 ;16080;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Remark[3] }
            { 1000000009;Shape  ;15   ;2700 ;27000;50   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000010;Label  ;135  ;200  ;2550 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=DESCRIPTION }
            { 1000000011;Shape  ;0    ;5440 ;27000;50   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000012;Shape  ;16900;4900 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000014;Shape  ;16900;3700 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000015;Label  ;4800 ;4600 ;2280 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Checked By : }
            { 1000000017;Label  ;14500;4600 ;2550 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved By : }
            { 1000000027;Shape  ;7000 ;3700 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000028;Shape  ;6950 ;4900 ;5200 ;150  ;ShapeStyle=HorzLine }
            { 1000000029;Label  ;4850 ;3400 ;2260 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By : }
            { 1000000031;Label  ;14500;3400 ;2490 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Acct.Entry By : }
            { 1000000034;Shape  ;0    ;0    ;30   ;5470 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000003;Shape  ;15   ;0    ;27000;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitDetail;
        OnAfterGetRecord=BEGIN
                           IF DebitAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27490;
            SectionHeight=600;
            OnPreSection=BEGIN
                           DebitTotalLCY := DebitTotalLCY + DebitAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;9250 ;50   ;2600 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitDimValue[Number] }
            { 1000000001;TextBox;2800 ;50   ;6200 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccName[Number] }
            { 1000000002;TextBox;12000;50   ;2900 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000071;TextBox;100  ;50   ;2400 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccNo[Number] }
            { 1000000155;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000080;Shape  ;2600 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000081;Shape  ;9000 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000082;Shape  ;11870;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000083;Shape  ;14950;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000084;Shape  ;18050;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000085;Shape  ;20700;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000109;Shape  ;27000;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000021;TextBox;18250;50   ;2450 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitExtDocNo[Number] }
            { 1000000022;TextBox;20900;50   ;6000 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVendName[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditDetail;
        OnAfterGetRecord=BEGIN
                           IF CreditAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27490;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CreditTotalLCY := CreditTotalLCY + CreditAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000018;TextBox;9250 ;50   ;2600 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditDimValue[Number] }
            { 1000000019;TextBox;2800 ;50   ;6200 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccName[Number] }
            { 1000000020;TextBox;15160;50   ;2800 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000016;TextBox;100  ;50   ;2400 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccNo[Number] }
            { 1000000086;Shape  ;20700;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000087;Shape  ;18050;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000088;Shape  ;14950;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000089;Shape  ;11870;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000090;Shape  ;9000 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000092;Shape  ;2600 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000098;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000110;Shape  ;27000;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000023;TextBox;20900;50   ;6000 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVendName[Number] }
            { 1000000024;TextBox;18250;50   ;2450 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditExtDocNo[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=LineLoop;
        OnAfterGetRecord=BEGIN
                           IF Line + Number > 11 THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27490;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000100;Shape  ;20700;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000101;Shape  ;18050;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000103;Shape  ;14950;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000104;Shape  ;11870;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000105;Shape  ;9000 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000106;Shape  ;2600 ;0    ;150  ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000108;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000111;Shape  ;27000;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=11440;
      Height=3960;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1000000004;TextBox;3410 ;110  ;7700 ;440  ;CaptionML=ENU=Remark 1;
                                                   SourceExpr=Remark[1] }
      { 1000000005;Label  ;110  ;110  ;3190 ;440  ;ParentControl=1000000004 }
      { 1000000006;TextBox;3410 ;660  ;7700 ;440  ;CaptionML=ENU=Remark 2;
                                                   SourceExpr=Remark[2] }
      { 1000000007;Label  ;110  ;660  ;3190 ;440  ;ParentControl=1000000006 }
      { 1000000010;TextBox;3410 ;1210 ;7700 ;440  ;CaptionML=ENU=Remark 3;
                                                   SourceExpr=Remark[3] }
      { 1000000011;Label  ;110  ;1210 ;3190 ;440  ;ParentControl=1000000010 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000003 : Record 79;
      Vendor@1000000025 : Record 23;
      VendPostingGroup@1000000050 : Record 93;
      Customer@1000000026 : Record 18;
      CustPostingGroup@1000000051 : Record 92;
      CustLedgEntry@1000000081 : Record 21;
      GLAcc@1000000022 : Record 15;
      BankAcc@1000000030 : Record 270;
      BankAccPostingGroup@1000000052 : Record 277;
      WHTPostingSetup@1000000085 : Record 28043;
      SalesInvLine@1000000084 : Record 113;
      VATEntry@1000000016 : Record 254;
      VATPostingSetup@1000000023 : Record 325;
      GenJnlLine@1000000045 : Record 81;
      GenJnlLine2@1000000065 : Record 81;
      DebitTotalLCY@1000000000 : Decimal;
      CreditTotalLCY@1000000001 : Decimal;
      Remark@1000000048 : ARRAY [3] OF Text[50];
      Line@1000000034 : Integer;
      DebitAccNo@1000000035 : ARRAY [300] OF Code[20];
      CreditAccNo@1000000036 : ARRAY [300] OF Code[20];
      DebitAccName@1000000044 : ARRAY [300] OF Text[150];
      CreditAccName@1000000043 : ARRAY [300] OF Text[150];
      DebitAmount@1000000067 : ARRAY [300] OF Decimal;
      CreditAmount@1000000071 : ARRAY [300] OF Decimal;
      DebitDimValue@1000000012 : ARRAY [300] OF Code[20];
      CreditDimValue@1000000013 : ARRAY [300] OF Code[20];
      MatchAcc@1000000037 : Boolean;
      I@1000000042 : Integer;
      DebitExtDocNo@1000000046 : ARRAY [300] OF Code[20];
      CreditExtDocNo@1000000049 : ARRAY [300] OF Code[20];
      DebitVendName@1000000021 : ARRAY [300] OF Text[150];
      CreditVendName@1000000047 : ARRAY [300] OF Text[150];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Purchase Voucher Report.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50017 Customer - Aging (As of Date)
{
  OBJECT-PROPERTIES
  {
    Date=11/28/07;
    Time=11:05:59 AM;
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=800;
    OnPreReport=BEGIN
                  CustFilter := Customer.GETFILTERS;
                  FOR i := 3 TO 5 DO
                    PeriodStartDate[i] := CALCDATE(PeriodLength,PeriodStartDate[i - 1]);
                  PeriodStartDate[6] := 12319999D;
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table18;
        DataItemTableView=SORTING(No.);
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(CustBalanceDueLCY,TotalCustBalanceLCY);
                        Currency2.Code := '';
                        Currency2.INSERT;
                        IF Currency.FIND('-') THEN
                          REPEAT
                            Currency2 := Currency;
                            Currency2.INSERT;
                          UNTIL Currency.NEXT = 0;
                      END;

        ReqFilterFields=No.,Search Name,Customer Posting Group,Currency Filter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Customer - Detail Aging }
            { 2   ;TextBox      ;16200;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 4   ;Label        ;18150;423  ;750  ;423  ;ParentControl=5 }
            { 5   ;TextBox      ;18900;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    THA=หน้า];
                                                         SourceExpr=CurrReport.PAGENO }
            { 6   ;TextBox      ;17100;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=423;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (CustFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 8   ;TextBox      ;0    ;0    ;18150;423  ;SourceExpr=Customer.TABLECAPTION + ': ' + CustFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 9   ;Label        ;6000 ;0    ;10950;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Balance Due;
                                                                    THA=ดุลที่ครบกำหนด] }
            { 10  ;TextBox      ;6000 ;423  ;10950;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         SourceExpr='' }
            { 14  ;Label        ;300  ;846  ;1350 ;846  ;ParentControl=1000000010;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;1650 ;846  ;2400 ;846  ;ParentControl=1000000008;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 16  ;Label        ;5550 ;846  ;2250 ;846  ;ParentControl=1000000024;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 11  ;TextBox      ;7950 ;846  ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[2] }
            { 12  ;TextBox      ;10200;846  ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[3] }
            { 13  ;TextBox      ;12450;846  ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[4] }
            { 20  ;Label        ;14700;846  ;2250 ;846  ;ParentControl=1000000020;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 21  ;Label        ;17100;846  ;2250 ;846  ;ParentControl=1000000019;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 17  ;TextBox      ;7950 ;1269 ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[3] - 1 }
            { 18  ;TextBox      ;10200;1269 ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[4] - 1 }
            { 19  ;TextBox      ;12450;1269 ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[5] - 1 }
            { 1000000011;Label  ;4200 ;846  ;1200 ;846  ;ParentControl=1000000009;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19500;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 22  ;Label        ;1350 ;0    ;3750 ;423  ;ParentControl=23;
                                                         LeaderDots=Yes }
            { 23  ;TextBox      ;5550 ;0    ;2250 ;423  ;CaptionML=[ENU=Continued (LCY);
                                                                    THA=ต่อไป (LCY)];
                                                         SourceExpr=CustBalanceDueLCY[1];
                                                         AutoFormatType=1 }
            { 24  ;TextBox      ;7950 ;0    ;2100 ;423  ;SourceExpr=CustBalanceDueLCY[2];
                                                         AutoFormatType=1 }
            { 25  ;TextBox      ;10200;0    ;2100 ;423  ;SourceExpr=CustBalanceDueLCY[3];
                                                         AutoFormatType=1 }
            { 26  ;TextBox      ;12450;0    ;2100 ;423  ;SourceExpr=CustBalanceDueLCY[4];
                                                         AutoFormatType=1 }
            { 27  ;TextBox      ;14700;0    ;2250 ;423  ;SourceExpr=CustBalanceDueLCY[5];
                                                         AutoFormatType=1 }
            { 28  ;TextBox      ;17100;0    ;2250 ;423  ;SourceExpr=TotalCustBalanceLCY;
                                                         AutoFormatType=1 }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19500;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 38  ;Label        ;1350 ;423  ;3750 ;423  ;ParentControl=39;
                                                         LeaderDots=Yes }
            { 39  ;TextBox      ;5550 ;423  ;2250 ;423  ;CaptionML=[ENU=Continued (LCY);
                                                                    THA=ต่อไป (LCY)];
                                                         SourceExpr=CustBalanceDueLCY[1];
                                                         AutoFormatType=1 }
            { 40  ;TextBox      ;7950 ;423  ;2100 ;423  ;SourceExpr=CustBalanceDueLCY[2];
                                                         AutoFormatType=1 }
            { 41  ;TextBox      ;10200;423  ;2100 ;423  ;SourceExpr=CustBalanceDueLCY[3];
                                                         AutoFormatType=1 }
            { 42  ;TextBox      ;12450;423  ;2100 ;423  ;SourceExpr=CustBalanceDueLCY[4];
                                                         AutoFormatType=1 }
            { 43  ;TextBox      ;14700;423  ;2250 ;423  ;SourceExpr=CustBalanceDueLCY[5];
                                                         AutoFormatType=1 }
            { 44  ;TextBox      ;17100;423  ;2250 ;423  ;SourceExpr=TotalCustBalanceLCY;
                                                         AutoFormatType=1 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19500;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 45  ;Label        ;0    ;423  ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Total (LCY);
                                                                    THA=ยอดรวม (LCY)] }
            { 46  ;TextBox      ;5550 ;423  ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr=CustBalanceDueLCY[1];
                                                         AutoFormatType=1 }
            { 47  ;TextBox      ;7950 ;423  ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=CustBalanceDueLCY[2];
                                                         AutoFormatType=1 }
            { 48  ;TextBox      ;10200;423  ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=CustBalanceDueLCY[3];
                                                         AutoFormatType=1 }
            { 49  ;TextBox      ;12450;423  ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=CustBalanceDueLCY[4];
                                                         AutoFormatType=1 }
            { 50  ;TextBox      ;14700;423  ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr=CustBalanceDueLCY[5];
                                                         AutoFormatType=1 }
            { 51  ;TextBox      ;17100;423  ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr=TotalCustBalanceLCY;
                                                         AutoFormatType=1 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table21;
        DataItemTableView=SORTING(Customer No.,Open,Positive,Due Date,Currency Code);
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(RemainingLCY,LineTotalRemainingLCY);
                        SETRANGE("Date Filter",0D,EndDate);
                        //SETRANGE("Due Date",0D,EndDate);
                      END;

        OnAfterGetRecord=BEGIN
                           LineTotalRemainingLCY := 0;
                           FOR i := 1 TO 5 DO BEGIN
                             IF ("Due Date" >= PeriodStartDate[i]) AND ("Due Date" <= PeriodStartDate[i+1] - 1) THEN BEGIN
                               CALCFIELDS("Remaining Amt. (LCY)");
                               RemainingLCY[i] := "Remaining Amt. (LCY)";
                               LineTotalRemainingLCY := LineTotalRemainingLCY + RemainingLCY[i];
                             END;
                           END;
                         END;

        ReqFilterFields=Global Dimension 1 Code;
        DataItemLink=Customer No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19500;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000006;TextBox;1950 ;0    ;8400 ;423  ;HorzAlign=General;
                                                         FontBold=Yes;
                                                         SourceExpr=Customer.Name }
            { 1000000007;TextBox;0    ;0    ;1800 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr=Customer."No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := LineTotalRemainingLCY <> 0;
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;1650 ;0    ;2400 ;423  ;SourceExpr="Document No." }
            { 1000000010;TextBox;300  ;0    ;1200 ;423  ;SourceExpr="Document Type" }
            { 1000000019;TextBox;17100;0    ;2250 ;423  ;CaptionML=[ENU=Balance;
                                                                    THA=ดุล];
                                                         SourceExpr=LineTotalRemainingLCY;
                                                         AutoFormatType=1 }
            { 1000000020;TextBox;14700;0    ;2250 ;423  ;CaptionML=[ENU=after...;
                                                                    THA=หลังจาก...];
                                                         SourceExpr=RemainingLCY[5];
                                                         AutoFormatType=1 }
            { 1000000021;TextBox;12450;0    ;2100 ;423  ;SourceExpr=RemainingLCY[4];
                                                         AutoFormatType=1 }
            { 1000000022;TextBox;10200;0    ;2100 ;423  ;SourceExpr=RemainingLCY[3];
                                                         AutoFormatType=1 }
            { 1000000023;TextBox;7950 ;0    ;2100 ;423  ;SourceExpr=RemainingLCY[2];
                                                         AutoFormatType=1 }
            { 1000000024;TextBox;5550 ;0    ;2250 ;423  ;CaptionML=[ENU=...before;
                                                                    THA=...ก่อน];
                                                         SourceExpr=RemainingLCY[1];
                                                         AutoFormatType=1 }
            { 1000000009;TextBox;4200 ;0    ;1200 ;423  ;SourceExpr="Posting Date" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19500;
            SectionHeight=846;
            OnPreSection=BEGIN
                           FOR i := 1 TO 5 DO BEGIN
                             CustBalanceDueLCY[i] := RemainingLCY[i];
                             TotalCustBalanceLCY := TotalCustBalanceLCY + CustBalanceDueLCY[i];
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000012;Label  ;1500 ;0    ;3750 ;423  ;FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000000;TextBox;17100;0    ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Balance;
                                                                    THA=ดุล];
                                                         SourceExpr=LineTotalRemainingLCY;
                                                         AutoFormatType=1 }
            { 1000000001;TextBox;14700;0    ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=after...;
                                                                    THA=หลังจาก...];
                                                         SourceExpr=RemainingLCY[5];
                                                         AutoFormatType=1 }
            { 1000000002;TextBox;12450;0    ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=RemainingLCY[4];
                                                         AutoFormatType=1 }
            { 1000000003;TextBox;10200;0    ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=RemainingLCY[3];
                                                         AutoFormatType=1 }
            { 1000000004;TextBox;7950 ;0    ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=RemainingLCY[2];
                                                         AutoFormatType=1 }
            { 1000000005;TextBox;5550 ;0    ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=...before;
                                                                    THA=...ก่อน];
                                                         SourceExpr=RemainingLCY[1];
                                                         AutoFormatType=1 }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=6160;
      Height=1540;
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   IF PeriodStartDate[2] = 0D THEN
                     PeriodStartDate[2] := WORKDATE;
                   IF FORMAT(PeriodLength) = '' THEN
                     EVALUATE(PeriodLength,'<1M>');
                   IF EndDate = 0D THEN
                     EndDate := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 2   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=[ENU=Starting Date;
                                                              THA=วันที่เริ่มต้น];
                                                   NotBlank=Yes;
                                                   SourceExpr=PeriodStartDate[2] }
      { 22  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=2 }
      { 3   ;TextBox      ;3410 ;550  ;2750 ;440  ;CaptionML=[ENU=Period Length;
                                                              THA=ความยาวของรอบระยะเวลา];
                                                   SourceExpr=PeriodLength }
      { 23  ;Label        ;0    ;550  ;3300 ;440  ;ParentControl=3 }
      { 1000000000;TextBox;3410 ;1100 ;1650 ;440  ;CaptionML=ENU=As of Date;
                                                   SourceExpr=EndDate }
      { 1000000001;Label  ;0    ;1100 ;3300 ;440  ;ParentControl=1000000000 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CustLedgEntry@1000000002 : Record 21;
      Currency@1000 : Record 4;
      Currency2@1001 : TEMPORARY Record 4;
      CustFilter@1002 : Text[250];
      PeriodLength@1004 : DateFormula;
      PeriodStartDate@1005 : ARRAY [6] OF Date;
      CustBalanceDueLCY@1007 : ARRAY [5] OF Decimal;
      TotalCustBalanceLCY@1009 : Decimal;
      i@1011 : Integer;
      RemainingLCY@1000000000 : ARRAY [5] OF Decimal;
      LineTotalRemainingLCY@1000000001 : Decimal;
      EndDate@1000000003 : Date;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Customer Aging Report.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50018 Vendor - Aging (As of Date)
{
  OBJECT-PROPERTIES
  {
    Date=11/28/07;
    Time=11:11:49 AM;
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=800;
    OnPreReport=BEGIN
                  VendFilter := Vendor.GETFILTERS;
                  FOR i := 3 TO 5 DO
                    PeriodStartDate[i] := CALCDATE(PeriodLength,PeriodStartDate[i-1]);
                  PeriodStartDate[6] := 12319999D;
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table23;
        DataItemTableView=SORTING(No.);
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(VendBalanceDueLCY,TotalVendAmtDueLCY);
                        Currency2.Code := '';
                        Currency2.INSERT;
                        IF Currency.FIND('-') THEN
                          REPEAT
                            Currency2 := Currency;
                            Currency2.INSERT;
                          UNTIL Currency.NEXT = 0;
                      END;

        ReqFilterFields=No.,Search Name,Vendor Posting Group,Currency Filter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19509;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1   ;Label        ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Vendor - Detail Aging }
            { 2   ;TextBox      ;16200;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 3   ;TextBox      ;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 4   ;Label        ;18150;423  ;750  ;423  ;ParentControl=5 }
            { 5   ;TextBox      ;18900;423  ;450  ;423  ;CaptionML=[ENU=Page;
                                                                    THA=หน้า];
                                                         SourceExpr=CurrReport.PAGENO }
            { 6   ;TextBox      ;17100;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19509;
            SectionHeight=423;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19509;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (VendFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 8   ;TextBox      ;0    ;0    ;18150;423  ;SourceExpr=Vendor.TABLECAPTION + ': ' + VendFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19509;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 9   ;Label        ;6150 ;0    ;10800;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Balance Due;
                                                                    THA=ดุลที่ครบกำหนดชำระ] }
            { 10  ;TextBox      ;6150 ;423  ;10800;423  ;FontBold=Yes;
                                                         LeaderDots=Yes;
                                                         SourceExpr='' }
            { 14  ;Label        ;150  ;846  ;900  ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 15  ;Label        ;2400 ;846  ;2100 ;846  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 16  ;Label        ;5550 ;846  ;2250 ;846  ;ParentControl=1000000007;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 11  ;TextBox      ;7950 ;846  ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[2] }
            { 12  ;TextBox      ;10200;846  ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[3] }
            { 13  ;TextBox      ;12450;846  ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[4] }
            { 20  ;Label        ;14700;846  ;2250 ;846  ;ParentControl=1000000003;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 21  ;Label        ;17100;846  ;2250 ;846  ;ParentControl=1000000002;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 17  ;TextBox      ;7950 ;1269 ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[3] - 1 }
            { 18  ;TextBox      ;10200;1269 ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[4] - 1 }
            { 19  ;TextBox      ;12450;1269 ;2100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         SourceExpr=PeriodStartDate[5] - 1 }
            { 1000000018;Label  ;1200 ;846  ;1050 ;846  ;ParentControl=1000000001;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000020;Label  ;4500 ;846  ;1050 ;846  ;ParentControl=1000000019;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19509;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 22  ;Label        ;1650 ;0    ;3750 ;423  ;ParentControl=23;
                                                         LeaderDots=Yes }
            { 23  ;TextBox      ;5550 ;0    ;2250 ;423  ;CaptionML=[ENU=Continued (LCY);
                                                                    THA=ทำต่อไป (LCY)];
                                                         SourceExpr=VendBalanceDueLCY[1];
                                                         AutoFormatType=1 }
            { 24  ;TextBox      ;7950 ;0    ;2100 ;423  ;SourceExpr=VendBalanceDueLCY[2];
                                                         AutoFormatType=1 }
            { 25  ;TextBox      ;10200;0    ;2100 ;423  ;SourceExpr=VendBalanceDueLCY[3];
                                                         AutoFormatType=1 }
            { 26  ;TextBox      ;12450;0    ;2100 ;423  ;SourceExpr=VendBalanceDueLCY[4];
                                                         AutoFormatType=1 }
            { 27  ;TextBox      ;14700;0    ;2250 ;423  ;SourceExpr=VendBalanceDueLCY[5];
                                                         AutoFormatType=1 }
            { 28  ;TextBox      ;17100;0    ;2250 ;423  ;SourceExpr=TotalVendAmtDueLCY;
                                                         AutoFormatType=1 }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19509;
            SectionHeight=952;
          }
          CONTROLS
          {
            { 38  ;Label        ;0    ;529  ;3300 ;423  ;ParentControl=39;
                                                         LeaderDots=Yes }
            { 39  ;TextBox      ;5100 ;529  ;2700 ;423  ;CaptionML=[ENU=Continued (LCY);
                                                                    THA=ทำต่อไป (LCY)];
                                                         SourceExpr=VendBalanceDueLCY[1];
                                                         AutoFormatType=1 }
            { 40  ;TextBox      ;7950 ;529  ;2100 ;423  ;SourceExpr=VendBalanceDueLCY[2];
                                                         AutoFormatType=1 }
            { 41  ;TextBox      ;10200;529  ;2118 ;423  ;SourceExpr=VendBalanceDueLCY[3];
                                                         AutoFormatType=1 }
            { 42  ;TextBox      ;12450;529  ;2100 ;423  ;SourceExpr=VendBalanceDueLCY[4];
                                                         AutoFormatType=1 }
            { 43  ;TextBox      ;14700;529  ;2294 ;423  ;SourceExpr=VendBalanceDueLCY[5];
                                                         AutoFormatType=1 }
            { 44  ;TextBox      ;17100;529  ;2242 ;423  ;SourceExpr=TotalVendAmtDueLCY;
                                                         AutoFormatType=1 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19509;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 45  ;Label        ;0    ;423  ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Total (LCY);
                                                                    THA=ยอดรวม (LCY)] }
            { 46  ;TextBox      ;5100 ;423  ;2691 ;423  ;FontBold=Yes;
                                                         SourceExpr=VendBalanceDueLCY[1];
                                                         AutoFormatType=1 }
            { 47  ;TextBox      ;7950 ;423  ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=VendBalanceDueLCY[2];
                                                         AutoFormatType=1 }
            { 48  ;TextBox      ;10200;423  ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=VendBalanceDueLCY[3];
                                                         AutoFormatType=1 }
            { 49  ;TextBox      ;12450;423  ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=VendBalanceDueLCY[4];
                                                         AutoFormatType=1 }
            { 50  ;TextBox      ;14700;423  ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr=VendBalanceDueLCY[5];
                                                         AutoFormatType=1 }
            { 51  ;TextBox      ;17100;423  ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr=TotalVendAmtDueLCY;
                                                         AutoFormatType=1 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table25;
        DataItemTableView=SORTING(Vendor No.,Open,Positive,Due Date,Currency Code);
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(RemainingLCY,LineTotalRemainingLCY);
                        SETRANGE("Date Filter",0D,EndDate);
                        //SETRANGE("Due Date",0D,EndDate);
                      END;

        OnAfterGetRecord=BEGIN
                           LineTotalRemainingLCY := 0;
                           FOR i := 1 TO 5 DO BEGIN
                             IF ("Due Date" >= PeriodStartDate[i]) AND ("Due Date" <= PeriodStartDate[i+1] - 1) THEN BEGIN
                               CALCFIELDS("Remaining Amt. (LCY)");
                               RemainingLCY[i] := -"Remaining Amt. (LCY)";
                               LineTotalRemainingLCY := LineTotalRemainingLCY + RemainingLCY[i];
                             END;
                           END;
                         END;

        ReqFilterFields=Global Dimension 1 Code;
        DataItemLink=Vendor No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19509;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000015;TextBox;1950 ;0    ;8400 ;423  ;FontBold=Yes;
                                                         SourceExpr=[Vendor.Name ] }
            { 1000000016;TextBox;0    ;0    ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr=Vendor."No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19509;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := LineTotalRemainingLCY <> 0;
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;2400 ;0    ;2100 ;423  ;HorzAlign=Left;
                                                         SourceExpr="External Document No." }
            { 1000000001;TextBox;1200 ;0    ;1050 ;423  ;CaptionML=[ENU=Doc. Type;
                                                                    THA=ชนิดเอกสาร];
                                                         SourceExpr="Document Type" }
            { 1000000002;TextBox;17100;0    ;2250 ;423  ;CaptionML=[ENU=Balance;
                                                                    THA=ดุล];
                                                         SourceExpr=LineTotalRemainingLCY;
                                                         AutoFormatType=1 }
            { 1000000003;TextBox;14700;0    ;2250 ;423  ;CaptionML=[ENU=after...;
                                                                    THA=หลังจาก...];
                                                         SourceExpr=RemainingLCY[5];
                                                         AutoFormatType=1 }
            { 1000000004;TextBox;12450;0    ;2100 ;423  ;SourceExpr=RemainingLCY[4];
                                                         AutoFormatType=1 }
            { 1000000005;TextBox;10200;0    ;2100 ;423  ;SourceExpr=RemainingLCY[3];
                                                         AutoFormatType=1 }
            { 1000000006;TextBox;7950 ;0    ;2100 ;423  ;SourceExpr=RemainingLCY[2];
                                                         AutoFormatType=1 }
            { 1000000007;TextBox;5550 ;0    ;2250 ;423  ;CaptionML=[ENU=...before;
                                                                    THA=...ก่อน];
                                                         SourceExpr=RemainingLCY[1];
                                                         AutoFormatType=1 }
            { 1000000017;TextBox;0    ;0    ;1050 ;423  ;CaptionML=[ENU=Doc. Date;
                                                                    THA=วันที่ในเอกสาร];
                                                         SourceExpr="Document Date" }
            { 1000000019;TextBox;4500 ;0    ;1050 ;423  ;SourceExpr="Posting Date" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19509;
            SectionHeight=846;
            OnPreSection=BEGIN
                           FOR i := 1 TO 5 DO BEGIN
                             VendBalanceDueLCY[i] := RemainingLCY[i];
                             TotalVendAmtDueLCY := TotalVendAmtDueLCY + VendBalanceDueLCY[i];
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000008;Label  ;1650 ;0    ;3750 ;423  ;FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000009;TextBox;17100;0    ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=Balance;
                                                                    THA=ดุล];
                                                         SourceExpr=LineTotalRemainingLCY;
                                                         AutoFormatType=1 }
            { 1000000010;TextBox;14700;0    ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=after...;
                                                                    THA=หลังจาก...];
                                                         SourceExpr=RemainingLCY[5];
                                                         AutoFormatType=1 }
            { 1000000011;TextBox;12450;0    ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=RemainingLCY[4];
                                                         AutoFormatType=1 }
            { 1000000012;TextBox;10200;0    ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=RemainingLCY[3];
                                                         AutoFormatType=1 }
            { 1000000013;TextBox;7950 ;0    ;2100 ;423  ;FontBold=Yes;
                                                         SourceExpr=RemainingLCY[2];
                                                         AutoFormatType=1 }
            { 1000000014;TextBox;5550 ;0    ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=...before;
                                                                    THA=...ก่อน];
                                                         SourceExpr=RemainingLCY[1];
                                                         AutoFormatType=1 }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=6160;
      Height=1540;
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   IF PeriodStartDate[2] = 0D THEN
                     PeriodStartDate[2] := WORKDATE;
                   IF FORMAT(PeriodLength)  = '' THEN
                     EVALUATE(PeriodLength,'<1M>');
                   IF EndDate = 0D THEN
                     EndDate := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=[ENU=Starting Date;
                                                              THA=วันที่เริ่มต้น];
                                                   NotBlank=Yes;
                                                   SourceExpr=PeriodStartDate[2] }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
      { 2   ;TextBox      ;3410 ;550  ;2750 ;440  ;CaptionML=[ENU=Period Length;
                                                              THA=ความยาวของรอบระยะเวลา];
                                                   SourceExpr=PeriodLength }
      { 22  ;Label        ;0    ;550  ;3300 ;440  ;ParentControl=2 }
      { 1000000000;TextBox;3410 ;1100 ;1650 ;440  ;CaptionML=ENU=As of Date;
                                                   SourceExpr=EndDate }
      { 1000000001;Label  ;0    ;1100 ;3300 ;440  ;ParentControl=1000000000 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Currency@1000 : Record 4;
      Currency2@1001 : TEMPORARY Record 4;
      VendFilter@1003 : Text[250];
      PeriodStartDate@1004 : ARRAY [6] OF Date;
      TotalVendAmtDueLCY@1006 : Decimal;
      VendBalanceDueLCY@1008 : ARRAY [5] OF Decimal;
      PeriodLength@1009 : DateFormula;
      i@1011 : Integer;
      RemainingLCY@1000000001 : ARRAY [5] OF Decimal;
      LineTotalRemainingLCY@1000000000 : Decimal;
      EndDate@1000000002 : Date;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Vendor Aging Report.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50019 Stock Card
{
  OBJECT-PROPERTIES
  {
    Date=10/13/06;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=ENU=Stock Card;
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  ItemFilter := "Item Ledger Entry".GETFILTERS;
                  CLEAR(StartingDate);
                  CLEAR(EndingDate);
                  IF "Item Ledger Entry".GETFILTER("Posting Date") <> '' THEN BEGIN
                    StartingDate := "Item Ledger Entry".GETRANGEMIN("Posting Date");
                    EndingDate := "Item Ledger Entry".GETRANGEMAX("Posting Date");
                  END;
                END;

    Orientation=Landscape;
    PaperSize=A4 210 x 297 mm;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table32;
        DataItemTableView=SORTING(Item No.,Location Code,Posting Date);
        NewPagePerGroup=No;
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("Item No.");
                        CompanyInfo.GET;
                        CurrReport.CREATETOTALS(RemQty,RemAmt);
                        "Item Ledger Entry".SETRANGE("Posting Date");
                      END;

        OnAfterGetRecord=BEGIN
                           IF ("Posting Date" >= StartingDate) AND ("Posting Date" <= EndingDate) THEN BEGIN

                           ValueEntry.RESET;
                           ValueEntry.SETCURRENTKEY("Item Ledger Entry No.");
                           ValueEntry.SETRANGE("Item Ledger Entry No.","Entry No.");
                           ValueEntry.SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
                           ValueEntry.SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
                           ValueEntry.SETFILTER("Global Dimension 1 Code",Item.GETFILTER("Global Dimension 1 Filter"));
                           ValueEntry.SETFILTER("Global Dimension 2 Code",Item.GETFILTER("Global Dimension 2 Filter"));
                           IF NOT ValueEntry.FIND('-') THEN
                             CLEAR(ValueEntry);

                           CLEAR(IncQty);
                           CLEAR(DrcQty);
                           CLEAR(IncAmt);
                           CLEAR(DrcAmt);
                           {---
                           CASE TRUE OF
                             "Invoiced Quantity" > 0:
                             BEGIN
                               IncQty := "Invoiced Quantity";
                               IncAmt := ValueEntry."Cost Posted to G/L";
                             END;
                             "Invoiced Quantity" < 0:
                             BEGIN
                               DrcQty := "Invoiced Quantity";
                               DrcAmt := ValueEntry."Cost Posted to G/L";
                             END;
                             "Invoiced Quantity" = 0:
                             BEGIN
                               IF Quantity >= 0 THEN
                                 RecNotInv := RecNotInv + Quantity
                               ELSE
                                 ShipNotInv := ShipNotInv + Quantity;
                             END;
                           END;
                           RemQty := RemQty + "Invoiced Quantity";
                           RemAmt := RemAmt + ValueEntry."Cost Posted to G/L";
                           ---}

                           CASE TRUE OF
                             "Invoiced Quantity" > 0:
                               IncQty := "Invoiced Quantity";
                             "Invoiced Quantity" < 0:
                               DrcQty := "Invoiced Quantity";
                             "Invoiced Quantity" = 0:
                             BEGIN
                               IF Quantity >= 0 THEN
                                 RecNotInv := RecNotInv + Quantity
                               ELSE
                                 ShipNotInv := ShipNotInv + Quantity;
                             END;
                           END;
                           RemQty := RemQty + "Invoiced Quantity";

                           REPEAT
                             CASE TRUE OF
                               "Invoiced Quantity" > 0:
                                 IncAmt := ValueEntry."Cost Posted to G/L";
                               "Invoiced Quantity" < 0:
                                 DrcAmt := ValueEntry."Cost Posted to G/L";
                             END;
                             RemAmt := RemAmt + ValueEntry."Cost Posted to G/L";
                           UNTIL ValueEntry.NEXT=0;
                           END;
                         END;

        ReqFilterFields=Item No.,Location Code,Posting Date;
        TotalFields=Quantity;
        GroupTotalFields=Item No.,Location Code;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=28200;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;28050;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Stock Card;
                                                                    THA=รายงานการเคลื่อนไหวสินค้า แบบละเอียด] }
            { 1000000002;TextBox;24900;423  ;3150 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;423  ;28050;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000004;TextBox;27450;0    ;600  ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=[ENU=Page;
                                                                    THA=หน้า];
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;24900;0    ;2400 ;423  ;ParentControl=1000000004;
                                                         HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8 }
            { 1000000006;TextBox;24900;846  ;3150 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TIME,0) }
            { 1117700001;TextBox;24900;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=USERID }
            { 1000000019;TextBox;12750;1046 ;7350 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Item Ledger Entry".GETFILTER("Posting Date") }
            { 1000000016;TextBox;12750;1469 ;7350 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Item Ledger Entry".GETFILTER("Item No.") }
            { 1000000022;Label  ;10950;1046 ;1800 ;423  ;FontName=tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=[ENU=Period:;
                                                                    THA=ระหว่างวันที่:] }
            { 1000000040;Label  ;10950;1469 ;1800 ;423  ;FontName=tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=รหัสสินค้า: }
            { 1117700003;Label  ;0    ;0    ;3000 ;423  ;CaptionML=THA=Report ID: 50019 }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=28200;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := (CurrReport.PAGENO = 1) AND ("Item Ledger Entry".GETFILTERS <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;0    ;23700;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1  :-  %2', "Item Ledger Entry".TABLECAPTION   ,"Item Ledger Entry".GETFILTERS) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=28200;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000081;Label  ;150  ;423  ;5700 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=<---------------สินค้า-----------------> }
            { 1000000082;Label  ;5850 ;423  ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000083;Label  ;7350 ;423  ;2850 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เลขที่เอกสาร }
            { 1000000084;Label  ;10200;423  ;1500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=คลังสินค้า }
            { 1000000085;Label  ;23100;423  ;4800 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=<-------ยอดคงเหลือ--------> }
            { 1000000086;Shape  ;0    ;1269 ;27900;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000087;Label  ;14550;423  ;3750 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวน }
            { 1000000088;Label  ;18450;423  ;4800 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=มูลค่า }
            { 1000000089;Label  ;23250;846  ;2100 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวน }
            { 1000000090;Label  ;150  ;846  ;1350 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รหัส }
            { 1000000091;Label  ;2400 ;846  ;3450 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ชื่อสินค้า }
            { 1000000092;Label  ;11700;423  ;1500 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เหตุผล }
            { 1000000093;Label  ;13200;423  ;1200 ;423  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หน่วยนับ }
            { 1000000094;Label  ;15150;846  ;1050 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รับ }
            { 1000000095;Label  ;16950;846  ;1350 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จ่าย }
            { 1000000096;Label  ;18450;846  ;2100 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รับ }
            { 1000000097;Label  ;20700;846  ;2400 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จ่าย }
            { 1000000098;Label  ;25500;846  ;2400 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รวม }
            { 1000000108;Shape  ;0    ;0    ;27900;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=28200;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Item Ledger Entry".FIELDNO("Item No.");
                         END;

            OnPostSection=BEGIN
                            IF CurrReport.SHOWOUTPUT THEN BEGIN
                              BeginingQty := 0;
                              EndingQty := 0;
                              BeginingAmt := 0;
                              EndingAmt := 0;
                              //RemQty := 0;
                              //RemAmt := 0;
                              RecNotInv := 0;
                              ShipNotInv := 0;

                              Item.GET("Item No.");

                              //Begining
                              IF StartingDate <> 0D THEN BEGIN
                                ItemLedgEntry.RESET;
                                ItemLedgEntry.SETCURRENTKEY("Item No.","Location Code","Posting Date");
                                ItemLedgEntry.COPYFILTERS("Item Ledger Entry");
                                ItemLedgEntry.SETRANGE("Item No.","Item No.");
                                IF Item.GETFILTER("Location Filter") <> '' THEN
                                  ItemLedgEntry.SETRANGE("Location Code",Item.GETFILTER("Location Filter"));
                                //  ItemLedgEntry.SETRANGE("Location Code","Location Code");
                                ItemLedgEntry.SETFILTER("Posting Date",'<%1',StartingDate);
                                IF ItemLedgEntry.FIND('-') THEN
                                REPEAT
                                  ValueEntry.RESET;
                                  ValueEntry.SETCURRENTKEY("Item Ledger Entry No.");
                                  ValueEntry.SETRANGE("Item Ledger Entry No.",ItemLedgEntry."Entry No.");  //TSA001
                                  ValueEntry.SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
                                  ValueEntry.SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
                                  ValueEntry.SETFILTER("Global Dimension 1 Code",Item.GETFILTER("Global Dimension 1 Filter"));
                                  ValueEntry.SETFILTER("Global Dimension 2 Code",Item.GETFILTER("Global Dimension 2 Filter"));
                                  //TSA001
                                  IF ValueEntry.FIND('-') THEN
                                  REPEAT
                                    BeginingAmt := BeginingAmt + ValueEntry."Cost Posted to G/L";
                                    BeginingQty := BeginingQty + ItemLedgEntry."Invoiced Quantity";
                                  UNTIL ValueEntry.NEXT = 0;
                                  //TSA001
                                UNTIL ItemLedgEntry.NEXT=0;
                              END;

                              //Ending
                              IF EndingDate <> 0D THEN BEGIN
                                ItemLedgEntry.RESET;
                                ItemLedgEntry.SETCURRENTKEY("Item No.","Location Code","Posting Date");
                                ItemLedgEntry.COPYFILTERS("Item Ledger Entry");
                                ItemLedgEntry.SETRANGE("Item No.","Item No.");
                                IF Item.GETFILTER("Location Filter") <> '' THEN
                                  ItemLedgEntry.SETRANGE("Location Code",Item.GETFILTER("Location Filter"));
                                //  ItemLedgEntry.SETRANGE("Location Code","Location Code");
                                ItemLedgEntry.SETFILTER("Posting Date",'>%1',EndingDate);
                                IF ItemLedgEntry.FIND('-') THEN
                                REPEAT
                                  ValueEntry.RESET;
                                  ValueEntry.SETCURRENTKEY("Item Ledger Entry No.");
                                  ValueEntry.SETRANGE("Item Ledger Entry No.",ItemLedgEntry."Entry No.");  //TSA001
                                  ValueEntry.SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
                                  ValueEntry.SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
                                  ValueEntry.SETFILTER("Global Dimension 1 Code",Item.GETFILTER("Global Dimension 1 Filter"));
                                  ValueEntry.SETFILTER("Global Dimension 2 Code",Item.GETFILTER("Global Dimension 2 Filter"));
                                  //TSA001
                                  IF ValueEntry.FIND('-') THEN
                                  REPEAT
                                    EndingAmt := EndingAmt + ValueEntry."Cost Posted to G/L";
                                    EndingQty := EndingQty + ItemLedgEntry."Invoiced Quantity";
                                  UNTIL ValueEntry.NEXT = 0;
                                  //TSA001
                                UNTIL ItemLedgEntry.NEXT=0;
                              END;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;150  ;346  ;16050;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Item No.;
                                                                    THA=รหัสสินค้า];
                                                         SourceExpr="Item No." + ' ' + Item.Description + Item."Description 2" }
            { 1000000054;TextBox;22800;346  ;2550 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=BeginingQty }
            { 1000000055;TextBox;25500;346  ;2400 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=BeginingAmt }
            { 1117700000;TextBox;17100;346  ;5250 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='ยอดยกมา ' + FORMAT(StartingDate) }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=28200;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Item Ledger Entry".FIELDNO("Location Code");
                         END;

            OnPostSection=BEGIN
                            IF CurrReport.SHOWOUTPUT THEN BEGIN
                              LocationName := '';
                              IF recLocation.GET("Item Ledger Entry"."Location Code") THEN
                                LocationName := recLocation.Name;

                              BeginingAmtperLoc := 0;
                              BeginingQtyperLoc := 0;

                              IF StartingDate <> 0D THEN BEGIN
                                ItemLedgEntry.RESET;
                                ItemLedgEntry.SETCURRENTKEY("Item No.","Location Code","Posting Date");
                                ItemLedgEntry.COPYFILTERS("Item Ledger Entry");
                                ItemLedgEntry.SETRANGE("Item No.","Item No.");
                                IF Item.GETFILTER("Location Filter") <> '' THEN
                                  ItemLedgEntry.SETRANGE("Location Code",Item.GETFILTER("Location Filter"));
                                ItemLedgEntry.SETRANGE("Location Code","Location Code");
                                ItemLedgEntry.SETFILTER("Posting Date",'<%1',StartingDate);
                                IF ItemLedgEntry.FIND('-') THEN
                                REPEAT
                                  ValueEntry.RESET;
                                  ValueEntry.SETCURRENTKEY("Item Ledger Entry No.");
                                  ValueEntry.SETRANGE("Item Ledger Entry No.",ItemLedgEntry."Entry No.");  //TSA001
                                  ValueEntry.SETFILTER("Variant Code",Item.GETFILTER("Variant Filter"));
                                  ValueEntry.SETFILTER("Location Code",Item.GETFILTER("Location Filter"));
                                  ValueEntry.SETFILTER("Global Dimension 1 Code",Item.GETFILTER("Global Dimension 1 Filter"));
                                  ValueEntry.SETFILTER("Global Dimension 2 Code",Item.GETFILTER("Global Dimension 2 Filter"));
                                  IF ValueEntry.FIND('-') THEN
                                  REPEAT
                                    BeginingAmtperLoc := BeginingAmtperLoc + ValueEntry."Cost Posted to G/L";
                                    BeginingQtyperLoc := BeginingQtyperLoc + ItemLedgEntry."Invoiced Quantity";
                                  UNTIL ValueEntry.NEXT=0;
                                UNTIL ItemLedgEntry.NEXT=0;
                              END;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000104;TextBox;2550 ;0    ;3150 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Location Code" }
            { 1000000105;Label  ;750  ;0    ;1950 ;500  ;FontName=tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Location:;
                                                                    THA=คลังเก็บสินค้า:] }
            { 1117700007;TextBox;22800;0    ;2550 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=BeginingQtyperLoc }
            { 1117700008;TextBox;25500;0    ;2400 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=BeginingAmtperLoc }
            { 1117700009;TextBox;17100;0    ;5250 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='ยอดยกมา ' + FORMAT(StartingDate) }
            { 1117700013;TextBox;5850 ;0    ;10350;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=LocationName }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=28200;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ("Posting Date" >= StartingDate) AND ("Posting Date" <= EndingDate);
                         END;

          }
          CONTROLS
          {
            { 1000000014;TextBox;5850 ;0    ;1350 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Posting Date" }
            { 1000000017;TextBox;7350 ;0    ;2850 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Document No." }
            { 1000000023;TextBox;10350;0    ;1350 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Location Code" }
            { 1000000026;TextBox;23100;0    ;2250 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Remaining Qty;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=RemQty }
            { 1000000010;TextBox;14400;0    ;1800 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=In Qty;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=IncQty }
            { 1000000011;TextBox;16350;0    ;1950 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Out Qty;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=DrcQty }
            { 1000000012;TextBox;25500;0    ;2400 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=[ENU=Remaining Amount;
                                                                    THA=จำนวนที่เหลือ];
                                                         SourceExpr=RemAmt }
            { 1000000013;TextBox;18450;0    ;2100 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=In Amount;
                                                         SourceExpr=IncAmt }
            { 1000000020;TextBox;20700;0    ;2250 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Out Amount;
                                                         SourceExpr=DrcAmt }
            { 1000000051;TextBox;13200;0    ;1200 ;500  ;FontName=tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Unit of Measure Code" }
            { 1000000053;TextBox;11700;0    ;1500 ;500  ;FontName=tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Entry Type" }
            { 1117700002;TextBox;1650 ;0    ;3600 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Item No." }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=28200;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Item Ledger Entry".FIELDNO("Location Code");
                         END;

          }
          CONTROLS
          {
            { 1000000113;Shape  ;0    ;846  ;27900;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1117700004;TextBox;750  ;0    ;9900 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='TotalFor : ' + "Location Code" }
            { 1117700005;TextBox;25500;0    ;2400 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=Remaining Amount;
                                                                    THA=จำนวนที่เหลือ];
                                                         SourceExpr=RemAmt }
            { 1117700006;TextBox;22800;0    ;2550 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Remaining Qty;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=RemQty }
            { 1117700010;TextBox;17100;500  ;5250 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='ยอดยกไป ' + FORMAT(EndingDate) }
            { 1117700011;TextBox;25500;500  ;2400 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=BeginingAmtperLoc + RemAmt }
            { 1117700012;TextBox;22800;500  ;2550 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=BeginingQtyperLoc + RemQty }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=28200;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=  CurrReport.TOTALSCAUSEDBY = LastFieldNo;
                         END;

          }
          CONTROLS
          {
            { 1000000035;TextBox;22800;0    ;2550 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=BeginingQty + RemQty }
            { 1000000036;TextBox;17100;0    ;5250 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='ยอดยกไป ' + FORMAT(EndingDate) }
            { 1000000038;TextBox;25500;0    ;2400 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=BeginingAmt + RemAmt }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=28200;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Item Ledger Entry".FIELDNO("Item No.");
                         END;

            OnPostSection=BEGIN
                            IF CurrReport.SHOWOUTPUT THEN BEGIN
                              TotalQty := TotalQty + BeginingQty + RemQty;
                              TotalAmt := TotalAmt + BeginingAmt + RemAmt;
                              BranchTotalQty := BranchTotalQty + BeginingQty + RemQty;
                              BranchTotalAmt := BranchTotalAmt + BeginingAmt + RemAmt;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000031;TextBox;150  ;0    ;16050;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalFor + FIELDCAPTION("Item No.") + ' : ' + "Item No." }
            { 1000000032;TextBox;22800;0    ;2550 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=BeginingQty + EndingQty + RemQty }
            { 1000000039;TextBox;25500;0    ;2400 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         SourceExpr=BeginingAmt + RemAmt + EndingAmt }
            { 1000000007;TextBox;17100;0    ;5250 ;500  ;FontSize=8;
                                                         FontBold=No;
                                                         SourceExpr=Text001+'  '+FORMAT(WORKDATE) }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=28200;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Item Ledger Entry".FIELDNO("Item No.");
                         END;

            OnPostSection=BEGIN
                            {IF CurrReport.SHOWOUTPUT THEN BEGIN
                              BeginingQty := 0;
                              EndingQty := 0;
                              BeginingAmt := 0;
                              EndingAmt := 0;
                              //RemQty := 0;
                              //RemAmt := 0;
                              RecNotInv := 0;
                              ShipNotInv := 0;
                            END;
                             }
                          END;

          }
          CONTROLS
          {
            { 1000000114;Shape  ;0    ;0    ;27900;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=28200;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1   ;Label        ;150  ;0    ;3450 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=[ENU=GrandTotal;
                                                                    THA=ยอดรวม] }
            { 2   ;Shape        ;0    ;423  ;27900;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 3   ;TextBox      ;22800;0    ;2550 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalQty }
            { 4   ;TextBox      ;25500;0    ;2400 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalAmt }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1117700000 : Record 79;
      Item@1000000003 : Record 27;
      ItemLedgEntry@1000000007 : Record 32;
      ValueEntry@1117700001 : Record 5802;
      recLocation@1117700004 : Record 14;
      ItemFilter@1000000008 : Text[250];
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      TotalFor@1000000002 : TextConst 'ENU="Total for ";THA="รวมสำหรับ "';
      StartingDate@1000000009 : Date;
      EndingDate@1000000010 : Date;
      BeginingQty@1000000005 : Decimal;
      EndingQty@1000000006 : Decimal;
      BeginingAmt@1000000017 : Decimal;
      EndingAmt@1000000013 : Decimal;
      IncQty@1000000016 : Decimal;
      DrcQty@1000000015 : Decimal;
      RemQty@1000000014 : Decimal;
      IncAmt@1000000012 : Decimal;
      DrcAmt@1000000011 : Decimal;
      RemAmt@1000000004 : Decimal;
      TotalQty@1000 : Decimal;
      TotalAmt@1001 : Decimal;
      RecNotInv@1002 : Decimal;
      ShipNotInv@1003 : Decimal;
      BranchTotalQty@1000000018 : Decimal;
      BranchTotalAmt@1000000019 : Decimal;
      Text001@1000000020 : TextConst 'ENU=ยอด ณ วันที่;THA=ยอด ณ วันที่';
      BeginingQtyperLoc@1117700003 : Decimal;
      BeginingAmtperLoc@1117700002 : Decimal;
      LocationName@1117700005 : Text[50];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.12.2005   KKE   -Stock Card Report.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50020 Stock Card (New)
{
  OBJECT-PROPERTIES
  {
    Date=02/20/08;
    Time=[ 2:18:46 PM];
    Version List=AVATHA4.01;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Stock Card (New);
               THA=รายงานสินค้าและวัตถุดิบ];
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   AsOfDate := TODAY;
                 END;

    OnPreReport=BEGIN
                  ItemDateFilter := Item.GETFILTER("Date Filter");
                  IF CompanyInfo.GET THEN
                    FOR i := 1 TO 10 DO
                      TaxID[i] := COPYSTR(CompanyInfo."VAT Registration No.",i,1);
                  FOR i := 1 TO 4 DO
                    Branch[i] := '0';

                  IF AsOfDate = 0D THEN
                    ERROR('As of date must be specify.');

                  //ForMonth := PurchaseVAT.FormatDateThai(1,AsOfDate);
                END;

    Orientation=Landscape;
    PaperSize=A4 210 x 297 mm;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table27;
        DataItemTableView=SORTING(No.);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("No.");
                      END;

        OnAfterGetRecord=BEGIN
                           TotalQuantity := 0;
                           TotalPos := 0;
                           TotalNeg := 0;
                           TotalPosAmt := 0;
                           TotalNegAmt := 0;
                           OpeningBalance := 0;
                           OpeningBalanceAmt := 0;
                           CLEAR(tmpdate); //TSA-001

                           IF ItemDateFilter <> '' THEN
                             IF GETRANGEMIN("Date Filter") > 01010000D THEN BEGIN
                               tmpdate := GETRANGEMIN("Date Filter") - 1 ;
                               //SETRANGE("Date Filter",0D,GETRANGEMIN("Date Filter") - 1);  //TSA001
                               SETRANGE("Date Filter",0D, tmpdate);  //TSA001
                               CALCFIELDS("Net Change");
                               OpeningBalance := "Net Change";

                               //TSA001
                               g_recItemLedgerEntry.RESET;
                               g_recItemLedgerEntry.SETRANGE("Item No.",Item."No.");
                               g_recItemLedgerEntry.SETRANGE("Posting Date",0D,tmpdate);
                               IF g_recItemLedgerEntry.FIND('-') THEN
                               REPEAT
                                 g_recItemLedgerEntry.CALCFIELDS("Cost Amount (Actual)");
                                 OpeningBalanceAmt += g_recItemLedgerEntry."Cost Amount (Actual)" ;
                               UNTIL g_recItemLedgerEntry.NEXT = 0;
                               //TSA001

                               SETFILTER("Date Filter",ItemDateFilter);
                             END;
                         END;

        ReqFilterFields=No.,Date Filter,Location Filter;
        GroupTotalFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27750;
            SectionHeight=6780;
          }
          CONTROLS
          {
            { 1000000000;Label  ;8100 ;0    ;9900 ;846  ;HorzAlign=Center;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=รายงานสินค้าและวัตถุดิบ;
                                                                    THA=สินค้าคงคลัง - รายละเอียดธุรกรรม] }
            { 1000000002;TextBox;25200;1100 ;900  ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=หน้า;
                                                                    THA=หน้า];
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000003;Label  ;23700;1100 ;1350 ;423  ;ParentControl=1000000002;
                                                         HorzAlign=Right;
                                                         FontSize=9 }
            { 1000000004;TextBox;8100 ;846  ;9900 ;846  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         SourceExpr='ประจำเดือน ' + ForMonth }
            { 1000000005;Label  ;150  ;2100 ;5100 ;423  ;FontSize=9;
                                                         CaptionML=ENU=ชื่อผู้ประกอบการ }
            { 1000000006;Label  ;150  ;2523 ;5100 ;423  ;FontSize=9;
                                                         CaptionML=ENU=ชื่อสถานประกอบการ }
            { 1000000007;Label  ;150  ;2946 ;5100 ;423  ;Name=1000000004;
                                                         FontSize=9;
                                                         CaptionML=ENU=รหัสสินค้า / วัตถุดิบ }
            { 1000000008;Label  ;150  ;3369 ;5100 ;423  ;FontSize=9;
                                                         CaptionML=ENU=ชื่อสินค้า / วัตถุดิบ }
            { 1000000009;Label  ;150  ;4638 ;5100 ;423  ;FontSize=9;
                                                         CaptionML=ENU=Unit Standard Cost THB }
            { 1000000010;TextBox;5550 ;2100 ;6450 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=COMPANYNAME }
            { 1000000011;TextBox;5550 ;2523 ;6450 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=COMPANYNAME }
            { 1000000012;TextBox;5550 ;2946 ;6450 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="No." }
            { 1000000013;TextBox;5550 ;3369 ;11250;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=Description + "Description 2" }
            { 1000000014;TextBox;5550 ;4638 ;6450 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Standard Cost" }
            { 1000000015;Label  ;17400;2600 ;4350 ;500  ;HorzAlign=Right;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000017;Label  ;19650;3300 ;2250 ;700  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=ENU=สำนักงานใหญ่ }
            { 1000000019;Label  ;18750;3300 ;750  ;700  ;HorzAlign=Center;
                                                         FontSize=11;
                                                         CaptionML=ENU=X }
            { 1000000020;Shape  ;18750;3300 ;750  ;700   }
            { 1000000021;Label  ;150  ;4215 ;5100 ;423  ;FontSize=9;
                                                         CaptionML=ENU=ปริมาณนับเป็น }
            { 1000000022;TextBox;5550 ;4215 ;6450 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=Item."Base Unit of Measure" }
            { 1000000023;Label  ;18750;4700 ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=ENU=จากวันที่ }
            { 1000000024;TextBox;20250;4700 ;1950 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=FromDate;
                                                         Format=<Day,2>/<Month,2>/<Year4> }
            { 1000000025;TextBox;23850;4700 ;1950 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         SourceExpr=AsOfDate;
                                                         Format=<Day,2>/<Month,2>/<Year4> }
            { 1000000026;Label  ;22200;4700 ;1650 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=ถึงวันที่ }
            { 1000000028;TextBox;20400;4200 ;5250 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr=Location }
            { 1000000029;Label  ;18750;4200 ;1650 ;423  ;FontSize=9;
                                                         CaptionML=ENU=คลังสินค้า }
            { 1000000030;Shape  ;24450;5499 ;300  ;1269 ;ShapeStyle=VertLine }
            { 1000000031;Label  ;21600;6345 ;2850 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=AMT }
            { 1000000033;Label  ;19500;6345 ;2100 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=QTY }
            { 1000000034;Shape  ;21450;6345 ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000035;Label  ;16650;6345 ;2550 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=AMT }
            { 1000000037;Label  ;14700;6346 ;1800 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=QTY }
            { 1000000038;Shape  ;16500;6357 ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000039;Label  ;9600 ;5922 ;4950 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=รับ }
            { 1000000040;Label  ;14550;5922 ;4650 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=จ่าย }
            { 1000000041;Label  ;19500;5922 ;4950 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=คงเหลือ }
            { 1000000045;Label  ;11700;6346 ;2850 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=AMT }
            { 1000000047;Shape  ;9600 ;5800 ;15000;200  ;ShapeStyle=HorzLine }
            { 1000000048;Label  ;9600 ;6346 ;2100 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=QTY }
            { 1000000049;Shape  ;11550;6346 ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000050;Label  ;7200 ;5500 ;2250 ;1269 ;HorzAlign=Center;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Doc.\Reference }
            { 1000000051;Shape  ;9450 ;5500 ;300  ;1269 ;ShapeStyle=VertLine }
            { 1000000052;Label  ;5400 ;5500 ;1800 ;1269 ;HorzAlign=Center;
                                                         FontSize=9;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Transaction Type }
            { 1000000053;Shape  ;7200 ;5500 ;300  ;1269 ;ShapeStyle=VertLine }
            { 1000000054;Label  ;150  ;5499 ;4950 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=ใบสำคัญ }
            { 1000000055;Label  ;2100 ;5922 ;3000 ;846  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000056;Shape  ;5100 ;5500 ;300  ;1268 ;ShapeStyle=VertLine }
            { 1000000057;Shape  ;150  ;5500 ;27300;30   ;ShapeStyle=HorzLine }
            { 1000000058;Label  ;150  ;5922 ;1800 ;846  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=วัน เดือน ปี }
            { 1000000059;Shape  ;1800 ;5934 ;300  ;846  ;ShapeStyle=VertLine }
            { 1000000060;Shape  ;0    ;5499 ;300  ;1269 ;ShapeStyle=VertLine }
            { 1000000066;TextBox;25650;3460 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[4] }
            { 1000000080;Shape  ;24300;3460 ;1800 ;423   }
            { 1000000081;TextBox;25200;3460 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[3] }
            { 1000000082;Shape  ;25650;3460 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000083;TextBox;24750;3460 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[2] }
            { 1000000084;Shape  ;25200;3460 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000085;TextBox;24300;3460 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[1] }
            { 1000000086;Shape  ;24750;3460 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000087;Label  ;23100;3400 ;1200 ;540  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=สาขาที่ }
            { 1000000088;Shape  ;21900;2646 ;4500 ;423   }
            { 1000000089;TextBox;25950;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[10] }
            { 1000000090;Shape  ;25950;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000091;TextBox;25500;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[9] }
            { 1000000092;TextBox;25050;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[8] }
            { 1000000093;Shape  ;25500;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000094;Shape  ;25050;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000095;TextBox;24600;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[7] }
            { 1000000096;TextBox;24150;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[6] }
            { 1000000097;Shape  ;24600;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000098;TextBox;23700;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[5] }
            { 1000000099;Shape  ;24150;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000100;TextBox;23250;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[4] }
            { 1000000101;Shape  ;23700;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000102;Shape  ;23250;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000103;TextBox;22800;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[3] }
            { 1000000104;Shape  ;23250;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000105;Shape  ;22800;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000106;TextBox;22350;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[2] }
            { 1000000107;TextBox;21900;2646 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=TaxID[1] }
            { 1000000108;Shape  ;22350;2646 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000120;Shape  ;150  ;6750 ;27300;30   ;ShapeStyle=HorzLine }
            { 1000000121;Shape  ;150  ;5800 ;5100 ;200  ;ShapeStyle=HorzLine }
            { 1000000122;Shape  ;14400;5901 ;300  ;846  ;ShapeStyle=VertLine }
            { 1000000123;Shape  ;19200;5900 ;300  ;846  ;ShapeStyle=VertLine }
            { 1000000124;Shape  ;9600 ;6250 ;15000;200  ;ShapeStyle=HorzLine }
            { 1000000125;Label  ;13050;5500 ;6450 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=ปริมาณสินค้าและวัตถุดิบ }
            { 1000000032;Shape  ;27300;5499 ;300  ;1269 ;ShapeStyle=VertLine }
            { 1000000036;Label  ;24750;5900 ;2550 ;423  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000027;Label  ;150  ;3800 ;5100 ;423  ;FontSize=9;
                                                         CaptionML=ENU=ชนิด/ขนาด }
            { 1000000044;TextBox;5550 ;3800 ;6450 ;423  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr='' }
            { 1000000001;Shape  ;22200;3300 ;750  ;700   }
            { 1000000046;TextBox;22800;1600 ;3250 ;500  ;HorzAlign=Right;
                                                         FontName=AngsanaUPC;
                                                         FontSize=11;
                                                         CaptionML=ENU=หน้า;
                                                         SourceExpr=FORMAT(TODAY,0,1) + ' / ' + FORMAT(TIME,0) }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27750;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000016;TextBox;19500;0    ;1800 ;423  ;HorzAlign=General;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=OpeningBalance }
            { 1000000018;TextBox;24750;0    ;2250 ;423  ;SourceExpr=Text001 }
            { 1000000109;Shape  ;24450;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000110;Shape  ;1800 ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000111;Shape  ;5100 ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000112;Shape  ;7200 ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000113;Shape  ;11550;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000114;Shape  ;14400;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000115;Shape  ;16500;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000116;Shape  ;19200;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000117;Shape  ;21450;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000118;Shape  ;9450 ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000119;Shape  ;0    ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000042;Shape  ;27300;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000141;TextBox;21900;0    ;2400 ;423  ;HorzAlign=General;
                                                         FontBold=No;
                                                         SourceExpr=OpeningBalanceAmt }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=27750;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1500029;TextBox   ;24750;0    ;2250 ;423  ;FontBold=No;
                                                         SourceExpr=Text002 }
            { 1500031;TextBox   ;9750 ;0    ;1800 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=pos;
                                                                    THA=pos];
                                                         DecimalPlaces=0:5;
                                                         BlankZero=Yes;
                                                         SourceExpr=TotalPos }
            { 1500032;TextBox   ;14700;0    ;1800 ;423  ;FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         BlankZero=Yes;
                                                         SourceExpr=TotalNeg }
            { 1000000126;Shape  ;24450;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000130;Shape  ;11550;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000131;Shape  ;14400;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000132;Shape  ;16500;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000133;Shape  ;19200;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000134;Shape  ;21450;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000135;Shape  ;9450 ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000136;Shape  ;0    ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000137;Shape  ;27300;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000138;Shape  ;150  ;0    ;27300;30   ;ShapeStyle=HorzLine }
            { 1000000139;Shape  ;150  ;393  ;27300;30   ;ShapeStyle=HorzLine }
            { 1000000140;TextBox;16800;0    ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=pos;
                                                                    THA=pos];
                                                         BlankZero=Yes;
                                                         SourceExpr=TotalNegAmt }
            { 1000000129;TextBox;12000;0    ;2250 ;423  ;FontBold=Yes;
                                                         CaptionML=[ENU=pos;
                                                                    THA=pos];
                                                         BlankZero=Yes;
                                                         SourceExpr=TotalPosAmt }
            { 1000000143;TextBox;19500;0    ;1800 ;423  ;HorzAlign=General;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=OpeningBalance }
            { 1000000144;TextBox;21900;0    ;2400 ;423  ;HorzAlign=General;
                                                         FontBold=Yes;
                                                         SourceExpr=OpeningBalanceAmt }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=27750;
            SectionHeight=30;
            OnPreSection=BEGIN
                           IF NOT FooterPrinted THEN
                             LastFieldNo := CurrReport.TOTALSCAUSEDBY;
                           CurrReport.SHOWOUTPUT := NOT FooterPrinted;
                           FooterPrinted := TRUE;
                         END;

          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table32;
        DataItemTableView=SORTING(Item No.,Posting Date);
        OnAfterGetRecord=BEGIN
                           Pos := 0;
                           Neg := 0;
                           PosAmt := 0;
                           NegAmt := 0;
                           "Item Ledger Entry".CALCFIELDS("Cost Amount (Actual)");
                           IF "Item Ledger Entry".Quantity > 0 THEN BEGIN
                             Pos := "Item Ledger Entry".Quantity;
                             PosAmt := "Cost Amount (Actual)";
                           END ELSE BEGIN
                             Neg := "Item Ledger Entry".Quantity;
                             NegAmt := "Cost Amount (Actual)";
                           END;
                           OpeningBalance := OpeningBalance + "Item Ledger Entry".Quantity;
                           OpeningBalanceAmt := OpeningBalanceAmt + "Cost Amount (Actual)";
                           TotalPos := TotalPos + Pos;
                           TotalNeg := TotalNeg + Neg;
                           TotalPosAmt := TotalPosAmt + PosAmt;
                           TotalNegAmt := TotalNegAmt + NegAmt;
                           TotalQuantity := TotalQuantity + "Item Ledger Entry".Quantity;

                           //KKE : #003 +
                           DocNo := "Document No.";
                           ValueEntry.RESET;
                           ValueEntry.SETRANGE("Item Ledger Entry No.","Entry No.");
                           IF ValueEntry.FIND('-') THEN
                             DocNo := ValueEntry."Document No.";
                           //KKE : #003 -
                         END;

        DataItemLink=Item No.=FIELD(No.),
                     Posting Date=FIELD(Date Filter),
                     Location Code=FIELD(Location Filter);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27750;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000061;TextBox;150  ;0    ;1800 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr="Posting Date" }
            { 1000000062;TextBox;2100 ;0    ;3150 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=DocNo }
            { 1000000067;Shape  ;24450;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;1800 ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;5100 ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000070;Shape  ;7200 ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000071;Shape  ;11550;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000072;Shape  ;14400;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000073;Shape  ;16500;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;19200;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;21450;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000076;TextBox;5400 ;0    ;1800 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr="Entry Type" }
            { 1000000077;TextBox;7430 ;0    ;2020 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="External Document No." }
            { 1000000078;Shape  ;9450 ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000079;Shape  ;0    ;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000063;TextBox;9750 ;0    ;1800 ;423  ;CaptionML=[ENU=pos;
                                                                    THA=pos];
                                                         DecimalPlaces=0:5;
                                                         BlankZero=Yes;
                                                         SourceExpr=Pos }
            { 1000000065;TextBox;14700;0    ;1800 ;423  ;DecimalPlaces=0:5;
                                                         BlankZero=Yes;
                                                         SourceExpr=Neg }
            { 1000000064;TextBox;19500;0    ;1800 ;423  ;HorzAlign=General;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=OpeningBalance }
            { 1000000043;Shape  ;27300;0    ;300  ;423  ;ShapeStyle=VertLine }
            { 1000000127;TextBox;12000;0    ;2250 ;423  ;CaptionML=[ENU=pos;
                                                                    THA=pos];
                                                         BlankZero=Yes;
                                                         SourceExpr=PosAmt }
            { 1000000128;TextBox;16800;0    ;2250 ;423  ;CaptionML=[ENU=pos;
                                                                    THA=pos];
                                                         BlankZero=Yes;
                                                         SourceExpr=NegAmt }
            { 1000000142;TextBox;21900;0    ;2400 ;423  ;HorzAlign=General;
                                                         FontBold=No;
                                                         SourceExpr=OpeningBalanceAmt }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1000000000;TextBox;2860 ;110  ;1920 ;440  ;SourceExpr=AsOfDate }
      { 1000000001;Label  ;110  ;110  ;2640 ;440  ;CaptionML=ENU=As of Date }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000004 : Record 79;
      Item2@1500011 : Record 27;
      PurchaseVAT@1000000007 : Report 50005;
      LastFieldNo@1500010 : Integer;
      FooterPrinted@1500009 : Boolean;
      Pos@1500008 : Decimal;
      PosAmt@1000000009 : Decimal;
      TotalPosAmt@1000000011 : Decimal;
      Neg@1500007 : Decimal;
      NegAmt@1000000010 : Decimal;
      TotalNegAmt@1000000012 : Decimal;
      OpeningBalance@1500006 : Decimal;
      OpeningBalanceAmt@1000000013 : Decimal;
      TotalQuantity@1500005 : Decimal;
      TotalPos@1500004 : Decimal;
      TotalNeg@1500003 : Decimal;
      ItemDateFilter@1500002 : Text[60];
      ForMonth@1000000008 : Text[250];
      MinRange@1500001 : Date;
      MaxRange@1500000 : Date;
      Text001@1500013 : TextConst 'ENU=Opening Balance;THA=เปิดงบดุล';
      Text002@1500012 : TextConst 'ENU=Closing Balance;THA=การปิดงบดุล';
      AsOfDate@1000000002 : Date;
      TaxID@1000000001 : ARRAY [13] OF Text[1];
      Branch@1000000006 : ARRAY [4] OF Text[1];
      FromDate@1000000000 : Date;
      Location@1000000003 : Text[50];
      i@1000000005 : Integer;
      g_recItemLedgerEntry@1000000014 : Record 32;
      tmpdate@1000000015 : Date;
      ValueEntry@1000000017 : Record 5802;
      DocNo@1000000016 : Code[20];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut
      TSA : Theerasak Saenwiset

      No.   Date         Sign  Description
      ----------------------------------------
      001   13.10.2006   TSA   -Calculate Opening Balance Amount
      002   20.04.2007   KKE   -Add filter by Location Code
      003   24.07.2007   KKE   -Show Document No. from Posted Invoice.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50021 Customer Sales Summary
{
  OBJECT-PROPERTIES
  {
    Date=05/02/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    RightMargin=0;
    OnPreReport=BEGIN
                  DateFilter := Customer.GETFILTER("Date Filter");
                  CustFilter := Customer.GETFILTERS;
                  ItemFilter := "Sales Invoice Line".GETFILTER("No.");
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table18;
        DataItemTableView=SORTING(No.);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("No.");
                      END;

        OnAfterGetRecord=BEGIN
                           InvoiceQty := 0;
                           CreMemoQty := 0;
                           InvoiceAmount := 0;
                           CreMemoAmount := 0;
                         END;

        ReqFilterFields=No.,Date Filter;
        GroupTotalFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Customer Sales Summary }
            { 1000000002;TextBox;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;846  ;9900 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;17700;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;16950;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1000000047;TextBox;0    ;1692 ;18000;423  ;FontSize=7;
                                                         SourceExpr=CustFilter + '  Item No. Filter : ' + ItemFilter }
            { 1000000052;TextBox;15000;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Customer Sales Summary") }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000022;Label  ;16050;423  ;1800 ;846  ;ParentControl=1000000021;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000020;Label  ;13950;423  ;1800 ;846  ;ParentControl=1000000019;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;10200;423  ;1800 ;846  ;ParentControl=1000000017;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000016;Label  ;12150;423  ;1500 ;846  ;ParentControl=1000000015;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000013;Label  ;5400 ;423  ;4500 ;846  ;ParentControl=1000000012;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000011;Label  ;3750 ;423  ;1500 ;846  ;ParentControl=1000000010;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000007;Label  ;2850 ;423  ;750  ;846  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000027;Shape  ;0    ;0    ;18150;423  ;ShapeStyle=HorzLine }
            { 1000000028;Shape  ;0    ;1269 ;18150;423  ;ShapeStyle=HorzLine }
            { 1000000045;Label  ;1200 ;423  ;1350 ;846  ;ParentControl=1000000044;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000008;TextBox;2400 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Customer No.;
                                                         SourceExpr="No." }
            { 1000000009;Label  ;0    ;0    ;2250 ;423  ;ParentControl=1000000008;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes }
            { 1000000014;TextBox;4200 ;0    ;7200 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Name }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000038;TextBox;9600 ;0    ;2400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=InvoiceQty - CreMemoQty }
            { 1000000039;TextBox;15000;0    ;2850 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=InvoiceAmount - CreMemoAmount }
            { 1000000040;Label  ;0    ;0    ;1500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000041;Shape  ;0    ;423  ;18150;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000048;TextBox;9600 ;0    ;2400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalInvoiceQty - TotalCreMemoQty }
            { 1000000049;TextBox;15000;0    ;2850 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalInvoiceAmount - TotalCreMemoAmount }
            { 1000000050;Label  ;0    ;0    ;2550 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Grand Total }
            { 1000000051;Shape  ;0    ;423  ;18150;423  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table113;
        DataItemTableView=SORTING(Sell-to Customer No.)
                          WHERE(Quantity=FILTER(<>0),
                                Type=CONST(Item));
        ReqFilterHeadingML=ENU=Detail Line;
        OnAfterGetRecord=BEGIN
                           IF DateFilter <> '' THEN BEGIN
                             SalesInvHdr.RESET;
                             SalesInvHdr.SETRANGE("No.","Document No.");
                             SalesInvHdr.SETFILTER("Posting Date",DateFilter);
                             IF NOT SalesInvHdr.FIND('-') THEN
                               CurrReport.SKIP;
                           END;
                           SalesInvHdr2.GET("Document No.");
                         END;

        ReqFilterFields=No.;
        TotalFields=Quantity,Amount;
        DataItemLink=Bill-to Customer No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000025;Label  ;600  ;0    ;1500 ;846  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Invoice }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000000;TextBox;2850 ;0    ;750  ;423  ;FontSize=8;
                                                         SourceExpr=Type }
            { 1000000010;TextBox;3750 ;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="No." }
            { 1000000012;TextBox;5400 ;0    ;4500 ;423  ;FontSize=8;
                                                         SourceExpr=Description }
            { 1000000015;TextBox;12150;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="Unit of Measure" }
            { 1000000017;TextBox;10200;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=Quantity }
            { 1000000019;TextBox;13950;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Unit Price" }
            { 1000000021;TextBox;16050;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=Amount }
            { 1000000044;TextBox;1200 ;0    ;1350 ;423  ;FontSize=8;
                                                         CaptionML=ENU=Posting Date;
                                                         SourceExpr=SalesInvHdr2."Posting Date" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=846;
            OnPreSection=BEGIN
                           InvoiceQty := Quantity;
                           InvoiceAmount := Amount;

                           TotalInvoiceQty += Quantity;
                           TotalInvoiceAmount += Amount;
                         END;

          }
          CONTROLS
          {
            { 1000000023;TextBox;15000;0    ;2850 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Amount }
            { 1000000024;TextBox;9600 ;0    ;2400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Quantity }
            { 1000000042;Label  ;1200 ;0    ;2550 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total Invoice }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table115;
        DataItemTableView=SORTING(Sell-to Customer No.)
                          WHERE(Quantity=FILTER(<>0),
                                Type=CONST(Item));
        OnPreDataItem=BEGIN
                        SETFILTER("No.",ItemFilter);
                      END;

        OnAfterGetRecord=BEGIN
                           IF DateFilter <> '' THEN BEGIN
                             SalesCreMemoHdr.RESET;
                             SalesCreMemoHdr.SETRANGE("No.","Document No.");
                             SalesCreMemoHdr.SETFILTER("Posting Date",DateFilter);
                             IF NOT SalesCreMemoHdr.FIND('-') THEN
                               CurrReport.SKIP;
                           END;
                           SalesCreMemoHdr2.GET("Document No.");
                         END;

        TotalFields=Quantity,Amount;
        DataItemLink=Bill-to Customer No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000026;Label  ;600  ;0    ;2700 ;846  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Credit Memo }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000029;TextBox;2850 ;0    ;750  ;423  ;FontSize=8;
                                                         SourceExpr=Type }
            { 1000000030;TextBox;3750 ;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="No." }
            { 1000000031;TextBox;5400 ;0    ;4500 ;423  ;FontSize=8;
                                                         SourceExpr=Description }
            { 1000000032;TextBox;12150;0    ;1500 ;423  ;FontSize=8;
                                                         SourceExpr="Unit of Measure" }
            { 1000000033;TextBox;10200;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=Quantity }
            { 1000000034;TextBox;13950;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr="Unit Price" }
            { 1000000035;TextBox;16050;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=Amount }
            { 1000000046;TextBox;1200 ;0    ;1350 ;423  ;FontSize=8;
                                                         CaptionML=ENU=Posting Date;
                                                         SourceExpr=SalesCreMemoHdr2."Posting Date" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CreMemoQty := Quantity;
                           CreMemoAmount := Amount;

                           TotalCreMemoQty += Quantity;
                           TotalCreMemoAmount += Amount;
                         END;

          }
          CONTROLS
          {
            { 1000000036;TextBox;15000;0    ;2850 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Amount }
            { 1000000037;TextBox;9600 ;0    ;2400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Quantity }
            { 1000000043;Label  ;1200 ;0    ;3600 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total Credit Memo }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SalesInvHdr@1000000007 : Record 112;
      SalesCreMemoHdr@1000000008 : Record 114;
      SalesInvHdr2@1000000010 : Record 112;
      SalesCreMemoHdr2@1000000009 : Record 114;
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      InvoiceQty@1000000002 : Decimal;
      InvoiceAmount@1000000003 : Decimal;
      CreMemoQty@1000000004 : Decimal;
      CreMemoAmount@1000000005 : Decimal;
      TotalInvoiceQty@1000000016 : Decimal;
      TotalInvoiceAmount@1000000015 : Decimal;
      TotalCreMemoQty@1000000014 : Decimal;
      TotalCreMemoAmount@1000000013 : Decimal;
      DateFilter@1000000006 : Text[250];
      CustFilter@1000000011 : Text[250];
      ItemFilter@1000000012 : Text[250];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.03.2007   KKE   New report for Subscription Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50022 Confirm Magazine/Volume/Issue
{
  OBJECT-PROPERTIES
  {
    Date=08/23/07;
    Time=[ 6:15:55 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50012;
        DataItemTableView=SORTING(Create as Item)
                          WHERE(Create as Item=CONST(No));
        OnPreDataItem=BEGIN
                        IF NOT FINDFIRST THEN
                          CurrReport.BREAK;

                        MagazineSalesSetup.GET;
                        MagazineSalesSetup.TESTFIELD("Default Base UOM");
                        MagazineSalesSetup.TESTFIELD("Default Costing Method");
                        //MagazineSalesSetup.TESTFIELD("Default Gen. Prod. Posting");
                        MagazineSalesSetup.TESTFIELD("Default VAT Prod. Posting Grou");
                        MagazineSalesSetup.TESTFIELD("Default WHT Prod. Posting Grou");
                        MagazineSalesSetup.TESTFIELD("Default Inventory Posting Grou");
                      END;

        OnAfterGetRecord=BEGIN
                           Item.INIT;
                           Item."No." := NoSeriesMgnt.GetNextNo("Magazine Item Nos.",WORKDATE,TRUE);
                           Item.INSERT(TRUE);

                           ItemUOM.INIT;
                           ItemUOM.VALIDATE("Item No.",Item."No.");
                           ItemUOM.VALIDATE(Code,MagazineSalesSetup."Default Base UOM");
                           ItemUOM.INSERT;

                           Magazine.GET("Magazine Code");
                           Magazine.TESTFIELD("Default Gen. Prod. Posting");
                           Item.VALIDATE(Description,COPYSTR("Magazine Code" + '-' + "Volume No." + '-' + "Issue No.",1,30));
                           Item.VALIDATE("Base Unit of Measure",MagazineSalesSetup."Default Base UOM");
                           Item."Costing Method" := MagazineSalesSetup."Default Costing Method";
                           //Item.VALIDATE("Gen. Prod. Posting Group",MagazineSalesSetup."Default Gen. Prod. Posting");
                           Item.VALIDATE("Gen. Prod. Posting Group",Magazine."Default Gen. Prod. Posting");
                           Item.VALIDATE("VAT Prod. Posting Group",MagazineSalesSetup."Default VAT Prod. Posting Grou");
                           Item.VALIDATE("WHT Product Posting Group",MagazineSalesSetup."Default WHT Prod. Posting Grou");
                           Item.VALIDATE("Inventory Posting Group",MagazineSalesSetup."Default Inventory Posting Grou");
                           Item."Item Type" := Item."Item Type"::Magazine;
                           Item."Magazine Code" := "Magazine Code";
                           Item."Volume No." := "Volume No.";
                           Item."Issue No." := "Issue No.";
                           Item."Issue Date" := "Issue Date";
                           Item."Unit Price" := "Unit Price";
                           Item."No. Series" := "Magazine Item Nos.";
                           IF Magazine."Dimension 1 Code" <> '' THEN
                             Item.VALIDATE("Global Dimension 1 Code",Magazine."Dimension 1 Code");
                           Item."Last Pick-up Date" := CALCDATE(Magazine."Pick-up Interval","Issue Date");
                           Item.MODIFY;

                           Volume.GET("Volume No.");
                           IF Volume."Dimension 3 Code" <> '' THEN
                             DimMgnt.SaveDefaultDim(DATABASE::Item,Item."No.",3,Volume."Dimension 3 Code");

                           IssueNo.GET("Issue No.");
                           IF IssueNo."Dimension 4 Code" <> '' THEN
                             DimMgnt.SaveDefaultDim(DATABASE::Item,Item."No.",4,IssueNo."Dimension 4 Code");

                           IF Item."No." <> '' THEN BEGIN
                             MagazineVolumeIssue := "Magazine/Volume/Issue - Matrix";
                             MagazineVolumeIssue."Create as Item" := TRUE;
                             MagazineVolumeIssue."Magazine Item No." := Item."No.";
                             MagazineVolumeIssue.MODIFY;
                           END;
                         END;

        ReqFilterFields=Magazine Code,Volume No.,Issue No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      MagazineSalesSetup@1000000000 : Record 50007;
      MagazineVolumeIssue@1000000007 : Record 50012;
      Magazine@1000000008 : Record 50011;
      Item@1000000001 : Record 27;
      ItemUOM@1000000006 : Record 5404;
      Volume@1000000005 : Record 50008;
      IssueNo@1000000004 : Record 50009;
      NoSeriesMgnt@1000000003 : Codeunit 396;
      DimMgnt@1000000002 : Codeunit 408;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.03.2007   KKE   New batchjob to confirm Magazine/Volume/Issue for Magazine Sales Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50023 Create Subscriber Delivery
{
  OBJECT-PROPERTIES
  {
    Date=08/16/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF MagazineItemNo = '' THEN
                    ERROR(Text000);

                  SubscriptionSetup.GET;
                  SubscriptionSetup.TESTFIELD("Posted Invoice Nos.");
                  SubscriptionSetup.TESTFIELD("Delivery Location Code");
                END;

    OnPostReport=BEGIN
                   IF SalesHeader."No." <> '' THEN BEGIN // Not the first time
                     FinalizeSalesHeader;
                     IF (NoOfSalesInvErrors = 0) AND NOT HideDialog THEN BEGIN
                       MESSAGE(
                         Text003,
                         NoOfSalesInv);
                     END ELSE
                       IF NOT HideDialog THEN
                         MESSAGE(
                           Text002,
                           NoOfSalesInvErrors)
                   END ELSE
                     IF NOT HideDialog THEN
                       MESSAGE(Text001);
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50006;
        DataItemTableView=SORTING(Shipping Agent Code,Delivered Flag)
                          WHERE(Paid Flag=CONST(Yes),
                                Sales Order Flag=CONST(No),
                                Delivered Flag=CONST(No),
                                Reversed Flag=CONST(No));
        OnPreDataItem=BEGIN
                        IF SubscriberNo <> '' THEN
                          SETRANGE("Subscriber No.",SubscriberNo);
                        IF ShippingAgentCode <> '' THEN
                          SETRANGE("Shipping Agent Code",ShippingAgentCode);
                        SETRANGE("Magazine Code",MagazineVolumeIssue."Magazine Code");
                        SETRANGE("Volume No.",MagazineVolumeIssue."Volume No.");
                        SETRANGE("Issue No.",MagazineVolumeIssue."Issue No.");
                      END;

        OnAfterGetRecord=BEGIN
                           SubscriberContract.GET("Subscriber Contract No.");
                           IF (SubscriberContract."Contract Status" <> SubscriberContract."Contract Status"::Released) OR
                              (SubscriberContract."Payment Status" <> SubscriberContract."Payment Status"::Paid)
                           THEN
                             CurrReport.SKIP;

                           IF "Shipping Agent Code" <> Cust."No." THEN
                             Cust.GET("Shipping Agent Code");
                           IF NOT (Cust.Blocked IN [Cust.Blocked::All,Cust.Blocked::Invoice]) THEN BEGIN
                             TESTFIELD("Shipping Agent Code");
                             IF ("Shipping Agent Code" <> SalesHeader."Sell-to Customer No.") OR
                                ("Magazine Code" <> SubscriberContractLE."Magazine Code")
                             THEN BEGIN
                               IF SalesHeader."No." <> '' THEN
                                 FinalizeSalesHeader;
                               InsertSalesHeader("Subscriber Contract L/E");
                               InsertSalesLine("Subscriber Contract L/E",MagazineItemNo,FALSE);
                             END ELSE
                               InsertSalesLine("Subscriber Contract L/E",MagazineItemNo,FALSE);
                           END ELSE
                             NoOfSalesInvErrors := NoOfSalesInvErrors + 1;

                           IF ("Magazine Code" <> SubscriberContractLE."Magazine Code") THEN
                             SubscriberContractLE := "Subscriber Contract L/E";
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50006;
        DataItemTableView=SORTING(Subscriber Contract No.,Subscriber No.,Magazine Code,Volume No.,Issue No.)
                          WHERE(Paid Flag=CONST(Yes),
                                Delivered Flag=CONST(No),
                                Sales Order Flag=CONST(No),
                                Reversed Flag=CONST(No));
        DataItemVarName=Subscriber Contract L/E2;
        OnPreDataItem=BEGIN
                        IF NOT IncludeOlderthanMagazine THEN
                          CurrReport.BREAK;

                        SETFILTER("Issue Date",'<%1',"Subscriber Contract L/E"."Issue Date");
                      END;

        OnAfterGetRecord=BEGIN
                           InsertSalesLine("Subscriber Contract L/E2",
                             MagazineVolumeIssue.GetMagazineItemNo("Magazine Code","Volume No.","Issue No."),
                             TRUE);
                         END;

        DataItemLink=Subscriber Contract No.=FIELD(Subscriber Contract No.),
                     Subscriber No.=FIELD(Subscriber No.),
                     Magazine Code=FIELD(Magazine Code),
                     Volume No.=FIELD(Volume No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=5390;
    }
    CONTROLS
    {
      { 1000000000;TextBox;3520 ;770  ;3080 ;440  ;CaptionML=ENU=Magazine Item No.;
                                                   SourceExpr=MagazineItemNo;
                                                   TableRelation=Item WHERE (Item Type=CONST(Magazine));
                                                   OnValidate=VAR
                                                                Magazine@1000000000 : Record 50011;
                                                              BEGIN
                                                                SalesOrderNos := '';
                                                                CLEAR(MagazineVolumeIssue);
                                                                IF MagazineItemNo = '' THEN
                                                                  EXIT;

                                                                MagazineVolumeIssue.SETPERMISSIONFILTER;
                                                                MagazineVolumeIssue.SETRANGE("Magazine Item No.",MagazineItemNo);
                                                                MagazineVolumeIssue.FIND('-');
                                                                Magazine.GET(MagazineVolumeIssue."Magazine Code");
                                                                Magazine.TESTFIELD("Subscriber S/O Nos.");
                                                                SalesOrderNos := Magazine."Subscriber S/O Nos.";
                                                              END;
                                                               }
      { 1000000001;Label  ;110  ;770  ;3300 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;3520 ;110  ;3080 ;440  ;CaptionML=ENU=Subscriber No.;
                                                   SourceExpr=SubscriberNo;
                                                   TableRelation=Subscriber }
      { 1000000003;Label  ;110  ;110  ;3300 ;440  ;ParentControl=1000000002 }
      { 1000000004;TextBox;3520 ;1320 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Magazine Code;
                                                   SourceExpr=MagazineVolumeIssue."Magazine Code" }
      { 1000000005;Label  ;880  ;1320 ;2530 ;440  ;ParentControl=1000000004 }
      { 1000000006;TextBox;3520 ;1870 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Volume No.;
                                                   SourceExpr=MagazineVolumeIssue."Volume No." }
      { 1000000007;Label  ;880  ;1870 ;2530 ;440  ;ParentControl=1000000006 }
      { 1000000008;TextBox;3520 ;2420 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Issue No.;
                                                   SourceExpr=MagazineVolumeIssue."Issue No." }
      { 1000000009;Label  ;880  ;2420 ;2530 ;440  ;ParentControl=1000000008 }
      { 1000000010;TextBox;3520 ;2970 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Issue Date;
                                                   SourceExpr=MagazineVolumeIssue."Issue Date" }
      { 1000000011;Label  ;880  ;2970 ;2530 ;440  ;ParentControl=1000000010 }
      { 1000000012;CheckBox;4730;4070 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Include Older than Magazine;
                                                   SourceExpr=IncludeOlderthanMagazine }
      { 1000000013;Label  ;110  ;4070 ;4510 ;440  ;ParentControl=1000000012 }
      { 1000000014;TextBox;3520 ;4730 ;2200 ;440  ;CaptionML=ENU=Shipping Agent Code;
                                                   SourceExpr=ShippingAgentCode;
                                                   TableRelation=Customer WHERE (Shipping Agent=CONST(Yes)) }
      { 1000000015;Label  ;110  ;4730 ;3300 ;440  ;ParentControl=1000000014 }
      { 1000000016;TextBox;3520 ;3520 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Sales Order Nos.;
                                                   SourceExpr=SalesOrderNos }
      { 1000000017;Label  ;880  ;3520 ;2530 ;440  ;ParentControl=1000000016 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SubscriptionSetup@1000000000 : Record 50000;
      Cust@1000000001 : Record 18;
      Subscriber@1000000002 : Record 50001;
      SubscriberContract@1000000024 : Record 50005;
      SubscriberContractLE@1000000004 : Record 50006;
      SalesHeader@1000000003 : Record 36;
      SalesLine@1000000011 : Record 37;
      Item@1000000016 : Record 27;
      MagazineVolumeIssue@1000000018 : Record 50012;
      TempToLineDim@1000000010 : TEMPORARY Record 357;
      DimMgt@1000000009 : Codeunit 408;
      NoSeriesMgt@1000000023 : Codeunit 396;
      NextLineNo@1000000008 : Integer;
      NoOfSalesInv@1000000007 : Integer;
      NoOfSalesInvErrors@1000000006 : Integer;
      HideDialog@1000000005 : Boolean;
      Text000@1000000021 : TextConst 'ENU=Magazine Item No. must be specify.';
      Text001@1000000014 : TextConst 'ENU=There is nothing to create.;THA=ไม่มีสิ่งใดที่จะรวม';
      Text002@1000000012 : TextConst 'ENU=Not all the invoices were posted. A total of %1 invoices were not posted.;THA=มีบางใบส่งของที่ยังไม่ได้ลงรายการบัญชี  ดังนั้น จึงไม่ได้ลงรายการบัญชีผลรวมของใบส่งของ %1';
      Text003@1000000013 : TextConst 'ENU=The sales order for subscriber are now completed, and the number of order(s) created is %1.;THA=ขณะนี้ ได้รวมการจัดส่งแล้ว, และจำนวนของใบส่งของที่สร้างคือ %1';
      SubscriberNo@1000000017 : Code[20];
      MagazineItemNo@1000000015 : Code[20];
      ShippingAgentCode@1000000019 : Code[20];
      IncludeOlderthanMagazine@1000000020 : Boolean;
      SalesOrderNos@1000000022 : Code[10];

    LOCAL PROCEDURE FinalizeSalesHeader@2();
    BEGIN
      WITH SalesHeader DO BEGIN
        SalesHeader.FIND;
        DimMgt.TransferTempToDimToDocDim(TempToLineDim);
      //  COMMIT;
      END;
    END;

    LOCAL PROCEDURE InsertSalesHeader@1(xSubscriberContractLE@1000000000 : Record 50006);
    VAR
      Magazine@1000000001 : Record 50011;
      Volume@1000000002 : Record 50008;
      IssueNo@1000000003 : Record 50009;
    BEGIN
      WITH SalesHeader DO BEGIN
        INIT;
        "Document Type" := "Document Type"::Order;
        "No." := NoSeriesMgt.GetNextNo(SalesOrderNos,WORKDATE,TRUE);
        INSERT(TRUE);
        VALIDATE("Sell-to Customer No.",xSubscriberContractLE."Shipping Agent Code");
        VALIDATE("Order Date",xSubscriberContractLE."Issue Date");
        VALIDATE("Posting Date",xSubscriberContractLE."Issue Date");
        Magazine.GET(xSubscriberContractLE."Magazine Code");
        Magazine.TESTFIELD("Payment Method for Delivery");
        VALIDATE("Payment Method Code",Magazine."Payment Method for Delivery");
        VALIDATE("Shortcut Dimension 1 Code",Magazine."Dimension 1 Code");
        VALIDATE("Posting No. Series",SubscriptionSetup."Posted Invoice Nos.");
        IF SubscriptionSetup."Delivery Location Code" <> '' THEN
          VALIDATE("Location Code",SubscriptionSetup."Delivery Location Code");
        MODIFY;
      //  COMMIT;
        NoOfSalesInv := NoOfSalesInv + 1;
      END;
    END;

    PROCEDURE InsertSalesLine@1000000006(xSubscriberContractLE@1000000000 : Record 50006;xMagazineItemNo@1000000001 : Code[20];OldMagazine@1000000006 : Boolean);
    VAR
      Magazine@1000000004 : Record 50011;
      Volume@1000000003 : Record 50008;
      IssueNo@1000000002 : Record 50009;
      SubscriberContract@1000000005 : Record 50005;
    BEGIN
      IF xMagazineItemNo = '' THEN
        EXIT;

      WITH SalesLine DO BEGIN
        SETRANGE("Document Type",SalesHeader."Document Type");
        SETRANGE("Document No.",SalesHeader."No.");
        "Document Type" := SalesHeader."Document Type";
        "Document No." := SalesHeader."No.";

        NextLineNo += 10000;
        "Line No." := NextLineNo;
        VALIDATE(Type,SalesLine.Type::Item);
        VALIDATE("No.",xMagazineItemNo);
        VALIDATE(Quantity,1);
        VALIDATE("Unit Price",xSubscriberContractLE."Unit Price");
        VALIDATE("Subscriber Contract No.",xSubscriberContractLE."Subscriber Contract No.");
        INSERT(TRUE);

        Magazine.GET(xSubscriberContractLE."Magazine Code");
        VALIDATE("Shortcut Dimension 1 Code",Magazine."Dimension 1 Code");
        Volume.GET(xSubscriberContractLE."Volume No.");
        IssueNo.GET(xSubscriberContractLE."Issue No.");
        DimMgt.SaveDocDim(
          DATABASE::"Sales Line",
          "Document Type"::Order,
          "Document No.","Line No.",
          3,Volume."Dimension 3 Code");
        DimMgt.SaveDocDim(
          DATABASE::"Sales Line",
          "Document Type"::Order,
          "Document No.","Line No.",
          4,IssueNo."Dimension 4 Code");
        MODIFY;

        xSubscriberContractLE."Sales Order Flag" := TRUE;
        xSubscriberContractLE."Sales Order Date" := SalesHeader."Posting Date";  //issue date
        xSubscriberContractLE."Sales Order No." := "Document No.";
        xSubscriberContractLE."Sales Order Line No." := "Line No.";
        xSubscriberContractLE.MODIFY;
        IF (NOT OldMagazine) AND
           SubscriberContract.GET(xSubscriberContractLE."Subscriber Contract No.")
        THEN BEGIN
          SubscriberContract."Last SO Doc. No." := "Document No.";
          SubscriberContract."Last SO Date" := SalesHeader."Posting Date";
          SubscriberContract."Last SO Magazine Item No." := MagazineItemNo;
          SubscriberContract.MODIFY;
        END;
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.03.2007   KKE   New batchjob to create subscriber delivery - Subscription Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50024 Close Subscriber Contract
{
  OBJECT-PROPERTIES
  {
    Date=08/07/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   IF NoOfUpdated <= 1 THEN
                     MESSAGE(Text001,NoOfUpdated,'record')
                   ELSE
                     MESSAGE(Text001,NoOfUpdated,'records');
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50005;
        DataItemTableView=SORTING(No.)
                          WHERE(Contract Status=CONST(Released));
        OnAfterGetRecord=BEGIN
                           SubscriberContractLE.SETPERMISSIONFILTER;
                           SubscriberContractLE.RESET;
                           SubscriberContractLE.SETRANGE("Magazine Code","Magazine Code");
                           SubscriberContractLE.SETRANGE("Subscriber Contract No.","No.");
                           SubscriberContractLE.SETRANGE("Paid Flag",FALSE);
                           IF SubscriberContractLE.FIND('-') THEN
                             CurrReport.SKIP;

                           SubscriberContractLE.RESET;
                           SubscriberContractLE.SETRANGE("Magazine Code","Magazine Code");
                           SubscriberContractLE.SETRANGE("Subscriber Contract No.","No.");
                           SubscriberContractLE.SETRANGE("Sales Order Flag",FALSE);
                           IF SubscriberContractLE.FIND('-') THEN
                             CurrReport.SKIP;

                           SubscriberContractLE.RESET;
                           SubscriberContractLE.SETRANGE("Magazine Code","Magazine Code");
                           SubscriberContractLE.SETRANGE("Subscriber Contract No.","No.");
                           SubscriberContractLE.SETRANGE("Delivered Flag",FALSE);
                           IF SubscriberContractLE.FIND('-') THEN
                             CurrReport.SKIP;

                           "Contract Status" := "Contract Status"::Closed;
                           MODIFY;
                           NoOfUpdated += 1;
                         END;

        ReqFilterFields=Magazine Code;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SubscriberContractLE@1000000000 : Record 50006;
      NoOfUpdated@1000000001 : Integer;
      Text001@1000000002 : TextConst 'ENU=Update complete %1 %2.';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.03.2007   KKE   -Subscription Module - Close Subscriber Contract
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50025 Create Magazine/Volume/IssueNo
{
  OBJECT-PROPERTIES
  {
    Date=04/23/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF MagazineCode = '' THEN
                    ERROR(STRSUBSTNO(Text000,'Magazine Code'));
                  IF VolumeNo = '' THEN
                    ERROR(STRSUBSTNO(Text000,'Volume No.'));
                  IF FromIssue = '' THEN
                    ERROR(STRSUBSTNO(Text000,'From Issue No.'));
                  IF ToIssue = '' THEN
                    ERROR(STRSUBSTNO(Text000,'To Issue No.'));
                  IF StartIssueDate = 0D THEN
                    ERROR(STRSUBSTNO(Text000,'Starting Issue Date'));

                  IssueNo.SETRANGE(Code,FromIssue,ToIssue);
                  IssueNo.FINDFIRST;
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50009;
        DataItemTableView=SORTING(Code);
        OnPreDataItem=BEGIN
                        COPY(IssueNo);
                        Magazine.GET(MagazineCode);
                        Magazine.TESTFIELD(Frequency);
                        Frequency.GET(Magazine.Frequency);
                        Frequency.TESTFIELD("Date Formula");
                      END;

        OnAfterGetRecord=BEGIN
                           MagazineVolumeIssue.INIT;
                           MagazineVolumeIssue.VALIDATE("Magazine Code",Magazine.Code);
                           MagazineVolumeIssue.VALIDATE("Volume No.",VolumeNo);
                           MagazineVolumeIssue.VALIDATE("Issue No.",Code);
                           MagazineVolumeIssue.VALIDATE("Issue Date",StartIssueDate);
                           MagazineVolumeIssue."Unit Price" := Magazine."Unit Price";
                           MagazineVolumeIssue.VALIDATE("Magazine Item Nos.",Magazine."Magazine Item Nos.");
                           MagazineVolumeIssue.INSERT;
                           StartIssueDate := CALCDATE(STRSUBSTNO('CD + %1',Frequency."Date Formula"), StartIssueDate);
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1000000000;TextBox;3520 ;110  ;2420 ;440  ;CaptionML=ENU=Magazine Code;
                                                   SourceExpr=MagazineCode;
                                                   TableRelation=Magazine }
      { 1000000001;Label  ;110  ;110  ;3300 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;3520 ;660  ;2420 ;440  ;CaptionML=ENU=Volume No.;
                                                   SourceExpr=VolumeNo;
                                                   TableRelation=Volume }
      { 1000000003;Label  ;110  ;660  ;3300 ;440  ;ParentControl=1000000002 }
      { 1000000004;TextBox;3520 ;1210 ;2420 ;440  ;CaptionML=ENU=From Issue No.;
                                                   SourceExpr=FromIssue;
                                                   TableRelation="Issue No." }
      { 1000000005;Label  ;110  ;1210 ;3300 ;440  ;ParentControl=1000000004 }
      { 1000000006;TextBox;3520 ;1760 ;2420 ;440  ;CaptionML=ENU=To Issue No.;
                                                   SourceExpr=ToIssue;
                                                   TableRelation="Issue No." }
      { 1000000007;Label  ;110  ;1760 ;3300 ;440  ;ParentControl=1000000006 }
      { 1000000008;TextBox;3520 ;2310 ;1700 ;440  ;CaptionML=ENU=Starting Issue Date;
                                                   SourceExpr=StartIssueDate }
      { 1000000009;Label  ;110  ;2310 ;3300 ;440  ;ParentControl=1000000008 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      MagazineVolumeIssue@1000000008 : Record 50012;
      Magazine@1000000007 : Record 50011;
      Frequency@1000000006 : Record 50010;
      IssueNo@1000000005 : Record 50009;
      MagazineCode@1000000004 : Code[20];
      VolumeNo@1000000003 : Code[20];
      FromIssue@1000000002 : Code[20];
      ToIssue@1000000001 : Code[20];
      StartIssueDate@1000000000 : Date;
      Text000@1000000009 : TextConst 'ENU=%1 must be specify.';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.03.2007   KKE   -Circulation Module - Create Magazine/Volume/IssueNo.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50026 Confirm Ads. Item No.
{
  OBJECT-PROPERTIES
  {
    Date=06/21/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50012;
        DataItemTableView=SORTING(Create as Item,Magazine Item No.)
                          WHERE(Create as Item=CONST(Yes),
                                Create as Ads. Item=CONST(No));
        OnPreDataItem=BEGIN
                        IF NOT FINDFIRST THEN
                          CurrReport.BREAK;

                        AdsItemSetup.GET;
                        AdsItemSetup.TESTFIELD("Default Base UOM");
                      END;

        OnAfterGetRecord=BEGIN
                           AdsItem.INIT;
                           AdsItem."Ads. Item No." := NoSeriesMgnt.GetNextNo("Ads. Item Nos.",WORKDATE,TRUE);
                           AdsItem.INSERT(TRUE);

                           AdsItem."Magazine Code" := "Magazine Code";
                           AdsItem."Volume No." := "Volume No.";
                           AdsItem."Issue No." := "Issue No.";
                           AdsItem."Issue Date" := "Issue Date";
                           AdsItem."Base Unit of Measure" := AdsItemSetup."Default Base UOM";
                           AdsItem."VAT Prod. Posting Group" := AdsItemSetup."VAT Prod. Posting Group";
                           AdsItem."Ads. Closing Date" := "Ads. Closing Date";
                           AdsItem."No. Series" := "Ads. Item Nos.";
                           AdsItem.MODIFY;
                           IF AdsItem."Ads. Item No." <> '' THEN BEGIN
                             MagazineVolumeIssue := "Magazine/Volume/Issue - Matrix";
                             MagazineVolumeIssue."Create as Ads. Item" := TRUE;
                             MagazineVolumeIssue."Ads. Item No." := AdsItem."Ads. Item No.";
                             MagazineVolumeIssue.MODIFY;
                           END;
                         END;

        ReqFilterFields=Magazine Code,Volume No.,Issue No.,Magazine Item No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AdsItemSetup@1000000008 : Record 50026;
      MagazineVolumeIssue@1000000006 : Record 50012;
      Item@1000000007 : Record 27;
      AdsItem@1000000005 : Record 50036;
      Magazine@1000000004 : Record 50011;
      Volume@1000000003 : Record 50008;
      IssueNo@1000000002 : Record 50009;
      NoSeriesMgnt@1000000001 : Codeunit 396;
      DimMgnt@1000000000 : Codeunit 408;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.03.2007   KKE   -Circulation Module - Confirm Ads Item No.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50027 Create Ads. Invoice
{
  OBJECT-PROPERTIES
  {
    Date=06/18/12;
    Time=[ 2:42:28 PM];
    Modified=Yes;
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF NOT UserSetup.GET(USERID) THEN
                    CLEAR(UserSetup);
                  IF NOT UserSetup."Allow Create Ads. Invoice" THEN
                    ERROR(Text004);

                  IF BilltoCust = '' THEN
                    ERROR(Text000,'Bill-to Customer No.');
                  {
                  IF AdsItemNo = '' THEN
                    ERROR(Text000,'Ads. Item No.');
                  IF ScheduleInvDate = 0D THEN
                    ERROR(Text000,'Schedule Invoice Date');
                  }
                  IF PostingDate = 0D THEN
                    ERROR(Text000,'Posting Date');
                  IF DocumentDate = 0D THEN
                    ERROR(Text000,'Document Date');

                  AdsItemSetup.GET;
                  AdsItemSetup.TESTFIELD("Ads. Sales Invoice Nos.");
                  SalesInvNos := AdsItemSetup."Ads. Sales Invoice Nos.";
                  AdsItemSetup.TESTFIELD("Posted Invoice Nos.");
                END;

    OnPostReport=BEGIN
                   IF SalesHeader."No." <> '' THEN BEGIN // Not the first time
                     FinalizeSalesHeader;
                     IF (NoOfSalesInvErrors = 0) AND NOT HideDialog THEN BEGIN
                       MESSAGE(
                         Text003,
                         NoOfSalesInv);
                     END ELSE
                       IF NOT HideDialog THEN
                         MESSAGE(
                           Text002,
                           NoOfSalesInvErrors)
                   END ELSE
                     IF NOT HideDialog THEN
                       MESSAGE(Text001);
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50037;
        DataItemTableView=SORTING(Bill-to Customer No.,Sell-to Customer No.);
        OnPreDataItem=BEGIN
                        IF SelltoCust <> '' THEN
                          SETFILTER("Sell-to Customer No.",SelltoCust);
                        IF BilltoCust <> '' THEN
                          SETFILTER("Bill-to Customer No.",BilltoCust);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50038;
        DataItemTableView=SORTING(Ads. Item No.,Line Status)
                          WHERE(Line Status=CONST(Approved));
        OnPreDataItem=BEGIN
                        IF AdsBookingNo <> '' THEN
                          SETFILTER("Booking No.",AdsBookingNo);
                        IF AdsProduct <> '' THEN
                          SETFILTER("Ads. Product",AdsProduct);

                        IF AdsItemNo <> '' THEN
                          SETFILTER("Ads. Item No.",AdsItemNo);
                        {
                        IF ScheduleInvDate <> 0D THEN
                          SETRANGE("Scheduled Invoice Date",ScheduleInvDate);
                        }
                        SETRANGE("Magazine Code");
                        SETPERMISSIONFILTER;
                      END;

        OnAfterGetRecord=BEGIN
                           IF "Bill-to Customer No." <> Cust."No." THEN
                             Cust.GET("Bill-to Customer No.");
                           IF NOT (Cust.Blocked IN [Cust.Blocked::All,Cust.Blocked::Invoice]) THEN BEGIN
                             TESTFIELD("Bill-to Customer No.");

                             IF CombineInvDoc THEN BEGIN
                               IF ("Bill-to Customer No." <> SalesHeader."Bill-to Customer No.") OR
                                  ("Ads. Booking Header"."Salesperson Code" <> SalesHeader."Salesperson Code") OR
                                  ("Ads. Booking Header"."Ads. Sales Type" <> SalesHeader."Ads. Sales Type") OR
                                  ("Ads. Booking Header"."Zone Area" <> SalesHeader."Zone Area")
                               THEN BEGIN
                                 IF SalesHeader."No." <> '' THEN
                                   FinalizeSalesHeader;
                                 InsertSalesHeader("Ads. Booking Line");
                               END;
                               IF "Create Sales Invoice" THEN BEGIN
                                 TESTFIELD("Bill Revenue G/L Account");
                                 InsertSalesLine(
                                   "Ads. Booking Line",
                                   "Bill Revenue G/L Account",
                                   "Cash Invoice Amount");
                                 AdsBookingLine.GET("Booking No.","Line No.");
                                 AdsBookingLine."Line Status" := AdsBookingLine."Line Status"::Invoiced;
                                 AdsBookingLine."Last Status Date" := CURRENTDATETIME;//GKU:002
                                 AdsBookingLine."Last Date Modified" := CURRENTDATETIME;  //18.06.2012
                                 AdsBookingLine."Cash Invoice No." := SalesHeader."No.";
                                 AdsBookingLine.Closed := TRUE;
                                 //AdsBookingLine."Scheduled Invoice Date" := ScheduleInvDate;
                                 AdsBookingLine.MODIFY;
                               END;
                               IF "Barter Required Document" THEN BEGIN
                                 TESTFIELD("Barter G/L Account");
                                 InsertSalesLine(
                                   "Ads. Booking Line",
                                   "Barter G/L Account",
                                   "Barter Amount");
                                 AdsBookingLine.GET("Booking No.","Line No.");
                                 AdsBookingLine."Line Status" := AdsBookingLine."Line Status"::Invoiced;
                                 AdsBookingLine."Last Status Date" := CURRENTDATETIME;//GKU:002
                                 AdsBookingLine."Last Date Modified" := CURRENTDATETIME;  //18.06.2012
                                 AdsBookingLine."Barter Invoice No." := SalesHeader."No.";
                                 AdsBookingLine.Closed := TRUE;
                                 //AdsBookingLine."Scheduled Invoice Date" := ScheduleInvDate;
                                 AdsBookingLine.MODIFY;
                               END;
                             END ELSE BEGIN
                               IF "Create Sales Invoice" THEN BEGIN
                                 IF SalesHeader."No." <> '' THEN
                                   FinalizeSalesHeader;
                                 InsertSalesHeader("Ads. Booking Line");

                                 TESTFIELD("Bill Revenue G/L Account");
                                 InsertSalesLine(
                                   "Ads. Booking Line",
                                   "Bill Revenue G/L Account",
                                   "Cash Invoice Amount");
                                 AdsBookingLine.GET("Booking No.","Line No.");
                                 AdsBookingLine."Line Status" := AdsBookingLine."Line Status"::Invoiced;
                                 AdsBookingLine."Last Status Date" := CURRENTDATETIME;//GKU:002
                                 AdsBookingLine."Last Date Modified" := CURRENTDATETIME;  //18.06.2012
                                 AdsBookingLine."Cash Invoice No." := SalesHeader."No.";
                                 AdsBookingLine.Closed := TRUE;
                                 //AdsBookingLine."Scheduled Invoice Date" := ScheduleInvDate;
                                 AdsBookingLine.MODIFY;
                               END;
                               IF "Barter Required Document" THEN BEGIN
                                 IF SalesHeader."No." <> '' THEN
                                   FinalizeSalesHeader;
                                 InsertSalesHeader("Ads. Booking Line");

                                 TESTFIELD("Barter G/L Account");
                                 InsertSalesLine(
                                   "Ads. Booking Line",
                                   "Barter G/L Account",
                                   "Barter Amount");
                                 AdsBookingLine.GET("Booking No.","Line No.");
                                 AdsBookingLine."Line Status" := AdsBookingLine."Line Status"::Invoiced;
                                 AdsBookingLine."Last Status Date" := CURRENTDATETIME;//GKU:002
                                 AdsBookingLine."Last Date Modified" := CURRENTDATETIME;  //18.06.2012
                                 AdsBookingLine."Barter Invoice No." := SalesHeader."No.";
                                 AdsBookingLine.Closed := TRUE;
                                 //AdsBookingLine."Scheduled Invoice Date" := ScheduleInvDate;
                                 AdsBookingLine.MODIFY;
                               END;
                             END;
                           END ELSE
                             NoOfSalesInvErrors := NoOfSalesInvErrors + 1;
                         END;

        CalcFields=Sell-to Customer No.,Bill-to Customer No.;
        DataItemLink=Booking No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=13860;
      Height=7590;
      OnInit=VAR
               Magazine@1000000000 : Record 50011;
             BEGIN
             END;

      OnOpenForm=BEGIN
                   SalesInvNos := '';
                   CLEAR(MagazineVolumeIssue);
                   IF AdsItemNo = '' THEN
                     EXIT;

                   MagazineVolumeIssue.SETPERMISSIONFILTER;
                   MagazineVolumeIssue.SETRANGE("Magazine Code");
                   MagazineVolumeIssue.SETRANGE("Ads. Item No.",AdsItemNo);
                   MagazineVolumeIssue.FIND('-');
                   PostingDate := WORKDATE;
                   DocumentDate := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 1000000000;TextBox;3520 ;1760 ;3080 ;440  ;InPage=-1;
                                                   CaptionML=ENU=Ads. Item No.;
                                                   SourceExpr=AdsItemNo;
                                                   TableRelation="Ads. Item";
                                                   OnValidate=VAR
                                                                Magazine@1000000000 : Record 50011;
                                                              BEGIN
                                                                SalesInvNos := '';
                                                                CLEAR(MagazineVolumeIssue);
                                                                IF AdsItemNo = '' THEN
                                                                  EXIT;

                                                                MagazineVolumeIssue.SETPERMISSIONFILTER;
                                                                MagazineVolumeIssue.SETRANGE("Magazine Code");
                                                                MagazineVolumeIssue.SETRANGE("Ads. Item No.",AdsItemNo);
                                                                MagazineVolumeIssue.FIND('-');
                                                              END;
                                                               }
      { 1000000001;Label  ;110  ;1760 ;3300 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;3520 ;110  ;2750 ;440  ;InPage=-1;
                                                   CaptionML=ENU=Ads. Booking No.;
                                                   SourceExpr=AdsBookingNo;
                                                   TableRelation="Ads. Booking Header" }
      { 1000000003;Label  ;110  ;110  ;3300 ;440  ;ParentControl=1000000002;
                                                   FontBold=Yes }
      { 1000000004;TextBox;3520 ;2310 ;2200 ;440  ;Editable=No;
                                                   InPage=-1;
                                                   CaptionML=ENU=Magazine Code;
                                                   SourceExpr=MagazineVolumeIssue."Magazine Code" }
      { 1000000005;Label  ;880  ;2310 ;2530 ;440  ;ParentControl=1000000004 }
      { 1000000006;TextBox;3520 ;2860 ;2200 ;440  ;Editable=No;
                                                   InPage=-1;
                                                   CaptionML=ENU=Volume No.;
                                                   SourceExpr=MagazineVolumeIssue."Volume No." }
      { 1000000007;Label  ;880  ;2860 ;2530 ;440  ;ParentControl=1000000006 }
      { 1000000008;TextBox;3520 ;3410 ;2200 ;440  ;Editable=No;
                                                   InPage=-1;
                                                   CaptionML=ENU=Issue No.;
                                                   SourceExpr=MagazineVolumeIssue."Issue No." }
      { 1000000009;Label  ;880  ;3410 ;2530 ;440  ;ParentControl=1000000008 }
      { 1000000010;TextBox;3520 ;3960 ;2200 ;440  ;Editable=No;
                                                   InPage=-1;
                                                   CaptionML=ENU=Issue Date;
                                                   SourceExpr=MagazineVolumeIssue."Issue Date" }
      { 1000000011;Label  ;880  ;3960 ;2530 ;440  ;ParentControl=1000000010 }
      { 1000000012;CheckBox;3520;5720 ;440  ;440  ;Name=tbxCombineInvDoc;
                                                   Editable=No;
                                                   InPage=-1;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Combine Invoice;
                                                   SourceExpr=CombineInvDoc }
      { 1000000013;Label  ;110  ;5720 ;3300 ;440  ;ParentControl=1000000012 }
      { 1000000014;TextBox;3520 ;5170 ;2200 ;440  ;Name=tbxAdsProduct;
                                                   InPage=-1;
                                                   CaptionML=ENU=Ads. Product;
                                                   SourceExpr=AdsProduct;
                                                   TableRelation="Ads. Product" }
      { 1000000015;Label  ;110  ;5170 ;3300 ;440  ;ParentControl=1000000014;
                                                   FontBold=Yes }
      { 1000000016;TextBox;3520 ;4510 ;2200 ;440  ;Editable=No;
                                                   InPage=-1;
                                                   CaptionML=ENU=Sales Invoice Nos.;
                                                   SourceExpr=SalesInvNos }
      { 1000000017;Label  ;110  ;4510 ;3300 ;440  ;ParentControl=1000000016 }
      { 1000000018;TextBox;3520 ;660  ;2750 ;440  ;InPage=-1;
                                                   CaptionML=ENU=Sell-to Customer No.;
                                                   SourceExpr=SelltoCust;
                                                   TableRelation=Customer }
      { 1000000019;Label  ;110  ;660  ;3300 ;440  ;ParentControl=1000000018;
                                                   FontBold=Yes }
      { 1000000020;TextBox;3520 ;1210 ;2750 ;440  ;InPage=-1;
                                                   CaptionML=ENU=Bill-to Customer No.;
                                                   SourceExpr=BilltoCust;
                                                   TableRelation=Customer }
      { 1000000021;Label  ;110  ;1210 ;3300 ;440  ;ParentControl=1000000020;
                                                   FontBold=Yes }
      { 1000000024;TextBox;10340;110  ;2200 ;440  ;InPage=-1;
                                                   CaptionML=ENU=Posting Date;
                                                   SourceExpr=PostingDate }
      { 1000000025;Label  ;6930 ;110  ;3300 ;440  ;ParentControl=1000000024 }
      { 1000000026;TextBox;10340;660  ;2200 ;440  ;InPage=-1;
                                                   CaptionML=ENU=Document Date;
                                                   SourceExpr=DocumentDate }
      { 1000000027;Label  ;6930 ;660  ;3300 ;440  ;ParentControl=1000000026 }
      { 1000000028;Label  ;110  ;6270 ;13750;1100 ;InPage=-1;
                                                   ForeColor=255;
                                                   MultiLine=Yes;
                                                   LeaderDots=No;
                                                   CaptionML=ENU=เงื่อนไขการสร้าง Invoice \ข้อมูล Ads. Booking No., Sell-to Customer No., Bill-to Customer No., Ads. Product จะต้องตรงกัน }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AdsItemSetup@1000000024 : Record 50026;
      UserSetup@1000000025 : Record 91;
      Cust@1000000001 : Record 18;
      SalesHeader@1000000003 : Record 36;
      SalesLine@1000000011 : Record 37;
      AdsBookingLine@1000000022 : Record 50038;
      Magazine@1000000016 : Record 50011;
      MagazineVolumeIssue@1000000018 : Record 50012;
      TempToLineDim@1000000010 : TEMPORARY Record 357;
      DimMgt@1000000009 : Codeunit 408;
      NoSeriesMgt@1000000023 : Codeunit 396;
      NextLineNo@1000000008 : Integer;
      NoOfSalesInv@1000000007 : Integer;
      NoOfSalesInvErrors@1000000006 : Integer;
      HideDialog@1000000005 : Boolean;
      Text000@1000000021 : TextConst 'ENU=%1 must be specify.';
      Text001@1000000014 : TextConst 'ENU=There is nothing to create.;THA=ไม่มีสิ่งใดที่จะรวม';
      Text002@1000000012 : TextConst 'ENU=Not all the invoices were posted. A total of %1 invoices were not posted.;THA=มีบางใบส่งของที่ยังไม่ได้ลงรายการบัญชี  ดังนั้น จึงไม่ได้ลงรายการบัญชีผลรวมของใบส่งของ %1';
      AdsBookingNo@1000000002 : Code[20];
      AdsItemNo@1000000015 : Code[20];
      SelltoCust@1000000017 : Code[20];
      BilltoCust@1000000019 : Code[20];
      SalesInvNos@1000000004 : Code[10];
      AdsProduct@1000000000 : Code[20];
      CombineInvDoc@1000000020 : Boolean;
      Text003@1000000013 : TextConst 'ENU=The sales invoice for ads. booking are now completed, and the number of invoice(s) created is %1.;THA=ขณะนี้ ได้รวมการจัดส่งแล้ว, และจำนวนของใบส่งของที่สร้างคือ %1';
      Text004@1000000026 : TextConst 'ENU=You do not have permission to create ads. sales invoice.';
      ScheduleInvDate@1000000027 : Date;
      PostingDate@1000000028 : Date;
      DocumentDate@1000000029 : Date;

    PROCEDURE InitRequest@1000000000(_AdsBookingNo@1000000005 : Code[20];_AdsItemNo@1000000000 : Code[20];_SelltoCust@1000000001 : Code[20];_BilltoCust@1000000004 : Code[20];_AdsProd@1000000002 : Code[20];CombineInv@1000000003 : Boolean);
    BEGIN
      AdsBookingNo := _AdsBookingNo;
      AdsItemNo := _AdsItemNo;
      SelltoCust := _SelltoCust;
      BilltoCust := _BilltoCust;
      AdsProduct := _AdsProd;
      CombineInvDoc := CombineInv;
      //RequestOptionsForm.tbxAdsProduct.EDITABLE := FALSE;
      //RequestOptionsForm.tbxCombineInvDoc.EDITABLE := TRUE;
    END;

    LOCAL PROCEDURE FinalizeSalesHeader@2();
    BEGIN
      WITH SalesHeader DO BEGIN
        SalesHeader.FIND;
        DimMgt.TransferTempToDimToDocDim(TempToLineDim);
        //COMMIT;
      END;
    END;

    LOCAL PROCEDURE InsertSalesHeader@1(xAdsBookingLine@1000000000 : Record 50038);
    VAR
      Magazine@1000000001 : Record 50011;
      Volume@1000000002 : Record 50008;
      IssueNo@1000000003 : Record 50009;
    BEGIN
      WITH SalesHeader DO BEGIN
        INIT;
        "Document Type" := "Document Type"::Invoice;
        "No." := NoSeriesMgt.GetNextNo(SalesInvNos,WORKDATE,TRUE);
        INSERT(TRUE);
        SetHideValidationDialog(TRUE); //do not warning message.
        VALIDATE("Sell-to Customer No.",xAdsBookingLine."Sell-to Customer No.");
        VALIDATE("Bill-to Customer No.",xAdsBookingLine."Bill-to Customer No.");
        VALIDATE("Posting Date",PostingDate);
        VALIDATE("Document Date",DocumentDate);
        Magazine.GET(xAdsBookingLine."Magazine Code");
        VALIDATE("Shortcut Dimension 1 Code",Magazine."Dimension 1 Code");
        VALIDATE("Zone Area","Ads. Booking Header"."Zone Area");
        VALIDATE("Salesperson Code","Ads. Booking Header"."Salesperson Code");
        VALIDATE("Ads. Sales Type","Ads. Booking Header"."Ads. Sales Type");
        VALIDATE("Posting No. Series",AdsItemSetup."Posted Invoice Nos.");
        MODIFY;
        //COMMIT;
        NoOfSalesInv := NoOfSalesInv + 1;
      END;
    END;

    PROCEDURE InsertSalesLine@1000000006(xAdsBookingLine@1000000000 : Record 50038;GLAcc@1000000001 : Code[20];UnitPrice@1000000005 : Decimal);
    VAR
      Magazine@1000000004 : Record 50011;
      Volume@1000000003 : Record 50008;
      IssueNo@1000000002 : Record 50009;
      AdsPosition@1000000006 : Record 50029;
      AdsType@1000000007 : Record 50032;
      textDesc@1000000008 : Text[250];
    BEGIN
      WITH SalesLine DO BEGIN
        SETRANGE("Document Type",SalesHeader."Document Type");
        SETRANGE("Document No.",SalesHeader."No.");
        INIT;
        "Document Type" := SalesHeader."Document Type";
        "Document No." := SalesHeader."No.";

        NextLineNo += 10000;
        "Line No." := NextLineNo;
        AdsType.GET(xAdsBookingLine."Ads. Type");
        AdsType.TESTFIELD("Gen. Bus. Posting Group");
        Magazine.GET(xAdsBookingLine."Magazine Code");
        Magazine.TESTFIELD("Default Gen. Prod. Posting");

        VALIDATE(Type,SalesLine.Type::"G/L Account");
        VALIDATE("No.",GLAcc);
        textDesc :=
          Description + '(' +
          xAdsBookingLine."Magazine Code" + '-' +
          xAdsBookingLine."Volume No." + '-' +
          xAdsBookingLine."Issue No." + ')';
        Description := COPYSTR(textDesc,1,50);
        "Description 2" := COPYSTR(textDesc,51,50);
        VALIDATE("Gen. Bus. Posting Group",AdsType."Gen. Bus. Posting Group");
        VALIDATE("Gen. Prod. Posting Group",Magazine."Default Gen. Prod. Posting");
        VALIDATE("VAT Prod. Posting Group",xAdsBookingLine."VAT Prod. Posting Group");
        VALIDATE(Quantity,1);
        VALIDATE("Unit Price",UnitPrice);
        INSERT(TRUE);

        VALIDATE("Shortcut Dimension 1 Code",Magazine."Dimension 1 Code");

        Volume.GET(xAdsBookingLine."Volume No.");
        DimMgt.SaveDocDim(
          DATABASE::"Sales Line",
          "Document Type"::Invoice,
          "Document No.","Line No.",
          3,Volume."Dimension 3 Code");

        IssueNo.GET(xAdsBookingLine."Issue No.");
        DimMgt.SaveDocDim(
          DATABASE::"Sales Line",
          "Document Type"::Invoice,
          "Document No.","Line No.",
          4,IssueNo."Dimension 4 Code");

        AdsPosition.GET(xAdsBookingLine."Ads. Position");
        DimMgt.SaveDocDim(
          DATABASE::"Sales Line",
          "Document Type"::Invoice,
          "Document No.","Line No.",
          5,AdsPosition."Shortcut Dimension 5 Code");

        "Ads. Sales Type" := "Ads. Booking Header"."Ads. Sales Type";
        "Zone Area" := "Ads. Booking Header"."Zone Area";
        "Ads. Booking No." := xAdsBookingLine."Booking No.";
        "Ads. Booking Line No." := xAdsBookingLine."Line No.";
        MODIFY;
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   14.05.2007   KKE   -New batchjob to create ads invoice - Ads. Sales Module
                               -Billing Note need to separate invoice if user not tick mark on "Combine invoice" by
                                "Bill-to Customer No.","Salesperson","Ads. Sales Type","Zone Area"
                               -"Scheduled Invoice Date" use for filter data only.
      002   19.10.2010   GKU   -Add "Status Date"
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50028 Copy Sales Tax Invoice
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=[ 4:32:04 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    Permissions=TableData 113=rm,
                TableData 115=rm;
    CaptionML=[ENU=Copy Sales Document;
               THA=คัดลอกเอกสารการขาย];
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  SalesSetup.GET;
                  IF SalesTaxInvHeader."No." <> '' THEN BEGIN
                    CopySalesTaxInvoice(SalesTaxInvHeader."No.");
                  END ELSE BEGIN
                    CopyDocMgt.SetProperties(
                      IncludeHeader,RecalculateLines,FALSE,FALSE,FALSE,SalesSetup."Exact Cost Reversing Mandatory",FALSE);
                    CopyDocMgt.CopySalesDoc(DocType,DocNo,SalesHeader);
                    WITH SalesHeader DO BEGIN
                      IF ReplacePostDate OR ReplaceDocDate THEN BEGIN
                        IF ReplacePostDate THEN
                          VALIDATE("Posting Date",PostingDate);
                        IF ReplaceDocDate THEN
                          VALIDATE("Document Date",PostingDate);
                        MODIFY;
                      END;
                      GLSetup.GET;
                      IF ("Document Type" IN ["Document Type"::"Credit Memo","Document Type"::"Return Order"]) AND
                         GLSetup.GSTEnabled(FromSalesHeader."Document Date")
                      THEN BEGIN
                        CASE DocType OF
                          DocType::"Posted Invoice":
                            BEGIN
                              "Adjustment Applies-to" := FromSalesInvHeader."No.";
                              "BAS Adjustment" := BASManagement.CheckBASPeriod("Document Date",FromSalesInvHeader."Document Date");
                            END;
                          DocType::"Posted Credit Memo":
                            BEGIN
                              "Adjustment Applies-to" := FromSalesCrMemoHeader."No.";
                              "BAS Adjustment" := BASManagement.CheckBASPeriod("Document Date",FromSalesCrMemoHeader."Document Date");
                            END;
                        END;
                        MODIFY;
                      END;
                    END;
                  END;
                END;

  }
  DATAITEMS
  {
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=8910;
      Height=2970;
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   IF DocNo <> '' THEN BEGIN
                     CASE DocType OF
                       DocType::"Posted Invoice":
                         IF FromSalesInvHeader.GET(DocNo) THEN
                           FromSalesHeader.TRANSFERFIELDS(FromSalesInvHeader);
                       DocType::"Posted Credit Memo":
                         IF FromSalesCrMemoHeader.GET(DocNo) THEN
                           FromSalesHeader.TRANSFERFIELDS(FromSalesCrMemoHeader);
                     END;
                     IF FromSalesHeader."No." = '' THEN
                       DocNo := '';
                   END;
                   ValidateDocNo;
                 END;

    }
    CONTROLS
    {
      { 3   ;TextBox      ;3410 ;0    ;2750 ;440  ;CaptionML=[ENU=Document Type;
                                                              THA=ชนิดเอกสาร];
                                                   OptionCaptionML=ENU=Posted Invoice,Posted Credit Memo;
                                                   SourceExpr=DocType;
                                                   OnValidate=BEGIN
                                                                DocNo := '';
                                                                ValidateDocNo;
                                                              END;
                                                               }
      { 23  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=3 }
      { 8   ;TextBox      ;3410 ;550  ;2750 ;440  ;CaptionML=[ENU=Document No.;
                                                              THA=หมายเลขเอกสาร];
                                                   SourceExpr=DocNo;
                                                   OnValidate=BEGIN
                                                                ValidateDocNo;
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupDocNo;
                                                            END;
                                                             }
      { 9   ;Label        ;0    ;550  ;3300 ;440  ;ParentControl=8 }
      { 1   ;CheckBox     ;3410 ;2310 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Include Header;
                                                              THA=รวมหัวข้อ];
                                                   SourceExpr=IncludeHeader;
                                                   OnValidate=BEGIN
                                                                ValidateIncludeHeader;
                                                              END;
                                                               }
      { 2   ;Label        ;0    ;2310 ;3300 ;440  ;ParentControl=1 }
      { 5   ;TextBox      ;3410 ;1100 ;2750 ;440  ;Editable=No;
                                                   HorzAlign=Left;
                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              THA=ขายให้ลูกค้าหมายเลข];
                                                   SourceExpr=FromSalesHeader."Sell-to Customer No." }
      { 6   ;Label        ;0    ;1100 ;3300 ;440  ;ParentControl=5 }
      { 7   ;TextBox      ;3410 ;1650 ;5500 ;440  ;Editable=No;
                                                   CaptionML=[ENU=Sell-to Customer Name;
                                                              THA=ขายให้ลูกค้าชื่อ];
                                                   SourceExpr=FromSalesHeader."Sell-to Customer Name" }
      { 10  ;Label        ;0    ;1650 ;3300 ;440  ;ParentControl=7 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SalesSetup@1000000002 : Record 311;
      SalesHeader@1007 : Record 36;
      FromSalesHeader@1010 : Record 36;
      FromSalesShptHeader@1012 : Record 110;
      FromSalesInvHeader@1014 : Record 112;
      FromReturnRcptHeader@1016 : Record 6660;
      FromSalesCrMemoHeader@1018 : Record 114;
      GLSetup@1500001 : Record 98;
      PostCodeCheck@1500000 : Codeunit 28000;
      CopyDocMgt@1008 : Codeunit 6620;
      BASManagement@1500002 : Codeunit 11601;
      DocType@1026 : 'Posted Invoice,Posted Credit Memo';
      DocNo@1027 : Code[20];
      IncludeHeader@1028 : Boolean;
      RecalculateLines@1029 : Boolean;
      ReplacePostDate@1500005 : Boolean;
      ReplaceDocDate@1500004 : Boolean;
      PostingDate@1500003 : Date;
      SalesTaxInvHeader@1000000000 : Record 50054;
      AdsSalesSetup@1000000001 : Record 50026;

    PROCEDURE SetSalesTaxInvHeader@1000000000(VAR NewSalesTaxInvHeader@1000 : Record 50054);
    BEGIN
      SalesTaxInvHeader := NewSalesTaxInvHeader;
      SalesTaxInvHeader.TESTFIELD("Issued Tax Invoice/Receipt",FALSE);
      SalesTaxInvHeader.TESTFIELD("Cancel Tax Invoice",FALSE);
    END;

    LOCAL PROCEDURE ValidateDocNo@10();
    BEGIN
      IF DocNo = '' THEN
        FromSalesHeader.INIT
      ELSE
        IF FromSalesHeader."No." = '' THEN BEGIN
          FromSalesHeader.INIT;
          CASE DocType OF
            DocType::"Posted Invoice":
              BEGIN
                FromSalesInvHeader.GET(DocNo);
                FromSalesHeader.TRANSFERFIELDS(FromSalesInvHeader);
                PostCodeCheck.CopyAllAddressID(
                  DATABASE::"Sales Invoice Header",FromSalesInvHeader.GETPOSITION,
                  DATABASE::"Sales Header",FromSalesHeader.GETPOSITION);
              END;
            DocType::"Posted Credit Memo":
              BEGIN
                FromSalesCrMemoHeader.GET(DocNo);
                FromSalesHeader.TRANSFERFIELDS(FromSalesCrMemoHeader);
                PostCodeCheck.CopyAllAddressID(
                  DATABASE::"Sales Cr.Memo Header",FromSalesCrMemoHeader.GETPOSITION,
                  DATABASE::"Sales Header",FromSalesHeader.GETPOSITION);
              END;
          END;
        END;
      FromSalesHeader."No." := '';

      IncludeHeader :=
        (DocType = DocType::"Posted Invoice") AND (SalesTaxInvHeader."Sell-to Customer No." = '');
      ValidateIncludeHeader;
    END;

    LOCAL PROCEDURE LookupDocNo@3();
    BEGIN
      AdsSalesSetup.GET;
      CASE DocType OF
        DocType::"Posted Invoice":
          BEGIN
            FromSalesInvHeader."No." := DocNo;
            IF SalesTaxInvHeader."Sell-to Customer No." <> '' THEN
              IF FromSalesInvHeader.SETCURRENTKEY("Sell-to Customer No.") THEN BEGIN
                FromSalesInvHeader.SETRANGE("Sell-to Customer No.",SalesTaxInvHeader."Sell-to Customer No.");
                IF FromSalesInvHeader.FIND('=><') THEN;
              END;
            //IF AdsSalesSetup."Posted Invoice Nos." <> '' THEN
            //  FromSalesInvHeader.SETRANGE("No. Series",AdsSalesSetup."Posted Invoice Nos.");
            IF FORM.RUNMODAL(0,FromSalesInvHeader) = ACTION::LookupOK THEN
              DocNo := FromSalesInvHeader."No.";
          END;
        DocType::"Posted Credit Memo":
          BEGIN
            FromSalesCrMemoHeader."No." := DocNo;
            IF SalesTaxInvHeader."Sell-to Customer No." <> '' THEN
              IF FromSalesCrMemoHeader.SETCURRENTKEY("Sell-to Customer No.") THEN BEGIN
                FromSalesCrMemoHeader.SETRANGE("Sell-to Customer No.",SalesTaxInvHeader."Sell-to Customer No.");
                IF FromSalesCrMemoHeader.FIND('=><') THEN;
              END;
            //IF AdsSalesSetup."Posted Invoice Nos." <> '' THEN
            //  FromSalesInvHeader.SETRANGE("No. Series",AdsSalesSetup."Posted Invoice Nos.");
            IF FORM.RUNMODAL(0,FromSalesCrMemoHeader) = ACTION::LookupOK THEN
              DocNo := FromSalesCrMemoHeader."No.";
          END;
      END;
      ValidateDocNo;
    END;

    LOCAL PROCEDURE ValidateIncludeHeader@4();
    BEGIN
      RecalculateLines := NOT IncludeHeader;
    END;

    PROCEDURE CopySalesTaxInvoice@1000000002(SalesTaxInvNo@1000000010 : Code[20]);
    VAR
      SalesTaxInvLine@1000000011 : Record 50055;
      SalesHeader@1000000005 : Record 36;
      SalesLine@1000000004 : Record 37;
      SalesShipHeader@1000000006 : Record 110;
      SalesShipLine@1000000003 : Record 111;
      SalesInvHeader@1000000007 : Record 112;
      SalesInvLine@1000000002 : Record 113;
      SalesCrMemoHeader@1000000008 : Record 114;
      SalesCrMemoLine@1000000001 : Record 115;
      ReturnReceiptHeader@1000000009 : Record 6660;
      ReturnReceiptLine@1000000000 : Record 6661;
      FromPostedDocDim@1000000012 : Record 359;
      ToPostedDocDim@1000000014 : Record 359;
      DimMgt@1000000013 : Codeunit 408;
      LineNo@1000000015 : Integer;
      SalesInvLine2@1000000016 : Record 113;
      SalesCrMemoLine2@1000000017 : Record 115;
    BEGIN
      LineNo := 0;
      SalesTaxInvLine.LOCKTABLE;
      SalesTaxInvLine.RESET;
      SalesTaxInvLine.SETRANGE("Document No.",SalesTaxInvNo);
      IF SalesTaxInvLine.FIND('+') THEN
        LineNo := SalesTaxInvLine."Line No.";
      CASE DocType OF
        DocType::"Posted Invoice":
          BEGIN
            IF SalesInvHeader.GET(DocNo) THEN BEGIN
              IF IncludeHeader THEN BEGIN
                SalesTaxInvHeader.TRANSFERFIELDS(SalesInvHeader);
                SalesTaxInvHeader."No." := SalesTaxInvNo;
                SalesTaxInvHeader.MODIFY;

                CopyPostedDocDimToPostedDocDim(
                  DATABASE::"Sales Invoice Header",DocNo,0,
                  DATABASE::"Sales Tax Invoice/Rec. Header",SalesTaxInvNo,0);
              END;

              SalesInvLine.RESET;
              SalesInvLine.SETRANGE("Document No.",DocNo);
              SalesInvLine.SETRANGE("Sales Tax Invoice/Receipt No.",'');
              IF SalesInvLine.FIND('-') THEN BEGIN
                REPEAT
                  SalesTaxInvLine.TRANSFERFIELDS(SalesInvLine);
                  SalesTaxInvLine."Document No." := SalesTaxInvNo;
                  LineNo += 10000;
                  SalesTaxInvLine."Line No." := LineNo;
                  SalesTaxInvLine."Sell-to Customer No." := SalesInvHeader."Sell-to Customer No.";
                  SalesTaxInvLine."Posted Document Type" := SalesTaxInvLine."Posted Document Type"::Invoice;
                  SalesTaxInvLine."Posted Document No." := SalesInvHeader."No.";
                  SalesTaxInvLine."Posted Document Line No." := SalesInvLine."Line No.";
                  SalesTaxInvLine.INSERT;

                  CopyPostedDocDimToPostedDocDim(
                    DATABASE::"Sales Invoice Line",DocNo,SalesInvLine."Line No.",
                    DATABASE::"Sales Tax Invoice/Rec. Line",SalesTaxInvNo,LineNo);

                  SalesInvLine2.GET(SalesInvLine."Document No.",SalesInvLine."Line No.");
                  SalesInvLine2."Sales Tax Invoice/Receipt No." := SalesTaxInvLine."Document No.";
                  SalesInvLine2."Sales Tax Invoice/Receipt Line" := SalesTaxInvLine."Line No.";
                  SalesInvLine2.MODIFY;
                UNTIL SalesInvLine.NEXT=0;
              END;
            END;
          END;
        DocType::"Posted Credit Memo":
          BEGIN
            IF SalesCrMemoHeader.GET(DocNo) THEN BEGIN
              IF IncludeHeader THEN BEGIN
                SalesTaxInvHeader.TRANSFERFIELDS(SalesCrMemoHeader);
                SalesTaxInvHeader."No." := SalesTaxInvNo;
                SalesTaxInvHeader.MODIFY;

                CopyPostedDocDimToPostedDocDim(
                  DATABASE::"Sales Cr.Memo Header",DocNo,0,
                  DATABASE::"Sales Tax Invoice/Rec. Header",SalesTaxInvNo,0);
              END;

              SalesCrMemoLine.RESET;
              SalesCrMemoLine.SETRANGE("Document No.",DocNo);
              SalesCrMemoLine.SETRANGE("Sales Tax Invoice/Receipt No.",'');
              IF SalesCrMemoLine.FIND('-') THEN BEGIN
                REPEAT
                  SalesTaxInvLine.TRANSFERFIELDS(SalesCrMemoLine);
                  SalesTaxInvLine."Document No." := SalesTaxInvNo;
                  IF LineNo <> 0 THEN BEGIN
                    LineNo += 10000;
                    SalesTaxInvLine."Line No." := LineNo;
                  END;
                  SalesTaxInvLine."Sell-to Customer No." := SalesCrMemoHeader."Sell-to Customer No.";
                  SalesTaxInvLine."Posted Document Type" := SalesTaxInvLine."Posted Document Type"::"Credit Memo";
                  SalesTaxInvLine."Posted Document No." := SalesCrMemoHeader."No.";
                  SalesTaxInvLine."Posted Document Line No." := SalesCrMemoLine."Line No.";
                  SalesTaxInvLine.Quantity := -SalesTaxInvLine.Quantity;
                  SalesTaxInvLine."Line Amount" := -SalesTaxInvLine."Line Amount";
                  SalesTaxInvLine.Amount := -SalesTaxInvLine.Amount;
                  SalesTaxInvLine."Amount Including VAT" := -SalesTaxInvLine."Amount Including VAT";
                  SalesTaxInvLine.INSERT;

                  CopyPostedDocDimToPostedDocDim(
                    DATABASE::"Sales Cr.Memo Line",DocNo,SalesCrMemoLine."Line No.",
                    DATABASE::"Sales Tax Invoice/Rec. Line",SalesTaxInvNo,LineNo);

                  SalesCrMemoLine2.GET(SalesCrMemoLine."Document No.",SalesCrMemoLine."Line No.");
                  SalesCrMemoLine2."Sales Tax Invoice/Receipt No." := SalesTaxInvLine."Document No.";
                  SalesCrMemoLine2."Sales Tax Invoice/Receipt Line" := SalesTaxInvLine."Line No.";
                  SalesCrMemoLine2.MODIFY;
                UNTIL SalesCrMemoLine.NEXT=0;

              END;
            END;
          END;
        END;
    END;

    PROCEDURE CopyDocDimToPostedDocDim@1000000001(FromTableNo@1000 : Integer;FromDocType@1000000006 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';FromDocNo@1000000001 : Code[20];FromLineNo@1000000005 : Integer;ToTableNo@1001 : Integer;ToDocNo@1000000002 : Code[20];ToLineNo@1000000004 : Integer);
    VAR
      FromDocDim@1000000000 : Record 357;
      ToPostedDocDim@1000000003 : Record 359;
    BEGIN
      FromDocDim.RESET;
      FromDocDim.SETRANGE("Table ID",FromTableNo);
      FromDocDim.SETRANGE("Document Type",FromDocType);
      FromDocDim.SETRANGE("Document No.",FromDocNo);
      FromDocDim.SETRANGE("Line No.",FromLineNo);
      IF FromDocDim.FIND('-') THEN
        REPEAT
          ToPostedDocDim.TRANSFERFIELDS(FromDocDim);
          ToPostedDocDim."Table ID" := ToTableNo;
          ToPostedDocDim."Document No." := ToDocNo;
          ToPostedDocDim."Line No." := ToLineNo;
          ToPostedDocDim.INSERT;
        UNTIL FromDocDim.NEXT = 0;
    END;

    PROCEDURE CopyPostedDocDimToPostedDocDim@1000000003(FromTableNo@1000 : Integer;FromDocNo@1000000001 : Code[20];FromLineNo@1000000005 : Integer;ToTableNo@1001 : Integer;ToDocNo@1000000002 : Code[20];ToLineNo@1000000004 : Integer);
    VAR
      FromPostedDocDim@1000000000 : Record 359;
      ToPostedDocDim@1000000003 : Record 359;
    BEGIN
      FromPostedDocDim.RESET;
      FromPostedDocDim.SETRANGE("Table ID",FromTableNo);
      FromPostedDocDim.SETRANGE("Document No.",FromDocNo);
      FromPostedDocDim.SETRANGE("Line No.",FromLineNo);
      IF FromPostedDocDim.FIND('-') THEN
        REPEAT
          ToPostedDocDim := FromPostedDocDim;
          ToPostedDocDim."Table ID" := ToTableNo;
          ToPostedDocDim."Document No." := ToDocNo;
          ToPostedDocDim."Line No." := ToLineNo;
          ToPostedDocDim.INSERT;
        UNTIL FromPostedDocDim.NEXT = 0;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   15.05.2007   KKE   Customized report to copy document for "Sales Tax Invoice/Receipt" - Ads. Sales Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50030 Copy Agent Customer
{
  OBJECT-PROPERTIES
  {
    Date=08/07/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF FromAgentCustNo <> '' THEN
                    WITH AgentCustHdr DO BEGIN
                      AgentCustNo := "No.";
                      IF IncludeHeader THEN BEGIN
                        "Document Date" := FromAgentCustHdr."Document Date";
                        "Magazine Item No." := FromAgentCustHdr."Magazine Item No.";
                        "Magazine Code" := FromAgentCustHdr."Magazine Code";
                        "Volume No." := FromAgentCustHdr."Volume No.";
                        "Issue No." := FromAgentCustHdr."Issue No.";
                        "Issue Date" := FromAgentCustHdr."Issue Date";
                        "Salesperson Code" := FromAgentCustHdr."Salesperson Code";
                        "Location Code" := FromAgentCustHdr."Location Code";
                        "Unit of Measure Code" := FromAgentCustHdr."Unit of Measure Code";
                        MODIFY;
                      END;

                      LineNo := 0;
                      AgentCustLine.RESET;
                      AgentCustLine.SETRANGE("Agent Customer No.",AgentCustNo);
                      IF AgentCustLine.FIND('+') THEN
                        LineNo := AgentCustLine."Line No.";

                      FromAgentCustLine.RESET;
                      FromAgentCustLine.SETRANGE("Agent Customer No.",FromAgentCustNo);
                      IF FromAgentCustLine.FIND('-') THEN
                        REPEAT
                          LineNo += 10000;
                          AgentCustLine.INIT;
                          AgentCustLine.TRANSFERFIELDS(FromAgentCustLine);
                          AgentCustLine."Agent Customer No." := AgentCustNo;
                          AgentCustLine."Line No." := LineNo;
                          AgentCustLine."Delivered Flag" := FALSE;
                          AgentCustLine."Delivered Date" := 0D;
                          AgentCustLine."Delivered Document No." := '';
                          AgentCustLine."Delivered Document Line No." := 0;
                          AgentCustLine.INSERT;
                        UNTIL FromAgentCustLine.NEXT=0;
                    END;
                END;

  }
  DATAITEMS
  {
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1000000002;TextBox;3520 ;110  ;2750 ;440  ;CaptionML=ENU=Agent Customer No.;
                                                   SourceExpr=FromAgentCustNo;
                                                   TableRelation="Agent Customer Header";
                                                   OnValidate=BEGIN
                                                                IF AgentCustHdr."No." = FromAgentCustNo THEN
                                                                  ERROR(Text001,FromAgentCustNo);
                                                              END;

                                                   OnAfterValidate=BEGIN
                                                                     IF NOT FromAgentCustHdr.GET(FromAgentCustNo) THEN
                                                                       CLEAR(FromAgentCustHdr);
                                                                     IF NOT Item.GET(FromAgentCustHdr."Magazine Item No.") THEN
                                                                       CLEAR(Item);
                                                                   END;
                                                                    }
      { 1000000003;Label  ;110  ;110  ;3300 ;440  ;ParentControl=1000000002 }
      { 1000000000;TextBox;3520 ;660  ;2750 ;440  ;Editable=No;
                                                   CaptionML=ENU=Magazine Item No.;
                                                   SourceExpr=Item."No." }
      { 1000000001;Label  ;110  ;660  ;3300 ;440  ;ParentControl=1000000000 }
      { 1000000004;CheckBox;3520;1210 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Include Header;
                                                              THA=รวมหัวข้อ];
                                                   SourceExpr=IncludeHeader }
      { 1000000005;Label  ;110  ;1210 ;3300 ;440  ;ParentControl=1000000004 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AgentCustHdr@1000000003 : Record 50041;
      FromAgentCustHdr@1000000002 : Record 50041;
      NewAgentCustHdr@1000000009 : Record 50041;
      AgentCustLine@1000000006 : Record 50042;
      FromAgentCustLine@1000000007 : Record 50042;
      Item@1000000001 : Record 27;
      AgentCustNo@1000000005 : Code[20];
      FromAgentCustNo@1000000000 : Code[20];
      IncludeHeader@1000000004 : Boolean;
      LineNo@1000000008 : Integer;
      Text001@1000000010 : TextConst 'ENU=From Agent Customer No. must not be %1.';

    PROCEDURE SetAgentCustHdr@2(VAR NewAgentCustHdr@1000 : Record 50041);
    BEGIN
      AgentCustHdr := NewAgentCustHdr;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.03.2007   KKE   -Circulation Module - Copy Document Agent Customer
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50031 Create Sales Order Circulation
{
  OBJECT-PROPERTIES
  {
    Date=08/16/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF MagazineItemNo = '' THEN
                    ERROR(Text000,'Magazine Item No.');
                  IF PostingDate = 0D THEN
                    ERROR(Text000,'Posting Date');
                  IF DocumentDate = 0D THEN
                    ERROR(Text000,'document Date');

                  MagazineSalesSetup.GET;
                  MagazineSalesSetup.TESTFIELD("Posted Invoice Nos.");
                END;

    OnPostReport=BEGIN
                   IF SalesHeader."No." <> '' THEN BEGIN // Not the first time
                     FinalizeSalesHeader;
                     IF (NoOfSalesInvErrors = 0) AND NOT HideDialog THEN BEGIN
                       MESSAGE(
                         Text003,
                         NoOfSalesInv);
                     END ELSE
                       IF NOT HideDialog THEN
                         MESSAGE(
                           Text002,
                           NoOfSalesInvErrors)
                   END ELSE
                     IF NOT HideDialog THEN
                       MESSAGE(Text001);
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50041;
        DataItemTableView=SORTING(No.);
        OnPreDataItem=BEGIN
                        IF DocNo <> '' THEN
                          SETRANGE("No.",DocNo);
                        IF SalespersonCode <> '' THEN
                          SETRANGE("Salesperson Code",SalespersonCode);
                        SETRANGE("Magazine Code",Item."Magazine Code");
                        SETRANGE("Volume No.",Item."Volume No.");
                        SETRANGE("Issue No.",Item."Issue No.");
                      END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50042;
        DataItemTableView=SORTING(Sell-to Customer No.,Bill-to Customer No.)
                          WHERE(Delivered Flag=CONST(No));
        OnPreDataItem=BEGIN
                        IF CustNo <> '' THEN
                          SETRANGE("Sell-to Customer No.",CustNo);
                      END;

        GroupTotalFields=Bill-to Customer No.;
        DataItemLink=Agent Customer No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=12000;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FALSE;
                           IF "Sell-to Customer No." <> Cust."No." THEN
                             Cust.GET("Sell-to Customer No.");
                           IF NOT (Cust.Blocked IN [Cust.Blocked::All,Cust.Blocked::Invoice]) THEN BEGIN
                             TESTFIELD("Sell-to Customer No.");
                             IF "Sell-to Customer No." <> SalesHeader."Sell-to Customer No." THEN BEGIN
                               IF SalesHeader."No." <> '' THEN
                                 FinalizeSalesHeader;
                               InsertSalesHeader("Agent Customer Header","Agent Customer Line");
                               InsertSalesLine("Agent Customer Header","Agent Customer Line");
                             END ELSE
                               InsertSalesLine("Agent Customer Header","Agent Customer Line");
                           END ELSE
                             NoOfSalesInvErrors := NoOfSalesInvErrors + 1;
                         END;

          }
          CONTROLS
          {
            { 1000000000;Label  ;300  ;0    ;10200;846  ;FontSize=15;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=6710;
    }
    CONTROLS
    {
      { 1000000000;TextBox;3520 ;1870 ;3080 ;440  ;CaptionML=ENU=Magazine Item No.;
                                                   SourceExpr=MagazineItemNo;
                                                   TableRelation=Item WHERE (Item Type=CONST(Magazine));
                                                   OnValidate=VAR
                                                                Magazine@1000000000 : Record 50011;
                                                              BEGIN
                                                                SalesOrderNos := '';
                                                                IF NOT Item.GET(MagazineItemNo) THEN BEGIN
                                                                  CLEAR(Item);
                                                                  EXIT;
                                                                END;
                                                                Magazine.GET(Item."Magazine Code");
                                                                Magazine.TESTFIELD("Circulation S/O Nos.");
                                                                SalesOrderNos := Magazine."Circulation S/O Nos.";
                                                              END;
                                                               }
      { 1000000001;Label  ;110  ;1870 ;3300 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;3520 ;110  ;3080 ;440  ;CaptionML=ENU=Document No.;
                                                   SourceExpr=DocNo;
                                                   TableRelation="Agent Customer Header" }
      { 1000000003;Label  ;110  ;110  ;3300 ;440  ;ParentControl=1000000002 }
      { 1000000004;TextBox;3520 ;2420 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Magazine Code;
                                                   SourceExpr=Item."Magazine Code" }
      { 1000000005;Label  ;880  ;2420 ;2530 ;440  ;ParentControl=1000000004 }
      { 1000000006;TextBox;3520 ;2970 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Volume No.;
                                                   SourceExpr=Item."Volume No." }
      { 1000000007;Label  ;880  ;2970 ;2530 ;440  ;ParentControl=1000000006 }
      { 1000000008;TextBox;3520 ;3520 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Issue No.;
                                                   SourceExpr=Item."Issue No." }
      { 1000000009;Label  ;880  ;3520 ;2530 ;440  ;ParentControl=1000000008 }
      { 1000000010;TextBox;3520 ;4070 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Issue Date;
                                                   SourceExpr=Item."Issue Date" }
      { 1000000011;Label  ;880  ;4070 ;2530 ;440  ;ParentControl=1000000010 }
      { 1000000014;TextBox;3520 ;5170 ;2200 ;440  ;CaptionML=ENU=Salesperson Code;
                                                   SourceExpr=SalespersonCode;
                                                   TableRelation=Salesperson/Purchaser }
      { 1000000015;Label  ;110  ;5170 ;3300 ;440  ;ParentControl=1000000014 }
      { 1000000012;TextBox;3520 ;660  ;2200 ;440  ;CaptionML=ENU=Customer No.;
                                                   SourceExpr=CustNo;
                                                   TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF NOT Cust.GET(CustNo) THEN
                                                                  CLEAR(Cust);
                                                                CustPostingGroup := Cust."Customer Posting Group";
                                                              END;
                                                               }
      { 1000000013;Label  ;110  ;660  ;3300 ;440  ;ParentControl=1000000012 }
      { 1000000016;TextBox;3520 ;1210 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Customer Posting Group;
                                                   SourceExpr=CustPostingGroup;
                                                   TableRelation="Customer Posting Group" }
      { 1000000017;Label  ;110  ;1210 ;3300 ;440  ;ParentControl=1000000016 }
      { 1000000018;TextBox;3520 ;5720 ;2200 ;440  ;CaptionML=ENU=Posting Date;
                                                   SourceExpr=PostingDate }
      { 1000000019;Label  ;110  ;5720 ;3300 ;440  ;ParentControl=1000000018 }
      { 1000000020;TextBox;3520 ;6270 ;2200 ;440  ;CaptionML=ENU=Document Date;
                                                   SourceExpr=DocumentDate }
      { 1000000021;Label  ;110  ;6270 ;3300 ;440  ;ParentControl=1000000020 }
      { 1000000022;TextBox;3520 ;4620 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Sales Order Nos.;
                                                   SourceExpr=SalesOrderNos }
      { 1000000023;Label  ;880  ;4620 ;2530 ;440  ;ParentControl=1000000022 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      MagazineSalesSetup@1000000018 : Record 50007;
      Cust@1000000001 : Record 18;
      SalesHeader@1000000003 : Record 36;
      SalesLine@1000000011 : Record 37;
      Item@1000000016 : Record 27;
      TempToLineDim@1000000010 : TEMPORARY Record 357;
      DimMgt@1000000009 : Codeunit 408;
      NoSeriesMgt@1000000023 : Codeunit 396;
      NextLineNo@1000000008 : Integer;
      NoOfSalesInv@1000000007 : Integer;
      NoOfSalesInvErrors@1000000006 : Integer;
      HideDialog@1000000005 : Boolean;
      Text000@1000000021 : TextConst 'ENU=%1 must be specify.';
      Text001@1000000014 : TextConst 'ENU=There is nothing to create.;THA=ไม่มีสิ่งใดที่จะรวม';
      Text002@1000000012 : TextConst 'ENU=Not all the invoices were posted. A total of %1 invoices were not posted.;THA=มีบางใบส่งของที่ยังไม่ได้ลงรายการบัญชี  ดังนั้น จึงไม่ได้ลงรายการบัญชีผลรวมของใบส่งของ %1';
      Text003@1000000013 : TextConst 'ENU=The sales order for agent customer are now completed, and the number of order(s) created is %1.;THA=ขณะนี้ ได้รวมการจัดส่งแล้ว, และจำนวนของใบส่งของที่สร้างคือ %1';
      DocNo@1000000017 : Code[20];
      CustNo@1000000000 : Code[20];
      CustPostingGroup@1000000020 : Code[10];
      MagazineItemNo@1000000015 : Code[20];
      SalespersonCode@1000000025 : Code[20];
      SalesOrderNos@1000000019 : Code[10];
      PostingDate@1000000002 : Date;
      DocumentDate@1000000004 : Date;

    LOCAL PROCEDURE FinalizeSalesHeader@2();
    BEGIN
      WITH SalesHeader DO BEGIN
        SalesHeader.FIND;
        DimMgt.TransferTempToDimToDocDim(TempToLineDim);
      //  COMMIT;
      END;
    END;

    LOCAL PROCEDURE InsertSalesHeader@1(xAgentCustHeader@1000000000 : Record 50041;xAgentCustLine@1000000005 : Record 50042);
    VAR
      Magazine@1000000001 : Record 50011;
      Volume@1000000002 : Record 50008;
      IssueNo@1000000003 : Record 50009;
    BEGIN
      WITH SalesHeader DO BEGIN
        INIT;
        "Document Type" := "Document Type"::Order;
        "No." := NoSeriesMgt.GetNextNo(SalesOrderNos,WORKDATE,TRUE);
        INSERT(TRUE);
        VALIDATE("Sell-to Customer No.",xAgentCustLine."Sell-to Customer No.");
        IF (xAgentCustLine."Bill-to Customer No." <> xAgentCustLine."Sell-to Customer No.") AND
           (xAgentCustLine."Bill-to Customer No." <> '')
        THEN
          VALIDATE("Bill-to Customer No.","Agent Customer Line"."Bill-to Customer No.");
        VALIDATE("Posting Date",PostingDate);
        VALIDATE("Order Date",PostingDate);
        VALIDATE("Document Date",DocumentDate);
        VALIDATE("Location Code",xAgentCustHeader."Location Code");
        Magazine.GET(xAgentCustHeader."Magazine Code");
      //  Magazine.TESTFIELD("Payment Method for Delivery");
      //  VALIDATE("Payment Method Code",Magazine."Payment Method for Delivery");
        VALIDATE("Shortcut Dimension 1 Code",Magazine."Dimension 1 Code");
        VALIDATE("Posting No. Series",MagazineSalesSetup."Posted Invoice Nos.");
        MODIFY;
      //  COMMIT;
        NoOfSalesInv := NoOfSalesInv + 1;
      END;
    END;

    PROCEDURE InsertSalesLine@1000000006(xAgentCustHeader@1000000007 : Record 50041;xAgentCustLine@1000000000 : Record 50042);
    VAR
      AgentCustLine@1000000001 : Record 50042;
      Magazine@1000000004 : Record 50011;
      Volume@1000000003 : Record 50008;
      IssueNo@1000000002 : Record 50009;
    BEGIN
      IF xAgentCustLine."Line Amount" = 0 THEN
        EXIT;

      AgentCustLine.RESET;
      AgentCustLine.SETRANGE("Agent Customer No.",xAgentCustLine."Agent Customer No.");
      AgentCustLine.SETRANGE("Sell-to Customer No.",xAgentCustLine."Sell-to Customer No.");
      AgentCustLine.SETRANGE("Bill-to Customer No.",xAgentCustLine."Bill-to Customer No.");
      IF AgentCustLine.FIND('-') THEN
      REPEAT
      WITH SalesLine DO BEGIN
        INIT;
        "Document Type" := SalesHeader."Document Type";
        "Document No." := SalesHeader."No.";

        NextLineNo += 10000;
        "Line No." := NextLineNo;
        VALIDATE(Type,SalesLine.Type::Item);
        VALIDATE("No.",xAgentCustHeader."Magazine Item No.");
        VALIDATE(Quantity,AgentCustLine.Quantity);
        VALIDATE("Unit Price",AgentCustLine."Unit Price");
        VALIDATE("Line Discount %",AgentCustLine."Discount %");
        VALIDATE(SalesLine."Agent Customer No.",AgentCustLine."Agent Customer No.");
        INSERT(TRUE);

        Magazine.GET(xAgentCustHeader."Magazine Code");
        VALIDATE("Shortcut Dimension 1 Code",Magazine."Dimension 1 Code");
        Volume.GET(xAgentCustHeader."Volume No.");
        IssueNo.GET(xAgentCustHeader."Issue No.");
        DimMgt.SaveDocDim(
          DATABASE::"Sales Line",
          "Document Type"::Order,
          "Document No.","Line No.",
          3,Volume."Dimension 3 Code");
        DimMgt.SaveDocDim(
          DATABASE::"Sales Line",
          "Document Type"::Order,
          "Document No.","Line No.",
          4,IssueNo."Dimension 4 Code");
        MODIFY;

        AgentCustLine."Delivered Flag" := TRUE;
        AgentCustLine."Delivered Date" := TODAY;
        AgentCustLine."Delivered Document No." := "Document No.";
        AgentCustLine."Delivered Document Line No." := "Line No.";
        AgentCustLine.MODIFY;

      END;
      UNTIL AgentCustLine.NEXT=0;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   23.04.2007   KKE   New batchjob to create sales order circulation - Circulation Module
                               Separate "Sales Order" by "Sell-to Cust No." and "Bill-to Cust No.".
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50032 Archive Ads. Booking
{
  OBJECT-PROPERTIES
  {
    Date=08/08/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   IF NoOfArch <= 1 THEN
                     MESSAGE(Text001,NoOfArch,' has')
                   ELSE
                     MESSAGE(Text001,NoOfArch,'s have');
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50037;
        DataItemTableView=SORTING(No.);
        OnPreDataItem=BEGIN
                        NoOfArch := 0;
                        UserSetup.GET(USERID);
                      END;

        OnAfterGetRecord=BEGIN
                           AdsBookingLine.SETPERMISSIONFILTER;
                           AdsBookingLine.RESET;
                           AdsBookingLine.SETRANGE("Magazine Code",UserSetup."Magazine Filter");
                           AdsBookingLine.SETRANGE("Booking No.","No.");
                           AdsBookingLine.SETFILTER("Line Status",'<>%1&<>%2&<>%3',
                             AdsBookingLine."Line Status"::Closed,
                             AdsBookingLine."Line Status"::Cancelled,
                             AdsBookingLine."Line Status"::Invoiced);
                           IF AdsBookingLine.FIND('-') THEN
                             CurrReport.SKIP;

                           AdsBookingLine.SETRANGE("Line Status");
                           IF NOT AdsBookingLine.FIND('-') THEN
                             CurrReport.SKIP;

                           ArchAdsBookingHdr.INIT;
                           ArchAdsBookingHdr.TRANSFERFIELDS("Ads. Booking Header");
                           ArchAdsBookingHdr.INSERT;

                           REPEAT
                             ArchAdsBookingLine.INIT;
                             ArchAdsBookingLine.TRANSFERFIELDS(AdsBookingLine);
                             ArchAdsBookingLine.INSERT;
                           UNTIL AdsBookingLine.NEXT=0;

                           DELETE;
                           AdsBookingLine.DELETEALL;

                           NoOfArch += 1;
                         END;

        ReqFilterFields=No.,Booking Date,Salesperson Code,Sell-to Customer No.,Bill-to Customer No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AdsBookingLine@1000000000 : Record 50038;
      ArchAdsBookingHdr@1000000001 : Record 50039;
      ArchAdsBookingLine@1000000002 : Record 50040;
      UserSetup@1000000005 : Record 91;
      NoOfArch@1000000003 : Integer;
      Text001@1000000004 : TextConst 'ENU=%1 record%2 been archived.';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   09.05.2007   KKE   New batchjob to archived Ads. Booking - Ads. Sales Module
                               Ads. Booking will be archived when line status = closed,cancelled,invoiced only.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50033 Copy Content Index
{
  OBJECT-PROPERTIES
  {
    Date=11/06/07;
    Time=[ 1:09:27 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF FromContentIndexHdr."No." = '' THEN
                    ERROR(Text001,'Copy Content List From');
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50020;
        DataItemTableView=SORTING(Content List No.,Content List Line No.)
                          WHERE(Status=FILTER(<>Approved));
        OnPreDataItem=BEGIN
                        SETRANGE("Content List No.",FromContentIndexHdr."No.");
                        LineNo := 0;
                        ToContentIndexLine.SETRANGE("Content List No.",ToContentIndexHdr."No.");
                        IF ToContentIndexLine.FIND('+') THEN
                          LineNo := ToContentIndexLine."Content List Line No.";
                      END;

        OnAfterGetRecord=BEGIN
                           LineNo += 10000;
                           ToContentIndexLine.INIT;
                           ToContentIndexLine."Content List No." := ToContentIndexHdr."No.";
                           ToContentIndexLine."Content List Line No." := LineNo;
                           ToContentIndexLine."Content Code" := "Content Code";
                           ToContentIndexLine.Description := Description;
                           ToContentIndexLine."No. of Page" := "No. of Page";
                           ToContentIndexLine."Content Type" := "Content Type";
                           ToContentIndexLine."Content Sub Type" := "Content Sub Type";
                           ToContentIndexLine."Author Name" := "Author Name";
                           ToContentIndexLine."Description 2" := "Description 2";
                           ToContentIndexLine."Source of Information" := "Source of Information";
                           ToContentIndexLine."Content Receipt Date" := "Content Receipt Date";
                           ToContentIndexLine.Size := Size;
                           ToContentIndexLine.Position := Position;
                           ToContentIndexLine."Column Name" := "Column Name";
                           ToContentIndexLine."Own Customer" := "Own Customer";
                           ToContentIndexLine.Quantity := Quantity;
                           ToContentIndexLine."Unit Price" := "Unit Price";
                           ToContentIndexLine."Magazine Code" := ToContentIndexHdr."Magazine Code";
                           ToContentIndexLine.INSERT;

                           IF CopyPhotoExpense THEN BEGIN
                             FromPhotoExpense.RESET;
                             FromPhotoExpense.SETRANGE("Content Index No.","Content List No.");
                             FromPhotoExpense.SETRANGE("Content Index Line No.","Content List Line No.");
                             IF FromPhotoExpense.FIND('-') THEN
                               REPEAT
                                 ToPhotoExpense.INIT;
                                 ToPhotoExpense := FromPhotoExpense;
                                 ToPhotoExpense."Content Index No." := ToContentIndexLine."Content List No.";
                                 ToPhotoExpense."Content Index Line No." := ToContentIndexLine."Content List Line No.";
                                 ToPhotoExpense."Payment Status" := '';
                                 ToPhotoExpense.Remarks := '';
                                 ToPhotoExpense.INSERT;
                               UNTIL FromPhotoExpense.NEXT=0;
                           END;

                           IF CopyContentCost THEN BEGIN
                             FromContentCost.RESET;
                             FromContentCost.SETRANGE("Content Index No.","Content List No.");
                             FromContentCost.SETRANGE("Content Index Line No.","Content List Line No.");
                             IF FromContentCost.FIND('-') THEN
                               REPEAT
                                 ToContentCost.INIT;
                                 ToContentCost := FromContentCost;
                                 ToContentCost."Content Index No." := ToContentIndexLine."Content List No.";
                                 ToContentCost."Content Index Line No." := ToContentIndexLine."Content List Line No.";
                                 ToContentCost."Payment Status" := '';
                                 ToContentCost.Remarks := '';
                                 ToContentCost.INSERT;
                               UNTIL FromContentCost.NEXT=0;
                           END;

                           IF CopyPhotoExpense OR CopyContentCost THEN BEGIN
                             ToContentIndexLine.UpdateCost;
                             ToContentIndexLine.MODIFY;
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=11220;
      Height=5830;
    }
    CONTROLS
    {
      { 1000000000;TextBox;3850 ;110  ;2640 ;440  ;CaptionML=ENU=Copy Content List From;
                                                   SourceExpr=FromContentIndexHdr."No.";
                                                   TableRelation="Content Index Header";
                                                   OnValidate=BEGIN
                                                                FromContentIndexHdr.GET(FromContentIndexHdr."No.");
                                                                IF NOT Item1.GET(FromContentIndexHdr."Magazine Item No.") THEN
                                                                  CLEAR(Item1);
                                                                IF FromContentIndexHdr."No." = ToContentIndexHdr."No." THEN
                                                                  ERROR(Text002,FromContentIndexHdr."No.");
                                                              END;
                                                               }
      { 1000000001;Label  ;110  ;110  ;3630 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;3850 ;660  ;2640 ;440  ;Editable=No;
                                                   CaptionML=ENU=Magazine Item No.;
                                                   SourceExpr=FromContentIndexHdr."Magazine Item No.";
                                                   TableRelation=Item;
                                                   OnValidate=VAR
                                                                Magazine@1000000000 : Record 50011;
                                                              BEGIN
                                                              END;
                                                               }
      { 1000000003;Label  ;880  ;660  ;2860 ;440  ;ParentControl=1000000002 }
      { 1000000004;TextBox;3850 ;1210 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Magazine Code;
                                                   SourceExpr=Item1."Magazine Code" }
      { 1000000005;Label  ;880  ;1210 ;2860 ;440  ;ParentControl=1000000004 }
      { 1000000006;TextBox;3850 ;1760 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Volume No.;
                                                   SourceExpr=Item1."Volume No." }
      { 1000000007;Label  ;880  ;1760 ;2860 ;440  ;ParentControl=1000000006 }
      { 1000000008;TextBox;3850 ;2310 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Issue No.;
                                                   SourceExpr=Item1."Issue No." }
      { 1000000009;Label  ;880  ;2310 ;2860 ;440  ;ParentControl=1000000008 }
      { 1000000010;TextBox;3850 ;2970 ;2640 ;440  ;Editable=No;
                                                   CaptionML=ENU=Copy Content List To;
                                                   SourceExpr=ToContentIndexHdr."No.";
                                                   TableRelation="Content Index Header" }
      { 1000000011;Label  ;110  ;2970 ;3630 ;440  ;ParentControl=1000000010 }
      { 1000000012;TextBox;3850 ;3520 ;2640 ;440  ;Editable=No;
                                                   CaptionML=ENU=Magazine Item No.;
                                                   SourceExpr=ToContentIndexHdr."Magazine Item No.";
                                                   TableRelation=Item;
                                                   OnValidate=VAR
                                                                Magazine@1000000000 : Record 50011;
                                                              BEGIN
                                                              END;
                                                               }
      { 1000000013;Label  ;880  ;3520 ;2860 ;440  ;ParentControl=1000000012 }
      { 1000000014;TextBox;3850 ;4070 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Magazine Code;
                                                   SourceExpr=Item2."Magazine Code" }
      { 1000000015;Label  ;880  ;4070 ;2860 ;440  ;ParentControl=1000000014 }
      { 1000000016;TextBox;3850 ;4620 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Volume No.;
                                                   SourceExpr=Item2."Volume No." }
      { 1000000017;Label  ;880  ;4620 ;2860 ;440  ;ParentControl=1000000016 }
      { 1000000018;TextBox;3850 ;5170 ;2200 ;440  ;Editable=No;
                                                   CaptionML=ENU=Issue No.;
                                                   SourceExpr=Item2."Issue No." }
      { 1000000019;Label  ;880  ;5170 ;2860 ;440  ;ParentControl=1000000018 }
      { 1000000020;CheckBox;10560;110 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Copy Photo Expense;
                                                   SourceExpr=CopyPhotoExpense }
      { 1000000021;Label  ;7150 ;110  ;3300 ;440  ;ParentControl=1000000020 }
      { 1000000022;CheckBox;10560;660 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Copy Content Cost;
                                                   SourceExpr=CopyContentCost }
      { 1000000023;Label  ;7150 ;660  ;3300 ;440  ;ParentControl=1000000022 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      FromContentIndexHdr@1000000001 : Record 50019;
      Text001@1000000002 : TextConst 'ENU=%1 must be specify.';
      ToContentIndexHdr@1000000000 : Record 50019;
      ToContentIndexLine@1000000005 : Record 50020;
      FromPhotoExpense@1000000009 : Record 50021;
      ToPhotoExpense@1000000010 : Record 50021;
      FromContentCost@1000000011 : Record 50022;
      ToContentCost@1000000012 : Record 50022;
      Item1@1000000003 : Record 27;
      Item2@1000000004 : Record 27;
      LineNo@1000000006 : Integer;
      CopyPhotoExpense@1000000007 : Boolean;
      CopyContentCost@1000000008 : Boolean;
      Text002@1000000013 : TextConst 'ENU=You cannot copy document from Content Index %1.';

    PROCEDURE InitRequest@1000000000(_ContentIndexHdr@1000000000 : Record 50019);
    BEGIN
      ToContentIndexHdr := _ContentIndexHdr;
      IF NOT Item2.GET(ToContentIndexHdr."Magazine Item No.") THEN
        CLEAR(Item2);

      CopyPhotoExpense := TRUE;
      CopyContentCost := TRUE;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   17.05.2007   KKE   New batch job for "Copy Content Index" - Editorial Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50034 Archive Content Index
{
  OBJECT-PROPERTIES
  {
    Date=08/14/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00-P;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   IF NoOfArch <= 1 THEN
                     MESSAGE(Text001,NoOfArch,' has')
                   ELSE
                     MESSAGE(Text001,NoOfArch,'s have');
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50019;
        DataItemTableView=SORTING(No.);
        OnPreDataItem=BEGIN
                        NoOfArch := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           ContentIndexLine.SETPERMISSIONFILTER;
                           ContentIndexLine.RESET;
                           ContentIndexLine.SETRANGE("Magazine Code","Magazine Code");
                           ContentIndexLine.SETRANGE("Content List No.","No.");
                           ContentIndexLine.SETFILTER(Status,'<>%1&<>%2',
                             ContentIndexLine.Status::Occupied,
                             ContentIndexLine.Status::Approved);
                           IF ContentIndexLine.FIND('-') THEN
                             CurrReport.SKIP;

                           ContentIndexLine.SETRANGE(Status);
                           IF NOT ContentIndexLine.FIND('-') THEN
                             CurrReport.SKIP;

                           ArchContentIndexHdr.INIT;
                           ArchContentIndexHdr.TRANSFERFIELDS("Content Index Header");
                           ArchContentIndexHdr.INSERT;

                           REPEAT
                             ArchContentIndexLine.INIT;
                             ArchContentIndexLine.TRANSFERFIELDS(ContentIndexLine);
                             ArchContentIndexLine.INSERT;
                             PhotoExpense.RESET;
                             PhotoExpense.SETRANGE("Content Index No.",ContentIndexLine."Content List No.");
                             PhotoExpense.SETRANGE("Content Index Line No.",ContentIndexLine."Content List Line No.");
                             PhotoExpense.MODIFYALL(Archived,TRUE);
                             ContentCost.RESET;
                             ContentCost.SETRANGE("Content Index No.",ContentIndexLine."Content List No.");
                             ContentCost.SETRANGE("Content Index Line No.",ContentIndexLine."Content List Line No.");
                             ContentCost.MODIFYALL(Archived,TRUE);
                           UNTIL ContentIndexLine.NEXT=0;

                           DELETE;
                           ContentIndexLine.DELETEALL;

                           NoOfArch += 1;
                         END;

        ReqFilterFields=No.,Creation Date,Magazine Item No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      ContentIndexLine@1000000000 : Record 50020;
      ArchContentIndexHdr@1000000001 : Record 50045;
      ArchContentIndexLine@1000000002 : Record 50046;
      PhotoExpense@1000000005 : Record 50021;
      ContentCost@1000000006 : Record 50022;
      NoOfArch@1000000003 : Integer;
      Text001@1000000004 : TextConst 'ENU=%1 record%2 been archived.';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   21.05.2007   KKE   New batchjob to archived Content Booking - Editorial Module
                               Content Booking will be archived when line status = Approved,Cancelled only.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50035 Bank Cheque (Create File)
{
  OBJECT-PROPERTIES
  {
    Date=12/23/11;
    Time=[ 5:09:44 PM];
    Modified=Yes;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPostReport=BEGIN
                   IF CreateFile THEN
                     WriteDataToText;
                 END;

    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table81;
        DataItemTableView=SORTING(Journal Template Name,Journal Batch Name,Posting Date,Document No.)
                          WHERE(Document Type=CONST(Payment),
                                Block Bank Cheque=CONST(No));
        OnPreDataItem=BEGIN
                        NoOfLine := 0;
                        CompanyInfo.GET;
                        CompanyInfo.TESTFIELD("Order Party Account");
                        CompanyInfo.TESTFIELD("Order Party Account Currency");
                      END;

        OnAfterGetRecord=BEGIN
                           IF DocNo = "Document No." THEN
                             CurrReport.SKIP;

                           DocNo := "Document No.";
                           CheckAmount := 0;
                           WHTAmount := 0;
                           GenJnlLine.RESET;
                           GenJnlLine.SETCURRENTKEY("Journal Template Name","Journal Batch Name","Posting Date","Document No.");
                           GenJnlLine.SETRANGE("Journal Template Name", "Journal Template Name");
                           GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                           GenJnlLine.SETRANGE("Posting Date","Posting Date");
                           GenJnlLine.SETRANGE("Document No.","Document No.");
                           GenJnlLine.SETRANGE("Account Type","Account Type");
                           GenJnlLine.SETRANGE("Account No.","Account No.");
                           GenJnlLine.SETRANGE("Bal. Account Type","Bal. Account Type");
                           GenJnlLine.SETRANGE("Bal. Account No.","Bal. Account No.");
                           GenJnlLine.SETRANGE("Bank Payment Type","Bank Payment Type");
                           IF GenJnlLine.FIND('-') THEN
                             REPEAT
                               CheckAmount := CheckAmount + GenJnlLine.Amount;
                               GenJnlLine1.COPY(GenJnlLine);
                               IF (GenJnlLine1."Interest Amount"<>0) THEN
                                 GenJnlLine1.VALIDATE(Amount,GenJnlLine1.Amount-GenJnlLine1."Interest Amount");
                               IF GenJnlLine."Account Type" = GenJnlLine."Account Type"::Vendor THEN BEGIN
                                 GenJnlLine1.VALIDATE(Amount,-GenJnlLine.Amount);
                                 WHTAmount := WHTAmount + WHTManagement.WHTAmountJournal(GenJnlLine1,FALSE);
                               END;
                             UNTIL GenJnlLine.NEXT = 0;
                           CheckAmount := CheckAmount + WHTAmount;

                           IF CheckAmount < 0 THEN
                             CurrReport.SKIP;

                           IF "Account Type" = "Account Type"::Vendor THEN BEGIN
                             Vendor.GET("Account No.");
                             Vendor.Contact := '';
                             Vendor.TESTFIELD("Documents Require");
                             IF "Payee Name" <> '' THEN
                               VendorName := "Payee Name"
                             ELSE
                               IF Vendor."Name (Thai)" <> '' THEN
                                 VendorName := Vendor."Name (Thai)"
                               ELSE
                                 VendorName := Vendor.Name + Vendor."Name 2";
                             IF Vendor."Address (Thai)" <> '' THEN BEGIN
                               VendorAddress[1] := COPYSTR(Vendor."Address (Thai)",1,35);
                               VendorAddress[2] := COPYSTR(Vendor."Address (Thai)",36,35);
                               VendorAddress[3] := COPYSTR(Vendor."Address (Thai)",71,35);
                             END ELSE BEGIN
                               VendorAddress[1] := COPYSTR(Vendor.Address + Vendor."Address 2" + Vendor."Address 3",1,35);
                               VendorAddress[2] := COPYSTR(Vendor.Address + Vendor."Address 2" + Vendor."Address 3",36,35);
                               VendorAddress[3] := COPYSTR(Vendor.Address + Vendor."Address 2" + Vendor."Address 3",71,35);
                             END;
                           END;

                           VendLedgEntryBuffer.RESET;
                           //Applies to ID
                           IF "Applies-to ID" <> '' THEN BEGIN
                             VendLedgEntry.RESET;
                             VendLedgEntry.SETCURRENTKEY("Vendor No.","Applies-to ID",Open,Positive,"Due Date");
                             IF "Account Type" = "Account Type"::Vendor THEN
                               VendLedgEntry.SETRANGE("Vendor No.","Account No.");
                             IF "Bal. Account Type" = "Bal. Account Type"::Vendor THEN
                               VendLedgEntry.SETRANGE("Vendor No.","Bal. Account No.");
                             VendLedgEntry.SETRANGE("Applies-to ID","Applies-to ID");
                             IF VendLedgEntry.FIND('-') THEN
                               REPEAT
                                 VendLedgEntryBuffer := VendLedgEntry;
                                 VendLedgEntryBuffer.MARK(TRUE);
                               UNTIL VendLedgEntry.NEXT = 0 ;
                           END;

                           //Apply to Doc no.
                           IF "Applies-to Doc. No." <> '' THEN BEGIN
                             VendLedgEntry.RESET;
                             VendLedgEntry.SETCURRENTKEY("Vendor No.","Applies-to ID",Open,Positive,"Due Date");
                             IF "Account Type" = "Account Type"::Vendor THEN
                               VendLedgEntry.SETRANGE("Vendor No.","Account No.");
                             IF "Bal. Account Type" = "Bal. Account Type"::Vendor THEN
                               VendLedgEntry.SETRANGE("Vendor No.","Bal. Account No.");
                               VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                               VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                             IF VendLedgEntry.FIND('-') THEN
                               REPEAT
                                 VendLedgEntryBuffer := VendLedgEntry;
                                 VendLedgEntryBuffer.MARK(TRUE);
                               UNTIL VendLedgEntry.NEXT = 0 ;
                           END;

                           VendLedgEntryBuffer.MARKEDONLY(TRUE);

                           IF CreateFile THEN BEGIN
                             GenJnlLine.MODIFYALL("Block Bank Cheque",TRUE);

                             NoOfLine += 1;
                             EnterCellBuffer(NoOfLine,1,CompanyInfo."Order Party Account");
                             EnterCellBuffer(NoOfLine,2,CompanyInfo."Order Party Account Currency");
                             EnterCellBuffer(NoOfLine,3,CompanyInfo."Order Party Account");
                             EnterCellBuffer(NoOfLine,4,CompanyInfo."Order Party Account Currency");
                             EnterCellBuffer(NoOfLine,5,'ABQ');
                             EnterCellBuffer(NoOfLine,6,'15');
                             EnterCellBuffer(NoOfLine,7,'N');
                             EnterCellBuffer(NoOfLine,8,'');
                             EnterCellBuffer(NoOfLine,9,'THB');
                             EnterCellBuffer(NoOfLine,10,FORMAT("Posting Date",0,'<Day,2><Month,2><Year4>'));
                             EnterCellBuffer(NoOfLine,11,'');
                             EnterCellBuffer(NoOfLine,12,'');
                             EnterCellBuffer(NoOfLine,13,'');
                             EnterCellBuffer(NoOfLine,14,'');
                             EnterCellBuffer(NoOfLine,15,'');
                             EnterCellBuffer(NoOfLine,16,'');
                             EnterCellBuffer(NoOfLine,17,'');

                             txtChkAmount := '';
                             FOR i:=1 TO 15-STRLEN(FORMAT(CheckAmount,0,'<Precision,2:2><Integer><Decimals>')) DO
                               txtChkAmount += '0';
                             txtChkAmount += FORMAT(CheckAmount,0,'<Precision,2:2><Integer><Decimals>');
                             EnterCellBuffer(NoOfLine,18,txtChkAmount);

                             EnterCellBuffer(NoOfLine,19,'05');
                             EnterCellBuffer(NoOfLine,20,'');
                             EnterCellBuffer(NoOfLine,21,'');
                             EnterCellBuffer(NoOfLine,22,'');
                             EnterCellBuffer(NoOfLine,23,'');
                             EnterCellBuffer(NoOfLine,24,'');
                             EnterCellBuffer(NoOfLine,25,'');
                             EnterCellBuffer(NoOfLine,26,'');
                             EnterCellBuffer(NoOfLine,27,COPYSTR(VendorName,1,140));
                             EnterCellBuffer(NoOfLine,28,'');
                             EnterCellBuffer(NoOfLine,29,'');
                             EnterCellBuffer(NoOfLine,30,'');
                             EnterCellBuffer(NoOfLine,31,VendorAddress[1]);
                             EnterCellBuffer(NoOfLine,32,VendorAddress[2]);
                             EnterCellBuffer(NoOfLine,33,VendorAddress[3]);
                             FOR i:=34 TO 56 DO
                               EnterCellBuffer(NoOfLine,i,'');

                             EnterCellBuffer(NoOfLine,57,"Document No.");
                             EnterCellBuffer(NoOfLine,58,'');
                             EnterCellBuffer(NoOfLine,59,Vendor."Fax No.");
                             EnterCellBuffer(NoOfLine,60,"External Document No.");
                             EnterCellBuffer(NoOfLine,61,Vendor."Documents Require");
                             EnterCellBuffer(NoOfLine,62,'');
                             EnterCellBuffer(NoOfLine,63,'');
                             EnterCellBuffer(NoOfLine,64,"Document No.");
                             EnterCellBuffer(NoOfLine,65,'');

                             x := 0;
                             IF VendLedgEntryBuffer.FIND('-') THEN BEGIN
                               EnterCellBuffer(NoOfLine,66,Text005);
                               REPEAT
                                 x += 1;
                                 IF x = 1 THEN BEGIN
                                   NoOfLine += 1;
                                   EnterCellBuffer(NoOfLine,66,Text006);
                                 END;

                                 NoOfLine += 1;
                                 txtSqeNo := '';
                                 FOR i:=1 TO 4-STRLEN(FORMAT(x)) DO
                                   txtSqeNo += '0';
                                 txtSqeNo += FORMAT(x);

                                 VendLedgEntryBuffer.CALCFIELDS("Amount (LCY)");
                                 txtInvAmount := '';
                                 FOR i:=1 TO 15-STRLEN(FORMAT(VendLedgEntryBuffer."Amount (LCY)",0,'<Precision,2:2><Integer Thousand><Decimals>')) DO
                                   txtInvAmount += ' ';
                                 txtInvAmount += FORMAT(VendLedgEntryBuffer."Amount (LCY)",0,'<Precision,2:2><Integer Thousand><Decimals>');

                                 EnterCellBuffer(NoOfLine,66,STRSUBSTNO(Text007,
                                   txtSqeNo,
                                   //VendLedgEntryBuffer."Document No.",
                                   VendLedgEntryBuffer."External Document No.",  //26.05.2008 request to show vendor invoice no.
                                   FORMAT(VendLedgEntryBuffer."Posting Date",0,'<Day,2>.<Month,2>.<Year,4>'),
                                   txtInvAmount));
                               UNTIL VendLedgEntryBuffer.NEXT=0;
                             END;

                             IF x >= 1 THEN BEGIN
                               NoOfLine += 1;
                               EnterCellBuffer(NoOfLine,67,';');
                             END ELSE
                               EnterCellBuffer(NoOfLine,67,'');
                           END;
                         END;

        ReqFilterFields=Journal Template Name,Journal Batch Name,Posting Date,Document No.,Bal. Account Type,Bal. Account No.;
        GroupTotalFields=Document No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=28050;
            SectionHeight=2538;
          }
          CONTROLS
          {
            { 1000000001;Label  ;8850 ;846  ;1050 ;1269 ;ParentControl=1000000000;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000003;Label  ;20700;846  ;2100 ;1269 ;ParentControl=1000000002;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000005;Label  ;10050;846  ;1800 ;1269 ;ParentControl=1000000004;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000011;Label  ;24900;846  ;1950 ;1269 ;ParentControl=1000000010;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000007;Label  ;12900;846  ;3150 ;1269 ;ParentControl=1000000006;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000013;Label  ;1650 ;846  ;800  ;1269 ;ParentControl=1000000012;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000009;Label  ;0    ;846  ;1500 ;1269 ;ParentControl=1000000008;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000014;Label  ;4200 ;846  ;800  ;1269 ;ParentControl=1000000016;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000015;Label  ;2550 ;846  ;1500 ;1269 ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000019;Label  ;5100 ;846  ;900  ;1269 ;ParentControl=1000000018;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000021;Label  ;6150 ;846  ;750  ;1269 ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000023;Label  ;7050 ;846  ;750  ;1269 ;ParentControl=1000000022;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000025;Label  ;7900 ;846  ;800  ;1269 ;ParentControl=1000000024;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000027;Label  ;12000;846  ;750  ;1269 ;ParentControl=1000000026;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000029;Label  ;0    ;0    ;4050 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=BANK CHEQUE (ABQ) }
            { 1000000032;Shape  ;0    ;2115 ;28050;423  ;ShapeStyle=HorzLine }
            { 1000000034;Label  ;16200;846  ;2550 ;1269 ;ParentControl=1000000033;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000037;Label  ;22950;846  ;1800 ;1269 ;ParentControl=1000000036;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000039;Label  ;26850;846  ;1200 ;1269 ;ParentControl=1000000038;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=28050;
            SectionHeight=1100;
          }
          CONTROLS
          {
            { 1000000000;TextBox;8850 ;0    ;1050 ;423  ;CaptionML=ENU=Trans. Date;
                                                         SourceExpr="Posting Date" }
            { 1000000002;TextBox;20700;0    ;2100 ;423  ;CaptionML=ENU=Order party ref.;
                                                         SourceExpr="Document No." }
            { 1000000004;TextBox;10050;0    ;1800 ;423  ;CaptionML=ENU=Transaction amount;
                                                         SourceExpr=CheckAmount }
            { 1000000010;TextBox;24900;0    ;1950 ;423  ;CaptionML=ENU=Orderere Reference;
                                                         SourceExpr="External Document No." }
            { 1000000006;TextBox;12900;0    ;3150 ;1100 ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Counter-party name;
                                                         SourceExpr=VendorName }
            { 1000000008;TextBox;0    ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         CaptionML=ENU=Order Party Account;
                                                         SourceExpr=CompanyInfo."Order Party Account" }
            { 1000000012;TextBox;1650 ;0    ;800  ;423  ;CaptionML=ENU=Order Party Acc. Curr.;
                                                         SourceExpr=CompanyInfo."Order Party Account Currency" }
            { 1000000016;TextBox;4200 ;0    ;800  ;423  ;CaptionML=ENU=Charge Acc. Curr.;
                                                         SourceExpr=CompanyInfo."Order Party Account Currency" }
            { 1000000017;TextBox;2550 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         CaptionML=ENU=Charge Account;
                                                         SourceExpr=CompanyInfo."Order Party Account" }
            { 1000000018;TextBox;5100 ;0    ;900  ;423  ;CaptionML=ENU=Trans. Mode;
                                                         SourceExpr='ABQ' }
            { 1000000020;TextBox;6150 ;0    ;750  ;423  ;CaptionML=ENU=Inst. for Charges;
                                                         SourceExpr='15' }
            { 1000000022;TextBox;7050 ;0    ;750  ;423  ;CaptionML=ENU=Urgent Flag;
                                                         SourceExpr='N' }
            { 1000000024;TextBox;7900 ;0    ;800  ;423  ;CaptionML=ENU=Trans. Curr.;
                                                         SourceExpr='THB' }
            { 1000000026;TextBox;12000;0    ;750  ;423  ;CaptionML=ENU=Trans. Inst.;
                                                         SourceExpr='05' }
            { 1000000033;TextBox;16150;0    ;4400 ;1100 ;VertAlign=Top;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Address 1-3;
                                                         SourceExpr=VendorAddress[1] + VendorAddress[2] + VendorAddress[3] }
            { 1000000036;TextBox;22950;0    ;1800 ;423  ;CaptionML=ENU=Fax No.;
                                                         SourceExpr=Vendor."Fax No." }
            { 1000000038;TextBox;26850;0    ;1200 ;423  ;CaptionML=ENU=Commercial Reference;
                                                         SourceExpr=Vendor."Documents Require" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,VendLedgEntryBuffer.COUNT);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number=1 THEN
                             VendLedgEntryBuffer.FIND('-')
                           ELSE
                             VendLedgEntryBuffer.NEXT;
                           VendLedgEntryBuffer.CALCFIELDS("Amount (LCY)");
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=28050;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000030;Label  ;1950 ;0    ;1500 ;423  ;ParentControl=1000000028;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000035;Label  ;3750 ;0    ;2550 ;423  ;ParentControl=1000000031;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000041;Label  ;6750 ;0    ;1500 ;423  ;ParentControl=1000000040;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000043;Label  ;9000 ;0    ;2550 ;423  ;ParentControl=1000000042;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=28050;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000028;TextBox;1950 ;0    ;1500 ;423  ;CaptionML=ENU=Seq. No.;
                                                         SourceExpr=Number }
            { 1000000031;TextBox;3750 ;0    ;2550 ;423  ;CaptionML=ENU=Inv. No.;
                                                         SourceExpr=VendLedgEntryBuffer."External Document No." }
            { 1000000040;TextBox;6750 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         CaptionML=ENU=Inv. Date;
                                                         SourceExpr=VendLedgEntryBuffer."Posting Date" }
            { 1000000042;TextBox;9000 ;0    ;2550 ;423  ;CaptionML=ENU=Amount;
                                                         SourceExpr=VendLedgEntryBuffer."Amount (LCY)" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=28050;
            SectionHeight=423;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9130;
      Height=3410;
      OnOpenForm=BEGIN
                   UpdateRequestForm;
                 END;

    }
    CONTROLS
    {
      { 1000000001;CheckBox;3520;110  ;440  ;440  ;InPage=-1;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Create File;
                                                   SourceExpr=CreateFile;
                                                   OnAfterValidate=BEGIN
                                                                     UpdateRequestForm;
                                                                   END;
                                                                    }
      { 1000000003;Label  ;110  ;110  ;3300 ;440  ;ParentControl=1000000001 }
      { 1000000000;TextBox;3520 ;660  ;5500 ;440  ;Name=FileNamex;
                                                   InPage=-1;
                                                   CaptionML=[ENU=Workbook File Name;
                                                              THA=ชื่อแฟ้มสมุดงาน];
                                                   SourceExpr=FileName;
                                                   OnAssistEdit=BEGIN
                                                                  UploadFile;
                                                                  IF ISSERVICETIER AND (UploadedFileName <> '') THEN
                                                                    FileName := Text103;
                                                                END;

                                                   OnAfterValidate=BEGIN
                                                                     UploadFile;
                                                                     IF ISSERVICETIER AND (UploadedFileName <> '') THEN
                                                                       FileName := Text103;
                                                                   END;
                                                                    }
      { 1000000002;Label  ;110  ;660  ;3300 ;440  ;ParentControl=1000000000 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000021 : Record 79;
      GenJnlLine@1000000008 : Record 81;
      GenJnlLine1@1000000012 : Record 81;
      Vendor@1000000014 : Record 23;
      VendLedgEntry@1000000020 : Record 25;
      VendLedgEntryBuffer@1000000022 : Record 25;
      TempExcelBuffer@1000000005 : TEMPORARY Record 370;
      FormatAddr@1000000017 : Codeunit 365;
      WHTManagement@1000000011 : Codeunit 28040;
      CreateFile@1000000000 : Boolean;
      FileName@1000000002 : Text[250];
      Text000@1000000007 : TextConst 'ENU=Analyzing Data...\\;THA=กำลังวิเคราะห์ข้อมูล...\\';
      Text002@1000000006 : TextConst 'ENU=Update Workbook;THA=ปรับปรุงสมุดงาน';
      FileNameEnable@1000000029 : Boolean INDATASET;
      UploadedFileName@1000000028 : Text[1024];
      DocNo@1000000013 : Code[20];
      VendorName@1000000016 : Text[150];
      VendorAddress@1000000003 : ARRAY [3] OF Text[35];
      txtChkAmount@1000000023 : Text[15];
      txtSqeNo@1000000025 : Text[4];
      txtInvAmount@1000000015 : Text[15];
      CheckAmount@1000000010 : Decimal;
      WHTAmount@1000000009 : Decimal;
      NoOfLine@1000000001 : Integer;
      i@1000000004 : Integer;
      Text005@1000000018 : TextConst 'ENU=S/No  Inv No.            Inv Date              Amount';
      Text006@1000000019 : TextConst 'ENU=------------------------------------------------------------------';
      x@1000000024 : Integer;
      Text007@1000000026 : TextConst 'ENU=%1  %2     %3            %4  +';
      Text103@1000000027 : TextConst 'ENU=The file was successfully uploaded to server;THA=อัพโหลดแฟ้มไปยังเซิร์ฟเวอร์เรียบร้อยแล้ว';

    PROCEDURE WriteDataToText@1000000000();
    VAR
      ExportFile@1000000000 : File;
      LineText@1000000001 : Text[1000];
    BEGIN
      ExportFile.TEXTMODE(TRUE);
      ExportFile.WRITEMODE(TRUE);
      IF EXISTS(FileName) THEN
        ERROR('File %1 has already exist.');
      ExportFile.CREATE(FileName);

      FOR i:=1 TO NoOfLine DO BEGIN
        LineText := '';
        TempExcelBuffer.RESET;
        TempExcelBuffer.SETRANGE("Row No.",i);
        IF TempExcelBuffer.FIND('-') THEN
          REPEAT
            IF LineText <> '' THEN
              LineText += ';' + TempExcelBuffer."Cell Value as Text"
            ELSE
              LineText := TempExcelBuffer."Cell Value as Text";
          UNTIL TempExcelBuffer.NEXT=0;
        ExportFile.WRITE(LineText);
      END;
      ExportFile.CLOSE;
    END;

    LOCAL PROCEDURE EnterCellBuffer@2(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250]);
    BEGIN
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE UploadFile@6();
    VAR
      CommonDialogMgt@1000 : Codeunit 412;
    BEGIN
      UploadedFileName := CommonDialogMgt.OpenFile(Text002,FileName,1,'',0);
      FileName := UploadedFileName;
    END;

    PROCEDURE UpdateRequestForm@1000000002();
    BEGIN
      {
      IF ISSERVICETIER THEN BEGIN
        PageUpdateRequestForm;
        EXIT;
      END;
        FileName := '';
        UploadedFileName := '';
        IF NOT ISSERVICETIER THEN BEGIN
          RequestOptionsForm.FileNamex.ENABLED(FALSE);
        END;
      }
      IF CreateFile THEN BEGIN
        RequestOptionsForm.FileNamex.ENABLED(TRUE);
      END ELSE BEGIN
        FileName := '';
        RequestOptionsForm.FileNamex.ENABLED(FALSE);
      END;
    END;

    LOCAL PROCEDURE PageUpdateRequestForm@19031953();
    BEGIN
        FileName := '';
        UploadedFileName := '';
        IF NOT ISSERVICETIER THEN BEGIN
          FileNameEnable := FALSE;
        END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50036 Sales - Invoice Combine
{
  OBJECT-PROPERTIES
  {
    Date=12/27/19;
    Time=[ 1:28:07 PM];
    Modified=Yes;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    Permissions=TableData 7190=rimd;
    CaptionML=[ENU=Sales - Invoice;
               THA=การขาย - ใบส่งของ];
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   CompanyInfo.GET;
                   SalesSetup.GET;

                   {
                   CASE SalesSetup."Logo Position on Documents" OF
                     SalesSetup."Logo Position on Documents"::"No Logo":;
                     SalesSetup."Logo Position on Documents"::Left:
                       BEGIN
                         CompanyInfo.CALCFIELDS(Picture);
                       END;
                     SalesSetup."Logo Position on Documents"::Center:
                       BEGIN
                         CompanyInfo1.GET;
                         CompanyInfo1.CALCFIELDS(Picture);
                       END;
                     SalesSetup."Logo Position on Documents"::Right:
                       BEGIN
                         CompanyInfo2.GET;
                         CompanyInfo2.CALCFIELDS(Picture);
                       END;
                   END;
                   }
                 END;

    OnPreReport=BEGIN
                  IF NOT CurrReport.USEREQUESTFORM THEN
                    InitLogInteraction;
                END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table112;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Posted Sales Invoice;
                            THA=ใบส่งของสินค้าขายที่ลงรายการบัญชี];
        OnPreDataItem=BEGIN
                        //KKE : #001 +
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                        //KKE : #001 -
                      END;

        OnAfterGetRecord=BEGIN
                           CurrReport.LANGUAGE := Language.GetLanguageID("Language Code");

                           IF RespCenter.GET("Responsibility Center") THEN BEGIN
                             FormatAddr.RespCenter(CompanyAddr,RespCenter);
                             CompanyInfo."Phone No." := RespCenter."Phone No.";
                             CompanyInfo."Fax No." := RespCenter."Fax No.";
                           END ELSE BEGIN
                             FormatAddr.Company(CompanyAddr,CompanyInfo);
                           END;

                           //KKE : #001 +
                           BillToName := "Bill-to Name (Thai)";
                           IF BillToName = '' THEN
                             BillToName := "Bill-to Name" + "Bill-to Name 2";

                           BillToAddress := "Bill-to Address (Thai)";
                           IF BillToAddress = '' THEN
                             BillToAddress := "Bill-to Address" + ' ' + "Bill-to Address 2" + ' ' + "Bill-to Address 3";
                           //KKE : #001 -

                           PostedDocDim1.SETRANGE("Table ID",DATABASE::"Sales Invoice Header");
                           PostedDocDim1.SETRANGE("Document No.","Sales Invoice Header"."No.");

                           IF "Order No." = '' THEN
                             OrderNoText := ''
                           ELSE
                             OrderNoText := FIELDCAPTION("Order No.");
                           IF "Salesperson Code" = '' THEN BEGIN
                             SalesPurchPerson.INIT;
                             SalesPersonText := '';
                           END ELSE BEGIN
                             SalesPurchPerson.GET("Salesperson Code");
                             SalesPersonText := Text000;
                           END;
                           IF "Your Reference" = '' THEN
                             ReferenceText := ''
                           ELSE
                             ReferenceText := FIELDCAPTION("Your Reference");
                           IF "VAT Registration No." = '' THEN
                             VATNoText := ''
                           ELSE
                             VATNoText := FIELDCAPTION("VAT Registration No.");
                           IF "Currency Code" = '' THEN BEGIN
                             GLSetup.TESTFIELD("LCY Code");
                             TotalText := STRSUBSTNO(Text001,GLSetup."LCY Code");
                             TotalInclVATText := STRSUBSTNO(Text002,GLSetup."LCY Code");
                             TotalExclVATText := STRSUBSTNO(Text006,GLSetup."LCY Code");
                           END ELSE BEGIN
                             TotalText := STRSUBSTNO(Text001,"Currency Code");
                             TotalInclVATText := STRSUBSTNO(Text002,"Currency Code");
                             TotalExclVATText := STRSUBSTNO(Text006,"Currency Code");
                             TotalInclVATTextLCY := STRSUBSTNO(Text002,GLSetup."LCY Code");
                             TotalExclVATTextLCY := STRSUBSTNO(Text006,GLSetup."LCY Code");
                           END;
                           FormatAddr.SalesInvBillTo(CustAddr,"Sales Invoice Header");
                           Cust.GET("Bill-to Customer No.");

                           IF "Payment Terms Code" = '' THEN
                             PaymentTerms.INIT
                           ELSE
                             PaymentTerms.GET("Payment Terms Code");
                           IF "Shipment Method Code" = '' THEN
                             ShipmentMethod.INIT
                           ELSE
                             ShipmentMethod.GET("Shipment Method Code");

                           FormatAddr.SalesInvShipTo(ShipToAddr,"Sales Invoice Header");
                           ShowShippingAddr := "Sell-to Customer No." <> "Bill-to Customer No.";
                           FOR i := 1 TO ARRAYLEN(ShipToAddr) DO
                             IF ShipToAddr[i] <> CustAddr[i] THEN
                               ShowShippingAddr := TRUE;

                           CALCFIELDS(Amount);
                           CALCFIELDS("Amount Including VAT");

                           AmountLCY :=
                             ROUND(
                               CurrExchRate.ExchangeAmtFCYToLCY(
                                 WORKDATE,"Currency Code",Amount,"Currency Factor"));
                           AmountIncLCY :=
                             ROUND(
                               CurrExchRate.ExchangeAmtFCYToLCY(
                                 WORKDATE,"Currency Code","Amount Including VAT","Currency Factor"));

                           //KKE : #001 +
                           CommentText := '';
                           SalesComtLine.RESET;
                           SalesComtLine.SETRANGE("Document Type",SalesComtLine."Document Type"::"Posted Invoice");
                           SalesComtLine.SETRANGE("No.","No.");
                           SalesComtLine.SETFILTER(Comment,'<>%1','');
                           IF SalesComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(CommentText + SalesComtLine.Comment) < 250 THEN
                                 IF CommentText = '' THEN
                                   CommentText := SalesComtLine.Comment
                                 ELSE
                                   CommentText := CommentText + ' ' + SalesComtLine.Comment;
                             UNTIL SalesComtLine.NEXT=0;
                           //KKE : #001 -


                           //GKU : #003 +
                           CombineQty := 0;
                           CombineUnitPrice := 0;
                           CombineDisc := 0;
                           CombineAmt := 0;
                           //GKU : #003 -
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=CopyLoop;
        OnPreDataItem=BEGIN
                        NoOfLoops := ABS(NoOfCopies) + Cust."Invoice Copies" + 1;
                        IF NoOfLoops <= 0 THEN
                          NoOfLoops := 1;
                        CopyText := '';
                        SETRANGE(Number,1,NoOfLoops);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > 1 THEN
                             CopyText := Text003;
                           CurrReport.PAGENO := 1;
                           CntLine := 0;  //KKE : #001
                           AdsProductName := '';  //KKE : #002
                         END;

        OnPostDataItem=BEGIN
                         IF NOT CurrReport.PREVIEW THEN
                           SalesInvCountPrinted.RUN("Sales Invoice Header");
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=PageLoop;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19600;
            SectionHeight=8700;
          }
          CONTROLS
          {
            { 1000000019;Shape  ;0    ;4600 ;10400;3600  }
            { 1000000018;Shape  ;10600;4600 ;8700 ;3600  }
            { 1000000016;Shape  ;13600;2600 ;5700 ;1600  }
            { 1000000000;TextBox;2700 ;4700 ;7500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=["Sales Invoice Header"."Bill-to Customer No." ] }
            { 1000000001;TextBox;15100;3500 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Posting Date" }
            { 1000000002;TextBox;15100;2700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."No." }
            { 1000000003;TextBox;500  ;5300 ;9700 ;2100 ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=BillToName + '\' + BillToAddress }
            { 1000000005;TextBox;15100;4900 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."PO No." }
            { 1000000006;TextBox;15100;7300 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SalesPurchPerson.Name }
            { 1000000009;TextBox;15100;5700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PaymentTerms.Description }
            { 1000000010;TextBox;15100;6500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Due Date" }
            { 1000000013;TextBox;2100 ;7500 ;8100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Bill-to Contact" }
            { 1000000026;Label  ;5100 ;800  ;10000;850  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Invoice }
            { 1000000029;TextBox;0    ;3500 ;12200;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000030;TextBox;0    ;4000 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000033;Label  ;13800;2700 ;1100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000034;Label  ;13800;3500 ;1100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000008;Label  ;10800;7300 ;4100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=พนักงานขาย/Salesperson }
            { 1000000011;Label  ;11100;5700 ;3800 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เงื่อนไขการชำระเงิน/Terms }
            { 1000000012;Label  ;10600;6500 ;4300 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ครบกำหนดชำระเงิน/Due Date }
            { 1000000014;Label  ;11900;4900 ;3000 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ใบสั่งซื้อ PO.No. }
            { 1000000017;Shape  ;13600;3400 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000021;Label  ;100  ;4700 ;2600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อและที่อยู่ลูกค้า }
            { 1000000022;Label  ;100  ;7500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อผู้ที่ติดต่อ }
            { 1000000042;Shape  ;15000;5400 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000049;Shape  ;15000;6200 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000051;Shape  ;15000;7000 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000053;Shape  ;15000;7800 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000027;TextBox;0    ;1800 ;12200;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000028;TextBox;0    ;2400 ;12200;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" + CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000104;TextBox;0    ;2900 ;12200;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CompanyInfo."Company Address (Thai)" }
            { 1000000025;TextBox;5100 ;0    ;10000;800  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19600;
            SectionHeight=1015;
          }
          CONTROLS
          {
            { 1000000023;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000031;Shape  ;15   ;985  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000032;Shape  ;0    ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000035;Shape  ;2300 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000036;Shape  ;10700;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000037;Shape  ;12400;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000038;Shape  ;14900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000039;Shape  ;16100;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000040;Shape  ;19230;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000041;Label  ;100  ;100  ;2100 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Issue No./Date }
            { 1000000043;Label  ;10800;100  ;1500 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Quantity }
            { 1000000044;Label  ;15000;100  ;1000 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Disc % }
            { 1000000045;Label  ;12500;100  ;2300 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Unit Price }
            { 1000000046;Label  ;16200;100  ;2900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Extended Price }
            { 1000000047;Label  ;2400 ;100  ;7200 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Item No./Description }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19600;
            SectionHeight=3000;
          }
          CONTROLS
          {
            { 1000000060;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000078;Shape  ;19230;0    ;30   ;2200 ;ShapeStyle=VertLine }
            { 1000000079;Shape  ;0    ;0    ;30   ;2200 ;ShapeStyle=VertLine }
            { 1000000086;Shape  ;15   ;2200 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000087;Label  ;6000 ;300  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้จัดเตรียม }
            { 1000000092;Label  ;6000 ;1400 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้ตรวจสอบ }
            { 1000000088;Label  ;12900;200  ;6200 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ในนาม บริษัทเบอร์ด้า (ประเทศไทย) จำกัด }
            { 1000000089;Label  ;12900;1500 ;6200 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลายเซ็นผู้มีอำนาจลงนาม }
            { 1000000093;Label  ;0    ;2400 ;19300;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=กรุณาชำระเงินด้วยเช็คขีดคร่อมในนาม "บริษัท เบอร์ด้า (ประเทศไทย) จำกัด" การชำระโดยเช็ค ใบเสร็จจะสมบูรณ์เมื่อเช็คสามารถเรียกเก็บเงินได้ }
            { 1000000097;Shape  ;5800 ;0    ;30   ;2200 ;ShapeStyle=VertLine }
            { 1000000098;Shape  ;12400;0    ;30   ;2200 ;ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DimensionLoop1;
        OnPreDataItem=BEGIN
                        IF NOT ShowInternalInfo THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN BEGIN
                             IF NOT PostedDocDim1.FIND('-') THEN
                               CurrReport.BREAK;
                           END ELSE
                             IF NOT Continue THEN
                               CurrReport.BREAK;

                           CLEAR(DimText);
                           Continue := FALSE;
                           REPEAT
                             OldDimText := DimText;
                             IF DimText = '' THEN
                               DimText := STRSUBSTNO(
                                 '%1 %2',PostedDocDim1."Dimension Code",PostedDocDim1."Dimension Value Code")
                             ELSE
                               DimText :=
                                 STRSUBSTNO(
                                   '%1, %2 %3',DimText,
                                   PostedDocDim1."Dimension Code",PostedDocDim1."Dimension Value Code");
                             IF STRLEN(DimText) > MAXSTRLEN(OldDimText) THEN BEGIN
                               DimText := OldDimText;
                               Continue := TRUE;
                               EXIT;
                             END;
                           UNTIL (PostedDocDim1.NEXT = 0);
                         END;

        DataItemLinkReference=Sales Invoice Header;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table113;
        DataItemTableView=SORTING(Document No.,Line No.);
        OnPreDataItem=BEGIN
                        VATAmountLine.DELETEALL;
                        SalesShipmentBuffer.RESET;
                        SalesShipmentBuffer.DELETEALL;
                        FirstValueEntryNo := 0;
                        MoreLines := FIND('+');
                        WHILE MoreLines AND (Description = '') AND ("No." = '') AND (Quantity = 0) AND (Amount = 0) DO
                          MoreLines := NEXT(-1) <> 0;
                        IF NOT MoreLines THEN
                          CurrReport.BREAK;
                        SETRANGE("Line No.",0,"Line No.");
                        CurrReport.CREATETOTALS("Line Amount",Amount,"Amount Including VAT","Inv. Discount Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           PostedShipmentDate := 0D;
                           IF Quantity <> 0 THEN
                             PostedShipmentDate := FindPostedShipmentDate;

                           IF (Type = Type::"G/L Account") AND (NOT ShowInternalInfo) THEN
                             "No." := '';

                           VATAmountLine.INIT;
                           VATAmountLine."VAT Identifier" := "VAT Identifier";
                           VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
                           VATAmountLine."Tax Group Code" := "Tax Group Code";
                           VATAmountLine."VAT %" := "VAT %";
                           VATAmountLine."VAT Base" := Amount;
                           VATAmountLine."Amount Including VAT" := "Amount Including VAT";
                           VATAmountLine."Line Amount" := "Line Amount";
                           IF "Allow Invoice Disc." THEN
                             VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
                           VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
                           VATAmountLine.InsertLine;

                           CLEAR(Item);
                           IF Type = Type::Item THEN
                             Item.GET("No.");
                           IssueDate := Item."Issue Date";

                           //KKE : #002 +
                           IF AdsBookingLine.GET("Ads. Booking No.","Ads. Booking Line No.") THEN BEGIN
                             IssueDate := AdsBookingLine."Issue Date";
                             IF AdsProduct.GET(AdsBookingLine."Ads. Product") THEN
                               AdsProductName := AdsProduct.Description;
                           END ELSE
                             IF ArchivedAdsBookingLine.GET("Ads. Booking No.","Ads. Booking Line No.") THEN BEGIN
                               IssueDate := ArchivedAdsBookingLine."Issue Date";
                               IF AdsProduct.GET(ArchivedAdsBookingLine."Ads. Product") THEN
                                 AdsProductName := AdsProduct.Description;
                             END;
                           //KKE : #002 -


                           //GKU : #003 +
                           CombineQty := 1;
                           CombineUnitPrice += "Sales Invoice Line"."Line Discount Amount" + "Sales Invoice Line"."Line Amount";
                           CombineDisc += "Sales Invoice Line"."Line Discount Amount";
                           CombineAmt += "Sales Invoice Line"."Line Amount";
                           //GKU : #003 -
                         END;

        DataItemLinkReference=Sales Invoice Header;
        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           //GKU : #003
                           {
                           CurrReport.SHOWOUTPUT(Type = 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             CntLine += 1;
                           END
                           //KKE : #001 -
                           }
                           CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 57  ;TextBox      ;2400 ;0    ;8200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000048;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000050;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000052;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000054;Shape  ;12400;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;10700;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000059;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000061;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           {
                           CurrReport.SHOWOUTPUT(Type > 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             CntLine += 1;
                           END
                           //KKE : #001 -
                           }
                           //GKU : #003
                           CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 64  ;TextBox      ;100  ;0    ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=IssueDate;
                                                         Format=<Day,2> - <Month Text,3> - <Year4> }
            { 66  ;TextBox      ;10800;0    ;1470 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 68  ;TextBox      ;12500;0    ;2300 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 69  ;TextBox      ;15000;0    ;1000 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Disc. %;
                                                                    THA=% ส่วนลด];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Discount %" }
            { 70  ;TextBox      ;16200;0    ;2900 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Amount;
                                                                    THA=จำนวน];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000062;TextBox;2400 ;0    ;8200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="No." + '  ' + Description }
            { 1000000063;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000064;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;12400;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;10700;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           {IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 1;}
                           //GKU : #003
                           CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000102;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000103;Label  ;17385;0    ;1600 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=4;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=Sales Shipment Buffer;
        OnPreDataItem=BEGIN
                        SalesShipmentBuffer.SETRANGE("Document No.","Sales Invoice Line"."Document No.");
                        SalesShipmentBuffer.SETRANGE("Line No.","Sales Invoice Line"."Line No.");

                        SETRANGE(Number,1,SalesShipmentBuffer.COUNT);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             SalesShipmentBuffer.FIND('-')
                           ELSE
                             SalesShipmentBuffer.NEXT;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=4;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DimensionLoop2;
        OnPreDataItem=BEGIN
                        IF NOT ShowInternalInfo THEN
                          CurrReport.BREAK;

                        PostedDocDim2.SETRANGE("Table ID",DATABASE::"Sales Invoice Line");
                        PostedDocDim2.SETRANGE("Document No.","Sales Invoice Line"."Document No.");
                        PostedDocDim2.SETRANGE("Line No.","Sales Invoice Line"."Line No.");
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN BEGIN
                             IF NOT PostedDocDim2.FIND('-') THEN
                               CurrReport.BREAK;
                           END ELSE
                             IF NOT Continue THEN
                               CurrReport.BREAK;

                           CLEAR(DimText);
                           Continue := FALSE;
                           REPEAT
                             OldDimText := DimText;
                             IF DimText = '' THEN
                               DimText := STRSUBSTNO(
                                 '%1 %2',PostedDocDim2."Dimension Code",PostedDocDim2."Dimension Value Code")
                             ELSE
                               DimText :=
                                 STRSUBSTNO(
                                   '%1, %2 %3',DimText,
                                   PostedDocDim2."Dimension Code",PostedDocDim2."Dimension Value Code");
                             IF STRLEN(DimText) > MAXSTRLEN(OldDimText) THEN BEGIN
                               DimText := OldDimText;
                               Continue := TRUE;
                               EXIT;
                             END;
                           UNTIL (PostedDocDim2.NEXT = 0);
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Combine;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine += 1;
                         END;

          }
          CONTROLS
          {
            { 1000000118;TextBox;100  ;0    ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=IssueDate;
                                                         Format=<Day,2> - <Month Text,3> - <Year4> }
            { 1000000119;TextBox;10800;0    ;1470 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=CombineQty }
            { 1000000120;TextBox;12500;0    ;2300 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=CombineUnitPrice;
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000121;TextBox;15000;0    ;1000 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Disc. %;
                                                                    THA=% ส่วนลด];
                                                         BlankZero=Yes;
                                                         SourceExpr=CombineDisc }
            { 1000000122;TextBox;16200;0    ;2900 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Amount;
                                                                    THA=จำนวน];
                                                         BlankZero=Yes;
                                                         SourceExpr=CombineAmt;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000123;TextBox;2400 ;0    ;8200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CombineDesc }
            { 1000000124;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000125;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000126;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000127;Shape  ;12400;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000128;Shape  ;10700;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000129;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000130;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Combine2;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine += 1;
                         END;

          }
          CONTROLS
          {
            { 1000000111;TextBox;2400 ;0    ;8200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CombineDesc2 }
            { 1000000112;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000113;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000114;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000115;Shape  ;12400;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000116;Shape  ;10700;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000117;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000131;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19600;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000106;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000107;Label  ;17370;0    ;1600 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=VATCounter;
        OnPreDataItem=BEGIN
                        IF VATAmountLine.GetTotalVATAmount = 0 THEN
                          CurrReport.BREAK;
                        SETRANGE(Number,1,VATAmountLine.COUNT);
                        CurrReport.CREATETOTALS(
                          VATAmountLine."Line Amount",VATAmountLine."Inv. Disc. Base Amount",
                          VATAmountLine."Invoice Discount Amount",VATAmountLine."VAT Base",VATAmountLine."VAT Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           VATAmountLine.GetLine(Number);
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,13-CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000071;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000072;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000073;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;12400;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;10700;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000076;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000077;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19600;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000108;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000109;Label  ;17370;0    ;1600 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnAfterGetRecord=BEGIN
                           //KKE : #001 +
                           IF "Sales Invoice Line"."Amount Including VAT" <> 0 THEN
                             TextAmount := '(' + Form50BIS.FormatNoThaiText(ABS("Sales Invoice Line"."Amount Including VAT")) + ')'
                           ELSE
                             TextAmount := '';
                           //KKE : #001 -
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19600;
            SectionHeight=2530;
          }
          CONTROLS
          {
            { 1000000015;TextBox;100  ;1000 ;12200;1427 ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000020;TextBox;16200;1600 ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000004;TextBox;16200;0    ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000007;TextBox;16200;800  ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT" - "Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000055;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000057;Shape  ;19230;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000058;Shape  ;16100;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000070;Shape  ;12400;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000080;Shape  ;0    ;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000081;Shape  ;15   ;2500 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000082;Label  ;100  ;100  ;12200;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ค่าโฆษณาในนิตยสารโปรดหักภาษี ณ ที่จ่าย 2% จากยอดก่อนภาษีมูลค่าเพิ่ม }
            { 1000000083;Label  ;12600;0    ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=รวมเงิน }
            { 1000000084;Label  ;12600;800  ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ภาษีมูลค่าเพิ่ม }
            { 1000000085;Label  ;12600;1600 ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=จำนวนเงินรวมทั้งสิ้น }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19600;
            SectionHeight=2430;
          }
          CONTROLS
          {
            { 1000000090;Shape  ;15   ;200  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000091;Shape  ;19230;200  ;30   ;2200 ;ShapeStyle=VertLine }
            { 1000000094;Shape  ;0    ;200  ;30   ;2200 ;ShapeStyle=VertLine }
            { 1000000095;Shape  ;15   ;2400 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000096;Label  ;100  ;300  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ADVERTISER : }
            { 1000000100;Label  ;100  ;1000 ;1800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=PRODUCT : }
            { 1000000101;Label  ;100  ;1700 ;1900 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=COMMENTS : }
            { 1000000099;TextBox;2100 ;1700 ;17000;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Remark 1" + ' ' + "Sales Invoice Header"."Remark 2" }
            { 1000000024;TextBox;2200 ;300  ;17000;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=BillToName }
            { 1000000105;TextBox;2000 ;1000 ;17100;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=AdsProductName }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total2;
        OnPreDataItem=BEGIN
                        IF NOT ShowShippingAddr THEN
                          CurrReport.BREAK;
                      END;

      }
      SECTIONS
      {
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9790;
      Height=4840;
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   InitLogInteraction;
                   RequestOptionsForm.LogInteraction.ENABLED(LogInteraction);
                 END;

    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;1210 ;1650 ;440  ;CaptionML=[ENU=No. of Copies;
                                                              THA=จำนวนสำเนา];
                                                   SourceExpr=NoOfCopies }
      { 21  ;Label        ;0    ;1210 ;3300 ;440  ;ParentControl=1 }
      { 2   ;CheckBox     ;3410 ;1760 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Show Internal Information;
                                                              THA=แสดงรายละเอียดภายในบริษัท];
                                                   SourceExpr=ShowInternalInfo }
      { 3   ;Label        ;0    ;1760 ;3300 ;440  ;ParentControl=2 }
      { 4   ;CheckBox     ;3410 ;2310 ;440  ;440  ;Name=LogInteraction;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Log Interaction;
                                                              THA=ล็อกการโต้ตอบ];
                                                   SourceExpr=LogInteraction }
      { 5   ;Label        ;0    ;2310 ;3300 ;440  ;ParentControl=4 }
      { 1500000;CheckBox  ;3410 ;2860 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=AmountInWords }
      { 1500001;CheckBox  ;3410 ;3410 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=CurrencyLCY }
      { 1500002;Label     ;0    ;3410 ;3300 ;440  ;ParentControl=1500001;
                                                   CaptionML=[ENU=Show LCY for FCY;
                                                              THA=แสดง LCY สำหรับ FCY] }
      { 1500003;Label     ;0    ;2860 ;3300 ;440  ;ParentControl=1500000;
                                                   CaptionML=[ENU=Show Total In Words;
                                                              THA=แสดงยอดรวมเป็นตัวอักษร] }
      { 1500004;CheckBox  ;3410 ;3960 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=ShowTHFormatting }
      { 1500005;Label     ;0    ;3960 ;3300 ;440  ;ParentControl=1500004;
                                                   CaptionML=[ENU=Show TH Amount In Words;
                                                              THA=แสดงจำนวนเงินเป็นบาทด้วยตัวอักษร] }
      { 1000000000;Label  ;0    ;110  ;3300 ;440  ;CaptionML=[ENU=Description;
                                                              THA=รายละเอียด] }
      { 1000000002;TextBox;3410 ;110  ;6270 ;440  ;SourceExpr=CombineDesc }
      { 1000000001;TextBox;3410 ;660  ;6270 ;440  ;SourceExpr=CombineDesc2 }
      { 1000000003;Label  ;0    ;660  ;3300 ;440  ;CaptionML=[ENU=Description2;
                                                              THA=รายละเอียด2] }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Salesperson;THA=พนักงานขาย';
      Text001@1001 : TextConst 'ENU=Total %1;THA=รวม %1';
      Text002@1002 : TextConst 'ENU=Total %1 Incl. VAT;THA=ยอดรวม %1 ที่รวม VAT';
      Text003@1003 : TextConst 'ENU=COPY;THA=คัดลอก';
      Text004@1004 : TextConst 'ENU=Sales - Invoice %1;THA=การขาย - ใบส่งของ %1';
      Text005@1005 : TextConst 'ENU=Page %1;THA=หน้า %1';
      Text006@1006 : TextConst 'ENU=Total %1 Excl. VAT;THA=รวม %1 โดยไม่รวม VAT';
      GLSetup@1007 : Record 98;
      ShipmentMethod@1008 : Record 10;
      PaymentTerms@1009 : Record 3;
      SalesPurchPerson@1010 : Record 13;
      CompanyInfo@1011 : Record 79;
      CompanyInfo1@1045 : Record 79;
      CompanyInfo2@1046 : Record 79;
      SalesSetup@1048 : Record 311;
      Cust@1012 : Record 18;
      VATAmountLine@1013 : TEMPORARY Record 290;
      PostedDocDim1@1014 : Record 359;
      PostedDocDim2@1015 : Record 359;
      RespCenter@1016 : Record 5714;
      Language@1017 : Record 8;
      SalesInvCountPrinted@1018 : Codeunit 315;
      FormatAddr@1019 : Codeunit 365;
      SegManagement@1020 : Codeunit 5051;
      SalesShipmentBuffer@1050 : TEMPORARY Record 7190;
      PostedShipmentDate@1044 : Date;
      CustAddr@1021 : ARRAY [8] OF Text[50];
      ShipToAddr@1022 : ARRAY [8] OF Text[50];
      CompanyAddr@1023 : ARRAY [8] OF Text[50];
      OrderNoText@1024 : Text[30];
      SalesPersonText@1025 : Text[30];
      VATNoText@1026 : Text[30];
      ReferenceText@1027 : Text[30];
      TotalText@1028 : Text[50];
      TotalExclVATText@1029 : Text[50];
      TotalInclVATText@1030 : Text[50];
      MoreLines@1031 : Boolean;
      NoOfCopies@1032 : Integer;
      NoOfLoops@1033 : Integer;
      CopyText@1034 : Text[30];
      ShowShippingAddr@1035 : Boolean;
      i@1036 : Integer;
      NextEntryNo@1043 : Integer;
      FirstValueEntryNo@1042 : Integer;
      DimText@1037 : Text[120];
      OldDimText@1038 : Text[75];
      ShowInternalInfo@1039 : Boolean;
      Continue@1040 : Boolean;
      LogInteraction@1041 : Boolean;
      TotalInclVATTextLCY@1500009 : Text[50];
      TotalExclVATTextLCY@1500008 : Text[50];
      AmountLCY@1500007 : Decimal;
      AmountIncLCY@1500006 : Decimal;
      CurrExchRate@1500005 : Record 330;
      CurrencyLCY@1500004 : Boolean;
      AmountInWords@1500003 : Boolean;
      AmountLangA@1500002 : ARRAY [2] OF Text[80];
      AmountLangB@1500001 : ARRAY [2] OF Text[80];
      SalesLine@1500000 : Record 37;
      ShowTHFormatting@1500010 : Boolean;
      Form50BIS@1000000003 : Report 50002;
      BillToName@1000000001 : Text[500];
      BillToAddress@1000000000 : Text[500];
      TextAmount@1000000005 : Text[250];
      PurchOrderNo@1000000002 : Code[20];
      CntLine@1000000004 : Integer;
      tmpCompanyAddr@1000000007 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000006 : ARRAY [2] OF Text[250];
      Item@1000000008 : Record 27;
      SalesComtLine@1000000010 : Record 44;
      CommentText@1000000009 : Text[250];
      AdsBookingLine@1000000011 : Record 50038;
      ArchivedAdsBookingLine@1000000012 : Record 50040;
      IssueDate@1000000013 : Date;
      AdsProduct@1000000015 : Record 50031;
      AdsProductName@1000000014 : Text[50];
      CombineQty@1000000016 : Integer;
      CombineAmt@1000000017 : Decimal;
      CombineUnitPrice@1000000018 : Decimal;
      CombineDisc@1000000019 : Decimal;
      CombineDesc@1000000020 : Text[50];
      CombineDesc2@1000000021 : Text[50];

    PROCEDURE InitLogInteraction@1();
    BEGIN
      LogInteraction := SegManagement.FindInteractTmplCode(4) <> '';
    END;

    PROCEDURE FindPostedShipmentDate@6() : Date;
    VAR
      SalesShipmentHeader@1000 : Record 110;
      SalesShipmentBuffer2@1001 : TEMPORARY Record 7190;
    BEGIN
      NextEntryNo := 1;
      IF "Sales Invoice Line"."Shipment No." <> '' THEN
        IF SalesShipmentHeader.GET("Sales Invoice Line"."Shipment No.") THEN
          EXIT(SalesShipmentHeader."Posting Date");

      IF "Sales Invoice Header"."Order No."='' THEN
        EXIT("Sales Invoice Header"."Posting Date");

      CASE "Sales Invoice Line".Type OF
        "Sales Invoice Line".Type::Item:
          GenerateBufferFromValueEntry("Sales Invoice Line");
        "Sales Invoice Line".Type::"G/L Account","Sales Invoice Line".Type::Resource,
        "Sales Invoice Line".Type::"Charge (Item)","Sales Invoice Line".Type::"Fixed Asset":
           GenerateBufferFromShipment("Sales Invoice Line");
        "Sales Invoice Line".Type::" ":
            EXIT(0D);
      END;

      SalesShipmentBuffer.RESET;
      SalesShipmentBuffer.SETRANGE("Document No.","Sales Invoice Line"."Document No.");
      SalesShipmentBuffer.SETRANGE("Line No." ,"Sales Invoice Line"."Line No.");
      IF SalesShipmentBuffer.FIND('-') THEN BEGIN
        SalesShipmentBuffer2 := SalesShipmentBuffer;
          IF SalesShipmentBuffer.NEXT = 0 THEN BEGIN
            SalesShipmentBuffer.GET(
              SalesShipmentBuffer2."Document No.",SalesShipmentBuffer2."Line No.",SalesShipmentBuffer2."Entry No.");
            SalesShipmentBuffer.DELETE;
            EXIT(SalesShipmentBuffer2."Posting Date");;
          END ;
         SalesShipmentBuffer.CALCSUMS(Quantity);
         IF SalesShipmentBuffer.Quantity <> "Sales Invoice Line".Quantity THEN BEGIN
           SalesShipmentBuffer.DELETEALL;
           EXIT("Sales Invoice Header"."Posting Date");
         END;
      END ELSE
        EXIT("Sales Invoice Header"."Posting Date");
    END;

    PROCEDURE GenerateBufferFromValueEntry@2(SalesInvoiceLine2@1002 : Record 113);
    VAR
      ValueEntry@1000 : Record 5802;
      ItemLedgerEntry@1001 : Record 32;
      TotalQuantity@1003 : Decimal;
      Quantity@1004 : Decimal;
    BEGIN
      TotalQuantity := SalesInvoiceLine2."Quantity (Base)";
      ValueEntry.SETCURRENTKEY("Document No.","Posting Date");
      ValueEntry.SETRANGE("Document No.",SalesInvoiceLine2."Document No.");
      ValueEntry.SETRANGE("Posting Date","Sales Invoice Header"."Posting Date");
      ValueEntry.SETRANGE("Item Charge No.",'');
      ValueEntry.SETFILTER("Entry No.",'%1..',FirstValueEntryNo);
      IF ValueEntry.FIND('-') THEN
        REPEAT
          IF ItemLedgerEntry.GET(ValueEntry."Item Ledger Entry No.") THEN BEGIN
            IF SalesInvoiceLine2."Qty. per Unit of Measure" <> 0 THEN
              Quantity := ValueEntry."Invoiced Quantity" / SalesInvoiceLine2."Qty. per Unit of Measure"
            ELSE
              Quantity := ValueEntry."Invoiced Quantity";
            AddBufferEntry(
              SalesInvoiceLine2,
              -Quantity,
              ItemLedgerEntry."Posting Date");
            TotalQuantity := TotalQuantity + ValueEntry."Invoiced Quantity";
          END;
          FirstValueEntryNo := ValueEntry."Entry No." + 1;
        UNTIL (ValueEntry.NEXT = 0) OR (TotalQuantity = 0);
    END;

    PROCEDURE GenerateBufferFromShipment@8(SalesInvoiceLine@1000 : Record 113);
    VAR
      SalesInvoiceHeader@1001 : Record 112;
      SalesInvoiceLine2@1002 : Record 113;
      SalesShipmentHeader@1006 : Record 110;
      SalesShipmentLine@1004 : Record 111;
      TotalQuantity@1003 : Decimal;
      Quantity@1005 : Decimal;
    BEGIN
      TotalQuantity := 0;
      SalesInvoiceHeader.SETCURRENTKEY("Order No.");
      SalesInvoiceHeader.SETFILTER("No.",'..%1',"Sales Invoice Header"."No.");
      SalesInvoiceHeader.SETRANGE("Order No.","Sales Invoice Header"."Order No.");
      IF SalesInvoiceHeader.FIND('-') THEN
        REPEAT
          SalesInvoiceLine2.SETRANGE("Document No.",SalesInvoiceHeader."No.");
          SalesInvoiceLine2.SETRANGE("Line No.",SalesInvoiceLine."Line No.");
          SalesInvoiceLine2.SETRANGE(Type,SalesInvoiceLine.Type);
          SalesInvoiceLine2.SETRANGE("No.",SalesInvoiceLine."No.");
          SalesInvoiceLine2.SETRANGE("Unit of Measure Code",SalesInvoiceLine."Unit of Measure Code");
          IF SalesInvoiceLine2.FIND('-') THEN
            REPEAT
              TotalQuantity := TotalQuantity + SalesInvoiceLine2.Quantity;
            UNTIL SalesInvoiceLine2.NEXT = 0;
        UNTIL SalesInvoiceHeader.NEXT = 0;

      SalesShipmentLine.SETCURRENTKEY("Order No.","Order Line No.");
      SalesShipmentLine.SETRANGE("Order No.","Sales Invoice Header"."Order No.");
      SalesShipmentLine.SETRANGE("Order Line No.",SalesInvoiceLine."Line No.");
      SalesShipmentLine.SETRANGE("Line No.",SalesInvoiceLine."Line No.");
      SalesShipmentLine.SETRANGE(Type,SalesInvoiceLine.Type);
      SalesShipmentLine.SETRANGE("No.",SalesInvoiceLine."No.");
      SalesShipmentLine.SETRANGE("Unit of Measure Code",SalesInvoiceLine."Unit of Measure Code");
      SalesShipmentLine.SETFILTER(Quantity,'<>%1',0);

      IF SalesShipmentLine.FIND('-') THEN
        REPEAT
          IF "Sales Invoice Header"."Get Shipment Used" THEN
            CorrectShipment(SalesShipmentLine);
          IF ABS(SalesShipmentLine.Quantity) <= ABS(TotalQuantity - SalesInvoiceLine.Quantity) THEN
            TotalQuantity := TotalQuantity - SalesShipmentLine.Quantity
          ELSE BEGIN
            IF ABS(SalesShipmentLine.Quantity)  > ABS(TotalQuantity) THEN
              SalesShipmentLine.Quantity := TotalQuantity;
            Quantity :=
              SalesShipmentLine.Quantity - (TotalQuantity - SalesInvoiceLine.Quantity);

            TotalQuantity := TotalQuantity - SalesShipmentLine.Quantity;
            SalesInvoiceLine.Quantity := SalesInvoiceLine.Quantity - Quantity;

            IF SalesShipmentHeader.GET(SalesShipmentLine."Document No.") THEN
              BEGIN
                AddBufferEntry(
                  SalesInvoiceLine,
                  Quantity,
                  SalesShipmentHeader."Posting Date");
              END;
          END;
        UNTIL (SalesShipmentLine.NEXT = 0) OR (TotalQuantity = 0);
    END;

    PROCEDURE CorrectShipment@7(VAR SalesShipmentLine@1001 : Record 111);
    VAR
      SalesInvoiceLine@1000 : Record 113;
    BEGIN
      SalesInvoiceLine.SETCURRENTKEY("Shipment No.","Shipment Line No.");
      SalesInvoiceLine.SETRANGE("Shipment No.",SalesShipmentLine."Document No.");
      SalesInvoiceLine.SETRANGE("Shipment Line No.",SalesShipmentLine."Line No.");
      IF SalesInvoiceLine.FIND('-') THEN
         REPEAT
            SalesShipmentLine.Quantity := SalesShipmentLine.Quantity - SalesInvoiceLine.Quantity;
         UNTIL SalesInvoiceLine.NEXT = 0;
    END;

    PROCEDURE AddBufferEntry@3(SalesInvoiceLine@1001 : Record 113;QtyOnShipment@1002 : Decimal;PostingDate@1003 : Date);
    BEGIN
      SalesShipmentBuffer.SETRANGE("Document No.",SalesInvoiceLine."Document No.");
      SalesShipmentBuffer.SETRANGE("Line No.",SalesInvoiceLine."Line No.");
      SalesShipmentBuffer.SETRANGE("Posting Date",PostingDate);
      IF SalesShipmentBuffer.FIND('-') THEN BEGIN
        SalesShipmentBuffer.Quantity := SalesShipmentBuffer.Quantity + QtyOnShipment;
        SalesShipmentBuffer.MODIFY;
        EXIT;
      END;

      WITH SalesShipmentBuffer DO BEGIN
        "Document No." := SalesInvoiceLine."Document No.";
        "Line No." := SalesInvoiceLine."Line No.";
        "Entry No." := NextEntryNo;
        Type := SalesInvoiceLine.Type;
        "No." := SalesInvoiceLine."No.";
        Quantity := QtyOnShipment;
       "Posting Date" := PostingDate;
        INSERT;
        NextEntryNo := NextEntryNo + 1
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda
      KKE : Kanoknard Ketnut
      GKU : Goragot Kuanmuang

      No.   Date         Sign  Description
      ----------------------------------------
      001   26.04.2007   KKE   'Sales Invoice' Report.
      002   19.09.2007   KKE   Show Issue Date on line, show remark1+remark2
      003   02.10.2007   GKU   Modify report to 'Combine Invoice'
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50037 FORM 3 Portrait
{
  OBJECT-PROPERTIES
  {
    Date=03/12/12;
    Time=[ 2:58:54 PM];
    Modified=Yes;
    Version List=AVATHA4.02;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    RightMargin=100;
    OnPreReport=BEGIN
                  IF CompanyInfo.GET THEN
                    FOR i := 1 TO STRLEN(CompanyInfo."VAT Registration No.") DO
                      CId[i] := COPYSTR(CompanyInfo."VAT Registration No.",i,1);

                  FOR i := 1 TO STRLEN(BranchNo) DO
                    Branch[i] := COPYSTR(BranchNo,i,1);

                  GLSetup.FIND('-');

                  WHTTerm := '1';
                END;

    Orientation=Portrait;
    PaperSize=A4 210 x 297 mm;
    HorzGrid=100;
    VertGrid=30;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..2));
        DataItemVarName=Integer1;
        OnPreDataItem=BEGIN
                        pNO := 1;
                      END;

        OnAfterGetRecord=BEGIN
                           IF (pNO >= 2) AND (Number > 1) AND (PageHeight = 0) THEN
                             pNO := pNO - 1;

                           PageHeight := 0;
                           SNo := 0;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19802;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19802;
            SectionHeight=4560;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(SNo <> 0);
                         END;

          }
          CONTROLS
          {
            { 1000000022;Label  ;108  ;978  ;2826 ;476  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000024;Label  ;100  ;1620 ;10600;423  ;FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=(1) ให้ระบุว่าจ่ายเป็นค่าอะไร เช่น ค่าเช่าอาคาร ค่าสอบบัญชี ค่าทนายความ ค่าวิชาชีพของแพทย์ ค่าก่อสร้าง รางวัลในการ }
            { 1000000027;Label  ;600  ;2028 ;10100;423  ;FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=ประกวด การแข่งขัน การชิงโชค ค่าจ้างแสดงภาพยนตร์ ร้องเพลง ดนตรี ค่าจ้างทำของ ค่าจ้างโฆษณา ฯลฯ }
            { 1000000036;Label  ;100  ;2889 ;10584;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=(2)  เงื่อนไขการหักภาษี ให้กรอกดังนี้    - หัก ณ ที่จ่าย     กรอก 1 }
            { 1000000040;Label  ;600  ;3288 ;5346 ;423  ;FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=- ออกให้ตลอดไป  กรอก 2 }
            { 1000000041;Label  ;600  ;3711 ;5364 ;423  ;FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=- ออกให้ครั้งเดียว  กรอก 3 }
            { 1000000042;Label  ;4800 ;0    ;8200 ;480  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมยอดเงินได้และภาษีที่นำส่ง (นำไปรวมกับใบต่อ ภ.ง.ด.3  ฉบับอื่น (ถ้ามี)) }
            { 1000000043;Label  ;200  ;0    ;3900 ;480  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ให้กรอกลำดับที่ต่อเนื่องกันไปทุกแผ่น) }
            { 1000000051;Shape  ;10700;425  ;30   ;4015 ;ShapeStyle=VertLine }
            { 1000000053;Shape  ;14200;0    ;30   ;1010 ;ShapeStyle=VertLine }
            { 1000000055;Shape  ;17900;0    ;30   ;1010 ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;16400;0    ;30   ;1010 ;ShapeStyle=VertLine }
            { 1000000057;Shape  ;0    ;0    ;30   ;4410 ;ShapeStyle=VertLine }
            { 1000000058;Shape  ;15   ;423  ;19310;30   ;ShapeStyle=HorzLine }
            { 1000000059;Shape  ;19300;0    ;30   ;4410 ;ShapeStyle=VertLine }
            { 1000000060;Shape  ;15   ;4410 ;19310;30   ;ShapeStyle=HorzLine }
            { 1000000066;TextBox;14200;30   ;2200 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 1000000067;TextBox;16400;0    ;1500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000068;Shape  ;10800;1920 ;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000069;Label  ;10850;2120 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=5;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000070;Label  ;10850;2436 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=5;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000071;Label  ;10850;2720 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=5;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000072;Shape  ;15   ;0    ;19310;30   ;ShapeStyle=HorzLine }
            { 1000000073;Shape  ;14200;900  ;3700 ;30   ;ShapeStyle=HorzLine }
            { 1000000074;TextBox;14200;450  ;2200 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT2 }
            { 1000000075;TextBox;16400;450  ;1500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=TotWHTAmtLCY2 }
            { 1000000076;Label  ;12200;450  ;1900 ;480  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=รวมทั้งหมด }
            { 1000000077;Shape  ;14200;980  ;3700 ;30   ;ShapeStyle=HorzLine }
            { 1000000093;Label  ;12442;1350 ;700  ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ลงชื่อ }
            { 1000000094;Label  ;12442;1958 ;6800 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=(.........................................................................................) }
            { 1000000097;Label  ;13100;1350 ;5100 ;423  ;VertAlign=Bottom;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................................................ }
            { 1000000098;Label  ;12442;2619 ;900  ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ตำแหน่ง }
            { 1000000100;Label  ;13300;2610 ;6000 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................... }
            { 1000000102;Label  ;12400;3390 ;800  ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ยื่นวันที่ }
            { 1000000105;Label  ;13200;3390 ;1500 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=........................... }
            { 1000000108;Label  ;14700;3390 ;600  ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=เดือน }
            { 1000000110;Label  ;15300;3390 ;2100 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................... }
            { 1000000114;Label  ;17400;3390 ;600  ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=พ.ศ. }
            { 1000000115;Label  ;18000;3390 ;1300 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=......................... }
            { 1000000118;Label  ;18200;1350 ;1100 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table28044;
        DataItemTableView=SORTING(Document Type,Posting Date,WHT Certificate No.)
                          WHERE(Transaction Type=CONST(Purchase),
                                Document Type=CONST(Payment),
                                Amount=FILTER(<>0),
                                WHT Report=CONST(Por Ngor Dor 3),
                                Cancelled=CONST(No));
        OnPreDataItem=BEGIN
                        WHTEntry.COPYFILTERS("WHT Entry");
                        IF WHTEntry.FIND('-') THEN;

                        CLEAR(NewDocNo);
                        CLEAR(Name);
                        CLEAR(Address);
                        CLEAR(VAT);
                        CLEAR(PostingDate);
                        CLEAR(WHTExpenseText);
                        CLEAR("WHT%");
                        CLEAR(WHTBaseAmtLCYExcVAT);
                        CLEAR(WHTAmtLCY);
                      END;

        OnAfterGetRecord=BEGIN
                           IF NewDocNo <> "WHT Certificate No." THEN BEGIN
                             NewDocNo := "WHT Certificate No.";
                             CLEAR(Name);
                             CLEAR(Address);
                             CLEAR(VAT);
                             CLEAR(PId);
                             CLEAR(PostingDate);
                             CLEAR(WHTExpenseText);
                             CLEAR("WHT%");
                             CLEAR(WHTBaseAmtLCYExcVAT);
                             CLEAR(WHTAmtLCY);
                           END;

                           IF "Actual Vendor No." <> '' THEN
                             Vendor.GET("Actual Vendor No.")
                           ELSE
                             Vendor.GET("Bill-to/Pay-to No.");

                           //KKE : #002 +
                           IF "Dummy Vendor" AND PurchInvHeader.GET("Document No.") THEN BEGIN
                             IF PurchInvHeader."Pay-to Name (Thai)" <> '' THEN BEGIN
                               Name := PurchInvHeader."Pay-to Name (Thai)";
                               Address := PurchInvHeader."Pay-to Address (Thai)";
                             END ELSE BEGIN
                               Name := PurchInvHeader."Pay-to Name" + PurchInvHeader."Pay-to Name 2";
                               Address := PurchInvHeader."Pay-to Address" + ' ' +
                                          PurchInvHeader."Pay-to Address 2" + ' ' + PurchInvHeader."Pay-to Address 3";
                             END;
                             FOR i := 1 TO STRLEN("VAT Registration No.(Dummy)") DO
                               VAT[i] := COPYSTR("VAT Registration No.(Dummy)",i,1);
                           END ELSE BEGIN
                           //KKE : #002 -
                             IF Vendor."Name (Thai)" <> '' THEN BEGIN
                               Name := Vendor."Name (Thai)";
                               Address := Vendor."Address (Thai)";
                             END ELSE BEGIN
                               Name := Vendor.Name + Vendor."Name 2";
                               Address := Vendor.Address + ' ' + Vendor."Address 2" + ' ' + Vendor."Address 3";
                             END;
                             FOR i := 1 TO STRLEN(Vendor."VAT Registration No.") DO
                               VAT[i] := COPYSTR(Vendor."VAT Registration No.",i,1);
                           END;

                           FOR i := 1 TO STRLEN(Vendor."ID No.") DO
                             PId[i] := COPYSTR(Vendor."ID No.",i,1);

                           PostingDate := "Posting Date";

                           IF WHTRevType.GET("WHT Revenue Type") THEN BEGIN
                             i := 0;
                             MatchType := FALSE;
                             REPEAT
                               i := i + 1;
                               IF (WHTExpenseText[i] = '') OR (WHTExpenseText[i] = WHTRevType.Description) THEN
                                 MatchType := TRUE;
                             UNTIL (i=12) OR (MatchType);
                             WHTExpenseText[i] := WHTRevType.Description;
                             "WHT%"[i] := "WHT %";

                             WHTAmtLCY[i] := WHTAmtLCY[i] + "Amount (LCY)";
                             WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + "Base (LCY)";
                           END;

                           IF PrintTest THEN
                             TestText := "Original Document No." + '/ ' + "WHT Certificate No.";
                         END;

        ReqFilterFields=Transaction Type,Document Type,Document No.,WHT Certificate No.,Posting Date;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19802;
            SectionHeight=5183;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           TotWHTBaseAmtLCYExcVAT := 0;
                           TotWHTAmtLCY := 0;
                         END;

          }
          CONTROLS
          {
            { 8   ;Label        ;0    ;966  ;5600 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ของผู้มีหน้าที่หักภาษี ณ ที่จ่าย กรณีเป็นบุคคลธรรมดา) }
            { 7   ;Label        ;0    ;360  ;6156 ;633  ;FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขประจำตัวประชาชน }
            { 54  ;Label        ;900  ;1770 ;2200 ;846  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด. 3 }
            { 55  ;Label        ;0    ;2035 ;900  ;581  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบต่อ }
            { 1   ;Shape        ;5600 ;960  ;4500 ;423   }
            { 4   ;Shape        ;9650 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 6   ;Shape        ;9200 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 57  ;Shape        ;8750 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 59  ;Shape        ;8300 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 61  ;Shape        ;7850 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 63  ;Shape        ;7400 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 64  ;Shape        ;6950 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 65  ;Shape        ;6950 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 68  ;Shape        ;6500 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 70  ;Shape        ;6050 ;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 9   ;Label        ;10200;330  ;4260 ;607  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 10  ;Label        ;10200;936  ;3300 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ของผู้มีหน้าที่หักภาษี ณ ที่จ่าย) }
            { 72  ;Shape        ;13500;936  ;5700 ;423   }
            { 73  ;TextBox      ;17500;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[10] }
            { 74  ;TextBox      ;17100;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[9] }
            { 75  ;Shape        ;18300;930  ;30   ;423  ;ShapeStyle=VertLine }
            { 76  ;TextBox      ;16700;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[8] }
            { 77  ;Shape        ;17100;936  ;30   ;423  ;ShapeStyle=VertLine }
            { 78  ;TextBox      ;16200;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[7] }
            { 79  ;Shape        ;16650;936  ;30   ;423  ;ShapeStyle=VertLine }
            { 80  ;TextBox      ;15750;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[6] }
            { 81  ;Shape        ;16200;936  ;30   ;423  ;ShapeStyle=VertLine }
            { 82  ;TextBox      ;15300;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[5] }
            { 83  ;Shape        ;15750;936  ;30   ;423  ;ShapeStyle=VertLine }
            { 84  ;TextBox      ;14850;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[4] }
            { 85  ;Shape        ;15300;936  ;30   ;423  ;ShapeStyle=VertLine }
            { 86  ;Shape        ;14850;936  ;30   ;423  ;ShapeStyle=VertLine }
            { 87  ;Shape        ;14850;936  ;30   ;423  ;ShapeStyle=VertLine }
            { 89  ;TextBox      ;14400;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[3] }
            { 90  ;Shape        ;14400;936  ;30   ;423  ;ShapeStyle=VertLine }
            { 91  ;TextBox      ;13950;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[2] }
            { 92  ;Shape        ;13950;936  ;30   ;423  ;ShapeStyle=VertLine }
            { 93  ;TextBox      ;13500;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[1] }
            { 14  ;Label        ;16400;1416 ;1044 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=สาขาที่ }
            { 13  ;Label        ;18602;2190 ;1200 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=แผ่น }
            { 12  ;Label        ;15800;2190 ;1500 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ในจำนวน }
            { 11  ;Label        ;13100;2190 ;1200 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=แผ่นที่ }
            { 94  ;Label        ;14300;2190 ;1500 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=......................... }
            { 95  ;Label        ;17276;2190 ;1326 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.................. }
            { 96  ;TextBox      ;3200 ;1830 ;9800 ;816  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 98  ;Shape        ;10   ;3040 ;19300;30   ;ShapeStyle=HorzLine }
            { 99  ;Shape        ;0    ;3045 ;30   ;2130 ;ShapeStyle=VertLine }
            { 101 ;Shape        ;19300;3030 ;30   ;2153 ;ShapeStyle=VertLine }
            { 15  ;Label        ;36   ;3362 ;1100 ;1533 ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=ลำดับที่ }
            { 97  ;Shape        ;1200 ;3045 ;30   ;2130 ;ShapeStyle=VertLine }
            { 16  ;Label        ;1300 ;3120 ;4500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวประชาชน (ของผู้มีเงินได้) }
            { 17  ;Label        ;1300 ;3630 ;4500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร (ของผู้มีเงินได้) }
            { 18  ;Label        ;1300 ;4110 ;8100 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ชื่อผู้มีเงินได้ }
            { 19  ;Label        ;1300 ;4590 ;1900 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ที่อยู่ของผู้มีเงินได้ }
            { 23  ;Label        ;18000;4395 ;1200 ;688  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=เงื่อนไข }
            { 38  ;Label        ;16400;3060 ;2900 ;720  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=6;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รวมเงินภาษีที่หัก และนำส่งในครั้งนี้ }
            { 103 ;Shape        ;17300;3720 ;2000 ;30   ;ShapeStyle=HorzLine }
            { 25  ;Label        ;16400;4230 ;1500 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 106 ;Shape        ;17900;3750 ;30   ;1433 ;ShapeStyle=VertLine }
            { 26  ;Label        ;16400;4650 ;1500 ;397  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=บาท }
            { 30  ;Label        ;10000;3060 ;6000 ;720  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=รายละเอียดเกี่ยวกับการจ่ายเงิน }
            { 27  ;Label        ;14200;3810 ;2200 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=จำนวนเงินที่จ่าย }
            { 37  ;Label        ;14200;4226 ;2200 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=แต่ละประเภทในครั้งนี้ }
            { 112 ;Shape        ;9400 ;3720 ;7900 ;30   ;ShapeStyle=HorzLine }
            { 113 ;Shape        ;9400 ;3053 ;30   ;2130 ;ShapeStyle=VertLine }
            { 117 ;Shape        ;14200;3750 ;30   ;1400 ;ShapeStyle=VertLine }
            { 32  ;Label        ;13300;3810 ;900  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=อัตรา }
            { 35  ;Label        ;9500 ;3990 ;1100 ;360  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=วัน เดือน ปี }
            { 118 ;Shape        ;10600;3780 ;30   ;1400 ;ShapeStyle=VertLine }
            { 29  ;Label        ;14200;4650 ;2200 ;420  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=บาท }
            { 119 ;Shape        ;13300;3720 ;30   ;1450 ;ShapeStyle=VertLine }
            { 33  ;Label        ;10600;4233 ;2700 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ถ้ามากกว่าหนึ่งประเภท }
            { 34  ;Label        ;10600;3810 ;2700 ;420  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1) ประเภทเงินได้ }
            { 36  ;Label        ;10600;4656 ;2700 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=ให้กรอกเรียงลงไป) }
            { 189 ;Label        ;18000;3840 ;1200 ;555  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2) }
            { 190 ;Label        ;13300;4233 ;900  ;447  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ภาษี }
            { 191 ;Label        ;13300;4620 ;900  ;450  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ร้อยละ }
            { 141 ;TextBox      ;14300;2190 ;1350 ;423  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000000;Label  ;9500 ;4519 ;1100 ;554  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ที่จ่าย }
            { 1000000001;Shape  ;16400;3030 ;30   ;2130 ;ShapeStyle=VertLine }
            { 1000000002;Shape  ;13300;4650 ;3100 ;30   ;ShapeStyle=HorzLine }
            { 1000000003;TextBox;17258;2191 ;1350 ;423  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         SourceExpr=pNO }
            { 1000000004;Label  ;3200 ;4590 ;6200 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุเลขที่ ตรอก/ซอย ถนนตำบล/แขวง อำเภอ/เขต จังหวัด) }
            { 100 ;Shape        ;0    ;5153 ;19300;30   ;ShapeStyle=HorzLine }
            { 1000000009;TextBox;18788;1410 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[4] }
            { 1000000012;TextBox;18338;1410 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[3] }
            { 1000000014;Shape  ;18788;1410 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000016;TextBox;17888;1410 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[2] }
            { 1000000017;Shape  ;18338;1410 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000018;TextBox;17438;1410 ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[1] }
            { 1000000019;Shape  ;17888;1410 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000020;Shape  ;17438;1410 ;1800 ;423   }
            { 1000000044;Shape  ;18700;960  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000046;TextBox;17900;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[11] }
            { 1000000047;TextBox;18300;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[12] }
            { 1000000048;TextBox;18700;936  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[13] }
            { 1000000049;Shape  ;17900;930  ;30   ;423  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19802;
            SectionHeight=2370;
            OnPreSection=BEGIN
                           CLEAR(OldData);
                           WHTEntry := "WHT Entry";
                           //WHTEntry.SETCURRENTKEY("Entry Type","WHT Slip No.","Pay-to/Bill-to Account Type","Pay-to/Bill-to Account No.","Open Entry");
                           //KK : #1 +
                             //WHTEntry.SETCURRENTKEY("Entry Type","Posting Date","WHT Certificate No.","Pay-to/Bill-to Account Type",
                             //  "Pay-to/Bill-to Account No.","Open Entry");
                           //WHTEntry.SETCURRENTKEY("Transaction Type","Document Type","Document No.","Bill-to/Pay-to No.");
                           WHTEntry.SETCURRENTKEY("Document Type","Posting Date","WHT Certificate No.");  //KKE : #003
                           //KK : #1 -
                           IF WHTEntry.NEXT <> 0 THEN BEGIN
                             IF NewDocNo = WHTEntry."WHT Certificate No." THEN
                               OldData := TRUE;
                           END;

                           IF OldData THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE BEGIN
                             IF Integer1.Number = 1 THEN BEGIN
                               CurrReport.SHOWOUTPUT(FALSE);
                               //PageHeight := PageHeight + 1830;//GKU:#004
                               PageHeight := PageHeight + 2370;
                               //IF ((8670  - PageHeight) < 1830) AND (i <= 3) THEN BEGIN //GKU:#004
                               IF ((17820  - PageHeight) < 2370) AND (i <= 3) THEN BEGIN
                                 PageHeight := 0;
                                 IF Integer1.Number = 1 THEN
                                 pNO := pNO + 1;
                               END;
                             END ELSE
                               SNo := SNo + 1;
                           END;
                         END;

            OnPostSection=BEGIN
                            IF NOT OldData THEN BEGIN
                              IF Integer1.Number <> 1 THEN BEGIN
                                TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT +
                                          WHTBaseAmtLCYExcVAT[1] + WHTBaseAmtLCYExcVAT[2] + WHTBaseAmtLCYExcVAT[3];
                                TotWHTAmtLCY := TotWHTAmtLCY +
                                          WHTAmtLCY[1] + WHTAmtLCY[2] + WHTAmtLCY[3];
                                TotWHTBaseAmtLCYExcVAT2 := TotWHTBaseAmtLCYExcVAT2 +
                                          WHTBaseAmtLCYExcVAT[1] + WHTBaseAmtLCYExcVAT[2] + WHTBaseAmtLCYExcVAT[3];
                                TotWHTAmtLCY2 := TotWHTAmtLCY2 +
                                          WHTAmtLCY[1] + WHTAmtLCY[2] + WHTAmtLCY[3];
                              END;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000107;TextBox;18000;270  ;1200 ;450  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=WHTTerm }
            { 1000000112;TextBox;16400;780  ;1500 ;420  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[2] }
            { 1000000113;TextBox;16400;240  ;1500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[1] }
            { 1000000119;TextBox;14200;780  ;2200 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[2] }
            { 1000000121;TextBox;13400;780  ;800  ;420  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[2] }
            { 1000000124;Label  ;12282;1329 ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000127;Label  ;11462;761  ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000128;Label  ;11336;708  ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000129;TextBox;14200;240  ;2200 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[1] }
            { 1000000130;TextBox;13400;240  ;800  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[1] }
            { 1000000169;Label  ;1300 ;1026 ;1440 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ชื่อ - สกุล }
            { 1000000170;Label  ;2680 ;1020 ;6700 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000171;TextBox;2830 ;1026 ;6500 ;423  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=Name }
            { 1000000174;TextBox;0    ;690  ;1080 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=SNo }
            { 1000000181;Label  ;1300 ;1500 ;750  ;420  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000182;Label  ;2050 ;1500 ;7300 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=...................................................................................................................................................................................................... }
            { 1000000183;TextBox;2200 ;1500 ;7200 ;690  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         MultiLine=Yes;
                                                         SourceExpr=Address + '  ' + Address2 }
            { 1000000185;Shape  ;0    ;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000186;Shape  ;9400 ;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000188;Shape  ;16400;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000190;Shape  ;17900;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000191;Shape  ;19300;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000193;Shape  ;13300;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000194;Shape  ;14200;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000195;Shape  ;1200 ;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000196;TextBox;9500 ;210  ;1100 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=PostingDate }
            { 1000000197;Shape  ;10600;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000198;TextBox;10700;750  ;2500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText[2] }
            { 1000000199;TextBox;10700;210  ;2500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText[1] }
            { 1000000010;TextBox;10700;1280 ;2500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText[3] }
            { 1000000011;TextBox;13400;1310 ;800  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[3] }
            { 1000000013;TextBox;14200;1310 ;2200 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[3] }
            { 1000000015;TextBox;16400;1310 ;1500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[3] }
            { 1000000021;Label  ;2050 ;1860 ;7300 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=...................................................................................................................................................................................................... }
            { 1000000078;TextBox;3600 ;1830 ;5800 ;423  ;HorzAlign=Right;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=TestText }
            { 1000000081;Shape  ;1400 ;60   ;423  ;423   }
            { 1000000082;TextBox;1400 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[1] }
            { 1000000083;Shape  ;1823 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000084;Shape  ;1943 ;60   ;1692 ;423   }
            { 1000000086;TextBox;1943 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[2] }
            { 1000000087;TextBox;2366 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[3] }
            { 1000000088;Shape  ;2366 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000089;TextBox;2789 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[4] }
            { 1000000091;Shape  ;2789 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000092;Shape  ;2789 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000095;TextBox;3212 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[5] }
            { 1000000096;Shape  ;3212 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000099;Shape  ;3755 ;60   ;2115 ;423   }
            { 1000000101;TextBox;3755 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[6] }
            { 1000000103;Shape  ;3635 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000104;TextBox;4178 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[7] }
            { 1000000106;Shape  ;4178 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000109;TextBox;4601 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[8] }
            { 1000000111;Shape  ;4601 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000116;TextBox;5024 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[9] }
            { 1000000117;Shape  ;5024 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000120;TextBox;5447 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[10] }
            { 1000000123;Shape  ;5447 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000131;Shape  ;5870 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000133;Shape  ;5990 ;60   ;846  ;423   }
            { 1000000134;TextBox;5990 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[11] }
            { 1000000135;TextBox;6410 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[12] }
            { 1000000136;Shape  ;6410 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000137;Shape  ;6833 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000138;Shape  ;6953 ;60   ;423  ;423   }
            { 1000000139;TextBox;6953 ;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=PId[13] }
            { 1000000140;Shape  ;1400 ;540  ;423  ;423   }
            { 1000000141;TextBox;1400 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[1] }
            { 1000000142;Shape  ;1823 ;540  ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000143;Shape  ;1973 ;540  ;1692 ;423   }
            { 1000000144;TextBox;1973 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[2] }
            { 1000000145;TextBox;2396 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[3] }
            { 1000000146;Shape  ;2396 ;540  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000147;TextBox;2819 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[4] }
            { 1000000148;Shape  ;2819 ;540  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000149;TextBox;3242 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[5] }
            { 1000000150;Shape  ;3242 ;540  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000151;Shape  ;3665 ;540  ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000152;Shape  ;3815 ;540  ;1692 ;423   }
            { 1000000153;TextBox;3815 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[6] }
            { 1000000154;TextBox;4238 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[7] }
            { 1000000155;Shape  ;4238 ;540  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000156;TextBox;4661 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[8] }
            { 1000000157;Shape  ;4661 ;540  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000158;TextBox;5084 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[9] }
            { 1000000159;Shape  ;5084 ;540  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000160;Shape  ;5507 ;540  ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000161;Shape  ;5657 ;540  ;423  ;423   }
            { 1000000162;TextBox;5657 ;540  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[10] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19802;
            SectionHeight=30;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           IF i > 3 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           IF OldData THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000045;Shape  ;15   ;0    ;19310;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=No;
            SectionWidth=19802;
            SectionHeight=4560;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE
                           IF CurrReport.PAGENO = pNO THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 39  ;Label        ;108  ;978  ;2826 ;476  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 40  ;Label        ;100  ;1680 ;10600;423  ;FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=(1) ให้ระบุว่าจ่ายเป็นค่าอะไร เช่น ค่าเช่าอาคาร ค่าสอบบัญชี ค่าทนายความ ค่าวิชาชีพของแพทย์ ค่าก่อสร้าง รางวัลในการ }
            { 41  ;Label        ;600  ;2520 ;9400 ;423  ;FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=ประกวด การแข่งขัน การชิงโชค ค่าจ้างแสดงภาพยนตร์ ร้องเพลง ดนตรี ค่าจ้างทำของ ค่าจ้างโฆษณา ฯลฯ }
            { 42  ;Label        ;100  ;2961 ;6000 ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=(2)  เงื่อนไขการหักภาษี ให้กรอกดังนี้    - หัก ณ ที่จ่าย     กรอก 1 }
            { 43  ;Label        ;900  ;3330 ;2600 ;423  ;FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=- ออกให้ตลอดไป  กรอก 2 }
            { 44  ;Label        ;900  ;3753 ;2600 ;423  ;FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=- ออกให้ครั้งเดียว  กรอก 3 }
            { 46  ;Label        ;4600 ;0    ;8100 ;480  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมยอดเงินได้และภาษีที่นำส่ง (นำไปรวมกับใบต่อ ภ.ง.ด.3  ฉบับอื่น (ถ้ามี)) }
            { 47  ;Label        ;100  ;0    ;4000 ;480  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ให้กรอกลำดับที่ต่อเนื่องกันไปทุกแผ่น) }
            { 31  ;Label        ;12442;1440 ;700  ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ลงชื่อ }
            { 45  ;Label        ;12442;2709 ;900  ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ตำแหน่ง }
            { 48  ;Label        ;12400;3480 ;800  ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ยื่นวันที่ }
            { 49  ;Label        ;14700;3480 ;600  ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=เดือน }
            { 50  ;Label        ;17400;3480 ;600  ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=พ.ศ. }
            { 51  ;Label        ;18200;1440 ;1100 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 52  ;Shape        ;10700;450  ;30   ;4015 ;ShapeStyle=VertLine }
            { 53  ;Label        ;12442;2048 ;6800 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=(.........................................................................................) }
            { 105 ;Shape        ;14200;30   ;30   ;430  ;ShapeStyle=VertLine }
            { 111 ;Shape        ;17900;0    ;30   ;430  ;ShapeStyle=VertLine }
            { 115 ;Shape        ;16400;0    ;30   ;430  ;ShapeStyle=VertLine }
            { 122 ;Shape        ;0    ;0    ;30   ;4410 ;ShapeStyle=VertLine }
            { 133 ;Shape        ;15   ;423  ;19310;30   ;ShapeStyle=HorzLine }
            { 134 ;Shape        ;19300;0    ;30   ;4410 ;ShapeStyle=VertLine }
            { 135 ;Shape        ;15   ;4410 ;19310;30   ;ShapeStyle=HorzLine }
            { 183 ;Label        ;13100;1440 ;5100 ;423  ;VertAlign=Bottom;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................................................ }
            { 184 ;Label        ;13300;2700 ;6000 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................... }
            { 185 ;Label        ;13200;3480 ;1500 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=........................... }
            { 186 ;Label        ;15300;3480 ;2100 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................... }
            { 187 ;Label        ;18000;3480 ;1300 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=......................... }
            { 203 ;TextBox      ;14200;0    ;2200 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 204 ;TextBox      ;16400;0    ;1500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000005;Shape  ;10800;1740 ;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000006;Label  ;10850;1940 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=5;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000007;Label  ;10850;2256 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=5;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000008;Label  ;10850;2540 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=5;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 123 ;Shape        ;15   ;0    ;19310;30   ;ShapeStyle=HorzLine }
            { 1000000090;Label  ;600  ;2100 ;9400 ;423  ;FontName=Tahoma;
                                                         FontSize=6;
                                                         CaptionML=ENU=ประกวด การแข่งขัน การชิงโชค ค่าจ้างแสดงภาพยนตร์ ร้องเพลง ดนตรี ค่าจ้างทำของ ค่าจ้างโฆษณา ฯลฯ }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(4..));
        OnPreDataItem=BEGIN
                        IF OldData THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > i THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19802;
            SectionHeight=450;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN BEGIN
                             CurrReport.SHOWOUTPUT(FALSE);
                             PageHeight := PageHeight + 450;
                             //IF (8670  - PageHeight) < 450 THEN BEGIN //GKU:#004
                             IF (17820  - PageHeight) < 450 THEN BEGIN
                               PageHeight := 0;
                               pNO := pNO + 1;
                             END;
                           END;
                         END;

            OnPostSection=BEGIN
                            IF Integer1.Number <> 1 THEN BEGIN
                              TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT +
                                        WHTBaseAmtLCYExcVAT[Number];
                              TotWHTAmtLCY := TotWHTAmtLCY +
                                        WHTAmtLCY[Number];
                              TotWHTBaseAmtLCYExcVAT2 := TotWHTBaseAmtLCYExcVAT2 +
                                        WHTBaseAmtLCYExcVAT[Number];
                              TotWHTAmtLCY2 := TotWHTAmtLCY2 +
                                        WHTAmtLCY[Number];
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000023;Shape  ;19300;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000025;Shape  ;17900;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000026;Shape  ;16400;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000028;Shape  ;14200;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000029;Shape  ;13300;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000030;Shape  ;10600;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000031;Shape  ;9400 ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000032;Shape  ;1200 ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000033;Shape  ;0    ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000034;TextBox;16400;27   ;1500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[Number] }
            { 1000000035;TextBox;14200;27   ;2200 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[Number] }
            { 1000000037;TextBox;13400;27   ;800  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[Number] }
            { 1000000038;TextBox;10700;27   ;2500 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19802;
            SectionHeight=30;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000039;Shape  ;15   ;0    ;19310;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=Line Space;
        OnPreDataItem=BEGIN
                        IF SNo MOD 7 = 0 THEN
                          CurrReport.BREAK
                        ELSE
                          SETRANGE(Number,1,7 - (SNo MOD 7));
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19802;
            SectionHeight=2370;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000079;Label  ;14314;364  ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000085;Label  ;17542;1329 ;540  ;2    ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000184;Label  ;1300 ;996  ;1440 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ชื่อ - สกุล }
            { 1000000187;Label  ;2680 ;990  ;6700 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000208;Label  ;1300 ;1470 ;750  ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000209;Label  ;2050 ;1470 ;7300 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=...................................................................................................................................................................................................... }
            { 1000000211;Shape  ;0    ;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000212;Shape  ;9400 ;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000213;Shape  ;16400;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000214;Shape  ;17900;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000215;Shape  ;19300;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000216;Shape  ;13300;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000217;Shape  ;14200;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000218;Shape  ;1200 ;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000220;Shape  ;10600;0    ;30   ;2370 ;ShapeStyle=VertLine }
            { 1000000227;Label  ;2050 ;1830 ;7300 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=...................................................................................................................................................................................................... }
            { 1000000080;Shape  ;0    ;2340 ;19310;30   ;ShapeStyle=HorzLine }
            { 1000000163;Shape  ;1400 ;60   ;423  ;423   }
            { 1000000165;Shape  ;1823 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000166;Shape  ;1943 ;60   ;1692 ;423   }
            { 1000000172;Shape  ;2366 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000175;Shape  ;2789 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000176;Shape  ;2789 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000178;Shape  ;3212 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000179;Shape  ;3755 ;60   ;2115 ;423   }
            { 1000000189;Shape  ;3635 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000200;Shape  ;4178 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000202;Shape  ;4601 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000204;Shape  ;5024 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000206;Shape  ;5447 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000207;Shape  ;5870 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000210;Shape  ;5990 ;60   ;846  ;423   }
            { 1000000222;Shape  ;6410 ;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000223;Shape  ;6833 ;60   ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000224;Shape  ;6953 ;60   ;423  ;423   }
            { 1000000226;Shape  ;1400 ;510  ;423  ;423   }
            { 1000000229;Shape  ;1823 ;510  ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000230;Shape  ;1973 ;510  ;1692 ;423   }
            { 1000000233;Shape  ;2396 ;510  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000235;Shape  ;2819 ;510  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000237;Shape  ;3242 ;510  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000238;Shape  ;3665 ;510  ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000239;Shape  ;3815 ;510  ;1692 ;423   }
            { 1000000242;Shape  ;4238 ;510  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000244;Shape  ;4661 ;510  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000246;Shape  ;5084 ;510  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000247;Shape  ;5507 ;510  ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000248;Shape  ;5657 ;510  ;423  ;423   }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1000000000;TextBox;2640 ;110  ;1700 ;440  ;CaptionML=ENU=Branch;
                                                   SourceExpr=BranchNo }
      { 1000000001;Label  ;0    ;110  ;2530 ;440  ;ParentControl=1000000000 }
      { 1000000002;CheckBox;2640;660  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Test Report;
                                                   SourceExpr=PrintTest }
      { 1000000003;Label  ;0    ;660  ;2530 ;440  ;ParentControl=1000000002 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLSetup@1000000032 : Record 98;
      CompanyInfo@1000000007 : Record 79;
      Vendor@1000000006 : Record 23;
      WHTRevType@1000000044 : Record 28042;
      WHTBusPostinGrp@1000000043 : Record 28040;
      WHTEntry@1000000040 : Record 28044;
      WHTEntry2@1000000005 : Record 28044;
      NewDocNo@1000000011 : Code[20];
      Name@1000000003 : Text[150];
      Address@1000000002 : Text[250];
      Address2@1000000001 : Text[250];
      City@1000000000 : Text[30];
      VAT@1000 : ARRAY [20] OF Code[1];
      SNo@1007 : Integer;
      CId@1011 : ARRAY [20] OF Code[1];
      PId@1012 : ARRAY [20] OF Code[10];
      i@1000000004 : Integer;
      pNO@1000000008 : Integer;
      WHTTerm@1000000009 : Text[1];
      WHTExpenseType@1000000030 : ARRAY [12] OF Integer;
      WHTExpenseText@1000000010 : ARRAY [100] OF Text[30];
      "WHT%"@1000000014 : ARRAY [100] OF Decimal;
      WHTBaseAmtLCYExcVAT@1000000016 : ARRAY [100] OF Decimal;
      WHTAmtLCY@1000000015 : ARRAY [100] OF Decimal;
      TotWHTBaseAmtLCYExcVAT@1000000037 : Decimal;
      TotWHTAmtLCY@1000000036 : Decimal;
      TotWHTBaseAmtLCYExcVAT2@1000000013 : Decimal;
      TotWHTAmtLCY2@1000000012 : Decimal;
      PostingDate@1000000018 : Date;
      PageHeight@1000000028 : Integer;
      OldData@1000000035 : Boolean;
      Branch@1000000039 : ARRAY [4] OF Code[1];
      BranchNo@1000000038 : Text[4];
      MatchType@1000000034 : Boolean;
      PrintTest@1000000019 : Boolean;
      TestText@1000000017 : Text[70];
      PurchInvHeader@1000000020 : Record 122;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   Update for version 4.0 TH.
      002   20.06.2005   KKE   Update for 'Dummy Vendor' and 'VAT Registration No. (Dummy)'.
      003   09.08.2006   KKE   Sorting data by Posting Date.
      004   10.10.2007   GKU   Modify Orientation of report to Portrait
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50038 Subscriber Contract Listing
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=[ 4:34:10 PM];
    Version List=;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1500;
    Orientation=Landscape;
    PaperSize=A3 297 x 420 mm;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50011;
        DataItemTableView=SORTING(Code);
        NewPagePerGroup=Yes;
        NewPagePerRecord=Yes;
        PrintOnlyIfDetail=Yes;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        PrintOnlyIfDetail=Yes;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=39000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000003;TextBox;0    ;0    ;6300 ;423  ;FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=COMPANYNAME }
            { 1000000035;TextBox;35800;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000036;Label  ;37750;423  ;750  ;423  ;ParentControl=1000000037;
                                                         FontName=Tahoma;
                                                         FontSize=9 }
            { 1000000037;TextBox;38500;423  ;450  ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000002;Label  ;14100;0    ;10300;700  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Subscriber Contract Listing }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table50005;
        DataItemTableView=SORTING(Contract Category);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("No.");
                        RunningNo := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           RunningNo += 1 ;
                         END;

        ReqFilterFields=Magazine Code,Contract Category,Expired Date,Ending Issue Date,Starting Issue No.,Ending Issue No.;
        GroupTotalFields=Contract Category;
        DataItemLinkReference=Magazine;
        DataItemLink=Magazine Code=FIELD(Code);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=39000;
            SectionHeight=700;
          }
          CONTROLS
          {
            { 1000000005;Shape  ;0    ;430  ;39000;270  ;ShapeStyle=HorzLine }
            { 1000000026;TextBox;36700;0    ;2250 ;460  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=USERID }
            { 1000000025;TextBox;0    ;0    ;5500 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Magazine.Description }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=39000;
            SectionHeight=1792;
          }
          CONTROLS
          {
            { 1000000013;Label  ;3650 ;0    ;2450 ;846  ;ParentControl=1000000012;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Subscriber No. }
            { 1000000010;Label  ;1500 ;0    ;2000 ;846  ;ParentControl=1000000009;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contract No. }
            { 1000000008;Label  ;6150 ;0    ;4400 ;846  ;ParentControl=1000000007;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Name }
            { 1000000014;Label  ;10700;0    ;7000 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;17800;0    ;5900 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Address 2 }
            { 1000000020;Label  ;23800;0    ;4300 ;846  ;ParentControl=1000000019;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Address 3 }
            { 1000000022;Label  ;28200;0    ;3100 ;846  ;ParentControl=1000000021;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Phone }
            { 1000000029;Label  ;34700;0    ;2000 ;846  ;ParentControl=1000000024;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Start Magazine No. }
            { 1000000031;Label  ;36750;0    ;2000 ;846  ;ParentControl=1000000030;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=End Magazine No. }
            { 1000000006;Shape  ;0    ;1000 ;39000;300  ;ShapeStyle=HorzLine }
            { 1000000032;Label  ;0    ;0    ;1400 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Line No. }
            { 1000000004;Label  ;32700;0    ;1900 ;846  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contract Issue No. }
            { 1000000033;Label  ;31100;0    ;1600 ;846  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contract Quantity }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=39000;
            SectionHeight=600;
            OnPreSection=BEGIN
                           IF NewPageperContractCategory AND (RunningNo <> 1)  THEN
                             CurrReport.NEWPAGE ;

                           RunningNo := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000028;TextBox;3000 ;0    ;2850 ;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr="Contract Category" }
            { 1000000023;Label  ;100  ;0    ;2900 ;400  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contact Category : }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=39000;
            SectionHeight=900;
            OnPreSection=BEGIN
                           TotalRecord := RunningNo;
                         END;

          }
          CONTROLS
          {
            { 1000000015;TextBox;2400 ;200  ;10800;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=STRSUBSTNO(Text000,TotalRecord ,"Subscriber Contract"."Contract Category") }
            { 1000000016;Shape  ;0    ;0    ;39000;200  ;ShapeStyle=HorzLine }
            { 1000000027;Shape  ;0    ;700  ;39000;200  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table50001;
        DataItemTableView=SORTING(No.);
        DataItemLink=No.=FIELD(Subscriber No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=39000;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000000;TextBox;100  ;100  ;1200 ;430  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=RunningNo }
            { 1000000009;TextBox;1500 ;100  ;2000 ;430  ;HorzAlign=Left;
                                                         FontName=tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."No." }
            { 1000000012;TextBox;3700 ;100  ;2400 ;430  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Subscriber No." }
            { 1000000021;TextBox;28200;100  ;3500 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Subscriber."Phone No." + '  '+ Subscriber."Mobile No." }
            { 1000000019;TextBox;23800;100  ;4300 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Subscriber."Address 3" }
            { 1000000017;TextBox;17800;100  ;5900 ;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Subscriber."Address 2" }
            { 1000000011;TextBox;10700;100  ;7000 ;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Address 1;
                                                         SourceExpr=Subscriber."Address 1" }
            { 1000000007;TextBox;6200 ;100  ;4400 ;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Subscriber.Name }
            { 1000000024;TextBox;34700;100  ;2000 ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Starting Magazine Item No." }
            { 1000000030;TextBox;36800;100  ;2000 ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Ending Magazine Item No." }
            { 1000000001;TextBox;32800;100  ;1800 ;430  ;HorzAlign=Left;
                                                         FontName=tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Contract Issue No." }
            { 1000000034;TextBox;31900;100  ;800  ;430  ;HorzAlign=Left;
                                                         FontName=tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Contract Quantity" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=8470;
      Height=1430;
      OnOpenForm=BEGIN
                   NewPageperContractCategory := TRUE;
                 END;

    }
    CONTROLS
    {
      { 1000000001;CheckBox;6270;220  ;440  ;440  ;InPage=-1;
                                                   ShowCaption=No;
                                                   SourceExpr=NewPageperContractCategory }
      { 1000000002;Label  ;440  ;220  ;5610 ;440  ;ParentControl=1000000001;
                                                   CaptionML=ENU=New Page per Contract Category }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Pagex@1000000000 : TextConst 'ENU=Page';
      LastFieldNo@1000000001 : Integer;
      FooterPrinted@1000000002 : Boolean;
      RunningNo@1000000003 : Integer;
      NewPageperContractCategory@1000000004 : Boolean;
      Text000@1000000005 : TextConst 'ENU="Total Counting ===> %1 contracts (%2)";THA="รวมสมาชิก ===> %1 คน (%2)"';
      Detail@1000000006 : Text[30];
      TotalRecord@1000000007 : Decimal;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50039 Subscriber Contract - Labels
{
  OBJECT-PROPERTIES
  {
    Date=02/12/08;
    Time=[ 5:04:15 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    RightMargin=1000;
    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table37;
        DataItemTableView=SORTING(Document Type,Document No.,Line No.);
        OnPreDataItem=BEGIN
                        NoOfRecords := COUNT;
                        NoOfColumns := 2;
                      END;

        OnAfterGetRecord=BEGIN
                           RecordNo := RecordNo + 1;
                           ColumnNo := ColumnNo + 1;

                           SubscriContract.RESET;
                           SubscriContract.SETCURRENTKEY("No.");
                           SubscriContract.SETRANGE("No.", "Subscriber Contract No.");

                           IF SubscriContract.FIND('-') THEN
                             BEGIN
                             Subscri.RESET;
                             Subscri.SETCURRENTKEY("No.");
                             Subscri.SETRANGE("No.", SubscriContract."Subscriber No.");
                             Subscri.FIND('-');
                             Addr[ColumnNo][1] := FORMAT(Subscri.Name);
                             Addr[ColumnNo][2] := FORMAT(Subscri."Address 1");
                             Addr[ColumnNo][3] := FORMAT(Subscri."Address 2");
                             Addr[ColumnNo][4] := FORMAT(Subscri."Address 3");

                             COMPRESSARRAY(Addr[ColumnNo]);

                             IF RecordNo = NoOfRecords THEN BEGIN
                               FOR i := ColumnNo + 1 TO NoOfColumns DO
                                 CLEAR(Addr[i]);
                               ColumnNo := 0;
                             END ELSE BEGIN
                               IF ColumnNo = NoOfColumns THEN
                                 ColumnNo := 0;
                             END;
                           END;
                         END;

        ReqFilterFields=Document Type,Document No.,Line No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18700;
            SectionHeight=4300;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(ColumnNo = 0);
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;10300;2300 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][4] }
            { 1000000007;TextBox;10300;1800 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][3] }
            { 1000000006;TextBox;10300;1300 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][2] }
            { 1000000005;TextBox;10300;800  ;5700 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][1] }
            { 1000000004;TextBox;700  ;2300 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][4] }
            { 1000000003;TextBox;700  ;1800 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][3] }
            { 1000000002;TextBox;700  ;1300 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][2] }
            { 1000000001;TextBox;700  ;800  ;5700 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][1] }
            { 1000000000;TextBox;6400 ;800  ;2100 ;500  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SubscriContract."Subscriber No." }
            { 1000000009;TextBox;16000;800  ;2100 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SubscriContract."Subscriber No." }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=8580;
      Height=2640;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Addr@1000000000 : ARRAY [2,4] OF Text[250];
      NoOfRecords@1000000001 : Integer;
      RecordNo@1000000002 : Integer;
      NoOfColumns@1000000003 : Integer;
      ColumnNo@1000000004 : Integer;
      i@1000000005 : Integer;
      Subscri@1000000006 : Record 50001;
      SubscriContract@1000000007 : Record 50005;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50040 Circulation Billing
{
  OBJECT-PROPERTIES
  {
    Date=08/29/07;
    Time=10:02:38 AM;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  CompanyInfo.GET;
                  CompanyInfo.CALCFIELDS(Picture);
                  FormatAddr.Company(CompanyAddr,CompanyInfo);
                  IF CompanyInfo."Company Name (Thai)" = '' THEN
                    CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                  tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                  tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                  tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                  tmpCompanyAddr[2] := CompanyInfo."Address 3";

                  MagazineSalesSetup.GET;
                  MagazineSalesSetup.TESTFIELD("Circulation Billing Nos.");
                END;

    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table18;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        OnAfterGetRecord=BEGIN
                           SalesInvLineTmp.DELETEALL;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table21;
        DataItemTableView=SORTING(Customer No.,Posting Date)
                          WHERE(Document Type=FILTER(Invoice|Credit Memo));
        PrintOnlyIfDetail=Yes;
        OnAfterGetRecord=BEGIN
                           IF ("Document Type" = "Document Type"::Invoice) AND (Open = FALSE) THEN
                             CurrReport.SKIP;
                         END;

        ReqFilterFields=Customer No.,Posting Date;
        GroupTotalFields=Customer No.;
        DataItemLink=Customer No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table113;
        DataItemTableView=SORTING(Bill-to Customer No.,Type,No.)
                          WHERE(Type=CONST(Item),
                                Quantity=FILTER(<>0));
        OnPreDataItem=BEGIN
                        IF "Cust. Ledger Entry"."Document Type" <> "Cust. Ledger Entry"."Document Type"::Invoice THEN
                          CurrReport.BREAK;

                        //TSA002
                        CALCFIELDS("Last Pick-up Date");
                        IF LastPickupDate <> 0D THEN
                          SETFILTER("Last Pick-up Date",'<=%1',LastPickupDate)
                        //TSA002
                      END;

        TotalFields=Quantity,Line Amount;
        GroupTotalFields=No.;
        DataItemLink=Bill-to Customer No.=FIELD(Customer No.),
                     Document No.=FIELD(Document No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19430;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FALSE;
                           SalesInvLineTmp := "Sales Invoice Line";
                           SalesInvLineTmp.INSERT;
                         END;

          }
          CONTROLS
          {
            { 1000000044;Label  ;0    ;0    ;6100 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         ForeColor=255;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION. }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table115;
        DataItemTableView=SORTING(Bill-to Customer No.,Type,No.)
                          WHERE(Type=CONST(Item),
                                Quantity=FILTER(<>0));
        OnPreDataItem=BEGIN
                        IF "Cust. Ledger Entry"."Document Type" <> "Cust. Ledger Entry"."Document Type"::"Credit Memo" THEN
                          CurrReport.BREAK;

                        //TSA002
                        CALCFIELDS("Last Pick-up Date");
                        IF LastPickupDate <> 0D THEN
                          SETFILTER("Last Pick-up Date",'<=%1',LastPickupDate)
                        //TSA002
                      END;

        TotalFields=Quantity,Line Amount;
        GroupTotalFields=No.;
        DataItemLink=Bill-to Customer No.=FIELD(Customer No.),
                     Document No.=FIELD(Document No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19430;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FALSE;

                           SalesInvLineTmp.RESET;
                           SalesInvLineTmp.SETRANGE(Type,Type);
                           SalesInvLineTmp.SETRANGE("No.","No.");
                           IF SalesInvLineTmp.FIND('-') THEN BEGIN
                             SalesInvLineTmp.Quantity := SalesInvLineTmp.Quantity - "Sales Cr.Memo Line".Quantity;
                             SalesInvLineTmp."Line Amount" := SalesInvLineTmp."Line Amount" - "Sales Cr.Memo Line"."Line Amount";
                             SalesInvLineTmp.MODIFY;
                           END ELSE BEGIN
                             SalesInvLineTmp.TRANSFERFIELDS("Sales Cr.Memo Line");
                             SalesInvLineTmp.Quantity := -"Sales Cr.Memo Line".Quantity;
                             SalesInvLineTmp."Line Amount" := -"Sales Cr.Memo Line"."Line Amount";
                             SalesInvLineTmp.INSERT;
                           END;
                           SalesInvLineTmp.RESET;
                         END;

          }
          CONTROLS
          {
            { 1000000045;Label  ;0    ;0    ;6100 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         ForeColor=255;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION. }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=Detail;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,SalesInvLineTmp.COUNT);
                        TotalAmount := 0;
                        NetAmount := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             SalesInvLineTmp.FIND('-')
                           ELSE
                             SalesInvLineTmp.NEXT;

                           IF SalesInvLineTmp.Quantity <> 0 THEN
                             UnitPriceAfterDisc := SalesInvLineTmp."Line Amount"/SalesInvLineTmp.Quantity
                           ELSE
                             UnitPriceAfterDisc := 0;
                           LineAmount := SalesInvLineTmp."Line Amount";
                           TotalAmount += LineAmount;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19430;
            SectionHeight=5800;
            OnPreSection=BEGIN
                           IF NOT CurrReport.PREVIEW THEN
                             BillingNo := NoSeriesMgnt.GetNextNo(MagazineSalesSetup."Circulation Billing Nos.",WORKDATE,TRUE)
                           ELSE
                             BillingNo := NoSeriesMgnt.GetNextNo(MagazineSalesSetup."Circulation Billing Nos.",WORKDATE,FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000003;TextBox;5900 ;0    ;13200;800  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000005;PictureBox;0 ;0    ;5700 ;2300 ;SourceExpr=CompanyInfo.Picture }
            { 1000000007;Label  ;5900 ;800  ;5950 ;850  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบรับคืนสินค้า/ใบวางบิล }
            { 1000000018;TextBox;0    ;2300 ;12200;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=tmpCompanyAddrTH[1] + ' ' + tmpCompanyAddrTH[2] }
            { 1000000021;TextBox;0    ;2800 ;12200;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=tmpCompanyAddr[1] + ' ' + tmpCompanyAddr[2] }
            { 1000000022;TextBox;0    ;3300 ;12200;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000025;TextBox;0    ;3800 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000017;TextBox;14200;2700 ;4900 ;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=BillingNo }
            { 1000000024;TextBox;14200;3300 ;3600 ;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=WORKDATE }
            { 1000000016;Label  ;12900;2700 ;1200 ;630  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000023;Label  ;12900;3300 ;1200 ;630  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000001;TextBox;1600 ;4470 ;13700;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Customer.Name + Customer."Name 2" }
            { 1000000000;Label  ;0    ;4470 ;1600 ;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อลูกค้า : }
            { 1000000019;Label  ;0    ;5070 ;1100 ;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ที่อยู่ : }
            { 1000000020;TextBox;1100 ;5070 ;14200;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Customer.Address + Customer."Address 2" + Customer."Address 3" }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19430;
            SectionHeight=1130;
          }
          CONTROLS
          {
            { 1000000009;Label  ;100  ;115  ;1100 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลำดับที่ }
            { 1000000010;Label  ;1500 ;115  ;2100 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000011;Label  ;8600 ;115  ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนส่ง }
            { 1000000012;Label  ;10500;115  ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนคืน }
            { 1000000013;Label  ;12400;115  ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนขาย }
            { 1000000014;Label  ;14300;115  ;1900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ราคา/หน่วย }
            { 1000000015;Label  ;16400;115  ;2700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงิน(บาท) }
            { 1000000026;Shape  ;15   ;0    ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000027;Shape  ;15   ;1100 ;19200;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000028;Shape  ;0    ;15   ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000029;Shape  ;1300 ;15   ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000030;Shape  ;8500 ;15   ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000031;Shape  ;10400;15   ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000032;Shape  ;12300;15   ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000033;Shape  ;14150;15   ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000034;Shape  ;16300;15   ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000035;Shape  ;19200;15   ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19430;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000002;TextBox;1500 ;0    ;6900 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SalesInvLineTmp."Document No." + ' ' + SalesInvLineTmp.Description }
            { 1000000006;TextBox;8600 ;0    ;1700 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SalesInvLineTmp.Quantity }
            { 1000000008;TextBox;100  ;0    ;1100 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Number }
            { 1000000036;Shape  ;19200;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000037;Shape  ;16300;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000038;Shape  ;14150;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000039;Shape  ;12300;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000040;Shape  ;10400;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000041;Shape  ;8500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000042;Shape  ;1300 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000043;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000047;Shape  ;15   ;700  ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000004;TextBox;14300;0    ;1900 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=UnitPriceAfterDisc }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        IF SalesInvLineTmp.COUNT = 0 THEN
                          CurrReport.BREAK;
                        SETRANGE(Number,1,15-SalesInvLineTmp.COUNT);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19430;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000052;Shape  ;19200;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000053;Shape  ;16300;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000054;Shape  ;14150;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000055;Shape  ;12300;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000056;Shape  ;10400;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000057;Shape  ;8500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000076;Shape  ;1300 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000083;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000085;Shape  ;15   ;700  ;19200;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnPreDataItem=BEGIN
                        IF SalesInvLineTmp.COUNT = 0 THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           NetAmount := TotalAmount;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19430;
            SectionHeight=3000;
          }
          CONTROLS
          {
            { 1000000048;TextBox;0    ;100  ;11800;700  ;FontName=CordiaUPC;
                                                         FontSize=15;
                                                         SourceExpr='โปรดสั่งจ่ายเช็คขีดคร่อมในนาม บริษัท เบอร์ด้า(ประเทศไทย) จำกัด' }
            { 1000000058;Label  ;0    ;800  ;11800;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=Please issue a cressed cheque for Burda (Thailand) Co., Ltd. }
            { 1000000059;Label  ;12700;100  ;3500 ;700  ;FontName=CordiaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รวมจำนวนเงิน }
            { 1000000060;Label  ;12700;900  ;1000 ;700  ;FontName=CordiaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หัก }
            { 1000000061;Label  ;13700;900  ;2500 ;700  ;FontName=CordiaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ตกค้าง }
            { 1000000062;Label  ;12700;1700 ;3500 ;700  ;FontName=CordiaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงินสุทธิ }
            { 1000000063;Shape  ;19200;0    ;30   ;2400 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000064;Shape  ;16300;0    ;30   ;2400 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000065;Shape  ;0    ;1500 ;11800;800  ;BorderWidth=1pt }
            { 1000000066;Label  ;0    ;2300 ;11800;700  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รวมเงินทั้งสิ้น (ตัวอักษร) }
            { 1000000067;Shape  ;16315;800  ;2900 ;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000068;Shape  ;16315;1600 ;2900 ;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000069;Shape  ;16315;2400 ;2900 ;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19430;
            SectionHeight=4900;
          }
          CONTROLS
          {
            { 1000000073;Label  ;600  ;700  ;18700;700  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เช็คธนาคาร.....................................................เลขที่........................................ลงวันที่....................................จำนวนเงิน....................................... }
            { 1000000071;Label  ;600  ;0    ;4300 ;700  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เงินสด }
            { 1000000074;Label  ;600  ;1400 ;18700;700  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ผู้รับเงิน.......................................................... }
            { 1000000070;Shape  ;0    ;100  ;500  ;500  ;BorderWidth=1pt }
            { 1000000072;Shape  ;0    ;800  ;500  ;500  ;BorderWidth=1pt }
            { 1000000075;Label  ;100  ;2100 ;19200;700  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ในกรณีที่ชำระด้วยเช็คจะสมบูรณ์ต่อเมื่อเช็คเรียกเก็บเงินได้แล้ว/This receipt shall be valid when above indicated cheque is cleared by the bank. }
            { 1000000077;Label  ;100  ;3500 ;5900 ;700  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลงชื่อ................................................ผู้ส่งคืน }
            { 1000000078;Label  ;6200 ;3500 ;5900 ;700  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลงชื่อ................................................ผู้รับคืน }
            { 1000000079;Label  ;12400;3500 ;6900 ;700  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลงชื่อ................................................เจ้าหน้าที่สโตร์ }
            { 1000000080;Label  ;100  ;4200 ;5900 ;700  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=............/............/............ }
            { 1000000081;Label  ;6200 ;4200 ;5900 ;700  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=............/............/............ }
            { 1000000082;Label  ;12400;4200 ;5900 ;700  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=............/............/............ }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1000000000;TextBox;3520 ;110  ;2090 ;440  ;CaptionML=ENU=Last Pick-up Date;
                                                   SourceExpr=LastPickupDate }
      { 1000000001;Label  ;110  ;110  ;3300 ;440  ;ParentControl=1000000000 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000001 : Record 79;
      SalesInvLineTmp@1000000009 : TEMPORARY Record 113;
      MagazineSalesSetup@1000000006 : Record 50007;
      FormatAddr@1000000004 : Codeunit 365;
      NoSeriesMgnt@1000000007 : Codeunit 396;
      LastPickupDate@1000000000 : Date;
      CompanyAddr@1000000005 : ARRAY [8] OF Text[50];
      tmpCompanyAddr@1000000003 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000002 : ARRAY [2] OF Text[250];
      BillingNo@1000000008 : Code[20];
      UnitPriceAfterDisc@1000000010 : Decimal;
      LineAmount@1000000011 : Decimal;
      TotalAmount@1000000012 : Decimal;
      NetAmount@1000000013 : Decimal;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   26.04.2007   KKE   New Report Circulation Billing - Circulation Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50041 Circulation Receipt
{
  OBJECT-PROPERTIES
  {
    Date=01/17/08;
    Time=12:05:13 PM;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  CASE Payment OF
                    Payment::Cash:
                      P[1] := 'P';
                    Payment::Cheque:
                      P[2] := 'P';
                  END;
                END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50043;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        OnPreDataItem=BEGIN
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                      END;

        OnAfterGetRecord=BEGIN
                           IF Cust.GET("Customer No.") THEN BEGIN
                             BillToName := Cust."Name (Thai)";
                             IF BillToName = '' THEN
                               BillToName := Cust.Name + Cust."Name 2";

                             BillToAddress := Cust."Address (Thai)";
                             IF BillToAddress = '' THEN
                               BillToAddress := Cust.Address + ' ' + Cust."Address 2" + ' ' + Cust."Address 3";
                           END;

                           i := 0;
                           CntLine := 0;
                           TotalAmtText := '';
                           TotalAmt := 0;

                           IF NOT CurrReport.PREVIEW THEN BEGIN
                             "No. Printed" += 1;
                             MODIFY;
                           END;
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=PageLoop;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=8300;
          }
          CONTROLS
          {
            { 1000000022;TextBox;0    ;2400 ;7300 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000021;TextBox;0    ;3800 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000024;TextBox;0    ;1400 ;6000 ;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=tmpCompanyAddr[1] + ' ' + tmpCompanyAddr[2] }
            { 1000000027;TextBox;0    ;700  ;8000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=tmpCompanyAddrTH[1] }
            { 1000000029;Label  ;8400 ;1100 ;6050 ;850  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=" ใบเสร็จรับเงิน/RECEIPT" }
            { 1000000030;TextBox;0    ;0    ;6000 ;400  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000003;TextBox;14700;4700 ;3700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Circulation Receipt Header"."No." }
            { 1000000025;Label  ;13400;4700 ;1200 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000009;Shape  ;0    ;4600 ;12400;3600  }
            { 1000000005;TextBox;2700 ;4700 ;7500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Circulation Receipt Header"."Customer No." }
            { 1000000007;Label  ;100  ;4700 ;2600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อและที่อยู่ลูกค้า }
            { 1000000004;TextBox;14700;5400 ;3700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Circulation Receipt Header"."Document Date" }
            { 1000000006;TextBox;600  ;5400 ;11500;2100 ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=BillToName + '\' + BillToAddress }
            { 1000000026;Label  ;13400;5400 ;1200 ;630  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000012;Label  ;100  ;7500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อผู้ที่ติดต่อ }
            { 1000000010;TextBox;2100 ;7500 ;10000;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Circulation Receipt Header".Contact }
            { 1000000028;TextBox;0    ;1900 ;6000 ;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=tmpCompanyAddr[2] }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=1015;
          }
          CONTROLS
          {
            { 1000000013;Shape  ;15   ;0    ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000015;Shape  ;15   ;985  ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000016;Shape  ;0    ;0    ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000018;Shape  ;1300 ;0    ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000019;Shape  ;9700 ;0    ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000031;Shape  ;11800;0    ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000032;Shape  ;14100;0    ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000033;Shape  ;16000;0    ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000034;Shape  ;19100;0    ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000035;Label  ;100  ;100  ;1100 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลำดับที่ }
            { 1000000036;Label  ;1500 ;100  ;7600 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000037;Label  ;10000;100  ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวน }
            { 1000000038;Label  ;14200;100  ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ส่วนลด }
            { 1000000039;Label  ;12000;100  ;2000 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หน่วยละ }
            { 1000000040;Label  ;16100;100  ;2900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงิน(บาท) }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000098;TextBox;1400 ;0    ;8200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CirReceiptLine.Description }
            { 1000000102;TextBox;16100;0    ;2900 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=CirReceiptLine."Line Amount Incl. VAT" }
            { 1000000104;Shape  ;19100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000105;Shape  ;16000;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000106;Shape  ;14100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000107;Shape  ;11800;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000108;Shape  ;9700 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000109;Shape  ;1300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000110;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000103;Label  ;0    ;0    ;1300 ;600  ;Visible=No;
                                                         ForeColor=255;
                                                         CaptionML=ENU=Payment }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=1000;
          }
          CONTROLS
          {
            { 1000000001;TextBox;16100;0    ;2900 ;800  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalAmt }
            { 1000000002;TextBox;100  ;0    ;11700;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         SourceExpr=TotalAmtText }
            { 1000000068;Shape  ;19100;0    ;30   ;800  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;16000;0    ;30   ;800  ;ShapeStyle=VertLine }
            { 1000000071;Shape  ;11800;0    ;30   ;800  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;0    ;0    ;30   ;800  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;15   ;0    ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000076;Shape  ;15   ;785  ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000077;Label  ;11900;0    ;4100 ;800  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รวมราคาทั้งสิ้น/Grand Total }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=3800;
          }
          CONTROLS
          {
            { 1000000042;Label  ;0    ;0    ;900  ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ชำระ }
            { 1000000044;Shape  ;1100 ;0    ;500  ;500   }
            { 1000000046;Label  ;1700 ;0    ;2600 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เงินสด/Cash มูลค่า }
            { 1000000048;Shape  ;1100 ;700  ;500  ;500   }
            { 1000000050;Label  ;1700 ;700  ;2500 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เช็คธนาคาร/Bank }
            { 1000000052;Label  ;7300 ;700  ;2000 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=สาขา/Branch }
            { 1000000070;Label  ;12700;0    ;6200 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ในนาม บริษัทเบอร์ด้า (ประเทศไทย) จำกัด }
            { 1000000072;Label  ;12700;2200 ;6200 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลายเซ็นผู้มีอำนาจลงนาม }
            { 1000000073;Shape  ;12700;1900 ;6200 ;300  ;ShapeStyle=HorzLine }
            { 1000000078;Shape  ;4300 ;400  ;7100 ;200  ;ShapeStyle=HorzLine }
            { 1000000079;Shape  ;4200 ;1100 ;3000 ;200  ;ShapeStyle=HorzLine }
            { 1000000080;Shape  ;9300 ;1100 ;2100 ;200  ;ShapeStyle=HorzLine }
            { 1000000081;Label  ;1700 ;1500 ;3000 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เช็คเลขที่/Cheque No. }
            { 1000000082;Label  ;7800 ;1500 ;1500 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=วันที่/Date }
            { 1000000083;Shape  ;4700 ;1900 ;3100 ;200  ;ShapeStyle=HorzLine }
            { 1000000084;Shape  ;9300 ;1900 ;2100 ;200  ;ShapeStyle=HorzLine }
            { 1000000085;Label  ;1700 ;2500 ;1800 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลงชื่อผู้รับเงิน }
            { 1000000086;Shape  ;3500 ;2800 ;5300 ;300  ;ShapeStyle=HorzLine }
            { 1000000087;Label  ;0    ;3200 ;1300 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         FontUnderline=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000088;Label  ;1300 ;3200 ;17600;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=การชำระเงินจะถือว่าสมบูรณ์ต่อเมื่อมีลายมือชื่อของผู้รับมอบอำนาจ และของผู้รับเงินกำกับ และบริษัทได้เรียกเก็บเงินจากธนาคารตามเช็คเรียบร้อยแล้ว }
            { 1000000091;TextBox;4400 ;0    ;6900 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Cash }
            { 1000000092;TextBox;4300 ;700  ;2800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Bank }
            { 1000000093;TextBox;4800 ;1500 ;2800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=ChequeNo }
            { 1000000094;TextBox;9400 ;1500 ;1900 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=ChequeDate }
            { 1000000095;TextBox;9400 ;700  ;1900 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Branch }
            { 1000000096;TextBox;1200 ;0    ;500  ;600  ;HorzAlign=Left;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         SourceExpr=P[1] }
            { 1000000097;TextBox;1200 ;700  ;500  ;600  ;HorzAlign=Left;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         SourceExpr=P[2] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table50044;
        DataItemTableView=SORTING(Circulation Receipt No.,Document Type,Type,No.,Document No.)
                          WHERE(Document Type=FILTER(<>Payment));
        OnAfterGetRecord=BEGIN
                           DocType := '';
                           CASE "Document Type" OF
                             "Document Type"::Invoice:
                               DocType := 'ใบแจ้งหนี้ เลขที่ ';
                             "Document Type"::"Credit Memo":
                               DocType := 'ใบลดหนี้ เลขที่ ';
                           END;
                           i += 1;
                           CntLine += 1;

                           IF "Deposit Amount" <> 0 THEN
                             TotalAmt += "Deposit Amount"
                           ELSE
                             TotalAmt += "Line Amount Incl. VAT";
                         END;

        TotalFields=Line Amount Incl. VAT;
        DataItemLinkReference=Circulation Receipt Header;
        DataItemLink=Circulation Receipt No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := (NOT ReceiptFirst50Percent) OR ("Deposit Amount" = 0);
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;1400 ;0    ;8200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=DocType + ' ' + "Document No." }
            { 1000000014;TextBox;9800 ;0    ;1900 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Quantity }
            { 1000000017;TextBox;11900;0    ;2100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Unit Price" }
            { 1000000020;TextBox;14200;0    ;1700 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Discount }
            { 1000000023;TextBox;16100;0    ;2900 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Line Amount Incl. VAT" }
            { 1000000000;TextBox;100  ;0    ;1100 ;600  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=i }
            { 1000000061;Shape  ;19100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000062;Shape  ;16000;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000063;Shape  ;14100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000064;Shape  ;11800;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;9700 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;1300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ReceiptFirst50Percent AND ("Deposit Amount" <> 0);
                         END;

          }
          CONTROLS
          {
            { 1000000099;TextBox;1400 ;0    ;8200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Description 2" }
            { 1000000111;TextBox;16100;0    ;2900 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Deposit Amount" }
            { 1000000112;TextBox;100  ;0    ;1100 ;600  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=i }
            { 1000000113;Shape  ;19100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000114;Shape  ;16000;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000115;Shape  ;14100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000116;Shape  ;11800;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000117;Shape  ;9700 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000118;Shape  ;1300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000119;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000011;TextBox;1400 ;0    ;8200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000054;Shape  ;19100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000055;Shape  ;16000;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;14100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000057;Shape  ;11800;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000058;Shape  ;9700 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000059;Shape  ;1300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000060;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000089;Shape  ;15   ;0    ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000090;Label  ;17400;0    ;1600 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := (21 - CntLine*2) <= 0;
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000120;Shape  ;0    ;0    ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000121;Label  ;17385;0    ;1600 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=0;
            OnPreSection=BEGIN
                           IF CntLine = 0 THEN
                           CurrReport.NEWPAGE;
                         END;

          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        //SETRANGE(Number,1,18 - CntLine*2);
                        IF CntLine*2 > 16 THEN
                          SETRANGE(Number,1,16+24-CntLine*2)
                        ELSE
                          SETRANGE(Number,1,16-CntLine*2);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000041;Shape  ;19100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000043;Shape  ;16000;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000045;Shape  ;14100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000047;Shape  ;11800;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000049;Shape  ;9700 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000051;Shape  ;1300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000053;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000122;Shape  ;0    ;0    ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000123;Label  ;17385;0    ;1600 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnPreDataItem=BEGIN
                        CirReceiptLine.SETRANGE("Circulation Receipt No.","Circulation Receipt Header"."No.");
                        CirReceiptLine.SETRANGE("Document Type",CirReceiptLine."Document Type"::Payment);
                        IF NOT CirReceiptLine.FIND('-') THEN
                          CLEAR(CirReceiptLine);

                        PaymentAmt := CirReceiptLine."Line Amount Incl. VAT";
                      END;

        OnAfterGetRecord=BEGIN
                           TotalAmt += PaymentAmt;
                           IF "Circulation Receipt Line"."Line Amount Incl. VAT" <> 0 THEN
                             TotalAmtText := '(' + Form50BIS.FormatNoThaiText(ABS(TotalAmt)) + ')';
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := LineSpace.COUNT = 0;
                         END;

          }
          CONTROLS
          {
            { 1000000100;Shape  ;0    ;0    ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000101;Label  ;17385;0    ;1600 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=10560;
      Height=2860;
    }
    CONTROLS
    {
      { 1000000000;TextBox;3470 ;220  ;6900 ;600  ;HorzAlign=Left;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   SourceExpr=Cash }
      { 1000000002;Label  ;6370 ;990  ;2000 ;600  ;HorzAlign=Left;
                                                   VertAlign=Bottom;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   FontBold=No;
                                                   MultiLine=Yes;
                                                   CaptionML=ENU=สาขา/Branch }
      { 1000000003;TextBox;8470 ;990  ;1900 ;600  ;HorzAlign=Left;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   SourceExpr=Branch }
      { 1000000004;TextBox;3370 ;990  ;2800 ;600  ;HorzAlign=Left;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   SourceExpr=Bank }
      { 1000000005;Label  ;770  ;220  ;2600 ;600  ;HorzAlign=Left;
                                                   VertAlign=Bottom;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   FontBold=No;
                                                   MultiLine=Yes;
                                                   CaptionML=ENU=เงินสด/Cash มูลค่า }
      { 1000000008;Label  ;770  ;990  ;2500 ;600  ;HorzAlign=Left;
                                                   VertAlign=Bottom;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   FontBold=No;
                                                   MultiLine=Yes;
                                                   CaptionML=ENU=เช็คธนาคาร/Bank }
      { 1000000011;Label  ;770  ;1760 ;3000 ;600  ;HorzAlign=Left;
                                                   VertAlign=Bottom;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   FontBold=No;
                                                   MultiLine=Yes;
                                                   CaptionML=ENU=เช็คเลขที่/Cheque No. }
      { 1000000012;Label  ;6870 ;1760 ;1500 ;600  ;HorzAlign=Left;
                                                   VertAlign=Bottom;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   FontBold=No;
                                                   MultiLine=Yes;
                                                   CaptionML=ENU=วันที่/Date }
      { 1000000013;TextBox;3870 ;1760 ;2800 ;600  ;HorzAlign=Left;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   SourceExpr=ChequeNo }
      { 1000000014;TextBox;8470 ;1760 ;1900 ;600  ;HorzAlign=Left;
                                                   FontName=CordiaUPC;
                                                   FontSize=13;
                                                   SourceExpr=ChequeDate }
      { 1000000017;OptionButton;220;220;440 ;600  ;ShowCaption=No;
                                                   SourceExpr=Payment;
                                                   OptionValue=Cash }
      { 1000000018;OptionButton;220;990;440 ;600  ;ShowCaption=No;
                                                   SourceExpr=Payment;
                                                   OptionValue=Cheque }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000007 : Record 79;
      Cust@1000000005 : Record 18;
      Form50BIS@1000000002 : Report 50002;
      FormatAddr@1000000011 : Codeunit 365;
      CompanyAddr@1000000010 : ARRAY [8] OF Text[50];
      tmpCompanyAddr@1000000009 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000008 : ARRAY [2] OF Text[250];
      BillToName@1000000004 : Text[500];
      BillToAddress@1000000003 : Text[500];
      TotalAmtText@1000000001 : Text[500];
      DocType@1000000006 : Text[30];
      CntLine@1000000000 : Integer;
      i@1000000012 : Integer;
      Cash@1000000013 : Text[30];
      Bank@1000000014 : Text[30];
      Branch@1000000015 : Text[30];
      ChequeNo@1000000016 : Text[30];
      ChequeDate@1000000017 : Date;
      Payment@1000000018 : ' ,Cash,Cheque';
      P@1000000019 : ARRAY [2] OF Text[1];
      CirReceiptLine@1000000020 : Record 50044;
      ReceiptFirst50Percent@1000000021 : Boolean;
      TotalAmt@1000000022 : Decimal;
      PaymentAmt@1000000023 : Decimal;

    PROCEDURE InitRequest@1000000000("_ReceiptFirst50%"@1000000000 : Boolean);
    BEGIN
      ReceiptFirst50Percent := "_ReceiptFirst50%";
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.04.2007   KKE   New report Circulation Receipt - Circulation Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50042 Circulation Sales Summary
{
  OBJECT-PROPERTIES
  {
    Date=05/08/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    RightMargin=0;
    OnPreReport=BEGIN
                  DateFilter := Customer.GETFILTER("Date Filter");
                  CustFilter := Customer.GETFILTERS;
                  ItemFilter := "Sales Invoice Line".GETFILTER("No.");
                END;

    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table18;
        DataItemTableView=SORTING(Customer Posting Group,No.);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(InvoiceQty,InvoiceAmount,CreMemoQty,CreMemoAmount);
                      END;

        ReqFilterFields=Customer Posting Group,No.,Date Filter;
        GroupTotalFields=Customer Posting Group,No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19300;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Circulation Sales Summary }
            { 1000000002;TextBox;16050;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;846  ;9900 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;18750;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;18000;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;16950;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1000000052;TextBox;16050;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Circulation Sales Summary") }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := CustFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',Customer.TABLECAPTION,CustFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19300;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ItemFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000015;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',Item.TABLECAPTION,ItemFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19300;
            SectionHeight=1500;
          }
          CONTROLS
          {
            { 1000000022;Label  ;16600;300  ;2700 ;846  ;ParentControl=1000000021;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000020;Label  ;14600;300  ;1900 ;846  ;ParentControl=1000000019;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Net Price }
            { 1000000018;Label  ;12700;300  ;1800 ;846  ;ParentControl=1000000017;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000013;Label  ;7800 ;300  ;4800 ;846  ;ParentControl=1000000012;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000011;Label  ;5200 ;300  ;2500 ;846  ;ParentControl=1000000010;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Item }
            { 1000000007;Label  ;2500 ;300  ;1050 ;846  ;VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Doc. Type }
            { 1000000027;Shape  ;0    ;0    ;19300;300  ;ShapeStyle=HorzLine }
            { 1000000028;Shape  ;0    ;1169 ;19300;331  ;ShapeStyle=HorzLine }
            { 1000000045;Label  ;3700 ;300  ;1350 ;846  ;ParentControl=1000000044;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000053;Label  ;200  ;300  ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Document No. }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19300;
            SectionHeight=700;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("Customer Posting Group");
                         END;

          }
          CONTROLS
          {
            { 1000000009;TextBox;0    ;100  ;14600;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr=['Customer Posting Group : ' + "Customer Posting Group" ] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19300;
            SectionHeight=700;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("No.");

                           InvoiceQty := 0;
                           CreMemoQty := 0;
                           InvoiceAmount := 0;
                           CreMemoAmount := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;800  ;100  ;14600;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         CaptionML=ENU=Customer No.;
                                                         SourceExpr='Customer No. : (' + "No." + ') ' + Name }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19300;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("No.");
                         END;

          }
          CONTROLS
          {
            { 1000000038;TextBox;12100;100  ;2400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=InvoiceQty + CreMemoQty }
            { 1000000039;TextBox;16300;100  ;3000 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=InvoiceAmount + CreMemoAmount }
            { 1000000040;Label  ;800  ;100  ;4000 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Customer Total }
            { 1000000041;Shape  ;800  ;423  ;18500;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19300;
            SectionHeight=800;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("Customer Posting Group");
                         END;

          }
          CONTROLS
          {
            { 1000000014;TextBox;11800;0    ;2700 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=InvoiceQty + CreMemoQty }
            { 1000000024;TextBox;16000;0    ;3300 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=InvoiceAmount + CreMemoAmount }
            { 1000000029;Label  ;400  ;0    ;6050 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Customer Posting Group Total }
            { 1000000032;Shape  ;0    ;500  ;19300;30   ;ShapeStyle=HorzLine }
            { 1000000036;Shape  ;0    ;600  ;19300;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19300;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000048;TextBox;11600;0    ;2900 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalInvoiceQty + TotalCreMemoQty }
            { 1000000049;TextBox;15900;0    ;3400 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalInvoiceAmount + TotalCreMemoAmount }
            { 1000000050;Label  ;0    ;0    ;2550 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Grand Total }
            { 1000000051;Shape  ;0    ;400  ;19300;423  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table113;
        DataItemTableView=SORTING(Bill-to Customer No.,Type,No.)
                          WHERE(Quantity=FILTER(<>0),
                                Type=CONST(Item));
        ReqFilterHeadingML=ENU=Magazine Item No.;
        OnAfterGetRecord=BEGIN
                           IF DateFilter <> '' THEN BEGIN
                             SalesInvHdr.RESET;
                             SalesInvHdr.SETRANGE("No.","Document No.");
                             SalesInvHdr.SETFILTER("Posting Date",DateFilter);
                             IF NOT SalesInvHdr.FIND('-') THEN
                               CurrReport.SKIP;
                           END;
                           SalesInvHdr2.GET("Document No.");

                           IF (Quantity * "Unit Price" <> Amount) AND (Quantity <> 0) THEN
                             "Unit Price" := ROUND(Amount/Quantity);

                           InvoiceQty += Quantity;
                           InvoiceAmount += Amount;

                           TotalInvoiceQty += Quantity;
                           TotalInvoiceAmount += Amount;
                         END;

        ReqFilterFields=No.;
        DataItemLink=Bill-to Customer No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000010;TextBox;5200 ;0    ;2500 ;423  ;FontSize=8;
                                                         SourceExpr="No." }
            { 1000000012;TextBox;7800 ;0    ;4800 ;423  ;FontSize=8;
                                                         SourceExpr=Description }
            { 1000000017;TextBox;12700;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=Quantity }
            { 1000000019;TextBox;14600;0    ;1900 ;423  ;FontSize=8;
                                                         SourceExpr="Unit Price" }
            { 1000000021;TextBox;16600;0    ;2700 ;423  ;FontSize=8;
                                                         SourceExpr=Amount }
            { 1000000044;TextBox;3700 ;0    ;1350 ;423  ;FontSize=8;
                                                         CaptionML=ENU=Posting Date;
                                                         SourceExpr=SalesInvHdr2."Posting Date" }
            { 1000000025;Label  ;2500 ;0    ;1050 ;423  ;FontSize=8;
                                                         FontBold=No;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Invoice }
            { 1000000016;TextBox;200  ;0    ;2100 ;423  ;FontSize=8;
                                                         SourceExpr="Document No." }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table115;
        DataItemTableView=SORTING(Bill-to Customer No.,Type,No.)
                          WHERE(Quantity=FILTER(<>0),
                                Type=CONST(Item));
        OnPreDataItem=BEGIN
                        SETFILTER("No.",ItemFilter);
                      END;

        OnAfterGetRecord=BEGIN
                           IF DateFilter <> '' THEN BEGIN
                             SalesCreMemoHdr.RESET;
                             SalesCreMemoHdr.SETRANGE("No.","Document No.");
                             SalesCreMemoHdr.SETFILTER("Posting Date",DateFilter);
                             IF NOT SalesCreMemoHdr.FIND('-') THEN
                               CurrReport.SKIP;
                           END;
                           SalesCreMemoHdr2.GET("Document No.");

                           IF (Quantity * "Unit Price" <> Amount) AND (Quantity <> 0) THEN
                             "Unit Price" := ROUND(Amount/Quantity);
                           Quantity := -Quantity;
                           Amount := -Amount;

                           CreMemoQty += Quantity;
                           CreMemoAmount += Amount;

                           TotalCreMemoQty += Quantity;
                           TotalCreMemoAmount += Amount;
                         END;

        DataItemLink=Bill-to Customer No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000030;TextBox;5200 ;0    ;2500 ;423  ;FontSize=8;
                                                         SourceExpr="No." }
            { 1000000031;TextBox;7800 ;0    ;4800 ;423  ;FontSize=8;
                                                         SourceExpr=Description }
            { 1000000033;TextBox;12700;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=Quantity }
            { 1000000034;TextBox;14600;0    ;1900 ;423  ;FontSize=8;
                                                         SourceExpr="Unit Price" }
            { 1000000035;TextBox;16600;0    ;2700 ;423  ;FontSize=8;
                                                         SourceExpr=Amount }
            { 1000000046;TextBox;3700 ;0    ;1350 ;423  ;FontSize=8;
                                                         CaptionML=ENU=Posting Date;
                                                         SourceExpr=SalesCreMemoHdr2."Posting Date" }
            { 1000000026;Label  ;2500 ;0    ;1050 ;423  ;FontSize=8;
                                                         FontBold=No;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=CN }
            { 1000000023;TextBox;200  ;0    ;2100 ;423  ;FontSize=8;
                                                         SourceExpr="Document No." }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SalesInvHdr@1000000007 : Record 112;
      SalesCreMemoHdr@1000000008 : Record 114;
      SalesInvHdr2@1000000010 : Record 112;
      SalesCreMemoHdr2@1000000009 : Record 114;
      Item@1000000017 : Record 27;
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      InvoiceQty@1000000002 : Decimal;
      InvoiceAmount@1000000003 : Decimal;
      CreMemoQty@1000000004 : Decimal;
      CreMemoAmount@1000000005 : Decimal;
      TotalInvoiceQty@1000000016 : Decimal;
      TotalInvoiceAmount@1000000015 : Decimal;
      TotalCreMemoQty@1000000014 : Decimal;
      TotalCreMemoAmount@1000000013 : Decimal;
      DateFilter@1000000006 : Text[250];
      CustFilter@1000000011 : Text[250];
      ItemFilter@1000000012 : Text[250];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.03.2007   KKE   New report for Circulation Sales Summary - Circulation Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50043 Circulation Detail Report
{
  OBJECT-PROPERTIES
  {
    Date=01/22/08;
    Time=[ 2:03:08 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    RightMargin=0;
    OnPreReport=BEGIN
                  CustFilter := Customer.GETFILTERS;
                  ItemFilter := Item.GETFILTERS;
                  DateFilter := Item.GETFILTER("Date Filter");
                END;

    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table27;
        DataItemTableView=SORTING(No.)
                          WHERE(Item Type=CONST(Magazine));
        PrintOnlyIfDetail=Yes;
        ReqFilterHeadingML=ENU=Magazine Item;
        OnAfterGetRecord=BEGIN
                           TotalSaleQty := 0;
                           TotalCNQty[1] := 0;
                           TotalCNQty[2] := 0;
                           TotalCNQty[3] := 0;
                           TotalCNQty[4] := 0;
                           TotalCNQty[5] := 0;
                         END;

        ReqFilterFields=No.,Magazine Code,Date Filter;
        GroupTotalFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000002;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Circulation Detail Report }
            { 1000000003;TextBox;16100;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Circulation Detail Report") }
            { 1000000004;TextBox;16100;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000005;TextBox;18800;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000006;Label  ;18050;423  ;750  ;423  ;ParentControl=1000000005 }
            { 1000000037;TextBox;17000;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ItemFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000015;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',Item.TABLECAPTION,ItemFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := CustFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',Customer.TABLECAPTION,CustFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=1500;
          }
          CONTROLS
          {
            { 1000000013;Label  ;6600 ;300  ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Sale }
            { 1000000011;Label  ;2100 ;300  ;4400 ;846  ;VertAlign=Top;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Name }
            { 1000000027;Shape  ;0    ;0    ;19300;300  ;ShapeStyle=HorzLine }
            { 1000000028;Shape  ;0    ;1169 ;19300;331  ;ShapeStyle=HorzLine }
            { 1000000053;Label  ;100  ;300  ;1800 ;846  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Customer No. }
            { 1000000026;Label  ;8400 ;700  ;1200 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=#1 }
            { 1000000033;Label  ;9700 ;700  ;1200 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=#2 }
            { 1000000034;Label  ;11000;700  ;1200 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=#3 }
            { 1000000035;Label  ;12300;700  ;1200 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=#4 }
            { 1000000042;Label  ;13600;700  ;1200 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=>#5 }
            { 1000000043;Label  ;14900;700  ;1500 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000044;Label  ;16500;300  ;1600 ;846  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Net Qty. }
            { 1000000045;Label  ;18100;300  ;1200 ;846  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Return % }
            { 1000000025;Label  ;8400 ;300  ;8000 ;400  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=CN }
            { 1000000017;Shape  ;8400 ;700  ;8000 ;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=700;
          }
          CONTROLS
          {
            { 1000000024;TextBox;0    ;100  ;14600;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr='Magazine Item No. : ' + "No."  + ' ' + Description + "Description 2" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=700;
            OnPreSection=BEGIN
                             TotalCN := TotalCNQty[1] + TotalCNQty[2] + TotalCNQty[3] + TotalCNQty[4] + TotalCNQty[5];
                             IF TotalSaleQty <> 0 THEN
                               "Return%" := ROUND(TotalCN * 100 / TotalSaleQty)
                             ELSE
                               "Return%" := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000032;Label  ;0    ;0    ;4900 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Magazine Item Total }
            { 1000000048;Shape  ;0    ;523  ;19400;30   ;ShapeStyle=HorzLine }
            { 1000000031;TextBox;5400 ;0    ;2900 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty }
            { 1000000049;TextBox;8400 ;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[1] }
            { 1000000063;TextBox;9700 ;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[2] }
            { 1000000064;TextBox;11000;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[3] }
            { 1000000065;TextBox;12300;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[4] }
            { 1000000066;TextBox;13600;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[5] }
            { 1000000067;TextBox;14900;0    ;1500 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCN }
            { 1000000068;TextBox;16500;0    ;1500 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty - TotalCN }
            { 1000000069;TextBox;18100;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Return%" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=846;
            OnPreSection=BEGIN
                           TotalCN := GrandTotalCNQty[1] + GrandTotalCNQty[2] + GrandTotalCNQty[3] + GrandTotalCNQty[4] + GrandTotalCNQty[5];
                           IF GrandTotalSaleQty <> 0 THEN
                             "Return%" := ROUND(TotalCN * 100 / GrandTotalSaleQty)
                           ELSE
                             "Return%" := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000050;Label  ;0    ;0    ;2550 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Grand Total }
            { 1000000051;Shape  ;0    ;400  ;19300;423  ;ShapeStyle=HorzLine }
            { 1000000036;TextBox;18100;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Return%" }
            { 1000000055;TextBox;16500;0    ;1500 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalSaleQty - TotalCN }
            { 1000000056;TextBox;14900;0    ;1500 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCN }
            { 1000000057;TextBox;13600;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[5] }
            { 1000000058;TextBox;12300;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[4] }
            { 1000000059;TextBox;11000;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[3] }
            { 1000000060;TextBox;9700 ;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[2] }
            { 1000000061;TextBox;8400 ;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[1] }
            { 1000000062;TextBox;5400 ;0    ;2900 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalSaleQty }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table18;
        DataItemTableView=SORTING(Customer Posting Group,No.);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(SaleQty,CNQty);
                      END;

        OnAfterGetRecord=BEGIN
                           i := 0;
                           {
                           SaleQty := 0;
                           CNQty[1] := 0;
                           CNQty[2] := 0;
                           CNQty[3] := 0;
                           CNQty[4] := 0;
                           CNQty[5] := 0;
                            }
                         END;

        ReqFilterFields=Customer Posting Group,No.;
        GroupTotalFields=Customer Posting Group,No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19400;
            SectionHeight=700;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("Customer Posting Group");
                         END;

          }
          CONTROLS
          {
            { 1000000009;TextBox;400  ;100  ;14600;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr=['Customer Posting Group : ' + "Customer Posting Group" ] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=800;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("Customer Posting Group");
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             TotalCN := CNQty[1] + CNQty[2] + CNQty[3] + CNQty[4] + CNQty[5];
                             IF SaleQty <> 0 THEN
                               "Return%" := ROUND(TotalCN * 100 / SaleQty)
                             ELSE
                               "Return%" := 0;

                             TotalSaleQty += SaleQty;
                             TotalCNQty[1] += CNQty[1];
                             TotalCNQty[2] += CNQty[2];
                             TotalCNQty[3] += CNQty[3];
                             TotalCNQty[4] += CNQty[4];
                             TotalCNQty[5] += CNQty[5];
                             GrandTotalSaleQty += SaleQty;
                             GrandTotalCNQty[1] += CNQty[1];
                             GrandTotalCNQty[2] += CNQty[2];
                             GrandTotalCNQty[3] += CNQty[3];
                             GrandTotalCNQty[4] += CNQty[4];
                             GrandTotalCNQty[5] += CNQty[5];
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000029;Label  ;400  ;0    ;4900 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Customer Posting Group Total }
            { 1000000030;Shape  ;400  ;523  ;19000;30   ;ShapeStyle=HorzLine }
            { 1000000070;TextBox;18100;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Return%" }
            { 1000000071;TextBox;16500;0    ;1500 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty - TotalCN }
            { 1000000072;TextBox;14900;0    ;1500 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCN }
            { 1000000073;TextBox;13600;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[5] }
            { 1000000074;TextBox;12300;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[4] }
            { 1000000075;TextBox;11000;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[3] }
            { 1000000076;TextBox;9700 ;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[2] }
            { 1000000077;TextBox;8400 ;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[1] }
            { 1000000078;TextBox;5600 ;0    ;2700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table32;
        DataItemTableView=SORTING(Source Type,Source No.,Item No.,Variant Code,Posting Date)
                          WHERE(Source Type=CONST(Customer),
                                Entry Type=CONST(Sale));
        OnPreDataItem=BEGIN
                        SETRANGE("Item No.",Item."No.");
                        SETFILTER("Posting Date",DateFilter);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Quantity < 0 THEN
                             SaleQty += -Quantity
                           ELSE BEGIN
                             i += 1;
                             IF i > 5 THEN
                               i := 5;
                             CNQty[i] += Quantity;
                           END;
                         END;

        DataItemLink=Source No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=423;
            OnPreSection=BEGIN
                           TotalCN := CNQty[1] + CNQty[2] + CNQty[3] + CNQty[4] + CNQty[5];
                           IF SaleQty <> 0 THEN
                             "Return%" := ROUND(TotalCN * 100 / SaleQty)
                           ELSE
                             "Return%" := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000016;TextBox;100  ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=Customer."No." }
            { 1000000007;TextBox;2100 ;0    ;4400 ;423  ;FontSize=8;
                                                         SourceExpr=Customer.Name + Customer."Name 2" }
            { 1000000008;TextBox;18100;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         SourceExpr="Return%" }
            { 1000000010;TextBox;16500;0    ;1500 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty - TotalCN }
            { 1000000012;TextBox;14900;0    ;1500 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCN }
            { 1000000018;TextBox;13600;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[5] }
            { 1000000019;TextBox;12300;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[4] }
            { 1000000020;TextBox;11000;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[3] }
            { 1000000021;TextBox;9700 ;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[2] }
            { 1000000022;TextBox;8400 ;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[1] }
            { 1000000023;TextBox;6600 ;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SalesInvHdr@1000000007 : Record 112;
      SalesCreMemoHdr@1000000008 : Record 114;
      SalesInvHdr2@1000000010 : Record 112;
      SalesCreMemoHdr2@1000000009 : Record 114;
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      DateFilter@1000000006 : Text[250];
      CustFilter@1000000011 : Text[250];
      ItemFilter@1000000012 : Text[250];
      SaleQty@1000000026 : Decimal;
      CNQty@1000000025 : ARRAY [5] OF Decimal;
      TotalCN@1000000024 : Decimal;
      TotalSaleQty@1000000023 : Decimal;
      TotalCNQty@1000000022 : ARRAY [5] OF Decimal;
      GrandTotalSaleQty@1000000021 : Decimal;
      GrandTotalCNQty@1000000020 : ARRAY [5] OF Decimal;
      "Return%"@1000000019 : Decimal;
      i@1000000018 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.03.2007   KKE   New report for Circulation Detail Report - Circulation Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50044 Magazine Return Report
{
  OBJECT-PROPERTIES
  {
    Date=01/22/08;
    Time=[ 1:55:25 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  CustFilter := Customer.GETFILTERS;
                  ItemFilter := Item.GETFILTERS;
                  DateFilter := Item.GETFILTER("Date Filter");
                END;

    PaperSize=A4 210 x 297 mm;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table18;
        DataItemTableView=SORTING(Customer Posting Group,No.);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(TotalSaleQty,TotalCNQty);
                      END;

        ReqFilterFields=No.,Customer Posting Group;
        GroupTotalFields=Customer Posting Group,No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000001;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Magazine Return Report }
            { 1000000002;TextBox;16100;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Magazine Return Report") }
            { 1000000003;TextBox;16100;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000004;TextBox;18800;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;18050;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;17000;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := CustFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000007;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',Customer.TABLECAPTION,CustFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ItemFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',Item.TABLECAPTION,ItemFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=1330;
          }
          CONTROLS
          {
            { 1000000012;Label  ;400  ;0    ;3300 ;1300 ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Magazine No. }
            { 1000000014;Label  ;3800 ;0    ;1900 ;1300 ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Issue Date }
            { 1000000015;Shape  ;0    ;0    ;19400;30   ;ShapeStyle=HorzLine }
            { 1000000016;Label  ;5800 ;0    ;2500 ;1300 ;HorzAlign=Right;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Sale Qty }
            { 1000000017;Label  ;8400 ;0    ;8000 ;600  ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=CN }
            { 1000000018;Label  ;8400 ;600  ;1200 ;700  ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=#1 }
            { 1000000019;Label  ;9700 ;600  ;1200 ;700  ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=#2 }
            { 1000000020;Label  ;11000;600  ;1200 ;700  ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=#3 }
            { 1000000021;Label  ;12300;600  ;1200 ;700  ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=#4 }
            { 1000000022;Label  ;13600;600  ;1200 ;700  ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=>#5 }
            { 1000000023;Shape  ;8400 ;600  ;8000 ;30   ;ShapeStyle=HorzLine }
            { 1000000024;Label  ;14900;600  ;1500 ;700  ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000025;Label  ;16500;0    ;1500 ;1300 ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Net Qty. }
            { 1000000026;Label  ;18100;0    ;1200 ;1300 ;HorzAlign=Center;
                                                         FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Return (%) }
            { 1000000027;Shape  ;0    ;1300 ;19400;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19400;
            SectionHeight=700;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("Customer Posting Group");
                         END;

          }
          CONTROLS
          {
            { 1000000061;TextBox;0    ;100  ;14600;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr=['Customer Posting Group : ' + "Customer Posting Group" ] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19400;
            SectionHeight=800;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("No.");
                         END;

          }
          CONTROLS
          {
            { 1000000009;TextBox;0    ;100  ;17200;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr='Customer No. : (' + "No." + ') ' + Name + "Name 2" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=746;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("No.");
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             TotalCN := TotalCNQty[1] + TotalCNQty[2] + TotalCNQty[3] + TotalCNQty[4] + TotalCNQty[5];
                             IF TotalSaleQty <> 0 THEN
                               "Return%" := ROUND(TotalCN * 100 / TotalSaleQty)
                             ELSE
                               "Return%" := 0;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000064;Label  ;0    ;0    ;4000 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Customer Total }
            { 1000000065;Shape  ;0    ;600  ;19400;146  ;ShapeStyle=HorzLine }
            { 1000000066;TextBox;5800 ;0    ;2500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty }
            { 1000000067;TextBox;8400 ;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[1] }
            { 1000000068;TextBox;9700 ;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[2] }
            { 1000000069;TextBox;11000;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[3] }
            { 1000000070;TextBox;12300;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[4] }
            { 1000000071;TextBox;13600;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[5] }
            { 1000000072;TextBox;14900;0    ;1500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCN }
            { 1000000073;TextBox;16500;0    ;1500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty - TotalCN }
            { 1000000074;TextBox;18100;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Return%" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=746;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Customer.FIELDNO("Customer Posting Group");
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             TotalCN := TotalCNQty[1] + TotalCNQty[2] + TotalCNQty[3] + TotalCNQty[4] + TotalCNQty[5];
                             IF TotalSaleQty <> 0 THEN
                               "Return%" := ROUND(TotalCN * 100 / TotalSaleQty)
                             ELSE
                               "Return%" := 0;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000075;Label  ;0    ;0    ;5300 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Customer Posting Group Total }
            { 1000000076;Shape  ;0    ;600  ;19400;146  ;ShapeStyle=HorzLine }
            { 1000000077;TextBox;5800 ;0    ;2500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty }
            { 1000000078;TextBox;8400 ;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[1] }
            { 1000000079;TextBox;9700 ;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[2] }
            { 1000000080;TextBox;11000;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[3] }
            { 1000000081;TextBox;12300;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[4] }
            { 1000000082;TextBox;13600;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCNQty[5] }
            { 1000000083;TextBox;14900;0    ;1500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCN }
            { 1000000084;TextBox;16500;0    ;1500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty - TotalCN }
            { 1000000085;TextBox;18100;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Return%" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=846;
            OnPreSection=BEGIN
                           TotalCN := GrandTotalCNQty[1] + GrandTotalCNQty[2] + GrandTotalCNQty[3] + GrandTotalCNQty[4] + GrandTotalCNQty[5];
                           IF GrandTotalSaleQty <> 0 THEN
                             "Return%" := ROUND(TotalCN * 100 / GrandTotalSaleQty)
                           ELSE
                             "Return%" := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000010;Shape  ;0    ;100  ;19400;30   ;ShapeStyle=HorzLine }
            { 1000000011;Shape  ;0    ;800  ;19400;30   ;ShapeStyle=HorzLine }
            { 1000000051;Label  ;0    ;100  ;2900 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Grand Total }
            { 1000000052;TextBox;18100;100  ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Return%" }
            { 1000000053;TextBox;16500;100  ;1500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalSaleQty - TotalCN }
            { 1000000054;TextBox;14900;100  ;1500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCN }
            { 1000000055;TextBox;13600;100  ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[5] }
            { 1000000056;TextBox;12300;100  ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[4] }
            { 1000000057;TextBox;11000;100  ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[3] }
            { 1000000058;TextBox;9700 ;100  ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[2] }
            { 1000000059;TextBox;8400 ;100  ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalCNQty[1] }
            { 1000000060;TextBox;5800 ;100  ;2500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalSaleQty }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table27;
        DataItemTableView=SORTING(Item Type,Magazine Code)
                          WHERE(Item Type=CONST(Magazine));
        ReqFilterHeadingML=ENU=Magazine Item;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(SaleQty,CNQty);
                      END;

        OnAfterGetRecord=BEGIN
                           i := 0;
                           SaleQty := 0;
                           CNQty[1] := 0;
                           CNQty[2] := 0;
                           CNQty[3] := 0;
                           CNQty[4] := 0;
                           CNQty[5] := 0;

                           ItemLedgEntry.RESET;
                           ItemLedgEntry.SETCURRENTKEY("Item No.","Entry Type","Variant Code","Drop Shipment","Location Code","Posting Date");
                           ItemLedgEntry.SETRANGE("Item No.",Item."No.");
                           ItemLedgEntry.SETRANGE("Entry Type",ItemLedgEntry."Entry Type"::Sale);
                           ItemLedgEntry.SETCURRENTKEY("Source Type","Source No.","Item No.","Variant Code","Posting Date");
                           ItemLedgEntry.SETRANGE("Source Type",ItemLedgEntry."Source Type"::Customer);
                           ItemLedgEntry.SETRANGE("Source No.",Customer."No.");
                           ItemLedgEntry.SETFILTER("Posting Date",DateFilter);
                           IF NOT ItemLedgEntry.FIND('-') THEN
                             CurrReport.SKIP;

                           REPEAT
                             IF ItemLedgEntry.Quantity < 0 THEN
                               SaleQty += -ItemLedgEntry.Quantity
                             ELSE BEGIN
                               i += 1;
                               IF i > 5 THEN
                                 i := 5;
                               CNQty[i] += ItemLedgEntry.Quantity;
                             END;
                           UNTIL ItemLedgEntry.NEXT=0;

                           TotalCN := CNQty[1] + CNQty[2] + CNQty[3] + CNQty[4] + CNQty[5];
                           IF SaleQty <> 0 THEN
                             "Return%" := ROUND(TotalCN * 100 / SaleQty)
                           ELSE
                             "Return%" := 0;

                           TotalSaleQty += SaleQty;
                           TotalCNQty[1] += CNQty[1];
                           TotalCNQty[2] += CNQty[2];
                           TotalCNQty[3] += CNQty[3];
                           TotalCNQty[4] += CNQty[4];
                           TotalCNQty[5] += CNQty[5];
                           GrandTotalSaleQty += SaleQty;
                           GrandTotalCNQty[1] += CNQty[1];
                           GrandTotalCNQty[2] += CNQty[2];
                           GrandTotalCNQty[3] += CNQty[3];
                           GrandTotalCNQty[4] += CNQty[4];
                           GrandTotalCNQty[5] += CNQty[5];
                         END;

        ReqFilterFields=Magazine Code,Volume No.,Issue No.,Date Filter;
        GroupTotalFields=Magazine Code;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19400;
            SectionHeight=900;
          }
          CONTROLS
          {
            { 1000000013;TextBox;400  ;100  ;16800;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr='Magazine Code : ' + "Magazine Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000028;TextBox;400  ;0    ;3300 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         SourceExpr="No." }
            { 1000000032;TextBox;9700 ;0    ;1200 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[2] }
            { 1000000033;TextBox;11000;0    ;1200 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[3] }
            { 1000000034;TextBox;12300;0    ;1200 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[4] }
            { 1000000035;TextBox;13600;0    ;1200 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[5] }
            { 1000000030;TextBox;5800 ;0    ;2500 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty }
            { 1000000029;TextBox;3800 ;0    ;1900 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         SourceExpr="Issue Date" }
            { 1000000031;TextBox;8400 ;0    ;1200 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[1] }
            { 1000000036;TextBox;14900;0    ;1500 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCN }
            { 1000000037;TextBox;16500;0    ;1500 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty - TotalCN }
            { 1000000038;TextBox;18100;0    ;1200 ;600  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         SourceExpr="Return%" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=730;
            OnPreSection=BEGIN
                           TotalCN := CNQty[1] + CNQty[2] + CNQty[3] + CNQty[4] + CNQty[5];
                           IF SaleQty <> 0 THEN
                             "Return%" := ROUND(TotalCN * 100 / SaleQty)
                           ELSE
                             "Return%" := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000039;Shape  ;400  ;0    ;19000;30   ;ShapeStyle=HorzLine }
            { 1000000040;Shape  ;400  ;700  ;19000;30   ;ShapeStyle=HorzLine }
            { 1000000041;Label  ;400  ;0    ;2500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Magazine Total }
            { 1000000062;TextBox;18100;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Return%" }
            { 1000000063;TextBox;16500;0    ;1500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty - TotalCN }
            { 1000000086;TextBox;14900;0    ;1500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalCN }
            { 1000000087;TextBox;13600;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[5] }
            { 1000000088;TextBox;12300;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[4] }
            { 1000000089;TextBox;11000;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[3] }
            { 1000000090;TextBox;9700 ;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[2] }
            { 1000000091;TextBox;8400 ;0    ;1200 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=CNQty[1] }
            { 1000000092;TextBox;5800 ;0    ;2500 ;700  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      ItemLedgEntry@1000000002 : Record 32;
      CustFilter@1000000000 : Text[250];
      ItemFilter@1000000001 : Text[250];
      DateFilter@1000000012 : Text[250];
      SaleQty@1000000003 : Decimal;
      CNQty@1000000004 : ARRAY [5] OF Decimal;
      TotalCN@1000000005 : Decimal;
      TotalSaleQty@1000000009 : Decimal;
      TotalCNQty@1000000008 : ARRAY [5] OF Decimal;
      GrandTotalSaleQty@1000000011 : Decimal;
      GrandTotalCNQty@1000000010 : ARRAY [5] OF Decimal;
      "Return%"@1000000006 : Decimal;
      i@1000000007 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   02.05.2007   KKE   New report Magazine Return Report - Circulation Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50045 Magazine Income Report
{
  OBJECT-PROPERTIES
  {
    Date=01/22/08;
    Time=[ 1:52:32 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    RightMargin=0;
    OnPreReport=BEGIN
                  CustFilter := Customer.GETFILTERS;
                  ItemFilter := Item.GETFILTERS;
                  MagazineFilter := Item.GETFILTER("Magazine Code");
                  DateFilter := Item.GETFILTER("Date Filter");
                END;

    Orientation=Landscape;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50011;
        DataItemTableView=SORTING(Code);
        OnPreDataItem=BEGIN
                        SETFILTER(Code,MagazineFilter);
                      END;

        OnAfterGetRecord=BEGIN
                           TotalSaleQty[1] := 0;
                           TotalSaleQty[2] := 0;
                           TotalSaleQty[3] := 0;
                           TotalSaleQty[4] := 0;
                           TotalSaleQty[5] := 0;
                           TotalReturnQty := 0;
                         END;

        GroupTotalFields=Code;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27900;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000002;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Magazine Income Report }
            { 1000000003;TextBox;24700;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Magazine Income Report") }
            { 1000000004;TextBox;24700;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000005;TextBox;27400;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000006;Label  ;26650;423  ;750  ;423  ;ParentControl=1000000005 }
            { 1000000014;TextBox;25600;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := ItemFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000015;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',Item.TABLECAPTION,ItemFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := CustFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',Customer.TABLECAPTION,CustFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27900;
            SectionHeight=1631;
          }
          CONTROLS
          {
            { 1000000011;Label  ;2100 ;300  ;5400 ;846  ;VertAlign=Top;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Name }
            { 1000000027;Shape  ;0    ;0    ;27900;300  ;ShapeStyle=HorzLine }
            { 1000000028;Shape  ;0    ;1300 ;27900;331  ;ShapeStyle=HorzLine }
            { 1000000053;Label  ;100  ;300  ;1800 ;846  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Customer No. }
            { 1000000026;Label  ;7600 ;700  ;1700 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=#1 }
            { 1000000033;Label  ;9400 ;700  ;1700 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=#2 }
            { 1000000034;Label  ;11200;700  ;1700 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=#3 }
            { 1000000035;Label  ;13000;700  ;1700 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=#4 }
            { 1000000042;Label  ;14800;700  ;1700 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=>#5 }
            { 1000000043;Label  ;16600;700  ;2100 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000044;Label  ;18800;300  ;1700 ;1000 ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Return Qty. }
            { 1000000045;Label  ;20600;300  ;1200 ;1000 ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Return % }
            { 1000000025;Label  ;7600 ;300  ;11100;400  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Sale Quantity / Issue No. }
            { 1000000017;Shape  ;7600 ;800  ;11100;30   ;ShapeStyle=HorzLine }
            { 1000000013;Label  ;21900;300  ;5900 ;400  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Payment }
            { 1000000023;Label  ;21900;700  ;1800 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Bank }
            { 1000000037;Label  ;23800;700  ;1400 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000038;Shape  ;21900;800  ;5900 ;30   ;ShapeStyle=HorzLine }
            { 1000000039;Label  ;25300;700  ;2500 ;600  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Amount }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27900;
            SectionHeight=700;
          }
          CONTROLS
          {
            { 1000000040;TextBox;0    ;100  ;16800;500  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr='Magazine Code : ' + Code + ' ' + Description }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=27900;
            SectionHeight=700;
            OnPreSection=BEGIN
                           TotalSale := TotalSaleQty[1] + TotalSaleQty[2] + TotalSaleQty[3] + TotalSaleQty[4] + TotalSaleQty[5];
                           IF TotalSale <> 0 THEN
                             "Return%" := ROUND(TotalReturnQty * 100 / TotalSale)
                           ELSE
                             "Return%" := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000032;Label  ;0    ;0    ;4900 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Magazine Code Total }
            { 1000000048;Shape  ;0    ;523  ;27900;30   ;ShapeStyle=HorzLine }
            { 1000000049;TextBox;7600 ;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty[1] }
            { 1000000063;TextBox;9400 ;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty[2] }
            { 1000000064;TextBox;11200;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty[3] }
            { 1000000065;TextBox;13000;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty[4] }
            { 1000000066;TextBox;14800;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSaleQty[5] }
            { 1000000067;TextBox;16600;0    ;2100 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSale }
            { 1000000068;TextBox;18800;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalReturnQty }
            { 1000000069;TextBox;20600;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Return%" }
            { 1000000024;TextBox;24800;0    ;3000 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=PaymentAmt }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27900;
            SectionHeight=846;
            OnPreSection=BEGIN
                           TotalSale := GrandTotalSaleQty[1] + GrandTotalSaleQty[2] + GrandTotalSaleQty[3] + GrandTotalSaleQty[4] + GrandTotalSaleQty[5];
                           IF TotalSale <> 0 THEN
                             "Return%" := ROUND(GrandTotalReturnQty * 100 / TotalSale)
                           ELSE
                             "Return%" := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000050;Label  ;0    ;0    ;2550 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Grand Total }
            { 1000000051;Shape  ;0    ;400  ;27900;423  ;ShapeStyle=HorzLine }
            { 1000000036;TextBox;20600;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Return%" }
            { 1000000055;TextBox;18800;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalReturnQty }
            { 1000000056;TextBox;16600;0    ;2100 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSale }
            { 1000000057;TextBox;14800;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalSaleQty[5] }
            { 1000000058;TextBox;13000;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalSaleQty[4] }
            { 1000000059;TextBox;11200;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalSaleQty[3] }
            { 1000000060;TextBox;9400 ;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalSaleQty[2] }
            { 1000000062;TextBox;24700;0    ;3100 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=PaymentAmt }
            { 1000000061;TextBox;7600 ;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=GrandTotalSaleQty[1] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table18;
        DataItemTableView=SORTING(No.);
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(SaleQty,ReturnQty);
                      END;

        OnAfterGetRecord=BEGIN
                           i := 0;
                         END;

        ReqFilterFields=Customer Posting Group,No.;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table27;
        DataItemTableView=SORTING(Item Type,Magazine Code)
                          WHERE(Item Type=CONST(Magazine));
        PrintOnlyIfDetail=Yes;
        ReqFilterHeadingML=ENU=Magazine Item;
        OnPreDataItem=BEGIN
                        SETRANGE("Magazine Code",Magazine.Code);
                      END;

        ReqFilterFields=Magazine Code,Volume No.,Issue No.,No.,Date Filter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           TotalSale := SaleQty[1] + SaleQty[2] + SaleQty[3] + SaleQty[4] + SaleQty[5];
                           IF TotalSale <> 0 THEN
                             "Return%" := ROUND(ReturnQty * 100 / TotalSale)
                           ELSE
                             "Return%" := 0;

                           TotalSaleQty[1] += SaleQty[1];
                           TotalSaleQty[2] += SaleQty[2];
                           TotalSaleQty[3] += SaleQty[3];
                           TotalSaleQty[4] += SaleQty[4];
                           TotalSaleQty[5] += SaleQty[5];
                           TotalReturnQty += ReturnQty;
                           GrandTotalSaleQty[1] += SaleQty[1];
                           GrandTotalSaleQty[2] += SaleQty[2];
                           GrandTotalSaleQty[3] += SaleQty[3];
                           GrandTotalSaleQty[4] += SaleQty[4];
                           GrandTotalSaleQty[5] += SaleQty[5];
                           GrandTotalReturnQty += ReturnQty;
                         END;

          }
          CONTROLS
          {
            { 1000000016;TextBox;100  ;0    ;1800 ;423  ;FontSize=8;
                                                         SourceExpr=Customer."No." }
            { 1000000007;TextBox;2100 ;0    ;5400 ;423  ;FontSize=8;
                                                         SourceExpr=Customer.Name + Customer."Name 2" }
            { 1000000010;TextBox;18800;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=ReturnQty }
            { 1000000018;TextBox;14800;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty[5] }
            { 1000000019;TextBox;13000;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty[4] }
            { 1000000020;TextBox;11200;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty[3] }
            { 1000000021;TextBox;9400 ;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty[2] }
            { 1000000022;TextBox;7600 ;0    ;1700 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=SaleQty[1] }
            { 1000000009;TextBox;25300;0    ;2500 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         SourceExpr=PaymentAmt }
            { 1000000012;TextBox;16600;0    ;2100 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         DecimalPlaces=0:5;
                                                         SourceExpr=TotalSale }
            { 1000000008;TextBox;20600;0    ;1200 ;423  ;FontName=Helvetica;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         SourceExpr="Return%" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table32;
        DataItemTableView=SORTING(Source Type,Source No.,Item No.,Variant Code,Posting Date)
                          WHERE(Source Type=CONST(Customer),
                                Entry Type=CONST(Sale));
        OnPreDataItem=BEGIN
                        SETRANGE("Source No.",Customer."No.");
                        SETFILTER("Posting Date",DateFilter);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Quantity > 0 THEN
                             ReturnQty += Quantity
                           ELSE BEGIN
                             i += 1;
                             IF i > 5 THEN
                               i := 5;
                             SaleQty[i] += -Quantity;
                           END;
                         END;

        DataItemLink=Item No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SalesInvHdr@1000000007 : Record 112;
      SalesCreMemoHdr@1000000008 : Record 114;
      SalesInvHdr2@1000000010 : Record 112;
      SalesCreMemoHdr2@1000000009 : Record 114;
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      CustFilter@1000000011 : Text[250];
      ItemFilter@1000000012 : Text[250];
      DateFilter@1000000005 : Text[250];
      MagazineFilter@1000000006 : Text[250];
      SaleQty@1000000026 : ARRAY [5] OF Decimal;
      TotalSale@1000000002 : Decimal;
      ReturnQty@1000000025 : Decimal;
      "Return%"@1000000003 : Decimal;
      TotalSaleQty@1000000023 : ARRAY [5] OF Decimal;
      TotalReturnQty@1000000022 : Decimal;
      GrandTotalSaleQty@1000000021 : ARRAY [5] OF Decimal;
      GrandTotalReturnQty@1000000020 : Decimal;
      PaymentAmt@1000000004 : Decimal;
      i@1000000018 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.03.2007   KKE   New report for Magazine Income Report - Circulation Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50046 Advertising Contract
{
  OBJECT-PROPERTIES
  {
    Date=01/24/08;
    Time=[ 9:58:42 AM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50037;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        OnAfterGetRecord=BEGIN
                           SellCust.GET("Sell-to Customer No.");
                           IF SellCust."Name (Thai)" = '' THEN
                             SellCust."Name (Thai)" := SellCust.Name + SellCust."Name 2";
                           IF SellCust."Address (Thai)" = '' THEN
                             SellCust."Address (Thai)" := SellCust.Address + ' ' + SellCust."Address 2" + ' ' + SellCust."Address 3";

                           BillCust.GET("Bill-to Customer No.");
                           IF BillCust."Name (Thai)" = '' THEN
                             BillCust."Name (Thai)" := BillCust.Name + BillCust."Name 2";
                           IF BillCust."Address (Thai)" = '' THEN
                             BillCust."Address (Thai)" := BillCust.Address + ' ' + BillCust."Address 2" + ' ' + BillCust."Address 3";

                           CLEAR(ST);
                           CASE "Ads. Booking Header"."Ads. Sales Type" OF
                             'DIRECT':
                               ST[1] := 'X';
                             'AGENCY':
                               ST[2] := 'X';
                           END;

                           AdsBookLine.RESET;
                           AdsBookLine.SETCURRENTKEY("Booking No.","Line No.");
                           AdsBookLine.SETRANGE("Booking No.","No.");
                           AdsBookLine.SETRANGE("Line Status",AdsBookLine."Line Status"::Approved);
                           IF AdsBookLine.FIND('-') THEN BEGIN
                             IF NOT Magazine.GET(AdsBookLine."Magazine Code") THEN
                               Magazine.INIT;
                             IF Magazine.Description <> '' THEN
                               MagazineDesc := Magazine.Description
                             ELSE
                               MagazineDesc := Magazine.Code;
                             IF NOT ProductCategory.GET(AdsBookLine."Product Category") THEN
                               ProductCategory.INIT;
                             IF NOT AdsProduct.GET(AdsBookLine."Ads. Product") THEN
                               AdsProduct.INIT;
                           END ELSE BEGIN
                             Magazine.INIT;
                             ProductCategory.INIT;
                             AdsProduct.INIT;
                           END;

                           IF NOT Salesperson.GET("Salesperson Code") THEN
                             Salesperson.INIT;
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19300;
            SectionHeight=12300;
          }
          CONTROLS
          {
            { 1000000000;TextBox;2900 ;5800 ;7200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SellCust."Name (Thai)" }
            { 1000000001;TextBox;12300;5700 ;6900 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=BillCust."Name (Thai)" }
            { 1000000002;TextBox;1700 ;6600 ;8400 ;1900 ;VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=SellCust."Address (Thai)" }
            { 1000000003;TextBox;11400;6500 ;7700 ;1900 ;VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=BillCust."Address (Thai)" }
            { 1000000004;TextBox;1400 ;8500 ;3700 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SellCust."Phone No." }
            { 1000000005;TextBox;5800 ;8500 ;4300 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SellCust."Fax No." }
            { 1000000006;TextBox;3000 ;9200 ;6800 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Contact }
            { 1000000007;TextBox;15700;8400 ;3500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Fax No." }
            { 1000000008;TextBox;11100;8400 ;3800 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Phone No." }
            { 1000000009;TextBox;15100;2200 ;3400 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=FORMAT("Booking Date",0,'<Month Text,3> <Day,2>, <Year4>') }
            { 1000000021;TextBox;14100;2800 ;600  ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=ST[1] }
            { 1000000022;TextBox;16600;2800 ;600  ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=ST[2] }
            { 1000000023;TextBox;15800;3500 ;3300 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=MagazineDesc }
            { 1000000024;TextBox;13700;9100 ;5500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=ProductCategory.Description }
            { 1000000025;TextBox;13000;9800 ;6200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=AdsProduct.Description }
            { 1000000020;TextBox;15100;1700 ;3800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19300;
            SectionHeight=1200;
          }
          CONTROLS
          {
            { 1000000026;TextBox;2000 ;600  ;7700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Salesperson.Name }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50038;
        DataItemTableView=SORTING(Booking No.,Line No.)
                          WHERE(Line Status=CONST(Approved));
        OnPreDataItem=BEGIN
                        CntLine := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           CntLine += 1;
                         END;

        TotalFields=Amount,Amount Including VAT;
        DataItemLink=Booking No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=650;
            OnPreSection=BEGIN
                           IF CntLine = 12 THEN BEGIN
                             CntLine := 1;
                             CurrReport.NEWPAGE;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000010;TextBox;400  ;0    ;2600 ;650  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=STRSUBSTNO('%1  %2',"Issue No.","Issue Date") }
            { 1000000011;TextBox;3100 ;0    ;1700 ;650  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Ads. Position" }
            { 1000000012;TextBox;4900 ;0    ;1100 ;650  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Ads. Size" }
            { 1000000013;TextBox;6100 ;0    ;900  ;650  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Counting Unit" }
            { 1000000014;TextBox;7400 ;0    ;2800 ;650  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Unit Price Excl. VAT" }
            { 1000000015;TextBox;11500;0    ;3100 ;650  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Amount }
            { 1000000016;TextBox;14800;0    ;4400 ;650  ;Visible=No;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Remark }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        IF CntLine > 12 THEN
                          SETRANGE(Number,1,12+12-CntLine)
                        ELSE
                          SETRANGE(Number,1,12-CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000027;Label  ;0    ;0    ;6500 ;600  ;Visible=No;
                                                         ForeColor=255;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=2400;
          }
          CONTROLS
          {
            { 1000000017;TextBox;11500;300  ;3100 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr="Ads. Booking Line".Amount }
            { 1000000018;TextBox;11500;1700 ;3100 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr="Ads. Booking Line"."Amount Including VAT" }
            { 1000000019;TextBox;11500;1000 ;3100 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr="Ads. Booking Line"."Amount Including VAT" - "Ads. Booking Line".Amount }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SellCust@1000000002 : Record 18;
      BillCust@1000000001 : Record 18;
      AdsBookLine@1000000004 : Record 50038;
      Magazine@1000000005 : Record 50011;
      ProductCategory@1000000008 : Record 50030;
      AdsProduct@1000000007 : Record 50031;
      Salesperson@1000000009 : Record 13;
      CntLine@1000000000 : Integer;
      ST@1000000003 : ARRAY [2] OF Text[1];
      MagazineDesc@1000000006 : Text[50];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   09.05.2007   KKE   New report for "Advertising Contract" - Ads. Sales Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50047 Ads. Booking Overview
{
  OBJECT-PROPERTIES
  {
    Date=12/19/11;
    Time=[ 3:30:28 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnInitReport=BEGIN
                   SendToExcel := TRUE;
                 END;

    OnPreReport=BEGIN
                  IF SendToExcel THEN BEGIN
                    Window.OPEN(
                      Text000 +
                      '@1@@@@@@@@@@@@@@@@@@@@@\');
                    Window.UPDATE(1,0);
                    TempExcelBuffer.DELETEALL;
                    CLEAR(TempExcelBuffer);

                    AdsBufferTemp.FIND('-');
                    NoOfCol := 0;

                    //Header
                    EnterCell(1,2,'Ads. Booking Overview',TRUE,FALSE,FALSE,FALSE);
                    EnterCell(2,2,'Magazine Code : ' + MagazineFilter,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(3,2,'Volume No. : ' + VolumeFilter,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(4,2,'Issue No. : ' + IssueNoFilter,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(5,2,'Revenue Type : ' + RevenueTypeFilter,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(6,2,'Ads. Size : ' + AdsSizeFilter,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(7,2,'Ads. Position : ' + AdsPositionFilter,FALSE,FALSE,FALSE,FALSE);
                    EnterCell(8,2,'Include Line Status : ' + AdsBufferTemp.Status,FALSE,FALSE,FALSE,FALSE);
                    FOR i:= 1 TO 2 DO
                      EnterCell(9,i,'',FALSE,FALSE,TRUE,FALSE);
                    EnterCell(10,1,'Issue No.',FALSE,FALSE,TRUE,TRUE);
                    EnterCell(10,2,'Name',FALSE,FALSE,TRUE,TRUE);

                    CASE ShowAsColumn OF
                      ShowAsColumn::"Ads. Position":
                        BEGIN
                          i := 2;
                          IF AdsBufferTemp."Magazine Code Filter" <> '' THEN
                            AdsPosition.SETFILTER("Magazine Code",AdsBufferTemp."Magazine Code Filter");
                          NoOfCol := AdsPosition.COUNT;
                          AdsPosition.FIND('-');
                          REPEAT
                            i += 1;
                            EnterCell(9,i,'',FALSE,FALSE,TRUE,FALSE);
                            IF ShowColumnName THEN
                              EnterCell(10,i,AdsPosition.Description,FALSE,FALSE,TRUE,TRUE)
                            ELSE
                              EnterCell(10,i,AdsPosition.Code,FALSE,FALSE,TRUE,TRUE)
                          UNTIL AdsPosition.NEXT=0;
                        END;
                      ShowAsColumn::"Ads. Size":
                        BEGIN
                          i := 2;
                          NoOfCol := AdsSize.COUNT;
                          AdsSize.FIND('-');
                          REPEAT
                            i += 1;
                            EnterCell(9,i,'',FALSE,FALSE,TRUE,FALSE);
                            IF ShowColumnName THEN
                              EnterCell(10,i,AdsSize.Description,FALSE,FALSE,TRUE,TRUE)
                            ELSE
                              EnterCell(10,i,AdsSize.Code,FALSE,FALSE,TRUE,TRUE)
                          UNTIL AdsSize.NEXT=0;
                        END;
                      ShowAsColumn::"Revenue Type":
                        BEGIN
                          i := 2;
                          NoOfCol := RevenueType.COUNT;
                          RevenueType.FIND('-');
                          REPEAT
                            i += 1;
                            EnterCell(9,i,'',FALSE,FALSE,TRUE,FALSE);
                            IF ShowColumnName THEN
                              EnterCell(10,i,RevenueType.Description,FALSE,FALSE,TRUE,TRUE)
                            ELSE
                              EnterCell(10,i,RevenueType.Code,FALSE,FALSE,TRUE,TRUE)
                          UNTIL RevenueType.NEXT=0;
                        END;
                      ShowAsColumn::"Ads. Type":
                        BEGIN
                          i := 2;
                          NoOfCol := AdsType.COUNT;
                          AdsType.FIND('-');
                          REPEAT
                            i += 1;
                            EnterCell(9,i,'',FALSE,FALSE,TRUE,FALSE);
                            IF ShowColumnName THEN
                              EnterCell(10,i,AdsType.Description,FALSE,FALSE,TRUE,TRUE)
                            ELSE
                              EnterCell(10,i,AdsType.Code,FALSE,FALSE,TRUE,TRUE)
                          UNTIL AdsType.NEXT=0;
                        END;
                    END;

                    EnterCell(10,NoOfCol+3,'',FALSE,FALSE,FALSE,TRUE);
                    RowNo := 10;
                  END;
                  i := 0;
                END;

    OnPostReport=BEGIN
                   IF SendToExcel THEN BEGIN
                     Window.CLOSE;
                     {
                     IF Option = Option::"Update Workbook" THEN BEGIN
                       TempExcelBuffer.OpenBook(FileName,SheetName);
                       TempExcelBuffer.CreateSheet(SheetName,'',COMPANYNAME,USERID);
                     END ELSE BEGIN
                     }
                       TempExcelBuffer.CreateBook;
                       TempExcelBuffer.CreateSheet('Ads. Sales','Ads. Booking Overview',COMPANYNAME,USERID);
                     //END;
                     TempExcelBuffer.GiveUserControl;
                   END;
                 END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,AdsBufferTemp.COUNT);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN BEGIN
                             AdsBufferTemp.FIND('-');
                             ColumnWidth := 8;
                           END ELSE BEGIN
                             AdsBufferTemp.NEXT;
                             ColumnWidth := 0;
                           END;

                           WITH AdsBufferTemp DO BEGIN
                             IF SendToExcel THEN BEGIN
                               RowNo += 1;
                               RowHeight := 50;
                               EnterCell(RowNo,1,"Issue No.",FALSE,FALSE,TRUE,TRUE);
                               RowHeight := 0;
                               EnterCell(RowNo,2,Name,FALSE,FALSE,TRUE,TRUE);

                               i := 2;
                               CASE ShowAsColumn OF
                                 ShowAsColumn::"Ads. Position":
                                   BEGIN
                                     IF AdsBufferTemp."Magazine Code Filter" <> '' THEN
                                       AdsPosition.SETFILTER("Magazine Code",AdsBufferTemp."Magazine Code Filter");
                                     AdsPosition.FIND('-');
                                     REPEAT
                                       i += 1;
                                       EnterCell(RowNo,i,GetData(AdsBufferTemp,AdsPosition.Code),FALSE,FALSE,TRUE,TRUE);
                                     UNTIL AdsPosition.NEXT=0;
                                   END;
                                 ShowAsColumn::"Ads. Size":
                                   BEGIN
                                     AdsSize.FIND('-');
                                     REPEAT
                                       i += 1;
                                       EnterCell(RowNo,i,GetData(AdsBufferTemp,AdsSize.Code),FALSE,FALSE,TRUE,TRUE);
                                     UNTIL AdsSize.NEXT=0;
                                   END;
                                 ShowAsColumn::"Revenue Type":
                                   BEGIN
                                     RevenueType.FIND('-');
                                     REPEAT
                                       i += 1;
                                       EnterCell(RowNo,i,GetData(AdsBufferTemp,RevenueType.Code),FALSE,FALSE,TRUE,TRUE);
                                     UNTIL RevenueType.NEXT=0;
                                   END;
                                 ShowAsColumn::"Ads. Type":
                                   BEGIN
                                     AdsType.FIND('-');
                                     REPEAT
                                       i += 1;
                                       EnterCell(RowNo,i,GetData(AdsBufferTemp,AdsType.Code),FALSE,FALSE,TRUE,TRUE);
                                     UNTIL AdsType.NEXT=0;
                                   END;
                               END;
                               EnterCell(RowNo,i+1,'',FALSE,FALSE,FALSE,TRUE);
                             END;
                           END;
                         END;

      }
      SECTIONS
      {
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=15620;
      Height=4510;
    }
    CONTROLS
    {
      { 1000000000;Label  ;110  ;2970 ;2860 ;440  ;ParentControl=1000000001 }
      { 1000000001;TextBox;3080 ;2970 ;2750 ;440  ;Name=Dim2Filter;
                                                   Editable=No;
                                                   CaptionML=ENU=Ads. Position;
                                                   ClearOnLookup=No;
                                                   SourceExpr=AdsPositionFilter;
                                                   TableRelation="Ads. Position" }
      { 1000000002;TextBox;3080 ;2420 ;2750 ;440  ;Name=Dim2Filter;
                                                   Editable=No;
                                                   CaptionML=ENU=Ads. Size;
                                                   ClearOnLookup=No;
                                                   SourceExpr=AdsSizeFilter;
                                                   TableRelation="Ads. Size" }
      { 1000000003;Label  ;110  ;2420 ;2860 ;440  ;ParentControl=1000000002 }
      { 1000000004;TextBox;3080 ;1870 ;2750 ;440  ;Editable=No;
                                                   CaptionML=ENU=Revenue Type;
                                                   ClearOnLookup=No;
                                                   SourceExpr=RevenueTypeFilter;
                                                   TableRelation="Booking Revenue Type" }
      { 1000000005;Label  ;110  ;1870 ;2860 ;440  ;ParentControl=1000000004 }
      { 1000000006;TextBox;3080 ;1210 ;2750 ;440  ;Editable=No;
                                                   CaptionML=ENU=Issue No.;
                                                   ClearOnLookup=No;
                                                   SourceExpr=IssueNoFilter;
                                                   TableRelation="Issue No." }
      { 1000000007;Label  ;110  ;1210 ;2860 ;440  ;ParentControl=1000000006 }
      { 1000000008;TextBox;3080 ;660  ;2750 ;440  ;Editable=No;
                                                   CaptionML=ENU=Volume No.;
                                                   ClearOnLookup=No;
                                                   SourceExpr=VolumeFilter;
                                                   TableRelation=Volume }
      { 1000000009;Label  ;110  ;660  ;2860 ;440  ;ParentControl=1000000008 }
      { 1000000010;TextBox;3080 ;110  ;2750 ;440  ;Editable=No;
                                                   CaptionML=ENU=Magazine Code;
                                                   ClearOnLookup=No;
                                                   SourceExpr=MagazineFilter;
                                                   TableRelation=Magazine }
      { 1000000011;Label  ;110  ;110  ;2860 ;440  ;ParentControl=1000000010 }
      { 1000000012;Label  ;12210;110  ;3080 ;440  ;FontBold=Yes;
                                                   FontItalic=Yes;
                                                   CaptionML=ENU=Include Line Status }
      { 1000000013;Label  ;12650;660  ;2090 ;440  ;ParentControl=1000000020 }
      { 1000000014;Label  ;12650;1100 ;2090 ;440  ;ParentControl=1000000024 }
      { 1000000015;Label  ;12650;1540 ;2090 ;440  ;ParentControl=1000000021 }
      { 1000000016;Label  ;12650;1980 ;2090 ;440  ;ParentControl=1000000025 }
      { 1000000017;Label  ;12650;2420 ;2090 ;440  ;ParentControl=1000000026 }
      { 1000000018;Label  ;12650;2860 ;2090 ;440  ;ParentControl=1000000023 }
      { 1000000019;Label  ;12650;3300 ;2090 ;440  ;ParentControl=1000000022 }
      { 1000000020;CheckBox;14850;660 ;440  ;440  ;Editable=No;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Booking;
                                                   SourceExpr=StBooking }
      { 1000000021;CheckBox;14850;1540;440  ;440  ;Editable=No;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Confirmed;
                                                   SourceExpr=StConfirmed }
      { 1000000022;CheckBox;14850;3300;440  ;440  ;Editable=No;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Invoiced;
                                                   SourceExpr=StInvoiced }
      { 1000000023;CheckBox;14850;2860;440  ;440  ;Editable=No;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Cancelled;
                                                   SourceExpr=StCancelled }
      { 1000000024;CheckBox;14850;1100;440  ;440  ;Editable=No;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Waiting List;
                                                   SourceExpr=StWaitingList }
      { 1000000025;CheckBox;14850;1980;440  ;440  ;Editable=No;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Approved;
                                                   SourceExpr=StApproved }
      { 1000000026;CheckBox;14850;2420;440  ;440  ;Editable=No;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Hold;
                                                   SourceExpr=StHold }
      { 1000000027;CheckBox;14850;3740;440  ;440  ;Editable=No;
                                                   ShowCaption=No;
                                                   CaptionML=ENU=Closed;
                                                   SourceExpr=StClosed }
      { 1000000028;Label  ;12650;3740 ;2090 ;440  ;ParentControl=1000000027 }
      { 1000000029;Label  ;6160 ;660  ;2860 ;440  ;ParentControl=1000000030 }
      { 1000000030;CheckBox;9130;660  ;440  ;440  ;Editable=No;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Show Column Name;
                                                              THA=แสดงชื่อคอลัมน์];
                                                   SourceExpr=ShowColumnName }
      { 1000000031;TextBox;9130 ;110  ;2750 ;440  ;Editable=No;
                                                   CaptionML=[ENU=Show as Columns;
                                                              THA=แสดงเป็นคอลัมน์];
                                                   SourceExpr=ShowAsColumn }
      { 1000000032;Label  ;6160 ;110  ;2860 ;440  ;ParentControl=1000000031 }
      { 1000000033;TextBox;3080 ;3520 ;2750 ;440  ;Name=Dim2Filter;
                                                   Editable=No;
                                                   CaptionML=ENU=Ads. Type;
                                                   ClearOnLookup=No;
                                                   SourceExpr=AdsTypeFilter;
                                                   TableRelation="Ads. Type" }
      { 1000000034;Label  ;110  ;3520 ;2860 ;440  ;ParentControl=1000000033 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AdsBufferTemp@1000000000 : TEMPORARY Record 50049;
      AdsPosition@1000000025 : Record 50029;
      AdsSize@1000000024 : Record 50028;
      AdsType@1000000032 : Record 50032;
      RevenueType@1000000023 : Record 50027;
      Salesperson@1000000027 : Record 13;
      TempExcelBuffer@1000000015 : TEMPORARY Record 370;
      MagazineFilter@1000000006 : Code[250];
      VolumeFilter@1000000005 : Code[20];
      IssueNoFilter@1000000004 : Code[20];
      RevenueTypeFilter@1000000003 : Code[20];
      AdsSizeFilter@1000000002 : Code[20];
      AdsTypeFilter@1000000033 : Code[20];
      AdsPositionFilter@1000000001 : Code[20];
      StBooking@1000000014 : Boolean;
      StWaitingList@1000000013 : Boolean;
      StConfirmed@1000000012 : Boolean;
      StApproved@1000000011 : Boolean;
      StHold@1000000010 : Boolean;
      StCancelled@1000000009 : Boolean;
      StInvoiced@1000000008 : Boolean;
      StClosed@1000000007 : Boolean;
      ShowColumnName@1000000022 : Boolean;
      ShowAsColumn@1000000021 : 'Ads. Position,Ads. Size,Revenue Type,Ads. Type';
      Window@1000000019 : Dialog;
      RowNo@1000000018 : Integer;
      SendToExcel@1000000017 : Boolean;
      Text000@1000000016 : TextConst 'ENU=Analyzing Data...\\;THA=กำลังวิเคราะห์ข้อมูล...\\';
      i@1000000020 : Integer;
      NoOfCol@1000000026 : Integer;
      NewLine@1000000028 : TextConst 'ENU=
    ';
      ColumnWidth@1000000029 : Decimal;
      RowHeight@1000000030 : Decimal;
      st@1000000031 : TextConst 'ENU=''';

    PROCEDURE InitRequest@1000000000(VAR AdsBuffer@1000000000 : Record 50049);
    BEGIN
      AdsBufferTemp.INIT;
      AdsBufferTemp := AdsBuffer;
      AdsBufferTemp.INSERT;
      AdsBufferTemp.COPYFILTERS(AdsBuffer);
    END;

    PROCEDURE InitRequest2@1000000001(_MagazineFilter@1000000006 : Code[250];_VolumeFilter@1000000005 : Code[20];_IssueNoFilter@1000000004 : Code[20];_RevenueTypeFilter@1000000003 : Code[20];_AdsSizeFilter@1000000002 : Code[20];_AdsTypeFilter@1000000016 : Code[20];_AdsPositionFilter@1000000001 : Code[20];_StBooking@1000000013 : Boolean;_StWaitingList@1000000012 : Boolean;_StConfirmed@1000000011 : Boolean;_StApproved@1000000010 : Boolean;_StHold@1000000009 : Boolean;_StCancelled@1000000008 : Boolean;_StInvoiced@1000000007 : Boolean;_StClosed@1000000000 : Boolean;_ShowColumnName@1000000015 : Boolean;_ShowAsColumn@1000000014 : 'Ads. Position,Ads. Size,Revenue Type');
    BEGIN
      MagazineFilter := _MagazineFilter;
      VolumeFilter := _VolumeFilter;
      IssueNoFilter := _IssueNoFilter;
      RevenueTypeFilter := _RevenueTypeFilter;
      AdsSizeFilter := _AdsSizeFilter;
      AdsTypeFilter := _AdsTypeFilter;
      AdsPositionFilter := _AdsPositionFilter;
      StBooking := _StBooking;
      StWaitingList := _StWaitingList;
      StConfirmed := _StConfirmed;
      StApproved := _StApproved;
      StHold := _StHold;
      StCancelled := _StCancelled;
      StInvoiced := _StInvoiced;
      StClosed := _StClosed;
      ShowColumnName := _ShowColumnName;
      ShowAsColumn := _ShowAsColumn;
    END;

    LOCAL PROCEDURE GetData@27(VAR AdsBuff@1000000002 : Record 50049;ColumnCode@1000000001 : Code[20]) : Text[250];
    VAR
      AdsBookingLine@1000000000 : Record 50038;
      AdsProduct@1000000004 : Record 50031;
      Qty@1000000003 : Decimal;
    BEGIN
      Qty := 0;
      WITH AdsBuff DO BEGIN
        AdsBookingLine.RESET;
        AdsBookingLine.SETCURRENTKEY("Magazine Code","Volume No.","Issue No.","Line Status",
          "Booking Revenue Code","Ads. Size","Ads. Type","Ads. Position","Salesperson Code");

        IF "Magazine Code Filter" <> '' THEN
          AdsBookingLine.SETRANGE("Magazine Code","Magazine Code Filter");
        IF "Volume No. Filter" <> '' THEN
          AdsBookingLine.SETRANGE("Volume No.","Volume No. Filter");
        IF "Issue No. Filter" <> '' THEN
          AdsBookingLine.SETRANGE("Issue No.","Issue No. Filter");
        COPYFILTER("Line Status Filter",AdsBookingLine."Line Status");

        IF (ShowAsColumn = ShowAsColumn::"Ads. Size") AND (ColumnCode <> '') THEN BEGIN
          IF "Ads. Size Filter" <> '' THEN
            AdsBookingLine.SETFILTER("Ads. Size",'%1&%2',ColumnCode,"Ads. Size Filter")
          ELSE
            AdsBookingLine.SETRANGE("Ads. Size",ColumnCode);
        END ELSE
          IF "Ads. Size Filter" <> '' THEN
            AdsBookingLine.SETRANGE("Ads. Size","Ads. Size Filter");

        IF (ShowAsColumn = ShowAsColumn::"Ads. Type") AND (ColumnCode <> '') THEN BEGIN
          IF "Ads. Type Filter" <> '' THEN
            AdsBookingLine.SETFILTER("Ads. Type",'%1&%2',ColumnCode,"Ads. Type Filter")
          ELSE
            AdsBookingLine.SETRANGE("Ads. Type",ColumnCode);
        END ELSE
          IF "Ads. Type Filter" <> '' THEN
            AdsBookingLine.SETRANGE("Ads. Type","Ads. Type Filter");

        IF (ShowAsColumn = ShowAsColumn::"Ads. Position") AND (ColumnCode <> '') THEN BEGIN
          IF "Ads. Position Filter" <> '' THEN
            AdsBookingLine.SETFILTER("Ads. Position",'%1&%2',ColumnCode,"Ads. Position Filter")
          ELSE
            AdsBookingLine.SETRANGE("Ads. Position",ColumnCode);
        END ELSE
          IF "Ads. Position Filter" <> '' THEN
            AdsBookingLine.SETRANGE("Ads. Position","Ads. Position Filter");

        IF (ShowAsColumn = ShowAsColumn::"Revenue Type") AND (ColumnCode <> '') THEN BEGIN
          IF "Booking Revenue Code Filter" <> '' THEN
            AdsBookingLine.SETFILTER("Booking Revenue Code",'%1&%2',ColumnCode,"Booking Revenue Code Filter")
          ELSE
            AdsBookingLine.SETFILTER("Booking Revenue Code",ColumnCode);
        END ELSE
          IF "Booking Revenue Code Filter" <> '' THEN
            AdsBookingLine.SETRANGE("Booking Revenue Code","Booking Revenue Code Filter");

        {
        IF (ShowAsColumn = ShowAsColumn::"Ads. Size") AND (ColumnCode <> '') THEN
          AdsBookingLine.SETRANGE("Ads. Size",ColumnCode)
        ELSE
          IF "Ads. Size Filter" <> '' THEN
            AdsBookingLine.SETRANGE("Ads. Size","Ads. Size Filter");
        IF (ShowAsColumn = ShowAsColumn::"Ads. Type") AND (ColumnCode <> '') THEN
          AdsBookingLine.SETRANGE("Ads. Type",ColumnCode)
        ELSE
          IF "Ads. Type Filter" <> '' THEN
            AdsBookingLine.SETRANGE("Ads. Type","Ads. Type Filter");
        IF (ShowAsColumn = ShowAsColumn::"Ads. Position") AND (ColumnCode <> '') THEN
          AdsBookingLine.SETRANGE("Ads. Position",ColumnCode)
        ELSE
          IF "Ads. Position Filter" <> '' THEN
            AdsBookingLine.SETRANGE("Ads. Position","Ads. Position Filter");
        IF (ShowAsColumn = ShowAsColumn::"Revenue Type") AND (ColumnCode <> '') THEN
          AdsBookingLine.SETFILTER("Booking Revenue Code",ColumnCode)
        ELSE
          IF "Booking Revenue Code Filter" <> '' THEN
            AdsBookingLine.SETRANGE("Booking Revenue Code","Booking Revenue Code Filter");
        }

        COPYFILTER("Salesperson Filter",AdsBookingLine."Salesperson Code");
        IF AdsBookingLine.FIND('-') THEN BEGIN
          //AdsBookingLine.CALCSUMS("Counting Unit");
          //Qty := AdsBookingLine."Counting Unit";
          AdsBookingLine.CALCSUMS("Total Counting Unit");
          Qty := AdsBookingLine."Total Counting Unit";
          IF NOT AdsProduct.GET(AdsBookingLine."Ads. Product") THEN
            CLEAR(AdsProduct);
        END;
      END;
      IF Qty <> 0 THEN
        EXIT(STRSUBSTNO('%1 %2 %3',
          Qty,
          NewLine + AdsProduct."Short Description",
          NewLine + FORMAT(AdsBookingLine.Amount,0,'<Precision,2:3><Standard Format,0>') + ' ' + AdsBookingLine."Ads. Size"))
      ELSE
        EXIT('');
    END;

    LOCAL PROCEDURE EnterCell@2(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Bold@1003 : Boolean;Italic@1004 : Boolean;UnderLine@1005 : Boolean;EdgeLeft@1000000000 : Boolean);
    BEGIN
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := Bold;
      TempExcelBuffer.Italic := Italic;
      TempExcelBuffer.Underline := UnderLine;
      IF UnderLine THEN
        TempExcelBuffer."Line Style" := 1;
      TempExcelBuffer.EdgeLeft := EdgeLeft;
      TempExcelBuffer.NumberFormat := '@';
      IF ColumnNo = 2 THEN BEGIN
        TempExcelBuffer."AutoFit Column" := TRUE;
      END ELSE BEGIN
        TempExcelBuffer."Column Width" := ColumnWidth;
        TempExcelBuffer."Row Height" := RowHeight;
      END;
      TempExcelBuffer.INSERT;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   09.05.2007   KKE   New report for "Ads. Booking Overview" - Ads. Sales Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50048 Ads. Booking Worksheet
{
  OBJECT-PROPERTIES
  {
    Date=08/08/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  AdsBoolingLineFilter := "Ads. Booking Line".GETFILTERS;
                END;

    Orientation=Landscape;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50038;
        DataItemTableView=SORTING(Ads. Item No.,Line Status);
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("Ads. Item No.");
                      END;

        ReqFilterFields=Ads. Item No.;
        TotalFields=Quantity;
        GroupTotalFields=Ads. Item No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27900;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000007;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Ads. Booking Worksheet }
            { 1000000010;TextBox;24600;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Ads. Booking Worksheet") }
            { 1000000013;TextBox;24600;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000016;TextBox;27300;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000019;Label  ;26550;423  ;750  ;423  ;ParentControl=1000000016 }
            { 1000000022;TextBox;25500;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27900;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000004;TextBox;0    ;0    ;24700;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',"Ads. Booking Line".TABLECAPTION,AdsBoolingLineFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27900;
            SectionHeight=1400;
          }
          CONTROLS
          {
            { 1000000012;Label  ;0    ;100  ;2300 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000015;Label  ;2500 ;100  ;1400 ;846  ;ParentControl=1000000014;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;4100 ;100  ;3000 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000021;Label  ;7200 ;100  ;2500 ;846  ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000024;Label  ;9900 ;100  ;1800 ;846  ;ParentControl=1000000023;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000027;Label  ;11800;100  ;1400 ;846  ;ParentControl=1000000026;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000030;Label  ;13400;100  ;2300 ;846  ;ParentControl=1000000029;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000033;Label  ;15900;100  ;1700 ;846  ;ParentControl=1000000032;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000036;Label  ;17800;100  ;1700 ;846  ;ParentControl=1000000035;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000039;Label  ;19700;100  ;1800 ;846  ;ParentControl=1000000038;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000042;Label  ;21650;100  ;1900 ;846  ;ParentControl=1000000041;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000045;Label  ;23700;100  ;1800 ;846  ;ParentControl=1000000044;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000048;Label  ;25700;100  ;2000 ;846  ;ParentControl=1000000047;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000001;Shape  ;0    ;0    ;27700;30   ;ShapeStyle=HorzLine }
            { 1000000002;Shape  ;0    ;1100 ;27700;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=27900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FooterPrinted;
                           FooterPrinted := FALSE;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=27900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Ads. Booking Line".FIELDNO("Ads. Item No.");
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;2600 ;0    ;3350 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Ads. Item No." }
            { 1000000009;Label  ;0    ;0    ;2500 ;423  ;ParentControl=1000000008;
                                                         FontSize=8;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=27900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = LastFieldNo;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27900;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000011;TextBox;0    ;0    ;2300 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Booking No." }
            { 1000000014;TextBox;2500 ;0    ;1400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Booking Date" }
            { 1000000017;TextBox;4100 ;0    ;3000 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Item No." }
            { 1000000020;TextBox;7200 ;0    ;2500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Magazine Code" }
            { 1000000023;TextBox;9900 ;0    ;1800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Volume No." }
            { 1000000026;TextBox;11800;0    ;1400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Issue No." }
            { 1000000029;TextBox;13400;0    ;2300 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Booking Revenue Code" }
            { 1000000032;TextBox;15900;0    ;1700 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Size" }
            { 1000000035;TextBox;17800;0    ;1700 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Product" }
            { 1000000038;TextBox;19700;0    ;1800 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=Quantity }
            { 1000000041;TextBox;21700;0    ;1800 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr="Unit Price Excl. VAT" }
            { 1000000044;TextBox;23700;0    ;1800 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr="Counting Unit" }
            { 1000000047;TextBox;25700;0    ;2000 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Line Status" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=27900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF NOT FooterPrinted THEN
                             LastFieldNo := CurrReport.TOTALSCAUSEDBY;
                           CurrReport.SHOWOUTPUT := NOT FooterPrinted;
                           FooterPrinted := TRUE;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=27900;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Ads. Booking Line".FIELDNO("Ads. Item No.");
                         END;

          }
          CONTROLS
          {
            { 1000000049;TextBox;0    ;0    ;8000 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalFor + FIELDCAPTION("Ads. Item No.") }
            { 1000000050;TextBox;19400;0    ;2200 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Quantity }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000003;TextBox;0    ;300  ;8000 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='Grand Total' }
            { 1000000005;TextBox;19400;300  ;2200 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Quantity }
            { 1000000006;Shape  ;0    ;200  ;27700;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AdsBoolingLineFilter@1000000003 : Text[250];
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      TotalFor@1000000002 : TextConst 'ENU="Total for "';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.05.2007   KKE   New report for "Ads. Booking Worksheet" - Ads. Sales Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50049 Ads. Sale Report by Issue No.
{
  OBJECT-PROPERTIES
  {
    Date=04/02/08;
    Time=[ 2:50:50 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  AdsBookingLineFilter := "Ads. Booking Line".GETFILTERS;
                END;

    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50038;
        DataItemTableView=SORTING(Ads. Item No.,Ads. Type,Ads. Position);
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("Ads. Item No.");
                      END;

        OnAfterGetRecord=BEGIN
                           AdsBookingHdr.GET("Booking No.");
                           IF NOT Cust.GET("Sell-to Customer No.") THEN
                             CLEAR(Cust);
                           IF NOT AdsPosition.GET("Ads. Position") THEN
                             CLEAR(AdsPosition);
                           IF NOT AdsProduct.GET("Ads. Product") THEN
                             CLEAR(AdsProduct);
                           IF NOT Salesperson.GET("Salesperson Code") THEN
                             CLEAR(Salesperson);
                         END;

        ReqFilterFields=Ads. Item No.,Line Status;
        TotalFields=Amount;
        GroupTotalFields=Ads. Item No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000007;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Ads. Sale Report by Issue No. }
            { 1000000010;TextBox;16100;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Ads. Sale Report by Issue No.") }
            { 1000000013;TextBox;16100;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=7;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000014;TextBox;18800;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000015;Label  ;18050;423  ;750  ;423  ;ParentControl=1000000014 }
            { 1000000016;TextBox;17000;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := AdsBookingLineFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000001;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',"Ads. Booking Line".TABLECAPTION,AdsBookingLineFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000012;Label  ;0    ;423  ;1800 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;1950 ;423  ;1500 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000021;Label  ;3600 ;423  ;1950 ;846  ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000024;Label  ;5700 ;423  ;1200 ;846  ;ParentControl=1000000023;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000027;Label  ;7050 ;423  ;1050 ;846  ;ParentControl=1000000026;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000030;Label  ;8250 ;423  ;1500 ;846  ;ParentControl=1000000029;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000033;Label  ;9900 ;423  ;1050 ;846  ;ParentControl=1000000032;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000036;Label  ;11100;423  ;1350 ;846  ;ParentControl=1000000035;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000039;Label  ;12600;423  ;1650 ;846  ;ParentControl=1000000038;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000042;Label  ;14400;423  ;1500 ;846  ;ParentControl=1000000041;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000045;Label  ;16050;423  ;1200 ;846  ;ParentControl=1000000044;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000048;Label  ;17400;423  ;1800 ;846  ;ParentControl=1000000047;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000002;Shape  ;0    ;0    ;19200;423  ;ShapeStyle=HorzLine }
            { 1000000003;Shape  ;0    ;1269 ;19200;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FooterPrinted;
                           FooterPrinted := FALSE;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Ads. Booking Line".FIELDNO("Ads. Item No.");
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;0    ;0    ;8400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr='Ads. Item No. : ' + "Ads. Item No." }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = LastFieldNo;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000011;TextBox;0    ;0    ;2100 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Booking No." }
            { 1000000017;TextBox;2100 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Sale Type;
                                                         SourceExpr=AdsBookingHdr."Ads. Sales Type" }
            { 1000000020;TextBox;3600 ;0    ;1950 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Cust No.;
                                                         SourceExpr="Sell-to Customer No." }
            { 1000000023;TextBox;5700 ;0    ;1200 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Line Status" }
            { 1000000026;TextBox;7050 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Type" }
            { 1000000029;TextBox;8250 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Sub-Type" }
            { 1000000032;TextBox;9900 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Size" }
            { 1000000035;TextBox;11100;0    ;1350 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Position" }
            { 1000000038;TextBox;12600;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Product" }
            { 1000000041;TextBox;14400;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Sales person;
                                                         SourceExpr="Salesperson Code" }
            { 1000000044;TextBox;16050;0    ;1200 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=ENU=Qty;
                                                         SourceExpr=Quantity }
            { 1000000047;TextBox;17400;0    ;1800 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=Amount }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000009;TextBox;300  ;0    ;6300 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=ENU=Cust No.;
                                                         SourceExpr=Cust.Name }
            { 1000000019;TextBox;6750 ;0    ;3900 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=AdsPosition.Description }
            { 1000000022;TextBox;10800;0    ;3450 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=AdsProduct.Description }
            { 1000000025;TextBox;14400;0    ;3450 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Sales person;
                                                         SourceExpr=Salesperson.Name }
            { 1000000028;Shape  ;0    ;1069 ;19200;200  ;ShapeStyle=HorzLine }
            { 1000000031;TextBox;1900 ;500  ;17100;423  ;SourceExpr=Remark }
            { 1000000034;Label  ;0    ;500  ;1700 ;400  ;HorzAlign=Center;
                                                         CaptionML=ENU="Remark : " }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF NOT FooterPrinted THEN
                             LastFieldNo := CurrReport.TOTALSCAUSEDBY;
                           CurrReport.SHOWOUTPUT := NOT FooterPrinted;
                           FooterPrinted := TRUE;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Ads. Booking Line".FIELDNO("Ads. Item No.");
                         END;

          }
          CONTROLS
          {
            { 1000000049;TextBox;0    ;0    ;6450 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalFor + FIELDCAPTION("Ads. Item No.") }
            { 1000000050;TextBox;16650;0    ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Amount }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000004;TextBox;0    ;423  ;6450 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='Grand Total' }
            { 1000000005;TextBox;16650;423  ;2550 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Amount }
            { 1000000006;Shape  ;0    ;0    ;19200;423  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AdsBookingHdr@1000000003 : Record 50037;
      Cust@1000000005 : Record 18;
      AdsPosition@1000000006 : Record 50029;
      AdsProduct@1000000007 : Record 50031;
      Salesperson@1000000008 : Record 13;
      AdsBookingLineFilter@1000000004 : Text[250];
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      TotalFor@1000000002 : TextConst 'ENU="Total for "';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   15.05.2007   KKE   New report for "Ads. Sale Report by Issue No." - Ads. Sales Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50050 Ads. by Issue No for Editorial
{
  OBJECT-PROPERTIES
  {
    Date=12/26/11;
    Time=10:38:07 AM;
    Modified=Yes;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  AdsBookingLineFilter := "Ads. Booking Line".GETFILTERS;
                  AdsBookingLine.COPYFILTERS("Ads. Booking Line");
                END;

    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50036;
        DataItemTableView=SORTING(Ads. Item No.);
        NewPagePerRecord=Yes;
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        SETFILTER("Ads. Item No.",AdsBookingLine.GETFILTER("Ads. Item No."));
                      END;

        OnAfterGetRecord=BEGIN
                           TotalPagesByItem := 0;
                           AdsBookingLineTemp2.DELETEALL;
                         END;

        GroupTotalFields=Ads. Item No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=21500;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000007;Label  ;0    ;0    ;8850 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Ads. Sale Report by Issue No. for Editorial }
            { 1000000010;TextBox;16100;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Ads. by Issue No for Editorial") }
            { 1000000013;TextBox;16100;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=7;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000014;TextBox;18800;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000015;Label  ;18050;423  ;750  ;423  ;ParentControl=1000000014 }
            { 1000000016;TextBox;17000;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=21500;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := AdsBookingLineFilter <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000001;TextBox;0    ;0    ;19300;423  ;FontSize=8;
                                                         SourceExpr=STRSUBSTNO('%1: %2',"Ads. Booking Line".TABLECAPTION,AdsBookingLineFilter) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=21500;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000012;Label  ;0    ;423  ;1800 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;1950 ;423  ;1500 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000021;Label  ;3600 ;423  ;1800 ;846  ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000024;Label  ;16050;423  ;1200 ;846  ;ParentControl=1000000023;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Count Unit }
            { 1000000027;Label  ;5550 ;423  ;1050 ;846  ;ParentControl=1000000026;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000030;Label  ;6750 ;423  ;1500 ;846  ;ParentControl=1000000029;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000033;Label  ;8400 ;423  ;1050 ;846  ;ParentControl=1000000032;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000036;Label  ;9600 ;423  ;1350 ;846  ;ParentControl=1000000035;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000039;Label  ;11100;423  ;1650 ;846  ;ParentControl=1000000038;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000042;Label  ;12900;423  ;1650 ;846  ;ParentControl=1000000041;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000045;Label  ;14700;423  ;1200 ;846  ;ParentControl=1000000044;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000048;Label  ;17400;423  ;1800 ;846  ;ParentControl=1000000047;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000002;Shape  ;0    ;0    ;19200;423  ;ShapeStyle=HorzLine }
            { 1000000003;Shape  ;0    ;1269 ;19200;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=21500;
            SectionHeight=800;
          }
          CONTROLS
          {
            { 1000000008;TextBox;0    ;200  ;8400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr='Ads. Item No. : ' + "Ads. Item No." }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50032;
        DataItemTableView=SORTING(Code);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        SETFILTER(Code,AdsBookingLine.GETFILTER("Ads. Type"));
                      END;

        OnAfterGetRecord=BEGIN
                           TotalPages := 0;
                           AdsBookingLineTemp1.RESET;
                           AdsBookingLineTemp1.DELETEALL;
                           x := 0;
                         END;

        GroupTotalFields=Code;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=21500;
            SectionHeight=800;
          }
          CONTROLS
          {
            { 1000000009;TextBox;300  ;200  ;12300;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr='Ads. Type : ' + Code + ' (' + Description +')' }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=21500;
            SectionHeight=1200;
          }
          CONTROLS
          {
            { 1000000019;TextBox;6400 ;100  ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='*** Total Pages by ' + Description }
            { 1000000022;TextBox;16700;100  ;2500 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalPages }
            { 1000000051;TextBox;6400 ;600  ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='*** Total Amount by ' + Description }
            { 1000000054;TextBox;16700;600  ;2500 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Ads. Booking Line".Amount }
            { 1000000025;Shape  ;6400 ;600  ;12800;30   ;ShapeStyle=HorzLine }
            { 1000000028;Shape  ;6400 ;1100 ;12800;30   ;ShapeStyle=HorzLine }
            { 1000000040;Shape  ;6400 ;100  ;12800;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table50038;
        DataItemTableView=SORTING(Ads. Item No.,Ads. Type,Ads. Position);
        OnPreDataItem=BEGIN
                        SETRANGE("Ads. Item No.","Ads. Item"."Ads. Item No.");
                      END;

        OnAfterGetRecord=BEGIN
                           AdsBookingHdr.GET("Booking No.");
                           TotalPages := Quantity * "Counting Unit";
                           TotalPagesByItem += TotalPages;
                           GrandTotalPages += TotalPages;

                           AdsBookingLineTemp1.RESET;
                           AdsBookingLineTemp1.SETRANGE("Ads. Size","Ads. Size");
                           IF AdsBookingLineTemp1.FIND('-') THEN BEGIN
                             AdsBookingLineTemp1.Quantity += Quantity;
                             AdsBookingLineTemp1.MODIFY;
                           END ELSE BEGIN
                             x += 1;
                             AdsBookingLineTemp1.INIT;
                             AdsBookingLineTemp1."Line No." := x;
                             AdsBookingLineTemp1."Ads. Size" := "Ads. Size";
                             AdsBookingLineTemp1.Quantity := Quantity;
                             AdsBookingLineTemp1.INSERT;
                           END;
                         END;

        ReqFilterFields=Ads. Item No.,Ads. Type;
        TotalFields=Quantity,Amount,Counting Unit;
        DataItemLink=Ads. Type=FIELD(Code);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=21500;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000011;TextBox;0    ;0    ;1800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Booking No." }
            { 1000000017;TextBox;1950 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Sale Type;
                                                         SourceExpr=AdsBookingHdr."Ads. Sales Type" }
            { 1000000020;TextBox;3600 ;0    ;1800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Cust No.;
                                                         SourceExpr="Sell-to Customer No." }
            { 1000000023;TextBox;16050;0    ;1200 ;423  ;HorzAlign=General;
                                                         FontSize=8;
                                                         SourceExpr="Counting Unit" }
            { 1000000026;TextBox;5550 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Type" }
            { 1000000029;TextBox;6750 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Sub-Type" }
            { 1000000032;TextBox;8400 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Size" }
            { 1000000035;TextBox;9600 ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Position" }
            { 1000000038;TextBox;11100;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Product" }
            { 1000000041;TextBox;12900;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Sales person;
                                                         SourceExpr="Salesperson Code" }
            { 1000000044;TextBox;14700;0    ;1200 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=ENU=Qty;
                                                         SourceExpr=Quantity }
            { 1000000047;TextBox;17400;0    ;1800 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=Amount }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=21500;
            SectionHeight=400;
            OnPreSection=BEGIN
                           i += 1;
                           AdsBookingLineTemp2.INIT;
                           AdsBookingLineTemp2."Line No." := i;
                           AdsBookingLineTemp2."Ads. Type" := "Ads. Type";
                           AdsBookingLineTemp2.Quantity := Quantity;
                           AdsBookingLineTemp2.Amount := Amount;
                           AdsBookingLineTemp2."Counting Unit" := TotalPages;
                           AdsBookingLineTemp2.INSERT;

                           AdsBookingLineTemp3.SETRANGE("Ads. Type","Ads. Type");
                           IF AdsBookingLineTemp3.FIND('-') THEN BEGIN
                             AdsBookingLineTemp3.Quantity += Quantity;
                             AdsBookingLineTemp3.Amount += Amount;
                             AdsBookingLineTemp3."Counting Unit" += TotalPages;
                             AdsBookingLineTemp3.MODIFY;
                           END ELSE BEGIN
                             AdsBookingLineTemp3.INIT;
                             AdsBookingLineTemp3 := AdsBookingLineTemp2;
                             AdsBookingLineTemp3.INSERT;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000108;Label  ;100  ;0    ;5900 ;400  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=SummaryAdsSize;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,AdsBookingLineTemp1.COUNT);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             AdsBookingLineTemp1.FIND('-')
                           ELSE
                             AdsBookingLineTemp1.NEXT;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=21500;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000005;TextBox;16700;0    ;2500 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AdsBookingLineTemp1.Quantity }
            { 1000000006;TextBox;8500 ;0    ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='*** Total Pages by Ads. Size ' + AdsBookingLineTemp1."Ads. Size" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50038;
        DataItemTableView=SORTING(Ads. Item No.,Ads. Type,Ads. Position);
        DataItemVarName=Blank Ads. Type;
        OnPreDataItem=BEGIN
                        //for ads. type = blank
                        SETRANGE("Ads. Type",'');
                      END;

        DataItemLink=Ads. Item No.=FIELD(Ads. Item No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=21500;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000004;TextBox;300  ;200  ;12300;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr='Ads. Type : ' }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=21500;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000062;TextBox;0    ;0    ;1800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Booking No." }
            { 1000000063;TextBox;1950 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Sale Type;
                                                         SourceExpr=AdsBookingHdr."Ads. Sales Type" }
            { 1000000064;TextBox;3600 ;0    ;1800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Cust No.;
                                                         SourceExpr="Sell-to Customer No." }
            { 1000000065;TextBox;16050;0    ;1200 ;423  ;HorzAlign=General;
                                                         FontSize=8;
                                                         SourceExpr="Counting Unit" }
            { 1000000066;TextBox;5550 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Type" }
            { 1000000067;TextBox;6750 ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Sub-Type" }
            { 1000000068;TextBox;8400 ;0    ;1050 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Size" }
            { 1000000069;TextBox;9600 ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Position" }
            { 1000000070;TextBox;11100;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Ads. Product" }
            { 1000000071;TextBox;12900;0    ;1650 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Sales person;
                                                         SourceExpr="Salesperson Code" }
            { 1000000072;TextBox;14700;0    ;1200 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=ENU=Qty;
                                                         SourceExpr=Quantity }
            { 1000000073;TextBox;17400;0    ;1800 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=Amount }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=21500;
            SectionHeight=1200;
          }
          CONTROLS
          {
            { 1000000075;TextBox;16700;100  ;2500 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Amount }
            { 1000000077;TextBox;16700;600  ;2500 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=Amount }
            { 1000000043;TextBox;6400 ;100  ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='*** Total Pages by ' }
            { 1000000046;Shape  ;6400 ;100  ;12800;30   ;ShapeStyle=HorzLine }
            { 1000000050;TextBox;6400 ;600  ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='*** Total Amount by ' }
            { 1000000074;Shape  ;6400 ;600  ;12800;30   ;ShapeStyle=HorzLine }
            { 1000000076;Shape  ;6400 ;1100 ;12800;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=SummaryByItem;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,AdsBookingLineTemp2.COUNT);
                        CurrReport.CREATETOTALS(AdsBookingLineTemp2.Amount);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             AdsBookingLineTemp2.FIND('-')
                           ELSE
                             AdsBookingLineTemp2.NEXT;

                           IF NOT AdsType.GET(AdsBookingLineTemp2."Ads. Type") THEN
                             CLEAR(AdsType);
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=21500;
            SectionHeight=1000;
          }
          CONTROLS
          {
            { 1000000087;Shape  ;10   ;300  ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000089;Shape  ;0    ;300  ;30   ;700  ;ShapeStyle=VertLine }
            { 1000000090;Shape  ;19200;300  ;30   ;700  ;ShapeStyle=VertLine }
            { 1000000049;TextBox;400  ;400  ;8700 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr='*** SUMMARY FOR ADS. ITEM ' + "Ads. Item"."Ads. Item No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=21500;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000091;Shape  ;19200;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000092;Shape  ;0    ;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000093;TextBox;8700 ;0    ;3400 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AdsBookingLineTemp2.Amount }
            { 1000000094;TextBox;700  ;0    ;7800 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='Total ' + AdsType.Description }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=21500;
            SectionHeight=1930;
            OnPreSection=BEGIN
                           AveragePerPage := 0;
                           IF TotalPagesByItem <> 0 THEN
                             AveragePerPage := AdsBookingLineTemp2.Amount / TotalPagesByItem;
                         END;

          }
          CONTROLS
          {
            { 1000000095;Shape  ;10   ;1900 ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000096;Label  ;700  ;100  ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=*** Total Amount }
            { 1000000097;Label  ;700  ;600  ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=*** Total Pages }
            { 1000000098;Label  ;700  ;1100 ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=*** Average / Page }
            { 1000000099;Shape  ;0    ;0    ;30   ;1900 ;ShapeStyle=VertLine }
            { 1000000100;Shape  ;19200;0    ;30   ;1900 ;ShapeStyle=VertLine }
            { 1000000101;TextBox;8700 ;100  ;3400 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AdsBookingLineTemp2.Amount }
            { 1000000102;TextBox;8700 ;600  ;3400 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalPagesByItem }
            { 1000000103;TextBox;8700 ;1100 ;3400 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AveragePerPage }
            { 1000000104;Shape  ;8700 ;100  ;3400 ;30   ;ShapeStyle=HorzLine }
            { 1000000105;Shape  ;8700 ;1100 ;3400 ;30   ;ShapeStyle=HorzLine }
            { 1000000106;Shape  ;8700 ;1600 ;3400 ;30   ;ShapeStyle=HorzLine }
            { 1000000107;Shape  ;8700 ;1700 ;3400 ;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=GrandSummary;
        OnPreDataItem=BEGIN
                        AdsBookingLineTemp3.RESET;
                        SETRANGE(Number,1,AdsBookingLineTemp3.COUNT);
                        CurrReport.CREATETOTALS(AdsBookingLineTemp3.Amount);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             AdsBookingLineTemp3.FIND('-')
                           ELSE
                             AdsBookingLineTemp3.NEXT;

                           IF NOT AdsType.GET(AdsBookingLineTemp3."Ads. Type") THEN
                             CLEAR(AdsType);
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=21500;
            SectionHeight=1000;
          }
          CONTROLS
          {
            { 1000000053;Shape  ;10   ;300  ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000052;Label  ;400  ;400  ;6150 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=*** SUMMARY REPORT *** }
            { 1000000056;Shape  ;0    ;300  ;30   ;700  ;ShapeStyle=VertLine }
            { 1000000057;Shape  ;19200;300  ;30   ;700  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=21500;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000058;Shape  ;19200;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000059;Shape  ;0    ;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000080;TextBox;8700 ;0    ;3400 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AdsBookingLineTemp3.Amount }
            { 1000000081;TextBox;700  ;0    ;7800 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr='Total ' + AdsType.Description }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=21500;
            SectionHeight=2000;
            OnPreSection=BEGIN
                           AveragePerPage := 0;
                           IF GrandTotalPages <> 0 THEN
                             AveragePerPage := AdsBookingLineTemp3.Amount / GrandTotalPages;
                         END;

          }
          CONTROLS
          {
            { 1000000055;Shape  ;10   ;1900 ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000031;Label  ;700  ;100  ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=*** Grand Total Amount }
            { 1000000034;Label  ;700  ;600  ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=*** Grand Total Pages }
            { 1000000037;Label  ;700  ;1100 ;6450 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=*** Average / Page }
            { 1000000060;Shape  ;0    ;0    ;30   ;1900 ;ShapeStyle=VertLine }
            { 1000000061;Shape  ;19200;0    ;30   ;1900 ;ShapeStyle=VertLine }
            { 1000000078;TextBox;8700 ;100  ;3400 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AdsBookingLineTemp3.Amount }
            { 1000000079;TextBox;8700 ;600  ;3400 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=GrandTotalPages }
            { 1000000082;TextBox;8700 ;1100 ;3400 ;500  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=AveragePerPage }
            { 1000000083;Shape  ;8700 ;100  ;3400 ;30   ;ShapeStyle=HorzLine }
            { 1000000084;Shape  ;8700 ;1100 ;3400 ;30   ;ShapeStyle=HorzLine }
            { 1000000085;Shape  ;8700 ;1600 ;3400 ;30   ;ShapeStyle=HorzLine }
            { 1000000086;Shape  ;8700 ;1700 ;3400 ;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AdsBookingHdr@1000000003 : Record 50037;
      AdsBookingLine@1000000009 : Record 50038;
      AdsBookingLineTemp1@1000000008 : TEMPORARY Record 50038;
      AdsBookingLineTemp2@1000000006 : TEMPORARY Record 50038;
      AdsBookingLineTemp3@1000000013 : TEMPORARY Record 50038;
      AdsType@1000000005 : Record 50032;
      AdsBookingLineFilter@1000000004 : Text[250];
      TotalFor@1000000002 : TextConst 'ENU="Total for "';
      i@1000000007 : Integer;
      x@1000000001 : Integer;
      TotalPages@1000000000 : Decimal;
      TotalPagesByItem@1000000014 : Decimal;
      GrandTotalPages@1000000011 : Decimal;
      AveragePerPage@1000000012 : Decimal;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.05.2007   KKE   New report for "Ads. by Issue No. for Editorial" - Ads. Sales Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50051 FA Details Report
{
  OBJECT-PROPERTIES
  {
    Date=05/14/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=800;
    OnInitReport=BEGIN
                   Asofdate := WORKDATE;
                 END;

    OnPreReport=BEGIN
                  IF Asofdate = 0D THEN
                    ERROR('Please specify As of date');

                  IF DepreciationBook.Code = '' THEN
                    ERROR('Please specify Depreciation Book');

                  Startdate := DMY2DATE(1,1,DATE2DMY(Asofdate,3));
                END;

    Orientation=Landscape;
    PaperSize=A4 210 x 297 mm;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table5600;
        DataItemTableView=SORTING(FA Subclass Code);
        ReqFilterFields=FA Subclass Code;
        GroupTotalFields=FA Subclass Code;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=28350;
            SectionHeight=3807;
          }
          CONTROLS
          {
            { 1000000001;Label  ;13950;2538 ;1950 ;846  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Code }
            { 1000000003;Label  ;7650 ;2538 ;4500 ;846  ;ParentControl=1000000002;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Detail of Asset }
            { 1000000005;Label  ;750  ;2538 ;4650 ;846  ;ParentControl=1000000004;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Supplier }
            { 1000000007;Label  ;5550 ;2538 ;1950 ;846  ;ParentControl=1000000006;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Receipt/\Tax Invoice }
            { 1000000009;Label  ;12150;2538 ;1800 ;846  ;ParentControl=1000000008;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000010;Label  ;15900;2538 ;600  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Qty }
            { 1000000018;Label  ;16500;2538 ;2250 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Unit Price }
            { 1000000019;Label  ;18900;2538 ;1350 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date Purchase }
            { 1000000026;Label  ;20250;2538 ;1950 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Net Cost }
            { 1000000027;Label  ;22350;2538 ;900  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Rate }
            { 1000000028;Label  ;23250;2538 ;750  ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Days }
            { 1000000029;Label  ;24000;2538 ;2250 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=B/F \Accu.depre }
            { 1000000031;Label  ;26250;2538 ;2100 ;846  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Net Change Accu.depre }
            { 1000000032;Label  ;0    ;2538 ;750  ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Item }
            { 1000000012;Shape  ;0    ;2115 ;28350;423  ;ShapeStyle=HorzLine }
            { 1000000016;Shape  ;0    ;3384 ;28350;423  ;ShapeStyle=HorzLine }
            { 1000000024;Label  ;0    ;1692 ;1500 ;423  ;FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=As of Date }
            { 1000000025;TextBox;1500 ;1692 ;4650 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Asofdate }
            { 1000000047;TextBox;25200;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000054;TextBox;27900;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000055;Label  ;27150;423  ;750  ;423  ;ParentControl=1000000054 }
            { 1000000056;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=FA Details Report }
            { 1000000057;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000058;TextBox;26100;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1000000059;TextBox;25200;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"FA Details Report") }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=28350;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           CLEAR(sUnitPrice);
                           CLEAR(sNetcost);
                           CLEAR(sBFAccum);
                           CLEAR(sNetCAccum);
                           CLEAR(Entry);
                         END;

          }
          CONTROLS
          {
            { 1000000034;TextBox;3000 ;423  ;4650 ;423  ;VertAlign=Bottom;
                                                         SourceExpr="FA Subclass Code" }
            { 1000000035;Label  ;0    ;423  ;2850 ;423  ;ParentControl=1000000034;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=28350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           Entry += 1;
                           Qty := 1;


                           IF NOT Vendor.GET("Fixed Asset"."Vendor No.") THEN
                             CLEAR(Vendor);

                           CLEAR(UnitPrice);
                           CLEAR(DatePurchase);

                           FALedgerEntry.RESET;
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA No.","Fixed Asset"."No.");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA Posting Type",FALedgerEntry."FA Posting Type"::"Acquisition Cost");
                           IF FALedgerEntry.FIND('-') THEN
                           BEGIN
                             UnitPrice := FALedgerEntry.Amount;
                             DatePurchase := FALedgerEntry."Posting Date";
                           END;

                           UnitPrice := ABS(UnitPrice);

                           CLEAR(Days);
                           FALedgerEntry.RESET;
                           FALedgerEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","FA Posting Type","Posting Date");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA No.","Fixed Asset"."No.");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA Posting Type",FALedgerEntry."FA Posting Type"::Depreciation);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Posting Date",0D,Asofdate);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Depreciation Book Code",DepreciationBook.Code);
                           IF FALedgerEntry.FIND('-') THEN
                           REPEAT
                             Days += FALedgerEntry."No. of Depreciation Days";
                           UNTIL FALedgerEntry.NEXT = 0;


                           CLEAR(BFAccum);
                           FALedgerEntry.RESET;
                           FALedgerEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","FA Posting Type","Posting Date");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA No.","Fixed Asset"."No.");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA Posting Type",FALedgerEntry."FA Posting Type"::Depreciation);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Posting Date",0D,Startdate-1);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Depreciation Book Code",DepreciationBook.Code);
                           IF FALedgerEntry.FIND('-') THEN
                           BEGIN
                             FALedgerEntry.CALCSUMS(Amount);
                             BFAccum := FALedgerEntry.Amount;
                           END;

                           BFAccum := ABS(BFAccum);

                           CLEAR(NetCAccum);
                           FALedgerEntry.RESET;
                           FALedgerEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","FA Posting Type","Posting Date");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA No.","Fixed Asset"."No.");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA Posting Type",FALedgerEntry."FA Posting Type"::Depreciation);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Posting Date",Startdate,Asofdate);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Depreciation Book Code",DepreciationBook.Code);
                           IF FALedgerEntry.FIND('-') THEN
                           BEGIN
                             FALedgerEntry.CALCSUMS(Amount);
                             NetCAccum := FALedgerEntry.Amount;
                           END;

                           NetCAccum := ABS(NetCAccum);

                           CLEAR(rate);
                           FADepreciationBook.RESET;
                           FADepreciationBook.SETRANGE(FADepreciationBook."FA No.","Fixed Asset"."No.");
                           FADepreciationBook.SETRANGE(FADepreciationBook."Depreciation Book Code",DepreciationBook.Code);
                           IF FADepreciationBook.FIND('-') THEN
                             rate := FORMAT(FADepreciationBook."Straight-Line %") +' %' ;

                           sUnitPrice += UnitPrice ;
                           sNetcost +=  "Fixed Asset"."Purchase Value"+"Fixed Asset"."Cost Portion";
                           sBFAccum += BFAccum ;
                           sNetCAccum += NetCAccum ;

                           tUnitPrice += UnitPrice ;
                           tNetcost +=  "Fixed Asset"."Purchase Value"+"Fixed Asset"."Cost Portion";
                           tBFAccum += BFAccum ;
                           tNetCAccum += NetCAccum ;
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;13950;0    ;1950 ;423  ;HorzAlign=Left;
                                                         SourceExpr="No." }
            { 1000000002;TextBox;7650 ;0    ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Description }
            { 1000000004;TextBox;750  ;0    ;4650 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Vendor.Name }
            { 1000000006;TextBox;5550 ;0    ;1950 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Receipt/Tax invoice" }
            { 1000000008;TextBox;12150;0    ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Global Dimension 2 Code" }
            { 1000000011;TextBox;16500;0    ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=UnitPrice }
            { 1000000013;TextBox;0    ;0    ;750  ;423  ;HorzAlign=Left;
                                                         SourceExpr=Entry }
            { 1000000014;TextBox;15900;0    ;600  ;423  ;HorzAlign=Right;
                                                         SourceExpr=Qty }
            { 1000000015;TextBox;18900;0    ;1200 ;423  ;HorzAlign=Center;
                                                         SourceExpr=DatePurchase }
            { 1000000036;TextBox;22350;0    ;900  ;423  ;HorzAlign=Right;
                                                         SourceExpr=rate }
            { 1000000037;TextBox;23250;0    ;750  ;423  ;HorzAlign=Right;
                                                         SourceExpr=Days }
            { 1000000038;TextBox;20250;0    ;1950 ;423  ;HorzAlign=Right;
                                                         SourceExpr="Fixed Asset"."Purchase Value"+"Fixed Asset"."Cost Portion" }
            { 1000000039;TextBox;24000;0    ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=BFAccum }
            { 1000000043;TextBox;26250;0    ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=28350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000040;TextBox;16500;423  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sUnitPrice }
            { 1000000042;TextBox;20250;423  ;1950 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetcost }
            { 1000000044;TextBox;24000;423  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sBFAccum }
            { 1000000045;TextBox;26250;423  ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum }
            { 1000000046;Label  ;750  ;423  ;4650 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Sub-Total }
            { 1000000052;Shape  ;0    ;846  ;28350;423  ;ShapeStyle=HorzLine }
            { 1000000053;TextBox;3000 ;423  ;4650 ;423  ;VertAlign=Bottom;
                                                         SourceExpr="FA Subclass Code" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=28350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000041;TextBox;16500;423  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tUnitPrice }
            { 1000000048;TextBox;20250;423  ;1950 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetcost }
            { 1000000049;TextBox;24000;423  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tBFAccum }
            { 1000000050;TextBox;26250;423  ;2100 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum }
            { 1000000051;Label  ;750  ;423  ;4650 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000030;Shape  ;0    ;0    ;28350;423  ;ShapeStyle=HorzLine }
            { 1000000033;Shape  ;0    ;846  ;28350;423  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1000000003;TextBox;3520 ;330  ;1700 ;440  ;SourceExpr=Asofdate }
      { 1000000004;Label  ;110  ;330  ;3300 ;440  ;ParentControl=1000000003;
                                                   CaptionML=ENU=As of Date }
      { 1000000005;Label  ;110  ;880  ;3300 ;440  ;ParentControl=1000000006;
                                                   CaptionML=ENU=Depreciation Book }
      { 1000000006;TextBox;3520 ;880  ;1700 ;440  ;SourceExpr=DepreciationBook.Code;
                                                   TableRelation="Depreciation Book" }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Entry@1000000000 : Integer;
      Qty@1000000001 : Integer;
      UnitPrice@1000000002 : Decimal;
      DatePurchase@1000000003 : Date;
      rate@1000000004 : Text[30];
      Days@1000000005 : Integer;
      BFAccum@1000000006 : Decimal;
      NetCAccum@1000000007 : Decimal;
      Vendor@1000000008 : Record 23;
      FADepreciationBook@1000000009 : Record 5612;
      FALedgerEntry@1000000010 : Record 5601;
      Asofdate@1000000011 : Date;
      DepreciationBook@1000000012 : Record 5611;
      Startdate@1000000013 : Date;
      tUnitPrice@1000000014 : Decimal;
      tNetcost@1000000015 : Decimal;
      tBFAccum@1000000016 : Decimal;
      tNetCAccum@1000000017 : Decimal;
      sUnitPrice@1000000021 : Decimal;
      sNetcost@1000000020 : Decimal;
      sBFAccum@1000000019 : Decimal;
      sNetCAccum@1000000018 : Decimal;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50052 FA Monthly Depreciation Report
{
  OBJECT-PROPERTIES
  {
    Date=05/14/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=800;
    OnInitReport=BEGIN
                   Asofdate := WORKDATE;
                 END;

    OnPreReport=BEGIN
                  IF Asofdate = 0D THEN
                    ERROR('Please specify As of date');

                  IF DepreciationBook.Code = '' THEN
                    ERROR('Please specify Depreciation Book');

                  Startdate := DMY2DATE(1,1,DATE2DMY(Asofdate,3));
                  Year :=  DATE2DMY(Asofdate,3) ;
                END;

    Orientation=Landscape;
    PaperSize=A4 210 x 297 mm;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table5600;
        DataItemTableView=SORTING(FA Subclass Code);
        ReqFilterFields=FA Subclass Code;
        GroupTotalFields=FA Subclass Code;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=28500;
            SectionHeight=3807;
          }
          CONTROLS
          {
            { 1000000001;Label  ;13800;2538 ;1950 ;846  ;ParentControl=1000000000;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Code }
            { 1000000005;Label  ;750  ;2538 ;4650 ;846  ;ParentControl=1000000004;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Supplier }
            { 1000000007;Label  ;5550 ;2538 ;1950 ;846  ;ParentControl=1000000006;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Receipt/\Tax Invoice }
            { 1000000009;Label  ;12000;2538 ;1800 ;846  ;ParentControl=1000000008;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000029;Label  ;15750;2538 ;1800 ;846  ;HorzAlign=Right;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Net Book Value }
            { 1000000032;Label  ;0    ;2538 ;750  ;846  ;VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Item }
            { 1000000012;Shape  ;0    ;2115 ;28500;423  ;ShapeStyle=HorzLine }
            { 1000000016;Shape  ;0    ;3384 ;28500;423  ;ShapeStyle=HorzLine }
            { 1000000024;Label  ;0    ;1692 ;1500 ;423  ;FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=As of Date }
            { 1000000025;TextBox;1500 ;1692 ;4650 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Asofdate }
            { 1000000010;Label  ;17700;2538 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Jan }
            { 1000000011;Label  ;19500;2538 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Feb }
            { 1000000014;Label  ;21300;2538 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Mar }
            { 1000000015;Label  ;23100;2538 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Apr }
            { 1000000018;Label  ;24900;2538 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=May }
            { 1000000019;Label  ;26700;2538 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Jun }
            { 1000000037;Label  ;26700;2961 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Dec }
            { 1000000038;Label  ;24900;2961 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Nov }
            { 1000000040;Label  ;23100;2961 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Oct }
            { 1000000041;Label  ;21300;2961 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Sep }
            { 1000000042;Label  ;19500;2961 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Aug }
            { 1000000047;Label  ;17700;2961 ;1650 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Jul }
            { 1000000003;Label  ;7650 ;2538 ;4200 ;846  ;VertAlign=Top;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Detail of Asset }
            { 1000000087;Shape  ;17700;2961 ;10650;30   ;ShapeStyle=HorzLine }
            { 1000000088;TextBox;25200;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000089;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=FA Monthly Depreciation Report }
            { 1000000090;TextBox;27900;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000091;Label  ;27150;423  ;750  ;423  ;ParentControl=1000000090 }
            { 1000000092;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000093;TextBox;26100;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1000000094;TextBox;25200;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"FA Monthly Depreciation Report") }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=28500;
            SectionHeight=1269;
            OnPreSection=BEGIN
                           CLEAR(sBFAccum);
                           CLEAR(sNetCAccum);
                           CLEAR(Entry);
                         END;

          }
          CONTROLS
          {
            { 1000000034;TextBox;3000 ;423  ;4650 ;423  ;VertAlign=Bottom;
                                                         SourceExpr="FA Subclass Code" }
            { 1000000035;Label  ;0    ;423  ;2850 ;423  ;ParentControl=1000000034;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=28500;
            SectionHeight=1329;
            OnPreSection=BEGIN
                           Entry += 1;
                           Qty := 1;


                           IF NOT Vendor.GET("Fixed Asset"."Vendor No.") THEN
                             CLEAR(Vendor);



                           CLEAR(Days);
                           FALedgerEntry.RESET;
                           FALedgerEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","FA Posting Type","Posting Date");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA No.","Fixed Asset"."No.");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA Posting Type",FALedgerEntry."FA Posting Type"::Depreciation);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Posting Date",0D,Asofdate);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Depreciation Book Code",DepreciationBook.Code);
                           IF FALedgerEntry.FIND('-') THEN
                           REPEAT
                             Days += FALedgerEntry."No. of Depreciation Days";
                           UNTIL FALedgerEntry.NEXT = 0;


                           CLEAR(BFAccum);
                           FALedgerEntry.RESET;
                           FALedgerEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","FA Posting Type","Posting Date");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA No.","Fixed Asset"."No.");
                           FALedgerEntry.SETRANGE(FALedgerEntry."FA Posting Type",FALedgerEntry."FA Posting Type"::Depreciation);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Posting Date",0D,Asofdate);
                           FALedgerEntry.SETRANGE(FALedgerEntry."Depreciation Book Code",DepreciationBook.Code);
                           IF FALedgerEntry.FIND('-') THEN
                           BEGIN
                             FALedgerEntry.CALCSUMS(Amount);
                             BFAccum := FALedgerEntry.Amount;
                           END;

                           BFAccum := ABS(BFAccum);


                           CLEAR(NetCAccum);
                           FOR j:= 1 TO 12 DO
                             BEGIN
                               CLEAR(Fromdate);
                               CLEAR(Todate);
                               Fromdate :=DMY2DATE(1,j,Year);
                               Todate := CALCDATE('CM',DMY2DATE(1,j,Year));

                               FALedgerEntry.RESET;
                               FALedgerEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","FA Posting Type","Posting Date");
                               FALedgerEntry.SETRANGE(FALedgerEntry."FA No.","Fixed Asset"."No.");
                               FALedgerEntry.SETRANGE(FALedgerEntry."FA Posting Type",FALedgerEntry."FA Posting Type"::Depreciation);
                               FALedgerEntry.SETRANGE(FALedgerEntry."Posting Date",Fromdate,Todate);
                               FALedgerEntry.SETRANGE(FALedgerEntry."Depreciation Book Code",DepreciationBook.Code);
                               IF FALedgerEntry.FIND('-') THEN
                               BEGIN
                                 FALedgerEntry.CALCSUMS(Amount);
                                 NetCAccum[j] := ABS(FALedgerEntry.Amount);
                                 sNetCAccum[j]  += NetCAccum[j] ;
                                 tNetCAccum[j]  += NetCAccum[j] ;
                               END;
                             END;


                           sBFAccum += BFAccum ;
                           tBFAccum += BFAccum ;
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;13800;423  ;1950 ;423  ;HorzAlign=Left;
                                                         SourceExpr="No." }
            { 1000000002;TextBox;7650 ;423  ;4200 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Description }
            { 1000000004;TextBox;750  ;423  ;4650 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Vendor.Name }
            { 1000000006;TextBox;5550 ;423  ;1950 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Receipt/Tax invoice" }
            { 1000000008;TextBox;12000;423  ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Global Dimension 2 Code" }
            { 1000000013;TextBox;0    ;423  ;750  ;423  ;HorzAlign=Left;
                                                         SourceExpr=Entry }
            { 1000000039;TextBox;15750;423  ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=BFAccum }
            { 1000000043;TextBox;17700;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[1] }
            { 1000000026;TextBox;19500;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[2] }
            { 1000000027;TextBox;21300;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[3] }
            { 1000000028;TextBox;23100;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[4] }
            { 1000000031;TextBox;24900;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[5] }
            { 1000000036;TextBox;26700;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[6] }
            { 1000000057;TextBox;26700;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[12] }
            { 1000000058;TextBox;17700;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[7] }
            { 1000000059;TextBox;19500;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[8] }
            { 1000000060;TextBox;21300;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[9] }
            { 1000000061;TextBox;23100;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[10] }
            { 1000000062;TextBox;24900;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=NetCAccum[11] }
            { 1000000081;Shape  ;17700;846  ;10650;30   ;ShapeStyle=HorzLine }
            { 1000000082;Shape  ;17700;1299 ;10650;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=28500;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000044;TextBox;15750;423  ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sBFAccum }
            { 1000000046;Label  ;750  ;423  ;4650 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Sub-Total }
            { 1000000052;Shape  ;0    ;1269 ;28350;423  ;ShapeStyle=HorzLine }
            { 1000000053;TextBox;3000 ;423  ;4650 ;423  ;VertAlign=Bottom;
                                                         SourceExpr="FA Subclass Code" }
            { 1000000045;TextBox;26700;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[6] }
            { 1000000048;TextBox;24900;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[5] }
            { 1000000050;TextBox;23100;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[4] }
            { 1000000054;TextBox;26700;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[12] }
            { 1000000055;TextBox;23100;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[10] }
            { 1000000056;TextBox;24900;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[11] }
            { 1000000063;TextBox;21300;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[3] }
            { 1000000064;TextBox;21300;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[9] }
            { 1000000065;TextBox;19500;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[2] }
            { 1000000066;TextBox;19500;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[8] }
            { 1000000067;TextBox;17700;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[1] }
            { 1000000068;TextBox;17700;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=sNetCAccum[7] }
            { 1000000083;Shape  ;17700;846  ;10650;30   ;ShapeStyle=HorzLine }
            { 1000000084;Shape  ;17700;1269 ;10650;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=28500;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 1000000049;TextBox;15750;423  ;1800 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tBFAccum }
            { 1000000051;Label  ;750  ;423  ;4650 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000030;Shape  ;0    ;0    ;28350;423  ;ShapeStyle=HorzLine }
            { 1000000033;Shape  ;0    ;1269 ;28350;423  ;ShapeStyle=HorzLine }
            { 1000000069;TextBox;26700;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[6] }
            { 1000000070;TextBox;24900;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[5] }
            { 1000000071;TextBox;23100;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[4] }
            { 1000000072;TextBox;26700;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[12] }
            { 1000000073;TextBox;23100;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[10] }
            { 1000000074;TextBox;24900;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[11] }
            { 1000000075;TextBox;21300;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[3] }
            { 1000000076;TextBox;21300;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[9] }
            { 1000000077;TextBox;19500;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[2] }
            { 1000000078;TextBox;19500;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[8] }
            { 1000000079;TextBox;17700;423  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[1] }
            { 1000000080;TextBox;17700;846  ;1650 ;423  ;HorzAlign=Right;
                                                         SourceExpr=tNetCAccum[7] }
            { 1000000085;Shape  ;17700;846  ;10650;30   ;ShapeStyle=HorzLine }
            { 1000000086;Shape  ;17700;1269 ;10650;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1000000003;TextBox;3520 ;330  ;1700 ;440  ;SourceExpr=Asofdate }
      { 1000000004;Label  ;110  ;330  ;3300 ;440  ;ParentControl=1000000003;
                                                   CaptionML=ENU=As of Date }
      { 1000000005;Label  ;110  ;880  ;3300 ;440  ;ParentControl=1000000006;
                                                   CaptionML=ENU=Depreciation Book }
      { 1000000006;TextBox;3520 ;880  ;1700 ;440  ;SourceExpr=DepreciationBook.Code;
                                                   TableRelation="Depreciation Book" }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Entry@1000000000 : Integer;
      Qty@1000000001 : Integer;
      netBV@1000000002 : Decimal;
      DatePurchase@1000000003 : Date;
      rate@1000000004 : Text[30];
      Days@1000000005 : Integer;
      BFAccum@1000000006 : Decimal;
      NetCAccum@1000000007 : ARRAY [12] OF Decimal;
      Vendor@1000000008 : Record 23;
      FADepreciationBook@1000000009 : Record 5612;
      FALedgerEntry@1000000010 : Record 5601;
      Asofdate@1000000011 : Date;
      DepreciationBook@1000000012 : Record 5611;
      Startdate@1000000013 : Date;
      tBFAccum@1000000016 : Decimal;
      sBFAccum@1000000019 : Decimal;
      j@1000000022 : Integer;
      Fromdate@1000000023 : Date;
      Todate@1000000024 : Date;
      Year@1000000025 : Integer;
      sNetCAccum@1000000026 : ARRAY [12] OF Decimal;
      tNetCAccum@1000000018 : ARRAY [12] OF Decimal;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50053 Cash Advance Report
{
  OBJECT-PROPERTIES
  {
    Date=12/18/07;
    Time=[ 5:02:15 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Cash Advance Report;
               THA=รายงานเงินทดรองจ่าย];
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  VendorFilter := "Vendor Ledger Entry".GETFILTERS;
                  VendLedgEntry.SETFILTER("Date Filter","Vendor Ledger Entry".GETFILTER("Posting Date"));  //KKE : #002
                END;

    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table23;
        DataItemTableView=SORTING(No.)
                          WHERE(Cash Advance=CONST(Yes));
        OnAfterGetRecord=BEGIN
                           TotalDebitAmount := 0;
                           TotalCreditAmount := 0;
                           {
                           IF "Balance (LCY)" = 0 THEN
                             CurrReport.SKIP;
                           }  //KKE : #002
                         END;

        CalcFields=Balance (LCY),Net Change (LCY);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19480;
            SectionHeight=2800;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;846  ;FontName=CordiaUPC;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         CaptionML=ENU=รายงานเงินทดรองจ่าย }
            { 1000000004;TextBox;18800;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;18050;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;17000;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1000000009;Label  ;100  ;1938 ;2100 ;846  ;ParentControl=1000000008;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000012;Label  ;2400 ;1946 ;2800 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เลขที่เอกสาร }
            { 1000000015;Label  ;5400 ;1938 ;1600 ;846  ;ParentControl=1000000014;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;7100 ;1938 ;4700 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ/ชื่อบัญชี }
            { 1000000021;Label  ;11950;1938 ;2500 ;846  ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รับ }
            { 1000000024;Label  ;14650;1938 ;2500 ;846  ;ParentControl=1000000023;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จ่าย }
            { 1000000007;Shape  ;0    ;1830 ;19300;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000010;Label  ;17350;1938 ;1600 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000013;Shape  ;0    ;2770 ;19300;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000016;Shape  ;0    ;1846 ;30   ;954  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000019;Shape  ;2300 ;1846 ;30   ;954  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000022;Shape  ;5300 ;1846 ;30   ;954  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000025;Shape  ;6950 ;1846 ;30   ;954  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000026;Shape  ;11850;1846 ;30   ;954  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000027;Shape  ;14550;1846 ;30   ;954  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000028;Shape  ;17250;1846 ;30   ;954  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000029;Shape  ;19255;1846 ;30   ;954  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000035;TextBox;100  ;1100 ;15900;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=VendorFilter }
            { 1000000036;TextBox;16100;1300 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Cash Advance Report") }
            { 1000000002;TextBox;16100;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19480;
            SectionHeight=800;
            OnPreSection=BEGIN
                           IF TotalDebitAmount2 >= TotalCreditAmount2 THEN BEGIN
                             TotalDebitAmount2 := TotalDebitAmount2 - TotalCreditAmount2;
                             TotalCreditAmount2 := 0;
                           END ELSE BEGIN
                             TotalCreditAmount2 := TotalCreditAmount2 - TotalDebitAmount2;
                             TotalDebitAmount2 := 0;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;14650;0    ;2500 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalCreditAmount2 }
            { 1000000003;TextBox;11950;0    ;2500 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalDebitAmount2 }
            { 1000000032;Label  ;7200 ;0    ;3200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=คงเหลือ }
            { 1000000046;Shape  ;19255;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000047;Shape  ;17250;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;Shape  ;14550;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000049;Shape  ;11850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000053;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000054;Shape  ;0    ;580  ;19300;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table25;
        DataItemTableView=SORTING(Vendor No.,Posting Date,Currency Code);
        OnAfterGetRecord=BEGIN
                           //KKE : #002 +
                           IF VendLedgEntry.GET("Entry No.") THEN
                             VendLedgEntry.CALCFIELDS("Remaining Amount");
                           IF VendLedgEntry."Remaining Amount" = 0 THEN
                             CurrReport.SKIP;
                           //KKE : #002 -

                           TotalDebitAmount += "Debit Amount";
                           TotalCreditAmount += "Credit Amount";
                           TotalDebitAmount2 += "Debit Amount";
                           TotalCreditAmount2 += "Credit Amount";
                         END;

        ReqFilterFields=Vendor No.,Posting Date;
        DataItemLink=Vendor No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19480;
            SectionHeight=610;
          }
          CONTROLS
          {
            { 1000000050;Shape  ;19255;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000051;Shape  ;17250;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000052;Shape  ;14550;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000055;Shape  ;11850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000059;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000060;Shape  ;0    ;580  ;19300;30   ;ShapeStyle=HorzLine }
            { 1000000082;TextBox;500  ;0    ;11200;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr=Vendor."No." + ' ' + Vendor.Name }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19480;
            SectionHeight=610;
          }
          CONTROLS
          {
            { 1000000008;TextBox;100  ;0    ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Posting Date" }
            { 1000000011;TextBox;2400 ;0    ;2800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Document No." }
            { 1000000014;TextBox;5400 ;0    ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Global Dimension 2 Code" }
            { 1000000017;TextBox;7100 ;0    ;4700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000020;TextBox;11950;0    ;2500 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Debit Amount" }
            { 1000000023;TextBox;14650;0    ;2500 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Credit Amount" }
            { 1000000030;Shape  ;19255;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000033;Shape  ;17250;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000034;Shape  ;14550;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000037;Shape  ;11850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000038;Shape  ;6950 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000041;Shape  ;5300 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000042;Shape  ;2300 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000044;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000031;Shape  ;0    ;580  ;19300;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19480;
            SectionHeight=610;
            OnPreSection=BEGIN
                           IF TotalDebitAmount >= TotalCreditAmount THEN BEGIN
                             TotalDebitAmount := TotalDebitAmount - TotalCreditAmount;
                             TotalCreditAmount := 0;
                           END ELSE BEGIN
                             TotalCreditAmount := TotalCreditAmount - TotalDebitAmount;
                             TotalDebitAmount := 0;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000070;Shape  ;19255;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000071;Shape  ;17250;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000072;Shape  ;14550;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000073;Shape  ;11850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000077;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000078;Shape  ;0    ;580  ;19300;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000080;TextBox;11950;10   ;2500 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalDebitAmount }
            { 1000000081;TextBox;14650;10   ;2500 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalCreditAmount }
            { 1000000083;TextBox;1300 ;0    ;10500;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr='คงเหลือ : ' + Vendor.Name }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      VendLedgEntry@1000000002 : Record 25;
      VendorFilter@1000000005 : Text[250];
      TotalDebitAmount@1000000000 : Decimal;
      TotalCreditAmount@1000000001 : Decimal;
      TotalDebitAmount2@1000000004 : Decimal;
      TotalCreditAmount2@1000000003 : Decimal;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.03.2007   KKE   New report for Cash Advance
      002   18.12.2007   KKE   Correct report to show remaining amount incase filter data by Date.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50054 Content Index List
{
  OBJECT-PROPERTIES
  {
    Date=05/17/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50019;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        OnAfterGetRecord=BEGIN
                           IF NOT Item.GET("Magazine Item No.") THEN
                             CLEAR(Item);
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=2000;
          }
          CONTROLS
          {
            { 1000000022;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000025;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Content Index List }
            { 1000000028;TextBox;16100;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Content Index List") }
            { 1000000031;TextBox;16100;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000034;TextBox;18800;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000039;Label  ;18050;423  ;750  ;423  ;ParentControl=1000000034 }
            { 1000000040;TextBox;17000;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=2500;
          }
          CONTROLS
          {
            { 1000000000;TextBox;3300 ;100  ;2600 ;500  ;FontSize=8;
                                                         SourceExpr="No." }
            { 1000000007;Label  ;0    ;100  ;3100 ;500  ;ParentControl=1000000000;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000010;TextBox;3300 ;700  ;1900 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Creation Date" }
            { 1000000013;Label  ;0    ;700  ;3100 ;500  ;ParentControl=1000000010;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000016;TextBox;3300 ;1300 ;3100 ;500  ;FontSize=8;
                                                         SourceExpr="Magazine Item No." }
            { 1000000019;Label  ;0    ;1300 ;3100 ;500  ;ParentControl=1000000016;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000004;TextBox;11900;100  ;3100 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Magazine;
                                                         SourceExpr=Item."Magazine Code" }
            { 1000000005;Label  ;8600 ;100  ;3100 ;500  ;ParentControl=1000000004;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000044;TextBox;11900;700  ;3100 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Volume;
                                                         SourceExpr=Item."Volume No." }
            { 1000000045;Label  ;8600 ;700  ;3100 ;500  ;ParentControl=1000000044;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000046;TextBox;11900;1300 ;3100 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Issue No.;
                                                         SourceExpr=Item."Issue No." }
            { 1000000047;Label  ;8600 ;1300 ;3100 ;500  ;ParentControl=1000000046;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000048;TextBox;11900;1900 ;3100 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Issue Date;
                                                         SourceExpr=Item."Issue Date" }
            { 1000000049;Label  ;8600 ;1900 ;3100 ;500  ;ParentControl=1000000048;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50020;
        DataItemTableView=SORTING(Content List No.,Content List Line No.);
        TotalFields=Cost (LCY);
        DataItemLink=Content List No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=1700;
          }
          CONTROLS
          {
            { 1000000012;Label  ;0    ;400  ;1700 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000015;Label  ;1900 ;400  ;3900 ;846  ;ParentControl=1000000014;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;6000 ;400  ;1350 ;846  ;ParentControl=1000000017;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000021;Label  ;7500 ;400  ;1500 ;846  ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000024;Label  ;9200 ;400  ;1600 ;846  ;ParentControl=1000000023;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000027;Label  ;11000;400  ;2850 ;846  ;ParentControl=1000000026;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000030;Label  ;14000;400  ;2100 ;846  ;ParentControl=1000000029;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000033;Label  ;16300;100  ;1500 ;1100 ;ParentControl=1000000032;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000036;Label  ;18000;400  ;1200 ;846  ;ParentControl=1000000035;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000001;Shape  ;0    ;0    ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000002;Shape  ;0    ;1470 ;19200;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000011;TextBox;0    ;0    ;1700 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Content Code" }
            { 1000000014;TextBox;1900 ;0    ;3900 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=Description }
            { 1000000017;TextBox;6000 ;0    ;1350 ;600  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr="No. of Page" }
            { 1000000020;TextBox;7500 ;0    ;1500 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Content Type" }
            { 1000000023;TextBox;9200 ;0    ;1600 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Content Sub Type" }
            { 1000000026;TextBox;11000;0    ;2850 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Author Name" }
            { 1000000029;TextBox;14000;0    ;2100 ;600  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr="Cost (LCY)" }
            { 1000000032;TextBox;16300;0    ;1500 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Content Receipt Date" }
            { 1000000035;TextBox;18000;0    ;1200 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=Status }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=1000;
          }
          CONTROLS
          {
            { 1000000038;TextBox;12800;300  ;3300 ;600  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Cost (LCY)" }
            { 1000000003;Shape  ;0    ;200  ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000006;Label  ;800  ;300  ;2900 ;600  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Total }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Item@1000000003 : Record 27;
      TotalFor@1000000002 : TextConst 'ENU="Total for "';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   17.05.2007   KKE   New report for "Content Index List" - Editorial Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50055 Content Expense Report
{
  OBJECT-PROPERTIES
  {
    Date=05/17/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50019;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        OnAfterGetRecord=BEGIN
                           IF NOT Item.GET("Magazine Item No.") THEN
                             CLEAR(Item);
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=2000;
          }
          CONTROLS
          {
            { 1000000022;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000025;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Content Expense Report }
            { 1000000028;TextBox;16100;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Content Index List") }
            { 1000000031;TextBox;16100;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000034;TextBox;18800;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000039;Label  ;18050;423  ;750  ;423  ;ParentControl=1000000034 }
            { 1000000040;TextBox;17000;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=2500;
          }
          CONTROLS
          {
            { 1000000000;TextBox;3300 ;100  ;2600 ;500  ;FontSize=8;
                                                         SourceExpr="No." }
            { 1000000007;Label  ;0    ;100  ;3100 ;500  ;ParentControl=1000000000;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000010;TextBox;3300 ;700  ;1900 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Creation Date" }
            { 1000000013;Label  ;0    ;700  ;3100 ;500  ;ParentControl=1000000010;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000016;TextBox;3300 ;1300 ;3100 ;500  ;FontSize=8;
                                                         SourceExpr="Magazine Item No." }
            { 1000000019;Label  ;0    ;1300 ;3100 ;500  ;ParentControl=1000000016;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000004;TextBox;11900;100  ;3100 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Magazine;
                                                         SourceExpr=Item."Magazine Code" }
            { 1000000005;Label  ;8600 ;100  ;3100 ;500  ;ParentControl=1000000004;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000044;TextBox;11900;700  ;3100 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Volume;
                                                         SourceExpr=Item."Volume No." }
            { 1000000045;Label  ;8600 ;700  ;3100 ;500  ;ParentControl=1000000044;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000046;TextBox;11900;1300 ;3100 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Issue No.;
                                                         SourceExpr=Item."Issue No." }
            { 1000000047;Label  ;8600 ;1300 ;3100 ;500  ;ParentControl=1000000046;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000048;TextBox;11900;1900 ;3100 ;500  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         CaptionML=ENU=Issue Date;
                                                         SourceExpr=Item."Issue Date" }
            { 1000000049;Label  ;8600 ;1900 ;3100 ;500  ;ParentControl=1000000048;
                                                         HorzAlign=Left;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50021;
        DataItemTableView=SORTING(Content Index No.,Content Index Line No.,Line No.);
        TotalFields=Cost Amount,Cost Amount (LCY);
        DataItemLink=Content Index No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=2100;
          }
          CONTROLS
          {
            { 1000000012;Label  ;0    ;900  ;1500 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000015;Label  ;1600 ;900  ;3900 ;846  ;ParentControl=1000000014;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;5600 ;900  ;1350 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000021;Label  ;7100 ;900  ;1500 ;846  ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000024;Label  ;8700 ;900  ;1500 ;846  ;ParentControl=1000000023;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000027;Label  ;10300;900  ;1900 ;846  ;ParentControl=1000000026;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000030;Label  ;12300;900  ;1400 ;846  ;ParentControl=1000000029;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000033;Label  ;13800;900  ;1900 ;846  ;ParentControl=1000000032;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000036;Label  ;15800;900  ;1200 ;846  ;ParentControl=1000000035;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000001;Shape  ;0    ;700  ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000002;Shape  ;0    ;1970 ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000009;Label  ;17100;900  ;2100 ;846  ;ParentControl=1000000008;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000041;Label  ;0    ;0    ;3900 ;600  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontItalic=No;
                                                         FontUnderline=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Photo Expense }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000011;TextBox;0    ;0    ;1500 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Picture Code" }
            { 1000000014;TextBox;1600 ;0    ;3900 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=Description }
            { 1000000017;TextBox;5600 ;0    ;1350 ;600  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr="Picture Size" }
            { 1000000020;TextBox;7100 ;0    ;1500 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Reference No." }
            { 1000000023;TextBox;8700 ;0    ;1500 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=Agency }
            { 1000000026;TextBox;10300;0    ;1900 ;600  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Invoice No." }
            { 1000000029;TextBox;12300;0    ;1400 ;600  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr="Currency Code" }
            { 1000000032;TextBox;13800;0    ;1900 ;600  ;HorzAlign=General;
                                                         FontSize=8;
                                                         SourceExpr="Cost Amount" }
            { 1000000035;TextBox;15800;0    ;1200 ;600  ;HorzAlign=General;
                                                         FontSize=8;
                                                         SourceExpr="Exchange Rate" }
            { 1000000008;TextBox;17100;0    ;2100 ;600  ;FontSize=8;
                                                         SourceExpr="Cost Amount (LCY)" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=1100;
          }
          CONTROLS
          {
            { 1000000038;TextBox;15900;300  ;3300 ;500  ;HorzAlign=General;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Cost Amount (LCY)" }
            { 1000000003;Shape  ;0    ;200  ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000006;Label  ;1500 ;300  ;3900 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000037;TextBox;12400;300  ;3300 ;500  ;HorzAlign=General;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Cost Amount" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50022;
        DataItemTableView=SORTING(Content Index No.,Content Index Line No.,Line No.);
        TotalFields=Cost Amount,Cost Amount (LCY);
        DataItemLink=Content Index No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19400;
            SectionHeight=2100;
          }
          CONTROLS
          {
            { 1000000042;Shape  ;0    ;1970 ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000043;Shape  ;0    ;700  ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000050;Label  ;0    ;0    ;3900 ;600  ;FontSize=8;
                                                         FontBold=Yes;
                                                         FontItalic=No;
                                                         FontUnderline=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Content Cost }
            { 1000000052;Label  ;0    ;900  ;1700 ;800  ;ParentControl=1000000051;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000054;Label  ;4900 ;900  ;3000 ;800  ;ParentControl=1000000053;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000056;Label  ;1800 ;900  ;3000 ;800  ;ParentControl=1000000055;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000058;Label  ;8000 ;900  ;3000 ;800  ;ParentControl=1000000057;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000062;Label  ;13800;900  ;1900 ;800  ;ParentControl=1000000061;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000060;Label  ;12300;900  ;1400 ;800  ;ParentControl=1000000059;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000064;Label  ;15800;900  ;1200 ;800  ;ParentControl=1000000063;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000066;Label  ;17100;900  ;2100 ;800  ;ParentControl=1000000065;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000051;TextBox;0    ;0    ;1700 ;600  ;FontSize=8;
                                                         SourceExpr="Expense Code" }
            { 1000000053;TextBox;4900 ;0    ;3000 ;600  ;FontSize=8;
                                                         SourceExpr="Reference No." }
            { 1000000055;TextBox;1800 ;0    ;3000 ;600  ;FontSize=8;
                                                         SourceExpr=Description }
            { 1000000057;TextBox;8000 ;0    ;3000 ;600  ;FontSize=8;
                                                         SourceExpr="Invoice No." }
            { 1000000059;TextBox;12300;0    ;1400 ;600  ;FontSize=8;
                                                         SourceExpr="Currency Code" }
            { 1000000061;TextBox;13800;0    ;1900 ;600  ;FontSize=8;
                                                         SourceExpr="Cost Amount" }
            { 1000000063;TextBox;15800;0    ;1200 ;600  ;FontSize=8;
                                                         SourceExpr="Exchange Rate" }
            { 1000000065;TextBox;17100;0    ;2100 ;600  ;FontSize=8;
                                                         SourceExpr="Cost Amount (LCY)" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=1000;
          }
          CONTROLS
          {
            { 1000000067;TextBox;15900;300  ;3300 ;500  ;HorzAlign=General;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Cost Amount (LCY)" }
            { 1000000068;Shape  ;0    ;200  ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000069;Label  ;1500 ;300  ;3900 ;500  ;FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000070;TextBox;12400;300  ;3300 ;500  ;HorzAlign=General;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Cost Amount" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Item@1000000003 : Record 27;
      TotalFor@1000000002 : TextConst 'ENU="Total for "';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   17.05.2007   KKE   New report for "Content Expense Report" - Editorial Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50056 Sales Tax Invoice
{
  OBJECT-PROPERTIES
  {
    Date=01/18/12;
    Time=12:27:08 PM;
    Modified=Yes;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    Permissions=TableData 7190=rimd;
    CaptionML=[ENU=Sales - Invoice;
               THA=การขาย - ใบส่งของ];
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   CompanyInfo.GET;
                   SalesSetup.GET;
                   CompanyInfo.CALCFIELDS(Picture);

                   LinePerPage := 20;
                 END;

    Orientation=Portrait;
    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50054;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Posted Sales Invoice;
                            THA=ใบส่งของสินค้าขายที่ลงรายการบัญชี];
        OnPreDataItem=BEGIN
                        CLEAR(IssueDate);
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                      END;

        OnAfterGetRecord=BEGIN
                           SalesTaxInvLine.SETRANGE("Document No.","No.");
                           IF NOT SalesTaxInvLine.FIND('-') THEN
                             ERROR('There is no data on sales line.');

                           FormatAddr.Company(CompanyAddr,CompanyInfo);

                           BillToName := "Bill-to Name (Thai)";
                           IF BillToName = '' THEN
                             BillToName := "Bill-to Name" + "Bill-to Name 2";


                           BillToAddress := "Bill-to Address (Thai)";
                           IF BillToAddress = '' THEN
                             BillToAddress := "Bill-to Address" + ' ' + "Bill-to Address 2" + ' ' + "Bill-to Address 3";

                           Cust.GET("Bill-to Customer No.");

                           IF NOT SalesPurchPerson.GET("Salesperson Code") THEN
                             CLEAR(SalesPurchPerson);
                           IF "Payment Terms Code" = '' THEN
                             PaymentTerms.INIT
                           ELSE
                             PaymentTerms.GET("Payment Terms Code");
                           IF "Shipment Method Code" = '' THEN
                             ShipmentMethod.INIT
                           ELSE
                             ShipmentMethod.GET("Shipment Method Code");

                           CALCFIELDS(Amount);
                           CALCFIELDS("Amount Including VAT");

                           AmountLCY :=
                             ROUND(
                               CurrExchRate.ExchangeAmtFCYToLCY(
                                 WORKDATE,"Currency Code",Amount,"Currency Factor"));
                           AmountIncLCY :=
                             ROUND(
                               CurrExchRate.ExchangeAmtFCYToLCY(
                                 WORKDATE,"Currency Code","Amount Including VAT","Currency Factor"));

                           CommentText := '';
                           SalesComtLine.RESET;
                           SalesComtLine.SETRANGE("Document Type",SalesComtLine."Document Type"::"Issued Tax Invoice");
                           SalesComtLine.SETRANGE("No.","No.");
                           SalesComtLine.SETFILTER(Comment,'<>%1','');
                           IF SalesComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(CommentText + SalesComtLine.Comment) < 250 THEN
                                 IF CommentText = '' THEN
                                   CommentText := SalesComtLine.Comment
                                 ELSE
                                   CommentText := CommentText + ' ' + SalesComtLine.Comment;
                             UNTIL SalesComtLine.NEXT=0;
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=CopyLoop;
        OnPreDataItem=BEGIN
                        NoOfLoops := ABS(NoOfCopies) + Cust."Invoice Copies" + 1;
                        IF NoOfLoops <= 0 THEN
                          NoOfLoops := 1;
                        CopyText := '';
                        SETRANGE(Number,1,NoOfLoops);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > 1 THEN
                             CopyText := Text003;
                           CurrReport.PAGENO := 1;
                           CntLine := 0;

                           IF NOT CurrReport.PREVIEW THEN BEGIN
                             IF SalesTaxInvHeader.GET("Sales Tax Invoice/Rec. Header"."No.") THEN BEGIN
                               SalesTaxInvHeader."No. Printed" := SalesTaxInvHeader."No. Printed" + 1;
                               IF NOT SalesTaxInvHeader."Issued Tax Invoice/Receipt" THEN BEGIN
                                 SalesTaxInvHeader."Issued Tax Invoice/Receipt" := TRUE;
                                 SalesSetup.GET;
                                 SalesSetup.TESTFIELD("Issued Tax Invoice/Receipt Nos");
                                 "Sales Tax Invoice/Rec. Header"."Issued Tax Invoice/Receipt No." :=
                                   NoSeriesMgt.GetNextNo(SalesSetup."Issued Tax Invoice/Receipt Nos",WORKDATE,TRUE);
                                 SalesTaxInvHeader."Issued Tax Invoice/Receipt No." :=
                                   "Sales Tax Invoice/Rec. Header"."Issued Tax Invoice/Receipt No.";
                                 SalesTaxInvHeader."Issued Date / Time" := CREATEDATETIME(WORKDATE,TIME);
                                 SalesTaxInvHeader."Issued by" := USERID;
                                 IssueDate := DT2DATE(SalesTaxInvHeader."Issued Date / Time");
                               END;
                               SalesTaxInvHeader.MODIFY;
                               COMMIT;
                             END;
                           END;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=PageLoop;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=7000;
          }
          CONTROLS
          {
            { 1000000005;Shape  ;0    ;3600 ;10500;3400  }
            { 1000000008;Shape  ;13600;4200 ;5700 ;1600  }
            { 1000000009;TextBox;2700 ;3700 ;7700 ;600  ;Visible=Yes;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=["Sales Tax Invoice/Rec. Header"."Bill-to Customer No." ] }
            { 1000000010;TextBox;15100;5100 ;4000 ;600  ;Visible=Yes;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Tax Invoice/Rec. Header"."Posting Date" }
            { 1000000011;TextBox;15100;4300 ;4000 ;600  ;Visible=Yes;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Tax Invoice/Rec. Header"."Issued Tax Invoice/Receipt No." }
            { 1000000012;TextBox;700  ;4300 ;9700 ;2100 ;Visible=Yes;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=BillToName + '\' +  BillToAddress }
            { 1000000019;TextBox;2100 ;6400 ;8300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Tax Invoice/Rec. Header"."Bill-to Contact" }
            { 1000000021;TextBox;13600;0    ;5600 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000027;TextBox;0    ;3100 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000028;Label  ;13800;4300 ;1100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000029;Label  ;13800;5100 ;1100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000034;Shape  ;13600;5000 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000035;Label  ;100  ;3700 ;2600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อและที่อยู่ลูกค้า }
            { 1000000036;Label  ;100  ;6400 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อผู้ที่ติดต่อ }
            { 1000000015;Label  ;7700 ;1700 ;5400 ;700  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=" ใบเสร็จรับเงิน/ใบกำกับภาษี" }
            { 1000000072;Label  ;7900 ;2400 ;5400 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=16;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=RECEIPT / TAX INVOICE }
            { 1000000023;Label  ;0    ;0    ;5700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=บริษัท เบอร์ด้า (ประเทศไทย) จำกัด }
            { 1000000006;Label  ;0    ;700  ;6800 ;700  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ชั้น17 ห้อง 1702 อาคาร 208 เลขที่ 208 ถนนวิทยุ }
            { 1000000014;Label  ;0    ;1400 ;6800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=แขวงลุมพินี เขตปทุมวัน กรุงเทพมหานครฯ 10330 }
            { 1000000016;Label  ;0    ;2000 ;6800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=โทรศัพท์ (662)6515400 แฟกซ์ (662) 6515418-9 }
            { 1000000017;Label  ;13000;700  ;6200 ;700  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=17th Floor, Unit No. 1702, 208 Wireless Road, }
            { 1000000018;Label  ;13800;1400 ;5400 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=Lumpini, Pathumwan, Bangkok 10330 }
            { 1000000022;Label  ;13700;2000 ;5500 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=Tel (662)6515400 Fax (662)6515418-9 }
            { 1000000095;Label  ;5700 ;4800 ;7300 ;600  ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ใบแจ้งหนี้ INA08-03-0123 Sale - Ad. (LISA-VOL09-12) }
            { 1000000106;Label  ;15000;2900 ;3000 ;600  ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=RAD11-02-0111 }
            { 1000000112;Label  ;12000;3100 ;3000 ;600  ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=AB0028 }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=1730;
          }
          CONTROLS
          {
            { 1000000039;Label  ;100  ;300  ;1900 ;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=รับชำระโดย }
            { 1000000003;Shape  ;15   ;100  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000024;Shape  ;19230;100  ;30   ;1600 ;ShapeStyle=VertLine }
            { 1000000025;Shape  ;0    ;100  ;30   ;1600 ;ShapeStyle=VertLine }
            { 1000000026;Shape  ;0    ;1700 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000040;Label  ;3400 ;300  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=เงินสด }
            { 1000000045;Label  ;3400 ;1000 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=เงินโอน }
            { 1000000052;Shape  ;2800 ;300  ;500  ;500   }
            { 1000000060;Shape  ;2800 ;1000 ;500  ;500   }
            { 1000000062;Label  ;7000 ;300  ;5300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=เช็คธนาคาร......................................................... }
            { 1000000069;Label  ;7000 ;1000 ;5300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ดร๊าฟธนาคาร....................................................... }
            { 1000000071;Shape  ;6400 ;300  ;500  ;500   }
            { 1000000080;Shape  ;6400 ;1000 ;500  ;500   }
            { 1000000093;Label  ;12800;1000 ;5200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=เลขที่........................................................ }
            { 1000000094;Label  ;12800;300  ;5200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=เลขที่........................................................ }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=3100;
          }
          CONTROLS
          {
            { 1000000108;Label  ;100  ;1400 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=วันที่ }
            { 1000000096;Shape  ;15   ;85   ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000097;Shape  ;19230;100  ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000098;Shape  ;0    ;100  ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000099;Shape  ;0    ;2600 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000100;Label  ;6500 ;200  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้จัดเตรียม }
            { 1000000101;Label  ;6500 ;1400 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้ตรวจสอบ }
            { 1000000102;Label  ;13100;300  ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ในนาม บริษัทเบอร์ด้า (ประเทศไทย) จำกัด }
            { 1000000103;Label  ;13000;2000 ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลายเซ็นผู้มีอำนาจลงนาม }
            { 1000000104;Shape  ;6400 ;100  ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000105;Shape  ;12900;100  ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000107;Label  ;100  ;200  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้รับเงิน }
            { 1000000109;Shape  ;6400 ;1200 ;6500 ;30   ;ShapeStyle=HorzLine }
            { 1000000078;Label  ;0    ;2600 ;19300;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         CaptionML=ENU=กรุณาชำระด้วยเช็คขีดคร่อมในนาม "บริษัท เบอร์ด้า (ประเทศไทย) จำกัด" การชำระโดยเช็ค ใบเสร็จจะเสร็จสมบูรณ์เมื่อเช็คสามารถเรียกเก็บเงินได้ }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table50055;
        DataItemTableView=SORTING(Document No.,Line No.);
        OnPreDataItem=BEGIN
                        VATAmountLine.DELETEALL;
                        FirstValueEntryNo := 0;
                        MoreLines := FIND('+');
                        WHILE MoreLines AND (Description = '') AND ("No." = '') AND (Quantity = 0) AND (Amount = 0) DO
                          MoreLines := NEXT(-1) <> 0;
                        IF NOT MoreLines THEN
                          CurrReport.BREAK;
                        SETRANGE("Line No.",0,"Line No.");
                        CurrReport.CREATETOTALS("Line Amount",Amount,"Amount Including VAT","Inv. Discount Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF (Type = Type::"G/L Account") AND (NOT ShowInternalInfo) THEN
                             "No." := '';

                           InvNoText := STRSUBSTNO(Text007,"Posted Document No.");  //KKE : #002

                           VATAmountLine.INIT;
                           VATAmountLine."VAT Identifier" := "VAT Identifier";
                           VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
                           VATAmountLine."Tax Group Code" := "Tax Group Code";
                           VATAmountLine."VAT %" := "VAT %";
                           VATAmountLine."VAT Base" := Amount;
                           VATAmountLine."Amount Including VAT" := "Amount Including VAT";
                           VATAmountLine."Line Amount" := "Line Amount";
                           IF "Allow Invoice Disc." THEN
                             VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
                           VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
                           VATAmountLine.InsertLine;
                         END;

        DataItemLinkReference=Sales Tax Invoice/Rec. Header;
        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=1015;
          }
          CONTROLS
          {
            { 1000000000;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000001;Shape  ;15   ;985  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000002;Shape  ;0    ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000013;Shape  ;10500;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000041;Shape  ;12500;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000042;Shape  ;14900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000043;Shape  ;16100;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000044;Shape  ;19230;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000046;Label  ;10600;85   ;1800 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวน }
            { 1000000047;Label  ;14900;100  ;1200 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ส่วนลด }
            { 1000000048;Label  ;12600;100  ;2200 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ราคาหน่วยละ }
            { 1000000049;Label  ;16200;100  ;2900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 1000000050;Label  ;400  ;100  ;9900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000053;Label  ;15000;500  ;1000 ;446  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=% }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                           {
                             IF CntLine = LinePerPage THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 1000000054;TextBox;200  ;0    ;10200;600  ;Visible=Yes;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000055;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000057;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000058;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000059;Shape  ;10500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000061;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type > 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                           {
                             IF CntLine = LinePerPage THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 66  ;TextBox      ;10600;0    ;1800 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 68  ;TextBox      ;12600;0    ;2200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Tax Invoice/Rec. Line".GetCurrencyCode }
            { 69  ;TextBox      ;15000;0    ;1000 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Disc. %;
                                                                    THA=% ส่วนลด];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Discount %" }
            { 70  ;TextBox      ;16200;0    ;2920 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Amount;
                                                                    THA=จำนวน];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Tax Invoice/Rec. Line".GetCurrencyCode }
            { 1000000063;TextBox;200  ;0    ;10200;600  ;Visible=Yes;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="No." + ' ' + InvNoText + Description }
            { 1000000064;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;10500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000070;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000110;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000111;Label  ;17000;0    ;2200 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,LinePerPage-CntLine-3);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000073;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000076;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000077;Shape  ;10500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000079;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnAfterGetRecord=BEGIN
                           //KKE : #001 +
                           IF "Sales Tax Invoice/Rec. Line"."Amount Including VAT" <> 0 THEN
                             TextAmount := '(' + Form50BIS.FormatNoThaiText(ABS("Sales Tax Invoice/Rec. Line"."Amount Including VAT")) + ')'
                           ELSE
                             TextAmount := '';
                           //KKE : #001 -
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT("Sales Tax Invoice/Rec. Header"."Invoice Description" <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000030;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000031;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000032;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000033;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000037;Shape  ;10500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000038;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000051;TextBox;200  ;0    ;10700;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Tax Invoice/Rec. Header"."Invoice Description" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=2530;
          }
          CONTROLS
          {
            { 1000000081;TextBox;100  ;1000 ;12300;1400 ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000082;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000083;Shape  ;19230;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000084;Shape  ;16100;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000085;Shape  ;12500;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000086;Shape  ;0    ;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000087;Shape  ;15   ;2500 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000088;Label  ;12600;0    ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=รวมเงิน }
            { 1000000089;Label  ;12600;800  ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ภาษีมูลค่าเพิ่ม }
            { 1000000090;Label  ;12600;1600 ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=จำนวนเงินรวมทั้งสิ้น }
            { 1000000091;TextBox;1700 ;100  ;10700;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CommentText }
            { 1000000092;Label  ;100  ;100  ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=หมายเหตุ: }
            { 1000000020;TextBox;16200;0    ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Tax Invoice/Rec. Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Tax Invoice/Rec. Line".GetCurrencyCode }
            { 1000000007;TextBox;16200;800  ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Tax Invoice/Rec. Line"."Amount Including VAT" - "Sales Tax Invoice/Rec. Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Tax Invoice/Rec. Line".GetCurrencyCode }
            { 1000000004;TextBox;16200;1600 ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Tax Invoice/Rec. Line"."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Tax Invoice/Rec. Line".GetCurrencyCode }
            { 1000000113;Label  ;1700 ;100  ;9300 ;1400 ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เป็นการยกเลิกและออกใบกำกับภาษีฉบับใหม่แทนฉบับเดิมเลขที่ RAD10-12-0094 }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5060;
      Height=3300;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=[ENU=No. of Copies;
                                                              THA=จำนวนสำเนา];
                                                   SourceExpr=NoOfCopies }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Salesperson;THA=พนักงานขาย';
      Text001@1001 : TextConst 'ENU=Total %1;THA=รวม %1';
      Text002@1002 : TextConst 'ENU=Total %1 Incl. VAT;THA=ยอดรวม %1 ที่รวม VAT';
      Text003@1003 : TextConst 'ENU=COPY;THA=คัดลอก';
      Text004@1004 : TextConst 'ENU=Sales - Invoice %1;THA=การขาย - ใบส่งของ %1';
      Text005@1005 : TextConst 'ENU=Page %1;THA=หน้า %1';
      Text006@1006 : TextConst 'ENU=Total %1 Excl. VAT;THA=รวม %1 โดยไม่รวม VAT';
      CompanyInfo@1000000010 : Record 79;
      GLSetup@1007 : Record 98;
      SalesSetup@1000000011 : Record 311;
      ShipmentMethod@1008 : Record 10;
      PaymentTerms@1009 : Record 3;
      SalesPurchPerson@1000000013 : Record 13;
      SalesTaxInvHeader@1000000007 : Record 50054;
      SalesTaxInvLine@1000000006 : Record 50055;
      Cust@1012 : Record 18;
      VATAmountLine@1000000012 : TEMPORARY Record 290;
      FormatAddr@1019 : Codeunit 365;
      NoSeriesMgt@1000000008 : Codeunit 396;
      CustAddr@1021 : ARRAY [8] OF Text[50];
      ShipToAddr@1022 : ARRAY [8] OF Text[50];
      CompanyAddr@1023 : ARRAY [8] OF Text[50];
      VATNoText@1026 : Text[30];
      ReferenceText@1027 : Text[30];
      TotalText@1028 : Text[50];
      TotalExclVATText@1029 : Text[50];
      TotalInclVATText@1030 : Text[50];
      MoreLines@1031 : Boolean;
      NoOfCopies@1032 : Integer;
      NoOfLoops@1033 : Integer;
      CopyText@1034 : Text[30];
      ShowShippingAddr@1035 : Boolean;
      i@1036 : Integer;
      NextEntryNo@1043 : Integer;
      FirstValueEntryNo@1042 : Integer;
      DimText@1037 : Text[120];
      OldDimText@1038 : Text[75];
      ShowInternalInfo@1039 : Boolean;
      Continue@1040 : Boolean;
      LogInteraction@1041 : Boolean;
      TotalInclVATTextLCY@1500009 : Text[50];
      TotalExclVATTextLCY@1500008 : Text[50];
      AmountLCY@1500007 : Decimal;
      AmountIncLCY@1500006 : Decimal;
      CurrExchRate@1500005 : Record 330;
      CurrencyLCY@1500004 : Boolean;
      AmountInWords@1500003 : Boolean;
      AmountLangA@1500002 : ARRAY [2] OF Text[80];
      AmountLangB@1500001 : ARRAY [2] OF Text[80];
      SalesLine@1500000 : Record 37;
      ShowTHFormatting@1500010 : Boolean;
      Form50BIS@1000000003 : Report 50002;
      BillToName@1000000001 : Text[500];
      BillToAddress@1000000000 : Text[500];
      TextAmount@1000000005 : Text[250];
      PurchOrderNo@1000000002 : Code[20];
      CntLine@1000000004 : Integer;
      IssueDate@1000000009 : Date;
      tmpCompanyAddr@1000000017 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000016 : ARRAY [2] OF Text[250];
      SalesComtLine@1000000015 : Record 44;
      CommentText@1000000014 : Text[250];
      InvNoText@1000000018 : Text[50];
      Text007@1000000019 : TextConst 'ENU="ใบแจ้งหนี้ %1 "';
      LinePerPage@1000000020 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   15.05.2007   KKE   'Tax Invoice' Report.
      002   28.11.2007   KKE   Show Invoice No. on detail line.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50057 Complaint Report
{
  OBJECT-PROPERTIES
  {
    Date=05/16/07;
    Time=[ 6:00:00 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Opportunity - List;
               THA=โอกาส - รายการ];
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  ContactFilter := "Interaction Log Entry".GETFILTER("Interaction Log Entry".Date);
                END;

  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table5050;
        DataItemTableView=;
        OnAfterGetRecord=BEGIN
                           CLEAR(i);
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 3   ;TextBox      ;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1   ;Label        ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Complaint Report }
            { 1000000026;TextBox;15000;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::"Complaint Report") }
            { 1000000027;TextBox;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000028;TextBox;17700;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000029;Label  ;16950;423  ;750  ;423  ;ParentControl=1000000028 }
            { 1000000030;TextBox;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT((CurrReport.PAGENO = 1) AND (ContactFilter <> ''));
                         END;

          }
          CONTROLS
          {
            { 7   ;TextBox      ;0    ;0    ;18150;423  ;SourceExpr='Contact Date :' + ContactFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 1000000001;Label  ;4200 ;423  ;2700 ;423  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Subscriber No. }
            { 1000000003;Label  ;1350 ;423  ;2700 ;423  ;ParentControl=1000000002;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Document No. }
            { 1000000004;Label  ;7050 ;423  ;6900 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Name }
            { 1000000006;Label  ;14100;423  ;4050 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Tel. No. }
            { 1000000008;Label  ;5250 ;846  ;2700 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=End Time }
            { 1000000009;Label  ;8100 ;846  ;3600 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Duration (Min.) }
            { 1000000010;Label  ;11850;846  ;5100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Received by }
            { 1000000011;Label  ;2400 ;846  ;2700 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Start Time }
            { 1000000012;Label  ;3450 ;1269 ;2700 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Description }
            { 1000000018;Label  ;0    ;423  ;1200 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=No. }
            { 1000000023;Shape  ;0    ;0    ;18150;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000024;Shape  ;0    ;1692 ;18150;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table5065;
        DataItemTableView=SORTING(Contact Company No.,Contact No.,Date,Postponed);
        ReqFilterFields=Date;
        GroupTotalFields=Date;
        DataItemLink=Contact No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18150;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CLEAR(i);
                         END;

          }
          CONTROLS
          {
            { 1000000020;TextBox;2400 ;423  ;3750 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr=Date }
            { 1000000021;Label  ;0    ;423  ;2250 ;423  ;ParentControl=1000000020;
                                                         HorzAlign=Left;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         FontUnderline=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contact Date }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=1692;
            OnPreSection=BEGIN
                           i += 1 ;

                           CLEAR(SubscriberCode);
                           Subscriber.RESET;
                           Subscriber.SETRANGE("Contact No.","Interaction Log Entry"."Contact No.");
                           IF Subscriber.FIND('-') THEN
                             SubscriberCode := Subscriber."No." ;

                           CLEAR( tottime);
                           IF ("Interaction Log Entry"."Start Time" <> 0T) AND
                             ("Interaction Log Entry"."End Time" <> 0T) THEN
                             tottime  := ("Interaction Log Entry"."End Time"- "Interaction Log Entry"."Start Time")/60000;
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;4200 ;0    ;2700 ;423  ;HorzAlign=Left;
                                                         SourceExpr=SubscriberCode }
            { 1000000002;TextBox;1350 ;0    ;2700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Interaction Log Entry"."Reference No." }
            { 1000000005;TextBox;7050 ;0    ;6900 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Contact.Name }
            { 1000000007;TextBox;14100;0    ;4050 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Contact."Phone No." }
            { 1000000013;TextBox;2400 ;423  ;2700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Interaction Log Entry"."Start Time" }
            { 1000000014;TextBox;5250 ;423  ;2700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Interaction Log Entry"."End Time" }
            { 1000000015;TextBox;8100 ;423  ;3600 ;423  ;HorzAlign=Left;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=tottime }
            { 1000000016;TextBox;11850;423  ;5100 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Interaction Log Entry"."User ID" }
            { 1000000017;TextBox;3450 ;846  ;13650;423  ;HorzAlign=Left;
                                                         SourceExpr="Interaction Log Entry".Description }
            { 1000000019;TextBox;0    ;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr=i }
            { 1000000025;Shape  ;0    ;1269 ;18150;423  ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000022;Shape  ;0    ;0    ;18150;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      ContactFilter@1000 : Text[250];
      i@1000000000 : Integer;
      Subscriber@1000000001 : Record 50001;
      SubscriberCode@1000000002 : Code[20];
      tottime@1000000003 : Decimal;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50058 Ads. Billing Note
{
  OBJECT-PROPERTIES
  {
    Date=06/17/09;
    Time=[ 4:32:58 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=500;
    BottomMargin=1000;
    LeftMargin=1000;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50050;
        NewPagePerRecord=Yes;
        OnPreDataItem=BEGIN
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19230;
            SectionHeight=4595;
          }
          CONTROLS
          {
            { 1000000000;TextBox;241  ;0    ;9800 ;800  ;FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000003;TextBox;241  ;800  ;13400;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=tmpCompanyAddrTH[1] + ' ' + tmpCompanyAddrTH[2] }
            { 1000000004;TextBox;241  ;1300 ;13400;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=tmpCompanyAddr[1] + ' ' + tmpCompanyAddr[2] }
            { 1000000006;TextBox;241  ;1800 ;12180;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000018;TextBox;14900;2470 ;4300 ;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Ads. Billing Header"."No." }
            { 1000000016;Label  ;13500;2470 ;1200 ;630  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000021;TextBox;1400 ;3070 ;11700;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Ads. Billing Header"."Bill-to Customer No." + ' ' + "Ads. Billing Header"."Bill-to Name" + "Ads. Billing Header"."Bill-to Name 2" }
            { 1000000035;Label  ;13500;3070 ;1200 ;630  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000036;TextBox;14900;3070 ;3600 ;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Ads. Billing Header"."Billing Date" }
            { 1000000002;Label  ;0    ;3070 ;1300 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=ชื่อลูกค้า }
            { 1000000001;Label  ;6000 ;2400 ;5950 ;700  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบวางบิล }
            { 1000000007;Shape  ;0    ;3800 ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000009;Shape  ;0    ;4565 ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000010;Label  ;500  ;3900 ;1600 ;630  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=ลำดับที่ }
            { 1000000012;Label  ;2900 ;3900 ;6100 ;630  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=ใบแจ้งหนี้เลขที่ }
            { 1000000013;Label  ;10500;3900 ;2900 ;630  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=วันที่ }
            { 1000000015;Label  ;14700;3900 ;3900 ;630  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 1000000017;Shape  ;0    ;3815 ;30   ;780  ;ShapeStyle=VertLine }
            { 1000000019;Shape  ;2600 ;3815 ;30   ;780  ;ShapeStyle=VertLine }
            { 1000000020;Shape  ;9900 ;3815 ;30   ;780  ;ShapeStyle=VertLine }
            { 1000000022;Shape  ;13800;3815 ;30   ;780  ;ShapeStyle=VertLine }
            { 1000000023;Shape  ;19200;3815 ;30   ;780  ;ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        OnAfterGetRecord=BEGIN
                           i := 0;
                           CntLine := 0;
                           TotalAmount := 0;
                           TotalAmountText := '';
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table50051;
        DataItemTableView=SORTING(Billing No.,Line No.)
                          WHERE(Billing Amount=FILTER(<>0));
        OnPreDataItem=BEGIN
                        IF "Ads. Billing Line".FIND('-') THEN
                          IF NOT CurrReport.PREVIEW THEN BEGIN
                            "Ads. Billing Header".Status := "Ads. Billing Header".Status::Release;
                            "Ads. Billing Header".MODIFY;
                          END;
                      END;

        OnAfterGetRecord=BEGIN
                           i += 1;
                           CntLine += 1;
                         END;

        TotalFields=Billing Amount;
        DataItemLinkReference=Ads. Billing Header;
        DataItemLink=Billing No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19230;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000008;TextBox;2900 ;0    ;4500 ;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Document No." }
            { 1000000011;TextBox;10500;0    ;2900 ;500  ;Visible=Yes;
                                                         HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Due Date" }
            { 1000000014;TextBox;14700;0    ;3900 ;500  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Billing Amount" }
            { 1000000025;Shape  ;19200;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000027;Shape  ;13800;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000029;Shape  ;9900 ;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000031;Shape  ;2600 ;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000033;Shape  ;0    ;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000034;TextBox;500  ;0    ;1600 ;500  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=i }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19230;
            SectionHeight=500;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000037;Shape  ;0    ;0    ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000053;Label  ;15400;0    ;3700 ;500  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=Continue... }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,8-CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19230;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000043;Shape  ;19200;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000044;Shape  ;13800;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000054;Shape  ;9900 ;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000055;Shape  ;2600 ;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;0    ;0    ;30   ;500  ;ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnAfterGetRecord=BEGIN
                           TotalAmount := "Ads. Billing Line"."Billing Amount";
                           TotalAmountText := Form50BIS.FormatNoThaiText(TotalAmount);
                           IF TotalAmountText <> '' THEN
                             TotalAmountText := '(' + TotalAmountText + ')';
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19230;
            SectionHeight=830;
          }
          CONTROLS
          {
            { 1000000028;Shape  ;19200;0    ;30   ;815  ;ShapeStyle=VertLine }
            { 1000000026;TextBox;14100;0    ;4500 ;800  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         BlankZero=Yes;
                                                         SourceExpr=TotalAmount }
            { 1000000030;Shape  ;13800;0    ;30   ;815  ;ShapeStyle=VertLine }
            { 1000000046;TextBox;100  ;0    ;13400;800  ;FontName=CordiaUPC;
                                                         FontSize=14;
                                                         FontBold=No;
                                                         SourceExpr=TotalAmountText }
            { 1000000032;Shape  ;15   ;800  ;19200;30   ;ShapeStyle=HorzLine }
            { 1000000038;Shape  ;0    ;0    ;30   ;815  ;ShapeStyle=VertLine }
            { 1000000024;Shape  ;15   ;0    ;19200;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19230;
            SectionHeight=2730;
          }
          CONTROLS
          {
            { 1000000039;Label  ;100  ;100  ;13400;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=ได้รับต้นฉบับเอกสารถูกต้องและครบถ้วน ตามรายละเอียดข้างต้นเรียบร้อยแล้ว }
            { 1000000045;Label  ;100  ;1000 ;1600 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=ผู้รับวางบิล }
            { 1000000047;Label  ;3500 ;1500 ;2000 ;630  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=(ตัวบรรจง) }
            { 1000000048;Label  ;1700 ;1000 ;7700 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=________________________________________________ }
            { 1000000049;Label  ;100  ;2100 ;3500 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=โปรดมารับชำระเงินในวันที่ }
            { 1000000050;Label  ;3600 ;2100 ;13900;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=____________________________________________________________________________ }
            { 1000000051;Label  ;10900;1000 ;4500 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=____________________________ }
            { 1000000052;Label  ;10100;1000 ;800  ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=วันที่ }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000000 : Record 79;
      Form50BIS@1000000007 : Report 50002;
      FormatAddr@1000000003 : Codeunit 365;
      CompanyAddr@1000000005 : ARRAY [8] OF Text[50];
      tmpCompanyAddr@1000000002 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000001 : ARRAY [2] OF Text[250];
      i@1000000009 : Integer;
      CntLine@1000000004 : Integer;
      TotalAmount@1000000006 : Decimal;
      TotalAmountText@1000000008 : Text[250];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.05.2007   KKE   New report for "Ads. Billing Note" - Ads. Sales Module
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50059 Account Payable Voucher -Pre.
{
  OBJECT-PROPERTIES
  {
    Date=10/12/07;
    Time=[ 2:31:43 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  CompanyInfo.GET;
                  CompanyInfo.CALCFIELDS(Picture);
                  GLSetup.GetShortcutDimCode(ShortcutDimCode);
                  IF ShortcutDimCode[2] = 'DEPARTMENT' THEN
                    ShortcutDimCode[2] := 'DEPT.';
                END;

    PaperSize=A4 210 x 297 mm;
    HorzGrid=50;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table38;
        DataItemTableView=SORTING(Document Type,No.);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(DrAmount,CrAmount);
                      END;

        OnAfterGetRecord=BEGIN
                           CLEAR(AccCode);
                           CLEAR(AccName);
                           CLEAR(Dimension1Code);
                           CLEAR(Dimension2Code);
                           CLEAR(Dimension3Code);
                           CLEAR(Dimension4Code);
                           CLEAR(Dimension5Code);
                           CLEAR(DrAmount);
                           CLEAR(CrAmount);
                           CLEAR(TotalDrAmount);
                           CLEAR(TotalCrAmount);
                           CLEAR(WHTCode);
                           CLEAR(WHTCrAmount);

                           Description := "Ship-to Name (Thai)";
                           PostingDate := "Posting Date";
                           DocumentNo := "No.";
                         END;

        ReqFilterFields=Document Type,No.;
        GroupTotalFields=No.;
        CalcFields=Amount,Amount Including VAT;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19300;
            SectionHeight=6100;
            OnPreSection=BEGIN
                           CntLine := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000053;Label  ;12200;1900 ;6900 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PRE-POST.............................................................. }
            { 1000000068;TextBox;13900;1900 ;4600 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="No." }
            { 1000000073;Shape  ;0    ;4985 ;19100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000074;Label  ;15950;5300 ;3000 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=CREDIT }
            { 1000000075;Shape  ;15800;5000 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000076;Label  ;12750;5300 ;3000 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT }
            { 1000000079;Shape  ;2850 ;5000 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000080;Label  ;3300 ;5300 ;5500 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DESCRIPTION }
            { 1000000081;Label  ;150  ;5300 ;2650 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ACCOUNT CODE }
            { 1000000082;Shape  ;0    ;6070 ;19100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000083;Shape  ;19100;5000 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000084;Shape  ;0    ;5000 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000121;Label  ;0    ;3700 ;1600 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=VENDOR : }
            { 1000000122;TextBox;1700 ;3700 ;10300;550  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr="Purchase Header"."Pay-to Vendor No." + ' ' + "Purchase Header"."Pay-to Name" + '' + "Purchase Header"."Pay-to Name 2" }
            { 1000000023;Label  ;10000;0    ;6650 ;850  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ACCOUNT PAYABLE VOUCHER }
            { 1000000048;TextBox;0    ;0    ;9700 ;900  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000055;Label  ;12200;2500 ;6900 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=POSTED................................................................... }
            { 1000000062;Label  ;12200;3050 ;6900 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DATE....................................................................... }
            { 1000000063;TextBox;13350;3050 ;4650 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Posting Date" }
            { 1000000071;Label  ;12200;3700 ;6900 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PRINTED DATE................................................... }
            { 1000000072;TextBox;14500;3700 ;3700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=TODAY }
            { 1000000010;Shape  ;9500 ;5000 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000046;TextBox;9650 ;5315 ;1500 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ShortcutDimCode[1] }
            { 1000000054;Shape  ;11150;5000 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000056;TextBox;11300;5330 ;1250 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ShortcutDimCode[2] }
            { 1000000077;Shape  ;12550;5000 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000091;TextBox;0    ;4300 ;19050;550  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr='Description : ' + "Purchase Header"."Invoice Description" }
            { 1000000038;TextBox;0    ;900  ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" }
            { 1000000041;TextBox;0    ;1500 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000042;TextBox;0    ;2100 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr='Tel: ' + CompanyInfo."Phone No." + ' Fax: ' + CompanyInfo."Fax No." }
            { 1000000049;TextBox;0    ;2700 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='VAT Registration No. ' + CompanyInfo."VAT Registration No." }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19300;
            SectionHeight=830;
            OnPreSection=BEGIN
                           CheckReport.InitTextVariable;
                           CheckReport.FormatNoText(TextAmount,ABS(TotalDrAmount),"Currency Code");

                           IF TextAmount[1] <> '' THEN
                             TextAmount[1] := '(' + TextAmount[1] + ')';
                         END;

          }
          CONTROLS
          {
            { 1000000025;Label  ;11050;100  ;1450 ;600  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000026;TextBox;15950;100  ;3000 ;600  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=CREDIT;
                                                         SourceExpr=TotalCrAmount }
            { 1000000027;TextBox;12750;100  ;3000 ;600  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=TotalDrAmount }
            { 1000000028;Shape  ;19100;0    ;30   ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000029;Shape  ;15800;0    ;150  ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000030;Shape  ;12550;0    ;150  ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000031;Shape  ;0    ;0    ;30   ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000032;Shape  ;15   ;0    ;19100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000045;Shape  ;0    ;800  ;19100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000014;TextBox;100  ;100  ;10850;600  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=TextAmount[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19300;
            SectionHeight=3015;
          }
          CONTROLS
          {
            { 1000000001;Shape  ;19100;215  ;30   ;2785 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000033;Shape  ;0    ;200  ;19100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000036;Label  ;10600;200  ;8100 ;600  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved by }
            { 1000000016;Shape  ;10000;200  ;30   ;2785 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000037;Label  ;400  ;200  ;9000 ;600  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By }
            { 1000000034;Shape  ;0    ;900  ;19100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000018;Shape  ;0    ;215  ;30   ;2785 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000043;Label  ;10650;1670 ;8050 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_____________________________ }
            { 1000000039;Label  ;400  ;1685 ;9000 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_____________________________ }
            { 1000000040;Label  ;400  ;2335 ;9000 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_________/_________/_________ }
            { 1000000044;Label  ;10650;2320 ;8050 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_________/_________/_________ }
            { 1000000035;Shape  ;0    ;2985 ;19100;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table39;
        DataItemTableView=SORTING(Document Type,Document No.,Line No.)
                          WHERE(Type=FILTER(<>' '));
        OnAfterGetRecord=BEGIN
                           CLEAR(AccountNo);
                           CASE Type OF
                             Type::"G/L Account":
                               BEGIN
                                 AccountNo := "No.";
                               END;
                             Type::Item:
                               BEGIN
                                 GenPostingSetup.GET("Gen. Bus. Posting Group","Gen. Prod. Posting Group");
                                 //HKK : #002 +
                                 //Remark By KK
                                 //AccountNo := GenPostingSetup."Purch. Account";
                                 //HKK : #002 -
                               END;
                             Type::"Fixed Asset":
                               BEGIN
                                 FALedgEntry.INIT;
                                 CASE "FA Posting Type" OF
                                   "FA Posting Type"::"Acquisition Cost":
                                     FALedgEntry."FA Posting Type" := FALedgEntry."FA Posting Type"::"Acquisition Cost";
                                 END;
                                 FALedgEntry."FA Posting Group" := "Posting Group";
                                 AccountNo := FAGetGLAccNo.GetAccNo(FALedgEntry);
                               END;
                             ELSE
                               EXIT;
                           END;

                           IF NOT GLAcc.GET(AccountNo) THEN
                             GLAcc.INIT;

                           ShortcutDim3Code := '';
                           ShortcutDim4Code := '';
                           ShortcutDim5Code := '';
                           IF DocumentDim.GET(39,"Document Type","Document No.","Line No.",ShortcutDimCode[3]) THEN
                             ShortcutDim3Code := DocumentDim."Dimension Value Code";
                           IF DocumentDim.GET(39,"Document Type","Document No.","Line No.",ShortcutDimCode[4]) THEN
                             ShortcutDim4Code := DocumentDim."Dimension Value Code";
                           IF DocumentDim.GET(39,"Document Type","Document No.","Line No.",ShortcutDimCode[5]) THEN
                             ShortcutDim5Code := DocumentDim."Dimension Value Code";

                           i := 0;
                           MatchAcc := FALSE;
                           REPEAT
                             i := i + 1;
                             IF ((AccCode[i] = AccountNo) AND
                                 (AccName[i] = Description) AND //KKE : #003
                                 (Dimension1Code[i] = "Shortcut Dimension 1 Code") AND
                                 (Dimension2Code[i] = "Shortcut Dimension 2 Code") AND
                                 (Dimension3Code[i] = ShortcutDim3Code) AND
                                 (Dimension4Code[i] = ShortcutDim4Code) AND
                                 (Dimension5Code[i] = ShortcutDim5Code))
                                OR (AccCode[i] = '')
                             THEN
                               MatchAcc := TRUE;
                           UNTIL (i=27) OR MatchAcc;

                           AccCode[i] := AccountNo;
                           //AccName[i] := GLAcc.Name;
                           AccName[i] := Description;  //KKE : #003
                           Dimension1Code[i] := "Shortcut Dimension 1 Code";
                           Dimension2Code[i] := "Shortcut Dimension 2 Code";
                           Dimension3Code[i] := ShortcutDim3Code;
                           Dimension4Code[i] := ShortcutDim4Code;
                           Dimension5Code[i] := ShortcutDim5Code;

                           {
                           IF "Qty. to Invoice" = Quantity THEN
                             VATBaseAmt := "VAT Base Amount"
                           ELSE
                             VATBaseAmt := ROUND("VAT Base Amount" * "Qty. to Invoice" / Quantity);
                           } //change code for rounding amount by using line discount - 20.03.2007
                           {
                           IF "Qty. to Invoice" = Quantity THEN
                             VATBaseAmt := "VAT Base Amount" - "Line Discount Amount"
                           ELSE
                             VATBaseAmt := ROUND("VAT Base Amount" * "Qty. to Invoice" / Quantity) - "Line Discount Amount";
                           } //29.03.2007

                           //KKE : xxx
                           IF "Avg. VAT Amount" <> 0 THEN BEGIN
                             IF "Qty. to Invoice" = Quantity THEN
                               VATBaseAmt := "Amount Including VAT" - "Avg. VAT Amount"
                             ELSE
                               VATBaseAmt := ROUND(("Amount Including VAT" - "Avg. VAT Amount") * "Qty. to Invoice" / Quantity);
                           END ELSE BEGIN
                           //KKE : xxx
                             IF "Qty. to Invoice" = Quantity THEN
                               VATBaseAmt := Amount
                             ELSE
                               VATBaseAmt := ROUND(Amount * "Qty. to Invoice" / Quantity);
                           END;

                           //HKK : #002 +
                           { Remark By KK
                           IF "Qty. to Invoice" * "Unit Cost (LCY)" >= 0 THEN
                             DrAmount[i] := DrAmount[i] + "Qty. to Invoice" * "Unit Cost (LCY)"
                           ELSE
                             CrAmount[i] := CrAmount[i] - "Qty. to Invoice" * "Unit Cost (LCY)";
                           }
                           IF AccountNo <> '' THEN BEGIN
                             IF VATBaseAmt >= 0 THEN
                               DrAmount[i] := DrAmount[i] + VATBaseAmt
                             ELSE
                               CrAmount[i] := CrAmount[i] - VATBaseAmt;
                           END;
                           //HKK : #002 -

                           // VAT
                           CLEAR(AccountNo);
                           VATPostingSetup.GET("VAT Bus. Posting Group","VAT Prod. Posting Group");
                           IF VATPostingSetup."Purch. VAT Unreal. Account" <> '' THEN
                             AccountNo := VATPostingSetup."Purch. VAT Unreal. Account"
                           ELSE
                             AccountNo := VATPostingSetup."Purchase VAT Account";
                           IF NOT GLAcc.GET(AccountNo) THEN
                             GLAcc.INIT;

                           i := 0;
                           MatchAcc := FALSE;
                           REPEAT
                             i := i + 1;
                             IF ((AccCode[i] = AccountNo) AND
                                 (Dimension1Code[i] = "Shortcut Dimension 1 Code") AND
                                 (Dimension2Code[i] = "Shortcut Dimension 2 Code") AND
                                 (Dimension3Code[i] = ShortcutDim3Code) AND
                                 (Dimension4Code[i] = ShortcutDim4Code) AND
                                 (Dimension5Code[i] = ShortcutDim5Code))
                                OR (AccCode[i] = '')
                             THEN
                               MatchAcc := TRUE;
                           UNTIL (i=27) OR MatchAcc;
                           AccCode[i] := AccountNo;
                           AccName[i] := GLAcc.Name;
                           Dimension1Code[i] := "Shortcut Dimension 1 Code";
                           Dimension2Code[i] := "Shortcut Dimension 2 Code";
                           Dimension3Code[i] := ShortcutDim3Code;
                           Dimension4Code[i] := ShortcutDim4Code;
                           Dimension5Code[i] := ShortcutDim5Code;
                           //VATAmt := ROUND("Qty. to Invoice" * "Direct Unit Cost") * "VAT %" /100 + "VAT Difference";
                           //VATAmt := VATBaseAmt * "VAT %" /100 + "VAT Difference";

                           //KKE : xxx
                           IF "Avg. VAT Amount" <> 0 THEN
                             VATAmt := "Avg. VAT Amount"
                           ELSE
                           //KKE : xxx
                             VATAmt := "Amount Including VAT" - Amount;  //04.06.2007

                           //IF VATAmt  >= 0 THEN  //KKE : 26.03.2007
                           IF DrAmount[i] + VATAmt  >= 0 THEN
                             DrAmount[i] := DrAmount[i] + VATAmt
                           ELSE
                             CrAmount[i] := CrAmount[i] - VATAmt;

                           // WHT
                           WHTPostingSetup.GET("WHT Business Posting Group","WHT Product Posting Group");
                           IF WHTPostingSetup."WHT %" <> 0 THEN BEGIN
                             i := 0;
                             {--
                             REPEAT
                               i := i + 1;
                             UNTIL (i=200) OR (WHTCode[i] = '');
                             ---}  //Burda
                             MatchAcc := FALSE;
                             REPEAT
                               i := i + 1;
                               IF (WHTProd[i] = "WHT Product Posting Group") OR (WHTProd[i] = '') THEN
                                 MatchAcc := TRUE;
                             UNTIL (i=200) OR MatchAcc;
                             WHTCode[i] := 'WHT';
                             WHTProd[i] := "WHT Product Posting Group";
                             IF "WHT Absorb Base" = 0 THEN
                               WHTCrAmount[i] += ROUND("Qty. to Invoice" * "Unit Cost (LCY)" * WHTPostingSetup."WHT %" /100)
                             ELSE
                               WHTCrAmount[i] += ROUND("WHT Absorb Base" * WHTPostingSetup."WHT %" /100);
                           END;

                           //Direct Inventory post cost
                           IF ("Job No." = '') AND (Type = Type::Item) THEN BEGIN
                             IF InventoryPostingSetup.GET("Location Code","Posting Group") THEN BEGIN
                               AccountNo := InventoryPostingSetup."Inventory Account";
                               IF NOT GLAcc.GET(AccountNo) THEN
                                 GLAcc.INIT;

                               MatchAcc := FALSE;
                               i := 0;
                               REPEAT
                                 i := i + 1;
                                 IF ((AccCode[i] = AccountNo) AND
                                     (Dimension1Code[i] = "Shortcut Dimension 1 Code") AND
                                     (Dimension2Code[i] = "Shortcut Dimension 2 Code") AND
                                     (Dimension3Code[i] = ShortcutDim3Code) AND
                                     (Dimension4Code[i] = ShortcutDim4Code) AND
                                     (Dimension5Code[i] = ShortcutDim5Code))
                                    OR (AccCode[i] = '')
                                 THEN
                                   MatchAcc := TRUE;
                               UNTIL (i=27) OR MatchAcc;
                               AccCode[i] := AccountNo;
                               AccName[i] := GLAcc.Name;
                               Dimension1Code[i] := "Shortcut Dimension 1 Code";
                               Dimension2Code[i] := "Shortcut Dimension 2 Code";
                               Dimension3Code[i] := ShortcutDim3Code;
                               Dimension4Code[i] := ShortcutDim4Code;
                               Dimension5Code[i] := ShortcutDim5Code;
                               //DrAmount[i] := DrAmount[i] + "Qty. to Invoice" * "Direct Unit Cost";
                               DrAmount[i] := DrAmount[i] + VATBaseAmt;

                               //HKK : #002 +
                               { Remark By KK
                               GenPostingSetup.GET("Gen. Bus. Posting Group","Gen. Prod. Posting Group");
                               AccountNo := GenPostingSetup."Direct Cost Applied Account";
                               IF NOT GLAcc.GET(AccountNo) THEN
                                 GLAcc.INIT;
                               MatchAcc := FALSE;
                               i := 0;
                               REPEAT
                                 i := i + 1;
                                 IF ((AccCode[i] = AccountNo) AND
                                     (Dimension1Code[i] = "Shortcut Dimension 1 Code") AND
                                     (Dimension2Code[i] = "Shortcut Dimension 2 Code") AND
                                     (Dimension3Code[i] = ShortcutDim3Code) AND
                                     (Dimension4Code[i] = ShortcutDim4Code) AND
                                     (Dimension5Code[i] = ShortcutDim5Code))
                                    OR (AccCode[i] = '')
                                 THEN
                                   MatchAcc := TRUE;
                               UNTIL (i=27) OR MatchAcc;
                               AccCode[i] := AccountNo;
                               AccName[i] := GLAcc.Name;
                               Dimension1Code[i] := "Shortcut Dimension 1 Code";
                               Dimension2Code[i] := "Shortcut Dimension 2 Code";
                               Dimension3Code[i] := ShortcutDim3Code;
                               Dimension4Code[i] := ShortcutDim4Code;
                               Dimension5Code[i] := ShortcutDim5Code;
                               CrAmount[i] := CrAmount[i] + "Qty. to Invoice" * "Unit Cost (LCY)";
                               }
                               //HKK : #002 -
                             END;
                           END;
                         END;

        DataItemLink=Document Type=FIELD(Document Type),
                     Document No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=Detail;
        OnPreDataItem=BEGIN
                        VendPostingGrp.GET("Purchase Header"."Vendor Posting Group");
                        IF NOT GLAcc.GET(VendPostingGrp."Payables Account") THEN
                          GLAcc.INIT;

                        ShortcutDim3Code := '';
                        ShortcutDim4Code := '';
                        ShortcutDim5Code := '';
                        IF DocumentDim.GET(38,"Purchase Header"."Document Type","Purchase Header"."No.",0,ShortcutDimCode[3]) THEN
                          ShortcutDim3Code := DocumentDim."Dimension Value Code";
                        IF DocumentDim.GET(38,"Purchase Header"."Document Type","Purchase Header"."No.",0,ShortcutDimCode[4]) THEN
                          ShortcutDim4Code := DocumentDim."Dimension Value Code";
                        IF DocumentDim.GET(38,"Purchase Header"."Document Type","Purchase Header"."No.",0,ShortcutDimCode[5]) THEN
                          ShortcutDim5Code := DocumentDim."Dimension Value Code";

                        MatchAcc := FALSE;
                        i := 0;
                        REPEAT
                          i := i + 1;
                          IF ((AccCode[i] =  VendPostingGrp."Payables Account") AND
                              (Dimension1Code[i] = "Purchase Header"."Shortcut Dimension 1 Code") AND
                              (Dimension2Code[i] = "Purchase Header"."Shortcut Dimension 2 Code") AND
                              (Dimension3Code[i] = ShortcutDim3Code) AND
                              (Dimension4Code[i] = ShortcutDim4Code) AND
                              (Dimension5Code[i] = ShortcutDim5Code))
                             OR (AccCode[i] = '')
                          THEN
                            MatchAcc := TRUE
                        UNTIL (i=27) OR MatchAcc;

                        AccCode[i] := VendPostingGrp."Payables Account";
                        AccName[i] := GLAcc.Name;
                        Dimension1Code[i] := "Purchase Header"."Shortcut Dimension 1 Code";
                        Dimension2Code[i] := "Purchase Header"."Shortcut Dimension 2 Code";
                        Dimension3Code[i] := ShortcutDim3Code;
                        Dimension4Code[i] := ShortcutDim4Code;
                        Dimension5Code[i] := ShortcutDim5Code;

                        FOR j := 1 TO 27 DO BEGIN
                          IF i <> j THEN
                            CrAmount[i] := CrAmount[i] + DrAmount[j] - CrAmount[j]
                          ELSE
                            CrAmount[i] := CrAmount[i] + DrAmount[j];
                        END;
                        IF CrAmount[i] < 0 THEN BEGIN
                          DrAmount[i] := -CrAmount[i];
                          CrAmount[i] := 0;
                        END;

                        //Incase Purchase Credit Memo.
                        IF "Purchase Header"."Document Type" = "Purchase Header"."Document Type"::"Credit Memo" THEN BEGIN
                          i := 27;
                          j := 0;
                          REPEAT
                            IF AccCode[i] <> '' THEN BEGIN
                              j := j + 1;
                              CrMemoAccCode[j] := AccCode[i];
                              CrMemoAccName[j] := AccName[i];
                              CrMemoDim1Code[i] := Dimension1Code[i];
                              CrMemoDim2Code[i] := Dimension2Code[i];
                              CrMemoDim3Code[i] := Dimension3Code[i];
                              CrMemoDim4Code[i] := Dimension4Code[i];
                              CrMemoDim5Code[i] := Dimension5Code[i];
                              IF CrAmount[i] <> 0 THEN
                                CrMemoDrAmount[j] := CrAmount[i]
                              ELSE
                                CrMemoCrAmount[j] := DrAmount[i];
                            END;
                            i := i - 1;
                          UNTIL i=0;
                          CLEAR(AccCode);
                          CLEAR(AccName);
                          CLEAR(DrAmount);
                          CLEAR(CrAmount);
                          FOR i:=1 TO j DO BEGIN
                            AccCode[i] := CrMemoAccCode[i];
                            AccName[i] := CrMemoAccName[i];
                            Dimension1Code[i] := CrMemoDim1Code[i];
                            Dimension2Code[i] := CrMemoDim2Code[i];
                            Dimension3Code[i] := CrMemoDim3Code[i];
                            Dimension4Code[i] := CrMemoDim4Code[i];
                            Dimension5Code[i] := CrMemoDim5Code[i];
                            DrAmount[i] := CrMemoDrAmount[i];
                            CrAmount[i] := CrMemoCrAmount[i];
                          END;
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           IF AccCode[Number] = '' THEN
                             CurrReport.BREAK;

                           IF (DrAmount[Number] = 0) AND (CrAmount[Number] = 0) THEN
                             CurrReport.SKIP;

                           CntLine += 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=500;
            OnPreSection=BEGIN
                           IF (DrAmount[Number] <> 0) AND (CrAmount[Number] <> 0) THEN
                             IF DrAmount[Number] > CrAmount[Number] THEN BEGIN
                               DrAmount[Number] := DrAmount[Number] - CrAmount[Number];
                               CrAmount[Number] := 0;
                             END ELSE BEGIN
                               CrAmount[Number] := CrAmount[Number] - DrAmount[Number];
                               DrAmount[Number] := 0;
                             END;

                           TotalDrAmount := TotalDrAmount + DrAmount[Number];
                           TotalCrAmount := TotalCrAmount + CrAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000003;TextBox;150  ;0    ;2650 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=AccCode[Number] }
            { 1000000005;TextBox;3050 ;0    ;6450 ;500  ;FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr=AccName[Number] }
            { 1000000006;TextBox;12750;0    ;3000 ;500  ;FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=DrAmount[Number] }
            { 1000000007;TextBox;15950;0    ;3000 ;500  ;FontSize=9;
                                                         CaptionML=ENU=CREDIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=CrAmount[Number] }
            { 1000000008;Shape  ;19100;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000009;Shape  ;15800;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000011;Shape  ;2850 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000012;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000097;Shape  ;12550;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000094;TextBox;11300;0    ;1250 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=Dimension2Code[Number] }
            { 1000000092;Shape  ;11150;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000096;TextBox;9650 ;0    ;1500 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=Dimension1Code[Number] }
            { 1000000095;Shape  ;9500 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=WHT;
        OnAfterGetRecord=BEGIN
                           IF WHTCode[Number] = '' THEN
                            CurrReport.BREAK;

                           CntLine += 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := "Purchase Header"."Document Type" = "Purchase Header"."Document Type"::"Credit Memo";
                         END;

          }
          CONTROLS
          {
            { 1000000002;TextBox;150  ;0    ;2650 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=WHTCode[Number] }
            { 1000000015;TextBox;12750;0    ;3000 ;500  ;FontSize=9;
                                                         CaptionML=ENU=CREDIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTCrAmount[Number] }
            { 1000000017;Shape  ;19100;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000019;Shape  ;15800;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000021;Shape  ;2850 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000022;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000020;Shape  ;9500 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000024;Shape  ;11150;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000059;Shape  ;12550;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000000;TextBox;3600 ;0    ;4900 ;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=WHTProd[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := "Purchase Header"."Document Type" <> "Purchase Header"."Document Type"::"Credit Memo";
                         END;

          }
          CONTROLS
          {
            { 1000000004;TextBox;150  ;0    ;2650 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=WHTCode[Number] }
            { 1000000013;TextBox;15950;0    ;3000 ;500  ;FontSize=9;
                                                         CaptionML=ENU=CREDIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTCrAmount[Number] }
            { 1000000057;Shape  ;19100;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000058;Shape  ;15800;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000060;Shape  ;2850 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000061;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000065;Shape  ;9500 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000066;Shape  ;11150;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000067;Shape  ;12550;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000064;TextBox;3600 ;0    ;4950 ;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=WHTProd[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Description1;
        OnAfterGetRecord=BEGIN
                           CntLine += 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := "Purchase Header"."Document Type" <> "Purchase Header"."Document Type"::"Credit Memo";
                         END;

          }
          CONTROLS
          {
            { 1000000047;Shape  ;19100;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000050;Shape  ;15800;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000112;Shape  ;2850 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000113;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000069;Shape  ;9500 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000070;Shape  ;11150;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000078;Shape  ;12550;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000088;Label  ;150  ;0    ;3000 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=Vendor Invoice No. }
            { 1000000089;TextBox;3250 ;0    ;6150 ;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Purchase Header"."Vendor Invoice No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := "Purchase Header"."Document Type" = "Purchase Header"."Document Type"::"Credit Memo";
                         END;

          }
          CONTROLS
          {
            { 1000000090;Shape  ;19100;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000093;Shape  ;15800;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000098;Shape  ;2850 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000099;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000100;Shape  ;9500 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000101;Shape  ;11150;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000102;Shape  ;12550;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000103;Label  ;150  ;0    ;3000 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=Vendor Cr. Memo No. }
            { 1000000104;TextBox;3250 ;0    ;6150 ;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         SourceExpr="Purchase Header"."Vendor Cr. Memo No." }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=Line Loop;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,30 - CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19300;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000051;Shape  ;19100;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000052;Shape  ;15800;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000105;Shape  ;2850 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000106;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000085;Shape  ;9500 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000086;Shape  ;11150;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000087;Shape  ;12550;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000000 : Record 79;
      VendPostingGrp@1000000015 : Record 93;
      GenPostingSetup@1000000016 : Record 252;
      VATPostingSetup@1000000018 : Record 325;
      WHTPostingSetup@1000000020 : Record 28043;
      PurchLine@1000000014 : Record 39;
      GLSetup@1000000034 : Record 98;
      GLAcc@1000 : Record 15;
      DocumentDim@1000000004 : Record 357;
      InventoryPostingSetup@1000000021 : Record 5813;
      Description@1000000001 : Text[250];
      DocumentNo@1000000002 : Code[20];
      PostingDate@1000000003 : Date;
      AccountNo@1000000017 : Code[20];
      AccCode@1000000005 : ARRAY [27] OF Code[20];
      AccName@1000000006 : ARRAY [27] OF Text[50];
      DrAmount@1000000008 : ARRAY [27] OF Decimal;
      CrAmount@1000000009 : ARRAY [27] OF Decimal;
      TotalDrAmount@1000000012 : Decimal;
      TotalCrAmount@1000000011 : Decimal;
      MatchAcc@1000000013 : Boolean;
      i@1000000010 : Integer;
      j@1000000019 : Integer;
      WHTCode@1000000026 : ARRAY [200] OF Code[20];
      WHTCrAmount@1000000022 : ARRAY [200] OF Decimal;
      CrMemoAccCode@1000000029 : ARRAY [27] OF Code[20];
      CrMemoAccName@1000000028 : ARRAY [27] OF Text[50];
      CrMemoDrAmount@1000000025 : ARRAY [27] OF Decimal;
      CrMemoCrAmount@1000000023 : ARRAY [27] OF Decimal;
      Dimension1Code@1000000043 : ARRAY [27] OF Code[20];
      Dimension2Code@1000000042 : ARRAY [27] OF Code[20];
      Dimension3Code@1000000041 : ARRAY [27] OF Code[20];
      Dimension4Code@1000000040 : ARRAY [27] OF Code[20];
      Dimension5Code@1000000039 : ARRAY [27] OF Code[20];
      ShortcutDimCode@1000000033 : ARRAY [8] OF Code[20];
      ShortcutDim1Code@1000000036 : Code[20];
      ShortcutDim2Code@1000000035 : Code[20];
      ShortcutDim3Code@1000000032 : Code[20];
      ShortcutDim4Code@1000000031 : Code[20];
      ShortcutDim5Code@1000000030 : Code[20];
      CrMemoDim1Code@1000000047 : ARRAY [27] OF Code[20];
      CrMemoDim2Code@1000000046 : ARRAY [27] OF Code[20];
      CrMemoDim3Code@1000000045 : ARRAY [27] OF Code[20];
      CrMemoDim4Code@1000000044 : ARRAY [27] OF Code[20];
      CrMemoDim5Code@1000000038 : ARRAY [27] OF Code[20];
      CntLine@1000000037 : Integer;
      FALedgEntry@1000000024 : Record 5601;
      FAGetGLAccNo@1000000007 : Codeunit 5602;
      FormatAddr@1000000027 : Codeunit 365;
      VATBaseAmt@1000000049 : Decimal;
      VATAmt@1000000048 : Decimal;
      CheckReport@1000000051 : Report 1401;
      TextAmount@1000000050 : ARRAY [2] OF Text[250];
      WHTProd@1000000052 : ARRAY [200] OF Code[20];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   14.09.2006   KKE   -New report 'Account Payable Voucher' (before posted).
                               -Show G/L entries related to cost of inventory. These entries are posted
                                automatically by the system when user does not input job code on purchase line.
                               -Account Payable for Credit memo need to show debit,credit g/l account correctly.
      002   08.12.2006   KKE   -For the Type = Item, The Purchase Account and Direct Cost Account is not showed.
                               -Add column Shortcut Dimension 2 Code (Department).
      003   25.09.2007   KKE   -add criteria to group data by description. (request by p'Nok)
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50060 Sales - Invoice Circulation
{
  OBJECT-PROPERTIES
  {
    Date=11/29/19;
    Time=11:14:59 AM;
    Modified=Yes;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    Permissions=TableData 7190=rimd;
    CaptionML=[ENU=Sales - Invoice Circulation;
               THA=การขาย - ใบส่งของ];
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   CompanyInfo.GET;
                   SalesSetup.GET;
                 END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table112;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Posted Sales Invoice;
                            THA=ใบส่งของสินค้าขายที่ลงรายการบัญชี];
        OnPreDataItem=BEGIN
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                      END;

        OnAfterGetRecord=BEGIN
                           FormatAddr.Company(CompanyAddr,CompanyInfo);

                           BillToName := "Bill-to Name (Thai)";
                           IF BillToName = '' THEN
                             BillToName := "Bill-to Name" + "Bill-to Name 2";

                           BillToAddress := "Bill-to Address (Thai)";
                           IF BillToAddress = '' THEN
                             BillToAddress := "Bill-to Address" + ' ' + "Bill-to Address 2" + ' ' + "Bill-to Address 3";
                           IF "Salesperson Code" = '' THEN BEGIN
                             SalesPurchPerson.INIT;
                           END ELSE BEGIN
                             SalesPurchPerson.GET("Salesperson Code");
                           END;

                           FormatAddr.SalesInvBillTo(CustAddr,"Sales Invoice Header");
                           Cust.GET("Bill-to Customer No.");

                           IF "Payment Terms Code" = '' THEN
                             PaymentTerms.INIT
                           ELSE
                             PaymentTerms.GET("Payment Terms Code");

                           CALCFIELDS(Amount);
                           CALCFIELDS("Amount Including VAT");

                           CommentText := '';
                           SalesComtLine.RESET;
                           SalesComtLine.SETRANGE("Document Type",SalesComtLine."Document Type"::"Posted Invoice");
                           SalesComtLine.SETRANGE("No.","No.");
                           SalesComtLine.SETFILTER(Comment,'<>%1','');
                           IF SalesComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(CommentText + SalesComtLine.Comment) < 250 THEN
                                 IF CommentText = '' THEN
                                   CommentText := SalesComtLine.Comment
                                 ELSE
                                   CommentText := CommentText + ' ' + SalesComtLine.Comment;
                             UNTIL SalesComtLine.NEXT=0;
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=CopyLoop;
        OnPreDataItem=BEGIN
                        NoOfLoops := ABS(NoOfCopies) + Cust."Invoice Copies" + 1;
                        IF NoOfLoops <= 0 THEN
                          NoOfLoops := 1;
                        CopyText := '';
                        SETRANGE(Number,1,NoOfLoops);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > 1 THEN
                             CopyText := Text003;
                           CurrReport.PAGENO := 1;
                           CntLine := 0;
                         END;

        OnPostDataItem=BEGIN
                         IF NOT CurrReport.PREVIEW THEN
                           SalesInvCountPrinted.RUN("Sales Invoice Header");
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=PageLoop;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19600;
            SectionHeight=8400;
          }
          CONTROLS
          {
            { 1000000019;Shape  ;0    ;4600 ;10400;3600  }
            { 1000000018;Shape  ;10600;4600 ;8700 ;3600  }
            { 1000000016;Shape  ;13600;2600 ;5700 ;1600  }
            { 1000000000;TextBox;1300 ;4700 ;8900 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=["Sales Invoice Header"."Bill-to Customer No." ] }
            { 1000000001;TextBox;15100;3500 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Posting Date" }
            { 1000000002;TextBox;15100;2700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."No." }
            { 1000000003;TextBox;500  ;5300 ;9700 ;2100 ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=BillToName + '\' + BillToAddress }
            { 1000000005;TextBox;15100;4900 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."PO No." }
            { 1000000006;TextBox;15100;7300 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SalesPurchPerson.Name }
            { 1000000009;TextBox;15100;5700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PaymentTerms.Description }
            { 1000000010;TextBox;15100;6500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Due Date" }
            { 1000000013;TextBox;2500 ;7500 ;7700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Bill-to Contact" }
            { 1000000024;TextBox;5200 ;0    ;10000;800  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000026;Label  ;5200 ;900  ;10000;850  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Invoice }
            { 1000000033;Label  ;13800;2700 ;1100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=No. }
            { 1000000034;Label  ;13800;3500 ;1100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Date. }
            { 1000000008;Label  ;12100;7300 ;2800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Salesperson }
            { 1000000011;Label  ;12100;5700 ;2800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Terms }
            { 1000000012;Label  ;12100;6500 ;2800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Due Date }
            { 1000000014;Label  ;12100;4900 ;2800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=PO.No. }
            { 1000000017;Shape  ;13600;3400 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000021;Label  ;100  ;4700 ;1200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Bill To. }
            { 1000000022;Label  ;100  ;7500 ;2200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Contact Name. }
            { 1000000042;Shape  ;15000;5400 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000049;Shape  ;15000;6200 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000051;Shape  ;15000;7000 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000053;Shape  ;15000;7800 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000025;TextBox;0    ;2400 ;12200;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000027;TextBox;0    ;2400 ;12200;550  ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" + CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000028;TextBox;0    ;3400 ;12200;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000029;TextBox;0    ;3900 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000030;TextBox;0    ;2900 ;12200;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CompanyInfo."Company Address (Thai)" }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19600;
            SectionHeight=1015;
          }
          CONTROLS
          {
            { 1000000023;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000031;Shape  ;15   ;985  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000032;Shape  ;0    ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000035;Shape  ;2300 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000036;Shape  ;9000 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000037;Shape  ;12500;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000038;Shape  ;14900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000039;Shape  ;16100;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000040;Shape  ;19230;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000041;Label  ;100  ;100  ;2100 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Code. }
            { 1000000043;Label  ;9100 ;85   ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Quantity }
            { 1000000044;Label  ;14900;100  ;1200 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Discount }
            { 1000000045;Label  ;12600;100  ;2200 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Unit Price. }
            { 1000000046;Label  ;16200;100  ;2900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Amount }
            { 1000000047;Label  ;2400 ;100  ;6500 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Description. }
            { 1000000102;Label  ;11000;85   ;1500 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Unit Of. }
            { 1000000103;Shape  ;10900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000108;Label  ;15000;500  ;1000 ;446  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=% }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19600;
            SectionHeight=3800;
          }
          CONTROLS
          {
            { 1000000100;Shape  ;15   ;100  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000109;Shape  ;19230;100  ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000110;Shape  ;0    ;100  ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000111;Shape  ;15   ;3100 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000112;Label  ;6500 ;200  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=Prepared By. }
            { 1000000113;Label  ;6500 ;1700 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=Verify By. }
            { 1000000114;Label  ;13100;300  ;6000 ;600  ;Visible=No;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=HPB PRESS HOLDING SDN BHD }
            { 1000000115;Label  ;13100;2300 ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Authorised Signature }
            { 1000000116;Label  ;0    ;3200 ;19300;600  ;Visible=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=กรุณาชำระเงินด้วยเช็คขีดคร่อมในนาม "บริษัท เบอร์ด้า (ประเทศไทย) จำกัด" การชำระโดยเช็ค ใบเสร็จจะสมบูรณ์เมื่อเช็คสามารถเรียกเก็บเงินได้ }
            { 1000000117;Shape  ;6400 ;100  ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000118;Shape  ;12900;100  ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000119;Label  ;100  ;200  ;6300 ;600  ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ได้รับสินค้าตามรายการในสภาพดีและถูกต้องแล้ว }
            { 1000000120;Label  ;100  ;1700 ;2100 ;600  ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้รับสินค้า }
            { 1000000121;Label  ;100  ;2300 ;2100 ;600  ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=วันที่รับสินค้า }
            { 1000000122;Shape  ;6400 ;1600 ;6500 ;30   ;ShapeStyle=HorzLine }
            { 1000000079;TextBox;13100;300  ;6000 ;600  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table113;
        DataItemTableView=SORTING(Document No.,Line No.);
        OnPreDataItem=BEGIN
                        VATAmountLine.DELETEALL;
                        MoreLines := FIND('+');
                        WHILE MoreLines AND (Description = '') AND ("No." = '') AND (Quantity = 0) AND (Amount = 0) DO
                          MoreLines := NEXT(-1) <> 0;
                        IF NOT MoreLines THEN
                          CurrReport.BREAK;
                        SETRANGE("Line No.",0,"Line No.");
                        CurrReport.CREATETOTALS("Line Amount",Amount,"Amount Including VAT","Inv. Discount Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF (Type = Type::"G/L Account") THEN
                             "No." := '';

                           VATAmountLine.INIT;
                           VATAmountLine."VAT Identifier" := "VAT Identifier";
                           VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
                           VATAmountLine."Tax Group Code" := "Tax Group Code";
                           VATAmountLine."VAT %" := "VAT %";
                           VATAmountLine."VAT Base" := Amount;
                           VATAmountLine."Amount Including VAT" := "Amount Including VAT";
                           VATAmountLine."Line Amount" := "Line Amount";
                           IF "Allow Invoice Disc." THEN
                             VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
                           VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
                           VATAmountLine.InsertLine;
                           ChkLastPage := TRUE //GKU:#002
                         END;

        DataItemLinkReference=Sales Invoice Header;
        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 57  ;TextBox      ;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000048;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000050;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000052;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000054;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000059;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000061;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000105;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type > 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 64  ;TextBox      ;100  ;0    ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="No." }
            { 66  ;TextBox      ;9100 ;0    ;1700 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 68  ;TextBox      ;12600;0    ;2200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 69  ;TextBox      ;15000;0    ;1000 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Disc. %;
                                                                    THA=% ส่วนลด];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Discount %" }
            { 70  ;TextBox      ;16200;0    ;2900 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Amount;
                                                                    THA=จำนวน];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000062;TextBox;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000063;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000064;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000104;TextBox;11000;0    ;1470 ;600  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit of Measure" }
            { 1000000106;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 1;
                           ChkLastPage := FALSE;//GKU:#002
                         END;

          }
          CONTROLS
          {
            { 1000000095;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000096;Label  ;17385;0    ;1700 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        IF CntLine > 16 THEN
                          SETRANGE(Number,1,16+20-CntLine)
                        ELSE
                          SETRANGE(Number,1,16-CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000071;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000072;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000073;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000076;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000077;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000107;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19600;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000060;Shape  ;0    ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000078;Label  ;17370;0    ;1700 ;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnAfterGetRecord=BEGIN
                           //KKE : #001 +
                           IF "Sales Invoice Line"."Amount Including VAT" <> 0 THEN
                             TextAmount := '(' + Form50BIS.FormatNoThaiText(ABS("Sales Invoice Line"."Amount Including VAT")) + ')'
                           ELSE
                             TextAmount := '';
                           //KKE : #001 -
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19600;
            SectionHeight=2530;
          }
          CONTROLS
          {
            { 1000000015;TextBox;100  ;1000 ;12300;1400 ;Visible=No;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000020;TextBox;16200;1600 ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000004;TextBox;16200;0    ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000007;TextBox;16200;800  ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT" - "Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000055;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000057;Shape  ;19230;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000058;Shape  ;16100;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000070;Shape  ;12500;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000080;Shape  ;0    ;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000081;Shape  ;15   ;2500 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000083;Label  ;12600;0    ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=Total. }
            { 1000000084;Label  ;12600;800  ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=Service Tax. }
            { 1000000085;Label  ;12600;1600 ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=Grand Total. }
            { 1000000099;TextBox;1700 ;100  ;10700;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CommentText }
            { 1000000101;Label  ;100  ;100  ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=Remark: }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5060;
      Height=660;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=[ENU=No. of Copies;
                                                              THA=จำนวนสำเนา];
                                                   SourceExpr=NoOfCopies }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Salesperson;THA=พนักงานขาย';
      Text001@1001 : TextConst 'ENU=Total %1;THA=รวม %1';
      Text002@1002 : TextConst 'ENU=Total %1 Incl. VAT;THA=ยอดรวม %1 ที่รวม VAT';
      Text003@1003 : TextConst 'ENU=COPY;THA=คัดลอก';
      Text004@1004 : TextConst 'ENU=Sales - Invoice %1;THA=การขาย - ใบส่งของ %1';
      Text005@1005 : TextConst 'ENU=Page %1;THA=หน้า %1';
      Text006@1006 : TextConst 'ENU=Total %1 Excl. VAT;THA=รวม %1 โดยไม่รวม VAT';
      GLSetup@1007 : Record 98;
      PaymentTerms@1009 : Record 3;
      SalesPurchPerson@1010 : Record 13;
      CompanyInfo@1011 : Record 79;
      SalesSetup@1048 : Record 311;
      SalesComtLine@1000000010 : Record 44;
      Cust@1012 : Record 18;
      VATAmountLine@1013 : TEMPORARY Record 290;
      Language@1017 : Record 8;
      Form50BIS@1000000003 : Report 50002;
      SalesInvCountPrinted@1018 : Codeunit 315;
      FormatAddr@1019 : Codeunit 365;
      tmpCompanyAddr@1000000007 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000006 : ARRAY [2] OF Text[250];
      CustAddr@1021 : ARRAY [8] OF Text[50];
      CompanyAddr@1023 : ARRAY [8] OF Text[50];
      CopyText@1000000008 : Text[30];
      BillToName@1000000005 : Text[500];
      BillToAddress@1000000001 : Text[500];
      CommentText@1000000009 : Text[250];
      TextAmount@1000000000 : Text[250];
      PurchOrderNo@1000000002 : Code[20];
      MoreLines@1031 : Boolean;
      NoOfCopies@1032 : Integer;
      NoOfLoops@1033 : Integer;
      i@1036 : Integer;
      NextEntryNo@1043 : Integer;
      Continue@1040 : Boolean;
      CntLine@1000000004 : Integer;
      ChkLastPage@1000000011 : Boolean;
      TotalAmt@1000000012 : Decimal;
      TotalVat@1000000013 : Decimal;
      TotalAll@1000000014 : Decimal;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda
      KKE : Kanoknard Ketnut
      GKU : Goragot Kuanmuang

      No.   Date         Sign  Description
      ----------------------------------------
      001   14.06.2007   KKE   'Sales Invoice' Report - Circulation Module.
      002   19.11.2007   GKU   Modify show footer on every page
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50061 Receipt - Subscription
{
  OBJECT-PROPERTIES
  {
    Date=07/13/10;
    Time=11:57:01 PM;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  {
                  IF Payment[1] THEN
                    P[1] := 'P';
                  IF Payment[2] THEN
                    P[2] := 'P';
                  IF Payment[3] THEN
                    P[3] := 'P';
                  IF Payment[4] THEN
                    P[4] := 'P';
                  IF Payment[5] THEN
                    P[5] := 'P';
                  }
                END;

    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table112;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        OnPreDataItem=BEGIN
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                      END;

        OnAfterGetRecord=BEGIN


                           BillToName := "Bill-to Name (Thai)";
                           IF BillToName = '' THEN
                             BillToName := "Bill-to Name" + "Bill-to Name 2";
                           BillToAddress := "Bill-to Address (Thai)";
                           IF BillToAddress = '' THEN
                             BillToAddress := "Bill-to Address" + ' ' + "Bill-to Address 2" + ' ' + "Bill-to Address 3";

                           {---
                           CommentText := '';
                           SalesComtLine.RESET;
                           SalesComtLine.SETRANGE("Document Type",SalesComtLine."Document Type"::"Posted Invoice");
                           SalesComtLine.SETRANGE("No.","No.");
                           SalesComtLine.SETFILTER(Comment,'<>%1','');
                           IF SalesComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(CommentText + SalesComtLine.Comment) < 250 THEN
                                 IF CommentText = '' THEN
                                   CommentText := SalesComtLine.Comment
                                 ELSE
                                   CommentText := CommentText + ' ' + SalesComtLine.Comment;
                             UNTIL SalesComtLine.NEXT=0;
                           ---}
                         END;

        ReqFilterFields=No.,Sell-to Customer No.;
        CalcFields=Amount Including VAT;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        OnAfterGetRecord=BEGIN
                           i := 0;
                           CLEAR(P);
                           CLEAR(Payment);
                           CLEAR(CreditCard);
                           CLEAR(CreditCardNo);
                           CLEAR(SubContNo);
                           CLEAR(PostalOrderNo);
                           CLEAR(Cheque);
                           CLEAR(ChequeNo);

                           CntLine := 0;
                           SalesInvLine.RESET;
                           SalesInvLine.SETRANGE("Document No.","Sales Invoice Header"."No.");
                           SalesInvLine.SETFILTER("Subscriber Contract No.",'<>%1','');
                           IF SalesInvLine.FIND('-') THEN
                             SubContNo := SalesInvLine."Subscriber Contract No.";

                           SalesInvHdr.INIT;
                           SalesInvLine.RESET;
                           SalesInvLine.SETFILTER("Document No.",'<>%1',"Sales Invoice Header"."No.");
                           SalesInvLine.SETRANGE("Subscriber Contract No.",SubContNo);
                           SalesInvLine.SETRANGE("Sell-to Customer No.",SalesInvLine."Sell-to Customer No.");  //KKE : #003
                           IF SalesInvLine.FIND('-') THEN BEGIN
                             SalesInvHdr.GET(SalesInvLine."Document No.");
                             SalesInvHdr.CALCFIELDS("Amount Including VAT");
                           END;
                           TotalAmount := "Sales Invoice Header"."Amount Including VAT" + SalesInvHdr."Amount Including VAT";

                           IF TotalAmount <> 0 THEN
                             TotalAmountText := FORMAT(TotalAmount,0,'<Precision,2:3><Standard Format,0>') + ' (' +
                               Form50BIS.FormatNoThaiText(TotalAmount) + ')'
                           ELSE
                             TotalAmountText := '';

                           IF NOT SubscriberCont.GET(SubContNo) THEN
                             SubscriberCont.INIT;

                           SubscriberNoText := '';
                           IF SubscriberCont."Subscriber No." <> '' THEN
                             SubscriberNoText := STRSUBSTNO(Text001,SubscriberCont."Subscriber No.");

                           CommentText := '';
                           IF Promotion.GET(SubscriberCont."Promotion Code") THEN
                             CommentText := Promotion.Description;
                           CommentText += '   ' + STRSUBSTNO(Text002,
                             SubscriberCont."Contract Quantity",
                             SubscriberCont."Starting Magazine Item No.",
                             SubscriberCont."Ending Magazine Item No.");

                           CASE SubscriberCont."Payment Option" OF
                             SubscriberCont."Payment Option"::Cash:
                               Payment[1] := TRUE;
                             SubscriberCont."Payment Option"::Transfer:
                               Payment[2] := TRUE;
                             SubscriberCont."Payment Option"::"Postal Order":
                               BEGIN
                                 Payment[5] := TRUE;
                                 PostalOrderNo := SubscriberCont."Receipt No.";
                               END;
                           END;

                           IF SubscriberCont."Credit Card Amount" <> 0 THEN BEGIN
                             Payment[3] := TRUE;
                             IF GenMasterSetup.GET(GenMasterSetup.Type::"Credit Card Bank",SubscriberCont."Credit Card Bank") THEN
                               CreditCard := GenMasterSetup.Description;
                             IF CreditCard = '' THEN
                               CreditCard := SubscriberCont."Credit Card Bank";
                             CreditCardNo := SubscriberCont."Credit Card No.";
                           END;

                           IF SubscriberCont."Check Amount" <> 0 THEN BEGIN
                             Payment[4] := TRUE;
                             Cheque := SubscriberCont."Bank Code";
                             ChequeNo := SubscriberCont."Check No.";
                           END;

                           IF Payment[1] THEN
                             P[1] := 'P';
                           IF Payment[2] THEN
                             P[2] := 'P';
                           IF Payment[3] THEN
                             P[3] := 'P';
                           IF Payment[4] THEN
                             P[4] := 'P';
                           IF Payment[5] THEN
                             P[5] := 'P';
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=12500;
          }
          CONTROLS
          {
            { 1000000006;TextBox;1600 ;6800 ;17600;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=TotalAmountText }
            { 1000000021;TextBox;2900 ;4700 ;10700;630  ;Visible=Yes;
                                                         Enabled=Yes;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=BillToName }
            { 1000000002;Label  ;0    ;4700 ;2900 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=บริษัทฯ ได้รับเงินจาก }
            { 1000000065;Label  ;5000 ;900  ;10000;850  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบเสร็จรับเงิน / Receipt }
            { 1000000068;Shape  ;13600;2600 ;5700 ;1600  }
            { 1000000069;TextBox;15100;2700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."No." }
            { 1000000070;Label  ;13800;2700 ;1100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000073;Shape  ;13600;3400 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000074;TextBox;15100;3500 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Posting Date" }
            { 1000000075;Label  ;13800;3500 ;1100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000077;TextBox;800  ;5400 ;18400;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=BillToAddress }
            { 1000000078;Label  ;0    ;5400 ;800  ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000079;Label  ;0    ;6100 ;2800 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=เพื่อเป็นการชำระค่า }
            { 1000000000;Shape  ;2700 ;5100 ;16500;200  ;ShapeStyle=HorzLine }
            { 1000000001;Shape  ;700  ;5800 ;18500;200  ;ShapeStyle=HorzLine }
            { 1000000003;Shape  ;2700 ;6500 ;16500;200  ;ShapeStyle=HorzLine }
            { 1000000004;Label  ;0    ;6800 ;1600 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 1000000005;Shape  ;1500 ;7200 ;17700;200  ;ShapeStyle=HorzLine }
            { 1000000039;Label  ;0    ;11700;9600 ;630  ;FontName=CordiaUPC;
                                                         FontSize=12;
                                                         CaptionML=ENU=การชำระเงินโดยเช็ค ใบเสร็จจะสมบูรณ์เมื่อเช็คสามารถเรียกเก็บเงินได้ }
            { 1000000045;Label  ;11600;10900;1900 ;630  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=ลงชื่อผู้รับเงิน }
            { 1000000052;Label  ;12700;11600;800  ;630  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=วันที่ }
            { 1000000007;Shape  ;13500;11400;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000008;Shape  ;13500;12100;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000009;Label  ;1200 ;8200 ;900  ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=โดย }
            { 1000000010;TextBox;2000 ;10600;9200 ;630  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=BillToName }
            { 1000000011;Shape  ;2300 ;8200 ;500  ;500   }
            { 1000000012;Shape  ;2300 ;8800 ;500  ;500   }
            { 1000000013;Shape  ;2300 ;9400 ;500  ;500   }
            { 1000000014;Label  ;2900 ;8200 ;1000 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=เงินสด }
            { 1000000015;Label  ;2900 ;8800 ;1300 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=เงินโอน }
            { 1000000016;Label  ;2900 ;9400 ;1600 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=บัตรเครดิต }
            { 1000000017;Label  ;6300 ;8200 ;1900 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=เช็คธนาคาร }
            { 1000000018;Shape  ;5700 ;8200 ;500  ;500   }
            { 1000000019;Shape  ;5700 ;8800 ;500  ;500   }
            { 1000000020;Label  ;6300 ;8800 ;1400 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=ธนาณัติ }
            { 1000000022;Label  ;13600;8200 ;1000 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000026;Label  ;13600;8800 ;1000 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000027;Label  ;13600;9400 ;1000 ;630  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000028;Shape  ;14400;8700 ;4800 ;30   ;ShapeStyle=HorzLine }
            { 1000000029;Shape  ;14400;9300 ;4800 ;30   ;ShapeStyle=HorzLine }
            { 1000000030;Shape  ;14400;9900 ;4800 ;30   ;ShapeStyle=HorzLine }
            { 1000000031;Shape  ;7800 ;8700 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000032;Shape  ;7800 ;9300 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000033;Shape  ;4500 ;9900 ;9000 ;30   ;ShapeStyle=HorzLine }
            { 1000000023;TextBox;2400 ;8200 ;500  ;600  ;HorzAlign=Left;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         SourceExpr=P[1] }
            { 1000000024;TextBox;2400 ;8800 ;500  ;600  ;HorzAlign=Left;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         SourceExpr=P[2] }
            { 1000000025;TextBox;14700;8200 ;4300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=ChequeNo }
            { 1000000035;TextBox;8300 ;8200 ;5000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Cheque }
            { 1000000036;TextBox;14700;8800 ;4300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PostalOrderNo }
            { 1000000037;TextBox;8000 ;8800 ;5300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PostalOrder }
            { 1000000041;TextBox;14700;9400 ;4300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CreditCardNo }
            { 1000000042;TextBox;4700 ;9400 ;8600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CreditCard }
            { 1000000046;TextBox;2400 ;9400 ;500  ;600  ;HorzAlign=Left;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         SourceExpr=P[3] }
            { 1000000047;TextBox;5800 ;8200 ;500  ;600  ;HorzAlign=Left;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         SourceExpr=P[4] }
            { 1000000048;TextBox;5800 ;8800 ;500  ;600  ;HorzAlign=Left;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         SourceExpr=P[5] }
            { 1000000034;TextBox;2800 ;6100 ;16400;600  ;Visible=Yes;
                                                         Enabled=Yes;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CommentText }
            { 1000000038;TextBox;0    ;1800 ;12200;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000040;TextBox;0    ;2400 ;12200;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" + CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000043;TextBox;0    ;2900 ;12200;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CompanyInfo."Company Address (Thai)" }
            { 1000000044;TextBox;0    ;3400 ;12200;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000049;TextBox;0    ;3900 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000050;TextBox;5000 ;0    ;10000;800  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000051;TextBox;13600;4700 ;5600 ;630  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SubscriberNoText }
            { 1000000053;Label  ;1800 ;7500 ;14100;700  ;Visible=No;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=HELLO! 1 ปี 2600 บ. + Bobbi Brown Eyes จำนวน 27 ฉบับ เริ่มตั้งแต่ฉบับที่ HL0512 ถึงฉบับที่ HL0612 }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=14190;
      Height=2420;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000000 : Record 79;
      SalesComtLine@1000000021 : Record 44;
      Form50BIS@1000000007 : Report 50002;
      FormatAddr@1000000003 : Codeunit 365;
      CompanyAddr@1000000005 : ARRAY [8] OF Text[50];
      tmpCompanyAddr@1000000002 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000001 : ARRAY [2] OF Text[250];
      BillToName@1000000011 : Text[500];
      BillToAddress@1000000010 : Text[500];
      CommentText@1000000020 : Text[250];
      i@1000000009 : Integer;
      CntLine@1000000004 : Integer;
      TotalAmountText@1000000008 : Text[250];
      Payment@1000000013 : ARRAY [5] OF Boolean;
      P@1000000012 : ARRAY [5] OF Text[1];
      Cheque@1000000014 : Text[30];
      ChequeNo@1000000015 : Text[30];
      PostalOrder@1000000016 : Text[30];
      PostalOrderNo@1000000017 : Text[30];
      CreditCard@1000000018 : Text[30];
      CreditCardNo@1000000019 : Text[30];
      SalesInvHdr@1000000024 : Record 112;
      SalesInvLine@1000000022 : Record 113;
      SubContNo@1000000023 : Code[20];
      TotalAmount@1000000006 : Decimal;
      SubscriberCont@1000000025 : Record 50005;
      GenMasterSetup@1000000026 : Record 50002;
      Text001@1000000027 : TextConst 'ENU=สมาชิกเลขที่ %1';
      Promotion@1000000029 : Record 50004;
      SubscriberNoText@1000000028 : Text[50];
      Text002@1000000030 : TextConst 'ENU=จำนวน %1 เล่ม เริ่มตั้งแต่ฉบับที่ %2 ถึงฉบับที่ %3';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.05.2007   KKE   New report for "Receipt - Subscription" - Ads. Sales Module
      002   05.10.2007   KKE   Total 2 Invoice incase split sales invoice from credit charge fee.
      003   07.01.2008   KKE   Incase 2 invoice is not the same customer.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50062 Receipt - Other Sales
{
  OBJECT-PROPERTIES
  {
    Date=02/07/12;
    Time=11:36:05 AM;
    Modified=Yes;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    Permissions=TableData 7190=rimd;
    CaptionML=ENU=Receipt - Other Sales;
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   CompanyInfo.GET;
                   SalesSetup.GET;
                 END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table112;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Posted Sales Invoice;
                            THA=ใบส่งของสินค้าขายที่ลงรายการบัญชี];
        OnPreDataItem=BEGIN
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                      END;

        OnAfterGetRecord=BEGIN
                           FormatAddr.Company(CompanyAddr,CompanyInfo);

                           BillToName := "Bill-to Name (Thai)";
                           IF BillToName = '' THEN
                             BillToName := "Bill-to Name" + "Bill-to Name 2";

                           BillToAddress := "Bill-to Address (Thai)";
                           IF BillToAddress = '' THEN
                             BillToAddress := "Bill-to Address" + ' ' + "Bill-to Address 2" + ' ' + "Bill-to Address 3";
                           IF "Salesperson Code" = '' THEN BEGIN
                             SalesPurchPerson.INIT;
                           END ELSE BEGIN
                             SalesPurchPerson.GET("Salesperson Code");
                           END;

                           FormatAddr.SalesInvBillTo(CustAddr,"Sales Invoice Header");
                           Cust.GET("Bill-to Customer No.");

                           IF "Payment Terms Code" = '' THEN
                             PaymentTerms.INIT
                           ELSE
                             PaymentTerms.GET("Payment Terms Code");

                           CALCFIELDS(Amount);
                           CALCFIELDS("Amount Including VAT");

                           CommentText := '';
                           SalesComtLine.RESET;
                           SalesComtLine.SETRANGE("Document Type",SalesComtLine."Document Type"::"Posted Invoice");
                           SalesComtLine.SETRANGE("No.","No.");
                           SalesComtLine.SETFILTER(Comment,'<>%1','');
                           IF SalesComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(CommentText + SalesComtLine.Comment) < 250 THEN
                                 IF CommentText = '' THEN
                                   CommentText := SalesComtLine.Comment
                                 ELSE
                                   CommentText := CommentText + ' ' + SalesComtLine.Comment;
                             UNTIL SalesComtLine.NEXT=0;
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=CopyLoop;
        OnPreDataItem=BEGIN
                        NoOfLoops := ABS(NoOfCopies) + Cust."Invoice Copies" + 1;
                        IF NoOfLoops <= 0 THEN
                          NoOfLoops := 1;
                        CopyText := '';
                        SETRANGE(Number,1,NoOfLoops);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > 1 THEN
                             CopyText := Text003;
                           CurrReport.PAGENO := 1;
                           CntLine := 0;
                         END;

        OnPostDataItem=BEGIN
                         IF NOT CurrReport.PREVIEW THEN
                           SalesInvCountPrinted.RUN("Sales Invoice Header");
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=PageLoop;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=8400;
          }
          CONTROLS
          {
            { 1000000019;Shape  ;0    ;4600 ;10400;3600  }
            { 1000000018;Shape  ;10600;4600 ;8700 ;3600  }
            { 1000000016;Shape  ;13600;2600 ;5700 ;1600  }
            { 1000000000;TextBox;2700 ;4700 ;7500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=["Sales Invoice Header"."Bill-to Customer No." ] }
            { 1000000001;TextBox;15100;3500 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=ReceiptDate }
            { 1000000002;TextBox;15100;2700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=ReceiptNo }
            { 1000000003;TextBox;500  ;5300 ;9700 ;2100 ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=BillToName + '\' + BillToAddress }
            { 1000000005;TextBox;15100;4900 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PurchOrderNo }
            { 1000000006;TextBox;15100;7300 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SalesPurchPerson.Name }
            { 1000000009;TextBox;15100;5700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PaymentTerms.Description }
            { 1000000010;TextBox;15100;6500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Due Date" }
            { 1000000013;TextBox;2100 ;7500 ;8100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Bill-to Contact" }
            { 1000000026;Label  ;5300 ;900  ;10000;850  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบเสร็จรับเงิน }
            { 1000000033;Label  ;13800;2700 ;1100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000034;Label  ;13800;3500 ;1100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000008;Label  ;10800;7300 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=พนักงานขาย/Salesperson }
            { 1000000011;Label  ;10800;5700 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เงื่อนไขการชำระเงิน/Terms }
            { 1000000012;Label  ;10800;6500 ;4300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ครบกำหนดชำระเงิน/Due Date }
            { 1000000014;Label  ;10800;4900 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ใบสั่งซื้อ PO.No. }
            { 1000000017;Shape  ;13600;3400 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000021;Label  ;100  ;4700 ;2600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อและที่อยู่ลูกค้า }
            { 1000000022;Label  ;100  ;7500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อผู้ที่ติดต่อ }
            { 1000000042;Shape  ;15000;5400 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000049;Shape  ;15000;6200 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000051;Shape  ;15000;7000 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000053;Shape  ;15000;7800 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000025;TextBox;0    ;1800 ;12200;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000027;TextBox;0    ;2400 ;12200;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" + CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000028;TextBox;0    ;2900 ;12200;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CompanyInfo."Company Address (Thai)" }
            { 1000000029;TextBox;0    ;3400 ;12200;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000030;TextBox;0    ;3900 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000100;TextBox;5300 ;0    ;10000;800  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000111;Label  ;16200;900  ;1000 ;600  ;Visible=No;
                                                         HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=30 }
            { 1000000112;Label  ;17600;1200 ;1100 ;600  ;Visible=No;
                                                         HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=30 }
            { 1000000110;Label  ;17200;400  ;1500 ;600  ;Visible=No;
                                                         HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=2400 }
            { 1000000113;Label  ;16100;1600 ;1500 ;700  ;Visible=No;
                                                         HorzAlign=Right;
                                                         FontName=<Helvetica>;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=2400 }
            { 1000000114;Label  ;15600;100  ;1500 ;700  ;Visible=No;
                                                         HorzAlign=Right;
                                                         FontName=<Helvetica>;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=2400 }
            { 1000000115;Label  ;13500;1200 ;4500 ;600  ;Visible=No;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=(สองพันสี่ร้อยบาทถ้วน) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=1015;
          }
          CONTROLS
          {
            { 1000000023;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000031;Shape  ;15   ;985  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000032;Shape  ;0    ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000035;Shape  ;2300 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000036;Shape  ;9000 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000037;Shape  ;12500;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000038;Shape  ;14900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000039;Shape  ;16100;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000040;Shape  ;19230;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000041;Label  ;100  ;100  ;2100 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รหัสสินค้า }
            { 1000000043;Label  ;9100 ;85   ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวน }
            { 1000000044;Label  ;14900;100  ;1200 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ส่วนลด }
            { 1000000045;Label  ;12600;100  ;2200 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ราคาหน่วยละ }
            { 1000000046;Label  ;16200;100  ;2900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 1000000047;Label  ;2400 ;100  ;6500 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000102;Label  ;11000;85   ;1500 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หน่วย }
            { 1000000103;Shape  ;10900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000108;Label  ;15000;500  ;1000 ;446  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=% }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19500;
            SectionHeight=3700;
          }
          CONTROLS
          {
            { 1000000060;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000078;Shape  ;19230;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000079;Shape  ;0    ;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000086;Shape  ;15   ;3000 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000087;Label  ;6500 ;100  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้จัดเตรียม }
            { 1000000092;Label  ;6500 ;1600 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้ตรวจสอบ }
            { 1000000088;Label  ;13100;200  ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ในนาม บริษัทเบอร์ด้า (ประเทศไทย) จำกัด }
            { 1000000089;Label  ;13100;2200 ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลายเซ็นผู้มีอำนาจลงนาม }
            { 1000000093;Label  ;0    ;3100 ;19300;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=กรุณาชำระเงินด้วยเช็คขีดคร่อมในนาม "บริษัท เบอร์ด้า (ประเทศไทย) จำกัด" การชำระโดยเช็ค ใบเสร็จจะสมบูรณ์เมื่อเช็คสามารถเรียกเก็บเงินได้ }
            { 1000000097;Shape  ;6400 ;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000098;Shape  ;12900;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000082;Label  ;100  ;100  ;6300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ได้รับสินค้าตามรายการในสภาพดีและถูกต้องแล้ว }
            { 1000000090;Label  ;100  ;1600 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้รับสินค้า }
            { 1000000091;Label  ;100  ;2200 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=วันที่รับสินค้า }
            { 1000000094;Shape  ;6400 ;1500 ;6500 ;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table113;
        DataItemTableView=SORTING(Document No.,Line No.);
        OnPreDataItem=BEGIN
                        VATAmountLine.DELETEALL;
                        MoreLines := FIND('+');
                        WHILE MoreLines AND (Description = '') AND ("No." = '') AND (Quantity = 0) AND (Amount = 0) DO
                          MoreLines := NEXT(-1) <> 0;
                        IF NOT MoreLines THEN
                          CurrReport.BREAK;
                        SETRANGE("Line No.",0,"Line No.");
                        CurrReport.CREATETOTALS("Line Amount",Amount,"Amount Including VAT","Inv. Discount Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF (Type = Type::"G/L Account") THEN
                             "No." := '';

                           VATAmountLine.INIT;
                           VATAmountLine."VAT Identifier" := "VAT Identifier";
                           VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
                           VATAmountLine."Tax Group Code" := "Tax Group Code";
                           VATAmountLine."VAT %" := "VAT %";
                           VATAmountLine."VAT Base" := Amount;
                           VATAmountLine."Amount Including VAT" := "Amount Including VAT";
                           VATAmountLine."Line Amount" := "Line Amount";
                           IF "Allow Invoice Disc." THEN
                             VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
                           VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
                           VATAmountLine.InsertLine;
                         END;

        DataItemLinkReference=Sales Invoice Header;
        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 57  ;TextBox      ;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000048;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000050;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000052;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000054;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000059;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000061;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000105;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type > 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 64  ;TextBox      ;100  ;0    ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="No." }
            { 66  ;TextBox      ;9100 ;0    ;1700 ;600  ;Visible=Yes;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 68  ;TextBox      ;12600;0    ;2200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 69  ;TextBox      ;15000;0    ;1000 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Disc. %;
                                                                    THA=% ส่วนลด];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Discount %" }
            { 1000000062;TextBox;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000063;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000064;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000104;TextBox;11000;0    ;1470 ;600  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit of Measure" }
            { 1000000106;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 70  ;TextBox      ;16200;0    ;2900 ;600  ;Visible=Yes;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Amount;
                                                                    THA=จำนวน];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19500;
            SectionHeight=500;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000095;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000096;Label  ;17385;0    ;1700 ;500  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        IF CntLine > 16 THEN
                          SETRANGE(Number,1,16+20-CntLine)
                        ELSE
                          SETRANGE(Number,1,16-CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000071;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000072;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000073;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000076;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000077;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000107;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19500;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000024;Shape  ;0    ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000109;Label  ;17370;0    ;1700 ;500  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnAfterGetRecord=BEGIN
                           //KKE : #001 +
                           IF "Sales Invoice Line"."Amount Including VAT" <> 0 THEN
                             TextAmount := '(' + Form50BIS.FormatNoThaiText(ABS("Sales Invoice Line"."Amount Including VAT")) + ')'
                           ELSE
                             TextAmount := '';
                           //KKE : #001 -
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19500;
            SectionHeight=2530;
          }
          CONTROLS
          {
            { 1000000015;TextBox;100  ;1000 ;12300;1427 ;Visible=Yes;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000020;TextBox;16200;1600 ;2900 ;800  ;Visible=Yes;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000004;TextBox;16200;0    ;2900 ;800  ;Visible=Yes;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000007;TextBox;16200;800  ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT" - "Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000055;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000057;Shape  ;19230;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000058;Shape  ;16100;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000070;Shape  ;12500;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000080;Shape  ;0    ;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000081;Shape  ;15   ;2500 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000083;Label  ;12600;0    ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=รวมเงิน }
            { 1000000084;Label  ;12600;800  ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ภาษีมูลค่าเพิ่ม }
            { 1000000085;Label  ;12600;1600 ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=จำนวนเงินรวมทั้งสิ้น }
            { 1000000099;TextBox;1700 ;100  ;10700;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CommentText }
            { 1000000101;Label  ;100  ;100  ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=หมายเหตุ: }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=6820;
      Height=1760;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;InPage=-1;
                                                   CaptionML=[ENU=No. of Copies;
                                                              THA=จำนวนสำเนา];
                                                   SourceExpr=NoOfCopies }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
      { 1000000000;TextBox;3410 ;660  ;3410 ;440  ;InPage=-1;
                                                   CaptionML=ENU=Receipt No.;
                                                   SourceExpr=ReceiptNo }
      { 1000000001;Label  ;0    ;660  ;3300 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;3410 ;1320 ;2200 ;440  ;InPage=-1;
                                                   CaptionML=ENU=Receipt Date;
                                                   SourceExpr=ReceiptDate }
      { 1000000003;Label  ;0    ;1320 ;3300 ;440  ;ParentControl=1000000002 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Salesperson;THA=พนักงานขาย';
      Text001@1001 : TextConst 'ENU=Total %1;THA=รวม %1';
      Text002@1002 : TextConst 'ENU=Total %1 Incl. VAT;THA=ยอดรวม %1 ที่รวม VAT';
      Text003@1003 : TextConst 'ENU=COPY;THA=คัดลอก';
      Text004@1004 : TextConst 'ENU=Sales - Invoice %1;THA=การขาย - ใบส่งของ %1';
      Text005@1005 : TextConst 'ENU=Page %1;THA=หน้า %1';
      Text006@1006 : TextConst 'ENU=Total %1 Excl. VAT;THA=รวม %1 โดยไม่รวม VAT';
      GLSetup@1007 : Record 98;
      PaymentTerms@1009 : Record 3;
      SalesPurchPerson@1010 : Record 13;
      CompanyInfo@1011 : Record 79;
      SalesSetup@1048 : Record 311;
      SalesComtLine@1000000010 : Record 44;
      Cust@1012 : Record 18;
      VATAmountLine@1013 : TEMPORARY Record 290;
      Language@1017 : Record 8;
      Form50BIS@1000000003 : Report 50002;
      SalesInvCountPrinted@1018 : Codeunit 315;
      FormatAddr@1019 : Codeunit 365;
      tmpCompanyAddr@1000000007 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000006 : ARRAY [2] OF Text[250];
      CustAddr@1021 : ARRAY [8] OF Text[50];
      CompanyAddr@1023 : ARRAY [8] OF Text[50];
      CopyText@1000000008 : Text[30];
      BillToName@1000000005 : Text[500];
      BillToAddress@1000000001 : Text[500];
      CommentText@1000000009 : Text[250];
      TextAmount@1000000000 : Text[250];
      PurchOrderNo@1000000002 : Code[20];
      MoreLines@1031 : Boolean;
      NoOfCopies@1032 : Integer;
      NoOfLoops@1033 : Integer;
      i@1036 : Integer;
      NextEntryNo@1043 : Integer;
      Continue@1040 : Boolean;
      CntLine@1000000004 : Integer;
      ReceiptNo@1000000011 : Code[20];
      ReceiptDate@1000000012 : Date;

    PROCEDURE InitRequest@1000000000(SIH@1000000000 : Record 112);
    BEGIN
      ReceiptNo := SIH."No.";
      ReceiptDate := SIH."Posting Date";
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   14.06.2007   KKE   'Sales Invoice' Report - Circulation Module.
      002   07.02.2012   KKE   Allow to specify Receipt Date, Receipt No.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50063 Receipt/Tax Inv. - Other Sales
{
  OBJECT-PROPERTIES
  {
    Date=06/12/19;
    Time=[ 5:29:24 PM];
    Modified=Yes;
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    Permissions=TableData 7190=rimd;
    CaptionML=[ENU=Sales - Invoice;
               THA=การขาย - ใบส่งของ];
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   CompanyInfo.GET;
                   SalesSetup.GET;
                 END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table112;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Posted Sales Invoice;
                            THA=ใบส่งของสินค้าขายที่ลงรายการบัญชี];
        OnPreDataItem=BEGIN
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                      END;

        OnAfterGetRecord=BEGIN
                           FormatAddr.Company(CompanyAddr,CompanyInfo);

                           BillToName := "Bill-to Name (Thai)";
                           IF BillToName = '' THEN
                             BillToName := "Bill-to Name" + "Bill-to Name 2";

                           BillToAddress := "Bill-to Address (Thai)";
                           IF BillToAddress = '' THEN
                             BillToAddress := "Bill-to Address" + ' ' + "Bill-to Address 2" + ' ' + "Bill-to Address 3";
                           IF "Salesperson Code" = '' THEN BEGIN
                             SalesPurchPerson.INIT;
                           END ELSE BEGIN
                             SalesPurchPerson.GET("Salesperson Code");
                           END;

                           FormatAddr.SalesInvBillTo(CustAddr,"Sales Invoice Header");
                           Cust.GET("Bill-to Customer No.");

                           IF "Payment Terms Code" = '' THEN
                             PaymentTerms.INIT
                           ELSE
                             PaymentTerms.GET("Payment Terms Code");

                           CALCFIELDS(Amount);
                           CALCFIELDS("Amount Including VAT");

                           CommentText := '';
                           SalesComtLine.RESET;
                           SalesComtLine.SETRANGE("Document Type",SalesComtLine."Document Type"::"Posted Invoice");
                           SalesComtLine.SETRANGE("No.","No.");
                           SalesComtLine.SETFILTER(Comment,'<>%1','');
                           IF SalesComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(CommentText + SalesComtLine.Comment) < 250 THEN
                                 IF CommentText = '' THEN
                                   CommentText := SalesComtLine.Comment
                                 ELSE
                                   CommentText := CommentText + ' ' + SalesComtLine.Comment;
                             UNTIL SalesComtLine.NEXT=0;
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=CopyLoop;
        OnPreDataItem=BEGIN
                        NoOfLoops := ABS(NoOfCopies) + Cust."Invoice Copies" + 1;
                        IF NoOfLoops <= 0 THEN
                          NoOfLoops := 1;
                        CopyText := '';
                        SETRANGE(Number,1,NoOfLoops);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > 1 THEN
                             CopyText := Text003;
                           CurrReport.PAGENO := 1;
                           CntLine := 0;
                         END;

        OnPostDataItem=BEGIN
                         IF NOT CurrReport.PREVIEW THEN
                           SalesInvCountPrinted.RUN("Sales Invoice Header");
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=PageLoop;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=8400;
          }
          CONTROLS
          {
            { 1000000019;Shape  ;0    ;4600 ;10400;3600  }
            { 1000000018;Shape  ;10600;4600 ;8700 ;3600  }
            { 1000000016;Shape  ;13600;2600 ;5700 ;1600  }
            { 1000000000;TextBox;2700 ;4700 ;7500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=["Sales Invoice Header"."Bill-to Customer No." ] }
            { 1000000001;TextBox;15100;3500 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Posting Date" }
            { 1000000002;TextBox;15100;2700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."No." }
            { 1000000003;TextBox;500  ;5300 ;9700 ;2100 ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=BillToName + '\' + BillToAddress }
            { 1000000005;TextBox;15100;4900 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PurchOrderNo }
            { 1000000006;TextBox;15100;7300 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SalesPurchPerson.Name }
            { 1000000009;TextBox;15100;5700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PaymentTerms.Description }
            { 1000000010;TextBox;15100;6500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Due Date" }
            { 1000000013;TextBox;2100 ;7500 ;8100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Bill-to Contact" }
            { 1000000026;Label  ;5600 ;900  ;8900 ;850  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบเสร็จรับเงิน }
            { 1000000033;Label  ;13800;2700 ;1100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000034;Label  ;13800;3500 ;1100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000008;Label  ;10800;7300 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=พนักงานขาย/Salesperson }
            { 1000000011;Label  ;10800;5700 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เงื่อนไขการชำระเงิน/Terms }
            { 1000000012;Label  ;10800;6500 ;4300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ครบกำหนดชำระเงิน/Due Date }
            { 1000000014;Label  ;10800;4900 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ใบสั่งซื้อ PO.No. }
            { 1000000017;Shape  ;13600;3400 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000021;Label  ;100  ;4700 ;2600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อและที่อยู่ลูกค้า }
            { 1000000022;Label  ;100  ;7500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อผู้ที่ติดต่อ }
            { 1000000042;Shape  ;15000;5400 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000049;Shape  ;15000;6200 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000051;Shape  ;15000;7000 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000053;Shape  ;15000;7800 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000024;TextBox;5300 ;0    ;10000;800  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000025;TextBox;0    ;1800 ;12200;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000027;TextBox;0    ;2400 ;12200;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" + CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000028;TextBox;0    ;2900 ;12200;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CompanyInfo."Company Address (Thai)" }
            { 1000000029;TextBox;0    ;3400 ;12200;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000030;TextBox;0    ;3900 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=1015;
          }
          CONTROLS
          {
            { 1000000023;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000031;Shape  ;15   ;985  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000032;Shape  ;0    ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000035;Shape  ;2300 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000036;Shape  ;9000 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000037;Shape  ;12500;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000038;Shape  ;14900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000039;Shape  ;16100;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000040;Shape  ;19230;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000041;Label  ;100  ;100  ;2100 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รหัสสินค้า }
            { 1000000043;Label  ;9100 ;85   ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวน }
            { 1000000044;Label  ;14900;100  ;1200 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ส่วนลด }
            { 1000000045;Label  ;12600;100  ;2200 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ราคาหน่วยละ }
            { 1000000046;Label  ;16200;100  ;2900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 1000000047;Label  ;2400 ;100  ;6500 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000102;Label  ;11000;85   ;1500 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หน่วย }
            { 1000000103;Shape  ;10900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000108;Label  ;15000;500  ;1000 ;446  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=% }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19500;
            SectionHeight=3700;
          }
          CONTROLS
          {
            { 1000000060;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000078;Shape  ;19230;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000079;Shape  ;0    ;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000086;Shape  ;15   ;3000 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000087;Label  ;6500 ;100  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้จัดเตรียม }
            { 1000000092;Label  ;6500 ;1600 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้ตรวจสอบ }
            { 1000000088;Label  ;13100;200  ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ในนาม บริษัทเบอร์ด้า (ประเทศไทย) จำกัด }
            { 1000000089;Label  ;13100;2200 ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลายเซ็นผู้มีอำนาจลงนาม }
            { 1000000093;Label  ;0    ;3100 ;19300;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=กรุณาชำระเงินด้วยเช็คขีดคร่อมในนาม "บริษัท เบอร์ด้า (ประเทศไทย) จำกัด" การชำระโดยเช็ค ใบเสร็จจะสมบูรณ์เมื่อเช็คสามารถเรียกเก็บเงินได้ }
            { 1000000097;Shape  ;6400 ;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000098;Shape  ;12900;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000082;Label  ;100  ;100  ;6300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ได้รับสินค้าตามรายการในสภาพดีและถูกต้องแล้ว }
            { 1000000090;Label  ;100  ;1600 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้รับสินค้า }
            { 1000000091;Label  ;100  ;2200 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=วันที่รับสินค้า }
            { 1000000094;Shape  ;6400 ;1500 ;6500 ;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table113;
        DataItemTableView=SORTING(Document No.,Line No.);
        OnPreDataItem=BEGIN
                        VATAmountLine.DELETEALL;
                        MoreLines := FIND('+');
                        WHILE MoreLines AND (Description = '') AND ("No." = '') AND (Quantity = 0) AND (Amount = 0) DO
                          MoreLines := NEXT(-1) <> 0;
                        IF NOT MoreLines THEN
                          CurrReport.BREAK;
                        SETRANGE("Line No.",0,"Line No.");
                        CurrReport.CREATETOTALS("Line Amount",Amount,"Amount Including VAT","Inv. Discount Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF (Type = Type::"G/L Account") THEN
                             "No." := '';

                           VATAmountLine.INIT;
                           VATAmountLine."VAT Identifier" := "VAT Identifier";
                           VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
                           VATAmountLine."Tax Group Code" := "Tax Group Code";
                           VATAmountLine."VAT %" := "VAT %";
                           VATAmountLine."VAT Base" := Amount;
                           VATAmountLine."Amount Including VAT" := "Amount Including VAT";
                           VATAmountLine."Line Amount" := "Line Amount";
                           IF "Allow Invoice Disc." THEN
                             VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
                           VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
                           VATAmountLine.InsertLine;
                         END;

        DataItemLinkReference=Sales Invoice Header;
        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 57  ;TextBox      ;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000048;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000050;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000052;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000054;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000059;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000061;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000105;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type > 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 64  ;TextBox      ;100  ;0    ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="No." }
            { 66  ;TextBox      ;9100 ;0    ;1700 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 68  ;TextBox      ;12600;0    ;2200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 69  ;TextBox      ;15000;0    ;1000 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Disc. %;
                                                                    THA=% ส่วนลด];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Discount %" }
            { 70  ;TextBox      ;16200;0    ;2900 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Amount;
                                                                    THA=จำนวน];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000062;TextBox;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000063;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000064;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000104;TextBox;11000;0    ;1470 ;600  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit of Measure" }
            { 1000000106;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19500;
            SectionHeight=500;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000095;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000096;Label  ;17385;0    ;1700 ;500  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        IF CntLine > 16 THEN
                          SETRANGE(Number,1,16+20-CntLine)
                        ELSE
                          SETRANGE(Number,1,16-CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000071;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000072;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000073;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000076;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000077;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000107;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19500;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000126;Shape  ;0    ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000127;Label  ;17370;0    ;1700 ;500  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnAfterGetRecord=BEGIN
                           //KKE : #001 +
                           IF "Sales Invoice Line"."Amount Including VAT" <> 0 THEN
                             TextAmount := '(' + Form50BIS.FormatNoThaiText(ABS("Sales Invoice Line"."Amount Including VAT")) + ')'
                           ELSE
                             TextAmount := '';
                           //KKE : #001 -
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19500;
            SectionHeight=2530;
          }
          CONTROLS
          {
            { 1000000015;TextBox;100  ;1000 ;12300;1427 ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000020;TextBox;16200;1600 ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000004;TextBox;16200;0    ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000007;TextBox;16200;800  ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT" - "Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000055;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000057;Shape  ;19230;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000058;Shape  ;16100;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000070;Shape  ;12500;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000080;Shape  ;0    ;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000081;Shape  ;15   ;2500 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000083;Label  ;12600;0    ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=รวมเงิน }
            { 1000000084;Label  ;12600;800  ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ภาษีมูลค่าเพิ่ม }
            { 1000000085;Label  ;12600;1600 ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=จำนวนเงินรวมทั้งสิ้น }
            { 1000000099;TextBox;1700 ;100  ;10700;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CommentText }
            { 1000000101;Label  ;100  ;100  ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=หมายเหตุ: }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5060;
      Height=660;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=[ENU=No. of Copies;
                                                              THA=จำนวนสำเนา];
                                                   SourceExpr=NoOfCopies }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Salesperson;THA=พนักงานขาย';
      Text001@1001 : TextConst 'ENU=Total %1;THA=รวม %1';
      Text002@1002 : TextConst 'ENU=Total %1 Incl. VAT;THA=ยอดรวม %1 ที่รวม VAT';
      Text003@1003 : TextConst 'ENU=COPY;THA=คัดลอก';
      Text004@1004 : TextConst 'ENU=Sales - Invoice %1;THA=การขาย - ใบส่งของ %1';
      Text005@1005 : TextConst 'ENU=Page %1;THA=หน้า %1';
      Text006@1006 : TextConst 'ENU=Total %1 Excl. VAT;THA=รวม %1 โดยไม่รวม VAT';
      GLSetup@1007 : Record 98;
      PaymentTerms@1009 : Record 3;
      SalesPurchPerson@1010 : Record 13;
      CompanyInfo@1011 : Record 79;
      SalesSetup@1048 : Record 311;
      SalesComtLine@1000000010 : Record 44;
      Cust@1012 : Record 18;
      VATAmountLine@1013 : TEMPORARY Record 290;
      Language@1017 : Record 8;
      Form50BIS@1000000003 : Report 50002;
      SalesInvCountPrinted@1018 : Codeunit 315;
      FormatAddr@1019 : Codeunit 365;
      tmpCompanyAddr@1000000007 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000006 : ARRAY [2] OF Text[250];
      CustAddr@1021 : ARRAY [8] OF Text[50];
      CompanyAddr@1023 : ARRAY [8] OF Text[50];
      CopyText@1000000008 : Text[30];
      BillToName@1000000005 : Text[500];
      BillToAddress@1000000001 : Text[500];
      CommentText@1000000009 : Text[250];
      TextAmount@1000000000 : Text[250];
      PurchOrderNo@1000000002 : Code[20];
      MoreLines@1031 : Boolean;
      NoOfCopies@1032 : Integer;
      NoOfLoops@1033 : Integer;
      i@1036 : Integer;
      NextEntryNo@1043 : Integer;
      Continue@1040 : Boolean;
      CntLine@1000000004 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   14.06.2007   KKE   'Sales Invoice' Report - Circulation Module.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50064 Inv./Tax Inv. for Other Sales
{
  OBJECT-PROPERTIES
  {
    Date=11/22/07;
    Time=[ 8:59:08 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    Permissions=TableData 7190=rimd;
    CaptionML=[ENU=Sales - Invoice;
               THA=การขาย - ใบส่งของ];
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   CompanyInfo.GET;
                   SalesSetup.GET;
                 END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table112;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Posted Sales Invoice;
                            THA=ใบส่งของสินค้าขายที่ลงรายการบัญชี];
        OnPreDataItem=BEGIN
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                      END;

        OnAfterGetRecord=BEGIN
                           FormatAddr.Company(CompanyAddr,CompanyInfo);

                           BillToName := "Bill-to Name (Thai)";
                           IF BillToName = '' THEN
                             BillToName := "Bill-to Name" + "Bill-to Name 2";

                           BillToAddress := "Bill-to Address (Thai)";
                           IF BillToAddress = '' THEN
                             BillToAddress := "Bill-to Address" + ' ' + "Bill-to Address 2" + ' ' + "Bill-to Address 3";
                           IF "Salesperson Code" = '' THEN BEGIN
                             SalesPurchPerson.INIT;
                           END ELSE BEGIN
                             SalesPurchPerson.GET("Salesperson Code");
                           END;

                           FormatAddr.SalesInvBillTo(CustAddr,"Sales Invoice Header");
                           Cust.GET("Bill-to Customer No.");

                           IF "Payment Terms Code" = '' THEN
                             PaymentTerms.INIT
                           ELSE
                             PaymentTerms.GET("Payment Terms Code");

                           CALCFIELDS(Amount);
                           CALCFIELDS("Amount Including VAT");

                           CommentText := '';
                           SalesComtLine.RESET;
                           SalesComtLine.SETRANGE("Document Type",SalesComtLine."Document Type"::"Posted Invoice");
                           SalesComtLine.SETRANGE("No.","No.");
                           SalesComtLine.SETFILTER(Comment,'<>%1','');
                           IF SalesComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(CommentText + SalesComtLine.Comment) < 250 THEN
                                 IF CommentText = '' THEN
                                   CommentText := SalesComtLine.Comment
                                 ELSE
                                   CommentText := CommentText + ' ' + SalesComtLine.Comment;
                             UNTIL SalesComtLine.NEXT=0;
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=CopyLoop;
        OnPreDataItem=BEGIN
                        NoOfLoops := ABS(NoOfCopies) + Cust."Invoice Copies" + 1;
                        IF NoOfLoops <= 0 THEN
                          NoOfLoops := 1;
                        CopyText := '';
                        SETRANGE(Number,1,NoOfLoops);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > 1 THEN
                             CopyText := Text003;
                           CurrReport.PAGENO := 1;
                           CntLine := 0;
                         END;

        OnPostDataItem=BEGIN
                         IF NOT CurrReport.PREVIEW THEN
                           SalesInvCountPrinted.RUN("Sales Invoice Header");
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=PageLoop;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=8400;
          }
          CONTROLS
          {
            { 1000000019;Shape  ;0    ;4600 ;10400;3600  }
            { 1000000018;Shape  ;10600;4600 ;8700 ;3600  }
            { 1000000016;Shape  ;13600;2600 ;5700 ;1600  }
            { 1000000000;TextBox;2700 ;4700 ;7500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=["Sales Invoice Header"."Bill-to Customer No." ] }
            { 1000000001;TextBox;15100;3500 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Posting Date" }
            { 1000000002;TextBox;15100;2700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."No." }
            { 1000000003;TextBox;500  ;5300 ;9700 ;2100 ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=BillToName + '\' + BillToAddress }
            { 1000000005;TextBox;15100;4900 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PurchOrderNo }
            { 1000000006;TextBox;15100;7300 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SalesPurchPerson.Name }
            { 1000000009;TextBox;15100;5700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PaymentTerms.Description }
            { 1000000010;TextBox;15100;6500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Due Date" }
            { 1000000013;TextBox;2100 ;7500 ;8100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Invoice Header"."Bill-to Contact" }
            { 1000000026;Label  ;5600 ;900  ;8900 ;850  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบแจ้งหนี้/ใบกำกับภาษี }
            { 1000000033;Label  ;13800;2700 ;1100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000034;Label  ;13800;3500 ;1100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
            { 1000000008;Label  ;10800;7300 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=พนักงานขาย/Salesperson }
            { 1000000011;Label  ;10800;5700 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เงื่อนไขการชำระเงิน/Terms }
            { 1000000012;Label  ;10800;6500 ;4300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ครบกำหนดชำระเงิน/Due Date }
            { 1000000014;Label  ;10800;4900 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ใบสั่งซื้อ PO.No. }
            { 1000000017;Shape  ;13600;3400 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000021;Label  ;100  ;4700 ;2600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อและที่อยู่ลูกค้า }
            { 1000000022;Label  ;100  ;7500 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อผู้ที่ติดต่อ }
            { 1000000042;Shape  ;15000;5400 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000049;Shape  ;15000;6200 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000051;Shape  ;15000;7000 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000053;Shape  ;15000;7800 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000024;TextBox;5300 ;0    ;10000;800  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000025;TextBox;0    ;1800 ;12200;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000027;TextBox;0    ;2400 ;12200;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" + CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000028;TextBox;0    ;2900 ;12200;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CompanyInfo."Company Address (Thai)" }
            { 1000000029;TextBox;0    ;3400 ;12200;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000030;TextBox;0    ;3900 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19500;
            SectionHeight=1015;
          }
          CONTROLS
          {
            { 1000000023;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000031;Shape  ;15   ;985  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000032;Shape  ;0    ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000035;Shape  ;2300 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000036;Shape  ;9000 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000037;Shape  ;12500;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000038;Shape  ;14900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000039;Shape  ;16100;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000040;Shape  ;19230;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000041;Label  ;100  ;100  ;2100 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รหัสสินค้า }
            { 1000000043;Label  ;9100 ;85   ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวน }
            { 1000000044;Label  ;14900;100  ;1200 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ส่วนลด }
            { 1000000045;Label  ;12600;100  ;2200 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ราคาหน่วยละ }
            { 1000000046;Label  ;16200;100  ;2900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 1000000047;Label  ;2400 ;100  ;6500 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000102;Label  ;11000;85   ;1500 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หน่วย }
            { 1000000103;Shape  ;10900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000108;Label  ;15000;500  ;1000 ;446  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=% }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19500;
            SectionHeight=3700;
          }
          CONTROLS
          {
            { 1000000060;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000078;Shape  ;19230;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000079;Shape  ;0    ;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000086;Shape  ;15   ;3000 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000087;Label  ;6500 ;100  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้จัดเตรียม }
            { 1000000092;Label  ;6500 ;1600 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้ตรวจสอบ }
            { 1000000088;Label  ;13100;200  ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ในนาม บริษัทเบอร์ด้า (ประเทศไทย) จำกัด }
            { 1000000089;Label  ;13100;2200 ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลายเซ็นผู้มีอำนาจลงนาม }
            { 1000000093;Label  ;0    ;3100 ;19300;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=กรุณาชำระเงินด้วยเช็คขีดคร่อมในนาม "บริษัท เบอร์ด้า (ประเทศไทย) จำกัด" การชำระโดยเช็ค ใบเสร็จจะสมบูรณ์เมื่อเช็คสามารถเรียกเก็บเงินได้ }
            { 1000000097;Shape  ;6400 ;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000098;Shape  ;12900;0    ;30   ;3015 ;ShapeStyle=VertLine }
            { 1000000082;Label  ;100  ;100  ;6300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ได้รับสินค้าตามรายการในสภาพดีและถูกต้องแล้ว }
            { 1000000090;Label  ;100  ;1600 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้รับสินค้า }
            { 1000000091;Label  ;100  ;2200 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=วันที่รับสินค้า }
            { 1000000094;Shape  ;6400 ;1500 ;6500 ;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table113;
        DataItemTableView=SORTING(Document No.,Line No.);
        OnPreDataItem=BEGIN
                        VATAmountLine.DELETEALL;
                        MoreLines := FIND('+');
                        WHILE MoreLines AND (Description = '') AND ("No." = '') AND (Quantity = 0) AND (Amount = 0) DO
                          MoreLines := NEXT(-1) <> 0;
                        IF NOT MoreLines THEN
                          CurrReport.BREAK;
                        SETRANGE("Line No.",0,"Line No.");
                        CurrReport.CREATETOTALS("Line Amount",Amount,"Amount Including VAT","Inv. Discount Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           IF (Type = Type::"G/L Account") THEN
                             "No." := '';

                           VATAmountLine.INIT;
                           VATAmountLine."VAT Identifier" := "VAT Identifier";
                           VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
                           VATAmountLine."Tax Group Code" := "Tax Group Code";
                           VATAmountLine."VAT %" := "VAT %";
                           VATAmountLine."VAT Base" := Amount;
                           VATAmountLine."Amount Including VAT" := "Amount Including VAT";
                           VATAmountLine."Line Amount" := "Line Amount";
                           IF "Allow Invoice Disc." THEN
                             VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
                           VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
                           VATAmountLine.InsertLine;
                         END;

        DataItemLinkReference=Sales Invoice Header;
        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 57  ;TextBox      ;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000048;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000050;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000052;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000054;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000059;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000061;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000105;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type > 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 64  ;TextBox      ;100  ;0    ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="No." }
            { 66  ;TextBox      ;9100 ;0    ;1700 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 68  ;TextBox      ;12600;0    ;2200 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 69  ;TextBox      ;15000;0    ;1000 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Disc. %;
                                                                    THA=% ส่วนลด];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Discount %" }
            { 70  ;TextBox      ;16200;0    ;2900 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Amount;
                                                                    THA=จำนวน];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000062;TextBox;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000063;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000064;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000104;TextBox;11000;0    ;1470 ;600  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit of Measure" }
            { 1000000106;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19500;
            SectionHeight=500;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000095;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000096;Label  ;17385;0    ;1700 ;500  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        IF CntLine > 16 THEN
                          SETRANGE(Number,1,16+20-CntLine)
                        ELSE
                          SETRANGE(Number,1,16-CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19500;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000071;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000072;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000073;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000076;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000077;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000107;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19500;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000126;Shape  ;0    ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000127;Label  ;17370;0    ;1700 ;500  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnAfterGetRecord=BEGIN
                           //KKE : #001 +
                           IF "Sales Invoice Line"."Amount Including VAT" <> 0 THEN
                             TextAmount := '(' + Form50BIS.FormatNoThaiText(ABS("Sales Invoice Line"."Amount Including VAT")) + ')'
                           ELSE
                             TextAmount := '';
                           //KKE : #001 -
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19500;
            SectionHeight=2530;
          }
          CONTROLS
          {
            { 1000000015;TextBox;100  ;1000 ;12300;1427 ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000020;TextBox;16200;1600 ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000004;TextBox;16200;0    ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000007;TextBox;16200;800  ;2900 ;800  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Invoice Line"."Amount Including VAT" - "Sales Invoice Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Invoice Line".GetCurrencyCode }
            { 1000000055;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000057;Shape  ;19230;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000058;Shape  ;16100;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000070;Shape  ;12500;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000080;Shape  ;0    ;0    ;30   ;2500 ;ShapeStyle=VertLine }
            { 1000000081;Shape  ;15   ;2500 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000083;Label  ;12600;0    ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=รวมเงิน }
            { 1000000084;Label  ;12600;800  ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ภาษีมูลค่าเพิ่ม }
            { 1000000085;Label  ;12600;1600 ;3400 ;800  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=จำนวนเงินรวมทั้งสิ้น }
            { 1000000099;TextBox;1700 ;100  ;10700;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CommentText }
            { 1000000101;Label  ;100  ;100  ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=หมายเหตุ: }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5060;
      Height=660;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=[ENU=No. of Copies;
                                                              THA=จำนวนสำเนา];
                                                   SourceExpr=NoOfCopies }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Salesperson;THA=พนักงานขาย';
      Text001@1001 : TextConst 'ENU=Total %1;THA=รวม %1';
      Text002@1002 : TextConst 'ENU=Total %1 Incl. VAT;THA=ยอดรวม %1 ที่รวม VAT';
      Text003@1003 : TextConst 'ENU=COPY;THA=คัดลอก';
      Text004@1004 : TextConst 'ENU=Sales - Invoice %1;THA=การขาย - ใบส่งของ %1';
      Text005@1005 : TextConst 'ENU=Page %1;THA=หน้า %1';
      Text006@1006 : TextConst 'ENU=Total %1 Excl. VAT;THA=รวม %1 โดยไม่รวม VAT';
      GLSetup@1007 : Record 98;
      PaymentTerms@1009 : Record 3;
      SalesPurchPerson@1010 : Record 13;
      CompanyInfo@1011 : Record 79;
      SalesSetup@1048 : Record 311;
      SalesComtLine@1000000010 : Record 44;
      Cust@1012 : Record 18;
      VATAmountLine@1013 : TEMPORARY Record 290;
      Language@1017 : Record 8;
      Form50BIS@1000000003 : Report 50002;
      SalesInvCountPrinted@1018 : Codeunit 315;
      FormatAddr@1019 : Codeunit 365;
      tmpCompanyAddr@1000000007 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000006 : ARRAY [2] OF Text[250];
      CustAddr@1021 : ARRAY [8] OF Text[50];
      CompanyAddr@1023 : ARRAY [8] OF Text[50];
      CopyText@1000000008 : Text[30];
      BillToName@1000000005 : Text[500];
      BillToAddress@1000000001 : Text[500];
      CommentText@1000000009 : Text[250];
      TextAmount@1000000000 : Text[250];
      PurchOrderNo@1000000002 : Code[20];
      MoreLines@1031 : Boolean;
      NoOfCopies@1032 : Integer;
      NoOfLoops@1033 : Integer;
      i@1036 : Integer;
      NextEntryNo@1043 : Integer;
      Continue@1040 : Boolean;
      CntLine@1000000004 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   14.06.2007   KKE   'Sales Invoice' Report - Circulation Module.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50065 Sales - Credit Note / Invoice
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=[ 4:26:05 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    Permissions=TableData 7190=rimd;
    CaptionML=[ENU=Sales - Credit Memo;
               THA=การขาย - ใบลดหนี้];
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   GLSetup.GET;
                 END;

    OnPreReport=BEGIN
                  IF NOT CurrReport.USEREQUESTFORM THEN
                    InitLogInteraction;
                END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table114;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        ReqFilterHeadingML=[ENU=Posted Sales Credit Memo;
                            THA=ใบลดหนี้การขายที่ลงรายการบัญชี];
        OnPreDataItem=BEGIN
                        //KKE : #001 +
                        CompanyInfo.GET;
                        CompanyInfo.CALCFIELDS(Picture);
                        FormatAddr.Company(CompanyAddr,CompanyInfo);
                        IF CompanyInfo."Company Name (Thai)" = '' THEN
                          CompanyInfo."Company Name (Thai)" := CompanyInfo.Name + CompanyInfo."Name 2";
                        tmpCompanyAddrTH[1] := CompanyInfo."Company Address (Thai)";
                        tmpCompanyAddrTH[2] := CompanyInfo."Address 3";
                        tmpCompanyAddr[1] := CompanyAddr[2] + ' ' + CompanyAddr[3] + ' ' + CompanyAddr[4];
                        tmpCompanyAddr[2] := CompanyInfo."Address 3";
                        //KKE : #001 -
                      END;

        OnAfterGetRecord=BEGIN
                           CurrReport.LANGUAGE := Language.GetLanguageID("Language Code");

                           IF RespCenter.GET("Responsibility Center") THEN BEGIN
                             FormatAddr.RespCenter(CompanyAddr,RespCenter);
                             CompanyInfo."Phone No." := RespCenter."Phone No.";
                             CompanyInfo."Fax No." := RespCenter."Fax No.";
                           END ELSE BEGIN
                             FormatAddr.Company(CompanyAddr,CompanyInfo);
                           END;

                           //KKE : #001 +
                           BillToName := "Bill-to Name (Thai)";
                           IF BillToName = '' THEN
                             BillToName := "Bill-to Name" + "Bill-to Name 2";

                           BillToAddress := "Bill-to Address (Thai)";
                           IF BillToAddress = '' THEN
                             BillToAddress := "Bill-to Address" + ' ' + "Bill-to Address 2" + ' ' + "Bill-to Address 3";

                           IF "Applies-to Doc. No." <> '' THEN
                             SalesInvNo := "Applies-to Doc. No."
                           ELSE
                             SalesInvNo := "Applied-to Tax Invoice";
                           //KKE : #001 -

                           PostedDocDim1.SETRANGE("Table ID",DATABASE::"Sales Cr.Memo Header");
                           PostedDocDim1.SETRANGE("Document No.","Sales Cr.Memo Header"."No.");

                           IF "Return Order No." = '' THEN
                             ReturnOrderNoText := ''
                           ELSE
                             ReturnOrderNoText := FIELDCAPTION("Return Order No.");
                           IF "Salesperson Code" = '' THEN BEGIN
                             SalesPurchPerson.INIT;
                             SalesPersonText := '';
                           END ELSE BEGIN
                             SalesPurchPerson.GET("Salesperson Code");
                             SalesPersonText := Text000;
                           END;
                           IF "Your Reference" = '' THEN
                             ReferenceText := ''
                           ELSE
                             ReferenceText := FIELDCAPTION("Your Reference");
                           IF "VAT Registration No." = '' THEN
                             VATNoText := ''
                           ELSE
                             VATNoText := FIELDCAPTION("VAT Registration No.");
                           IF "Currency Code" = '' THEN BEGIN
                             GLSetup.TESTFIELD("LCY Code");
                             TotalText := STRSUBSTNO(Text001,GLSetup."LCY Code");
                             TotalInclVATText := STRSUBSTNO(Text002,GLSetup."LCY Code");
                             TotalExclVATText := STRSUBSTNO(Text007,GLSetup."LCY Code");
                           END ELSE BEGIN
                             TotalText := STRSUBSTNO(Text001,"Currency Code");
                             TotalInclVATText := STRSUBSTNO(Text002,"Currency Code");
                             TotalExclVATText := STRSUBSTNO(Text007,"Currency Code");
                             TotalInclVATTextLCY := STRSUBSTNO(Text002,GLSetup."LCY Code");
                             TotalExclVATTextLCY := STRSUBSTNO(Text007,GLSetup."LCY Code");
                           END;
                           FormatAddr.SalesCrMemoBillTo(CustAddr,"Sales Cr.Memo Header");
                           IF "Applies-to Doc. No." = '' THEN
                             AppliedToText := ''
                           ELSE
                             IF GLSetup.GSTEnabled(SalesInvHeader."Document Date") THEN BEGIN
                               AppliedToText := "Applies-to Doc. No.";
                               IF SalesInvHeader.GET("Adjustment Applies-to") THEN
                                 OriginalInvDate := SalesInvHeader."Document Date"
                               ELSE
                                 OriginalInvDate := 0D;
                             END ELSE
                               AppliedToText := STRSUBSTNO(Text003,"Applies-to Doc. Type","Applies-to Doc. No.");

                           FormatAddr.SalesCrMemoShipTo(ShipToAddr,"Sales Cr.Memo Header");
                           ShowShippingAddr := "Sell-to Customer No." <> "Bill-to Customer No.";
                           FOR i := 1 TO ARRAYLEN(ShipToAddr) DO
                             IF ShipToAddr[i] <> CustAddr[i] THEN
                               ShowShippingAddr := TRUE;

                           CALCFIELDS(Amount);
                           CALCFIELDS("Amount Including VAT");

                           AmountLCY :=
                             ROUND(
                               CurrExchRate.ExchangeAmtFCYToLCY(
                                 WORKDATE,"Currency Code",Amount,"Currency Factor"));
                           AmountIncLCY :=
                             ROUND(
                               CurrExchRate.ExchangeAmtFCYToLCY(
                                 WORKDATE,"Currency Code","Amount Including VAT","Currency Factor"));
                           SalesLine.InitTextVariable;
                           SalesLine.FormatNoText(AmountLangA,"Amount Including VAT","Currency Code");
                           IF ShowTHFormatting THEN BEGIN
                             SalesLine.InitTextVariableTH;
                             SalesLine.FormatNoTextTH(AmountLangB,"Amount Including VAT","Currency Code");
                           END ELSE BEGIN
                             AmountLangB[1]:='';
                             AmountLangB[2]:='';
                           END;

                           IF LogInteraction THEN
                             IF NOT CurrReport.PREVIEW THEN
                               SegManagement.LogDocument(
                                 6,"No.",0,0,DATABASE::Customer,"Sell-to Customer No.","Salesperson Code",
                                 "Campaign No.","Posting Description",'');

                           //KKE : #001 +
                           CommentText := '';
                           SalesComtLine.RESET;
                           SalesComtLine.SETRANGE("Document Type",SalesComtLine."Document Type"::"Posted Credit Memo");
                           SalesComtLine.SETRANGE("No.","No.");
                           SalesComtLine.SETFILTER(Comment,'<>%1','');
                           IF SalesComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(CommentText + SalesComtLine.Comment) < 250 THEN
                                 IF CommentText = '' THEN
                                   CommentText := SalesComtLine.Comment
                                 ELSE
                                   CommentText := CommentText + ' ' + SalesComtLine.Comment;
                             UNTIL SalesComtLine.NEXT=0;
                           //KKE : #001 -
                         END;

        ReqFilterFields=No.,Sell-to Customer No.,No. Printed;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        NewPagePerRecord=Yes;
        DataItemVarName=CopyLoop;
        OnPreDataItem=BEGIN
                        NoOfLoops := ABS(NoOfCopies) + 1;
                        CopyText := '';
                        SETRANGE(Number,1,NoOfLoops);
                      END;

        OnAfterGetRecord=BEGIN
                           CurrReport.PAGENO := 1;
                           IF Number > 1 THEN
                             CopyText := Text004;
                           CntLine := 0;  //KKE : #001
                         END;

        OnPostDataItem=BEGIN
                         IF NOT CurrReport.PREVIEW THEN
                           SalesCrMemoCountPrinted.RUN("Sales Cr.Memo Header");
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=PageLoop;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=20100;
            SectionHeight=4500;
          }
          CONTROLS
          {
            { 1000000019;TextBox;0    ;4000 ;10500;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000123;TextBox;0    ;3500 ;12200;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='Tel : ' + CompanyInfo."Phone No." + '    Fax : ' + CompanyInfo."Fax No." }
            { 1000000124;TextBox;0    ;2900 ;12200;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CompanyInfo."Company Address (Thai)" }
            { 1000000125;TextBox;0    ;2400 ;12200;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" + CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000126;TextBox;0    ;1800 ;12200;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000127;Label  ;5100 ;800  ;10000;850  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Credit Note/Invoice }
            { 1000000128;Label  ;5100 ;0    ;10000;850  ;HorzAlign=Center;
                                                         FontName=CordiaUPC;
                                                         FontSize=18;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบลดหนี้/ใบกำกับภาษี }
            { 1000000033;TextBox;16000;2000 ;3300 ;500  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000114;Label  ;14700;2000 ;1200 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=ENU=หน้า : }
            { 1000000022;Shape  ;13600;2600 ;5700 ;1600  }
            { 1000000025;TextBox;15100;2700 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Cr.Memo Header"."No." }
            { 1000000039;Label  ;13800;2700 ;1100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000045;Shape  ;13600;3400 ;5700 ;30   ;ShapeStyle=HorzLine }
            { 1000000024;TextBox;15100;3500 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Cr.Memo Header"."Posting Date" }
            { 1000000040;Label  ;13800;3500 ;1100 ;600  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=วันที่ }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=20100;
            SectionHeight=4000;
          }
          CONTROLS
          {
            { 1000000020;Shape  ;0    ;200  ;10400;3600  }
            { 1000000021;Shape  ;10600;200  ;8700 ;3600  }
            { 1000000023;TextBox;1600 ;300  ;8600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=["Sales Cr.Memo Header"."Bill-to Customer No." ] }
            { 1000000026;TextBox;500  ;900  ;9700 ;2100 ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=BillToName + '\' + BillToAddress }
            { 1000000028;TextBox;15100;2900 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SalesPurchPerson.Name }
            { 1000000029;TextBox;15100;1300 ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=PaymentTerms.Description }
            { 1000000030;TextBox;15100;2100 ;2000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Cr.Memo Header"."Due Date" }
            { 1000000031;TextBox;1300 ;3100 ;8900 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Sales Cr.Memo Header"."Bill-to Contact" }
            { 1000000041;Label  ;10700;2900 ;4100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=พนักงานขาย/Salesperson }
            { 1000000042;Label  ;10700;1300 ;3800 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เงื่อนไขการชำระเงิน/Terms }
            { 1000000043;Label  ;10700;2100 ;4300 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ครบกำหนดชำระเงิน/Due Date }
            { 1000000044;Label  ;10700;500  ;3200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=อ้างถึงใบแจ้งหนี้เลขที่ }
            { 1000000046;Label  ;100  ;300  ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Sold To : }
            { 1000000047;Label  ;100  ;3100 ;1200 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Attn : }
            { 1000000048;Shape  ;15000;1000 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000049;Shape  ;15000;1800 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000050;Shape  ;15000;2600 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000051;Shape  ;15000;3400 ;4100 ;100  ;ShapeStyle=HorzLine }
            { 1000000004;TextBox;15100;500  ;4000 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SalesInvNo }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=20100;
            SectionHeight=3530;
          }
          CONTROLS
          {
            { 1000000016;Shape  ;15   ;100  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000032;Shape  ;19230;100  ;30   ;3400 ;ShapeStyle=VertLine }
            { 1000000034;Shape  ;0    ;100  ;30   ;3400 ;ShapeStyle=VertLine }
            { 1000000035;Shape  ;0    ;3500 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000036;Label  ;6915 ;200  ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้จัดเตรียม }
            { 1000000037;Label  ;6900 ;1900 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้ตรวจสอบ }
            { 1000000038;Label  ;13100;300  ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ในนาม บริษัทเบอร์ด้า (ประเทศไทย) จำกัด }
            { 1000000079;Label  ;13100;2300 ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลายเซ็นผู้มีอำนาจลงนาม }
            { 1000000088;Shape  ;6710 ;100  ;30   ;3400 ;ShapeStyle=VertLine }
            { 1000000089;Shape  ;12900;100  ;30   ;3400 ;ShapeStyle=VertLine }
            { 1000000101;Label  ;100  ;200  ;6500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ได้รับสินค้าตามรายการในสภาพดีและถูกต้องแล้ว }
            { 1000000102;Label  ;100  ;1900 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ผู้รับสินค้า }
            { 1000000103;Label  ;100  ;2600 ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=วันที่รับสินค้า }
            { 1000000104;Shape  ;6705 ;1800 ;6200 ;30   ;ShapeStyle=HorzLine }
            { 1000000106;Label  ;13100;2800 ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Authorized Signature }
            { 1000000107;Label  ;13100;800  ;6000 ;600  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=For BURDA (THAILAND) CO.,LTD. }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DimensionLoop1;
        OnPreDataItem=BEGIN
                        IF NOT ShowInternalInfo THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN BEGIN
                             IF NOT PostedDocDim1.FIND('-') THEN
                               CurrReport.BREAK;
                           END ELSE
                             IF NOT Continue THEN
                               CurrReport.BREAK;

                           CLEAR(DimText);
                           Continue := FALSE;
                           REPEAT
                             OldDimText := DimText;
                             IF DimText = '' THEN
                               DimText := STRSUBSTNO(
                                 '%1 %2',PostedDocDim1."Dimension Code",PostedDocDim1."Dimension Value Code")
                             ELSE
                               DimText :=
                                 STRSUBSTNO(
                                   '%1, %2 %3',DimText,
                                   PostedDocDim1."Dimension Code",PostedDocDim1."Dimension Value Code");
                             IF STRLEN(DimText) > MAXSTRLEN(OldDimText) THEN BEGIN
                               DimText := OldDimText;
                               Continue := TRUE;
                               EXIT;
                             END;
                           UNTIL (PostedDocDim1.NEXT = 0);
                         END;

        DataItemLinkReference=Sales Cr.Memo Header;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table115;
        DataItemTableView=SORTING(Document No.,Line No.);
        OnPreDataItem=BEGIN
                        VATAmountLine.DELETEALL;
                        SalesShipmentBuffer.RESET;
                        SalesShipmentBuffer.DELETEALL;
                        FirstValueEntryNo := 0;
                        MoreLines := FIND('+');
                        WHILE MoreLines AND (Description = '') AND ("No." = '') AND (Quantity = 0) AND (Amount = 0) DO
                          MoreLines := NEXT(-1) <> 0;
                        IF NOT MoreLines THEN
                          CurrReport.BREAK;
                        SETRANGE("Line No.",0,"Line No.");
                        CurrReport.CREATETOTALS(Amount,"Amount Including VAT","Inv. Discount Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           SalesShipmentBuffer.DELETEALL;
                           PostedReceiptDate := 0D;
                           IF Quantity <> 0 THEN
                             PostedReceiptDate := FindPostedShipmentDate;

                           IF (Type = Type::"G/L Account") AND (NOT ShowInternalInfo) THEN
                             "No." := '';

                           VATAmountLine.INIT;
                           VATAmountLine."VAT Identifier" := "VAT Identifier";
                           VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
                           VATAmountLine."Tax Group Code" := "Tax Group Code";
                           VATAmountLine."VAT %" := "VAT %";
                           VATAmountLine."VAT Base" := Amount;
                           VATAmountLine."Amount Including VAT" := "Amount Including VAT";
                           VATAmountLine."Line Amount" := "Line Amount";
                           IF "Allow Invoice Disc." THEN
                             VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
                           VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
                           VATAmountLine.InsertLine;
                         END;

        TotalFields=Line Amount;
        DataItemLinkReference=Sales Cr.Memo Header;
        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=20100;
            SectionHeight=1015;
          }
          CONTROLS
          {
            { 1000000000;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000001;Shape  ;15   ;985  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000002;Shape  ;0    ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000003;Shape  ;2300 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000005;Shape  ;9000 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000006;Shape  ;12500;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000007;Shape  ;14900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000008;Shape  ;16100;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000027;Shape  ;19230;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000052;Label  ;100  ;100  ;2100 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รหัสสินค้า }
            { 1000000053;Label  ;9100 ;85   ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวน }
            { 1000000054;Label  ;14900;100  ;1200 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ส่วนลด }
            { 1000000055;Label  ;12600;100  ;2200 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ราคาหน่วยละ }
            { 1000000056;Label  ;16200;100  ;2900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 1000000057;Label  ;2400 ;100  ;6500 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000058;Label  ;11000;85   ;1500 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หน่วย }
            { 1000000059;Shape  ;10900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000060;Label  ;15000;500  ;1000 ;446  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=% }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=20100;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type = 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 1000000061;TextBox;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000062;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000063;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000064;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=20100;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Type > 0);
                           //KKE : #001 +
                           IF CurrReport.SHOWOUTPUT THEN BEGIN
                             {
                             IF CntLine = 17 THEN BEGIN
                               CntLine := 0;
                               CurrReport.NEWPAGE;
                             END;
                             }
                             CntLine += 1;
                           END
                           //KKE : #001 -
                         END;

          }
          CONTROLS
          {
            { 1000000009;TextBox;100  ;0    ;2100 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="No." }
            { 1000000011;TextBox;9100 ;0    ;1740 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr=Quantity }
            { 1000000012;TextBox;11000;0    ;1470 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr="Unit of Measure" }
            { 1000000013;TextBox;12600;0    ;2180 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         BlankZero=Yes;
                                                         SourceExpr="Unit Price";
                                                         AutoFormatType=2;
                                                         AutoFormatExpr="Sales Cr.Memo Line".GetCurrencyCode }
            { 1000000014;TextBox;15000;0    ;1000 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Disc. %;
                                                                    THA=% ส่วนลด];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Discount %" }
            { 1000000015;TextBox;16200;0    ;2920 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         CaptionML=[ENU=Amount;
                                                                    THA=จำนวน];
                                                         BlankZero=Yes;
                                                         SourceExpr="Line Amount";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Cr.Memo Line".GetCurrencyCode }
            { 1000000070;TextBox;2400 ;0    ;6500 ;600  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Description }
            { 1000000071;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000072;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000073;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000075;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000076;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000077;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000078;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=20100;
            SectionHeight=500;
            OnPreSection=BEGIN
                           IF CurrReport.SHOWOUTPUT THEN
                             CntLine := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000147;Label  ;17370;0    ;1600 ;500  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
            { 1000000148;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=4;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=Sales Shipment Buffer;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,SalesShipmentBuffer.COUNT);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             SalesShipmentBuffer.FIND('-')
                           ELSE
                             SalesShipmentBuffer.NEXT;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=4;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DimensionLoop2;
        OnPreDataItem=BEGIN
                        IF NOT ShowInternalInfo THEN
                          CurrReport.BREAK;

                        PostedDocDim2.SETRANGE("Table ID",DATABASE::"Sales Cr.Memo Line");
                        PostedDocDim2.SETRANGE("Document No.","Sales Cr.Memo Line"."Document No.");
                        PostedDocDim2.SETRANGE("Line No.","Sales Cr.Memo Line"."Line No.");
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN BEGIN
                             IF NOT PostedDocDim2.FIND('-') THEN
                               CurrReport.BREAK;
                           END ELSE
                             IF NOT Continue THEN
                               CurrReport.BREAK;

                           CLEAR(DimText);
                           Continue := FALSE;
                           REPEAT
                             OldDimText := DimText;
                             IF DimText = '' THEN
                               DimText := STRSUBSTNO(
                                 '%1 %2',PostedDocDim2."Dimension Code",PostedDocDim2."Dimension Value Code")
                             ELSE
                               DimText :=
                                 STRSUBSTNO(
                                   '%1, %2 %3',DimText,
                                   PostedDocDim2."Dimension Code",PostedDocDim2."Dimension Value Code");
                             IF STRLEN(DimText) > MAXSTRLEN(OldDimText) THEN BEGIN
                               DimText := OldDimText;
                               Continue := TRUE;
                               EXIT;
                             END;
                           UNTIL (PostedDocDim2.NEXT = 0);
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=VATCounter;
        OnPreDataItem=BEGIN
                        IF VATAmountLine.GetTotalVATAmount = 0 THEN
                          CurrReport.BREAK;
                        SETRANGE(Number,1,VATAmountLine.COUNT);
                        CurrReport.CREATETOTALS(
                          VATAmountLine."Line Amount",VATAmountLine."Inv. Disc. Base Amount",
                          VATAmountLine."Invoice Discount Amount",VATAmountLine."VAT Base",VATAmountLine."VAT Amount");
                      END;

        OnAfterGetRecord=BEGIN
                           VATAmountLine.GetLine(Number);
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=LineSpace;
        OnPreDataItem=BEGIN
                        IF CntLine > 15 THEN
                          SETRANGE(Number,1,15 + 20 - CntLine)
                        ELSE
                          SETRANGE(Number,1,15-CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=20100;
            SectionHeight=1015;
          }
          CONTROLS
          {
            { 1000000108;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000109;Shape  ;15   ;985  ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000110;Shape  ;0    ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000111;Shape  ;2300 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000113;Shape  ;9000 ;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000129;Shape  ;12500;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000130;Shape  ;14900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000131;Shape  ;16100;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000132;Shape  ;19230;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000133;Label  ;100  ;100  ;2100 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รหัสสินค้า }
            { 1000000134;Label  ;9100 ;85   ;1700 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวน }
            { 1000000135;Label  ;14900;100  ;1200 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ส่วนลด }
            { 1000000136;Label  ;12600;100  ;2200 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ราคาหน่วยละ }
            { 1000000137;Label  ;16200;100  ;2900 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงิน }
            { 1000000138;Label  ;2400 ;100  ;6500 ;846  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=รายการ }
            { 1000000139;Label  ;11000;85   ;1500 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=หน่วย }
            { 1000000140;Shape  ;10900;15   ;30   ;1000 ;ShapeStyle=VertLine }
            { 1000000141;Label  ;15000;500  ;1000 ;446  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=% }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=20100;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000080;Shape  ;19230;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000081;Shape  ;16100;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000082;Shape  ;14900;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000083;Shape  ;12500;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000084;Shape  ;9000 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000085;Shape  ;2300 ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000086;Shape  ;0    ;0    ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000087;Shape  ;10900;0    ;30   ;600  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=20100;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000145;Label  ;17370;0    ;1600 ;500  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=12;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
            { 1000000146;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total;
        OnAfterGetRecord=BEGIN
                           //KKE : #001 +
                           IF "Sales Cr.Memo Line"."Amount Including VAT" <> 0 THEN
                             TextAmount := '(' + Form50BIS.FormatNoThaiText(ABS("Sales Cr.Memo Line"."Amount Including VAT")) + ')'
                           ELSE
                             TextAmount := '';
                           //KKE : #001 -

                           //#002
                           IF SalesInvHeader.GET("Sales Cr.Memo Header"."Applied-to Tax Invoice")  THEN
                             SalesInvHeader.CALCFIELDS("Amount Including VAT");
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20100;
            SectionHeight=3730;
          }
          CONTROLS
          {
            { 1000000010;TextBox;100  ;3000 ;8900 ;700  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000091;Shape  ;19230;0    ;30   ;3700 ;ShapeStyle=VertLine }
            { 1000000092;Shape  ;16100;0    ;30   ;3700 ;ShapeStyle=VertLine }
            { 1000000093;Shape  ;9000 ;0    ;30   ;3700 ;ShapeStyle=VertLine }
            { 1000000094;Shape  ;0    ;0    ;30   ;3700 ;ShapeStyle=VertLine }
            { 1000000095;Shape  ;0    ;3700 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000096;Label  ;9400 ;0    ;6600 ;600  ;Visible=Yes;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ยอดรวม ใบกำกับภาษีเดิม INV. TOTAL }
            { 1000000097;Label  ;9400 ;600  ;6600 ;600  ;Visible=Yes;
                                                         HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ยอดรวมที่ถูกต้อง }
            { 1000000098;Label  ;9400 ;1200 ;6600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ยอดรวมลดหนี้ }
            { 1000000099;TextBox;1700 ;100  ;7300 ;600  ;VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=CommentText }
            { 1000000100;Label  ;100  ;100  ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=หมายเหตุ: }
            { 1000000018;TextBox;16200;600  ;2900 ;600  ;Visible=Yes;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=SalesInvHeader."Amount Including VAT" - "Sales Cr.Memo Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Cr.Memo Line".GetCurrencyCode }
            { 1000000017;TextBox;16200;2400 ;2900 ;600  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Cr.Memo Line"."Amount Including VAT" - "Sales Cr.Memo Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Cr.Memo Line".GetCurrencyCode }
            { 1000000115;Label  ;9400 ;1800 ;6600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ราคารวมสินค้า SUB TOTAL }
            { 1000000116;Label  ;9400 ;2400 ;6600 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=ภาษีมูลค่าเพิ่ม VAT }
            { 1000000117;TextBox;16200;0    ;2900 ;600  ;Visible=Yes;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=SalesInvHeader."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Cr.Memo Line".GetCurrencyCode }
            { 1000000118;Label  ;9400 ;3000 ;6600 ;700  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         FontBold=No;
                                                         CaptionML=ENU=จำนวนเงินรวมทั้งสิ้น }
            { 1000000119;TextBox;16200;3000 ;2900 ;700  ;FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Cr.Memo Line"."Amount Including VAT";
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Cr.Memo Line".GetCurrencyCode }
            { 1000000120;Shape  ;0    ;3000 ;19245;30   ;ShapeStyle=HorzLine }
            { 1000000121;TextBox;16200;1200 ;2900 ;600  ;Visible=Yes;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Cr.Memo Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Cr.Memo Line".GetCurrencyCode }
            { 1000000122;TextBox;16200;1800 ;2900 ;600  ;Visible=Yes;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr="Sales Cr.Memo Line".Amount;
                                                         AutoFormatType=1;
                                                         AutoFormatExpr="Sales Cr.Memo Line".GetCurrencyCode }
            { 1000000090;Shape  ;15   ;0    ;19245;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Total2;
        OnPreDataItem=BEGIN
                        IF NOT ShowShippingAddr THEN
                          CurrReport.BREAK;
                      END;

      }
      SECTIONS
      {
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5060;
      Height=3190;
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   LogInteraction := SegManagement.FindInteractTmplCode(6) <> '';
                   RequestOptionsForm.LogInteraction.ENABLED(LogInteraction);
                 END;

    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;0    ;1650 ;440  ;CaptionML=[ENU=No. of Copies;
                                                              THA=จำนวนสำเนา];
                                                   SourceExpr=NoOfCopies }
      { 21  ;Label        ;0    ;0    ;3300 ;440  ;ParentControl=1 }
      { 2   ;CheckBox     ;3410 ;550  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Show Internal Information;
                                                              THA=แสดงรายละเอียดภายในบริษัท];
                                                   SourceExpr=ShowInternalInfo }
      { 3   ;Label        ;0    ;550  ;3300 ;440  ;ParentControl=2 }
      { 4   ;CheckBox     ;3410 ;1100 ;440  ;440  ;Name=LogInteraction;
                                                   ShowCaption=No;
                                                   CaptionML=[ENU=Log Interaction;
                                                              THA=ล็อกการโต้ตอบ];
                                                   SourceExpr=LogInteraction }
      { 5   ;Label        ;0    ;1100 ;3300 ;440  ;ParentControl=4 }
      { 1500000;CheckBox  ;3410 ;1650 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=AmountInWords }
      { 1500001;CheckBox  ;3410 ;2200 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=CurrencyLCY }
      { 1500002;Label     ;0    ;2200 ;3300 ;440  ;ParentControl=1500001;
                                                   CaptionML=[ENU=Show LCY for FCY;
                                                              THA=แสดง LCY สำหรับ FCY] }
      { 1500003;Label     ;0    ;1650 ;3300 ;440  ;ParentControl=1500000;
                                                   CaptionML=[ENU=Show Total In Words;
                                                              THA=แสดงยอดรวมเป็นตัวอักษร] }
      { 1500004;Label     ;0    ;2750 ;3300 ;440  ;ParentControl=1500005;
                                                   CaptionML=[ENU=Show TH Amount In Words;
                                                              THA=แสดงจำนวนเงินเป็นบาทด้วยตัวอักษร] }
      { 1500005;CheckBox  ;3410 ;2750 ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=ShowTHFormatting }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Salesperson;THA=พนักงานขาย';
      Text001@1001 : TextConst 'ENU=Total %1;THA=รวม %1';
      Text002@1002 : TextConst 'ENU=Total %1 Incl. VAT;THA=ยอดรวม %1 ที่รวม VAT';
      Text003@1003 : TextConst 'ENU=(Applies to %1 %2);THA=(ใช้กับ %1 %2)';
      Text004@1004 : TextConst 'ENU=COPY;THA=คัดลอก';
      Text005@1005 : TextConst 'ENU=Sales - Credit Memo %1;THA=การขาย - ใบลดหนี้ %1';
      Text006@1006 : TextConst 'ENU=Page %1;THA=หน้า %1';
      Text007@1007 : TextConst 'ENU=Total %1 Excl. VAT;THA=รวม %1 โดยไม่รวม VAT';
      GLSetup@1008 : Record 98;
      SalesPurchPerson@1009 : Record 13;
      CompanyInfo@1010 : Record 79;
      VATAmountLine@1011 : TEMPORARY Record 290;
      PostedDocDim1@1012 : Record 359;
      PostedDocDim2@1013 : Record 359;
      Language@1014 : Record 8;
      SalesShipmentBuffer@1042 : TEMPORARY Record 7190;
      SalesInvHeader@1500012 : Record 112;
      SalesCrMemoCountPrinted@1015 : Codeunit 316;
      FormatAddr@1016 : Codeunit 365;
      SegManagement@1017 : Codeunit 5051;
      RespCenter@1018 : Record 5714;
      CustAddr@1019 : ARRAY [8] OF Text[50];
      ShipToAddr@1020 : ARRAY [8] OF Text[50];
      CompanyAddr@1021 : ARRAY [8] OF Text[50];
      ReturnOrderNoText@1039 : Text[30];
      SalesPersonText@1022 : Text[30];
      VATNoText@1023 : Text[30];
      ReferenceText@1024 : Text[30];
      AppliedToText@1025 : Text[40];
      TotalText@1026 : Text[50];
      TotalExclVATText@1027 : Text[50];
      TotalInclVATText@1028 : Text[50];
      MoreLines@1029 : Boolean;
      NoOfCopies@1030 : Integer;
      NoOfLoops@1031 : Integer;
      CopyText@1032 : Text[30];
      ShowShippingAddr@1033 : Boolean;
      i@1034 : Integer;
      DimText@1035 : Text[120];
      OldDimText@1036 : Text[75];
      ShowInternalInfo@1037 : Boolean;
      Continue@1038 : Boolean;
      LogInteraction@1040 : Boolean;
      FirstValueEntryNo@1041 : Integer;
      PostedReceiptDate@1043 : Date;
      NextEntryNo@1044 : Integer;
      TotalInclVATTextLCY@1500009 : Text[50];
      TotalExclVATTextLCY@1500008 : Text[50];
      AmountLCY@1500007 : Decimal;
      AmountIncLCY@1500006 : Decimal;
      CurrExchRate@1500005 : Record 330;
      CheckReport@1500004 : Report 1401;
      AmountLangA@1500003 : ARRAY [2] OF Text[80];
      AmountLangB@1500002 : ARRAY [2] OF Text[80];
      CurrencyLCY@1500001 : Boolean;
      AmountInWords@1500000 : Boolean;
      SalesLine@1500010 : Record 37;
      ShowTHFormatting@1500011 : Boolean;
      OriginalInvDate@1500013 : Date;
      Form50BIS@1000000005 : Report 50002;
      PaymentTerms@1000000006 : Record 3;
      SalesComtLine@1000000010 : Record 44;
      tmpCompanyAddr@1000000008 : ARRAY [2] OF Text[250];
      tmpCompanyAddrTH@1000000007 : ARRAY [2] OF Text[250];
      BillToName@1000000004 : Text[500];
      BillToAddress@1000000003 : Text[500];
      TextAmount@1000000002 : Text[250];
      SalesInvNo@1000000001 : Code[20];
      CntLine@1000000000 : Integer;
      CommentText@1000000009 : Text[250];

    PROCEDURE InitLogInteraction@1();
    BEGIN
      LogInteraction := SegManagement.FindInteractTmplCode(6) <> '';
    END;

    PROCEDURE FindPostedShipmentDate@6() : Date;
    VAR
      ReturnReceiptHeader@1000 : Record 6660;
      SalesShipmentBuffer2@1001 : TEMPORARY Record 7190;
    BEGIN
      NextEntryNo := 1;
      IF "Sales Cr.Memo Line"."Return Receipt No." <> '' THEN
        IF ReturnReceiptHeader.GET("Sales Cr.Memo Line"."Return Receipt No.") THEN
          EXIT(ReturnReceiptHeader."Posting Date");

      CASE "Sales Cr.Memo Line".Type OF
        "Sales Cr.Memo Line".Type::Item:
          GenerateBufferFromValueEntry("Sales Cr.Memo Line");
        "Sales Cr.Memo Line".Type::"G/L Account","Sales Cr.Memo Line".Type::Resource,
        "Sales Cr.Memo Line".Type::"Charge (Item)","Sales Cr.Memo Line".Type::"Fixed Asset":
           GenerateBufferFromShipment("Sales Cr.Memo Line");
        "Sales Cr.Memo Line".Type::" ":
            EXIT(0D);
      END;

      SalesShipmentBuffer.RESET;
      SalesShipmentBuffer.SETRANGE("Document No.","Sales Cr.Memo Line"."Document No.");
      SalesShipmentBuffer.SETRANGE("Line No." ,"Sales Cr.Memo Line"."Line No.");

      IF SalesShipmentBuffer.FIND('-') THEN BEGIN
        SalesShipmentBuffer2 := SalesShipmentBuffer;
          IF SalesShipmentBuffer.NEXT = 0 THEN BEGIN
            SalesShipmentBuffer.GET(SalesShipmentBuffer2."Document No.",SalesShipmentBuffer2."Line No.",SalesShipmentBuffer2."Entry No."
      );
            SalesShipmentBuffer.DELETE;
            EXIT(SalesShipmentBuffer2."Posting Date");;
          END;
         SalesShipmentBuffer.CALCSUMS(Quantity);
         IF SalesShipmentBuffer.Quantity <> "Sales Cr.Memo Line".Quantity THEN BEGIN
           SalesShipmentBuffer.DELETEALL;
           EXIT("Sales Cr.Memo Header"."Posting Date");
         END;
      END ELSE
        EXIT("Sales Cr.Memo Header"."Posting Date");
    END;

    PROCEDURE GenerateBufferFromValueEntry@2(SalesCrMemoLine2@1002 : Record 115);
    VAR
      ValueEntry@1000 : Record 5802;
      ItemLedgerEntry@1001 : Record 32;
      TotalQuantity@1003 : Decimal;
      Quantity@1004 : Decimal;
    BEGIN
      TotalQuantity := SalesCrMemoLine2."Quantity (Base)";
      ValueEntry.SETCURRENTKEY("Document No.","Posting Date");
      ValueEntry.SETRANGE("Document No.",SalesCrMemoLine2."Document No.");
      ValueEntry.SETRANGE("Posting Date","Sales Cr.Memo Header"."Posting Date");
      ValueEntry.SETRANGE("Item Charge No.",'');
      ValueEntry.SETFILTER("Entry No.",'%1..',FirstValueEntryNo);
      IF ValueEntry.FIND('-') THEN
        REPEAT
          IF ItemLedgerEntry.GET(ValueEntry."Item Ledger Entry No.") THEN BEGIN
            IF SalesCrMemoLine2."Qty. per Unit of Measure" <> 0 THEN
              Quantity := ValueEntry."Invoiced Quantity" / SalesCrMemoLine2."Qty. per Unit of Measure"
            ELSE
              Quantity := ValueEntry."Invoiced Quantity";
            AddBufferEntry(
              SalesCrMemoLine2,
              -Quantity,
              ItemLedgerEntry."Posting Date");
            TotalQuantity := TotalQuantity - ValueEntry."Invoiced Quantity";
          END;
          FirstValueEntryNo := ValueEntry."Entry No." + 1;
        UNTIL (ValueEntry.NEXT = 0) OR (TotalQuantity = 0);
    END;

    PROCEDURE GenerateBufferFromShipment@8(SalesCrMemoLine@1000 : Record 115);
    VAR
      SalesCrMemoHeader@1001 : Record 114;
      SalesCrMemoLine2@1002 : Record 115;
      ReturnReceiptHeader@1006 : Record 6660;
      ReturnReceiptLine@1004 : Record 6661;
      TotalQuantity@1003 : Decimal;
      Quantity@1005 : Decimal;
    BEGIN
      TotalQuantity := 0;
      SalesCrMemoHeader.SETCURRENTKEY("Return Order No.");
      SalesCrMemoHeader.SETFILTER("No.",'..%1',"Sales Cr.Memo Header"."No.");
      SalesCrMemoHeader.SETRANGE("Return Order No.","Sales Cr.Memo Header"."Return Order No.");
      IF SalesCrMemoHeader.FIND('-') THEN
        REPEAT
          SalesCrMemoLine2.SETRANGE("Document No.",SalesCrMemoHeader."No.");
          SalesCrMemoLine2.SETRANGE("Line No.",SalesCrMemoLine."Line No.");
          SalesCrMemoLine2.SETRANGE(Type,SalesCrMemoLine.Type);
          SalesCrMemoLine2.SETRANGE("No.",SalesCrMemoLine."No.");
          SalesCrMemoLine2.SETRANGE("Unit of Measure Code",SalesCrMemoLine."Unit of Measure Code");
          IF SalesCrMemoLine2.FIND('-') THEN
            REPEAT
              TotalQuantity := TotalQuantity + SalesCrMemoLine2.Quantity;
            UNTIL SalesCrMemoLine2.NEXT = 0;
        UNTIL SalesCrMemoHeader.NEXT = 0;

      ReturnReceiptLine.SETCURRENTKEY("Return Order No.","Return Order Line No.");
      ReturnReceiptLine.SETRANGE("Return Order No.","Sales Cr.Memo Header"."Return Order No.");
      ReturnReceiptLine.SETRANGE("Return Order Line No.",SalesCrMemoLine."Line No.");
      ReturnReceiptLine.SETRANGE("Line No.",SalesCrMemoLine."Line No.");
      ReturnReceiptLine.SETRANGE(Type,SalesCrMemoLine.Type);
      ReturnReceiptLine.SETRANGE("No.",SalesCrMemoLine."No.");
      ReturnReceiptLine.SETRANGE("Unit of Measure Code",SalesCrMemoLine."Unit of Measure Code");
      ReturnReceiptLine.SETFILTER(Quantity,'<>%1',0);

      IF ReturnReceiptLine.FIND('-') THEN
        REPEAT
          IF "Sales Cr.Memo Header"."Get Return Receipt Used" THEN
            CorrectShipment(ReturnReceiptLine);
          IF ABS(ReturnReceiptLine.Quantity) <= ABS(TotalQuantity - SalesCrMemoLine.Quantity) THEN
            TotalQuantity := TotalQuantity - ReturnReceiptLine.Quantity
          ELSE BEGIN
            IF ABS(ReturnReceiptLine.Quantity)  > ABS(TotalQuantity) THEN
              ReturnReceiptLine.Quantity := TotalQuantity;
            Quantity :=
              ReturnReceiptLine.Quantity - (TotalQuantity- SalesCrMemoLine.Quantity);

            SalesCrMemoLine.Quantity := SalesCrMemoLine.Quantity - Quantity;
            TotalQuantity := TotalQuantity - ReturnReceiptLine.Quantity;

            IF ReturnReceiptHeader.GET(ReturnReceiptLine."Document No.") THEN
              BEGIN
                AddBufferEntry(
                  SalesCrMemoLine,
                  -Quantity,
                  ReturnReceiptHeader."Posting Date");
              END;
          END;
        UNTIL (ReturnReceiptLine.NEXT = 0) OR (TotalQuantity = 0);
    END;

    PROCEDURE CorrectShipment@7(VAR ReturnReceiptLine@1001 : Record 6661);
    VAR
      SalesCrMemoLine@1000 : Record 115;
    BEGIN
      SalesCrMemoLine.SETCURRENTKEY("Return Receipt No.","Return Receipt Line No.");
      SalesCrMemoLine.SETRANGE("Return Receipt No.",ReturnReceiptLine."Document No.");
      SalesCrMemoLine.SETRANGE("Return Receipt Line No.",ReturnReceiptLine."Line No.");
      IF SalesCrMemoLine.FIND('-') THEN
         REPEAT
            ReturnReceiptLine.Quantity := ReturnReceiptLine.Quantity - SalesCrMemoLine.Quantity;
         UNTIL SalesCrMemoLine.NEXT = 0;
    END;

    PROCEDURE AddBufferEntry@3(SalesCrMemoLine@1001 : Record 115;QtyOnShipment@1002 : Decimal;PostingDate@1003 : Date);
    BEGIN
      SalesShipmentBuffer.SETRANGE("Document No.",SalesCrMemoLine."Document No.");
      SalesShipmentBuffer.SETRANGE("Line No.",SalesCrMemoLine."Line No.");
      SalesShipmentBuffer.SETRANGE("Posting Date",PostingDate);
      IF SalesShipmentBuffer.FIND('-') THEN BEGIN
        SalesShipmentBuffer.Quantity := SalesShipmentBuffer.Quantity - QtyOnShipment;
        SalesShipmentBuffer.MODIFY;
        EXIT;
      END;

      WITH SalesShipmentBuffer DO BEGIN
        INIT;
        "Document No." := SalesCrMemoLine."Document No.";
        "Line No." := SalesCrMemoLine."Line No.";
        "Entry No." := NextEntryNo;
        Type := SalesCrMemoLine.Type;
        "No." := SalesCrMemoLine."No.";
        Quantity := -QtyOnShipment;
       "Posting Date" := PostingDate;
        INSERT;
        NextEntryNo := NextEntryNo + 1
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda
      KKE : Kanoknard Ketnut
      GKU : Goragot Kuanmuang

      No.   Date         Sign  Description
      ----------------------------------------
      001   26.04.2007   KKE   'Sales Credit Memo' Report.
      002   30.08.2007   GKU   -Change format report
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50066 Report Subscriber Contact
{
  OBJECT-PROPERTIES
  {
    Date=09/11/07;
    Time=[ 6:02:24 PM];
    Version List=;
  }
  PROPERTIES
  {
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50001;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000004;TextBox;7500 ;423  ;3900 ;423  ;SourceExpr="Old Subscriber No." }
            { 1000000005;Label  ;7050 ;423  ;3750 ;423  ;ParentControl=1000000004;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50005;
        DataItemTableView=SORTING(No.);
        DataItemLink=Subscriber No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=12000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000001;Label  ;900  ;0    ;1950 ;423  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000003;Label  ;3600 ;0    ;2400 ;423  ;ParentControl=1000000002;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000000;TextBox;900  ;0    ;1950 ;423  ;SourceExpr="No." }
            { 1000000002;TextBox;3750 ;0    ;2400 ;423  ;SourceExpr="Subscriber No." }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50067 Subscriber Contract - Labels 2
{
  OBJECT-PROPERTIES
  {
    Date=07/25/08;
    Time=[ 5:51:10 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=100;
    LeftMargin=1000;
    RightMargin=100;
    PaperSize=SuperB/SuperB/A3 305 x 487 mm;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50006;
        DataItemTableView=SORTING(Subscriber No.);
        OnPreDataItem=BEGIN
                        NoOfRecords := COUNT;
                        NoOfColumns := 2;
                        i := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           RecordNo := RecordNo + 1;
                           ColumnNo := ColumnNo + 1;

                           {
                           Addr[ColumnNo][1] := FORMAT(Subscri.Name);
                           Addr[ColumnNo][2] := FORMAT(Subscri."Address 1");
                           Addr[ColumnNo][3] := FORMAT(Subscri."Address 2");
                           Addr[ColumnNo][4] := FORMAT(Subscri."Address 3");

                           COMPRESSARRAY(Addr[ColumnNo]);


                           IF RecordNo = NoOfRecords THEN BEGIN
                             CLEAR(Addr);
                             ColumnNo := 0;
                           END ELSE BEGIN
                             IF ColumnNo = NoOfColumns THEN
                               ColumnNo := 0;
                           END;
                           }
                         END;

        ReqFilterFields=Subscriber Contract No.,Subscriber No.,Magazine Code,Volume No.,Issue No.,Sales Order Flag;
        GroupTotalFields=Subscriber No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           i += 1;
                           IF i > 2 THEN
                             i := 1;
                           IF NOT Subscri.GET("Subscriber No.") THEN
                             CurrReport.SKIP;

                           IF i = 1 THEN BEGIN
                             SubscriberTemp1 := Subscri;
                             IF SubscriberTemp1.INSERT THEN;
                           END ELSE BEGIN
                             SubscriberTemp2 := Subscri;
                             IF SubscriberTemp2.INSERT THEN;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000010;Label  ;100  ;0    ;7200 ;600  ;ForeColor=255;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION. }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        OnPreDataItem=BEGIN
                        IF SubscriberTemp1.COUNT > SubscriberTemp2.COUNT THEN
                          SETRANGE(Number,1,SubscriberTemp1.COUNT)
                        ELSE
                          SETRANGE(Number,1,SubscriberTemp2.COUNT);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN BEGIN
                             IF SubscriberTemp1.FIND('-') THEN;
                             IF SubscriberTemp2.FIND('-') THEN;
                           END ELSE BEGIN
                             IF (SubscriberTemp1.NEXT=0) AND (SubscriberTemp2.NEXT=0) THEN
                               CurrReport.BREAK;
                           END;

                           SubNo[1] := SubscriberTemp1."No.";
                           //Addr[1][1] := FORMAT(subscribertemp1.salutation code & " " & SubscriberTemp1.Name);
                           Addr[1][1] := SubscriberTemp1."Salutation Code" + ' ' + SubscriberTemp1.Name;
                           Addr[1][2] := FORMAT(SubscriberTemp1."Address 1");
                           Addr[1][3] := FORMAT(SubscriberTemp1."Address 2");
                           Addr[1][4] := FORMAT(SubscriberTemp1."Address 3");
                           //COMPRESSARRAY(Addr[1]);

                           SubNo[2] := SubscriberTemp2."No.";
                           //Addr[2][1] := FORMAT(SubscriberTemp2.Name);
                           Addr[2][1] := SubscriberTemp2."Salutation Code" + ' ' + SubscriberTemp2.Name;
                           Addr[2][2] := FORMAT(SubscriberTemp2."Address 1");
                           Addr[2][3] := FORMAT(SubscriberTemp2."Address 2");
                           Addr[2][4] := FORMAT(SubscriberTemp2."Address 3");
                           //COMPRESSARRAY(Addr[2]);

                           IF Number > SubscriberTemp2.COUNT THEN BEGIN
                             CLEAR(Addr[2]);
                             SubNo[2] := '';
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=4700;
          }
          CONTROLS
          {
            { 1000000008;TextBox;11800;3600 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][4] }
            { 1000000007;TextBox;11800;3100 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][3] }
            { 1000000006;TextBox;11800;2600 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][2] }
            { 1000000005;TextBox;11800;2100 ;5700 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][1] }
            { 1000000004;TextBox;700  ;3600 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][4] }
            { 1000000003;TextBox;700  ;3100 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][3] }
            { 1000000002;TextBox;700  ;2600 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][2] }
            { 1000000001;TextBox;700  ;2100 ;5700 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][1] }
            { 1000000000;TextBox;6400 ;2100 ;2100 ;500  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SubNo[1] }
            { 1000000009;TextBox;17500;2100 ;2100 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SubNo[2] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=8580;
      Height=2640;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Addr@1000000000 : ARRAY [2,4] OF Text[250];
      SubNo@1000000010 : ARRAY [2] OF Code[20];
      NoOfRecords@1000000001 : Integer;
      RecordNo@1000000002 : Integer;
      NoOfColumns@1000000003 : Integer;
      ColumnNo@1000000004 : Integer;
      i@1000000005 : Integer;
      Subscri@1000000006 : Record 50001;
      SubscriberTemp1@1000000008 : TEMPORARY Record 50001;
      SubscriberTemp2@1000000009 : TEMPORARY Record 50001;
      SubscriContract@1000000007 : Record 50005;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50068 Subscriber Contract - Expire
{
  OBJECT-PROPERTIES
  {
    Date=12/12/11;
    Time=[ 2:19:40 PM];
    Version List=Burda1.00;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=100;
    LeftMargin=1000;
    RightMargin=100;
    PaperSize=SuperB/SuperB/A3 305 x 487 mm;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50005;
        DataItemTableView=SORTING(No.);
        OnPreDataItem=BEGIN
                        NoOfRecords := COUNT;
                        NoOfColumns := 2;
                        i := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           RecordNo := RecordNo + 1;
                           ColumnNo := ColumnNo + 1;

                           {
                           Addr[ColumnNo][1] := FORMAT(Subscri.Name);
                           Addr[ColumnNo][2] := FORMAT(Subscri."Address 1");
                           Addr[ColumnNo][3] := FORMAT(Subscri."Address 2");
                           Addr[ColumnNo][4] := FORMAT(Subscri."Address 3");

                           COMPRESSARRAY(Addr[ColumnNo]);


                           IF RecordNo = NoOfRecords THEN BEGIN
                             CLEAR(Addr);
                             ColumnNo := 0;
                           END ELSE BEGIN
                             IF ColumnNo = NoOfColumns THEN
                               ColumnNo := 0;
                           END;
                           }
                         END;

        ReqFilterFields=Magazine Code,Ending Volume No.,Ending Issue No.,Ending Issue Date;
        GroupTotalFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19600;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           i += 1;
                           IF i > 2 THEN
                             i := 1;
                           IF NOT Subscri.GET("Subscriber No.") THEN
                             EXIT;
                             //CurrReport.SKIP;

                           IF i = 1 THEN BEGIN
                             SubscriberTemp1 := Subscri;
                             IF SubscriberTemp1.INSERT THEN;
                           END ELSE BEGIN
                             SubscriberTemp2 := Subscri;
                             IF SubscriberTemp2.INSERT THEN;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000010;Label  ;100  ;0    ;7200 ;600  ;ForeColor=255;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION. }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        OnPreDataItem=BEGIN
                        IF SubscriberTemp1.COUNT > SubscriberTemp2.COUNT THEN
                          SETRANGE(Number,1,SubscriberTemp1.COUNT)
                        ELSE
                          SETRANGE(Number,1,SubscriberTemp2.COUNT);
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN BEGIN
                             IF SubscriberTemp1.FIND('-') THEN;
                             IF SubscriberTemp2.FIND('-') THEN;
                           END ELSE BEGIN
                             IF (SubscriberTemp1.NEXT=0) AND (SubscriberTemp2.NEXT=0) THEN
                               CurrReport.BREAK;
                           END;

                           SubNo[1] := SubscriberTemp1."No.";
                           //Addr[1][1] := FORMAT(SubscriberTemp1.Name);
                           Addr[1][1] := SubscriberTemp1."Salutation Code" + ' ' + SubscriberTemp1.Name;
                           Addr[1][2] := FORMAT(SubscriberTemp1."Address 1");
                           Addr[1][3] := FORMAT(SubscriberTemp1."Address 2");
                           Addr[1][4] := FORMAT(SubscriberTemp1."Address 3");
                           //COMPRESSARRAY(Addr[1]);

                           SubNo[2] := SubscriberTemp2."No.";
                           //Addr[2][1] := FORMAT(SubscriberTemp2.Name);
                           Addr[2][1] := SubscriberTemp2."Salutation Code" + ' ' + SubscriberTemp1.Name;
                           Addr[2][2] := FORMAT(SubscriberTemp2."Address 1");
                           Addr[2][3] := FORMAT(SubscriberTemp2."Address 2");
                           Addr[2][4] := FORMAT(SubscriberTemp2."Address 3");
                           //COMPRESSARRAY(Addr[2]);

                           IF Number > SubscriberTemp2.COUNT THEN BEGIN
                             CLEAR(Addr[2]);
                             SubNo[2] := '';
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19600;
            SectionHeight=4700;
          }
          CONTROLS
          {
            { 1000000008;TextBox;11800;3600 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][4] }
            { 1000000007;TextBox;11800;3100 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][3] }
            { 1000000006;TextBox;11800;2600 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][2] }
            { 1000000005;TextBox;11800;2100 ;5700 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[2][1] }
            { 1000000004;TextBox;700  ;3600 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][4] }
            { 1000000003;TextBox;700  ;3100 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][3] }
            { 1000000002;TextBox;700  ;2600 ;7800 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][2] }
            { 1000000001;TextBox;700  ;2100 ;5700 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=Addr[1][1] }
            { 1000000000;TextBox;6400 ;2100 ;2100 ;500  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SubNo[1] }
            { 1000000009;TextBox;17500;2100 ;2100 ;500  ;FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr=SubNo[2] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=8580;
      Height=2640;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Addr@1000000000 : ARRAY [2,4] OF Text[250];
      SubNo@1000000010 : ARRAY [2] OF Code[20];
      NoOfRecords@1000000001 : Integer;
      RecordNo@1000000002 : Integer;
      NoOfColumns@1000000003 : Integer;
      ColumnNo@1000000004 : Integer;
      i@1000000005 : Integer;
      Subscri@1000000006 : Record 50001;
      SubscriberTemp1@1000000008 : TEMPORARY Record 50001;
      SubscriberTemp2@1000000009 : TEMPORARY Record 50001;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50069 Subscriber Contract List
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=[ 4:34:19 PM];
    Version List=;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1500;
    Orientation=Landscape;
    PaperSize=A3 297 x 420 mm;
    HorzGrid=100;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50011;
        DataItemTableView=SORTING(Code);
        NewPagePerGroup=Yes;
        NewPagePerRecord=Yes;
        PrintOnlyIfDetail=Yes;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        PrintOnlyIfDetail=Yes;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=39000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000003;TextBox;0    ;0    ;6300 ;423  ;FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=COMPANYNAME }
            { 1000000035;TextBox;35800;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000036;Label  ;37750;423  ;750  ;423  ;ParentControl=1000000037;
                                                         FontName=Tahoma;
                                                         FontSize=9 }
            { 1000000037;TextBox;38500;423  ;450  ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000002;Label  ;14100;0    ;10300;700  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Subscriber Contract Listing }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table50005;
        DataItemTableView=SORTING(Contract Category);
        PrintOnlyIfDetail=Yes;
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("No.");
                        RunningNo := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           RunningNo += 1 ;
                         END;

        ReqFilterFields=Magazine Code,Contract Category,Expired Date,Ending Issue Date,Starting Issue No.,Ending Issue No.;
        GroupTotalFields=Contract Category;
        DataItemLinkReference=Magazine;
        DataItemLink=Magazine Code=FIELD(Code);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=39000;
            SectionHeight=700;
          }
          CONTROLS
          {
            { 1000000005;Shape  ;0    ;430  ;39000;270  ;ShapeStyle=HorzLine }
            { 1000000026;TextBox;36700;0    ;2250 ;460  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=USERID }
            { 1000000025;TextBox;0    ;0    ;5500 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Magazine.Description }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=39000;
            SectionHeight=1792;
          }
          CONTROLS
          {
            { 1000000013;Label  ;3650 ;0    ;2450 ;846  ;ParentControl=1000000012;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Subscriber No. }
            { 1000000010;Label  ;1500 ;0    ;2000 ;846  ;ParentControl=1000000009;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contract No. }
            { 1000000008;Label  ;6150 ;0    ;4400 ;846  ;ParentControl=1000000007;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Name }
            { 1000000014;Label  ;10700;0    ;7000 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;17800;0    ;5900 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Address 2 }
            { 1000000020;Label  ;23800;0    ;4300 ;846  ;ParentControl=1000000019;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Address 3 }
            { 1000000022;Label  ;28200;0    ;3100 ;846  ;ParentControl=1000000021;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Phone }
            { 1000000029;Label  ;34700;0    ;2000 ;846  ;ParentControl=1000000024;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Start Magazine No. }
            { 1000000031;Label  ;36750;0    ;2000 ;846  ;ParentControl=1000000030;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=End Magazine No. }
            { 1000000006;Shape  ;0    ;1000 ;39000;300  ;ShapeStyle=HorzLine }
            { 1000000032;Label  ;0    ;0    ;1400 ;846  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Line No. }
            { 1000000004;Label  ;32700;0    ;1900 ;846  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contract Issue No. }
            { 1000000033;Label  ;31100;0    ;1600 ;846  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contract Quantity }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=39000;
            SectionHeight=600;
            OnPreSection=BEGIN
                           IF NewPageperContractCategory AND (RunningNo <> 1)  THEN
                             CurrReport.NEWPAGE ;

                           RunningNo := 1;
                         END;

          }
          CONTROLS
          {
            { 1000000028;TextBox;3000 ;0    ;2850 ;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         SourceExpr="Contract Category" }
            { 1000000023;Label  ;100  ;0    ;2900 ;400  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contact Category : }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=39000;
            SectionHeight=900;
            OnPreSection=BEGIN
                           TotalRecord := RunningNo;
                         END;

          }
          CONTROLS
          {
            { 1000000015;TextBox;2400 ;200  ;10800;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=STRSUBSTNO(Text000,TotalRecord ,"Subscriber Contract"."Contract Category") }
            { 1000000016;Shape  ;0    ;0    ;39000;200  ;ShapeStyle=HorzLine }
            { 1000000027;Shape  ;0    ;700  ;39000;200  ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=3;
        DataItemTable=Table50001;
        DataItemTableView=SORTING(No.);
        DataItemLink=No.=FIELD(Subscriber No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=39000;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000000;TextBox;100  ;100  ;1200 ;430  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=RunningNo }
            { 1000000009;TextBox;1500 ;100  ;2000 ;430  ;HorzAlign=Left;
                                                         FontName=tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."No." }
            { 1000000012;TextBox;3700 ;100  ;2400 ;430  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Subscriber No." }
            { 1000000021;TextBox;28200;100  ;3500 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Subscriber."Phone No." + '  '+ Subscriber."Mobile No." }
            { 1000000019;TextBox;23800;100  ;4300 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Subscriber."Address 3" }
            { 1000000017;TextBox;17800;100  ;5900 ;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Subscriber."Address 2" }
            { 1000000011;TextBox;10700;100  ;7000 ;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Address 1;
                                                         SourceExpr=Subscriber."Address 1" }
            { 1000000007;TextBox;6200 ;100  ;4400 ;430  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Subscriber.Name }
            { 1000000024;TextBox;34700;100  ;2000 ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Starting Magazine Item No." }
            { 1000000030;TextBox;36800;100  ;2000 ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Ending Magazine Item No." }
            { 1000000001;TextBox;32800;100  ;1800 ;430  ;HorzAlign=Left;
                                                         FontName=tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Contract Issue No." }
            { 1000000034;TextBox;31900;100  ;800  ;430  ;HorzAlign=Left;
                                                         FontName=tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Subscriber Contract"."Contract Quantity" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=8470;
      Height=1430;
      OnOpenForm=BEGIN
                   NewPageperContractCategory := TRUE;
                 END;

    }
    CONTROLS
    {
      { 1000000001;CheckBox;6270;220  ;440  ;440  ;ShowCaption=No;
                                                   SourceExpr=NewPageperContractCategory }
      { 1000000002;Label  ;440  ;220  ;5610 ;440  ;ParentControl=1000000001;
                                                   CaptionML=ENU=New Page per Contract Category }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Pagex@1000000000 : TextConst 'ENU=Page';
      LastFieldNo@1000000001 : Integer;
      FooterPrinted@1000000002 : Boolean;
      RunningNo@1000000003 : Integer;
      NewPageperContractCategory@1000000004 : Boolean;
      Text000@1000000005 : TextConst 'ENU="Total Counting ===> %1 contracts (%2)";THA="รวมสมาชิก ===> %1 คน (%2)"';
      Detail@1000000006 : Text[30];
      TotalRecord@1000000007 : Decimal;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50070 Outstanding S/O
{
  OBJECT-PROPERTIES
  {
    Date=08/21/07;
    Time=[ 6:58:03 PM];
    Version List=;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table36;
        DataItemTableView=SORTING(Customer Posting Group,Sell-to Customer No.);
        ReqFilterFields=Customer Posting Group,Sell-to Customer No.;
        GroupTotalFields=Customer Posting Group;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=2538;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Outstanding S/O }
            { 1000000002;TextBox;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;17700;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;16950;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1000000012;Label  ;0    ;1692 ;2100 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000015;Label  ;2700 ;1692 ;1350 ;846  ;ParentControl=1000000014;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;4200 ;1692 ;1950 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000021;Label  ;6300 ;1692 ;4500 ;846  ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Cust. Name }
            { 1000000024;Label  ;15900;1692 ;2250 ;846  ;ParentControl=1000000023;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000010;Label  ;11100;1692 ;2250 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Base Amount }
            { 1000000013;Label  ;13500;1692 ;2250 ;846  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=VAT Amount }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18150;
            SectionHeight=846;
            OnPreSection=BEGIN
                           VATBaseAmt := 0;
                           VATAmt := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;3900 ;0    ;2850 ;423  ;SourceExpr="Customer Posting Group" }
            { 1000000009;Label  ;0    ;0    ;3600 ;423  ;ParentControl=1000000008;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000025;TextBox;0    ;0    ;5850 ;423  ;SourceExpr=TotalFor + FIELDCAPTION("Customer Posting Group") }
            { 1000000016;TextBox;11100;0    ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=VATBaseAmt }
            { 1000000019;TextBox;13500;0    ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=VATAmt }
            { 1000000022;TextBox;15900;0    ;2250 ;423  ;HorzAlign=Right;
                                                         CaptionML=ENU=Total Amount;
                                                         SourceExpr=VATBaseAmt + VATAmt }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000026;TextBox;11100;0    ;2250 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalBase }
            { 1000000027;TextBox;13500;0    ;2250 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalVAT }
            { 1000000028;TextBox;15900;0    ;2250 ;423  ;HorzAlign=Right;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Total Amount;
                                                         SourceExpr=TotalBase + TotalVAT }
            { 1000000029;Label  ;0    ;0    ;3600 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Grand Total }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table37;
        DataItemTableView=SORTING(Document Type,Document No.,Line No.);
        OnAfterGetRecord=BEGIN
                           IF NOT Cust.GET("Sell-to Customer No.") THEN
                             CLEAR(Cust);
                           sh.GET("Document Type","Document No.");

                           VATBaseAmt += Amount;
                           VATAmt += "Amount Including VAT" - Amount;
                           TotalBase += Amount;
                           TotalVAT += "Amount Including VAT" - Amount;
                         END;

        ReqFilterFields=Posting Group,Sell-to Customer No.;
        GroupTotalFields=Posting Group;
        DataItemLink=Document Type=FIELD(Document Type),
                     Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000011;TextBox;0    ;0    ;2550 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Document No." }
            { 1000000014;TextBox;2700 ;0    ;1350 ;423  ;HorzAlign=Left;
                                                         CaptionML=ENU=Posting Date;
                                                         SourceExpr=sh."Posting Date" }
            { 1000000017;TextBox;4200 ;0    ;1950 ;423  ;HorzAlign=Left;
                                                         CaptionML=ENU=Cust. No.;
                                                         SourceExpr="Sell-to Customer No." }
            { 1000000020;TextBox;6300 ;0    ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Cust.Name }
            { 1000000023;TextBox;15900;0    ;2250 ;423  ;HorzAlign=Right;
                                                         CaptionML=ENU=Total Amount;
                                                         SourceExpr="Amount Including VAT" }
            { 1000000000;TextBox;11100;0    ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=Amount }
            { 1000000007;TextBox;13500;0    ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr="Amount Including VAT" - Amount }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      TotalFor@1000000002 : TextConst 'ENU="Total for "';
      Cust@1000000006 : Record 18;
      VATEntry@1000000003 : Record 254;
      TotalBase@1000000008 : Decimal;
      TotalVAT@1000000009 : Decimal;
      VATBaseAmt@1000000004 : Decimal;
      VATAmt@1000000005 : Decimal;
      sh@1000000007 : Record 36;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50071 Subscriber List
{
  OBJECT-PROPERTIES
  {
    Date=06/05/08;
    Time=[ 6:15:34 PM];
    Version List=;
  }
  PROPERTIES
  {
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50001;
        DataItemTableView=SORTING(No.);
        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Subscriber }
            { 1000000002;TextBox;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;17700;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;16950;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000007;Label  ;4050 ;0    ;1500 ;846  ;ParentControl=1000000000;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000010;Label  ;900  ;0    ;1500 ;846  ;ParentControl=1000000009;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000012;Label  ;6450 ;0    ;2850 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000014;Label  ;9600 ;0    ;3750 ;846  ;ParentControl=1000000013;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000008;TextBox;2700 ;0    ;4500 ;423  ;SourceExpr=Name }
            { 1000000009;TextBox;150  ;0    ;2400 ;423  ;SourceExpr="No." }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000017;TextBox;3300 ;0    ;4500 ;423  ;SourceExpr=Name }
            { 1000000015;TextBox;300  ;0    ;2400 ;423  ;SourceExpr="No." }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50005;
        DataItemLink=Subscriber No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000000;TextBox;2700 ;0    ;3300 ;423  ;SourceExpr="Subscriber No." }
            { 1000000011;TextBox;6450 ;0    ;2850 ;423  ;SourceExpr="Starting Magazine Item No." }
            { 1000000013;TextBox;9750 ;0    ;3750 ;423  ;SourceExpr="Ending Magazine Item No." }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SubContact@1000000000 : Record 50005;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50072 Top 100 Cust
{
  OBJECT-PROPERTIES
  {
    Date=11/13/07;
    Time=[ 5:57:26 PM];
    Version List=;
  }
  PROPERTIES
  {
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table18;
        DataItemTableView=SORTING(No.);
        OnPreDataItem=BEGIN
                        IF CompareBy <> CompareBy::Customer THEN
                          CurrReport.SKIP;
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=12000;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000003;Label  ;2250 ;0    ;1500 ;846  ;ParentControl=1000000002;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000005;Label  ;4350 ;0    ;1200 ;846  ;ParentControl=1000000004;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000007;Label  ;6750 ;0    ;1800 ;846  ;ParentControl=1000000006;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50038;
        ReqFilterFields=Sell-to Customer No.,Issue Date,Ads. Item No.;
        TotalFields=Amount Including VAT;
        DataItemLink=Sell-to Customer No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000002;TextBox;2250 ;0    ;1500 ;423  ;SourceExpr="Sell-to Customer No." }
            { 1000000004;TextBox;4350 ;0    ;1200 ;423  ;SourceExpr="Issue Date" }
            { 1000000006;TextBox;6750 ;0    ;1800 ;423  ;SourceExpr="Amount Including VAT" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=12000;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CustAmount."Amount (LCY)" := "Ads. Booking Line"."Amount Including VAT";
                           CustAmount."Customer No." := "Ads. Booking Line"."Sell-to Customer No.";
                           CustAmount.INSERT;
                           CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;4650 ;0    ;3900 ;423  ;FontBold=Yes;
                                                         SourceExpr="Amount Including VAT" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table50030;
        DataItemTableView=SORTING(Code);
        OnPreDataItem=BEGIN
                        IF CompareBy <> CompareBy::"Product Category" THEN
                          CurrReport.SKIP;
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50038;
        DataItemTableView=SORTING(Booking No.,Line No.);
        DataItemVarName=Ads. Booking Line1;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table50031;
        DataItemTableView=SORTING(Code);
        OnPreDataItem=BEGIN
                        IF CompareBy <> CompareBy::"Ads. Product" THEN
                          CurrReport.SKIP;
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50038;
        DataItemTableView=SORTING(Booking No.,Line No.);
        DataItemVarName=Ads. Booking Line2;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        OnPreDataItem=BEGIN
                        Integer.SETRANGE(Integer.Number,1,CustAmount.COUNT);

                        CustAmount.ASCENDING(FALSE);

                        //CurrReport.CREATETOTALS(CustAmount."Amount (LCY)");
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             CustAmount.FIND('-')
                           ELSE
                             CustAmount.NEXT;

                           TotalAmount := TotalAmount + CustAmount."Amount (LCY)";
                           //TotalAmount += CustAmount."Amount (LCY)";

                           Cust.GET(CustAmount."Customer No.");
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;3150 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         FontUnderline=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Top 100 Customer }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000000;TextBox;1950 ;0    ;2400 ;423  ;SourceExpr=CustAmount."Customer No." }
            { 1000000009;TextBox;8850 ;0    ;3150 ;423  ;SourceExpr=CustAmount."Amount (LCY)" }
            { 1000000010;TextBox;150  ;0    ;1500 ;423  ;SourceExpr=Number }
            { 1000000013;TextBox;4500 ;0    ;4200 ;423  ;SourceExpr=Cust.Name }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000011;TextBox;8850 ;0    ;3150 ;423  ;FontBold=Yes;
                                                         SourceExpr=TotalAmount }
            { 1000000012;Label  ;2400 ;0    ;2700 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Grand Total }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
      { 1000000000;TextBox;4290 ;440  ;2640 ;440  ;CaptionML=ENU=Compare By;
                                                   SourceExpr=CompareBy }
      { 1000000001;Label  ;880  ;440  ;3300 ;440  ;ParentControl=1000000000 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CustAmount@1000000000 : TEMPORARY Record 266;
      TotalAmount@1000000001 : Decimal;
      Cust@1000000002 : Record 18;
      CompareBy@1000000003 : 'Customer,Product Category,Ads. Product';

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50073 Ads. Booking Issue
{
  OBJECT-PROPERTIES
  {
    Date=09/19/07;
    Time=[ 6:45:10 PM];
    Version List=;
  }
  PROPERTIES
  {
    PaperSize=A4 210 x 297 mm;
    DeviceFontName=0;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemIndent=0;
        DataItemTable=Table50038;
        OnAfterGetRecord=BEGIN
                           IF NOT AdsProduct.GET("Ads. Product") THEN
                             CLEAR(AdsProduct);
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=17400;
            SectionHeight=1722;
          }
          CONTROLS
          {
            { 1000000003;Label  ;0    ;0    ;2700 ;846  ;ParentControl=1000000001;
                                                         HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000008;Label  ;14550;846  ;2700 ;846  ;ParentControl=1000000002;
                                                         HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000005;Label  ;5400 ;846  ;3600 ;846  ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Ad Position }
            { 1000000007;Label  ;2400 ;846  ;3000 ;846  ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Product }
            { 1000000009;Label  ;12750;846  ;1800 ;846  ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=AD. Size }
            { 1000000001;TextBox;2700 ;0    ;3000 ;846  ;SourceExpr="Ads. Item No." }
            { 1000000012;Label  ;0    ;846  ;2400 ;846  ;HorzAlign=Center;
                                                         VertAlign=Center;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Booking No. }
            { 1000000013;Shape  ;150  ;1692 ;17250;30    }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=17400;
            SectionHeight=453;
          }
          CONTROLS
          {
            { 1000000000;TextBox;12750;0    ;1800 ;423  ;SourceExpr="Ads. Size" }
            { 1000000004;TextBox;2400 ;0    ;3000 ;423  ;SourceExpr="Ads. ProductT".Description }
            { 1000000006;TextBox;5400 ;0    ;3600 ;423  ;SourceExpr="Ads. PositionT".Description }
            { 1000000002;TextBox;14550;0    ;2400 ;423  ;SourceExpr="Unit Price Excl. VAT" }
            { 1000000010;TextBox;0    ;0    ;2400 ;423  ;SourceExpr="Booking No." }
            { 1000000015;TextBox;9000 ;0    ;3750 ;423  ;SourceExpr=Remark }
            { 1000000011;Shape  ;0    ;423  ;17250;30    }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50029;
        DataItemVarName=Ads. PositionT;
        DataItemLink=Code=FIELD(Ads. Position);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=17400;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50028;
        DataItemVarName=Ads. SizeT;
        DataItemLink=Code=FIELD(Ads. Size);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=17400;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50031;
        DataItemVarName=Ads. ProductT;
        DataItemLink=Code=FIELD(Ads. Product);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=17400;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AdsProduct@1000000000 : Record 50031;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50074 Report Issue
{
  OBJECT-PROPERTIES
  {
    Date=11/15/07;
    Time=[ 7:59:44 PM];
    Version List=;
  }
  PROPERTIES
  {
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50038;
        OnAfterGetRecord=BEGIN
                                   TotalCount.Code :=  "Ads. Booking Line"."Booking No.";
                                   TotalCount.Name := "Ads. Booking Line"."Ads. Size";
                                   TotalCount.Amount :=   "Ads. Booking Line"."Unit Price Excl. VAT";
                                   TotalCount.INSERT;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=12000;
            SectionHeight=555;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=609;
          }
          CONTROLS
          {
            { 1000000000;TextBox;133  ;0    ;2831 ;609  ;SourceExpr="<Ads. ProductT>".Description }
            { 1000000001;TextBox;2921 ;0    ;2328 ;609  ;SourceExpr="Ads. Booking Line"."Ads. Size" }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50031;
        DataItemVarName=<Ads. ProductT>;
        DataItemLink=Code=FIELD(Ads. Product);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50032;
        DataItemVarName=<Ads. TypeT>;
        DataItemLink=Code=FIELD(Ads. Type);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50028;
        DataItemVarName=<Ads. SizeT>;
        DataItemLink=Code=FIELD(Ads. Size);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table50029;
        DataItemVarName=<Ads. PositionT>;
        DataItemLink=Code=FIELD(Ads. Position);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=Integer;
        OnPreDataItem=BEGIN


                        Integer.SETRANGE(Integer.Number,1,TotalCount.COUNT);

                        TotalCount.ASCENDING(FALSE);

                        //CurrReport.CREATETOTALS(CustAmount."Amount (LCY)");
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number = 1 THEN
                             TotalCount.FIND('-')
                           ELSE
                             TotalCount.NEXT;

                           //TotalAmount := TotalAmount + CustAmount."Amount (LCY)";

                           //TotalAmount += CustAmount."Amount (LCY)";

                           //Cust.GET(CustAmount."Customer No.");
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=12000;
            SectionHeight=0;
          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=678;
          }
          CONTROLS
          {
            { 1000000003;TextBox;646  ;42   ;3281 ;609  ;SourceExpr=CountAd }
            { 1000000002;TextBox;7234 ;69   ;4075 ;609  ;SourceExpr="Ads. Booking Line"."Ads. Type" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=12000;
            SectionHeight=26;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CountAd@1000000000 : Integer;
      TotalCount@1000000001 : TEMPORARY Record 367;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50075 Subscription Unrealize Report
{
  OBJECT-PROPERTIES
  {
    Date=04/03/10;
    Time=[ 8:33:31 AM];
    Version List=;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    RightMargin=1000;
    OnPreReport=BEGIN
                  IF (StartDate = 0D) OR (EndDate = 0D) THEN
                    BEGIN
                    CurrReport.QUIT;
                    MESSAGE('Please Fill Start/End Date')    ;
                  END;

                  RepFilter := "Subscriber Contract".GETFILTERS      ;
                  IF RepFilter = '' THEN
                    RepFilter += STRSUBSTNO('Revenue Date : %1..%2', StartDate, EndDate)
                  ELSE
                    RepFilter += STRSUBSTNO(', Revenue Date : %1..%2', StartDate, EndDate);
                END;

    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50011;
        DataItemTableView=SORTING(Code);
        NewPagePerGroup=Yes;
        PrintOnlyIfDetail=Yes;
        OnAfterGetRecord=BEGIN
                           CLEAR(Total);
                         END;

        GroupTotalFields=Code;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        PrintOnlyIfDetail=Yes;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27570;
            SectionHeight=1440;
          }
          CONTROLS
          {
            { 1000000006;TextBox;25200;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1000000004;TextBox;27000;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;26250;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000043;TextBox;0    ;870  ;25050;420  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         SourceExpr=RepFilter }
            { 1000000037;Label  ;9690 ;0    ;9600 ;570  ;FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Outstanding Subscription Unrealize Report }
            { 1000000003;TextBox;0    ;0    ;6630 ;540  ;FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=COMPANYNAME }
            { 1000000002;TextBox;24300;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27570;
            SectionHeight=1230;
          }
          CONTROLS
          {
            { 1000000058;Shape  ;27525;0    ;30   ;1230 ;ShapeStyle=VertLine }
            { 1000000046;Shape  ;0    ;1200 ;27540;30   ;ShapeStyle=HorzLine }
            { 1000000060;Shape  ;20610;0    ;30   ;1200 ;ShapeStyle=VertLine }
            { 1000000063;Shape  ;24060;0    ;30   ;1200 ;ShapeStyle=VertLine }
            { 1000000071;Shape  ;21810;630  ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000072;Shape  ;25230;600  ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000012;Label  ;18450;660  ;2100 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Amount }
            { 1000000013;Label  ;21900;660  ;2100 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Amount }
            { 1000000022;Label  ;20700;660  ;1050 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Q'ty }
            { 1000000025;Label  ;25350;660  ;2100 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Amount }
            { 1000000028;Label  ;24150;660  ;1050 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Q'ty }
            { 1000000011;Label  ;17250;660  ;1050 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Q'ty }
            { 1000000055;Shape  ;17160;0    ;30   ;1200 ;ShapeStyle=VertLine }
            { 1000000070;Shape  ;18330;600  ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000030;Label  ;15270;190  ;1830 ;846  ;ParentControl=1000000029;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Ending Magazine }
            { 1000000027;Label  ;13500;190  ;1680 ;870  ;ParentControl=1000000026;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Starting Magazine }
            { 1000000021;Label  ;10860;190  ;2580 ;846  ;ParentControl=1000000020;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000059;Shape  ;17160;600  ;10410;30   ;ShapeStyle=HorzLine }
            { 1000000000;Label  ;17250;100  ;3300 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Realize Bal. At Date }
            { 1000000007;Label  ;20700;100  ;3300 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Realize Revenue }
            { 1000000010;Label  ;24150;100  ;3300 ;500  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=UnRealize }
            { 1000000024;Label  ;9090 ;190  ;1710 ;846  ;ParentControl=1000000023;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000019;Label  ;5580 ;190  ;3480 ;846  ;ParentControl=1000000016;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contact Name }
            { 1000000045;Shape  ;0    ;0    ;27540;30   ;ShapeStyle=HorzLine }
            { 1000000018;Label  ;3210 ;190  ;2340 ;846  ;ParentControl=1000000017;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000015;Label  ;1110 ;190  ;2040 ;846  ;ParentControl=1000000014;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contract No. }
            { 1000000042;Label  ;60   ;190  ;990  ;800  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Line No. }
            { 1000000052;Shape  ;0    ;0    ;30   ;1230 ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27570;
            SectionHeight=670;
          }
          CONTROLS
          {
            { 1000000001;Shape  ;27525;0    ;30   ;670  ;ShapeStyle=VertLine }
            { 1000000041;Shape  ;0    ;620  ;27540;50   ;ShapeStyle=HorzLine }
            { 1000000009;Shape  ;0    ;0    ;30   ;670  ;ShapeStyle=VertLine }
            { 1000000008;TextBox;300  ;60   ;8790 ;540  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Magazine.Description }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table50005;
        DataItemTableView=SORTING(Magazine Code,No.);
        OnPreDataItem=BEGIN
                        CLEAR(Line);
                      END;

        OnAfterGetRecord=BEGIN
                           Subscriber.INIT;
                           IF Subscriber.GET("Subscriber Contract"."Subscriber No.")
                                 AND ("Contract Status" = "Contract Status"::Released )
                                 AND ("Payment Status" = "Payment Status"::Paid)THEN BEGIN

                             CLEAR(Qty);
                             CLEAR(Amt);

                            // IF ("Subscriber Contract"."Contract Net Price" = 0) OR ("Subscriber Contract"."Contract Quantity" = 0) THEN
                            //   UnitPrice := 0
                            // ELSE
                            //   UnitPrice := "Subscriber Contract"."Contract Net Price" / "Subscriber Contract"."Contract Quantity"
                            // ;

                             SubContractLE.RESET;
                             SubContractLE.SETCURRENTKEY("Subscriber Contract No.","Subscriber No.","Magazine Code","Volume No.","Issue No.");
                             SubContractLE.SETRANGE("Subscriber Contract No.", "Subscriber Contract"."No.");
                             SubContractLE.SETRANGE("Subscriber No.", "Subscriber Contract"."Subscriber No.");

                             IF SubContractLE.FIND('-') THEN
                             REPEAT
                               UnitPrice := SubContractLE."Unit Price" ;
                               IF (SubContractLE."Delivered Date" < StartDate) AND (SubContractLE."Delivered Date" <> 0D)  THEN
                               BEGIN
                                 Qty[1] += SubContractLE.Quantity;
                                // Amt[1] += ROUND(SubContractLE.Quantity * UnitPrice,0.01)  ;
                                 Amt[1] += SubContractLE.Quantity * UnitPrice  ;
                               END
                               ELSE
                                 IF (SubContractLE."Delivered Date" >= StartDate) AND (SubContractLE."Delivered Date" <= EndDate)  THEN
                                 BEGIN
                                   Qty[2] += SubContractLE.Quantity;
                                   //Amt[2] += ROUND(SubContractLE.Quantity * UnitPrice,0.01)  ;
                                   Amt[2] += SubContractLE.Quantity * UnitPrice  ;

                                 END
                                 ELSE
                                 IF (SubContractLE."Delivered Date" > EndDate) OR (NOT SubContractLE."Delivered Flag") THEN
                                 BEGIN
                                   Qty[3] += SubContractLE.Quantity;
                                   //Amt[3] += ROUND(SubContractLE.Quantity * UnitPrice,0.01)  ;
                                   Amt[3] += SubContractLE.Quantity * UnitPrice  ;

                                 END;
                             UNTIL SubContractLE.NEXT = 0;

                             IF (Amt[3] = 0) AND (NOT ShowUnrealZero) THEN
                               CurrReport.SKIP;

                             Line +=1 ;
                             Total[1] += Amt[1]  ;
                             Total[2] += Amt[2]  ;
                             Total[3] += Amt[3]  ;
                           END;
                         END;

        ReqFilterFields=Magazine Code;
        GroupTotalFields=Magazine Code,No.;
        DataItemLinkReference=Magazine;
        DataItemLink=Magazine Code=FIELD(Code);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27570;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT( ("Contract Status" = "Contract Status"::Released )
                             AND ("Payment Status" = "Payment Status"::Paid)) ;
                         END;

          }
          CONTROLS
          {
            { 1000000014;TextBox;1080 ;100  ;2100 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="No." }
            { 1000000017;TextBox;3240 ;100  ;2310 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Subscriber No." }
            { 1000000020;TextBox;10890;100  ;2250 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Contract Net Price" }
            { 1000000023;TextBox;9120 ;100  ;1680 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Contract Quantity" }
            { 1000000026;TextBox;13530;90   ;1710 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Starting Magazine Item No." }
            { 1000000029;TextBox;15390;90   ;1710 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Ending Magazine Item No." }
            { 1000000016;TextBox;5610 ;100  ;3450 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Subscriber.Name }
            { 1000000031;TextBox;17250;100  ;1050 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Qty[1] }
            { 1000000032;TextBox;18450;100  ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Amt[1] }
            { 1000000033;TextBox;20700;100  ;1050 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Qty[2] }
            { 1000000034;TextBox;21900;100  ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Amt[2] }
            { 1000000035;TextBox;24150;100  ;1050 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Qty[3] }
            { 1000000036;TextBox;25350;100  ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Amt[3] }
            { 1000000044;TextBox;90   ;100  ;960  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Line }
            { 1000000053;Shape  ;0    ;0    ;30   ;650  ;ShapeStyle=VertLine }
            { 1000000057;Shape  ;27525;0    ;30   ;650  ;ShapeStyle=VertLine }
            { 1000000047;Shape  ;0    ;600  ;27540;50   ;ShapeStyle=HorzLine }
            { 1000000061;Shape  ;17160;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000064;Shape  ;20610;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;24060;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;18330;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000073;Shape  ;21810;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;25230;0    ;30   ;630  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=27570;
            SectionHeight=650;
          }
          CONTROLS
          {
            { 1000000062;Label  ;90   ;60   ;3960 ;420  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         FontItalic=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue page }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27570;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000038;TextBox;17280;150  ;3300 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Total[1] }
            { 1000000039;TextBox;20700;150  ;3300 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Total[2] }
            { 1000000040;TextBox;24270;150  ;3180 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Total[3] }
            { 1000000048;Shape  ;0    ;700  ;27540;30   ;ShapeStyle=HorzLine }
            { 1000000049;Label  ;4650 ;150  ;6450 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total of }
            { 1000000050;TextBox;11250;150  ;5700 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Magazine.Description }
            { 1000000054;Shape  ;0    ;0    ;30   ;720  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;27525;0    ;30   ;720  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;24060;0    ;30   ;720  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;20610;0    ;30   ;720  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;17160;0    ;30   ;720  ;ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=4620;
      Height=1760;
      OnOpenForm=BEGIN
                   //day := DATE2DMY(d,1);
                   //month := DATE2DMY(d,2);
                   //year := DATE2DMY(d,3);
                   StartDate := DMY2DATE(1,DATE2DMY(TODAY,2),DATE2DMY(TODAY,3));
                   EndDate := TODAY;
                 END;

    }
    CONTROLS
    {
      { 1000000002;TextBox;2310 ;110  ;1980 ;440  ;SourceExpr=StartDate }
      { 1000000003;Label  ;110  ;110  ;2090 ;440  ;ParentControl=1000000002;
                                                   CaptionML=ENU=Start Date }
      { 1000000004;TextBox;2310 ;660  ;1980 ;440  ;SourceExpr=EndDate }
      { 1000000005;Label  ;110  ;660  ;2090 ;440  ;ParentControl=1000000004;
                                                   CaptionML=ENU=End Date }
      { 1000000000;CheckBox;3520;1320 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Show Unrealize Zero;
                                                   SourceExpr=ShowUnrealZero }
      { 1000000001;Label  ;110  ;1320 ;3300 ;440  ;ParentControl=1000000000 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SubContractLE@1000000008 : Record 50006;
      Subscriber@1000000001 : Record 50001;
      UnitPrice@1000000009 : Decimal;
      StartDate@1000000010 : Date;
      EndDate@1000000011 : Date;
      Total@1000000013 : ARRAY [3] OF Decimal;
      Line@1000000014 : Integer;
      Bal@1000000015 : Integer;
      Qty@1000000016 : ARRAY [3] OF Integer;
      Amt@1000000017 : ARRAY [3] OF Decimal;
      RepFilter@1000000018 : Text[255];
      ShowUnrealZero@1000000000 : Boolean;

    BEGIN
    {
      001  06.12.2008  KKE  - Not show unrealize zero.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50076 Subscription Report
{
  OBJECT-PROPERTIES
  {
    Date=04/04/08;
    Time=11:03:37 AM;
    Version List=;
  }
  PROPERTIES
  {
    TopMargin=1000;
    BottomMargin=1000;
    LeftMargin=1000;
    RightMargin=1000;
    OnPreReport=BEGIN
                  IF (StartDate = 0D) OR (EndDate = 0D) THEN
                    BEGIN
                    CurrReport.QUIT;
                    MESSAGE('Please Fill Start/End Date')    ;
                  END;

                  RepFilter := "Subscriber Contract".GETFILTERS      ;
                  IF RepFilter = '' THEN
                    RepFilter += STRSUBSTNO('Revenue Date : %1..%2', StartDate, EndDate)
                  ELSE
                    RepFilter += STRSUBSTNO(', Revenue Date : %1..%2', StartDate, EndDate);
                END;

    Orientation=Landscape;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50011;
        DataItemTableView=SORTING(Code);
        NewPagePerGroup=Yes;
        PrintOnlyIfDetail=Yes;
        OnAfterGetRecord=BEGIN
                           CLEAR(Total);
                         END;

        GroupTotalFields=Code;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        PrintOnlyIfDetail=Yes;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27570;
            SectionHeight=1440;
          }
          CONTROLS
          {
            { 1000000006;TextBox;25200;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
            { 1000000004;TextBox;27000;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;26250;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000043;TextBox;0    ;870  ;25050;420  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         SourceExpr=RepFilter }
            { 1000000037;Label  ;9690 ;0    ;9600 ;570  ;FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Outstanding Subscription Unrealize Report }
            { 1000000003;TextBox;0    ;0    ;6630 ;540  ;FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=COMPANYNAME }
            { 1000000002;TextBox;24300;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27570;
            SectionHeight=1230;
          }
          CONTROLS
          {
            { 1000000058;Shape  ;27525;0    ;30   ;1230 ;ShapeStyle=VertLine }
            { 1000000046;Shape  ;0    ;1200 ;27540;30   ;ShapeStyle=HorzLine }
            { 1000000060;Shape  ;20610;0    ;30   ;1200 ;ShapeStyle=VertLine }
            { 1000000063;Shape  ;24060;0    ;30   ;1200 ;ShapeStyle=VertLine }
            { 1000000071;Shape  ;21810;630  ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000072;Shape  ;25230;600  ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000012;Label  ;18450;660  ;2100 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Amount }
            { 1000000013;Label  ;21900;660  ;2100 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Amount }
            { 1000000022;Label  ;20700;660  ;1050 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Q'ty }
            { 1000000025;Label  ;25350;660  ;2100 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Amount }
            { 1000000028;Label  ;24150;660  ;1050 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Q'ty }
            { 1000000011;Label  ;17250;660  ;1050 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Q'ty }
            { 1000000055;Shape  ;17160;0    ;30   ;1200 ;ShapeStyle=VertLine }
            { 1000000070;Shape  ;18330;600  ;30   ;600  ;ShapeStyle=VertLine }
            { 1000000030;Label  ;15270;190  ;1830 ;846  ;ParentControl=1000000029;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Ending Magazine }
            { 1000000027;Label  ;13500;190  ;1680 ;870  ;ParentControl=1000000026;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Starting Magazine }
            { 1000000021;Label  ;10860;190  ;2580 ;846  ;ParentControl=1000000020;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000059;Shape  ;17160;630  ;10410;30   ;ShapeStyle=HorzLine }
            { 1000000000;Label  ;17250;190  ;3300 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Realize Bal. At Date }
            { 1000000007;Label  ;20700;190  ;3300 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Realize Revenue }
            { 1000000010;Label  ;24150;190  ;3300 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=UnRealize }
            { 1000000024;Label  ;9090 ;190  ;1710 ;846  ;ParentControl=1000000023;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000019;Label  ;5580 ;190  ;3480 ;846  ;ParentControl=1000000016;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contact Name }
            { 1000000045;Shape  ;0    ;0    ;27540;30   ;ShapeStyle=HorzLine }
            { 1000000018;Label  ;3210 ;190  ;2340 ;846  ;ParentControl=1000000017;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000015;Label  ;1110 ;190  ;2040 ;846  ;ParentControl=1000000014;
                                                         HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Contract No. }
            { 1000000042;Label  ;60   ;190  ;990  ;800  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Line No. }
            { 1000000052;Shape  ;0    ;0    ;30   ;1230 ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=27570;
            SectionHeight=670;
          }
          CONTROLS
          {
            { 1000000001;Shape  ;27525;0    ;30   ;670  ;ShapeStyle=VertLine }
            { 1000000041;Shape  ;0    ;620  ;27540;50   ;ShapeStyle=HorzLine }
            { 1000000009;Shape  ;0    ;0    ;30   ;670  ;ShapeStyle=VertLine }
            { 1000000008;TextBox;300  ;60   ;8790 ;540  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Magazine.Description }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table50005;
        DataItemTableView=SORTING(Magazine Code,No.);
        OnPreDataItem=BEGIN
                        CLEAR(Line);
                      END;

        OnAfterGetRecord=BEGIN
                           Subscriber.INIT;
                           IF Subscriber.GET("Subscriber Contract"."Subscriber No.")
                                 AND ("Contract Status" = "Contract Status"::Released )
                                 AND ("Payment Status" = "Payment Status"::Paid)THEN BEGIN

                             CLEAR(Qty);
                             CLEAR(Amt);

                            // IF ("Subscriber Contract"."Contract Net Price" = 0) OR ("Subscriber Contract"."Contract Quantity" = 0) THEN
                            //   UnitPrice := 0
                            // ELSE
                            //   UnitPrice := "Subscriber Contract"."Contract Net Price" / "Subscriber Contract"."Contract Quantity"
                            // ;

                             Line +=1 ;
                             SubContractLE.RESET;
                             SubContractLE.SETCURRENTKEY("Subscriber Contract No.","Subscriber No.","Magazine Code","Volume No.","Issue No.");
                             SubContractLE.SETRANGE("Subscriber Contract No.", "Subscriber Contract"."No.");
                             SubContractLE.SETRANGE("Subscriber No.", "Subscriber Contract"."Subscriber No.");

                             IF SubContractLE.FIND('-') THEN
                             REPEAT
                               UnitPrice := SubContractLE."Unit Price" ;
                               IF (SubContractLE."Delivered Date" < StartDate) AND (SubContractLE."Delivered Date" <> 0D)  THEN
                               BEGIN
                                 Qty[1] += SubContractLE.Quantity;
                                // Amt[1] += ROUND(SubContractLE.Quantity * UnitPrice,0.01)  ;
                                 Amt[1] += SubContractLE.Quantity * UnitPrice  ;
                               END
                               ELSE
                                 IF (SubContractLE."Delivered Date" >= StartDate) AND (SubContractLE."Delivered Date" <= EndDate)  THEN
                                 BEGIN
                                   Qty[2] += SubContractLE.Quantity;
                                   //Amt[2] += ROUND(SubContractLE.Quantity * UnitPrice,0.01)  ;
                                   Amt[2] += SubContractLE.Quantity * UnitPrice  ;

                                 END
                                 ELSE
                                 IF (SubContractLE."Delivered Date" > EndDate) OR (NOT SubContractLE."Delivered Flag") THEN
                                 BEGIN
                                   Qty[3] += SubContractLE.Quantity;
                                   //Amt[3] += ROUND(SubContractLE.Quantity * UnitPrice,0.01)  ;
                                   Amt[3] += SubContractLE.Quantity * UnitPrice  ;

                                 END;
                             UNTIL SubContractLE.NEXT = 0;

                             Total[1] += Amt[1]  ;
                             Total[2] += Amt[2]  ;
                             Total[3] += Amt[3]  ;
                           END;
                         END;

        ReqFilterFields=Magazine Code;
        GroupTotalFields=Magazine Code,No.;
        DataItemLinkReference=Magazine;
        DataItemLink=Magazine Code=FIELD(Code);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=27570;
            SectionHeight=650;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT( ("Contract Status" = "Contract Status"::Released )
                             AND ("Payment Status" = "Payment Status"::Paid)) ;
                         END;

          }
          CONTROLS
          {
            { 1000000014;TextBox;1080 ;100  ;2100 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="No." }
            { 1000000017;TextBox;3240 ;100  ;2310 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Subscriber No." }
            { 1000000020;TextBox;10890;100  ;2250 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Contract Net Price" }
            { 1000000023;TextBox;9120 ;100  ;1680 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Contract Quantity" }
            { 1000000026;TextBox;13530;90   ;1710 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Starting Magazine Item No." }
            { 1000000029;TextBox;15390;90   ;1710 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Ending Magazine Item No." }
            { 1000000016;TextBox;5610 ;100  ;3450 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Subscriber.Name }
            { 1000000031;TextBox;17250;100  ;1050 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Qty[1] }
            { 1000000032;TextBox;18450;100  ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Amt[1] }
            { 1000000033;TextBox;20700;100  ;1050 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Qty[2] }
            { 1000000034;TextBox;21900;100  ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Amt[2] }
            { 1000000035;TextBox;24150;100  ;1050 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Qty[3] }
            { 1000000036;TextBox;25350;100  ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Amt[3] }
            { 1000000044;TextBox;90   ;100  ;960  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Line }
            { 1000000053;Shape  ;0    ;0    ;30   ;650  ;ShapeStyle=VertLine }
            { 1000000057;Shape  ;27525;0    ;30   ;650  ;ShapeStyle=VertLine }
            { 1000000047;Shape  ;0    ;600  ;27540;50   ;ShapeStyle=HorzLine }
            { 1000000061;Shape  ;17160;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000064;Shape  ;20610;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000065;Shape  ;24060;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000069;Shape  ;18330;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000073;Shape  ;21810;0    ;30   ;630  ;ShapeStyle=VertLine }
            { 1000000074;Shape  ;25230;0    ;30   ;630  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=27570;
            SectionHeight=650;
          }
          CONTROLS
          {
            { 1000000062;Label  ;90   ;60   ;3960 ;420  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         FontItalic=Yes;
                                                         MultiLine=Yes;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue page }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=27570;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000038;TextBox;17280;150  ;3300 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Total[1] }
            { 1000000039;TextBox;20700;150  ;3300 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Total[2] }
            { 1000000040;TextBox;24270;150  ;3180 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Total[3] }
            { 1000000048;Shape  ;0    ;700  ;27540;30   ;ShapeStyle=HorzLine }
            { 1000000049;Label  ;4650 ;150  ;6450 ;423  ;HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total of }
            { 1000000050;TextBox;11250;150  ;5700 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         SourceExpr=Magazine.Description }
            { 1000000054;Shape  ;0    ;0    ;30   ;720  ;ShapeStyle=VertLine }
            { 1000000056;Shape  ;27525;0    ;30   ;720  ;ShapeStyle=VertLine }
            { 1000000066;Shape  ;24060;0    ;30   ;720  ;ShapeStyle=VertLine }
            { 1000000067;Shape  ;20610;0    ;30   ;720  ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;17160;0    ;30   ;720  ;ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=4290;
      Height=1320;
      OnOpenForm=BEGIN
                   //day := DATE2DMY(d,1);
                   //month := DATE2DMY(d,2);
                   //year := DATE2DMY(d,3);
                   StartDate := DMY2DATE(1,DATE2DMY(TODAY,2),DATE2DMY(TODAY,3));
                   EndDate := TODAY;
                 END;

    }
    CONTROLS
    {
      { 1000000002;TextBox;2310 ;110  ;1980 ;440  ;SourceExpr=StartDate }
      { 1000000003;Label  ;110  ;110  ;2090 ;440  ;ParentControl=1000000002;
                                                   CaptionML=ENU=Start Date }
      { 1000000004;TextBox;2310 ;660  ;1980 ;440  ;SourceExpr=EndDate }
      { 1000000005;Label  ;110  ;660  ;2090 ;440  ;ParentControl=1000000004;
                                                   CaptionML=ENU=End Date }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SubContractLE@1000000008 : Record 50006;
      Subscriber@1000000001 : Record 50001;
      UnitPrice@1000000009 : Decimal;
      StartDate@1000000010 : Date;
      EndDate@1000000011 : Date;
      Total@1000000013 : ARRAY [3] OF Decimal;
      Line@1000000014 : Integer;
      Bal@1000000015 : Integer;
      Qty@1000000016 : ARRAY [3] OF Integer;
      Amt@1000000017 : ARRAY [3] OF Decimal;
      RepFilter@1000000018 : Text[255];

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50083 FORM 53 (Portrait)
{
  OBJECT-PROPERTIES
  {
    Date=03/12/12;
    Time=[ 2:27:35 PM];
    Modified=Yes;
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=500;
    OnInitReport=BEGIN
                   RecPerPage := 9;
                   AllPageHeight := RecPerPage * 1830 + 1350;
                 END;

    OnPreReport=BEGIN
                  IF CompanyInfo.GET THEN
                    FOR i := 1 TO STRLEN(CompanyInfo."VAT Registration No.") DO
                      CId[i] := COPYSTR(CompanyInfo."VAT Registration No.",i,1);

                  FOR i := 1 TO STRLEN(BranchNo) DO
                    Branch[i] := COPYSTR(BranchNo,i,1);

                  GLSetup.FIND('-');

                  WHTTerm := '1';
                END;

    Orientation=Portrait;
    PaperSize=A4 210 x 297 mm;
    HorzGrid=30;
    VertGrid=30;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..2));
        DataItemVarName=Integer1;
        OnPreDataItem=BEGIN
                        pNO := 1;
                      END;

        OnAfterGetRecord=BEGIN
                           IF (pNO >= 2) AND (Number > 1) AND (PageHeight = 0) THEN
                             pNO := pNO - 1;

                           PageHeight := 0;
                           SNo := 0;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19710;
            SectionHeight=4260;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(SNo <> 0);
                         END;

          }
          CONTROLS
          {
            { 1000000013;Shape  ;19620;0    ;30   ;4230 ;ShapeStyle=VertLine }
            { 1000000018;Shape  ;18480;0    ;30   ;1140 ;ShapeStyle=VertLine }
            { 1000000039;Label  ;9240 ;0    ;3780 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=รวมยอดเงินได้และภาษีที่นำส่ง }
            { 1000000040;Shape  ;13080;0    ;30   ;1140 ;ShapeStyle=VertLine }
            { 1000000041;Shape  ;13080;480  ;5410 ;30   ;ShapeStyle=HorzLine }
            { 1000000042;Shape  ;9180 ;0    ;30   ;4260 ;ShapeStyle=VertLine }
            { 1000000043;Label  ;90   ;420  ;7290 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=(1) ให้ระบุว่าจ่ายเป็นค่าอะไร เช่น ค่าเช่าอาคาร ค่าสอบบัญชี }
            { 1000000044;Label  ;720  ;840  ;6660 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=ค่าออกแบบ  ค่าก่อสร้างโรงเรียน  ค่าซื้อเครื่องพิมพ์ดีด }
            { 1000000045;Label  ;720  ;1260 ;8040 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU="ค่าซื้อพืชผลทางการเกษตร  ( ยางพารา มันสำปะหลัง ปอ ข้าว ฯลฯ) " }
            { 1000000046;Label  ;210  ;0    ;3540 ;450  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000047;Shape  ;0    ;0    ;30   ;4260 ;ShapeStyle=VertLine }
            { 1000000048;Label  ;720  ;1680 ;8040 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU="ค่าจ้างทำของ ค่าจ้างโฆษณา ดอกเบี้ยเงินฝาก ดอกเบี้ยตั๋วเงิน " }
            { 1000000049;Label  ;720  ;2100 ;8220 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU="เงินปันผล เงินส่วนแบ่งของกำไร รางวัลใน การประกวด  การแข่งขัน  " }
            { 1000000050;Label  ;720  ;2520 ;2610 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=การชิงโชค  ฯลฯ }
            { 1000000051;Label  ;11250;1890 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ลงชื่อ }
            { 1000000052;Label  ;17730;1860 ;1260 ;510  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 1000000053;Label  ;12590;1890 ;4980 ;480  ;HorzAlign=General;
                                                         VertAlign=Bottom;
                                                         CaptionML=ENU=..................................................................... }
            { 1000000054;Label  ;90   ;3180 ;6540 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=(2) เงื่อนไขการหักภาษี ณ ที่จ่ายให้กรอกดังนี้ }
            { 1000000055;Label  ;660  ;3603 ;5940 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=- หัก ณ ที่จ่าย กรอก 1     - ออกภาษีให้ กรอก 2 }
            { 1000000056;Label  ;11290;3180 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ตำแหน่ง }
            { 1000000057;Label  ;12630;3180 ;6810 ;423  ;VertAlign=Bottom;
                                                         CaptionML=[ENU=.................................................................................................;
                                                                    THA="(                     กรรมการผู้จัดการ                      )                "] }
            { 1000000058;Label  ;11270;3792 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ยื่นวันที่ }
            { 1000000059;Label  ;13840;3792 ;930  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เดือน }
            { 1000000060;Label  ;16900;3792 ;870  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=พ.ศ. }
            { 1000000061;Label  ;12610;3792 ;1230 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.............. }
            { 1000000062;Label  ;14770;3792 ;2130 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................... }
            { 1000000063;Label  ;17770;3792 ;1650 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................... }
            { 1000000064;Shape  ;15   ;4230 ;19630;30   ;ShapeStyle=HorzLine }
            { 1000000065;TextBox;13170;0    ;3090 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 1000000066;TextBox;16380;0    ;2040 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000067;Shape  ;16320;0    ;30   ;1140 ;ShapeStyle=VertLine }
            { 1000000068;Shape  ;9600 ;2220 ;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000069;Label  ;9650 ;2420 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000070;Label  ;9650 ;2736 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000071;Label  ;9650 ;3020 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000072;Label  ;12590;2520 ;5490 ;423  ;HorzAlign=General;
                                                         VertAlign=Bottom;
                                                         CaptionML=[ENU=(..................................................................);
                                                                    THA=(                  นายสมเกียรติ  วงศาโรจน์                  )] }
            { 1000000073;Shape  ;13080;1050 ;5410 ;30   ;ShapeStyle=HorzLine }
            { 1000000074;TextBox;13200;560  ;3060 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT2 }
            { 1000000075;TextBox;16380;560  ;2040 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY2 }
            { 1000000076;Label  ;9270 ;540  ;3750 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=รวมทั้งหมด }
            { 1000000077;Shape  ;13080;1130 ;5410 ;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table28044;
        DataItemTableView=SORTING(Document Type,Posting Date,WHT Certificate No.)
                          WHERE(Transaction Type=CONST(Purchase),
                                Document Type=CONST(Payment),
                                Amount=FILTER(<>0),
                                WHT Report=CONST(Por Ngor Dor 53),
                                Cancelled=CONST(No));
        OnPreDataItem=BEGIN
                        WHTEntry.COPYFILTERS("WHT Entry");
                        IF WHTEntry.FIND('-') THEN;

                        CLEAR(NewDocNo);
                        CLEAR(Name);
                        CLEAR(Address);
                        CLEAR(VAT);
                        CLEAR(PostingDate);
                        CLEAR(WHTExpenseText);
                        CLEAR("WHT%");
                        CLEAR(WHTBaseAmtLCYExcVAT);
                        CLEAR(WHTAmtLCY);
                      END;

        OnAfterGetRecord=BEGIN
                           IF "Actual Vendor No." <> '' THEN
                             Vendor.GET("Actual Vendor No.")
                           ELSE
                             Vendor.GET("Bill-to/Pay-to No.");

                           IF (NewDocNo <> "WHT Certificate No.") OR (NewVendor <> Vendor."No.")  THEN BEGIN
                             NewDocNo := "WHT Certificate No.";
                             NewVendor := Vendor."No." ;
                             CLEAR(Name);
                             CLEAR(Address);
                             CLEAR(VAT);
                             CLEAR(PostingDate);
                             CLEAR(WHTExpenseText);
                             CLEAR("WHT%");
                             CLEAR(WHTBaseAmtLCYExcVAT);
                             CLEAR(WHTAmtLCY);
                           END;
                           //TSA001

                           //KKE : #002 +
                           IF "Dummy Vendor" AND PurchInvHeader.GET("Document No.") THEN BEGIN
                             IF PurchInvHeader."Pay-to Name (Thai)" <> '' THEN BEGIN
                               Name := PurchInvHeader."Pay-to Name (Thai)";
                               Address := PurchInvHeader."Pay-to Address (Thai)";
                             END ELSE BEGIN
                               Name := PurchInvHeader."Pay-to Name" + PurchInvHeader."Pay-to Name 2";
                               Address := PurchInvHeader."Pay-to Address" + ' ' +
                                          PurchInvHeader."Pay-to Address 2" + ' ' + PurchInvHeader."Pay-to Address 3";
                             END;
                             FOR i := 1 TO STRLEN("VAT Registration No.(Dummy)") DO
                               VAT[i] := COPYSTR("VAT Registration No.(Dummy)",i,1);
                           END ELSE BEGIN
                           //KKE : #002 -
                             IF Vendor."Name (Thai)" <> '' THEN BEGIN
                               Name := Vendor."Name (Thai)";
                               Address := Vendor."Address (Thai)";
                             END ELSE BEGIN
                               Name := Vendor.Name + Vendor."Name 2";
                               Address := Vendor.Address + ' ' + Vendor."Address 2" + ' ' + Vendor."Address 3";
                             END;
                             FOR i := 1 TO STRLEN(Vendor."VAT Registration No.") DO
                               VAT[i] := COPYSTR(Vendor."VAT Registration No.",i,1);
                           END;

                           PostingDate := "Posting Date";

                           IF WHTRevType.GET("WHT Revenue Type") THEN BEGIN
                             i := 0;
                             MatchType := FALSE;
                             REPEAT
                               i := i + 1;
                               IF (WHTExpenseText[i] = '') OR (WHTExpenseText[i] = WHTRevType.Description) THEN
                                 MatchType := TRUE;
                             UNTIL (i=12) OR (MatchType);
                             WHTExpenseText[i] := WHTRevType.Description;
                             "WHT%"[i] := "WHT %";

                             WHTAmtLCY[i] := WHTAmtLCY[i] + "Amount (LCY)";
                             WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + "Base (LCY)";
                           END;

                           IF PrintTest THEN
                             TestText := "Original Document No." + '/ ' + "WHT Certificate No.";
                         END;

        ReqFilterFields=Transaction Type,Document Type,Document No.,WHT Certificate No.,Posting Date;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19710;
            SectionHeight=5160;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           TotWHTBaseAmtLCYExcVAT := 0;
                           TotWHTAmtLCY := 0;
                         END;

          }
          CONTROLS
          {
            { 1   ;Label        ;18150;1530 ;1200 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=แผ่น }
            { 2   ;Shape        ;15   ;2370 ;19630;30   ;ShapeStyle=HorzLine }
            { 3   ;Shape        ;19620;2400 ;30   ;2760 ;ShapeStyle=VertLine }
            { 4   ;Label        ;18480;3720 ;1170 ;450  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=เงื่อนไข }
            { 5   ;Label        ;18480;3360 ;1170 ;360  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=(2) }
            { 20  ;Shape        ;18480;2400 ;30   ;2760 ;ShapeStyle=VertLine }
            { 22  ;Shape        ;14010;4500 ;4500 ;50   ;ShapeStyle=HorzLine }
            { 23  ;Label        ;16440;2880 ;1860 ;1560 ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=จำนวนเงินภาษี ที่หักและ นำส่งในครั้งนี้ }
            { 25  ;Label        ;16800;1590 ;1350 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.................................. }
            { 27  ;Label        ;16470;4620 ;1860 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=บาท }
            { 28  ;TextBox      ;18900;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[4] }
            { 29  ;TextBox      ;18450;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[3] }
            { 30  ;Shape        ;18900;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 31  ;TextBox      ;18000;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[2] }
            { 32  ;Shape        ;18450;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 33  ;TextBox      ;17550;270  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=Branch[1] }
            { 34  ;Shape        ;18000;270  ;30   ;423  ;ShapeStyle=VertLine }
            { 35  ;Shape        ;17550;270  ;1800 ;423   }
            { 36  ;Label        ;16350;210  ;1200 ;540  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=สาขาที่ }
            { 37  ;Label        ;15450;1530 ;1350 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ในจำนวน }
            { 42  ;Shape        ;16320;2370 ;30   ;2790 ;ShapeStyle=VertLine }
            { 47  ;Label        ;14100;1560 ;1350 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=....................... }
            { 48  ;Label        ;14100;3870 ;2160 ;570  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=6;
                                                         FontBold=No;
                                                         CaptionML=ENU=จำนวนเงินที่จ่ายในครั้งนี้ }
            { 54  ;Label        ;9270 ;2790 ;6960 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รายละเอียดเกี่ยวกับการจ่ายเงินได้พึงประเมิน }
            { 55  ;Label        ;14100;4620 ;2130 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=บาท }
            { 56  ;Label        ;12900;1530 ;1200 ;423  ;FontName=Tahoma;
                                                         FontSize=10;
                                                         CaptionML=ENU=แผ่นที่ }
            { 67  ;Label        ;13110;3870 ;930  ;420  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=อัตรา }
            { 68  ;Shape        ;14010;3810 ;30   ;1350 ;ShapeStyle=VertLine }
            { 69  ;Label        ;13110;4260 ;930  ;420  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=ภาษี }
            { 70  ;Label        ;13110;4680 ;930  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=ร้อยละ }
            { 73  ;Label        ;1350 ;210  ;8550 ;540  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร (ของผู้มีหน้าที่หักภาษี ณ ที่จ่าย) }
            { 74  ;Shape        ;13080;3810 ;30   ;1350 ;ShapeStyle=VertLine }
            { 75  ;Label        ;10830;4430 ;2250 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=พึงประเมินที่จ่าย }
            { 76  ;Label        ;10800;3960 ;2280 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=(1) ประเภทเงินได้ }
            { 78  ;Shape        ;10740;3810 ;30   ;1350 ;ShapeStyle=VertLine }
            { 79  ;Label        ;5250 ;2460 ;3870 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 80  ;Shape        ;1050 ;3789 ;15300;50   ;ShapeStyle=HorzLine }
            { 81  ;Shape        ;9180 ;2370 ;30   ;2790 ;ShapeStyle=VertLine }
            { 82  ;Label        ;1210 ;4665 ;7950 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุเลขที่ ตรอก/ซอย หมู่ที่ ถนนตำบล/แขวง อำเภอ/เขต จังหวัด) }
            { 83  ;Label        ;5280 ;2880 ;3840 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ของผู้มีเงินได้) }
            { 84  ;Label        ;2640 ;4012 ;3520 ;488  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ที่อยู่ของผู้มีเงินได้ }
            { 85  ;Label        ;1290 ;2490 ;3600 ;483  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ชื่อผู้รับเงินได้พึงประเมิน }
            { 86  ;Shape        ;5130 ;2370 ;50   ;1465 ;ShapeStyle=VertLine }
            { 87  ;Label        ;1290 ;2911 ;3900 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontBold=No;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็นบริษัทจำกัด ห้างหุ้นส่วน }
            { 88  ;Label        ;1290 ;3334 ;3900 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=จำกัด หรือห้างหุ้นส่วนสามัญนิติบุคคล) }
            { 89  ;Label        ;900  ;1020 ;3300 ;996  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=20;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.53 }
            { 90  ;Label        ;0    ;1320 ;930  ;696  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ใบต่อ }
            { 91  ;Shape        ;1020 ;2370 ;30   ;2790 ;ShapeStyle=VertLine }
            { 92  ;Label        ;70   ;3630 ;960  ;510  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=ลำดับที่ }
            { 95  ;Shape        ;0    ;2370 ;30   ;2790 ;ShapeStyle=VertLine }
            { 96  ;Shape        ;15   ;5127 ;19630;30   ;ShapeStyle=HorzLine }
            { 174 ;TextBox      ;14100;1470 ;1350 ;423  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000004;TextBox;16800;1500 ;1350 ;423  ;HorzAlign=Center;
                                                         VertAlign=Top;
                                                         SourceExpr=pNO }
            { 1000000005;Label  ;9240 ;3870 ;1410 ;581  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=วัน เดือน ปี }
            { 1000000006;Label  ;9240 ;4399 ;1410 ;554  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         CaptionML=ENU=ที่จ่าย }
            { 1000000031;TextBox;4290 ;750  ;11430;690  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000156;Shape  ;10200;210  ;5850 ;423   }
            { 1000000158;TextBox;14250;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[10] }
            { 1000000161;TextBox;13800;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[9] }
            { 1000000164;Shape  ;14250;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000165;TextBox;13350;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[8] }
            { 1000000166;Shape  ;13800;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000167;TextBox;12900;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[7] }
            { 1000000168;Shape  ;13350;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000169;TextBox;12450;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[6] }
            { 1000000170;Shape  ;12900;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000171;TextBox;12000;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[5] }
            { 1000000172;Shape  ;12450;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000173;TextBox;11550;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[4] }
            { 1000000174;Shape  ;12000;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000175;Shape  ;11550;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000176;TextBox;11100;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[3] }
            { 1000000177;Shape  ;11550;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000178;TextBox;10200;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[1] }
            { 1000000179;Shape  ;11100;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000180;Shape  ;10650;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000181;TextBox;10650;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[2] }
            { 1000000182;TextBox;14700;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[11] }
            { 1000000183;Shape  ;14700;240  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000184;Shape  ;15150;210  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000185;TextBox;15150;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[12] }
            { 1000000186;TextBox;15600;210  ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[13] }
            { 1000000187;Shape  ;15600;210  ;30   ;423  ;ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19710;
            SectionHeight=1890;
            OnPreSection=BEGIN
                           CLEAR(OldData);
                           WHTEntry := "WHT Entry";
                           //WHTEntry.SETCURRENTKEY("Entry Type","WHT Slip No.","Pay-to/Bill-to Account Type","Pay-to/Bill-to Account No.","Open Entry");
                           //KK : #1 +
                           //WHTEntry.SETCURRENTKEY("Entry Type","Posting Date","WHT Certificate No.","Pay-to/Bill-to Account Type",
                           //  "Pay-to/Bill-to Account No.","Open Entry");

                           //WHTEntry.SETCURRENTKEY("Transaction Type","Document Type","Document No.","Bill-to/Pay-to No.");
                           WHTEntry.SETCURRENTKEY("Document Type","Posting Date","WHT Certificate No.");  //KKE : #003
                           //KK : #1 -
                           IF WHTEntry.NEXT <> 0 THEN BEGIN
                             IF NewDocNo = WHTEntry."WHT Certificate No." THEN
                               OldData := TRUE;
                           END;

                           IF OldData THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE BEGIN
                             IF Integer1.Number = 1 THEN BEGIN
                               CurrReport.SHOWOUTPUT(FALSE);
                               PageHeight := PageHeight + 1830;
                               //IF ((8670  - PageHeight) < 1830) AND (i <= 3) THEN BEGIN //GKU:#006
                               IF ((AllPageHeight  - PageHeight) < 1830) AND (i <= 3) THEN BEGIN
                                 PageHeight := 0;
                                 pNO := pNO + 1;
                               END;
                             END ELSE
                               SNo := SNo + 1;
                           END;
                         END;

            OnPostSection=BEGIN
                            IF NOT OldData THEN BEGIN
                              IF Integer1.Number <> 1 THEN BEGIN
                                TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT +
                                          WHTBaseAmtLCYExcVAT[1] + WHTBaseAmtLCYExcVAT[2] + WHTBaseAmtLCYExcVAT[3];
                                TotWHTAmtLCY := TotWHTAmtLCY +
                                          WHTAmtLCY[1] + WHTAmtLCY[2] + WHTAmtLCY[3];
                                TotWHTBaseAmtLCYExcVAT2 := TotWHTBaseAmtLCYExcVAT2 +
                                          WHTBaseAmtLCYExcVAT[1] + WHTBaseAmtLCYExcVAT[2] + WHTBaseAmtLCYExcVAT[3];
                                TotWHTAmtLCY2 := TotWHTAmtLCY2 +
                                          WHTAmtLCY[1] + WHTAmtLCY[2] + WHTAmtLCY[3];
                              END;
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000036;Label  ;1740 ;450  ;7440 ;501  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 8   ;Shape        ;19620;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 9   ;Shape        ;19620;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 11  ;Shape        ;16320;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 97  ;Shape        ;14010;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 98  ;Shape        ;13080;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 99  ;Shape        ;10740;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 102 ;Shape        ;9180 ;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 104 ;Label        ;1770 ;1020 ;7410 ;480  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 105 ;TextBox      ;1830 ;1050 ;7350 ;750  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         MultiLine=Yes;
                                                         SourceExpr=Address + '  ' + Address2 + '  ' + City }
            { 118 ;Label        ;1110 ;1020 ;690  ;480  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 132 ;Label        ;1110 ;450  ;630  ;510  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 133 ;Shape        ;1020 ;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 134 ;Shape        ;0    ;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 170 ;TextBox      ;70   ;720  ;870  ;423  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=SNo }
            { 1000000080;TextBox;9240 ;240  ;1470 ;420  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PostingDate }
            { 1000000083;TextBox;10800;240  ;2250 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText[1] }
            { 1000000082;TextBox;10800;750  ;2250 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText[2] }
            { 1000000017;TextBox;13140;240  ;870  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[1] }
            { 1000000012;TextBox;13140;750  ;870  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[2] }
            { 1000000016;TextBox;14160;240  ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[1] }
            { 1000000011;TextBox;14160;750  ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[2] }
            { 1000000003;TextBox;16370;240  ;2040 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[1] }
            { 1000000002;TextBox;16370;750  ;2040 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[2] }
            { 1000000001;TextBox;18510;240  ;1110 ;540  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTTerm }
            { 1000000084;TextBox;1800 ;450  ;7320 ;510  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=Name }
            { 1000000032;TextBox;10800;1230 ;2250 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText[3] }
            { 1000000033;TextBox;13140;1230 ;870  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[3] }
            { 1000000034;TextBox;14160;1230 ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[3] }
            { 1000000035;TextBox;16370;1230 ;2040 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[3] }
            { 1000000038;Label  ;1800 ;1410 ;7380 ;450  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000078;TextBox;90   ;0    ;3660 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=TestText }
            { 1000000090;Shape  ;18480;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000103;Shape  ;8640 ;0    ;423  ;423   }
            { 1000000105;Shape  ;8250 ;0    ;423  ;423   }
            { 1000000107;Shape  ;7860 ;0    ;423  ;423   }
            { 1000000109;Shape  ;7470 ;0    ;423  ;423   }
            { 1000000110;Shape  ;5880 ;0    ;423  ;423   }
            { 1000000111;Shape  ;6270 ;0    ;423  ;423   }
            { 1000000114;Shape  ;6660 ;0    ;423  ;423   }
            { 1000000115;Shape  ;7050 ;0    ;423  ;423   }
            { 1000000116;Shape  ;3870 ;0    ;423  ;423   }
            { 1000000117;Shape  ;4260 ;0    ;423  ;423   }
            { 1000000131;Shape  ;4650 ;0    ;423  ;423   }
            { 1000000132;Shape  ;5040 ;0    ;423  ;423   }
            { 1000000133;Shape  ;5460 ;0    ;423  ;423   }
            { 1000000130;TextBox;3840 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[1] }
            { 1000000134;TextBox;4260 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[2] }
            { 1000000135;TextBox;4620 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[3] }
            { 1000000136;TextBox;5040 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[4] }
            { 1000000138;TextBox;5430 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[5] }
            { 1000000139;TextBox;5850 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[6] }
            { 1000000140;TextBox;6240 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[7] }
            { 1000000143;TextBox;6660 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[8] }
            { 1000000145;TextBox;7050 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[9] }
            { 1000000147;TextBox;7470 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[10] }
            { 1000000148;TextBox;7860 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[11] }
            { 1000000152;TextBox;8280 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[12] }
            { 1000000154;TextBox;8670 ;30   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[13] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19710;
            SectionHeight=30;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           IF i > 3 THEN
                             CurrReport.SHOWOUTPUT(FALSE);

                           IF OldData THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000030;Shape  ;15   ;0    ;19630;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=No;
            SectionWidth=19710;
            SectionHeight=4260;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE)
                           ELSE
                           IF CurrReport.PAGENO = pNO THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 15  ;Shape        ;19620;0    ;30   ;4230 ;ShapeStyle=VertLine }
            { 16  ;Shape        ;18480;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 17  ;Label        ;9300 ;0    ;4590 ;423  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=รวมยอดเงินได้และภาษีที่นำส่ง }
            { 136 ;Shape        ;14010;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 137 ;Shape        ;14010;500  ;5640 ;30   ;ShapeStyle=HorzLine }
            { 138 ;Shape        ;9180 ;0    ;30   ;4260 ;ShapeStyle=VertLine }
            { 139 ;Label        ;240  ;420  ;7980 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=(1) ให้ระบุว่าจ่ายเป็นค่าอะไร เช่น ค่าเช่าอาคาร ค่าสอบบัญชี }
            { 140 ;Label        ;420  ;840  ;6870 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=ค่าออกแบบ  ค่าก่อสร้างโรงเรียน  ค่าซื้อเครื่องพิมพ์ดีด }
            { 141 ;Label        ;420  ;1260 ;8670 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU="ค่าซื้อพืชผลทางการเกษตร  ( ยางพารา มันสำปะหลัง ปอ ข้าว ฯลฯ) " }
            { 142 ;Label        ;360  ;0    ;3540 ;450  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=หมายเหตุ }
            { 143 ;Shape        ;0    ;0    ;30   ;4260 ;ShapeStyle=VertLine }
            { 144 ;Label        ;420  ;1680 ;8670 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU="ค่าจ้างทำของ ค่าจ้างโฆษณา ดอกเบี้ยเงินฝาก ดอกเบี้ยตั๋วเงิน " }
            { 145 ;Label        ;420  ;2100 ;8670 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU="เงินปันผล เงินส่วนแบ่งของกำไร รางวัลใน การประกวด  การแข่งขัน  " }
            { 146 ;Label        ;420  ;2520 ;8670 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=การชิงโชค  ฯลฯ }
            { 147 ;Label        ;11430;1680 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ลงชื่อ }
            { 148 ;Label        ;18180;1620 ;1350 ;510  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 149 ;Label        ;12830;2310 ;5400 ;423  ;HorzAlign=General;
                                                         VertAlign=Bottom;
                                                         CaptionML=[ENU=.....................................................................;
                                                                    THA=(                  นายสมเกียรตื   วงศาโรจน์              )] }
            { 151 ;Label        ;240  ;3180 ;8850 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=(2) เงื่อนไขการหักภาษี ณ ที่จ่ายให้กรอกดังนี้ }
            { 154 ;Label        ;450  ;3630 ;8640 ;450  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=- หัก ณ ที่จ่าย กรอก 1     - ออกภาษีให้ กรอก 2 }
            { 155 ;Label        ;11470;2970 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ตำแหน่ง }
            { 156 ;Label        ;12740;1710 ;5430 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................. }
            { 158 ;Label        ;11450;3582 ;1250 ;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ยื่นวันที่ }
            { 159 ;Label        ;14020;3582 ;930  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เดือน }
            { 160 ;Label        ;17080;3582 ;870  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=พ.ศ. }
            { 161 ;Label        ;12790;3582 ;1230 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.............. }
            { 162 ;Label        ;14950;3582 ;2130 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=............................... }
            { 163 ;Label        ;17950;3582 ;1650 ;423  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................... }
            { 164 ;Shape        ;15   ;4230 ;19650;30   ;ShapeStyle=HorzLine }
            { 168 ;TextBox      ;14160;0    ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 169 ;TextBox      ;16370;0    ;2040 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 172 ;Shape        ;16320;0    ;30   ;500  ;ShapeStyle=VertLine }
            { 1000000007;Shape  ;9600 ;1980 ;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000008;Label  ;9650 ;2180 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000009;Label  ;9660 ;2460 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000010;Label  ;9650 ;2780 ;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000037;Label  ;12830;2910 ;5490 ;423  ;HorzAlign=General;
                                                         VertAlign=Bottom;
                                                         CaptionML=[ENU=(..................................................................);
                                                                    THA=(                       กรรมการผู้่จัดการ                    )] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(4..));
        OnPreDataItem=BEGIN
                        IF OldData THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > i THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19710;
            SectionHeight=450;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN BEGIN
                             CurrReport.SHOWOUTPUT(FALSE);
                             PageHeight := PageHeight + 450;
                             //IF (8670  - PageHeight) < 450 THEN BEGIN //GKU:#006
                             IF (AllPageHeight  - PageHeight) < 450 THEN BEGIN
                               PageHeight := 0;
                               pNO := pNO + 1;
                             END;
                           END;
                         END;

            OnPostSection=BEGIN
                            IF Integer1.Number <> 1 THEN BEGIN
                              TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT +
                                        WHTBaseAmtLCYExcVAT[Number];
                              TotWHTAmtLCY := TotWHTAmtLCY +
                                        WHTAmtLCY[Number];
                              TotWHTBaseAmtLCYExcVAT2 := TotWHTBaseAmtLCYExcVAT2 +
                                        WHTBaseAmtLCYExcVAT[Number];
                              TotWHTAmtLCY2 := TotWHTAmtLCY2 +
                                        WHTAmtLCY[Number];
                            END;
                          END;

          }
          CONTROLS
          {
            { 1000000000;Shape  ;19620;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000014;Shape  ;18480;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000015;Shape  ;16320;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000019;Shape  ;14010;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000020;Shape  ;13080;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000021;Shape  ;10740;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000022;Shape  ;9180 ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000023;Shape  ;1020 ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000024;Shape  ;0    ;0    ;30   ;450  ;ShapeStyle=VertLine }
            { 1000000025;TextBox;16370;0    ;2040 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[Number] }
            { 1000000026;TextBox;14160;0    ;2100 ;423  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[Number] }
            { 1000000027;TextBox;13140;0    ;870  ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         DecimalPlaces=0:2;
                                                         BlankZero=Yes;
                                                         SourceExpr="WHT%"[Number] }
            { 1000000028;TextBox;10800;0    ;2250 ;423  ;FontName=Tahoma;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19710;
            SectionHeight=30;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000029;Shape  ;15   ;0    ;19630;30   ;ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..4));
        DataItemVarName=Line Space;
        OnPreDataItem=BEGIN
                        IF SNo MOD RecPerPage = 0 THEN
                          CurrReport.BREAK
                        ELSE
                          SETRANGE(Number,1,RecPerPage - (SNo MOD RecPerPage));
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19710;
            SectionHeight=1890;
            OnPreSection=BEGIN
                           IF Integer1.Number = 1 THEN
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000079;Label  ;1740 ;450  ;7440 ;501  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000081;Shape  ;19620;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000085;Shape  ;19620;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000086;Shape  ;16320;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000087;Shape  ;14010;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000088;Shape  ;13080;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000089;Shape  ;10740;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000091;Shape  ;9180 ;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000092;Label  ;1860 ;1020 ;7320 ;480  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000095;Label  ;1110 ;1020 ;750  ;480  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000098;Label  ;1110 ;450  ;630  ;510  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000100;Shape  ;1020 ;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000101;Shape  ;0    ;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000137;Label  ;1860 ;1410 ;7320 ;450  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................... }
            { 1000000141;Shape  ;8487 ;30   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000142;Shape  ;6795 ;30   ;1692 ;423   }
            { 1000000144;Shape  ;8064 ;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000146;Shape  ;7641 ;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000149;Shape  ;7218 ;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000150;Shape  ;6645 ;30   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000151;Shape  ;4953 ;30   ;1692 ;423   }
            { 1000000153;Shape  ;6222 ;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000155;Shape  ;5799 ;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000157;Shape  ;5376 ;30   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000159;Shape  ;4803 ;30   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000160;Shape  ;4380 ;30   ;423  ;423   }
            { 1000000162;Shape  ;18480;0    ;30   ;1890 ;ShapeStyle=VertLine }
            { 1000000163;Shape  ;8610 ;30   ;423  ;423   }
            { 1000000093;Shape  ;0    ;1860 ;19630;30   ;ShapeStyle=HorzLine }
            { 1000000129;Shape  ;9750 ;60   ;423  ;423   }
            { 1000000128;Shape  ;10173;60   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000120;Shape  ;10323;60   ;1692 ;423   }
            { 1000000127;TextBox;10323;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[2] }
            { 1000000125;TextBox;10746;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[3] }
            { 1000000126;Shape  ;10746;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000123;TextBox;11169;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[4] }
            { 1000000124;Shape  ;11169;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000121;TextBox;11592;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[5] }
            { 1000000122;Shape  ;11592;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000119;Shape  ;12015;60   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000099;Shape  ;12165;60   ;1692 ;423   }
            { 1000000113;TextBox;12165;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[6] }
            { 1000000112;TextBox;12588;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[7] }
            { 1000000118;Shape  ;12588;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000106;TextBox;13011;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[8] }
            { 1000000108;Shape  ;13011;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000102;TextBox;13434;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[9] }
            { 1000000104;Shape  ;13434;60   ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000097;Shape  ;13857;60   ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000094;TextBox;14007;60   ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[10] }
            { 1000000096;Shape  ;14007;60   ;423  ;423   }
            { 38  ;Shape        ;14610;90   ;4500 ;423   }
            { 39  ;TextBox      ;18660;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[10] }
            { 41  ;Shape        ;18660;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 40  ;TextBox      ;18210;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[9] }
            { 46  ;Shape        ;18210;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 45  ;TextBox      ;17760;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[8] }
            { 49  ;TextBox      ;17310;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[7] }
            { 50  ;Shape        ;17760;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 53  ;Shape        ;17310;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 52  ;TextBox      ;16860;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[6] }
            { 57  ;TextBox      ;16410;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[5] }
            { 58  ;Shape        ;16860;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 59  ;TextBox      ;15960;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[4] }
            { 60  ;Shape        ;16410;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 62  ;Shape        ;15960;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 64  ;Shape        ;15960;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 63  ;TextBox      ;15510;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[3] }
            { 66  ;Shape        ;15510;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 72  ;TextBox      ;15060;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[2] }
            { 71  ;Shape        ;15060;90   ;30   ;423  ;ShapeStyle=VertLine }
            { 65  ;TextBox      ;14610;90   ;450  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CId[1] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=4620;
      Height=1100;
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1000000000;TextBox;2640 ;110  ;1700 ;440  ;CaptionML=ENU=Branch;
                                                   SourceExpr=BranchNo }
      { 1000000001;Label  ;0    ;110  ;2530 ;440  ;ParentControl=1000000000 }
      { 1000000002;CheckBox;2640;660  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Test Report;
                                                   SourceExpr=PrintTest }
      { 1000000003;Label  ;0    ;660  ;2530 ;440  ;ParentControl=1000000002 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      GLSetup@1000000032 : Record 98;
      CompanyInfo@1000000000 : Record 79;
      Vendor@1000000001 : Record 23;
      WHTRevType@1000000002 : Record 28042;
      WHTBusPostinGrp@1000000041 : Record 28040;
      WHTEntry@1000000035 : Record 28044;
      WHTEntry2@1000000040 : Record 28044;
      NewDocNo@1000000010 : Code[20];
      Name@1000000003 : Text[150];
      Address@1000000004 : Text[250];
      Address2@1000000005 : Text[250];
      City@1000000006 : Text[30];
      VAT@1000000014 : ARRAY [20] OF Code[1];
      SNo@1000000013 : Integer;
      CId@1000000012 : ARRAY [20] OF Code[1];
      i@1000000011 : Integer;
      pNO@1000000008 : Integer;
      PostingDate@1000000009 : Date;
      WHTExpenseText@1000000024 : ARRAY [100] OF Text[30];
      "WHT%"@1000000023 : ARRAY [100] OF Decimal;
      WHTBaseAmtLCYExcVAT@1000000020 : ARRAY [100] OF Decimal;
      WHTAmtLCY@1000000019 : ARRAY [100] OF Decimal;
      TotWHTBaseAmtLCYExcVAT@1000000037 : Decimal;
      TotWHTAmtLCY@1000000036 : Decimal;
      TotWHTBaseAmtLCYExcVAT2@1000000016 : Decimal;
      TotWHTAmtLCY2@1000000015 : Decimal;
      WHTTerm@1000000018 : Text[1];
      PageHeight@1000000028 : Integer;
      OldData@1000000033 : Boolean;
      Branch@1000000038 : ARRAY [4] OF Code[1];
      BranchNo@1000000039 : Text[4];
      MatchType@1000000042 : Boolean;
      ShowData@1000000007 : Boolean;
      PrintTest@1000000021 : Boolean;
      TestText@1000000017 : Text[70];
      PurchInvHeader@1000000022 : Record 122;
      NewVendor@1000000026 : Code[20];
      RecPerPage@1000000025 : Integer;
      AllPageHeight@1000000027 : Decimal;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   Update for version 4.0 TH.
      002   20.06.2005   KKE   Update for 'Dummy Vendor' and 'VAT Registration No. (Dummy)'.
      003   09.08.2006   KKE   Sorting data by Posting Date.
      RichASIA
      004   08.03.2007   KKE   -Show Posting Date from field "WHT Certificate Date" (new field).
      005   07.08.2007   TSA   -Correct report incase of the user not specify "WHT Certificate Date" and
                                  "WHT Certificate No."
      006   10.10.2007   GKU   Modify Orientation of report to Portrait
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50084 Petty Cash Test
{
  OBJECT-PROPERTIES
  {
    Date=02/21/07;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    LeftMargin=1000;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55001;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        OnAfterGetRecord=BEGIN
                           ActualVendNo := '';
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18600;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Petty Cash Test }
            { 1000000002;TextBox;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;17700;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;16950;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18600;
            SectionHeight=7191;
          }
          CONTROLS
          {
            { 1000000008;TextBox;3150 ;0    ;2250 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="No." }
            { 1000000009;Label  ;0    ;0    ;3000 ;423  ;ParentControl=1000000008;
                                                         FontBold=Yes }
            { 1000000011;TextBox;3150 ;423  ;2250 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Petty Cash Vendor No." }
            { 1000000012;Label  ;0    ;423  ;3000 ;423  ;ParentControl=1000000011 }
            { 1000000014;TextBox;3150 ;846  ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Name }
            { 1000000015;Label  ;0    ;846  ;3000 ;423  ;ParentControl=1000000014 }
            { 1000000017;TextBox;3150 ;1269 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Name 2" }
            { 1000000018;Label  ;0    ;1269 ;3000 ;423  ;ParentControl=1000000017 }
            { 1000000020;TextBox;3150 ;1692 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Address }
            { 1000000021;Label  ;0    ;1692 ;3000 ;423  ;ParentControl=1000000020 }
            { 1000000023;TextBox;3150 ;2115 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Address 2" }
            { 1000000024;Label  ;0    ;2115 ;3000 ;423  ;ParentControl=1000000023 }
            { 1000000026;TextBox;3150 ;2538 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Address 3" }
            { 1000000027;Label  ;0    ;2538 ;3000 ;423  ;ParentControl=1000000026 }
            { 1000000029;TextBox;3150 ;2961 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=City }
            { 1000000030;Label  ;0    ;2961 ;3000 ;423  ;ParentControl=1000000029 }
            { 1000000032;TextBox;3150 ;3384 ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Post Code" }
            { 1000000033;Label  ;0    ;3384 ;3000 ;423  ;ParentControl=1000000032 }
            { 1000000035;TextBox;3150 ;3807 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Name (Thai)" }
            { 1000000036;Label  ;0    ;3807 ;3000 ;423  ;ParentControl=1000000035 }
            { 1000000038;TextBox;3150 ;4230 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Address (Thai)" }
            { 1000000039;Label  ;0    ;4230 ;3000 ;423  ;ParentControl=1000000038 }
            { 1000000041;TextBox;3150 ;5076 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Invoice Description" }
            { 1000000042;Label  ;0    ;5076 ;3000 ;423  ;ParentControl=1000000041 }
            { 1000000044;TextBox;3150 ;5499 ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Gen. Bus. Posting Group" }
            { 1000000045;Label  ;0    ;5499 ;3000 ;423  ;ParentControl=1000000044 }
            { 1000000047;TextBox;3150 ;5922 ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="VAT Bus. Posting Group" }
            { 1000000048;Label  ;0    ;5922 ;3000 ;423  ;ParentControl=1000000047 }
            { 1000000050;TextBox;3150 ;6345 ;1500 ;423  ;HorzAlign=Left;
                                                         CaptionML=[ENU=WHT Bus. Posting Group;
                                                                    THA=กลุ่มการลงรายการบัญชีธุรกิจ WHT];
                                                         SourceExpr="WHT Business Posting Group" }
            { 1000000051;Label  ;0    ;6345 ;3000 ;423  ;ParentControl=1000000050 }
            { 1000000053;TextBox;14550;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Posting Date" }
            { 1000000054;Label  ;11400;0    ;3000 ;423  ;ParentControl=1000000053 }
            { 1000000056;TextBox;14550;423  ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Document Date" }
            { 1000000057;Label  ;11400;423  ;3000 ;423  ;ParentControl=1000000056 }
            { 1000000059;TextBox;14550;846  ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Location Code" }
            { 1000000060;Label  ;11400;846  ;3000 ;423  ;ParentControl=1000000059 }
            { 1000000062;TextBox;14550;1269 ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Petty Cash Amount" }
            { 1000000063;Label  ;11400;1269 ;3000 ;423  ;ParentControl=1000000062 }
            { 1000000065;TextBox;14550;1692 ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Balance Amount" }
            { 1000000066;Label  ;11400;1692 ;3000 ;423  ;ParentControl=1000000065 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55002;
        DataItemTableView=SORTING(Document No.,Line No.);
        TotalFields=Amount (LCY) Incl. VAT,VAT Amount (LCY),VAT Base Amount (LCY);
        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18600;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000013;Label  ;0    ;0    ;1500 ;846  ;ParentControl=1000000010;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000019;Label  ;1650 ;0    ;4500 ;846  ;ParentControl=1000000016;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000031;Label  ;10350;0    ;2100 ;846  ;ParentControl=1000000028;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000049;Label  ;12600;0    ;1800 ;846  ;ParentControl=1000000046;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000055;Label  ;6300 ;0    ;1200 ;846  ;ParentControl=1000000052;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000061;Label  ;7650 ;0    ;1200 ;846  ;ParentControl=1000000058;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000067;Label  ;9000 ;0    ;1200 ;846  ;ParentControl=1000000064;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000069;Label  ;16050;0    ;1650 ;846  ;ParentControl=1000000068;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000071;Label  ;17850;0    ;600  ;846  ;ParentControl=1000000070;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000007;Label  ;14550;0    ;1350 ;846  ;ParentControl=1000000000;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18600;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000010;TextBox;0    ;0    ;1500 ;423  ;SourceExpr="No." }
            { 1000000016;TextBox;1650 ;0    ;4500 ;423  ;SourceExpr=Description }
            { 1000000028;TextBox;10350;0    ;2100 ;423  ;CaptionML=[ENU=Amount (LCY) Excl. VAT;
                                                                    THA=ยอดเงิน (LCY)];
                                                         SourceExpr="VAT Base Amount (LCY)" }
            { 1000000046;TextBox;12600;0    ;1800 ;423  ;SourceExpr="VAT Amount (LCY)" }
            { 1000000052;TextBox;6300 ;0    ;1200 ;423  ;SourceExpr="Gen. Prod. Posting Group" }
            { 1000000058;TextBox;7650 ;0    ;1200 ;423  ;SourceExpr="VAT Prod. Posting Group" }
            { 1000000064;TextBox;9000 ;0    ;1200 ;423  ;SourceExpr="WHT Product Posting Group" }
            { 1000000068;TextBox;16050;0    ;1650 ;423  ;SourceExpr="Actual Vendor No." }
            { 1000000070;TextBox;17850;0    ;600  ;423  ;SourceExpr="Skip WHT" }
            { 1000000000;TextBox;14550;0    ;1350 ;423  ;SourceExpr="VAT Difference" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18600;
            SectionHeight=423;
            OnPreSection=BEGIN
                           Remark := CheckPettyCashLine;
                           CurrReport.SHOWOUTPUT := Remark <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000072;TextBox;1650 ;0    ;16800;423  ;FontBold=Yes;
                                                         SourceExpr=Remark }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18600;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000022;TextBox;9600 ;423  ;2850 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Total Excl. VAT;
                                                         SourceExpr="VAT Base Amount (LCY)" }
            { 1000000025;Label  ;6300 ;423  ;3150 ;423  ;ParentControl=1000000022;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000034;TextBox;9600 ;846  ;2850 ;423  ;FontBold=Yes;
                                                         SourceExpr="VAT Amount (LCY)" }
            { 1000000037;Label  ;6300 ;846  ;3150 ;423  ;ParentControl=1000000034;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000040;TextBox;9600 ;1269 ;2850 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Total Incl. VAT;
                                                         SourceExpr="Amount (LCY) Incl. VAT" }
            { 1000000043;Label  ;6300 ;1269 ;3150 ;423  ;ParentControl=1000000040;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=%1 must be specify.';
      Text002@1000000001 : TextConst 'ENU=Actual Vendor No. on Petty Cash Line must not be difference.';
      ActualVendNo@1000000003 : Code[20];
      Remark@1000000002 : Text[250];

    PROCEDURE CheckPettyCashLine@1000000002() : Text[250];
    VAR
      WHTPostingSetup@1000000001 : Record 28043;
    BEGIN
      WITH "Petty Cash Line" DO BEGIN
        IF "VAT %" <> 0 THEN
          IF "Actual Vendor No." = '' THEN
            EXIT(STRSUBSTNO(Text001,FIELDCAPTION("Actual Vendor No.")));

        IF NOT "Skip WHT" THEN BEGIN
          WHTPostingSetup.GET("WHT Business Posting Group","WHT Product Posting Group");
          IF WHTPostingSetup."WHT %" <> 0 THEN BEGIN
            IF "Actual Vendor No." = '' THEN
              EXIT(STRSUBSTNO(Text001,FIELDCAPTION("Actual Vendor No.")));
            IF "Petty Cash Header"."Printing WHT Slip (Doc:WHT)" = "Petty Cash Header"."Printing WHT Slip (Doc:WHT)"::"1:1"
       THEN BEGIN
              IF ActualVendNo = '' THEN
                ActualVendNo := "Actual Vendor No."
              ELSE
                IF ActualVendNo <> "Actual Vendor No." THEN
                  EXIT(Text002);
            END;
          END;
        END;
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.08.2006   KKE   -Petty Cash
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50085 Purchase Voucher - Petty Cash
{
  OBJECT-PROPERTIES
  {
    Date=10/12/07;
    Time=[ 2:44:13 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  CompanyInfo.GET;
                  CompanyInfo.CALCFIELDS(Picture);
                  GLSetup.GetShortcutDimCode(ShortcutDimCode);
                  IF ShortcutDimCode[2] = 'DEPARTMENT' THEN
                    ShortcutDimCode[2] := 'DEPT.';
                END;

    PaperSize=A4 210 x 297 mm;
    HorzGrid=50;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55001;
        DataItemTableView=SORTING(No.);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(DrAmount,CrAmount);
                      END;

        OnAfterGetRecord=BEGIN
                           CLEAR(AccCode);
                           CLEAR(AccName);
                           CLEAR(Dimension1Code);
                           CLEAR(Dimension2Code);
                           CLEAR(Dimension3Code);
                           CLEAR(Dimension4Code);
                           CLEAR(Dimension5Code);
                           CLEAR(DrAmount);
                           CLEAR(CrAmount);
                           CLEAR(TotalDrAmount);
                           CLEAR(TotalCrAmount);
                           CLEAR(WHTCode);
                           CLEAR(WHTName);
                           CLEAR(WHTCrAmount);

                           InvDescription := "Invoice Description";
                           PostingDate := "Posting Date";
                           DocumentNo := "No.";
                         END;

        ReqFilterFields=No.;
        GroupTotalFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19450;
            SectionHeight=6100;
            OnPreSection=BEGIN
                           CntLine := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000094;Label  ;13400;2600 ;5800 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PRE-POST................................................. }
            { 1000000000;TextBox;13250;100  ;5950 ;850  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000067;Label  ;13400;3200 ;5800 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=POSTED.................................................... }
            { 1000000068;TextBox;15300;2600 ;2950 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="No." }
            { 1000000069;Label  ;13400;3750 ;5800 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DATE......................................................... }
            { 1000000070;TextBox;14550;3750 ;3700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Posting Date" }
            { 1000000072;Label  ;7400 ;1300 ;5350 ;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=PETTY CASH VOUCHER }
            { 1000000073;Shape  ;10   ;4980 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000074;Label  ;16600;5265 ;2600 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=CREDIT }
            { 1000000075;Shape  ;16450;4985 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000076;Label  ;13850;5265 ;2600 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT }
            { 1000000077;Shape  ;7750 ;4985 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000078;Shape  ;6350 ;4985 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000079;Shape  ;2450 ;4985 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000080;Label  ;2600 ;5250 ;3750 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ACCOUNT NAME }
            { 1000000081;Label  ;100  ;5265 ;2350 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ACCOUNT CODE }
            { 1000000082;Shape  ;10   ;6070 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000083;Shape  ;19250;4985 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000084;Shape  ;0    ;4985 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000085;Shape  ;9150 ;4985 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000086;TextBox;6500 ;5300 ;1250 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ShortcutDimCode[1] }
            { 1000000087;TextBox;7900 ;5315 ;1250 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ShortcutDimCode[2] }
            { 1000000093;Shape  ;13700;4985 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000024;Label  ;13400;4350 ;5800 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PRINTED DATE......................................... }
            { 1000000046;TextBox;15700;4335 ;3300 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=TODAY }
            { 1000000121;Label  ;150  ;3200 ;1500 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PAY TO : }
            { 1000000122;TextBox;1650 ;3200 ;11700;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr="Name 2" }
            { 1000000089;Label  ;9300 ;5265 ;4400 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DESCRIPTION }
            { 1000000055;TextBox;2650 ;3800 ;10700;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr="Petty Cash Vendor No." + '  ' + Name }
            { 1000000056;Label  ;150  ;3800 ;2500 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PETTY VENDOR : }
            { 1000000065;TextBox;3200 ;4400 ;10150;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr="Invoice Description" }
            { 1000000088;Label  ;150  ;4400 ;3050 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=Invoice Description : }
            { 1000000014;TextBox;13250;900  ;5950 ;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000038;TextBox;200  ;1900 ;7050 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr='Tel: ' + CompanyInfo."Phone No." + ' Fax: ' + CompanyInfo."Fax No." }
            { 1000000041;TextBox;200  ;1300 ;7050 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000042;TextBox;200  ;700  ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" }
            { 1000000071;TextBox;200  ;0    ;9700 ;700  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19450;
            SectionHeight=3915;
            OnPreSection=BEGIN
                           CheckReport.InitTextVariable;
                           CheckReport.FormatNoText(TextAmount,ABS(TotalDrAmount),"Currency Code");

                           IF TextAmount[1] <> '' THEN
                             TextAmount[1] := '(' + TextAmount[1] + ')';
                         END;

          }
          CONTROLS
          {
            { 1000000025;Label  ;12300;100  ;1400 ;600  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000026;TextBox;16550;100  ;2600 ;600  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=CREDIT;
                                                         SourceExpr=TotalCrAmount }
            { 1000000027;TextBox;13850;100  ;2600 ;600  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=TotalDrAmount }
            { 1000000028;Shape  ;19250;0    ;30   ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000029;Shape  ;16450;0    ;150  ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000030;Shape  ;13700;0    ;150  ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000031;Shape  ;0    ;0    ;30   ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000032;Shape  ;10   ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000001;Shape  ;19250;1115 ;30   ;2785 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000016;Shape  ;10100;1100 ;30   ;2785 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000018;Shape  ;0    ;1115 ;30   ;2785 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000033;Shape  ;10   ;1100 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000034;Shape  ;10   ;1800 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000035;Shape  ;10   ;3885 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000036;Label  ;10550;1100 ;8250 ;600  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved By }
            { 1000000037;Label  ;400  ;1100 ;9265 ;600  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By }
            { 1000000039;Label  ;400  ;2600 ;9250 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_____________________________ }
            { 1000000040;Label  ;400  ;3250 ;9200 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_________/_________/_________ }
            { 1000000043;Label  ;10550;2600 ;8280 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_____________________________ }
            { 1000000044;Label  ;10550;3250 ;8280 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_________/_________/_________ }
            { 1000000045;Shape  ;10   ;780  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000090;TextBox;100  ;100  ;12100;600  ;FontSize=9;
                                                         SourceExpr=TextAmount[1] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55002;
        DataItemTableView=SORTING(Document No.,Line No.)
                          WHERE(Type=FILTER(<>' '));
        OnAfterGetRecord=BEGIN
                           CLEAR(AccountNo);
                           CASE Type OF
                             Type::"G/L Account":
                               BEGIN
                                 AccountNo := "No.";
                               END;
                             ELSE
                               EXIT;
                           END;

                           IF NOT GLAcc.GET(AccountNo) THEN
                             GLAcc.INIT;

                           ShortcutDim3Code := '';
                           ShortcutDim4Code := '';
                           ShortcutDim5Code := '';
                           IF DocumentDim.GET(
                               DATABASE::"Petty Cash Line",
                               DocumentDim."Document Type"::Invoice,
                               "Document No.","Line No.",
                               ShortcutDimCode[3])
                           THEN
                             ShortcutDim3Code := DocumentDim."Dimension Value Code";
                           IF DocumentDim.GET(
                               DATABASE::"Petty Cash Line",
                               DocumentDim."Document Type"::Invoice,
                               "Document No.","Line No.",
                               ShortcutDimCode[4])
                           THEN
                             ShortcutDim4Code := DocumentDim."Dimension Value Code";
                           IF DocumentDim.GET(
                               DATABASE::"Petty Cash Line",
                               DocumentDim."Document Type"::Invoice,
                               "Document No.","Line No.",
                               ShortcutDimCode[5])
                           THEN
                             ShortcutDim5Code := DocumentDim."Dimension Value Code";

                           i := 0;
                           MatchAcc := FALSE;
                           REPEAT
                             i := i + 1;
                             IF ((AccCode[i] = AccountNo) AND
                                 (LineDescription[i] = Description) AND
                                 (Dimension1Code[i] = "Shortcut Dimension 1 Code") AND
                                 (Dimension2Code[i] = "Shortcut Dimension 2 Code") AND
                                 (Dimension3Code[i] = ShortcutDim3Code) AND
                                 (Dimension4Code[i] = ShortcutDim4Code) AND
                                 (Dimension5Code[i] = ShortcutDim5Code))
                                OR (AccCode[i] = '')
                             THEN
                               MatchAcc := TRUE;
                           UNTIL (i=200) OR MatchAcc;

                           AccCode[i] := AccountNo;
                           AccName[i] := GLAcc.Name;
                           LineDescription[i] := Description;
                           Dimension1Code[i] := "Shortcut Dimension 1 Code";
                           Dimension2Code[i] := "Shortcut Dimension 2 Code";
                           Dimension3Code[i] := ShortcutDim3Code;
                           Dimension4Code[i] := ShortcutDim4Code;
                           Dimension5Code[i] := ShortcutDim5Code;
                           //KKE : #002 +
                           IF "Avg. VAT Amount" <> 0 THEN BEGIN
                             IF "Amount Incl. VAT" - "Avg. VAT Amount" >= 0 THEN
                               DrAmount[i] := DrAmount[i] + "Amount Incl. VAT" - "Avg. VAT Amount"
                             ELSE
                               CrAmount[i] := CrAmount[i] - ("Amount Incl. VAT" - "Avg. VAT Amount");
                           END ELSE BEGIN
                           //KKE : #002 -
                             IF "VAT Base Amount (LCY)" >= 0 THEN
                               DrAmount[i] := DrAmount[i] + "VAT Base Amount (LCY)"
                             ELSE
                               CrAmount[i] := CrAmount[i] - "VAT Base Amount (LCY)";
                           END;

                           // VAT
                           CLEAR(AccountNo);
                           VATPostingSetup.GET("VAT Bus. Posting Group","VAT Prod. Posting Group");
                           IF VATPostingSetup."Purch. VAT Unreal. Account" <> '' THEN
                             AccountNo := VATPostingSetup."Purch. VAT Unreal. Account"
                           ELSE
                             AccountNo := VATPostingSetup."Purchase VAT Account";
                           IF NOT GLAcc.GET(AccountNo) THEN
                             GLAcc.INIT;

                           i := 0;
                           MatchAcc := FALSE;
                           REPEAT
                             i := i + 1;
                             IF ((AccCode[i] = AccountNo) AND
                                 (Dimension1Code[i] = "Shortcut Dimension 1 Code") AND
                                 (Dimension2Code[i] = "Shortcut Dimension 2 Code") AND
                                 (Dimension3Code[i] = ShortcutDim3Code) AND
                                 (Dimension4Code[i] = ShortcutDim4Code) AND
                                 (Dimension5Code[i] = ShortcutDim5Code))
                                OR (AccCode[i] = '')
                             THEN
                               MatchAcc := TRUE;
                           UNTIL (i=200) OR MatchAcc;
                           AccCode[i] := AccountNo;
                           AccName[i] := GLAcc.Name;
                           Dimension1Code[i] := "Shortcut Dimension 1 Code";
                           Dimension2Code[i] := "Shortcut Dimension 2 Code";
                           Dimension3Code[i] := ShortcutDim3Code;
                           Dimension4Code[i] := ShortcutDim4Code;
                           Dimension5Code[i] := ShortcutDim5Code;
                           //KKE : #002 +
                           IF "Avg. VAT Amount" <> 0 THEN BEGIN
                             IF "Avg. VAT Amount" >= 0 THEN
                               DrAmount[i] := DrAmount[i] + "Avg. VAT Amount"
                             ELSE
                               CrAmount[i] := CrAmount[i] - "Avg. VAT Amount";
                           END ELSE BEGIN
                           //KKE : #002 -
                             IF "VAT Amount (LCY)" + "VAT Difference" >= 0 THEN
                               DrAmount[i] := DrAmount[i] + "VAT Amount (LCY)" + "VAT Difference"
                             ELSE
                               CrAmount[i] := CrAmount[i] - ("VAT Amount (LCY)" + "VAT Difference");
                           END;

                           // WHT
                           IF NOT "Skip WHT" THEN BEGIN
                             WHTPostingSetup.GET("WHT Business Posting Group","WHT Product Posting Group");
                             IF WHTPostingSetup."WHT %" <> 0 THEN BEGIN
                               WHTPostingSetup.TESTFIELD("Payable WHT Account Code");
                               AccountNo := WHTPostingSetup."Payable WHT Account Code";
                               IF NOT GLAcc.GET(AccountNo) THEN
                                 GLAcc.INIT;
                               i := 0;
                               MatchAcc := FALSE;
                               REPEAT
                                 i := i + 1;
                                 IF (WHTCode[i] = AccountNo) OR (WHTCode[i] = '') THEN
                                   MatchAcc := TRUE;
                               UNTIL (i=200) OR MatchAcc;
                               WHTCode[i] := AccountNo;
                               WHTName[i] := GLAcc.Name;
                               IF "WHT Absorb Base" = 0 THEN
                                 WHTCrAmount[i] := WHTCrAmount[i] + ROUND("VAT Base Amount (LCY)" * WHTPostingSetup."WHT %" /100)
                               ELSE
                                 WHTCrAmount[i] := WHTCrAmount[i] + ROUND("WHT Absorb Base" * WHTPostingSetup."WHT %" /100);
                             END;
                           END;
                         END;

        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=Detail;
        OnPreDataItem=BEGIN
                        Vendor.GET("Petty Cash Header"."Petty Cash Vendor No.");
                        VendPostingGrp.GET(Vendor."Vendor Posting Group");
                        IF NOT GLAcc.GET(VendPostingGrp."Payables Account") THEN
                          GLAcc.INIT;

                        ShortcutDim3Code := '';
                        ShortcutDim4Code := '';
                        ShortcutDim5Code := '';
                        IF DocumentDim.GET(
                            DATABASE::"Petty Cash Header",
                            DocumentDim."Document Type"::Invoice,
                            "Petty Cash Header"."No.",0,
                            ShortcutDimCode[3])
                        THEN
                          ShortcutDim3Code := DocumentDim."Dimension Value Code";
                        IF DocumentDim.GET(
                            DATABASE::"Petty Cash Header",
                            DocumentDim."Document Type"::Invoice,
                            "Petty Cash Header"."No.",0,
                            ShortcutDimCode[4])
                        THEN
                          ShortcutDim4Code := DocumentDim."Dimension Value Code";
                        IF DocumentDim.GET(
                            DATABASE::"Petty Cash Header",
                            DocumentDim."Document Type"::Invoice,
                            "Petty Cash Header"."No.",0,
                            ShortcutDimCode[5])
                        THEN
                          ShortcutDim5Code := DocumentDim."Dimension Value Code";

                        MatchAcc := FALSE;
                        i := 0;
                        REPEAT
                          i := i + 1;
                          IF ((AccCode[i] =  VendPostingGrp."Payables Account") AND
                              (Dimension1Code[i] = "Petty Cash Header"."Shortcut Dimension 1 Code") AND
                              (Dimension2Code[i] = "Petty Cash Header"."Shortcut Dimension 2 Code") AND
                              (Dimension3Code[i] = ShortcutDim3Code) AND
                              (Dimension4Code[i] = ShortcutDim4Code) AND
                              (Dimension5Code[i] = ShortcutDim5Code))
                             OR (AccCode[i] = '')
                          THEN
                            MatchAcc := TRUE
                        UNTIL (i=200) OR MatchAcc;

                        AccCode[i] := VendPostingGrp."Payables Account";
                        AccName[i] := GLAcc.Name;
                        Dimension1Code[i] := "Petty Cash Header"."Shortcut Dimension 1 Code";
                        Dimension2Code[i] := "Petty Cash Header"."Shortcut Dimension 2 Code";
                        Dimension3Code[i] := ShortcutDim3Code;
                        Dimension4Code[i] := ShortcutDim4Code;
                        Dimension5Code[i] := ShortcutDim5Code;

                        FOR j := 1 TO 200 DO BEGIN
                          IF i <> j THEN
                            CrAmount[i] := CrAmount[i] + DrAmount[j] - CrAmount[j] - WHTCrAmount[j]
                          ELSE
                            CrAmount[i] := CrAmount[i] + DrAmount[j];
                        END;
                        IF CrAmount[i] < 0 THEN BEGIN
                          DrAmount[i] := -CrAmount[i];
                          CrAmount[i] := 0;
                        END;

                        {---
                        //Incase Purchase Credit Memo.
                        IF "Purchase Header"."Document Type" = "Purchase Header"."Document Type"::"Credit Memo" THEN BEGIN
                          i := 27;
                          j := 0;
                          REPEAT
                            IF AccCode[i] <> '' THEN BEGIN
                              j := j + 1;
                              CrMemoAccCode[j] := AccCode[i];
                              CrMemoAccName[j] := AccName[i];
                              CrMemoDim1Code[i] := Dimension1Code[i];
                              CrMemoDim2Code[i] := Dimension2Code[i];
                              CrMemoDim3Code[i] := Dimension3Code[i];
                              CrMemoDim4Code[i] := Dimension4Code[i];
                              CrMemoDim5Code[i] := Dimension5Code[i];
                              IF CrAmount[i] <> 0 THEN
                                CrMemoDrAmount[j] := CrAmount[i]
                              ELSE
                                CrMemoCrAmount[j] := DrAmount[i];
                            END;
                            i := i - 1;
                          UNTIL i=0;
                          CLEAR(AccCode);
                          CLEAR(AccName);
                          CLEAR(DrAmount);
                          CLEAR(CrAmount);
                          FOR i:=1 TO j DO BEGIN
                            AccCode[i] := CrMemoAccCode[i];
                            AccName[i] := CrMemoAccName[i];
                            Dimension1Code[i] := CrMemoDim1Code[i];
                            Dimension2Code[i] := CrMemoDim2Code[i];
                            Dimension3Code[i] := CrMemoDim3Code[i];
                            Dimension4Code[i] := CrMemoDim4Code[i];
                            Dimension5Code[i] := CrMemoDim5Code[i];
                            DrAmount[i] := CrMemoDrAmount[i];
                            CrAmount[i] := CrMemoCrAmount[i];
                          END;
                        END;
                        ---}
                      END;

        OnAfterGetRecord=BEGIN
                           IF AccCode[Number] = '' THEN
                             CurrReport.BREAK;

                           IF (DrAmount[Number] = 0) AND (CrAmount[Number] = 0) THEN
                             CurrReport.SKIP;

                           CntLine += 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=500;
            OnPreSection=BEGIN
                           IF (DrAmount[Number] <> 0) AND (CrAmount[Number] <> 0) THEN
                             IF DrAmount[Number] > CrAmount[Number] THEN BEGIN
                               DrAmount[Number] := DrAmount[Number] - CrAmount[Number];
                               CrAmount[Number] := 0;
                             END ELSE BEGIN
                               CrAmount[Number] := CrAmount[Number] - DrAmount[Number];
                               DrAmount[Number] := 0;
                             END;

                           TotalDrAmount := TotalDrAmount + DrAmount[Number];
                           TotalCrAmount := TotalCrAmount + CrAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000003;TextBox;100  ;0    ;2350 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=AccCode[Number] }
            { 1000000005;TextBox;2600 ;0    ;3750 ;500  ;FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr=AccName[Number] }
            { 1000000006;TextBox;13850;0    ;2600 ;500  ;FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=DrAmount[Number] }
            { 1000000007;TextBox;16600;0    ;2600 ;500  ;FontSize=9;
                                                         CaptionML=ENU=CREDIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=CrAmount[Number] }
            { 1000000008;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000009;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000010;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000011;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000012;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000049;TextBox;7900 ;0    ;1250 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=Dimension2Code[Number] }
            { 1000000095;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000096;TextBox;6500 ;0    ;1250 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=Dimension1Code[Number] }
            { 1000000097;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000099;TextBox;9300 ;0    ;4400 ;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=LineDescription[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=WHT;
        OnAfterGetRecord=BEGIN
                           IF WHTCode[Number] = '' THEN
                            CurrReport.BREAK;

                           CntLine += 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := WHTCrAmount[Number] < 0;
                           IF CurrReport.SHOWOUTPUT THEN
                             TotalDrAmount := TotalDrAmount - WHTCrAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000002;TextBox;100  ;0    ;2350 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=WHTCode[Number] }
            { 1000000015;TextBox;13850;0    ;2600 ;500  ;FontSize=9;
                                                         CaptionML=ENU=CREDIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTCrAmount[Number] }
            { 1000000017;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000019;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000020;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000021;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000022;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000023;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000053;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000054;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000123;TextBox;2600 ;0    ;3750 ;500  ;FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr=WHTName[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := WHTCrAmount[Number] > 0;
                           IF CurrReport.SHOWOUTPUT THEN
                             TotalCrAmount := TotalCrAmount + WHTCrAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000004;TextBox;100  ;0    ;2350 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=WHTCode[Number] }
            { 1000000013;TextBox;16600;0    ;2600 ;500  ;FontSize=9;
                                                         CaptionML=ENU=CREDIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTCrAmount[Number] }
            { 1000000057;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000058;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000059;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000060;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000061;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000062;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000063;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000064;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000124;TextBox;2600 ;0    ;3750 ;500  ;FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr=WHTName[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Description1;
        OnAfterGetRecord=BEGIN
                           CntLine += 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000047;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000050;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000066;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000112;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000113;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000114;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000115;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000116;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=Line Loop;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,30 - CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000051;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000052;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000104;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000105;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000106;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000107;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000108;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000109;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000000 : Record 79;
      Vendor@1000000027 : Record 23;
      VendPostingGrp@1000000015 : Record 93;
      GenPostingSetup@1000000016 : Record 252;
      VATPostingSetup@1000000018 : Record 325;
      WHTPostingSetup@1000000020 : Record 28043;
      PurchLine@1000000014 : Record 39;
      GLSetup@1000000034 : Record 98;
      GLAcc@1000 : Record 15;
      DocumentDim@1000000004 : Record 357;
      InventoryPostingSetup@1000000021 : Record 5813;
      InvDescription@1000000001 : Text[250];
      DocumentNo@1000000002 : Code[20];
      PostingDate@1000000003 : Date;
      AccountNo@1000000017 : Code[20];
      AccCode@1000000005 : ARRAY [200] OF Code[20];
      AccName@1000000006 : ARRAY [200] OF Text[50];
      DrAmount@1000000008 : ARRAY [200] OF Decimal;
      CrAmount@1000000009 : ARRAY [200] OF Decimal;
      TotalDrAmount@1000000012 : Decimal;
      TotalCrAmount@1000000011 : Decimal;
      MatchAcc@1000000013 : Boolean;
      i@1000000010 : Integer;
      j@1000000019 : Integer;
      WHTCode@1000000026 : ARRAY [200] OF Code[20];
      WHTName@1000000048 : ARRAY [200] OF Text[50];
      WHTCrAmount@1000000022 : ARRAY [200] OF Decimal;
      CrMemoAccCode@1000000029 : ARRAY [200] OF Code[20];
      CrMemoAccName@1000000028 : ARRAY [200] OF Text[50];
      CrMemoDrAmount@1000000025 : ARRAY [200] OF Decimal;
      CrMemoCrAmount@1000000023 : ARRAY [200] OF Decimal;
      Dimension1Code@1000000043 : ARRAY [200] OF Code[20];
      Dimension2Code@1000000042 : ARRAY [200] OF Code[20];
      Dimension3Code@1000000041 : ARRAY [200] OF Code[20];
      Dimension4Code@1000000040 : ARRAY [200] OF Code[20];
      Dimension5Code@1000000039 : ARRAY [200] OF Code[20];
      ShortcutDimCode@1000000033 : ARRAY [8] OF Code[20];
      ShortcutDim1Code@1000000036 : Code[20];
      ShortcutDim2Code@1000000035 : Code[20];
      ShortcutDim3Code@1000000032 : Code[20];
      ShortcutDim4Code@1000000031 : Code[20];
      ShortcutDim5Code@1000000030 : Code[20];
      CrMemoDim1Code@1000000047 : ARRAY [200] OF Code[20];
      CrMemoDim2Code@1000000046 : ARRAY [200] OF Code[20];
      CrMemoDim3Code@1000000045 : ARRAY [200] OF Code[20];
      CrMemoDim4Code@1000000044 : ARRAY [200] OF Code[20];
      CrMemoDim5Code@1000000038 : ARRAY [200] OF Code[20];
      LineDescription@1000000049 : ARRAY [200] OF Text[50];
      CntLine@1000000037 : Integer;
      FALedgEntry@1000000024 : Record 5601;
      FAGetGLAccNo@1000000007 : Codeunit 5602;
      FormatAddr@1000000050 : Codeunit 365;
      CheckReport@1000000052 : Report 1401;
      TextAmount@1000000051 : ARRAY [2] OF Text[250];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   16.08.2006   KKE   Petty Cash
      Burda
      002   30.08.2007   KKE   Average VAT
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50086 FORM 50 BIS -Petty Cash
{
  OBJECT-PROPERTIES
  {
    Date=11/28/11;
    Time=[ 4:27:13 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=500;
    BottomMargin=500;
    LeftMargin=500;
    RightMargin=200;
    OnInitReport=BEGIN
                   NumberOfCopy := 1;
                   PaymentOption := 2 ;
                 END;

    OnPreReport=BEGIN
                  IF CompanyInfo.GET THEN BEGIN
                    FOR i := 1 TO STRLEN(CompanyInfo."VAT Registration No.") DO
                      CID[i] := COPYSTR(CompanyInfo."VAT Registration No.",i,1);
                    //KKE : #002 +
                    IF CompanyInfo."Phone No." <> '' THEN
                      CompanyPhone := 'Tel. ' + CompanyInfo."Phone No.";
                    //KKE : #002 -
                    CompanyInfo.CALCFIELDS(Picture);
                  END;

                  //KKE : #002 +
                  FOR i := 1 TO STRLEN(ConductVATID) DO
                    CCID[i] := COPYSTR(ConductVATID,i,1);

                  FOR i := 1 TO STRLEN(ConductID) DO
                    ID2[i] := COPYSTR(ConductID,i,1);

                  FOR i := 1 TO STRLEN(EmployerAccount) DO
                    EID[i] := COPYSTR(EmployerAccount,i,1);

                  FOR i := 1 TO STRLEN(SocialID) DO
                    SoID[i] := COPYSTR(SocialID,i,1);
                  //KKE : #002 -

                  IF NumberOfCopy > 4 THEN
                    ERROR('Number of copies shouldnot be more than 4.');

                  GLSetup.GET;
                  PurchSetup.GET;

                  CLEAR(WHTTerm);
                  CASE PaymentOption OF
                    0 : WHTTerm[1] := 'P';
                    1 : WHTTerm[2] := 'P';
                    2 : WHTTerm[3] := 'P';
                    3 : WHTTerm[4] := 'P';
                  END;
                END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=50;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55001;
        OnAfterGetRecord=BEGIN
                           CLEAR(ActualVendorNo);
                           CLEAR(WHTSlipNo);
                           CLEAR(Name);
                           CLEAR(Address);
                           CLEAR(Phone);  //KKE : #002
                           CLEAR(VAT);
                           CLEAR(WHTGroup);
                           CLEAR(WHTPostingDate);
                           CLEAR(WHTExpenseText);
                           CLEAR(WHTBaseAmtLCYExcVAT);
                           CLEAR(WHTAmtLCY);
                           CLEAR(TotWHTBaseAmtLCYExcVAT);
                           CLEAR(TotWHTAmtLCY);
                           //CLEAR(PostingDate);
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55002;
        DataItemTableView=SORTING(Actual Vendor No.,WHT Business Posting Group,WHT Product Posting Group)
                          WHERE(Actual Vendor No.=FILTER(<>''),
                                Amount Incl. VAT=FILTER(<>0),
                                Skip WHT=CONST(No));
        OnAfterGetRecord=BEGIN
                           IF ActualVendorNo = "Actual Vendor No." THEN
                             CurrReport.SKIP;

                           CLEAR(WHTSlipNo);
                           CLEAR(VAT);
                           CLEAR(WHTGroup);
                           CLEAR(WHTExpenseText);
                           CLEAR(WHTPostingDate);
                           CLEAR(WHTAmtLCY);
                           CLEAR(WHTBaseAmtLCYExcVAT);
                           CLEAR(TotWHTBaseAmtLCYExcVAT);
                           CLEAR(TotWHTAmtLCY);

                           ActualVendorNo := "Actual Vendor No.";

                           Vendor.GET("Actual Vendor No.");
                           IF Vendor."Name (Thai)" <> '' THEN BEGIN
                             Name := Vendor."Name (Thai)";
                             Address := Vendor."Address (Thai)";
                           END ELSE BEGIN
                             Name := Vendor.Name + Vendor."Name 2";
                             Address := Vendor.Address + ' ' + Vendor."Address 2" + ' ' + Vendor."Address 3";
                           END;
                           //KKE : #002 +
                           IF Vendor."Phone No." <> '' THEN
                             Phone := 'Tel. ' + Vendor."Phone No.";
                           FOR i := 1 TO 13 DO
                             ID3[i] := COPYSTR(Vendor."ID No.",i,1);
                           //KKE : #002 -
                           FOR i := 1 TO STRLEN(Vendor."VAT Registration No.") DO
                             VAT[i] := COPYSTR(Vendor."VAT Registration No.",i,1);

                           //WHTBusPostingGrp.GET("Petty Cash Header"."WHT Business Posting Group");
                           WHTBusPostingGrp.GET("WHT Business Posting Group");

                           PettyCashLine.RESET;
                           PettyCashLine.SETRANGE("Document No.","Document No.");
                           PettyCashLine.SETRANGE("Actual Vendor No.",ActualVendorNo);
                           PettyCashLine.SETRANGE("Skip WHT",FALSE);
                           PettyCashLine.SETFILTER("Amount (LCY) Incl. VAT",'<>0');
                           IF PettyCashLine.FIND('-') THEN
                             REPEAT
                               IF CalcWHTEntry(PettyCashLine) THEN
                                 IF (PettyCashLine."WHT Certificate No." = '') THEN BEGIN
                                   IF WHTSlipNo = '' THEN
                                     IF WHTBusPostingGrp."WHT Certificate No. Series" <> '' THEN
                                      WHTSlipNo := NoSeriesMgt.GetNextNo(WHTBusPostingGrp."WHT Certificate No. Series","Petty Cash Header"."Posting Date",TRUE)
                                     ELSE
                                       WHTSlipNo := NoSeriesMgt.GetNextNo(PurchSetup."WHT Certificate No. Series","Petty Cash Header"."Posting Date",TRUE);
                                   PettyCashLine."WHT Certificate No." := WHTSlipNo;
                                   PettyCashLine."Certificate Printed" := TRUE;
                                   PettyCashLine.MODIFY;
                                 END ELSE BEGIN
                                   WHTSlipNo := PettyCashLine."WHT Certificate No.";
                                   PettyCashLine."Certificate Printed" := TRUE;
                                   PettyCashLine.MODIFY;
                                 END;
                             UNTIL PettyCashLine.NEXT=0;
                         END;

        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..4));
        OnPreDataItem=BEGIN
                        IF TotWHTAmtLCY = 0 THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > NumberOfCopy THEN
                             CurrReport.BREAK;

                           WHTAmtLCYText := Form50BIS.FormatNoThaiText(TotWHTAmtLCY);
                           IF WHTAmtLCYText <> '' THEN
                             WHTAmtLCYText := '(' + WHTAmtLCYText + ')';
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=1400;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FALSE;
                         END;

          }
          CONTROLS
          {
            { 1000000041;PictureBox;0 ;0    ;3780 ;1400 ;HorzGlue=Both;
                                                         SourceExpr=CompanyInfo.Picture }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=26000;
          }
          CONTROLS
          {
            { 1000000000;Shape  ;150  ;9150 ;19100;16000;Visible=Yes }
            { 1000000001;Shape  ;6627 ;22600;423  ;423   }
            { 1000000002;Shape  ;18703;5850 ;423  ;423   }
            { 1000000004;Shape  ;18703;3350 ;423  ;423   }
            { 1000000005;Shape  ;13150;900  ;423  ;423   }
            { 1000000006;TextBox;18703;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[13] }
            { 1000000007;Shape  ;13693;900  ;1692 ;423   }
            { 1000000008;Shape  ;15505;900  ;2115 ;423   }
            { 1000000009;Shape  ;16865;6350 ;1692 ;423   }
            { 1000000010;TextBox;17711;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[8] }
            { 1000000011;Shape  ;16865;3850 ;1692 ;423   }
            { 1000000012;Shape  ;15023;6350 ;1692 ;423   }
            { 1000000013;Shape  ;15023;3850 ;1692 ;423   }
            { 1000000014;Shape  ;14450;3850 ;423  ;423   }
            { 1000000015;Shape  ;0    ;0    ;19400;26000;ShapeStyle=Rectangle }
            { 1000000016;Shape  ;150  ;20100;19100;30   ;ShapeStyle=HorzLine }
            { 1000000017;Label  ;300  ;19627;1750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=6. อื่นๆ (ระบุ) }
            { 1000000018;Label  ;8590 ;20162;4430 ;538  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมเงินที่จ่ายและภาษีที่หักนำส่ง }
            { 1000000019;Label  ;1620 ;25550;17690;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ผู้มีหน้าที่ออกหนังสือรับรองการหักภาษี ณ ที่จ่าย ฝ่าฝืนไม่ปฏิบัติตามมาตรา 50 ทวิ แห่งประมวลรัษฎากร ต้องรับโทษทางอาญาตามมาตรา 35 แห่งประมวลรัษฎากร }
            { 1000000020;Shape  ;150  ;9990 ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000021;Shape  ;150  ;5700 ;19100;3350 ;ShapeStyle=Rectangle }
            { 1000000022;Shape  ;150  ;800  ;19100;2350 ;ShapeStyle=Rectangle }
            { 1000000023;Label  ;350  ;5750 ;5050 ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ผู้ถูกหักภาษี ณ ที่จ่าย : }
            { 1000000024;Label  ;400  ;8000 ;1200 ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ลำดับที่ }
            { 1000000025;Label  ;300  ;10050;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=1. เงินเดือน ค่าจ้าง เบี้ยเลี้ยง โบนัส ฯลฯ ตามมาตรา 40 (1) }
            { 1000000026;Label  ;300  ;10450;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=2. ค่าธรรมเนียม ค่านายหน้า ฯลฯ ตามมาตรา 40 (2) }
            { 1000000027;Label  ;300  ;10850;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=3. ค่าแห่งลิขสิทธิ์ฯลฯ ตามมาตรา 40 (3) }
            { 1000000028;Label  ;300  ;11250;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=4. (ก)  ค่าดอกเบี้ย ฯลฯ ตามมาตรา 40 (4) ก }
            { 1000000029;Label  ;650  ;11650;8850 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ข) เงินปันผล เงินส่วนแบ่งกำไร ฯลฯ ตามมาตรา 40 (4) (ข) ที่จ่ายจาก }
            { 1000000030;Label  ;300  ;18050;10050;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=5. การจ่ายเงินได้ที่ต้องหักภาษี ณ ที่จ่ายตามคำสั่งกรมสรรพากรที่ออกตามมาตรา }
            { 1000000031;Label  ;600  ;18450;9750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=3 เตรส เช่น รางวัล ส่วนลดหรือประโยชน์ใดๆ เนื่องจากการส่งเสริมการขาย }
            { 1000000032;Label  ;600  ;18850;9750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=รางวัลในการประกวด การแข่งขัน การชิงโชค ค่าแสดงของนักแสดงสาธารณะ }
            { 1000000033;Label  ;600  ;19250;9720 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ค่าจ้างทำของ ค่าโฆษณา ค่าเช่า ค่าขนส่ง ค่าบริการ ค่าเบี้ยประกันวินาศภัย ฯลฯ }
            { 1000000034;Label  ;400  ;850  ;5100 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU="ผู้มีหน้าที่หักภาษี ณ ที่จ่าย : " }
            { 1000000035;Label  ;400  ;1300 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000036;Label  ;400  ;2200 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000037;Label  ;1950 ;9156 ;5100 ;846  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ประเภทเงินได้ที่จ่าย }
            { 1000000038;Shape  ;1700 ;8000 ;1400 ;423   }
            { 1000000039;Label  ;3450 ;8000 ;1150 ;523  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ในแบบ }
            { 1000000040;Shape  ;4900 ;8000 ;450  ;423   }
            { 1000000042;Shape  ;4900 ;8500 ;450  ;423   }
            { 1000000043;Label  ;6050 ;8000 ;1650 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.1ก }
            { 1000000044;Label  ;6050 ;8500 ;1650 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.2ก }
            { 1000000045;Label  ;300  ;25150;1340 ;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000046;Shape  ;8100 ;8000 ;450  ;423   }
            { 1000000047;Shape  ;8100 ;8500 ;450  ;423   }
            { 1000000048;Label  ;6650 ;150  ;5250 ;500  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ตามมาตรา 50 ทวิ แห่งประมวลรัษฎากร }
            { 1000000049;Label  ;10800;9150 ;2400 ;444  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=วัน เดือน }
            { 1000000050;Shape  ;10750;9150 ;30   ;10950;ShapeStyle=VertLine }
            { 1000000051;Shape  ;13290;20605;5960 ;30   ;ShapeStyle=HorzLine }
            { 1000000052;Label  ;150  ;100  ;6500 ;600  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หนังสือรับรองการหักภาษี ณ ที่จ่าย }
            { 1000000053;Label  ;9200 ;8000 ;2550 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.1ก พิเศษ }
            { 1000000054;Label  ;9200 ;8500 ;2550 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.3ก }
            { 1000000055;Shape  ;150  ;21200;19100;30   ;ShapeStyle=HorzLine }
            { 1000000056;Shape  ;150  ;23100;19100;30   ;ShapeStyle=HorzLine }
            { 1000000057;Label  ;290  ;23100;1650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 1000000058;Label  ;5170 ;23150;10550;550  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ขอรับรองว่า ข้อความและตัวเลขดังกล่าวข้างต้นถูกต้องตรงกับความจริงทุกประการ }
            { 1000000059;Label  ;5180 ;23900;860  ;523  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(ลงชื่อ) }
            { 1000000060;Shape  ;12100;8000 ;450  ;423   }
            { 1000000061;Shape  ;12100;8500 ;450  ;423   }
            { 1000000062;Label  ;5170 ;24550;6000 ;473  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................... }
            { 1000000063;Label  ;13200;8000 ;1950 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.2 }
            { 1000000064;Label  ;13250;8500 ;1950 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.53 }
            { 1000000065;Label  ;6020 ;23900;6640 ;523  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.............................................................................................. }
            { 1000000066;Shape  ;13280;9150 ;30   ;11550;ShapeStyle=VertLine }
            { 1000000067;Label  ;13400;9150 ;2650 ;846  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=จำนวนเงินที่จ่าย }
            { 1000000068;Shape  ;500  ;23500;500  ;360   }
            { 1000000069;Shape  ;500  ;23900;500  ;360   }
            { 1000000070;Label  ;1110 ;23500;2960 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=หักภาษี ณ ที่จ่าย }
            { 1000000071;Label  ;1110 ;23900;2990 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ออกภาษีให้ตลอดไป }
            { 1000000072;Shape  ;15450;8000 ;450  ;423   }
            { 1000000073;Label  ;12400;150  ;900  ;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=เล่มที่ }
            { 1000000074;Label  ;16500;8000 ;1450 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.3 }
            { 1000000075;Label  ;13300;150  ;2200 ;500  ;VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................ }
            { 1000000076;Label  ;11250;1350 ;3200 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000077;Label  ;11200;6300 ;3200 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000078;Shape  ;500  ;24300;500  ;360   }
            { 1000000079;Shape  ;500  ;24700;500  ;360   }
            { 1000000080;Label  ;12640;23900;3590 ;523  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ผู้มีหน้าที่หักภาษี ณ ที่จ่าย }
            { 1000000081;Label  ;11160;24550;4220 ;423  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=วัน เดือน ปี ที่ออกหนังสือรับรอง }
            { 1000000082;Shape  ;16400;9150 ;30   ;11550;ShapeStyle=VertLine }
            { 1000000083;Label  ;1110 ;24300;3400 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ออกภาษีให้ครั้งเดียว }
            { 1000000084;Label  ;1110 ;24700;3450 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=อื่นๆ ให้ระบุ................ }
            { 1000000085;Shape  ;15023;1400 ;1692 ;423   }
            { 1000000086;TextBox;14450;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[1] }
            { 1000000087;TextBox;15023;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[2] }
            { 1000000088;TextBox;15446;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[3] }
            { 1000000089;Shape  ;15446;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000090;TextBox;15869;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[4] }
            { 1000000091;Shape  ;15869;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000092;Shape  ;15869;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000093;TextBox;16292;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[5] }
            { 1000000094;Shape  ;16292;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000095;TextBox;16865;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[6] }
            { 1000000096;TextBox;17288;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[7] }
            { 1000000097;Shape  ;17288;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000098;TextBox;17711;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[8] }
            { 1000000099;Shape  ;17711;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000100;TextBox;18134;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[9] }
            { 1000000101;Shape  ;18134;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000102;TextBox;18707;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[10] }
            { 1000000103;TextBox;13400;20100;2550 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 1000000104;TextBox;16450;20100;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000105;Shape  ;14450;6350 ;423  ;423   }
            { 1000000106;TextBox;14450;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[1] }
            { 1000000107;TextBox;15023;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[2] }
            { 1000000108;TextBox;15446;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[3] }
            { 1000000109;Shape  ;15446;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000110;TextBox;15869;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[4] }
            { 1000000111;Shape  ;15869;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000112;TextBox;16292;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[5] }
            { 1000000113;Shape  ;16292;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000114;TextBox;16865;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[6] }
            { 1000000115;TextBox;17288;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[7] }
            { 1000000116;Shape  ;17288;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000117;Shape  ;17711;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000118;TextBox;18134;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[9] }
            { 1000000119;Shape  ;18134;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000120;TextBox;18707;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[10] }
            { 1000000121;Shape  ;16750;23400;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000122;Label  ;16800;23600;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000123;Label  ;16800;23916;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000124;Label  ;16800;24200;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000125;Label  ;15600;150  ;900  ;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000126;Label  ;16500;150  ;2550 ;500  ;VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................ }
            { 1000000127;Shape  ;14450;1400 ;423  ;423   }
            { 1000000128;Shape  ;14873;1400 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000129;Shape  ;16715;1400 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000130;Shape  ;16865;1400 ;1692 ;423   }
            { 1000000131;Shape  ;18557;1400 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000132;Shape  ;18707;1400 ;423  ;423   }
            { 1000000133;Label  ;1100 ;1800 ;10050;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000134;Label  ;900  ;1300 ;10310;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000135;TextBox;1000 ;1300 ;10060;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000136;Label  ;1150 ;2700 ;14570;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000137;Label  ;1000 ;2200 ;18100;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000138;TextBox;1100 ;2200 ;17550;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + ' ' + CompanyInfo."Address 2" + ' ' + CompanyPhone }
            { 1000000139;Shape  ;14873;6350 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000140;Shape  ;16715;6350 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000141;Shape  ;18557;6350 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000142;Shape  ;18707;6350 ;423  ;423   }
            { 1000000143;Label  ;350  ;6250 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000144;Label  ;1050 ;6700 ;10100;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000145;Label  ;850  ;6250 ;10290;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000146;TextBox;950  ;6250 ;10090;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Name }
            { 1000000147;Label  ;350  ;7100 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000148;Label  ;900  ;7100 ;18200;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000149;TextBox;1050 ;7100 ;17600;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Address + '  ' + Address2 + '  ' + City + ' ' + Phone }
            { 1000000150;Label  ;1050 ;7600 ;14710;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000151;Label  ;5500 ;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(1) }
            { 1000000152;Label  ;8650 ;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(2) }
            { 1000000153;Label  ;12700;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(3) }
            { 1000000154;Label  ;16000;8000 ;550  ;450  ;FontName=ms san seriff;
                                                         FontSize=8;
                                                         CaptionML=ENU=(4) }
            { 1000000155;Label  ;5500 ;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(5) }
            { 1000000156;Label  ;8650 ;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(6) }
            { 1000000157;Label  ;12700;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(7) }
            { 1000000158;Label  ;10800;9550 ;2400 ;450  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=หรือปีภาษี ที่จ่าย }
            { 1000000159;Label  ;16600;9150 ;2200 ;444  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ภาษีที่หัก }
            { 1000000160;Label  ;16600;9594 ;2200 ;450  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=และนำส่งไว้ }
            { 1000000161;Shape  ;16000;10000;30   ;10700;ShapeStyle=VertLine }
            { 1000000162;Shape  ;18800;10000;30   ;10700;ShapeStyle=VertLine }
            { 1000000163;Label  ;900  ;12050;7800 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1) กิจการที่ต้องเสียภาษีเงินได้นิติบุคคลในอัตราดังนี้ }
            { 1000000164;Label  ;1950 ;12450;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.1) อัตราร้อยละ 30 ของกำไรสุทธิ }
            { 1000000165;Label  ;1950 ;12850;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.2) อัตราร้อยละ 25 ของกำไรสุทธิ }
            { 1000000166;Label  ;1960 ;13250;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.3) อัตราร้อยละ 20 ของกำไรสุทธิ }
            { 1000000167;Label  ;1950 ;13650;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.4) อัตราอื่นๆ (ระบุ)................... ของกำไรสุทธิ }
            { 1000000168;Shape  ;1400 ;12450;450  ;360   }
            { 1000000169;Shape  ;1400 ;12850;450  ;360   }
            { 1000000170;Shape  ;1400 ;13250;450  ;360   }
            { 1000000171;Shape  ;1400 ;13650;450  ;360   }
            { 1000000172;Label  ;900  ;14050;9800 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2) กิจการที่ได้รับยกเว้นภาษีเงินได้นิติบุคคล ซึ่งผู้รับเงินปันผลไม่ได้รับเครดิตภาษี }
            { 1000000173;Label  ;1350 ;14450;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.1) กำไรสุทธิของกิจการที่ได้รับยกเว้นภาษีเงินได้นิติบุคคล }
            { 1000000174;Label  ;1350 ;14850;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.2) เงินปันผลหรือเงินส่วนแบ่งของกำไรที่ได้รับยกเว้นไม่ต้องนำมารวม }
            { 1000000175;Label  ;290  ;20700;4360 ;500  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมเงินภาษีที่หักนำส่ง (ตัวอักษร) }
            { 1000000176;Label  ;1620 ;25150;14930;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ให้สามารถอ้างอิงหรือสอบยันกันได้ระหว่างลำดับที่ตามหนังสือรับรองฯ กับแบบยื่นรายการภาษีหัก ณ ที่จ่าย }
            { 1000000177;Label  ;320  ;25550;1340 ;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=คำเตือน }
            { 1000000178;TextBox;15550;8000 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTGroup[1] }
            { 1000000179;TextBox;12200;8500 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTGroup[2] }
            { 1000000180;TextBox;600  ;24320;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         OptionCaptionML=ENU=1;
                                                         OptionString=1;
                                                         SourceExpr=WHTTerm[1] }
            { 1000000181;TextBox;600  ;23920;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[2] }
            { 1000000182;TextBox;600  ;23520;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[3] }
            { 1000000183;TextBox;600  ;24720;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[4] }
            { 1000000184;TextBox;10800;10050;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[1] }
            { 1000000185;TextBox;10800;10450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[2] }
            { 1000000186;TextBox;10800;10850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[3] }
            { 1000000187;TextBox;10800;11250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[4] }
            { 1000000188;TextBox;10800;12450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[5] }
            { 1000000189;TextBox;10800;12850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[6] }
            { 1000000190;TextBox;10800;13250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[7] }
            { 1000000191;TextBox;10800;13650;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[8] }
            { 1000000192;TextBox;10800;14450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[9] }
            { 1000000193;TextBox;10800;14850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[10] }
            { 1000000194;TextBox;10800;15650;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[11] }
            { 1000000195;TextBox;10800;16450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[12] }
            { 1000000196;TextBox;13400;10050;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[1] }
            { 1000000197;TextBox;13400;10450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[2] }
            { 1000000198;TextBox;13400;10850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[3] }
            { 1000000199;TextBox;13400;11250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[4] }
            { 1000000200;TextBox;13400;12450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[5] }
            { 1000000201;TextBox;13400;12850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[6] }
            { 1000000202;TextBox;13400;13250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[7] }
            { 1000000203;TextBox;13400;13650;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[8] }
            { 1000000204;TextBox;13400;14450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[9] }
            { 1000000205;TextBox;13400;14850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[10] }
            { 1000000206;TextBox;13400;15650;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[11] }
            { 1000000207;TextBox;13400;16450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[12] }
            { 1000000208;TextBox;16450;10050;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[1] }
            { 1000000209;TextBox;16450;10450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[2] }
            { 1000000210;TextBox;16450;10850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[3] }
            { 1000000211;TextBox;16450;11250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[4] }
            { 1000000212;TextBox;16450;12450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[5] }
            { 1000000213;TextBox;16450;12850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[6] }
            { 1000000214;TextBox;16450;13250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[7] }
            { 1000000215;TextBox;16450;13650;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[8] }
            { 1000000216;TextBox;16450;14450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[9] }
            { 1000000217;TextBox;16450;14850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[10] }
            { 1000000218;TextBox;16450;15650;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[11] }
            { 1000000219;TextBox;16450;16450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[12] }
            { 1000000220;TextBox;1500 ;12450;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[1] }
            { 1000000221;TextBox;1500 ;12850;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[2] }
            { 1000000222;TextBox;1500 ;13250;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[3] }
            { 1000000223;TextBox;1500 ;13650;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[4] }
            { 1000000224;TextBox;16600;150  ;2250 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=WHTSlipNo }
            { 1000000225;TextBox;4740 ;20700;13860;500  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=WHTAmtLCYText }
            { 1000000226;TextBox;13400;150  ;2000 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=FormBookNo }
            { 1000000227;Label  ;2050 ;19677;8530 ;400  ;VertAlign=Bottom;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=.......................................................................................................................... }
            { 1000000228;TextBox;2150 ;19627;6700 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText }
            { 1000000229;Shape  ;150  ;3250 ;19100;2350 ;ShapeStyle=Rectangle }
            { 1000000230;Label  ;400  ;3300 ;5100 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU="กระทำการแทน : " }
            { 1000000231;Label  ;11200;3800 ;3200 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000232;Label  ;900  ;3750 ;10250;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000233;TextBox;1000 ;3750 ;10040;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ConductName }
            { 1000000234;TextBox;14450;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[1] }
            { 1000000235;TextBox;15023;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[2] }
            { 1000000236;TextBox;15446;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[3] }
            { 1000000237;Shape  ;15446;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000238;TextBox;15869;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[4] }
            { 1000000239;Shape  ;15869;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000240;TextBox;16292;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[5] }
            { 1000000241;Shape  ;16250;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000242;TextBox;16865;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[6] }
            { 1000000243;TextBox;17288;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[7] }
            { 1000000244;Shape  ;17288;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000245;TextBox;17711;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[8] }
            { 1000000246;Shape  ;17711;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000247;TextBox;18134;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[9] }
            { 1000000248;Shape  ;18134;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000249;TextBox;18707;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[10] }
            { 1000000250;Shape  ;14873;3850 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000251;Shape  ;16715;3850 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000252;Shape  ;18557;3850 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000253;Shape  ;18707;3850 ;423  ;423   }
            { 1000000254;Label  ;400  ;3750 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000255;Label  ;1100 ;4250 ;10050;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000256;Label  ;400  ;4650 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000257;Label  ;1000 ;4650 ;18100;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000258;TextBox;1100 ;4650 ;17600;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ConductAddress }
            { 1000000259;Label  ;1150 ;5150 ;14610;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000260;TextBox;6220 ;24500;4600 ;473  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PostingDate }
            { 1000000261;TextBox;17197;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[10] }
            { 1000000262;Shape  ;18703;900  ;423  ;423   }
            { 1000000263;Shape  ;17620;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000264;TextBox;16774;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[9] }
            { 1000000265;Shape  ;16774;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000266;TextBox;15928;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[7] }
            { 1000000267;TextBox;16351;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[8] }
            { 1000000268;Shape  ;16351;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000269;TextBox;15505;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[6] }
            { 1000000270;Shape  ;15928;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000271;TextBox;14962;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[5] }
            { 1000000272;Shape  ;15385;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000273;TextBox;14539;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[4] }
            { 1000000274;Shape  ;14962;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000275;TextBox;14116;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[3] }
            { 1000000276;Shape  ;14539;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000277;Shape  ;14539;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000278;TextBox;13693;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[2] }
            { 1000000279;Shape  ;14116;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000280;Shape  ;13573;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000281;TextBox;13150;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[1] }
            { 1000000282;Label  ;10380;850  ;2800 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขที่ประจำตัวประชาชน }
            { 1000000283;Shape  ;13290;20685;5960 ;30   ;ShapeStyle=HorzLine }
            { 1000000284;Shape  ;17197;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000285;Shape  ;17740;900  ;846  ;423   }
            { 1000000286;TextBox;17740;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[11] }
            { 1000000287;Shape  ;18583;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000288;Shape  ;18160;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000289;TextBox;18160;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[12] }
            { 1000000290;Label  ;10380;3300 ;2800 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขที่ประจำตัวประชาชน }
            { 1000000291;TextBox;18703;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[13] }
            { 1000000292;Shape  ;17740;3350 ;846  ;423   }
            { 1000000293;Shape  ;18583;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000294;TextBox;18160;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[12] }
            { 1000000295;Shape  ;15505;3350 ;2115 ;423   }
            { 1000000296;TextBox;17197;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[10] }
            { 1000000297;Shape  ;17620;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000298;TextBox;17740;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[11] }
            { 1000000299;Shape  ;18160;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000300;TextBox;16774;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[9] }
            { 1000000301;Shape  ;16774;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000302;TextBox;15928;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[7] }
            { 1000000303;TextBox;16351;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[8] }
            { 1000000304;Shape  ;16351;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000305;Shape  ;17197;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000306;TextBox;15505;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[6] }
            { 1000000307;Shape  ;15928;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000308;Shape  ;13693;3350 ;1692 ;423   }
            { 1000000309;TextBox;14962;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[5] }
            { 1000000310;Shape  ;15385;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000311;TextBox;14539;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[4] }
            { 1000000312;Shape  ;14962;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000313;TextBox;14116;3350 ;420  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[3] }
            { 1000000314;Shape  ;14539;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000315;Shape  ;14539;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000316;TextBox;13693;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[2] }
            { 1000000317;Shape  ;14116;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000318;Shape  ;13573;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000319;Shape  ;13150;3350 ;423  ;423   }
            { 1000000320;TextBox;13150;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[1] }
            { 1000000321;Label  ;10380;5800 ;2800 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขที่ประจำตัวประชาชน }
            { 1000000322;TextBox;18703;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[13] }
            { 1000000323;Shape  ;17740;5850 ;846  ;423   }
            { 1000000324;Shape  ;18583;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000325;TextBox;18160;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[12] }
            { 1000000326;Shape  ;15505;5850 ;2115 ;423   }
            { 1000000327;TextBox;17197;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[10] }
            { 1000000328;Shape  ;17620;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000329;TextBox;17740;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[11] }
            { 1000000330;Shape  ;18160;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000331;TextBox;16774;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[9] }
            { 1000000332;Shape  ;16774;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000333;TextBox;15928;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[7] }
            { 1000000334;TextBox;16351;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[8] }
            { 1000000335;Shape  ;16351;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000336;Shape  ;17197;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000337;TextBox;15505;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[6] }
            { 1000000338;Shape  ;15928;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000339;Shape  ;13693;5850 ;1692 ;423   }
            { 1000000340;TextBox;14962;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[5] }
            { 1000000341;Shape  ;15385;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000342;TextBox;14539;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[4] }
            { 1000000343;Shape  ;14962;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000344;TextBox;14116;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[3] }
            { 1000000345;Shape  ;14539;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000346;Shape  ;14539;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000347;TextBox;13693;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[2] }
            { 1000000348;Shape  ;14116;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000349;Shape  ;13573;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000350;Shape  ;13150;5850 ;423  ;423   }
            { 1000000351;TextBox;13150;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[1] }
            { 1000000352;Shape  ;4640 ;23100;30   ;2050 ;ShapeStyle=VertLine }
            { 1000000353;Label  ;270  ;21250;18690;450  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เงินสะสมจ่ายเข้ากองทุนสำรองเลี้ยงชีพใบอนุญาตเลขที่........................................................จำนวนเงิน................................บาท }
            { 1000000354;Shape  ;150  ;21750;19100;30   ;ShapeStyle=HorzLine }
            { 1000000355;Label  ;3300 ;21800;12750;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เงินสมทบจ่ายเข้ากองทุนประกันสังคม จำนวนเงิน.........................................บาท }
            { 1000000356;Label  ;2400 ;22200;4620 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขที่บัญชีนายจ้าง }
            { 1000000357;Label  ;9610 ;22200;7010 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขที่บัตรประกันสังคม ของผู้ถูกหักภาษี ณ ที่จ่าย }
            { 1000000358;Shape  ;4785 ;22600;1692 ;423   }
            { 1000000359;TextBox;5631 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[8] }
            { 1000000360;Shape  ;2943 ;22600;1692 ;423   }
            { 1000000361;Shape  ;2370 ;22600;423  ;423   }
            { 1000000362;TextBox;2370 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[1] }
            { 1000000363;TextBox;2943 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[2] }
            { 1000000364;TextBox;3366 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[3] }
            { 1000000365;Shape  ;3366 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000366;TextBox;3789 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[4] }
            { 1000000367;Shape  ;3789 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000368;TextBox;4212 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[5] }
            { 1000000369;Shape  ;4212 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000370;TextBox;4785 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[6] }
            { 1000000371;TextBox;5208 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[7] }
            { 1000000372;Shape  ;5208 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000373;Shape  ;5631 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000374;TextBox;6054 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[9] }
            { 1000000375;Shape  ;6054 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000376;Shape  ;2793 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000377;Shape  ;4635 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000378;Shape  ;6477 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000379;TextBox;6627 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[10] }
            { 1000000380;Shape  ;15713;22600;423  ;423   }
            { 1000000381;TextBox;15713;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[13] }
            { 1000000382;Shape  ;15593;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000383;Shape  ;14750;22600;846  ;423   }
            { 1000000384;TextBox;15170;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[12] }
            { 1000000385;Shape  ;12515;22600;2115 ;423   }
            { 1000000386;TextBox;14207;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[10] }
            { 1000000387;Shape  ;14630;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000388;TextBox;14750;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[11] }
            { 1000000389;Shape  ;15170;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000390;TextBox;13784;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[9] }
            { 1000000391;Shape  ;14207;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000392;Shape  ;13784;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000393;TextBox;12938;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[7] }
            { 1000000394;TextBox;13361;22600;420  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[8] }
            { 1000000395;Shape  ;13361;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000396;TextBox;12515;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[6] }
            { 1000000397;Shape  ;12938;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000398;Shape  ;10703;22600;1692 ;423   }
            { 1000000399;TextBox;11972;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[5] }
            { 1000000400;Shape  ;12395;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000401;TextBox;11549;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[4] }
            { 1000000402;Shape  ;11972;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000403;TextBox;11126;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[3] }
            { 1000000404;Shape  ;11549;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000405;Shape  ;11549;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000406;TextBox;10703;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[2] }
            { 1000000407;Shape  ;11126;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000408;Shape  ;10583;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000409;Shape  ;10160;22600;423  ;423   }
            { 1000000410;TextBox;10160;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[1] }
            { 1000000411;Label  ;1350 ;17650;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ซึ่งผู้รับเงินปันผลไม่ได้รับเครดิตภาษี }
            { 1000000412;Label  ;900  ;17250;9600 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(3) กำไรเฉพาะส่วนที่ได้รับยกเว้นไม่ต้องนำมารวมคำนวณภาษีเงินได้นิติบุคคล }
            { 1000000413;Label  ;1940 ;15250;8560 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=คำนวณเป็นรายได้เพื่อเสียภาษีเงินได้นิติบุคคล }
            { 1000000414;Label  ;1350 ;15650;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.3) กำไรสุทธิส่วนที่ได้หักผลขาดทุนสุทธิยกมาไม่เกิน 5 ปี }
            { 1000000415;Label  ;1940 ;16050;8560 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ก่อนรอบระยะเวลาบัญชีปัจจุบัน }
            { 1000000416;Label  ;1380 ;16850;9120 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.5) อื่นๆ (ระบุ)....................................................................................................... }
            { 1000000417;Label  ;1390 ;16450;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.4) กำไรที่รับรู้ทางบัญชีโดยวิธีส่วนได้เสีย (equity method) }
            { 1000000418;TextBox;10800;16850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[13] }
            { 1000000419;TextBox;13400;16850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[13] }
            { 1000000420;TextBox;16450;16850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[13] }
            { 1000000421;TextBox;10800;17250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[14] }
            { 1000000422;TextBox;13400;17250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[14] }
            { 1000000423;TextBox;16450;17250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[14] }
            { 1000000424;TextBox;10800;18027;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[15] }
            { 1000000425;TextBox;13400;18027;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[15] }
            { 1000000426;TextBox;16450;18027;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[15] }
            { 1000000427;TextBox;10800;19604;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[19] }
            { 1000000428;TextBox;13400;19604;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[19] }
            { 1000000429;TextBox;16450;19604;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[19] }
            { 1000000430;TextBox;7630 ;21200;5190 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         SourceExpr=PFundNo }
            { 1000000431;TextBox;14530;21200;2760 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=PFundAmt }
            { 1000000432;TextBox;10930;21720;3500 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=SocialAmt }
            { 1000000433;TextBox;10800;18450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[16] }
            { 1000000434;TextBox;13400;18450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[16] }
            { 1000000435;TextBox;16450;18450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[16] }
            { 1000000436;TextBox;10800;18850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[17] }
            { 1000000437;TextBox;13400;18850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[17] }
            { 1000000438;TextBox;16450;18850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[17] }
            { 1000000439;TextBox;10800;19250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[18] }
            { 1000000440;TextBox;13400;19250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[18] }
            { 1000000441;TextBox;16450;19250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[18] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CASE Number OF
                             1: Heading := 'ฉบับที่ 1 (สำหรับผู้ถูกหักภาษี ณ ที่จ่าย ใช้แนบพร้อมกับแบบแสดงรายการภาษี)';
                             2: Heading := 'ฉบับที่ 2 (สำหรับผู้ถูกหักภาษี ณ ที่จ่าย เก็บไว้เป็นหลักฐาน)';
                             3: Heading := 'ฉบับที่ 3';
                             4: Heading := 'ฉบับที่ 4';
                           END;
                           CurrReport.SHOWOUTPUT(HeadingPrint);
                         END;

          }
          CONTROLS
          {
            { 1000000003;TextBox;150  ;0    ;16800;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         SourceExpr=Heading }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=16830;
      Height=9570;
      SaveValues=Yes;
      OnInit=BEGIN
               HeadingPrint := TRUE;
             END;

    }
    CONTROLS
    {
      { 1000000026;TextBox;4180 ;2750 ;7480 ;440  ;ParentControl=1000000013;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=ชื่อผู้กระทำการแทน;
                                                   SourceExpr=ConductName }
      { 1000000027;Label  ;330  ;2750 ;3740 ;440  ;ParentControl=1000000026 }
      { 1000000028;TextBox;4180 ;3300 ;11550;440  ;ParentControl=1000000013;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=ที่อยู่ผู้กระทำการแทน;
                                                   SourceExpr=ConductAddress }
      { 1000000029;Label  ;330  ;3300 ;3740 ;440  ;ParentControl=1000000028 }
      { 1000000030;TextBox;4180 ;3850 ;3630 ;440  ;ParentControl=1000000013;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=เลขประจำตัวผู้เสียภาษี;
                                                   SourceExpr=ConductVATID }
      { 1000000031;Label  ;330  ;3850 ;3740 ;440  ;ParentControl=1000000030 }
      { 1000000032;TextBox;4180 ;4400 ;3630 ;440  ;ParentControl=1000000013;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=เลขที่ประจำตัวประชาชน;
                                                   SourceExpr=ConductID }
      { 1000000033;Label  ;330  ;4400 ;3740 ;440  ;ParentControl=1000000032 }
      { 1000000000;TextBox;4070 ;770  ;1650 ;440  ;CaptionML=ENU=Number of copies;
                                                   SourceExpr=NumberOfCopy }
      { 1000000001;Label  ;220  ;770  ;3740 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;4070 ;220  ;1650 ;440  ;CaptionML=ENU=Form No.;
                                                   SourceExpr=FormBookNo }
      { 1000000003;Label  ;220  ;220  ;3740 ;440  ;ParentControl=1000000002;
                                                   CaptionML=ENU=Print Form 50 BIS Book No. }
      { 1000000004;CheckBox;4070;1320 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=พิมพ์ฉบับที่ (Heading Print);
                                                   SourceExpr=HeadingPrint }
      { 1000000005;Label  ;220  ;1320 ;3740 ;440  ;ParentControl=1000000004 }
      { 1000000008;OptionButton;3190;8030;3740;440;CaptionML=ENU=ออกภาษีให้ครั้งเดียว;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=0 }
      { 1000000009;OptionButton;3190;7590;3740;440;CaptionML=ENU=ออกภาษีให้ตลอดไป;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=1 }
      { 1000000010;OptionButton;3190;7150;3740;440;CaptionML=ENU=หักภาษี ณ ที่จ่าย;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=2 }
      { 1000000011;OptionButton;3190;8470;3740;440;CaptionML=ENU=อื่นๆ ให้ระบุ................;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=3 }
      { 1000000012;Label  ;330  ;7150 ;2750 ;440  ;CaptionML=ENU=ผู้จ่ายเงิน }
      { 1000000013;Frame  ;110  ;2200 ;15840;2860 ;FontBold=Yes;
                                                   CaptionML=ENU=กระทำการแทนโดย }
      { 1000000014;TextBox;6930 ;5390 ;2530 ;440  ;CaptionML=ENU=เงินสะสมจ่ายเข้ากองทุนสำรองเลี้ยงชีพใบอนุญาตเลขที่;
                                                   SourceExpr=PFundNo }
      { 1000000015;Label  ;330  ;5390 ;6490 ;440  ;ParentControl=1000000014 }
      { 1000000016;TextBox;11440;5390 ;2530 ;440  ;CaptionML=ENU=จำนวนเงิน;
                                                   SourceExpr=PFundAmt }
      { 1000000017;Label  ;9900 ;5390 ;1430 ;440  ;ParentControl=1000000016 }
      { 1000000018;Label  ;14080;5390 ;1650 ;440  ;LeaderDots=No;
                                                   CaptionML=ENU=บาท }
      { 1000000019;TextBox;6930 ;5940 ;2530 ;440  ;CaptionML=ENU=เงินสมทบเข้ากองทุนประกันสังคม จำนวนเงิน;
                                                   SourceExpr=SocialAmt }
      { 1000000020;Label  ;1320 ;5940 ;5500 ;440  ;ParentControl=1000000019 }
      { 1000000021;Label  ;9570 ;5940 ;1650 ;440  ;LeaderDots=No;
                                                   CaptionML=ENU=บาท }
      { 1000000022;Label  ;1320 ;6490 ;2530 ;440  ;ParentControl=1000000023 }
      { 1000000023;TextBox;3960 ;6490 ;2530 ;440  ;CaptionML=ENU=เลขที่บัญชีนายจ้าง;
                                                   SourceExpr=EmployerAccount }
      { 1000000024;TextBox;12650;6490 ;2530 ;440  ;CaptionML=ENU=เลขที่บัตรประกันสังคม ของผู้ถูกหักภาษี ณ ที่จ่าย;
                                                   SourceExpr=SocialID }
      { 1000000025;Label  ;6600 ;6490 ;5940 ;440  ;ParentControl=1000000024 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000020 : Record 79;
      GLSetup@1000000018 : Record 98;
      Vendor@1000000006 : Record 23;
      PettyCashLine@1000000028 : Record 55002;
      PurchSetup@1000000005 : Record 312;
      WHTPostingSetup@1000000047 : Record 28043;
      WHTRevType@1000000042 : Record 28042;
      WHTBusPostingGrp@1000000036 : Record 28040;
      Form50BIS@1000000046 : Report 50003;
      NoSeriesMgt@1000000033 : Codeunit 396;
      ActualVendorNo@1000000026 : Code[20];
      VAT@1000000029 : ARRAY [20] OF Code[1];
      CID@1000000008 : ARRAY [20] OF Code[1];
      CCID@1000000007 : ARRAY [20] OF Code[1];
      FormBookNo@1000000032 : Code[10];
      WHTSlipNo@1000000030 : Code[20];
      Name@1000000004 : Text[150];
      Address@1000000003 : Text[250];
      Address2@1000000002 : Text[250];
      City@1000000001 : Text[30];
      ConductID@1000000009 : Text[20];
      ConductName@1000000022 : Text[250];
      ConductAddress@1000000015 : Text[250];
      ExpenseType@1000000016 : ARRAY [4] OF Text[1];
      WHTGroup@1000000010 : ARRAY [2] OF Text[1];
      WHTTerm@1000000011 : ARRAY [4] OF Text[1];
      WHTAmtLCYText@1000000019 : Text[200];
      WHTExpenseText@1000000025 : Text[30];
      WHTPostingDate@1000000031 : ARRAY [19] OF Date;
      WHTBaseAmt@1000000017 : Decimal;
      WHTBaseAmtLCYExcVAT@1000000013 : ARRAY [19] OF Decimal;
      WHTAmtLCY@1000000014 : ARRAY [19] OF Decimal;
      TotWHTBaseAmtLCYExcVAT@1000000023 : Decimal;
      TotWHTAmtLCY@1000000021 : Decimal;
      NumberOfCopy@1000000024 : Integer;
      NewDocNo@1000000038 : Code[20];
      HeadingPrint@1000000041 : Boolean;
      Heading@1000000000 : Text[100];
      DocNoFilter@1000000027 : Text[250];
      PostingDate@1000000012 : Date;
      PaymentOption@1000000035 : '0,1,2,3';
      i@1000000034 : Integer;
      ConductVATID@1000000054 : Text[20];
      ID1@1000000053 : ARRAY [13] OF Code[1];
      ID2@1000000052 : ARRAY [13] OF Code[1];
      ID3@1000000051 : ARRAY [13] OF Code[1];
      PFundNo@1000000050 : Code[20];
      PFundAmt@1000000049 : Decimal;
      SocialAmt@1000000048 : Decimal;
      EmployerAccount@1000000045 : Code[10];
      SocialID@1000000044 : Code[13];
      SoID@1000000043 : ARRAY [13] OF Code[1];
      EID@1000000040 : ARRAY [10] OF Code[1];
      CompanyPhone@1000000039 : Text[50];
      Phone@1000000037 : Text[50];

    PROCEDURE CalcWHTEntry@1000000001(PettyCashLine@1000000000 : Record 55002) : Boolean;
    BEGIN
      WITH PettyCashLine DO BEGIN
        WHTPostingSetup.GET("WHT Business Posting Group","WHT Product Posting Group");
        IF WHTPostingSetup."WHT %" = 0 THEN
          EXIT(FALSE);

        CASE WHTPostingSetup."WHT Report" OF
          WHTPostingSetup."WHT Report"::"Por Ngor Dor 3":
            WHTGroup[1] := 'P';
          WHTPostingSetup."WHT Report"::"Por Ngor Dor 53":
            WHTGroup[2] := 'P';
        END;

        IF WHTRevType.GET(WHTPostingSetup."Revenue Type") THEN BEGIN
          i := WHTRevType.Sequence;
          IF (i = 99) OR (i = 19) THEN BEGIN  //KKE : #002
            i := 19;
            WHTExpenseText := WHTRevType.Description;
          END;
          WHTPostingDate[i] := "Petty Cash Header"."Posting Date";
          PostingDate := "Petty Cash Header"."Posting Date";

          IF "WHT Absorb Base" <> 0 THEN
            WHTBaseAmt := "WHT Absorb Base"
          ELSE
            WHTBaseAmt := "VAT Base Amount (LCY)";

          WHTAmtLCY[i] := WHTAmtLCY[i] + ROUND(WHTBaseAmt * WHTPostingSetup."WHT %" / 100);
          WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + WHTBaseAmt;
          TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT + WHTBaseAmt;
          TotWHTAmtLCY := TotWHTAmtLCY + ROUND(WHTBaseAmt * WHTPostingSetup."WHT %" / 100);
        END;
      END;
      EXIT(TRUE);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   17.08.2006   KKE   WHT Slip for Petty Cash.
      002   04.09.2006   KKE   Update for new format
                               Add 3 sub sequence in 5.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50087 Payment Voucher - Petty Cash
{
  OBJECT-PROPERTIES
  {
    Date=11/09/07;
    Time=11:30:52 AM;
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   CompanyInfo.GET;
                   CompanyInfo.CALCFIELDS(Picture);
                 END;

    OnPreReport=BEGIN
                  DebitTotalLCY := 0;
                  CreditTotalLCY := 0;
                END;

    PaperSize=A4 210 x 297 mm;
    HorzGrid=50;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55006;
        DataItemTableView=SORTING(No.);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        CASE TRUE OF
                          Cash: xCash := 'P';
                          Cheque: xCheque := 'P';
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           DocumentNo := "No.";

                           Vendor.GET("Petty Cash Vendor No.");
                           IF Vendor."Name (Thai)" <> '' THEN
                             VendName := Vendor."No." + '   ' + Vendor."Name (Thai)"
                           ELSE
                             VendName := Vendor."No." + '   ' + Vendor.Name + Vendor."Name 2";

                           CALCFIELDS("Balance Settle","Total WHT (LCY)");
                           TotalAmt := "Balance Settle";

                           VendPostingGroup.GET(Vendor."Vendor Posting Group");
                           DebitAccNo[1] := VendPostingGroup."Payables Account";
                           GLAcc.GET(DebitAccNo[1]);
                           DebitAccName[1] := GLAcc.Name;
                           DebitAmount[1] := -TotalAmt;

                           CASE "Settle Account Type" OF
                             "Settle Account Type"::"Bank Account":
                               BEGIN
                                 BankName := "Settle Account No.";
                                 BankAcc.GET("Settle Account No.");
                                 BankBranch := BankAcc."Bank Branch No.";
                                 BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                 CreditAccNo[1] := BankAccPostingGroup."G/L Bank Account No.";
                                 GLAcc.GET(CreditAccNo[1]);
                                 CreditAccName[1] := GLAcc.Name;
                                 CreditAmount[1] := -TotalAmt;
                               END;
                             "Settle Account Type"::"G/L Account":
                               BEGIN
                                 CreditAccNo[1] := "Settle Account No.";
                                 GLAcc.GET(CreditAccNo[1]);
                                 CreditAccName[1] := GLAcc.Name;
                                 CreditAmount[1] := -TotalAmt;
                               END;
                             "Settle Account Type"::Vendor:
                               BEGIN
                                 Vendor2.GET("Settle Account No.");
                                 VendPostingGroup.GET(Vendor2."Vendor Posting Group");
                                 CreditAccNo[1] := VendPostingGroup."Payables Account";
                                 GLAcc.GET(CreditAccNo[1]);
                                 CreditAccName[1] := GLAcc.Name;
                                 CreditAmount[1] := -TotalAmt;
                               END;
                           END;

                           //CheckReport.InitTextVariable;
                           //CheckReport.FormatNoText(TextAmount,ABS(TotalAmt),"Currency Code");

                           TextAmount[1] := FORMAT(ABS(TotalAmt),0,'<Precision,2:3><Standard Format,0>') + ' (' +
                             Form50BIS.FormatNoThaiText(ABS(TotalAmt)) + ')';

                           PettyCashComtLine.RESET;
                           PettyCashComtLine.SETRANGE("Document Type",PettyCashComtLine."Document Type"::Settle);
                           PettyCashComtLine.SETRANGE("No.","No.");
                           PettyCashComtLine.SETFILTER(Comment,'<>%1','');
                           IF PettyCashComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(Remark + PettyCashComtLine.Comment) < 250 THEN
                                 Remark += PettyCashComtLine.Comment + ' ';
                             UNTIL PettyCashComtLine.NEXT=0;
                         END;

        ReqFilterFields=No.;
        GroupTotalFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=4000;
            OnPreSection=BEGIN
                           Line := 0;
                           IF CurrReport.PAGENO > 1 THEN
                             TextPageNo := STRSUBSTNO('Page %1',CurrReport.PAGENO);
                         END;

          }
          CONTROLS
          {
            { 1000000047;Label  ;14600;2850 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=No......................................... }
            { 1000000055;TextBox;15350;2750 ;3550 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=DocumentNo }
            { 1000000060;Label  ;14600;3400 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Date...................................... }
            { 1000000061;TextBox;15650;3400 ;3000 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Posting Date" }
            { 1000000046;TextBox;11400;50   ;7450 ;850  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000150;Label  ;7700 ;1650 ;4900 ;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=PAYMENT VOUCHER }
            { 1000000151;TextBox;0    ;0    ;9700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000152;TextBox;0    ;600  ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" }
            { 1000000155;TextBox;0    ;1200 ;7550 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000161;TextBox;0    ;1800 ;7550 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr='Tel: ' + CompanyInfo."Phone No." + ' Fax: ' + CompanyInfo."Fax No." }
            { 1000000167;TextBox;14800;1900 ;4050 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextPageNo }
            { 1000000168;TextBox;11400;1100 ;7450 ;500  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19400;
            SectionHeight=4330;
          }
          CONTROLS
          {
            { 1000000096;Shape  ;0    ;0    ;30   ;4330 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000063;Label  ;150  ;150  ;10350;550  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Paid to................................................................................................................... }
            { 1000000147;TextBox;1250 ;100  ;9100 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VendName }
            { 1000000119;Label  ;13450;850  ;5600 ;550  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Payment Date........................................ }
            { 1000000120;TextBox;15600;800  ;3300 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Posting Date" }
            { 1000000033;Shape  ;19230;0    ;30   ;4330 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000083;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000085;Shape  ;0    ;3590 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000125;Label  ;16100;3650 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000127;Label  ;12800;3650 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Input VAT }
            { 1000000129;Label  ;10000;3650 ;2320 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Goods/Service }
            { 1000000131;Label  ;1450 ;3650 ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description }
            { 1000000090;Shape  ;0    ;4300 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000110;Shape  ;9500 ;3600 ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000115;Shape  ;12630;3600 ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000116;Shape  ;15850;3600 ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000017;Label  ;10750;150  ;8320 ;550  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Payee Name....................................................................................... }
            { 1000000180;TextBox;12450;100  ;6410 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PayeeName }
            { 1000000234;Label  ;150  ;850  ;13150;550  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=For Payment of ................................................................................................................................ }
            { 1000000235;TextBox;2450 ;800  ;10500;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Payment Invoice Description" }
            { 1000000000;Label  ;150  ;1500 ;18870;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Amount ..................................................................................................................................................................................................... }
            { 1000000004;TextBox;1450 ;1500 ;17480;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextAmount[1] }
            { 1000000069;Label  ;150  ;2300 ;660  ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=By : }
            { 1000000087;Shape  ;900  ;2350 ;450  ;423   }
            { 1000000088;TextBox;960  ;2350 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCash }
            { 1000000068;Label  ;1420 ;2300 ;900  ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CASH }
            { 1000000084;TextBox;2450 ;2350 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCheque }
            { 1000000086;Shape  ;2350 ;2350 ;450  ;423   }
            { 1000000067;Label  ;2920 ;2300 ;1770 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Check/ Draft }
            { 1000000095;Label  ;5100 ;2200 ;7000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Bank.......................................................................................... }
            { 1000000100;TextBox;5950 ;2200 ;5550 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=BankName }
            { 1000000097;Label  ;5100 ;2850 ;7000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Branch........................................................................ }
            { 1000000101;TextBox;6200 ;2850 ;5300 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=BankBranch }
            { 1000000122;Label  ;12950;2850 ;6000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Date................................................................. }
            { 1000000124;TextBox;14000;2850 ;2900 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Cheque Date" }
            { 1000000103;Label  ;12950;2200 ;6000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Check No........................................................ }
            { 1000000121;TextBox;14450;2200 ;4050 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Cheque No." }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=700;
            OnPreSection=BEGIN
                           CheckReport.InitTextVariable;
                           CheckReport.FormatNoText(TextAmount,ABS(TotalAmt),"Currency Code");

                           IF TextAmount[1] <> '' THEN
                             TextAmount[1] := '(' + TextAmount[1] + ')';
                         END;

          }
          CONTROLS
          {
            { 1000000093;TextBox;12750;100  ;3000 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitTotalLCY }
            { 1000000094;TextBox;16000;100  ;3110 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditTotalLCY }
            { 1000000099;Shape  ;12580;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000102;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000153;Label  ;11300;100  ;1150 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total }
            { 1000000019;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000034;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000036;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000145;TextBox;100  ;50   ;11100;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextAmount[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=550;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           DebitTotalLCY := 0;
                           CreditTotalLCY := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000064;Label  ;0    ;0    ;5750 ;550  ;HorzAlign=Center;
                                                         ForeColor=255;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=4580;
          }
          CONTROLS
          {
            { 1000000158;Label  ;150  ;150  ;2075 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Remark }
            { 1000000201;Label  ;6750 ;2650 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000210;Label  ;6750 ;3800 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000078;Label  ;16000;3800 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000050;Shape  ;0    ;0    ;30   ;4550 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000051;Shape  ;19230;0    ;30   ;4550 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000065;Shape  ;0    ;4550 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000107;Shape  ;0    ;2150 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000172;Shape  ;0    ;3350 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000175;Shape  ;9625 ;2150 ;30   ;2400 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000013;Label  ;10200;2650 ;2275 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Acct.Entry By : }
            { 1000000022;Label  ;10200;3800 ;2335 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved By : }
            { 1000000025;Label  ;550  ;3800 ;2045 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Received By : }
            { 1000000035;Label  ;550  ;2650 ;2075 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By : }
            { 1000000042;Label  ;16000;2650 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000077;TextBox;750  ;700  ;18000;1400 ;VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         MultiLine=Yes;
                                                         SourceExpr=Remark }
            { 1000000037;Shape  ;15   ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55007;
        DataItemTableView=SORTING(Entry No.);
        OnAfterGetRecord=VAR
                           DebitAppliedVATAmtTmp@1000000000 : Decimal;
                           CreditAppliedVATAmtTmp@1000000001 : Decimal;
                         BEGIN
                           VendLedgEntry3.GET("Entry No.");

                           CreditVATAmtTmp := 0;
                           VATEntry.RESET;
                           VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                           VATEntry.SETRANGE("Posting Date",VendLedgEntry3."Posting Date");
                           VATEntry.SETRANGE("Document No.",VendLedgEntry3."Document No.");
                           IF VATEntry.FIND('-') THEN
                             REPEAT
                               IF VATEntry."Remaining Unrealized Amount" <> 0 THEN
                                 BEGIN
                                   CreditVATAmtTmp := CreditVATAmtTmp + VATEntry."Remaining Unrealized Amount";
                                 END;
                               IF VATEntry.Amount <> 0 THEN
                                 BEGIN
                                   CreditVATAmtTmp := CreditVATAmtTmp + VATEntry.Amount;
                                 END;

                             UNTIL VATEntry.NEXT=0;
                           totCreditVATAmtTmp += CreditVATAmtTmp;
                         END;

        TotalFields=Amount (LCY) Incl. VAT,WHT Amount (LCY);
        DataItemLink=Settle Petty Cash No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19400;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000082;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000089;Label  ;1450 ;50   ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description }
            { 1000000092;Label  ;10000;50   ;2320 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Goods/Service }
            { 1000000132;Label  ;12800;50   ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Input VAT }
            { 1000000133;Label  ;16100;50   ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000135;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000136;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000140;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000141;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000142;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000143;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000123;TextBox;400  ;50   ;9050 ;600  ;FontSize=8;
                                                         SourceExpr=VendLedgEntry3.Description + '   #' +VendLedgEntry3."External Document No." }
            { 1000000138;TextBox;9650 ;50   ;2850 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Amount (LCY) Incl. VAT" + "WHT Amount (LCY)" - CreditVATAmtTmp }
            { 1000000074;TextBox;12800;50   ;2900 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATAmtTmp }
            { 1000000076;TextBox;16050;50   ;3050 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Amount (LCY) Incl. VAT" + "WHT Amount (LCY)" }
            { 1000000149;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000154;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000156;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000157;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000159;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000160;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=VendLEFooter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=730;
            OnPreSection=BEGIN
                           IF ShowBlank = TRUE THEN
                             CurrReport.SHOWOUTPUT(TRUE)
                           ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000182;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000183;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000187;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000193;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000197;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000198;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=2180;
          }
          CONTROLS
          {
            { 1000000066;Label  ;150  ;850  ;12900;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Case of Witholding tax.............................Rate........%.....................From.............................. }
            { 1000000071;Label  ;4650 ;0    ;1950 ;650  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000091;Label  ;150  ;1450 ;8250 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=(No. Letter of Witholding tax.......................................) }
            { 1000000126;TextBox;6600 ;0    ;2800 ;650  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Settle Petty Cash Line"."Amount (LCY) Incl. VAT" + "Settle Petty Cash Line"."WHT Amount (LCY)" }
            { 1000000128;TextBox;9650 ;0    ;2850 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Settle Petty Cash Line"."Amount (LCY) Incl. VAT" + "Settle Petty Cash Line"."WHT Amount (LCY)" - totCreditVATAmtTmp }
            { 1000000130;TextBox;12800;0    ;2900 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=totCreditVATAmtTmp }
            { 1000000134;TextBox;16050;0    ;3050 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Settle Petty Cash Line"."Amount (LCY) Incl. VAT" + "Settle Petty Cash Line"."WHT Amount (LCY)" }
            { 1000000137;TextBox;150  ;0    ;4400 ;650  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotalItemText }
            { 1000000139;Label  ;13100;850  ;2320 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=WHT Amount }
            { 1000000144;TextBox;16050;750  ;3050 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Settle Petty Cash Line"."WHT Amount (LCY)";
                                                         AutoFormatType=1 }
            { 1000000148;TextBox;16050;1450 ;3050 ;550  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=[ FORMAT(ABS(TotalAmt),0,'<Precision,2:2><Standard Format,0>')] }
            { 1000000162;Label  ;12850;1550 ;2770 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Net Payment (Baht) }
            { 1000000163;Shape  ;0    ;0    ;30   ;2150 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000165;Shape  ;19230;0    ;30   ;2150 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000185;Shape  ;15850;0    ;30   ;2150 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000186;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000188;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000189;Shape  ;0    ;2150 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000190;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000191;Shape  ;15850;1400 ;3400 ;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19400;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000111;Label  ;16050;50   ;3050 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CREDIT }
            { 1000000112;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000113;Label  ;12750;50   ;3000 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DEBIT }
            { 1000000114;Shape  ;12580;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000164;Label  ;3400 ;50   ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Account Name }
            { 1000000118;Shape  ;3000 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000109;Label  ;150  ;50   ;2700 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Account Code }
            { 1000000029;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000031;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000008;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000011;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19400;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000062;Label  ;15500;0    ;3600 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue Next Page. }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitDetail;
        OnPreDataItem=BEGIN
                        //Clear credit amount less than zero.
                        I := 0;
                        REPEAT
                          I := I + 1;
                          IF CreditAmount[I] < 0 THEN BEGIN
                            MatchAcc := FALSE;
                            J := 0;
                            REPEAT
                              J := J + 1;
                              IF DebitAccNo[J] = '' THEN
                                MatchAcc := TRUE;
                            UNTIL (J>=300) OR MatchAcc;
                            IF MatchAcc THEN BEGIN
                              DebitAccNo[J] := CreditAccNo[I];
                              DebitAccName[J] := CreditAccName[I];
                              DebitAmount[J] := -CreditAmount[I];
                              DebitDimValue[J] := CreditDimValue[I];
                              CreditAmount[I] := 0;
                            END;
                          END;
                        UNTIL (I>=300) OR (CreditAccNo[I] = '');

                        //Clear debit amount less than zero.
                        I := 0;
                        REPEAT
                          I := I + 1;
                          IF DebitAmount[I] < 0 THEN BEGIN
                            MatchAcc := FALSE;
                            J := 0;
                            REPEAT
                              J := J + 1;
                              IF CreditAccNo[J] = '' THEN
                                MatchAcc := TRUE;
                            UNTIL (J>=300) OR MatchAcc;
                            IF MatchAcc THEN BEGIN
                              CreditAccNo[J] := DebitAccNo[I];
                              CreditAccName[J] := DebitAccName[I];
                              CreditAmount[J] := -DebitAmount[I];
                              CreditDimValue[J] := DebitDimValue[I];
                              DebitAmount[I] := 0;
                            END;
                          END;
                        UNTIL (I>=300) OR (DebitAccNo[I] = '');

                        //Check balance debit/credit with same g/l account.
                        I := 0;
                        REPEAT
                          I := I + 1;
                          IF DebitAmount[I] > 0 THEN BEGIN
                            MatchAcc := FALSE;
                            J := 0;
                            REPEAT
                              J := J + 1;
                              IF DebitAccNo[I] = CreditAccNo[J] THEN
                                MatchAcc := TRUE;
                            UNTIL (J>=300) OR MatchAcc;
                            IF MatchAcc THEN BEGIN
                              IF DebitAmount[I] >= CreditAmount[J] THEN BEGIN
                                DebitAmount[I] := DebitAmount[I] - CreditAmount[J];
                                CreditAmount[J] := 0;
                              END ELSE BEGIN
                                CreditAmount[J] := CreditAmount[J] - DebitAmount[I];
                                DebitAmount[I] := 0;
                              END;
                            END;
                          END;
                        UNTIL (I>=300) OR (DebitAccNo[I] = '');
                      END;

        OnAfterGetRecord=BEGIN
                           IF DebitAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                           IF DebitAmount[Number] <= 0 THEN
                             CurrReport.SKIP;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           DebitTotalLCY := DebitTotalLCY + DebitAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000001;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccName[Number] }
            { 1000000002;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000003;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccNo[Number] }
            { 1000000005;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000006;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000007;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000009;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000010;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitVATDetail;
        OnAfterGetRecord=BEGIN
                           IF DebitVATNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := DebitVATAmt[Number] <> 0;
                           DebitTotalLCY := DebitTotalLCY + DebitVATAmt[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000030;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVATName[Number] }
            { 1000000038;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVATAmt[Number];
                                                         AutoFormatType=1 }
            { 1000000039;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVATNo[Number] }
            { 1000000040;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000041;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000045;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000049;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=WHTDetail;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(WHTAmt <> 0);
                           IF WHTAmt <> 0 THEN BEGIN
                             Line := Line + 1;
                             DebitTotalLCY := DebitTotalLCY + WHTAmt;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000043;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000044;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAmt;
                                                         AutoFormatType=1 }
            { 1000000075;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000166;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000178;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000179;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000181;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000184;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(CreditWHTAmt > 0);
                           IF CreditWHTAmt > 0 THEN BEGIN
                             Line := Line + 1;
                             DebitTotalLCY := DebitTotalLCY + CreditWHTAmt;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000079;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000080;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditWHTAmt;
                                                         AutoFormatType=1 }
            { 1000000081;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000098;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000105;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000106;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000108;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000117;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(CreditWHTAmt < 0);
                           IF CreditWHTAmt < 0 THEN BEGIN
                             Line := Line + 1;
                             CreditTotalLCY := CreditTotalLCY - CreditWHTAmt;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000052;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000053;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-CreditWHTAmt;
                                                         AutoFormatType=1 }
            { 1000000104;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000212;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000213;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000214;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000216;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000218;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditVATDetail;
        OnAfterGetRecord=BEGIN
                           IF CreditVATNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := CreditVATAmt[Number] <> 0;
                           CreditTotalLCY := CreditTotalLCY + CreditVATAmt[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000054;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATName[Number] }
            { 1000000056;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATAmt[Number];
                                                         AutoFormatType=1 }
            { 1000000057;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATNo[Number] }
            { 1000000058;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000059;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000070;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000072;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000073;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditDetail;
        OnPreDataItem=BEGIN
                        I := 0;
                        MatchAcc := FALSE;
                        REPEAT
                          I := I + 1;
                          IF (CreditAccNo[I] = BankAccNo) AND (CreditAmount[I] <> 0) THEN BEGIN
                            CreditAmount[I] := CreditAmount[I] + CreditWHTAmt;
                            MatchAcc := TRUE;
                          END;
                        UNTIL (I>=300) OR MatchAcc;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number >= 300 THEN
                             CurrReport.BREAK;

                           IF CreditAmount[Number] <= 0 THEN
                             CurrReport.SKIP;
                           IF CreditAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE BEGIN
                             IF NOT MatchAcc THEN BEGIN
                               CreditAmount[Number] := CreditAmount[Number] + CreditWHTAmt;
                               MatchAcc := TRUE;
                             END;
                             Line := Line + 1;
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CreditTotalLCY := CreditTotalLCY + CreditAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000012;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccName[Number] }
            { 1000000014;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000015;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000016;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000018;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000020;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000027;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000028;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccNo[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=LineLoop;
        OnPreDataItem=BEGIN
                        {GenJnlLine3.COPY("Gen. Journal Line");
                        IF GenJnlLine3.NEXT <> 0 THEN
                        IF (GenJnlLine3."Document No." = GenJnlLine2."Document No.") THEN
                          CurrReport.BREAK;  }
                      END;

        OnAfterGetRecord=BEGIN
                           IF Line + Number > 10 THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000021;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000023;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000024;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000026;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000032;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=11440;
      Height=2200;
      SaveValues=Yes;
      OnInit=BEGIN
               Cash := FALSE;
               Cheque := TRUE;
             END;

    }
    CONTROLS
    {
      { 1000000000;CheckBox;3410;110  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Cash;
                                                   SourceExpr=Cash;
                                                   OnValidate=BEGIN
                                                                IF Cash THEN
                                                                  Cheque := FALSE;
                                                              END;
                                                               }
      { 1000000001;Label  ;110  ;110  ;3190 ;440  ;ParentControl=1000000000 }
      { 1000000002;Label  ;110  ;660  ;3190 ;440  ;ParentControl=1000000003 }
      { 1000000003;CheckBox;3410;660  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Cheque;
                                                   SourceExpr=Cheque;
                                                   OnPush=BEGIN
                                                            IF Cheque THEN
                                                              Cash := FALSE;
                                                          END;
                                                           }
      { 1000000004;TextBox;3410 ;1210 ;3300 ;440  ;CaptionML=ENU=Starting Cheque No.;
                                                   SourceExpr=StartingChequeNo }
      { 1000000005;Label  ;110  ;1210 ;3190 ;440  ;ParentControl=1000000004 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000003 : Record 79;
      Vendor@1000000025 : Record 23;
      Vendor2@1000000073 : Record 23;
      VendPostingGroup@1000000036 : Record 93;
      VendLedgEntry@1000000016 : Record 25;
      VendLedgEntry2@1000000075 : Record 25;
      VendLedgEntry3@1000000061 : Record 25;
      VendLedgerEntrybuffer@1000000028 : Record 25;
      VendLedgerEntry@1000000027 : Record 25;
      CreditMemoVendLedgerEntry@1000000010 : Record 25;
      Customer@1000000026 : Record 18;
      CustPostingGroup@1000000035 : Record 92;
      CustLedgEntry@1000000081 : Record 21;
      GLAcc@1000000022 : Record 15;
      BankAcc@1000000030 : Record 270;
      BankAccPostingGroup@1000000034 : Record 277;
      WHTPostingSetup@1000000085 : Record 28043;
      WHTEntry@1000000015 : Record 28044;
      SalesInvLine@1000000084 : Record 113;
      GenJnlLine@1000000045 : Record 81;
      GenJnlLine2@1000000065 : Record 81;
      GenJnlLine3@1000000042 : Record 81;
      xGenJnlLine@1000000086 : Record 81;
      VATEntry@1000000074 : Record 254;
      VATPostSetup@1000000055 : Record 325;
      CheckReport@1000000004 : Report 1401;
      WHTManagement@1000000005 : Codeunit 28040;
      DebitAccount@1000000054 : Code[20];
      CreditAccount@1000000053 : Code[20];
      DebitAccNo@1000000052 : ARRAY [300] OF Code[20];
      CreditAccNo@1000000051 : ARRAY [300] OF Code[20];
      DebitAccName@1000000050 : ARRAY [300] OF Text[150];
      CreditAccName@1000000049 : ARRAY [300] OF Text[150];
      DebitAmount@1000000021 : ARRAY [300] OF Decimal;
      CreditAmount@1000000020 : ARRAY [300] OF Decimal;
      DebitDimValue@1000000013 : ARRAY [300] OF Code[20];
      CreditDimValue@1000000012 : ARRAY [300] OF Code[20];
      DebitVATDimValue@1000000079 : ARRAY [300] OF Code[20];
      CreditVATDimValue@1000000078 : ARRAY [300] OF Code[20];
      DebitVATNo@1000000067 : ARRAY [300] OF Code[20];
      CreditVATNo@1000000062 : ARRAY [300] OF Code[20];
      DebitVATName@1000000060 : ARRAY [300] OF Text[150];
      CreditVATName@1000000059 : ARRAY [300] OF Text[150];
      DebitVATAmt@1000000040 : ARRAY [300] OF Decimal;
      CreditVATAmt@1000000039 : ARRAY [300] OF Decimal;
      VATAccountNo@1000000007 : Code[20];
      VATAccountName@1000000002 : Text[150];
      WHTAccountNo@1000000018 : Code[20];
      WHTAccountName@1000000011 : Text[150];
      DebitTotalLCY@1000000000 : Decimal;
      CreditTotalLCY@1000000001 : Decimal;
      VendName@1000000038 : Text[150];
      DimentionValue@1000000046 : Code[20];
      TextAmount@1000000063 : ARRAY [2] OF Text[250];
      WHTAmt@1000000024 : Decimal;
      WHTBaseAmt@1000000008 : Decimal;
      CreditWHTAmt@1000000068 : Decimal;
      CreditWHTBaseAmt@1000000009 : Decimal;
      TotalAmt@1000000017 : Decimal;
      Line@1000000066 : Integer;
      DocumentNo@1000000029 : Code[20];
      Cash@1000000072 : Boolean;
      Cheque@1000000071 : Boolean;
      xCash@1000000070 : Text[1];
      xCheque@1000000069 : Text[1];
      BankAccNo@1000000014 : Code[20];
      BankName@1000000031 : Text[50];
      BankBranch@1000000032 : Text[30];
      StartingChequeNo@1000000064 : Code[20];
      CheckNo@1000000023 : Code[20];
      CheckDate@1000000019 : Date;
      PayPer@1000000033 : Decimal;
      DebitAmt@1000000037 : Decimal;
      CreditAmt@1000000041 : Decimal;
      DebitAmt2@1000000044 : Decimal;
      CreditAmt2@1000000043 : Decimal;
      MatchAcc@1000000057 : Boolean;
      I@1000000048 : Integer;
      J@1000000058 : Integer;
      DebitAppliedVATAmt@1000000076 : Decimal;
      CreditAppliedVATAmt@1000000077 : Decimal;
      PayeeName@1000000080 : Text[250];
      PaymentAmount@1000000082 : Decimal;
      ApplyCreditAmount@1000000083 : Decimal;
      ApplyInvoiceAmount@1000000089 : Decimal;
      g_intPatial@1000000093 : Integer;
      g_decRatioPatial@1000000094 : Decimal;
      g_decVATApplCrd@1000000095 : Decimal;
      FlagStatus@1000000096 : Integer;
      VATAccount@1000000098 : Code[20];
      VATAmount@1000000097 : Decimal;
      CreditVATAmtTmp@1000000102 : Decimal;
      CreditAppliedVATAmtTmp@1000000103 : Decimal;
      totCreditVATAmtTmp@1000000104 : Decimal;
      AmounttoApply@1000000105 : Decimal;
      totAmounttoApply@1000000106 : Decimal;
      ShowBlank@1000000109 : Boolean;
      TotalItemText@1000000047 : Text[30];
      Form50BIS@1000000087 : Report 50002;
      Remark@1000000088 : Text[250];
      PettyCashComtLine@1000000090 : Record 55003;
      TextPageNo@1000000006 : Text[30];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   22.08.2006   KKE   Payment Voucher - Petty Cash
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50088 Suggest Petty Cash Line
{
  OBJECT-PROPERTIES
  {
    Date=02/21/07;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55006;
        DataItemTableView=SORTING(No.);
        OnAfterGetRecord=BEGIN
                           LineNo := 0;
                           SettlePettyCashLine.RESET;
                           SettlePettyCashLine.SETRANGE("Settle Petty Cash No.","No.");
                           IF SettlePettyCashLine.FIND('+') THEN
                             LineNo := SettlePettyCashLine."Line No.";

                           VendLedgEntry.RESET;
                           VendLedgEntry.SETCURRENTKEY("Vendor No.","Posting Date","Currency Code");
                           VendLedgEntry.SETRANGE("Vendor No.","Petty Cash Vendor No.");
                           VendLedgEntry.SETFILTER("Posting Date",'..%1',"Posting Date");
                           VendLedgEntry.SETRANGE("Document Type",VendLedgEntry."Document Type"::Invoice);
                           VendLedgEntry.SETRANGE(Open,TRUE);
                           IF VendLedgEntry.FIND('-') THEN
                             REPEAT
                               VendLedgEntry.CALCFIELDS("Remaining Amt. (LCY)");
                               IF VendLedgEntry."Remaining Amt. (LCY)" <> 0 THEN BEGIN
                                 SettlePettyCashLine.RESET;
                                 SettlePettyCashLine.SETCURRENTKEY("Entry No.");
                                 SettlePettyCashLine.SETRANGE("Entry No.",VendLedgEntry."Entry No.");
                                 IF NOT SettlePettyCashLine.FINDFIRST THEN BEGIN
                                   LineNo += 10000;
                                   SettlePettyCashLine2.INIT;
                                   SettlePettyCashLine2."Settle Petty Cash No." := "No.";
                                   SettlePettyCashLine2."Line No." := LineNo;
                                   SettlePettyCashLine2."Petty Cash Vendor No." := VendLedgEntry."Vendor No.";
                                   SettlePettyCashLine2.VALIDATE("Entry No.",VendLedgEntry."Entry No.");
                                   SettlePettyCashLine2.INSERT;
                                 END;
                               END;
                             UNTIL VendLedgEntry.NEXT=0;
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      VendLedgEntry@1000000000 : Record 25;
      SettlePettyCashLine@1000000001 : Record 55007;
      SettlePettyCashLine2@1000000002 : Record 55007;
      LineNo@1000000003 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.08.2006   KKE   Petty Cash.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50089 Settle Petty Cash - Test
{
  OBJECT-PROPERTIES
  {
    Date=02/21/07;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55006;
        DataItemTableView=SORTING(No.);
        OnAfterGetRecord=BEGIN
                           SETFILTER("Date Filter",'..%1',"Posting Date");
                           CALCFIELDS("Balance Amount","Balance Settle");
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18900;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Settle Petty Cash - Test }
            { 1000000002;TextBox;15600;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;18300;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;17550;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;16500;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=3384;
          }
          CONTROLS
          {
            { 1000000008;TextBox;3600 ;0    ;2250 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="No." }
            { 1000000009;Label  ;0    ;0    ;3450 ;423  ;ParentControl=1000000008 }
            { 1000000011;TextBox;3600 ;423  ;2250 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Petty Cash Vendor No." }
            { 1000000012;Label  ;0    ;423  ;3450 ;423  ;ParentControl=1000000011 }
            { 1000000014;TextBox;3600 ;846  ;5550 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Petty Cash Name" }
            { 1000000015;Label  ;0    ;846  ;3450 ;423  ;ParentControl=1000000014 }
            { 1000000017;TextBox;3600 ;1269 ;5550 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Payment Invoice Description" }
            { 1000000018;Label  ;0    ;1269 ;3450 ;423  ;ParentControl=1000000017 }
            { 1000000020;TextBox;3600 ;2115 ;300  ;423  ;HorzAlign=Left;
                                                         SourceExpr="Settle Account Type" }
            { 1000000021;Label  ;0    ;2115 ;3450 ;423  ;ParentControl=1000000020 }
            { 1000000023;TextBox;3600 ;2538 ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Settle Account No." }
            { 1000000024;Label  ;0    ;2538 ;3450 ;423  ;ParentControl=1000000023 }
            { 1000000026;TextBox;13350;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Posting Date" }
            { 1000000027;Label  ;10200;0    ;3000 ;423  ;ParentControl=1000000026 }
            { 1000000029;TextBox;13350;423  ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Document Date" }
            { 1000000030;Label  ;10200;423  ;3000 ;423  ;ParentControl=1000000029 }
            { 1000000032;TextBox;13350;846  ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Petty Cash Amount" }
            { 1000000033;Label  ;10200;846  ;3000 ;423  ;ParentControl=1000000032 }
            { 1000000038;TextBox;13350;1692 ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Balance Settle" }
            { 1000000039;Label  ;10200;1692 ;3000 ;423  ;ParentControl=1000000038 }
            { 1000000049;TextBox;13350;1269 ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Balance Amount" }
            { 1000000050;Label  ;10200;1269 ;3000 ;423  ;ParentControl=1000000049 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55007;
        DataItemTableView=SORTING(Settle Petty Cash No.,Line No.);
        TotalFields=Amount Incl. VAT,Amount (LCY) Incl. VAT,WHT Amount (LCY);
        DataItemLink=Settle Petty Cash No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18900;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000007;Label  ;0    ;0    ;1050 ;846  ;ParentControl=1000000000;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000013;Label  ;1200 ;0    ;1200 ;846  ;ParentControl=1000000010;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000019;Label  ;2550 ;0    ;750  ;846  ;ParentControl=1000000016;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000025;Label  ;3450 ;0    ;2250 ;846  ;ParentControl=1000000022;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000031;Label  ;5850 ;0    ;4500 ;846  ;ParentControl=1000000028;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000037;Label  ;10500;0    ;1500 ;846  ;ParentControl=1000000034;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000041;Label  ;12150;0    ;2250 ;846  ;ParentControl=1000000040;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000043;Label  ;14550;0    ;2250 ;846  ;ParentControl=1000000042;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000045;Label  ;16950;0    ;1800 ;846  ;ParentControl=1000000044;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;0    ;1050 ;423  ;SourceExpr="Entry No." }
            { 1000000010;TextBox;1200 ;0    ;1200 ;423  ;SourceExpr="Posting Date" }
            { 1000000016;TextBox;2550 ;0    ;750  ;423  ;SourceExpr="Document Type" }
            { 1000000022;TextBox;3450 ;0    ;2250 ;423  ;SourceExpr="Document No." }
            { 1000000028;TextBox;5850 ;0    ;4500 ;423  ;SourceExpr=Description }
            { 1000000034;TextBox;10500;0    ;1500 ;423  ;SourceExpr="Currency Code" }
            { 1000000040;TextBox;12150;0    ;2250 ;423  ;SourceExpr="Amount Incl. VAT" }
            { 1000000042;TextBox;14550;0    ;2250 ;423  ;SourceExpr="Amount (LCY) Incl. VAT" }
            { 1000000044;TextBox;16950;0    ;1800 ;423  ;SourceExpr="WHT Amount (LCY)" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000046;TextBox;16950;0    ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr="WHT Amount (LCY)" }
            { 1000000047;TextBox;14550;0    ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr="Amount (LCY) Incl. VAT" }
            { 1000000048;TextBox;12150;0    ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr="Amount Incl. VAT" }
            { 1000000035;Label  ;6450 ;0    ;1950 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      BalanceSettle@1000000000 : Decimal;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.08.2006   KKE   Petty Cash.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50090 Check - Petty Cash
{
  OBJECT-PROPERTIES
  {
    Date=02/17/10;
    Time=[ 4:49:39 AM];
    Version List=AVATHA4.40,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Check;
               THA=ตรวจสอบ];
    TopMargin=1600;
    BottomMargin=0;
    LeftMargin=5000;
    OnPreReport=BEGIN
                  InitTextVariable;
                END;

    Orientation=Landscape;
    PaperSize=Envelope DL 110 x 220mm;
    HorzGrid=100;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55006;
        DataItemTableView=SORTING(No.);
        DataItemVarName=VoidSettlePettyCash;
        OnPreDataItem=BEGIN
                        IF CurrReport.PREVIEW THEN
                          ERROR(Text000);

                        //KKE : #002 +
                        IF ManualCheck THEN
                          CurrReport.BREAK;
                        //KKE : #002 -

                        IF UseCheckNo = '' THEN
                          ERROR(Text001);

                        IF TestPrint THEN
                          CurrReport.BREAK;

                        IF NOT ReprintChecks THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           CheckManagement.VoidCheckPettyCash(VoidSettlePettyCash);
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table55006;
        DataItemTableView=SORTING(No.);
        DataItemVarName=SettlePettyCash;
        OnPreDataItem=BEGIN
                        SettlePettyCash.COPY(VoidSettlePettyCash);
                        CompanyInfo.GET;
                        IF NOT TestPrint THEN BEGIN
                          FormatAddr.Company(CompanyAddr,CompanyInfo);
                          BankAcc2.GET(BankAcc2."No.");
                          BankAcc2.TESTFIELD(Blocked,FALSE);
                          COPY(VoidSettlePettyCash);
                          //KKE : #002 +
                          IF ManualCheck THEN
                            SETRANGE("Bank Payment Type","Bank Payment Type"::"Manual Check")
                          ELSE BEGIN
                          //KKE : #002 -
                            SETRANGE("Bank Payment Type","Bank Payment Type"::"Computer Check");
                            SETRANGE("Cheque Printed",FALSE);
                          END;
                        END ELSE BEGIN
                          CLEAR(CompanyAddr);
                          FOR i := 1 TO 5 DO
                            CompanyAddr[i] := Text003;
                        END;
                        ChecksPrinted := 0;

                        SETRANGE("Settle Account Type",SettlePettyCash."Settle Account Type"::"Fixed Asset");
                        IF FIND('-') THEN
                          SettlePettyCash.FIELDERROR("Settle Account Type");
                        SETRANGE("Settle Account Type");
                      END;

        OnAfterGetRecord=BEGIN
                           TESTFIELD(Status,Status::Released);

                           IF (SettlePettyCash."Currency Code" <> '') AND
                              (SettlePettyCash."Currency Code" <> Currency.Code)
                           THEN BEGIN
                             Currency.GET(SettlePettyCash."Currency Code");
                             Currency.TESTFIELD("Conv. LCY Rndg. Debit Acc.");
                             Currency.TESTFIELD("Conv. LCY Rndg. Credit Acc.");
                           END;

                           CALCFIELDS("Balance Settle");
                           IF NOT TestPrint THEN BEGIN
                             IF "Balance Settle" = 0 THEN
                               CurrReport.SKIP;

                             TESTFIELD("Settle Account Type","Settle Account Type"::"Bank Account");
                             IF "Settle Account No." <> BankAcc2."No." THEN
                               CurrReport.SKIP;

                             IF "Settle Account No." <> '' THEN BEGIN
                               BalancingType := "Settle Account Type"::Vendor;
                               BalancingNo := "Petty Cash Vendor No.";
                               RemainingAmount := -"Balance Settle";
                               Vend.GET(BalancingNo);
                               IF Vend.Blocked IN [Vend.Blocked::All,Vend.Blocked::Payment] THEN
                                 ERROR(Text064,Vend.FIELDCAPTION(Blocked),Vend.Blocked,Vend.TABLECAPTION,Vend."No.");
                               IF BankAcc2."Currency Code" <> "Currency Code" THEN
                                 ERROR(Text005);
                               IF "Paid to Vendor Name" <> '' THEN
                                 VendorName := "Paid to Vendor Name"
                               ELSE
                                 IF Vend."Name (Thai)" <> '' THEN
                                   VendorName := Vend."Name (Thai)"
                                 ELSE
                                   VendorName := Vend.Name + Vend."Name 2";
                             END ELSE
                               FIELDERROR("Settle Account No.",Text004);

                             CheckDateText := FORMAT("Posting Date",0,4);
                           END ELSE BEGIN
                             IF ChecksPrinted > 0 THEN
                               CurrReport.BREAK;
                             BalancingType := BalancingType::Vendor;
                             BalancingNo := Text010;
                             CheckNoText := Text011;
                             CheckDateText := Text012;
                           END;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=CheckPages;
        OnPreDataItem=BEGIN
                        FirstPage := TRUE;
                        FoundLast := FALSE;
                        TotalLineAmount := 0;
                        TotalLineDiscount := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF FoundLast THEN
                             CurrReport.BREAK;

                           UseCheckNo := INCSTR(UseCheckNo);
                           IF NOT TestPrint THEN
                             CheckNoText := UseCheckNo
                           ELSE
                             CheckNoText := Text011;
                           TotWHTAmount:=0;
                         END;

        OnPostDataItem=BEGIN
                         IF NOT TestPrint THEN BEGIN
                           IF UseCheckNo <> SettlePettyCash."Cheque No." THEN BEGIN
                             SettlePettyCash3.RESET;
                             SettlePettyCash3.SETRANGE("Cheque No.",UseCheckNo);
                             IF SettlePettyCash3.FIND('-') THEN
                               SettlePettyCash3.FIELDERROR("Cheque No.",STRSUBSTNO(Text013,UseCheckNo));
                           END;

                           SettlePettyCash3 := SettlePettyCash;
                           //SettlePettyCash3.TESTFIELD("No. Series",'');

                           SettlePettyCash3."Cheque No." := UseCheckNo;
                           SettlePettyCash3."Cheque Printed" := TRUE;
                           IF NOT ManualCheck THEN
                             SettlePettyCash3.MODIFY;
                         END;

                         IF NOT ManualCheck THEN BEGIN //KKE : #002
                           BankAcc2."Last Check No." := UseCheckNo;
                           BankAcc2.MODIFY;
                         END;

                         COMMIT;
                         CLEAR(CheckManagement);
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=PrintSettledLoop;
        OnPreDataItem=BEGIN
                        IF NOT TestPrint THEN
                          FoundLast := TRUE
                        ELSE
                          FoundLast := FALSE;
                      END;

        OnAfterGetRecord=VAR
                           GenJnlLine1@1500000 : Record 81;
                         BEGIN
                           IF NOT TestPrint THEN BEGIN
                             IF RemainingAmount <> 0 THEN BEGIN
                               DocType := Text015;
                               DocNo := '';
                               ExtDocNo := '';
                               LineAmount := RemainingAmount;
                               LineAmount2 := RemainingAmount;
                               LineDiscount := 0;
                               RemainingAmount := 0;
                               LineWHT := 0;
                             END ELSE
                               CurrReport.BREAK;
                             TotalLineAmount := TotalLineAmount + LineAmount2;
                             TotalLineDiscount := TotalLineDiscount + LineDiscount;
                           END ELSE BEGIN
                             IF FoundLast THEN
                               CurrReport.BREAK;
                             FoundLast := TRUE;
                             DocType := Text018;
                             DocNo := Text010;
                             ExtDocNo := Text010;
                             LineAmount := 0;
                             LineDiscount := 0;
                           END;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        MaxIteration=1;
        DataItemVarName=PrintCheck;
        OnAfterGetRecord=BEGIN
                           IF NOT TestPrint THEN BEGIN
                             WITH SettlePettyCash DO BEGIN
                               CheckLedgEntry.INIT;
                               CheckLedgEntry."Bank Account No." := BankAcc2."No.";
                               CheckLedgEntry."Posting Date" := "Cheque Date";  //KKE : #005
                               CheckLedgEntry."Document Type" := CheckLedgEntry."Document Type"::Payment;
                               CheckLedgEntry."Document No." := UseCheckNo;
                               IF "Payment Invoice Description" <> '' THEN
                                 CheckLedgEntry.Description := "Payment Invoice Description"
                               ELSE
                                 CheckLedgEntry.Description := COPYSTR("Paid to Vendor Name",1,50);
                               CheckLedgEntry."Bank Payment Type" := "Bank Payment Type";
                               CheckLedgEntry."Bal. Account Type" := BalancingType;
                               CheckLedgEntry."Bal. Account No." := BalancingNo;
                               CheckLedgEntry."WHT Amount" := TotWHTAmount;
                               CheckLedgEntry."PDC Check No." := "Cheque No.";
                               CheckLedgEntry."Interest Amount" := InterestAmount;
                               IF FoundLast THEN BEGIN
                                 IF TotalLineAmount < 0 THEN
                                   ERROR(
                                     Text020,
                                     UseCheckNo,TotalLineAmount-TotWHTAmount);
                                 CheckLedgEntry."Entry Status" := CheckLedgEntry."Entry Status"::Printed;
                                 CheckLedgEntry.Amount := TotalLineAmount + TotWHTAmount; //KKE
                               END ELSE BEGIN
                                 CheckLedgEntry."Entry Status" := CheckLedgEntry."Entry Status"::Voided;
                                 CheckLedgEntry.Amount := 0;
                               END;
                               CheckLedgEntry."Check Date" := "Cheque Date";  //KKE : #005
                               CheckLedgEntry."Check No." := UseCheckNo;

                               IF NOT ManualCheck THEN  //KKE : #002
                                 CheckManagement.InsertCheck(CheckLedgEntry);

                               IF FoundLast THEN BEGIN
                                 CheckAmountText := FORMAT(CheckLedgEntry.Amount,0);
                                 i := STRPOS(CheckAmountText,'.');
                                 CASE TRUE OF
                                   i = 0:
                                     CheckAmountText := CheckAmountText + '.00';
                                   i = STRLEN(CheckAmountText) - 1:
                                     CheckAmountText := CheckAmountText + '0';
                                   i > STRLEN(CheckAmountText) - 2:
                                     CheckAmountText := COPYSTR(CheckAmountText,1,i + 2);
                                 END;
                                 //KKE : #008 +
                                 IF GLOBALLANGUAGE = 1054 THEN
                                   TextAmount := '**' + Form50BIS.FormatNoThaiText(CheckLedgEntry.Amount) + '**'
                                 ELSE BEGIN
                                 //KKE : #008 -
                                   FormatNoText(DescriptionLine,CheckLedgEntry.Amount,BankAcc2."Currency Code");
                                   TextAmount := '**' + DescriptionLine[1] + '**'; //KKE : #008
                                 END;
                                 //FormatNoText(DescriptionLine,CheckLedgEntry.Amount,BankAcc2."Currency Code");
                                 VoidText := '';
                               END ELSE BEGIN
                                 CLEAR(CheckAmountText);
                                 CLEAR(DescriptionLine);
                                 DescriptionLine[1] := Text021;
                                 DescriptionLine[2] := DescriptionLine[1];
                                 VoidText := Text022;
                               END;
                             END;
                           END ELSE BEGIN
                             WITH SettlePettyCash DO BEGIN
                               CheckLedgEntry.INIT;
                               CheckLedgEntry."Bank Account No." := BankAcc2."No.";
                               CheckLedgEntry."Posting Date" := "Cheque Date";  //KKE : #005
                               CheckLedgEntry."Document No." := UseCheckNo;
                               CheckLedgEntry.Description := Text023;
                               CheckLedgEntry."Bank Payment Type" := "Bank Payment Type"::"Computer Check";
                               CheckLedgEntry."Entry Status" := CheckLedgEntry."Entry Status"::"Test Print";
                               CheckLedgEntry."Check Date" := "Cheque Date";  //KKE : #005
                               CheckLedgEntry."Check No." := UseCheckNo;

                               IF NOT ManualCheck THEN  //KKE : #002
                                 CheckManagement.InsertCheck(CheckLedgEntry);

                               CheckAmountText := Text024;
                               DescriptionLine[1] := Text025;
                               DescriptionLine[2] := DescriptionLine[1];
                               VoidText := Text022;
                             END;
                           END;

                           ChecksPrinted := ChecksPrinted + 1;
                           FirstPage := FALSE;

                           //GKU:005+
                           DocDateText := FORMAT(SettlePettyCash."Cheque Date",0,'<Day,2><Month,2><Year4>');
                           DocDDMMYY[1] := COPYSTR(DocDateText,1,1);
                           DocDDMMYY[2] := COPYSTR(DocDateText,2,1);
                           DocDDMMYY[3] := COPYSTR(DocDateText,3,1);
                           DocDDMMYY[4] := COPYSTR(DocDateText,4,1);
                           DocDDMMYY[5] := COPYSTR(DocDateText,5,1);
                           DocDDMMYY[6] := COPYSTR(DocDateText,6,1);
                           DocDDMMYY[7] := COPYSTR(DocDateText,7,1);
                           DocDDMMYY[8] := COPYSTR(DocDateText,8,1);
                           //GKU:005-
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Bank of Ayudhya";
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;2700 ;1850 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000001;TextBox;10600;2750 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000002;TextBox;6400 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=SettlePettyCash."Cheque Date" }
            { 1000000003;TextBox;2700 ;1050 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000004;Label  ;2300 ;0    ;4300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Siam Commercial Bank }
            { 1000000007;TextBox;15500;1100 ;1300 ;550  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=Helvetica;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=xxx }
            { 1000000022;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000023;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000029;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000030;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000037;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000038;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000040;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000041;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Bangkok Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;2700 ;1900 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000009;TextBox;10600;2900 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000010;TextBox;6300 ;150  ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=SettlePettyCash."Cheque Date" }
            { 1000000011;TextBox;2700 ;1100 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000012;Label  ;2300 ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Bangkok Bank }
            { 1000000015;TextBox;15500;1150 ;1300 ;550  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=Helvetica;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=xxx }
            { 1000000042;TextBox;14000;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000043;TextBox;14600;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000044;TextBox;15200;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000045;TextBox;15800;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000046;TextBox;12800;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000047;TextBox;13400;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000048;TextBox;12200;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000049;TextBox;11600;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Kasikorn Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000005;TextBox;2600 ;2250 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000006;TextBox;10900;3150 ;5700 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000013;TextBox;5300 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=FORMAT(SettlePettyCash."Cheque Date",0,'<Day,2>-<Month Text>-<Year4>') }
            { 1000000014;TextBox;2600 ;1500 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000016;Label  ;0    ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Kasikorn Bank }
            { 1000000050;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000051;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000052;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000053;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000054;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000055;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000056;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000057;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Thai Military Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000024;TextBox;3000 ;1900 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000025;TextBox;10900;2950 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000026;TextBox;6400 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=SettlePettyCash."Cheque Date" }
            { 1000000027;TextBox;3000 ;1100 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000028;Label  ;2300 ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Thai Military Bank }
            { 1000000031;TextBox;15800;1150 ;1300 ;550  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=Helvetica;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=xxx }
            { 1000000058;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000059;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000060;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000061;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000062;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000063;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000064;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000065;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Krung Thai Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000032;TextBox;3100 ;2050 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000033;TextBox;11000;2800 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000034;TextBox;6000 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=SettlePettyCash."Cheque Date" }
            { 1000000035;TextBox;3100 ;1250 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000036;Label  ;2300 ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Krung Thai Bank }
            { 1000000039;TextBox;15900;1250 ;1300 ;550  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=Helvetica;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=xxx }
            { 1000000066;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000067;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000068;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000069;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000070;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000071;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000072;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000073;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Deutsche Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000017;TextBox;1500 ;4250 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000018;TextBox;11000;3250 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000019;TextBox;5500 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=FORMAT(SettlePettyCash."Cheque Date",0,'<Day,2>-<Month Text>-<Year4>') }
            { 1000000020;TextBox;1500 ;2400 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000021;Label  ;0    ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Deutsche Bank }
            { 1000000074;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000075;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000076;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000077;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000078;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000079;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000080;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000081;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5610;
      Height=4400;
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   //KKE : #002 +
                   ManualCheck := FALSE;
                   RequestOptionsForm."Last Check No.".EDITABLE := NOT ManualCheck;
                   //KKE : #002 -

                   IF BankAcc2."No." <> '' THEN BEGIN
                     IF BankAcc2.GET(BankAcc2."No.") THEN BEGIN
                       IF NOT ManualCheck THEN  //KKE : #002
                         UseCheckNo := BankAcc2."Last Check No."
                     END ELSE BEGIN
                       BankAcc2."No." := '';
                       UseCheckNo := '';
                     END;
                   END;
                 END;

    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;660  ;2200 ;440  ;CaptionML=[ENU=Bank Account;
                                                              THA=บัญชีธนาคาร];
                                                   SourceExpr=BankAcc2."No.";
                                                   TableRelation="Bank Account";
                                                   OnValidate=BEGIN
                                                                IF BankAcc2."No." <> '' THEN BEGIN
                                                                  BankAcc2.GET(BankAcc2."No.");
                                                                  BankAcc2.TESTFIELD("Last Check No.");
                                                                  UseCheckNo := BankAcc2."Last Check No.";
                                                                END;
                                                              END;
                                                               }
      { 2   ;Label        ;0    ;660  ;3300 ;440  ;ParentControl=1 }
      { 3   ;TextBox      ;3410 ;1320 ;2200 ;440  ;Name=Last Check No.;
                                                   CaptionML=[ENU=Last Check No.;
                                                              THA=หมายเลขเช็คหลังสุด];
                                                   SourceExpr=UseCheckNo }
      { 4   ;Label        ;0    ;1320 ;3300 ;440  ;ParentControl=3 }
      { 5   ;CheckBox     ;3410 ;1980 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Reprint Checks;
                                                              THA=พิมพ์เช็คอีกครั้ง];
                                                   SourceExpr=ReprintChecks }
      { 6   ;Label        ;0    ;1980 ;3300 ;440  ;ParentControl=5 }
      { 9   ;CheckBox     ;3410 ;2530 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Test Print;
                                                              THA=ทดสอบพิมพ์];
                                                   SourceExpr=TestPrint }
      { 10  ;Label        ;0    ;2530 ;3300 ;440  ;ParentControl=9 }
      { 13  ;CheckBox     ;3410 ;3080 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Preprinted Stub;
                                                              THA=ส่วนย่อยที่พิมพ์ก่อน];
                                                   SourceExpr=PreprintedStub }
      { 14  ;Label        ;0    ;3080 ;3300 ;440  ;ParentControl=13 }
      { 1000000000;CheckBox;3410;0    ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Manual Check;
                                                   SourceExpr=ManualCheck;
                                                   OnAfterValidate=BEGIN
                                                                     //KKE : #002 +
                                                                     RequestOptionsForm."Last Check No.".EDITABLE := NOT ManualCheck;
                                                                     IF BankAcc2."No." <> '' THEN BEGIN
                                                                       BankAcc2.GET(BankAcc2."No.");
                                                                       IF NOT ManualCheck THEN BEGIN //#3
                                                                         BankAcc2.TESTFIELD("Last Check No.");
                                                                         UseCheckNo := BankAcc2."Last Check No.";
                                                                       END;
                                                                     END;
                                                                     //KKE : #002
                                                                   END;
                                                                    }
      { 1000000001;Label  ;0    ;0    ;3300 ;440  ;ParentControl=1000000000 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Preview is not allowed.;THA=ไม่สามารถดูภาพก่อนพิมพ์ได้';
      Text001@1001 : TextConst 'ENU=Last Check No. must be filled in.;THA=ต้องเติมหมายเลขเช็คหลังสุดด้วย';
      Text002@1002 : TextConst 'ENU=Filters on %1 and %2 are not allowed.;THA=ไม่สามารถใช้ตัวกรองบน %1 และ %2';
      Text003@1003 : TextConst 'ENU=XXXXXXXXXXXXXXXX;THA=XXXXXXXXXXXXXXXX';
      Text004@1004 : TextConst 'ENU=must be entered.;THA=ต้องใส่ข้อมูล';
      Text005@1005 : TextConst 'ENU=The Bank Account and the General Journal Line must have the same currency.;THA=บรรทัดบัญชีธนาคารและสมุดรายวันทั่วไปต้องมีสกุลเงินเหมือนกัน';
      Text006@1006 : TextConst 'ENU=Salesperson;THA=พนักงานขาย';
      Text007@1007 : TextConst 'ENU=Purchaser;THA=ผู้ซื้อ';
      Text008@1008 : TextConst 'ENU=Both Bank Accounts must have the same currency.;THA=บัญชีธนาคารทั้งสองบัญชีต้องมีสกุลเงินเหมือนกัน';
      Text009@1009 : TextConst 'ENU=Our Contact;THA=ผู้ติดต่อของบริษัท';
      Text010@1010 : TextConst 'ENU=XXXXXXXXXX;THA=XXXXXXXXXX';
      Text011@1011 : TextConst 'ENU=XXXX;THA=XXXX';
      Text012@1012 : TextConst 'ENU=XX.XXXXXXXXXX.XXXX;THA=XX.XXXXXXXXXX.XXXX';
      Text013@1013 : TextConst 'ENU=%1 already exists.;THA=มี %1 อยู่แล้ว';
      Text014@1014 : TextConst 'ENU=Check for %1 %2;THA=เช็คสำหรับ %1 %2';
      Text015@1015 : TextConst 'ENU=Payment;THA=การชำระเงิน';
      Text016@1016 : TextConst 'ENU=In the Check report, One Check per Vendor and Document No.\;THA=ในรายงานเช็ค, เช็คหนึ่งฉบับต่อผู้ขายและหมายเลขเอกสาร\';
      Text017@1017 : TextConst 'ENU=must not be activated when Applies-to ID is specified in the journal lines.;THA=ต้องไม่ทำงานเมื่อมีการระบุ ID การใช้ในบรรทัดสมุดรายวัน';
      Text018@1018 : TextConst 'ENU=XXX;THA=XXX';
      Text019@1019 : TextConst 'ENU=Total;THA=ยอดรวม';
      Text020@1020 : TextConst 'ENU=The total amount of check %1 is %2. The amount must be positive.;THA=เช็ค %1 มีจำนวนเงินรวมเป็น %2  จำนวนเงินต้องเป็นค่าบวก';
      Text021@1021 : TextConst 'ENU=VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID;THA=VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID';
      Text022@1022 : TextConst 'ENU=NON-NEGOTIABLE;THA=เจรจาไม่ได้';
      Text023@1023 : TextConst 'ENU=Test print;THA=ทดสอบพิมพ์';
      Text024@1024 : TextConst 'ENU=XXXX.XX;THA=XXXX.XX';
      Text025@1025 : TextConst 'ENU=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX;THA=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX';
      Text026@1026 : TextConst 'ENU=Zero;THA=ศูนย์';
      Text027@1027 : TextConst 'ENU=Hundred;THA=ร้อย';
      Text028@1028 : TextConst 'ENU=And;THA=และ';
      Text029@1029 : TextConst 'ENU=%1 results in a written number that is too long.;THA=%1 เขียนเป็นตัวอักษรแล้วยาวเกินไป';
      Text030@1030 : TextConst 'ENU=" is already applied to %1 %2 for customer %3.";THA=" ได้ใช้กับ %1 %2 สำหรับลูกค้า %3 แล้ว"';
      Text031@1031 : TextConst 'ENU=" is already applied to %1 %2 for vendor %3.";THA=" ได้ใช้กับ %1 %2 สำหรับผู้ขาย %3 แล้ว"';
      Text032@1032 : TextConst 'ENU=One;THA=หนึ่ง';
      Text033@1033 : TextConst 'ENU=Two;THA=สอง';
      Text034@1034 : TextConst 'ENU=Three;THA=สาม';
      Text035@1035 : TextConst 'ENU=Four;THA=สี่';
      Text036@1036 : TextConst 'ENU=Five;THA=ห้า';
      Text037@1037 : TextConst 'ENU=Six;THA=หก';
      Text038@1038 : TextConst 'ENU=Seven;THA=เจ็ด';
      Text039@1039 : TextConst 'ENU=Eight;THA=แปด';
      Text040@1040 : TextConst 'ENU=Nine;THA=เก้า';
      Text041@1041 : TextConst 'ENU=Ten;THA=สิบ';
      Text042@1042 : TextConst 'ENU=Eleven;THA=สิบเอ็ด';
      Text043@1043 : TextConst 'ENU=Twelve;THA=สิบสอง';
      Text044@1044 : TextConst 'ENU=Thirteen;THA=สิบสาม';
      Text045@1045 : TextConst 'ENU=Fourteen;THA=สิบสี่';
      Text046@1046 : TextConst 'ENU=Fifteen;THA=สิบห้า';
      Text047@1047 : TextConst 'ENU=Sixteen;THA=สิบหก';
      Text048@1048 : TextConst 'ENU=Seventeen;THA=สิบเจ็ด';
      Text049@1049 : TextConst 'ENU=Eighteen;THA=สิบแปด';
      Text050@1050 : TextConst 'ENU=Nineteen;THA=สิบเก้า';
      Text051@1051 : TextConst 'ENU=Twenty;THA=ยี่สิบ';
      Text052@1052 : TextConst 'ENU=Thirty;THA=สามสิบ';
      Text053@1053 : TextConst 'ENU=Forty;THA=FORTY';
      Text054@1054 : TextConst 'ENU=Fifty;THA=ห้าสิบ';
      Text055@1055 : TextConst 'ENU=Sixty;THA=หกสิบ';
      Text056@1056 : TextConst 'ENU=Seventy;THA=เจ็ดสิบ';
      Text057@1057 : TextConst 'ENU=Eighty;THA=แปดสิบ';
      Text058@1058 : TextConst 'ENU=Ninety;THA=เก้าสิบ';
      Text059@1059 : TextConst 'ENU=Thousand;THA=พัน';
      Text060@1060 : TextConst 'ENU=Million;THA=ล้าน';
      Text061@1061 : TextConst 'ENU=Billion;THA=พันล้าน';
      CompanyInfo@1062 : Record 79;
      CompanyInfo1@1000000007 : Record 79;
      GenJnlLine2@1064 : Record 81;
      SettlePettyCash3@1065 : Record 55006;
      Cust@1066 : Record 18;
      CustLedgEntry@1067 : Record 21;
      Vend@1068 : Record 23;
      VendLedgEntry@1069 : Record 25;
      BankAcc@1070 : Record 270;
      BankAcc2@1071 : Record 270;
      CheckLedgEntry@1072 : Record 272;
      Currency@1073 : Record 4;
      FormatAddr@1074 : Codeunit 365;
      CheckManagement@1075 : Codeunit 367;
      CompanyAddr@1076 : ARRAY [8] OF Text[50];
      OnesText@1078 : ARRAY [20] OF Text[30];
      TensText@1079 : ARRAY [10] OF Text[30];
      ExponentText@1080 : ARRAY [5] OF Text[30];
      BalancingType@1081 : 'G/L Account,Customer,Vendor,Bank Account';
      BalancingNo@1082 : Code[20];
      CheckNoText@1084 : Text[30];
      CheckDateText@1085 : Text[30];
      CheckAmountText@1086 : Text[30];
      DescriptionLine@1087 : ARRAY [2] OF Text[80];
      DocType@1088 : Text[30];
      DocNo@1089 : Text[30];
      ExtDocNo@1119 : Text[30];
      VoidText@1090 : Text[30];
      LineAmount@1091 : Decimal;
      LineDiscount@1092 : Decimal;
      TotalLineAmount@1093 : Decimal;
      TotalLineDiscount@1094 : Decimal;
      RemainingAmount@1095 : Decimal;
      CurrentLineAmount@1096 : Decimal;
      UseCheckNo@1097 : Code[20];
      FoundLast@1098 : Boolean;
      ReprintChecks@1099 : Boolean;
      TestPrint@1100 : Boolean;
      FirstPage@1101 : Boolean;
      OneCheckPrVendor@1102 : Boolean;
      FoundNegative@1103 : Boolean;
      ApplyMethod@1104 : 'Payment,OneLineOneEntry,OneLineID,MoreLinesOneEntry';
      ChecksPrinted@1105 : Integer;
      PreprintedStub@1107 : Boolean;
      TotalText@1108 : Text[10];
      DocDate@1109 : Date;
      i@1110 : Integer;
      Text062@1111 : TextConst 'ENU=G/L Account,Customer,Vendor,Bank Account;THA=บัญชี G/L,ลูกค้า,ผู้ขาย,บัญชีธนาคาร';
      CurrencyCode2@1112 : Code[10];
      NetAmount@1114 : Text[30];
      CurrencyExchangeRate@1115 : Record 330;
      LineAmount2@1116 : Decimal;
      Text063@1117 : TextConst 'ENU=Net Amount %1;THA=จำนวนสุทธิ %1';
      GLSetup@1118 : Record 98;
      Text064@1113 : TextConst 'ENU=%1 must not be %2 for %3 %4.;THA=%1 ต้องไม่เป็น %2 สำหรับ %3 %4';
      WHTSkip@1500005 : Boolean;
      InterestAmountLCY@1500004 : Decimal;
      InterestAmount@1500003 : Decimal;
      LineWHT@1500002 : Decimal;
      TotWHTAmount@1500001 : Decimal;
      WHTManagement@1500000 : Codeunit 28040;
      VendorName@1000000002 : Text[150];
      ManualCheck@1000000001 : Boolean;
      xGenJnlLine2@1000000000 : Record 81;
      UserSetup@1000000008 : Record 91;
      Form50BIS@1000000005 : Report 50002;
      TextAmount@1000000004 : Text[250];
      xxx@1000000003 : Text[30];
      Text50000@1000000009 : TextConst 'ENU=You do not have permission to change cheque to.;THA=คุณไม่ได้รับสิทธิในการเปลี่ยนแปลง &CO ได้';
      DocDateText@1000000010 : Text[30];
      DocDDMMYY@1000000006 : ARRAY [8] OF Text[30];

    PROCEDURE FormatNoText@1(VAR NoText@1000 : ARRAY [2] OF Text[80];No@1001 : Decimal;CurrencyCode@1002 : Code[10]);
    VAR
      PrintExponent@1003 : Boolean;
      Ones@1004 : Integer;
      Tens@1005 : Integer;
      Hundreds@1006 : Integer;
      Exponent@1007 : Integer;
      NoTextIndex@1008 : Integer;
    BEGIN
      CLEAR(NoText);
      NoTextIndex := 1;
      //NoText[1] := '****';
      //KKE : #001 +
      //IF CurrencyCode = '' THEN
      //  NoText[1] := 'Baht'
      //ELSE
        NoText[1] := '';
      //KKE : #001 -

      IF No < 1 THEN
        AddToNoText(NoText,NoTextIndex,PrintExponent,Text026)
      ELSE BEGIN
        FOR Exponent := 4 DOWNTO 1 DO BEGIN
          PrintExponent := FALSE;
          Ones := No DIV POWER(1000,Exponent - 1);
          Hundreds := Ones DIV 100;
          Tens := (Ones MOD 100) DIV 10;
          Ones := Ones MOD 10;
          IF Hundreds > 0 THEN BEGIN
            AddToNoText(NoText,NoTextIndex,PrintExponent,OnesText[Hundreds]);
            AddToNoText(NoText,NoTextIndex,PrintExponent,Text027);
          END;
          IF Tens >= 2 THEN BEGIN
            AddToNoText(NoText,NoTextIndex,PrintExponent,TensText[Tens]);
            IF Ones > 0 THEN
              AddToNoText(NoText,NoTextIndex,PrintExponent,OnesText[Ones]);
          END ELSE
            IF (Tens * 10 + Ones) > 0 THEN
              AddToNoText(NoText,NoTextIndex,PrintExponent,OnesText[Tens * 10 + Ones]);
          IF PrintExponent AND (Exponent > 1) THEN
            AddToNoText(NoText,NoTextIndex,PrintExponent,ExponentText[Exponent]);
          No := No - (Hundreds * 100 + Tens * 10 + Ones) * POWER(1000,Exponent - 1);
        END;
      END;

      //AddToNoText(NoText,NoTextIndex,PrintExponent,Text028);
      //AddToNoText(NoText,NoTextIndex,PrintExponent,FORMAT(No * 100) + '/100');

      //KKE : #001 +
      IF No * 100 <= 0 THEN BEGIN
        IF CurrencyCode = '' THEN
          AddToNoText(NoText,NoTextIndex,PrintExponent,'Baht Only')
        ELSE
          AddToNoText(NoText,NoTextIndex,PrintExponent,'Only');
      END ELSE BEGIN
        AddToNoText(NoText,NoTextIndex,PrintExponent,Text028);
        AddToNoText(NoText,NoTextIndex,PrintExponent,FORMAT(ROUND(No * 100,1)) + '/100');
      END;
      //KKE : #001 -

      IF CurrencyCode <> '' THEN
        AddToNoText(NoText,NoTextIndex,PrintExponent,CurrencyCode);
    END;

    LOCAL PROCEDURE AddToNoText@2(VAR NoText@1000 : ARRAY [2] OF Text[80];VAR NoTextIndex@1001 : Integer;VAR PrintExponent@1002 : Boolean;AddText@1003 : Text[30]);
    BEGIN
      PrintExponent := TRUE;

      WHILE STRLEN(NoText[NoTextIndex] + ' ' + AddText) > MAXSTRLEN(NoText[1]) DO BEGIN
        NoTextIndex := NoTextIndex + 1;
        IF NoTextIndex > ARRAYLEN(NoText) THEN
          ERROR(Text029,AddText);
      END;

      NoText[NoTextIndex] := DELCHR(NoText[NoTextIndex] + ' ' + AddText,'<');
    END;

    PROCEDURE InitTextVariable@5();
    BEGIN
      OnesText[1] := Text032;
      OnesText[2] := Text033;
      OnesText[3] := Text034;
      OnesText[4] := Text035;
      OnesText[5] := Text036;
      OnesText[6] := Text037;
      OnesText[7] := Text038;
      OnesText[8] := Text039;
      OnesText[9] := Text040;
      OnesText[10] := Text041;
      OnesText[11] := Text042;
      OnesText[12] := Text043;
      OnesText[13] := Text044;
      OnesText[14] := Text045;
      OnesText[15] := Text046;
      OnesText[16] := Text047;
      OnesText[17] := Text048;
      OnesText[18] := Text049;
      OnesText[19] := Text050;

      TensText[1] := '';
      TensText[2] := Text051;
      TensText[3] := Text052;
      TensText[4] := Text053;
      TensText[5] := Text054;
      TensText[6] := Text055;
      TensText[7] := Text056;
      TensText[8] := Text057;
      TensText[9] := Text058;

      ExponentText[1] := '';
      ExponentText[2] := Text059;
      ExponentText[3] := Text060;
      ExponentText[4] := Text061;
    END;

    PROCEDURE InitializeRequest@6(BankAcc@1000 : Code[20];LastCheckNo@1001 : Code[20];NewOneCheckPrVend@1002 : Boolean;NewReprintChecks@1003 : Boolean;NewTestPrint@1004 : Boolean;NewPreprintedStub@1005 : Boolean);
    BEGIN
      IF BankAcc <> '' THEN
        IF BankAcc2.GET(BankAcc) THEN BEGIN
          UseCheckNo := LastCheckNo;
          OneCheckPrVendor := NewOneCheckPrVend;
          ReprintChecks := NewReprintChecks;
          TestPrint := NewTestPrint;
          PreprintedStub := NewPreprintedStub;
        END;
    END;

    PROCEDURE ExchangeAmt@7(PostingDate@1000 : Date;CurrencyCode@1001 : Code[10];CurrencyCode2@1003 : Code[10];Amount@1002 : Decimal) Amount2 : Decimal;
    BEGIN
      IF (CurrencyCode <> '')  AND (CurrencyCode2 = '') THEN
         Amount2 :=
           CurrencyExchangeRate.ExchangeAmtLCYToFCY(
             PostingDate,CurrencyCode,Amount,CurrencyExchangeRate.ExchangeRate(PostingDate,CurrencyCode))
      ELSE IF (CurrencyCode = '') AND (CurrencyCode2 <> '') THEN
        Amount2 :=
          CurrencyExchangeRate.ExchangeAmtFCYToLCY(
            PostingDate,CurrencyCode2,Amount,CurrencyExchangeRate.ExchangeRate(PostingDate,CurrencyCode2))
      ELSE IF (CurrencyCode <> '') AND (CurrencyCode2 <> '') AND (CurrencyCode <> CurrencyCode2) THEN
        Amount2 := CurrencyExchangeRate.ExchangeAmtFCYToFCY(PostingDate,CurrencyCode2,CurrencyCode,Amount)
      ELSE
        Amount2 := Amount;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   -Fixed and update WHT.
                               -Correct One Check per Vendor per Document No.
                               -After cheque is printed, document no. field will be replaced by cheque no., system has to move
                                then previously assigned document no. info external document no.
                               -Rounding Satang in amount in word into 2 digit.
      002   11.04.2005   KKE   -If Manual check, system must not replaced document no. by cheque no.
      003   15.02.2006   KKE   -Paper size 9cmX18cm
      004   23.08.2006   KKE   -Petty Cash
      005   16.02.2010   GKU   -Split "Document Date"
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50091 Petty Cash Detail
{
  OBJECT-PROPERTIES
  {
    Date=11/12/07;
    Time=[ 5:38:18 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table25;
        DataItemTableView=SORTING(Vendor No.,Posting Date,Currency Code);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("Vendor No.");

                        SourceCodeSetup.GET;
                        SourceCodeSetup.TESTFIELD("Petty Cash");

                        SETFILTER("Source Code",SourceCodeSetup."Petty Cash");
                      END;

        ReqFilterFields=Vendor No.,Posting Date;
        TotalFields=Amount (LCY),WHT Amount (LCY);
        GroupTotalFields=Vendor No.;
        CalcFields=Amount (LCY),WHT Amount (LCY);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Petty Cash Detail }
            { 1000000002;TextBox;16050;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;423  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;18450;423  ;750  ;423  ;FontSize=8;
                                                         CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;17700;423  ;750  ;423  ;ParentControl=1000000004;
                                                         FontSize=8 }
            { 1000000006;TextBox;16950;846  ;2250 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000012;Label  ;150  ;0    ;1500 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000015;Label  ;2400 ;0    ;2400 ;846  ;ParentControl=1000000014;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;4950 ;0    ;3600 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000021;Label  ;10350;0    ;2400 ;846  ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000024;Label  ;12900;0    ;2100 ;846  ;ParentControl=1000000023;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000027;Label  ;17400;0    ;1800 ;846  ;ParentControl=1000000026;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000007;Label  ;15150;0    ;2100 ;846  ;ParentControl=1000000000;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000016;Label  ;1800 ;0    ;450  ;846  ;ParentControl=1000000010;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000022;Label  ;8700 ;0    ;1500 ;846  ;ParentControl=1000000019;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FooterPrinted;
                           FooterPrinted := FALSE;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Vendor Ledger Entry".FIELDNO("Vendor No.");
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;3150 ;0    ;2400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Vendor No." }
            { 1000000009;Label  ;0    ;0    ;3000 ;423  ;ParentControl=1000000008;
                                                         FontSize=8;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = LastFieldNo;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19350;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000011;TextBox;150  ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Posting Date" }
            { 1000000014;TextBox;2400 ;0    ;2550 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Document No." }
            { 1000000017;TextBox;5100 ;0    ;3600 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=Description }
            { 1000000020;TextBox;10350;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=ENU=Amount (LCY) incl. VAT;
                                                         SourceExpr="Amount (LCY)" - "WHT Amount (LCY)" }
            { 1000000023;TextBox;12900;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr="WHT Amount (LCY)" }
            { 1000000026;TextBox;17400;0    ;1800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Global Dimension 1 Code" }
            { 1000000000;TextBox;15150;0    ;2100 ;423  ;FontSize=8;
                                                         CaptionML=ENU=Amount after WHT;
                                                         SourceExpr="Amount (LCY)" }
            { 1000000010;TextBox;1800 ;0    ;450  ;423  ;FontSize=8;
                                                         SourceExpr="Document Type" }
            { 1000000019;TextBox;8850 ;0    ;1500 ;423  ;SourceExpr="Vendor No." }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF NOT FooterPrinted THEN
                             LastFieldNo := CurrReport.TOTALSCAUSEDBY;
                           CurrReport.SHOWOUTPUT := NOT FooterPrinted;
                           FooterPrinted := TRUE;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Vendor Ledger Entry".FIELDNO("Vendor No.");
                         END;

          }
          CONTROLS
          {
            { 1000000028;TextBox;0    ;0    ;9000 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalFor + FIELDCAPTION("Vendor No.") }
            { 1000000029;TextBox;10050;0    ;2700 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Amount (LCY)" - "WHT Amount (LCY)" }
            { 1000000030;TextBox;12900;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="WHT Amount (LCY)" }
            { 1000000013;TextBox;15150;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Amount (LCY)" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SourceCodeSetup@1000000003 : Record 242;
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      TotalFor@1000000002 : TextConst 'ENU="Total for "';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   24.08.2006   KKE   Petty Cash.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50092 Cash Advance Test
{
  OBJECT-PROPERTIES
  {
    Date=02/21/07;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    LeftMargin=1000;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55051;
        DataItemTableView=SORTING(No.);
        NewPagePerRecord=Yes;
        OnAfterGetRecord=BEGIN
                           ActualVendNo := '';
                         END;

        ReqFilterFields=No.;
        CalcFields=Balance Amount Settle;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18600;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Cash Advance Test }
            { 1000000002;TextBox;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;17700;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;16950;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18600;
            SectionHeight=7191;
          }
          CONTROLS
          {
            { 1000000008;TextBox;3150 ;0    ;2250 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="No." }
            { 1000000009;Label  ;0    ;0    ;3000 ;423  ;ParentControl=1000000008;
                                                         FontBold=Yes }
            { 1000000014;TextBox;3150 ;846  ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Name }
            { 1000000015;Label  ;0    ;846  ;3000 ;423  ;ParentControl=1000000014 }
            { 1000000017;TextBox;3150 ;1269 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Name 2" }
            { 1000000018;Label  ;0    ;1269 ;3000 ;423  ;ParentControl=1000000017 }
            { 1000000020;TextBox;3150 ;1692 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Address }
            { 1000000021;Label  ;0    ;1692 ;3000 ;423  ;ParentControl=1000000020 }
            { 1000000023;TextBox;3150 ;2115 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Address 2" }
            { 1000000024;Label  ;0    ;2115 ;3000 ;423  ;ParentControl=1000000023 }
            { 1000000026;TextBox;3150 ;2538 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Address 3" }
            { 1000000027;Label  ;0    ;2538 ;3000 ;423  ;ParentControl=1000000026 }
            { 1000000029;TextBox;3150 ;2961 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr=City }
            { 1000000030;Label  ;0    ;2961 ;3000 ;423  ;ParentControl=1000000029 }
            { 1000000032;TextBox;3150 ;3384 ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Post Code" }
            { 1000000033;Label  ;0    ;3384 ;3000 ;423  ;ParentControl=1000000032 }
            { 1000000035;TextBox;3150 ;3807 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Name (Thai)" }
            { 1000000036;Label  ;0    ;3807 ;3000 ;423  ;ParentControl=1000000035 }
            { 1000000038;TextBox;3150 ;4230 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Address (Thai)" }
            { 1000000039;Label  ;0    ;4230 ;3000 ;423  ;ParentControl=1000000038 }
            { 1000000041;TextBox;3150 ;5076 ;4500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Invoice Description" }
            { 1000000042;Label  ;0    ;5076 ;3000 ;423  ;ParentControl=1000000041 }
            { 1000000044;TextBox;3150 ;5499 ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Gen. Bus. Posting Group" }
            { 1000000045;Label  ;0    ;5499 ;3000 ;423  ;ParentControl=1000000044 }
            { 1000000047;TextBox;3150 ;5922 ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="VAT Bus. Posting Group" }
            { 1000000048;Label  ;0    ;5922 ;3000 ;423  ;ParentControl=1000000047 }
            { 1000000050;TextBox;3150 ;6345 ;1500 ;423  ;HorzAlign=Left;
                                                         CaptionML=[ENU=WHT Bus. Posting Group;
                                                                    THA=กลุ่มการลงรายการบัญชีธุรกิจ WHT];
                                                         SourceExpr="WHT Business Posting Group" }
            { 1000000051;Label  ;0    ;6345 ;3000 ;423  ;ParentControl=1000000050 }
            { 1000000053;TextBox;14550;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Posting Date" }
            { 1000000054;Label  ;11400;0    ;3000 ;423  ;ParentControl=1000000053 }
            { 1000000056;TextBox;14550;423  ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Document Date" }
            { 1000000057;Label  ;11400;423  ;3000 ;423  ;ParentControl=1000000056 }
            { 1000000059;TextBox;14550;846  ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Location Code" }
            { 1000000060;Label  ;11400;846  ;3000 ;423  ;ParentControl=1000000059 }
            { 1000000065;TextBox;14550;2538 ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Balance Amount Settle" }
            { 1000000066;Label  ;11400;2538 ;3000 ;423  ;ParentControl=1000000065 }
            { 1000000011;TextBox;3150 ;423  ;2250 ;423  ;SourceExpr="Cash Advance Vendor No." }
            { 1000000012;Label  ;0    ;423  ;3000 ;423  ;ParentControl=1000000011;
                                                         FontBold=No;
                                                         MultiLine=Yes }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55052;
        DataItemTableView=SORTING(Document No.,Line No.);
        TotalFields=Amount (LCY) Incl. VAT,VAT Amount (LCY),VAT Base Amount (LCY),Balance Amount Settle;
        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18600;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000013;Label  ;0    ;0    ;1500 ;846  ;ParentControl=1000000010;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000019;Label  ;1650 ;0    ;4500 ;846  ;ParentControl=1000000016;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000031;Label  ;9000 ;0    ;2100 ;846  ;ParentControl=1000000028;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000049;Label  ;11250;0    ;1650 ;846  ;ParentControl=1000000046;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000055;Label  ;6300 ;0    ;750  ;846  ;ParentControl=1000000052;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000061;Label  ;7200 ;0    ;750  ;846  ;ParentControl=1000000058;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000067;Label  ;8100 ;0    ;750  ;846  ;ParentControl=1000000064;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000069;Label  ;16050;0    ;1650 ;846  ;ParentControl=1000000068;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000071;Label  ;17850;0    ;600  ;846  ;ParentControl=1000000070;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000007;Label  ;13050;0    ;900  ;846  ;ParentControl=1000000000;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000076;Label  ;14100;0    ;1800 ;846  ;ParentControl=1000000075;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18600;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000010;TextBox;0    ;0    ;1500 ;423  ;SourceExpr="No." }
            { 1000000016;TextBox;1650 ;0    ;4500 ;423  ;SourceExpr=Description }
            { 1000000028;TextBox;9000 ;0    ;2100 ;423  ;CaptionML=[ENU=Amount (LCY) Excl. VAT;
                                                                    THA=ยอดเงิน (LCY)];
                                                         SourceExpr="VAT Base Amount (LCY)" }
            { 1000000046;TextBox;11250;0    ;1650 ;423  ;SourceExpr="VAT Amount (LCY)" }
            { 1000000052;TextBox;6300 ;0    ;750  ;423  ;SourceExpr="Gen. Prod. Posting Group" }
            { 1000000058;TextBox;7200 ;0    ;750  ;423  ;SourceExpr="VAT Prod. Posting Group" }
            { 1000000064;TextBox;8100 ;0    ;750  ;423  ;SourceExpr="WHT Product Posting Group" }
            { 1000000068;TextBox;16050;0    ;1650 ;423  ;SourceExpr="Actual Vendor No." }
            { 1000000070;TextBox;17850;0    ;600  ;423  ;SourceExpr="Skip WHT" }
            { 1000000000;TextBox;13050;0    ;900  ;423  ;SourceExpr="VAT Difference" }
            { 1000000075;TextBox;14100;0    ;1800 ;423  ;SourceExpr="Balance Amount Settle" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18600;
            SectionHeight=423;
            OnPreSection=BEGIN
                           Remark := CheckPettyCashLine;
                           CurrReport.SHOWOUTPUT := Remark <> '';
                         END;

          }
          CONTROLS
          {
            { 1000000072;TextBox;1650 ;0    ;16800;423  ;FontBold=Yes;
                                                         SourceExpr=Remark }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18600;
            SectionHeight=2538;
          }
          CONTROLS
          {
            { 1000000022;TextBox;9600 ;423  ;2850 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Total Excl. VAT;
                                                         SourceExpr="VAT Base Amount (LCY)" }
            { 1000000025;Label  ;6300 ;423  ;3150 ;423  ;ParentControl=1000000022;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000034;TextBox;9600 ;846  ;2850 ;423  ;FontBold=Yes;
                                                         SourceExpr="VAT Amount (LCY)" }
            { 1000000037;Label  ;6300 ;846  ;3150 ;423  ;ParentControl=1000000034;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000040;TextBox;9600 ;1269 ;2850 ;423  ;FontBold=Yes;
                                                         CaptionML=ENU=Total Incl. VAT;
                                                         SourceExpr="Amount (LCY) Incl. VAT" }
            { 1000000043;Label  ;6300 ;1269 ;3150 ;423  ;ParentControl=1000000040;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000077;TextBox;9600 ;1692 ;2850 ;423  ;FontBold=Yes;
                                                         SourceExpr="Balance Amount Settle" }
            { 1000000078;Label  ;6300 ;1692 ;3150 ;423  ;ParentControl=1000000077;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=%1 must be specify.';
      Text002@1000000001 : TextConst 'ENU=Actual Vendor No. on Petty Cash Line must not be difference.';
      ActualVendNo@1000000003 : Code[20];
      Remark@1000000002 : Text[250];

    PROCEDURE CheckPettyCashLine@1000000002() : Text[250];
    VAR
      WHTPostingSetup@1000000001 : Record 28043;
    BEGIN
      WITH "Cash Advance Line" DO BEGIN
        IF "VAT %" <> 0 THEN
          IF "Actual Vendor No." = '' THEN
            EXIT(STRSUBSTNO(Text001,FIELDCAPTION("Actual Vendor No.")));

        IF NOT "Skip WHT" THEN BEGIN
          WHTPostingSetup.GET("WHT Business Posting Group","WHT Product Posting Group");
          IF WHTPostingSetup."WHT %" <> 0 THEN BEGIN
            IF "Actual Vendor No." = '' THEN
              EXIT(STRSUBSTNO(Text001,FIELDCAPTION("Actual Vendor No.")));
            IF "Cash Advance Header"."Printing WHT Slip (Doc:WHT)" = "Cash Advance Header"."Printing WHT Slip (Doc:WHT)"::"1:1"
       THEN BEGIN
              IF ActualVendNo = '' THEN
                ActualVendNo := "Actual Vendor No."
              ELSE
                IF ActualVendNo <> "Actual Vendor No." THEN
                  EXIT(Text002);
            END;
          END;
        END;
      END;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.08.2006   KKE   -Cash Advance
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50093 Purchase Voucher -Cash Advance
{
  OBJECT-PROPERTIES
  {
    Date=02/27/08;
    Time=11:24:10 AM;
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnPreReport=BEGIN
                  CompanyInfo.GET;
                  CompanyInfo.CALCFIELDS(Picture);
                  GLSetup.GetShortcutDimCode(ShortcutDimCode);
                  IF ShortcutDimCode[2] = 'DEPARTMENT' THEN
                    ShortcutDimCode[2] := 'DEPT.';
                END;

    PaperSize=A4 210 x 297 mm;
    HorzGrid=50;
    VertGrid=100;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55051;
        DataItemTableView=SORTING(No.);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        CurrReport.CREATETOTALS(DrAmount,CrAmount);
                      END;

        OnAfterGetRecord=BEGIN
                           CLEAR(AccCode);
                           CLEAR(AccName);
                           CLEAR(Dimension1Code);
                           CLEAR(Dimension2Code);
                           CLEAR(Dimension3Code);
                           CLEAR(Dimension4Code);
                           CLEAR(Dimension5Code);
                           CLEAR(DrAmount);
                           CLEAR(CrAmount);
                           CLEAR(TotalDrAmount);
                           CLEAR(TotalCrAmount);
                           CLEAR(WHTCode);
                           CLEAR(WHTName);
                           CLEAR(WHTCrAmount);
                           CntPage := 0;
                           CntLine := 0;

                           InvDescription := "Invoice Description";
                           PostingDate := "Posting Date";
                           DocumentNo := "No.";
                         END;

        ReqFilterFields=No.;
        GroupTotalFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19750;
            SectionHeight=5900;
            OnPreSection=BEGIN
                           CntLine := 0;
                           CntPage += 1;
                         END;

          }
          CONTROLS
          {
            { 1000000126;Label  ;13400;1900 ;5800 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PRE-POST................................................. }
            { 1000000127;TextBox;11600;0    ;7550 ;850  ;HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=13;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000128;Label  ;13400;2500 ;5800 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=POSTED.................................................... }
            { 1000000129;TextBox;15100;1800 ;3950 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="No." }
            { 1000000130;Label  ;13400;3050 ;5800 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DATE......................................................... }
            { 1000000131;TextBox;14550;3000 ;3700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr="Posting Date" }
            { 1000000132;Label  ;11600;900  ;7550 ;850  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=CLEAR ADVANCE }
            { 1000000133;Shape  ;10   ;4785 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000134;Label  ;16600;5065 ;2600 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=CREDIT }
            { 1000000135;Shape  ;16450;4800 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000136;Label  ;13850;5065 ;2600 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT }
            { 1000000137;Shape  ;7750 ;4800 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000138;Shape  ;6350 ;4785 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000139;Shape  ;2450 ;4800 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000140;Label  ;2600 ;5050 ;3750 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ACCOUNT NAME }
            { 1000000141;Label  ;100  ;5065 ;2350 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=ACCOUNT CODE }
            { 1000000142;Shape  ;10   ;5870 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000143;Shape  ;19250;4800 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000144;Shape  ;0    ;4800 ;30   ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000145;Shape  ;9150 ;4785 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000146;TextBox;6500 ;5100 ;1250 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ShortcutDimCode[1] }
            { 1000000147;TextBox;7900 ;5115 ;1250 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ShortcutDimCode[2] }
            { 1000000148;Shape  ;13700;4800 ;150  ;1100 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000149;Label  ;13400;3650 ;5800 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=PRINTED DATE......................................... }
            { 1000000150;TextBox;15700;3600 ;3300 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=TODAY }
            { 1000000154;Label  ;9300 ;5065 ;4400 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DESCRIPTION }
            { 1000000119;TextBox;1650 ;3500 ;11400;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr="Cash Advance Header"."Cash Advance Vendor No." + '  ' + "Cash Advance Header".Name + '' + "Cash Advance Header"."Name 2" }
            { 1000000121;Label  ;50   ;3500 ;1600 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=VENDOR : }
            { 1000000042;TextBox;0    ;2400 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000043;TextBox;0    ;1800 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr='Tel: ' + CompanyInfo."Phone No." + ' Fax: ' + CompanyInfo."Fax No." }
            { 1000000044;TextBox;0    ;1200 ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000079;TextBox;0    ;600  ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" }
            { 1000000080;TextBox;0    ;0    ;9700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000081;Label  ;0    ;4200 ;2350 ;500  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=DESCRIPTION : }
            { 1000000058;TextBox;2350 ;4200 ;11100;500  ;FontSize=9;
                                                         SourceExpr=InvDescription }
            { 1000000082;TextBox;15250;4200 ;3950 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=STRSUBSTNO('Page : %1',CntPage) }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19750;
            SectionHeight=810;
            OnPreSection=BEGIN
                           CheckReport.InitTextVariable;
                           CheckReport.FormatNoText(TextAmount,ABS(TotalDrAmount),"Currency Code");

                           IF TextAmount[1] <> '' THEN
                             TextAmount[1] := '(' + TextAmount[1] + ')';
                         END;

          }
          CONTROLS
          {
            { 1000000001;Label  ;12250;100  ;1450 ;600  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Total }
            { 1000000014;TextBox;16550;100  ;2600 ;600  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=CREDIT;
                                                         SourceExpr=TotalCrAmount }
            { 1000000016;TextBox;13850;100  ;2600 ;600  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=TotalDrAmount }
            { 1000000018;Shape  ;19250;0    ;30   ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000025;Shape  ;16450;0    ;150  ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000026;Shape  ;13700;0    ;150  ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000027;Shape  ;0    ;0    ;30   ;800  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000028;Shape  ;10   ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000045;Shape  ;10   ;780  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000041;TextBox;100  ;100  ;12100;600  ;FontSize=9;
                                                         SourceExpr=TextAmount[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            PrintOnEveryPage=Yes;
            PlaceInBottom=Yes;
            SectionWidth=19750;
            SectionHeight=2915;
          }
          CONTROLS
          {
            { 1000000029;Shape  ;19250;115  ;30   ;2785 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000030;Shape  ;10   ;100  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000031;Label  ;10550;100  ;8250 ;600  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved By }
            { 1000000032;Shape  ;10   ;800  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000033;Label  ;10550;1600 ;8280 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_____________________________ }
            { 1000000035;Shape  ;10100;100  ;30   ;2785 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000036;Label  ;400  ;100  ;9265 ;600  ;HorzAlign=Center;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By }
            { 1000000037;Label  ;400  ;1600 ;9250 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_____________________________ }
            { 1000000034;Label  ;10550;2250 ;8280 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_________/_________/_________ }
            { 1000000038;Label  ;400  ;2250 ;9200 ;423  ;HorzAlign=Center;
                                                         VertAlign=Bottom;
                                                         FontSize=10;
                                                         CaptionML=ENU=_________/_________/_________ }
            { 1000000040;Shape  ;0    ;115  ;30   ;2785 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000039;Shape  ;10   ;2885 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55052;
        DataItemTableView=SORTING(Document No.,Line No.)
                          WHERE(Type=FILTER(<>' '));
        OnAfterGetRecord=BEGIN
                           CLEAR(AccountNo);
                           CASE Type OF
                             Type::"G/L Account":
                               BEGIN
                                 AccountNo := "No.";
                               END;
                             ELSE
                               EXIT;
                           END;

                           IF NOT GLAcc.GET(AccountNo) THEN
                             GLAcc.INIT;

                           ShortcutDim3Code := '';
                           ShortcutDim4Code := '';
                           ShortcutDim5Code := '';
                           IF DocumentDim.GET(
                               DATABASE::"Petty Cash Line",
                               DocumentDim."Document Type"::Invoice,
                               "Document No.","Line No.",
                               ShortcutDimCode[3])
                           THEN
                             ShortcutDim3Code := DocumentDim."Dimension Value Code";
                           IF DocumentDim.GET(
                               DATABASE::"Petty Cash Line",
                               DocumentDim."Document Type"::Invoice,
                               "Document No.","Line No.",
                               ShortcutDimCode[4])
                           THEN
                             ShortcutDim4Code := DocumentDim."Dimension Value Code";
                           IF DocumentDim.GET(
                               DATABASE::"Petty Cash Line",
                               DocumentDim."Document Type"::Invoice,
                               "Document No.","Line No.",
                               ShortcutDimCode[5])
                           THEN
                             ShortcutDim5Code := DocumentDim."Dimension Value Code";

                           i := 0;
                           MatchAcc := FALSE;
                           REPEAT
                             i := i + 1;
                             IF ((AccCode[i] = AccountNo) AND
                                 (LineDescription[i] = Description) AND //KKE : #003
                                 (Dimension1Code[i] = "Shortcut Dimension 1 Code") AND
                                 (Dimension2Code[i] = "Shortcut Dimension 2 Code") AND
                                 (Dimension3Code[i] = ShortcutDim3Code) AND
                                 (Dimension4Code[i] = ShortcutDim4Code) AND
                                 (Dimension5Code[i] = ShortcutDim5Code))
                                OR (AccCode[i] = '')
                             THEN
                               MatchAcc := TRUE;
                           UNTIL (i=200) OR MatchAcc;

                           AccCode[i] := AccountNo;
                           AccName[i] := GLAcc.Name;
                           LineDescription[i] := Description;
                           Dimension1Code[i] := "Shortcut Dimension 1 Code";
                           Dimension2Code[i] := "Shortcut Dimension 2 Code";
                           Dimension3Code[i] := ShortcutDim3Code;
                           Dimension4Code[i] := ShortcutDim4Code;
                           Dimension5Code[i] := ShortcutDim5Code;
                           //KKE : #003 +
                           IF "Avg. VAT Amount" <> 0 THEN BEGIN
                             IF "Amount Incl. VAT" - "Avg. VAT Amount" >= 0 THEN
                               DrAmount[i] := DrAmount[i] + "Amount Incl. VAT" - "Avg. VAT Amount"
                             ELSE
                               CrAmount[i] := CrAmount[i] - ("Amount Incl. VAT" - "Avg. VAT Amount");
                           END ELSE BEGIN
                           //KKE : #003 -
                             IF "VAT Base Amount (LCY)" >= 0 THEN
                               DrAmount[i] := DrAmount[i] + "VAT Base Amount (LCY)"
                             ELSE
                               CrAmount[i] := CrAmount[i] - "VAT Base Amount (LCY)";
                           END;

                           // VAT
                           CLEAR(AccountNo);
                           VATPostingSetup.GET("VAT Bus. Posting Group","VAT Prod. Posting Group");
                           IF VATPostingSetup."Purch. VAT Unreal. Account" <> '' THEN
                             AccountNo := VATPostingSetup."Purch. VAT Unreal. Account"
                           ELSE
                             AccountNo := VATPostingSetup."Purchase VAT Account";
                           IF NOT GLAcc.GET(AccountNo) THEN
                             GLAcc.INIT;

                           i := 0;
                           MatchAcc := FALSE;
                           REPEAT
                             i := i + 1;
                             IF ((AccCode[i] = AccountNo) AND
                                 (Dimension1Code[i] = "Shortcut Dimension 1 Code") AND
                                 (Dimension2Code[i] = "Shortcut Dimension 2 Code") AND
                                 (Dimension3Code[i] = ShortcutDim3Code) AND
                                 (Dimension4Code[i] = ShortcutDim4Code) AND
                                 (Dimension5Code[i] = ShortcutDim5Code))
                                OR (AccCode[i] = '')
                             THEN
                               MatchAcc := TRUE;
                           UNTIL (i=200) OR MatchAcc;
                           AccCode[i] := AccountNo;
                           AccName[i] := GLAcc.Name;
                           Dimension1Code[i] := "Shortcut Dimension 1 Code";
                           Dimension2Code[i] := "Shortcut Dimension 2 Code";
                           Dimension3Code[i] := ShortcutDim3Code;
                           Dimension4Code[i] := ShortcutDim4Code;
                           Dimension5Code[i] := ShortcutDim5Code;
                           //KKE : #003 +
                           IF "Avg. VAT Amount" <> 0 THEN BEGIN
                             IF "Avg. VAT Amount" >= 0 THEN
                               DrAmount[i] := DrAmount[i] + "Avg. VAT Amount"
                             ELSE
                               CrAmount[i] := CrAmount[i] - "Avg. VAT Amount";
                           END ELSE BEGIN
                           //KKE : #003 -
                             IF "VAT Amount (LCY)" + "VAT Difference" >= 0 THEN
                               DrAmount[i] := DrAmount[i] + "VAT Amount (LCY)" + "VAT Difference"
                             ELSE
                               CrAmount[i] := CrAmount[i] - ("VAT Amount (LCY)" + "VAT Difference");
                           END;

                           // WHT
                           IF NOT "Skip WHT" THEN BEGIN
                             WHTPostingSetup.GET("WHT Business Posting Group","WHT Product Posting Group");
                             IF WHTPostingSetup."WHT %" <> 0 THEN BEGIN
                               WHTPostingSetup.TESTFIELD("Payable WHT Account Code");
                               AccountNo := WHTPostingSetup."Payable WHT Account Code";
                               IF NOT GLAcc.GET(AccountNo) THEN
                                 GLAcc.INIT;
                               i := 0;
                               MatchAcc := FALSE;
                               REPEAT
                                 i := i + 1;
                                 IF (WHTCode[i] = AccountNo) OR (WHTCode[i] = '') THEN
                                   MatchAcc := TRUE;
                               UNTIL (i=200) OR MatchAcc;
                               WHTCode[i] := AccountNo;
                               WHTName[i] := GLAcc.Name;
                               IF "WHT Absorb Base" = 0 THEN
                                 WHTCrAmount[i] := WHTCrAmount[i] + ROUND("VAT Base Amount (LCY)" * WHTPostingSetup."WHT %" /100)
                               ELSE
                                 WHTCrAmount[i] := WHTCrAmount[i] + ROUND("WHT Absorb Base" * WHTPostingSetup."WHT %" /100);
                             END;
                           END;
                         END;

        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=Detail;
        OnPreDataItem=BEGIN
                        Vendor.GET("Cash Advance Header"."Cash Advance Vendor No.");
                        VendPostingGrp.GET(Vendor."Vendor Posting Group");
                        IF NOT GLAcc.GET(VendPostingGrp."Payables Account") THEN
                          GLAcc.INIT;

                        ShortcutDim3Code := '';
                        ShortcutDim4Code := '';
                        ShortcutDim5Code := '';
                        IF DocumentDim.GET(
                            DATABASE::"Petty Cash Header",
                            DocumentDim."Document Type"::Invoice,
                            "Cash Advance Header"."No.",0,
                            ShortcutDimCode[3])
                        THEN
                          ShortcutDim3Code := DocumentDim."Dimension Value Code";
                        IF DocumentDim.GET(
                            DATABASE::"Cash Advance Header",
                            DocumentDim."Document Type"::Invoice,
                            "Cash Advance Header"."No.",0,
                            ShortcutDimCode[4])
                        THEN
                          ShortcutDim4Code := DocumentDim."Dimension Value Code";
                        IF DocumentDim.GET(
                            DATABASE::"Cash Advance Header",
                            DocumentDim."Document Type"::Invoice,
                            "Cash Advance Header"."No.",0,
                            ShortcutDimCode[5])
                        THEN
                          ShortcutDim5Code := DocumentDim."Dimension Value Code";

                        MatchAcc := FALSE;
                        i := 0;
                        REPEAT
                          i := i + 1;
                          IF ((AccCode[i] =  VendPostingGrp."Payables Account") AND
                              (Dimension1Code[i] = "Cash Advance Header"."Shortcut Dimension 1 Code") AND
                              (Dimension2Code[i] = "Cash Advance Header"."Shortcut Dimension 2 Code") AND
                              (Dimension3Code[i] = ShortcutDim3Code) AND
                              (Dimension4Code[i] = ShortcutDim4Code) AND
                              (Dimension5Code[i] = ShortcutDim5Code))
                             OR (AccCode[i] = '')
                          THEN
                            MatchAcc := TRUE
                        UNTIL (i=200) OR MatchAcc;

                        AccCode[i] := VendPostingGrp."Payables Account";
                        AccName[i] := GLAcc.Name;
                        Dimension1Code[i] := "Cash Advance Header"."Shortcut Dimension 1 Code";
                        Dimension2Code[i] := "Cash Advance Header"."Shortcut Dimension 2 Code";
                        Dimension3Code[i] := ShortcutDim3Code;
                        Dimension4Code[i] := ShortcutDim4Code;
                        Dimension5Code[i] := ShortcutDim5Code;

                        FOR j := 1 TO 200 DO BEGIN
                          IF i <> j THEN
                            CrAmount[i] := CrAmount[i] + DrAmount[j] - CrAmount[j] - WHTCrAmount[j]
                          ELSE
                            CrAmount[i] := CrAmount[i] + DrAmount[j] - WHTCrAmount[j];  //KKE : 27.02.2008
                        END;
                        IF CrAmount[i] < 0 THEN BEGIN
                          DrAmount[i] := -CrAmount[i];
                          CrAmount[i] := 0;
                        END;

                        {---
                        //Incase Purchase Credit Memo.
                        IF "Purchase Header"."Document Type" = "Purchase Header"."Document Type"::"Credit Memo" THEN BEGIN
                          i := 27;
                          j := 0;
                          REPEAT
                            IF AccCode[i] <> '' THEN BEGIN
                              j := j + 1;
                              CrMemoAccCode[j] := AccCode[i];
                              CrMemoAccName[j] := AccName[i];
                              CrMemoDim1Code[i] := Dimension1Code[i];
                              CrMemoDim2Code[i] := Dimension2Code[i];
                              CrMemoDim3Code[i] := Dimension3Code[i];
                              CrMemoDim4Code[i] := Dimension4Code[i];
                              CrMemoDim5Code[i] := Dimension5Code[i];
                              IF CrAmount[i] <> 0 THEN
                                CrMemoDrAmount[j] := CrAmount[i]
                              ELSE
                                CrMemoCrAmount[j] := DrAmount[i];
                            END;
                            i := i - 1;
                          UNTIL i=0;
                          CLEAR(AccCode);
                          CLEAR(AccName);
                          CLEAR(DrAmount);
                          CLEAR(CrAmount);
                          FOR i:=1 TO j DO BEGIN
                            AccCode[i] := CrMemoAccCode[i];
                            AccName[i] := CrMemoAccName[i];
                            Dimension1Code[i] := CrMemoDim1Code[i];
                            Dimension2Code[i] := CrMemoDim2Code[i];
                            Dimension3Code[i] := CrMemoDim3Code[i];
                            Dimension4Code[i] := CrMemoDim4Code[i];
                            Dimension5Code[i] := CrMemoDim5Code[i];
                            DrAmount[i] := CrMemoDrAmount[i];
                            CrAmount[i] := CrMemoCrAmount[i];
                          END;
                        END;
                        ---}
                      END;

        OnAfterGetRecord=BEGIN
                           IF AccCode[Number] = '' THEN
                             CurrReport.BREAK;

                           IF (DrAmount[Number] = 0) AND (CrAmount[Number] = 0) THEN
                             CurrReport.SKIP;

                           CntLine += 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19750;
            SectionHeight=500;
            OnPreSection=BEGIN
                           IF (DrAmount[Number] <> 0) AND (CrAmount[Number] <> 0) THEN
                             IF DrAmount[Number] > CrAmount[Number] THEN BEGIN
                               DrAmount[Number] := DrAmount[Number] - CrAmount[Number];
                               CrAmount[Number] := 0;
                             END ELSE BEGIN
                               CrAmount[Number] := CrAmount[Number] - DrAmount[Number];
                               DrAmount[Number] := 0;
                             END;

                           TotalDrAmount := TotalDrAmount + DrAmount[Number];
                           TotalCrAmount := TotalCrAmount + CrAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;100  ;0    ;2350 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=AccCode[Number] }
            { 1000000024;TextBox;2600 ;0    ;3750 ;500  ;FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr=AccName[Number] }
            { 1000000046;TextBox;13850;0    ;2600 ;500  ;FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=DrAmount[Number] }
            { 1000000067;TextBox;16600;0    ;2600 ;500  ;FontSize=9;
                                                         CaptionML=ENU=CREDIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=CrAmount[Number] }
            { 1000000068;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000069;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000070;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000071;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000072;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000073;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000074;TextBox;7900 ;0    ;1250 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=Dimension2Code[Number] }
            { 1000000075;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000076;TextBox;6500 ;0    ;1250 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=Dimension1Code[Number] }
            { 1000000077;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000078;TextBox;9300 ;0    ;4400 ;500  ;HorzAlign=Left;
                                                         FontSize=9;
                                                         CaptionML=ENU=DEBIT;
                                                         SourceExpr=LineDescription[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19750;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000083;Label  ;16750;0    ;2400 ;500  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue }
            { 1000000084;Shape  ;15   ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=WHT;
        OnAfterGetRecord=BEGIN
                           IF WHTCode[Number] = '' THEN
                            CurrReport.BREAK;

                           CntLine += 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19750;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := WHTCrAmount[Number] < 0;
                           IF CurrReport.SHOWOUTPUT THEN
                             TotalDrAmount := TotalDrAmount - WHTCrAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000003;TextBox;100  ;0    ;2350 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=WHTCode[Number] }
            { 1000000005;TextBox;13850;0    ;2600 ;500  ;FontSize=9;
                                                         CaptionML=ENU=CREDIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTCrAmount[Number] }
            { 1000000006;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000007;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000008;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000009;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000010;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000011;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000012;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000049;TextBox;2600 ;0    ;3750 ;500  ;FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr=WHTName[Number] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19750;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := WHTCrAmount[Number] > 0;
                           IF CurrReport.SHOWOUTPUT THEN
                             TotalCrAmount := TotalCrAmount + WHTCrAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000002;TextBox;100  ;0    ;2350 ;500  ;HorzAlign=Center;
                                                         FontSize=9;
                                                         CaptionML=[ENU=ACCOUNT CODE;
                                                                    THA=หมายเลขบัญชี G/L];
                                                         SourceExpr=WHTCode[Number] }
            { 1000000015;TextBox;16600;0    ;2600 ;500  ;FontSize=9;
                                                         CaptionML=ENU=CREDIT;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTCrAmount[Number] }
            { 1000000017;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000019;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000020;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000021;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000022;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000023;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000053;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000054;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000055;TextBox;2600 ;0    ;3750 ;500  ;FontSize=9;
                                                         CaptionML=[ENU=DESCRIPTION;
                                                                    THA=ชื่อ];
                                                         SourceExpr=WHTName[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=Description1;
        OnAfterGetRecord=BEGIN
                           CntLine += 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19750;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000004;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000013;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000047;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000050;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000051;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000052;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000056;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000057;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=Line Loop;
        OnPreDataItem=BEGIN
                        SETRANGE(Number,1,30 - CntLine);
                      END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19750;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000059;Shape  ;19250;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000060;Shape  ;16450;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000061;Shape  ;13700;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000062;Shape  ;2450 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000063;Shape  ;0    ;0    ;30   ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000064;Shape  ;7750 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000065;Shape  ;6350 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000066;Shape  ;9150 ;0    ;150  ;500  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000000 : Record 79;
      Vendor@1000000027 : Record 23;
      VendPostingGrp@1000000015 : Record 93;
      GenPostingSetup@1000000016 : Record 252;
      VATPostingSetup@1000000018 : Record 325;
      WHTPostingSetup@1000000020 : Record 28043;
      PurchLine@1000000014 : Record 39;
      GLSetup@1000000034 : Record 98;
      GLAcc@1000 : Record 15;
      DocumentDim@1000000004 : Record 357;
      InventoryPostingSetup@1000000021 : Record 5813;
      InvDescription@1000000001 : Text[250];
      DocumentNo@1000000002 : Code[20];
      PostingDate@1000000003 : Date;
      AccountNo@1000000017 : Code[20];
      AccCode@1000000005 : ARRAY [200] OF Code[20];
      AccName@1000000006 : ARRAY [200] OF Text[50];
      DrAmount@1000000008 : ARRAY [200] OF Decimal;
      CrAmount@1000000009 : ARRAY [200] OF Decimal;
      TotalDrAmount@1000000012 : Decimal;
      TotalCrAmount@1000000011 : Decimal;
      MatchAcc@1000000013 : Boolean;
      i@1000000010 : Integer;
      j@1000000019 : Integer;
      WHTCode@1000000026 : ARRAY [200] OF Code[20];
      WHTName@1000000048 : ARRAY [200] OF Text[50];
      WHTCrAmount@1000000022 : ARRAY [200] OF Decimal;
      CrMemoAccCode@1000000029 : ARRAY [200] OF Code[20];
      CrMemoAccName@1000000028 : ARRAY [200] OF Text[50];
      CrMemoDrAmount@1000000025 : ARRAY [200] OF Decimal;
      CrMemoCrAmount@1000000023 : ARRAY [200] OF Decimal;
      Dimension1Code@1000000043 : ARRAY [200] OF Code[20];
      Dimension2Code@1000000042 : ARRAY [200] OF Code[20];
      Dimension3Code@1000000041 : ARRAY [200] OF Code[20];
      Dimension4Code@1000000040 : ARRAY [200] OF Code[20];
      Dimension5Code@1000000039 : ARRAY [200] OF Code[20];
      ShortcutDimCode@1000000033 : ARRAY [8] OF Code[20];
      ShortcutDim1Code@1000000036 : Code[20];
      ShortcutDim2Code@1000000035 : Code[20];
      ShortcutDim3Code@1000000032 : Code[20];
      ShortcutDim4Code@1000000031 : Code[20];
      ShortcutDim5Code@1000000030 : Code[20];
      CrMemoDim1Code@1000000047 : ARRAY [200] OF Code[20];
      CrMemoDim2Code@1000000046 : ARRAY [200] OF Code[20];
      CrMemoDim3Code@1000000045 : ARRAY [200] OF Code[20];
      CrMemoDim4Code@1000000044 : ARRAY [200] OF Code[20];
      CrMemoDim5Code@1000000038 : ARRAY [200] OF Code[20];
      LineDescription@1000000050 : ARRAY [200] OF Text[50];
      CntLine@1000000037 : Integer;
      FALedgEntry@1000000024 : Record 5601;
      FAGetGLAccNo@1000000007 : Codeunit 5602;
      FormatAddr@1000000049 : Codeunit 365;
      CheckReport@1000000052 : Report 1401;
      TextAmount@1000000051 : ARRAY [2] OF Text[250];
      CntPage@1000000053 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut
      GKU : Goragot Kuanmuang
      No.   Date         Sign  Description
      ----------------------------------------
      001   30.08.2006   KKE   -Cash Advance
      002   30.08.2006   GKU   -Add TextAmount and CheckReport variable
                                for display word total amount
      Burda
      003   30.08.2007   KKE   Average VAT
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50094 FORM 50 BIS -Cash Advance
{
  OBJECT-PROPERTIES
  {
    Date=05/21/12;
    Time=[ 4:24:54 PM];
    Modified=Yes;
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=500;
    BottomMargin=500;
    LeftMargin=500;
    RightMargin=200;
    OnInitReport=BEGIN
                   NumberOfCopy := 1;
                   PaymentOption := 2 ;
                 END;

    OnPreReport=BEGIN
                  IF CompanyInfo.GET THEN BEGIN
                    FOR i := 1 TO STRLEN(CompanyInfo."VAT Registration No.") DO
                      ID1[i] := COPYSTR(CompanyInfo."VAT Registration No.",i,1);
                    //KKE : #002 +
                    IF CompanyInfo."Phone No." <> '' THEN
                      CompanyPhone := 'Tel. ' + CompanyInfo."Phone No.";
                    //KKE : #002 -
                    CompanyInfo.CALCFIELDS(Picture);
                  END;

                  //KKE : #002 +
                  FOR i := 1 TO STRLEN(ConductVATID) DO
                    CCID[i] := COPYSTR(ConductVATID,i,1);

                  FOR i := 1 TO STRLEN(ConductID) DO
                    ID2[i] := COPYSTR(ConductID,i,1);

                  FOR i := 1 TO STRLEN(EmployerAccount) DO
                    EID[i] := COPYSTR(EmployerAccount,i,1);

                  FOR i := 1 TO STRLEN(SocialID) DO
                    SoID[i] := COPYSTR(SocialID,i,1);
                  //KKE : #002 -

                  IF NumberOfCopy > 4 THEN
                    ERROR('Number of copies shouldnot be more than 4.');

                  GLSetup.GET;
                  PurchSetup.GET;

                  CLEAR(WHTTerm);
                  CASE PaymentOption OF
                    0 : WHTTerm[1] := 'P';
                    1 : WHTTerm[2] := 'P';
                    2 : WHTTerm[3] := 'P';
                    3 : WHTTerm[4] := 'P';
                  END;
                END;

    PaperSize=Letter 8 1/2 x 11 in;
    HorzGrid=50;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55051;
        OnAfterGetRecord=BEGIN
                           CLEAR(ActualVendorNo);
                           CLEAR(WHTSlipNo);
                           CLEAR(Name);
                           CLEAR(Address);
                           CLEAR(Phone);  //KKE : #002
                           CLEAR(VAT);
                           CLEAR(WHTGroup);
                           CLEAR(WHTPostingDate);
                           CLEAR(WHTExpenseText);
                           CLEAR(WHTBaseAmtLCYExcVAT);
                           CLEAR(WHTAmtLCY);
                           CLEAR(TotWHTBaseAmtLCYExcVAT);
                           CLEAR(TotWHTAmtLCY);
                           //CLEAR(PostingDate);
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55052;
        DataItemTableView=SORTING(Actual Vendor No.,WHT Business Posting Group,WHT Product Posting Group)
                          WHERE(Actual Vendor No.=FILTER(<>''),
                                Amount Incl. VAT=FILTER(<>0),
                                Skip WHT=CONST(No));
        OnAfterGetRecord=BEGIN
                           IF ActualVendorNo = "Actual Vendor No." THEN
                             CurrReport.SKIP;

                           CLEAR(WHTSlipNo);
                           CLEAR(VAT);
                           CLEAR(WHTGroup);
                           CLEAR(WHTExpenseText);
                           CLEAR(WHTPostingDate);
                           CLEAR(WHTAmtLCY);
                           CLEAR(WHTBaseAmtLCYExcVAT);
                           CLEAR(TotWHTBaseAmtLCYExcVAT);
                           CLEAR(TotWHTAmtLCY);

                           ActualVendorNo := "Actual Vendor No.";

                           Vendor.GET("Actual Vendor No.");
                           IF Vendor."Name (Thai)" <> '' THEN BEGIN
                             Name := Vendor."Name (Thai)";
                             Address := Vendor."Address (Thai)";
                           END ELSE BEGIN
                             Name := Vendor.Name + Vendor."Name 2";
                             Address := Vendor.Address + ' ' + Vendor."Address 2" + ' ' + Vendor."Address 3";
                           END;
                           //KKE : #002 +
                           IF Vendor."Phone No." <> '' THEN
                             Phone := 'Tel. ' + Vendor."Phone No.";
                           FOR i := 1 TO 13 DO
                             ID3[i] := COPYSTR(Vendor."ID No.",i,1);
                           //KKE : #002 -
                           FOR i := 1 TO STRLEN(Vendor."VAT Registration No.") DO
                             VAT[i] := COPYSTR(Vendor."VAT Registration No.",i,1);

                           //WHTBusPostingGrp.GET("Cash Advance Header"."WHT Business Posting Group");
                           WHTBusPostingGrp.GET("WHT Business Posting Group");

                           CashAdvLine.RESET;
                           CashAdvLine.SETRANGE("Document No.","Document No.");
                           CashAdvLine.SETRANGE("Actual Vendor No.",ActualVendorNo);
                           CashAdvLine.SETRANGE("Skip WHT",FALSE);
                           CashAdvLine.SETFILTER("Amount (LCY) Incl. VAT",'<>0');
                           IF CashAdvLine.FIND('-') THEN
                             REPEAT
                               IF CalcWHTEntry(CashAdvLine) THEN
                                 IF (CashAdvLine."WHT Certificate No." = '') THEN BEGIN
                                   IF WHTSlipNo = '' THEN
                                     IF WHTBusPostingGrp."WHT Certificate No. Series" <> '' THEN
                                       WHTSlipNo :=
                                         NoSeriesMgt.GetNextNo(WHTBusPostingGrp."WHT Certificate No. Series","Cash Advance Header"."Posting Date",TRUE)
                                     ELSE
                                       WHTSlipNo :=
                                         NoSeriesMgt.GetNextNo(PurchSetup."WHT Certificate No. Series","Cash Advance Header"."Posting Date",TRUE);
                                   CashAdvLine."WHT Certificate No." := WHTSlipNo;
                                   CashAdvLine."Certificate Printed" := TRUE;
                                   CashAdvLine.MODIFY;
                                 END ELSE BEGIN
                                   WHTSlipNo := CashAdvLine."WHT Certificate No.";
                                   CashAdvLine."Certificate Printed" := TRUE;
                                   CashAdvLine.MODIFY;
                                 END;
                             UNTIL CashAdvLine.NEXT=0;
                         END;

        DataItemLink=Document No.=FIELD(No.);
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..4));
        OnPreDataItem=BEGIN
                        IF TotWHTAmtLCY = 0 THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number > NumberOfCopy THEN
                             CurrReport.BREAK;

                           WHTAmtLCYText := Form50BIS.FormatNoThaiText(TotWHTAmtLCY);
                           IF WHTAmtLCYText <> '' THEN
                             WHTAmtLCYText := '(' + WHTAmtLCYText + ')';
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=1400;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FALSE;
                         END;

          }
          CONTROLS
          {
            { 1000000041;PictureBox;0 ;0    ;3780 ;1400 ;HorzGlue=Both;
                                                         SourceExpr=CompanyInfo.Picture }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=26000;
          }
          CONTROLS
          {
            { 1000000000;Shape  ;150  ;9150 ;19100;16000;Visible=Yes }
            { 1000000001;Shape  ;6627 ;22600;423  ;423   }
            { 1000000002;Shape  ;18703;5850 ;423  ;423   }
            { 1000000004;Shape  ;18703;3350 ;423  ;423   }
            { 1000000005;Shape  ;13150;900  ;423  ;423   }
            { 1000000006;TextBox;18703;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[13] }
            { 1000000007;Shape  ;13693;900  ;1692 ;423   }
            { 1000000008;Shape  ;15505;900  ;2115 ;423   }
            { 1000000009;Shape  ;15505;6350 ;2100 ;423   }
            { 1000000010;TextBox;16351;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[8] }
            { 1000000011;Shape  ;16865;3850 ;1692 ;423   }
            { 1000000012;Shape  ;13693;6350 ;1692 ;423   }
            { 1000000013;Shape  ;15023;3850 ;1692 ;423   }
            { 1000000014;Shape  ;14450;3850 ;423  ;423   }
            { 1000000015;Shape  ;0    ;0    ;19400;26000;ShapeStyle=Rectangle }
            { 1000000016;Shape  ;150  ;20100;19100;30   ;ShapeStyle=HorzLine }
            { 1000000017;Label  ;300  ;19627;1750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=6. อื่นๆ (ระบุ) }
            { 1000000018;Label  ;8590 ;20162;4430 ;538  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมเงินที่จ่ายและภาษีที่หักนำส่ง }
            { 1000000019;Label  ;1620 ;25550;17690;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ผู้มีหน้าที่ออกหนังสือรับรองการหักภาษี ณ ที่จ่าย ฝ่าฝืนไม่ปฏิบัติตามมาตรา 50 ทวิ แห่งประมวลรัษฎากร ต้องรับโทษทางอาญาตามมาตรา 35 แห่งประมวลรัษฎากร }
            { 1000000020;Shape  ;150  ;9990 ;19100;30   ;ShapeStyle=HorzLine }
            { 1000000021;Shape  ;150  ;5700 ;19100;3350 ;ShapeStyle=Rectangle }
            { 1000000022;Shape  ;150  ;800  ;19100;2350 ;ShapeStyle=Rectangle }
            { 1000000023;Label  ;350  ;5750 ;5050 ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ผู้ถูกหักภาษี ณ ที่จ่าย : }
            { 1000000024;Label  ;400  ;8000 ;1200 ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ลำดับที่ }
            { 1000000025;Label  ;300  ;10050;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=1. เงินเดือน ค่าจ้าง เบี้ยเลี้ยง โบนัส ฯลฯ ตามมาตรา 40 (1) }
            { 1000000026;Label  ;300  ;10450;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=2. ค่าธรรมเนียม ค่านายหน้า ฯลฯ ตามมาตรา 40 (2) }
            { 1000000027;Label  ;300  ;10850;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=3. ค่าแห่งลิขสิทธิ์ฯลฯ ตามมาตรา 40 (3) }
            { 1000000028;Label  ;300  ;11250;8700 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=4. (ก)  ค่าดอกเบี้ย ฯลฯ ตามมาตรา 40 (4) ก }
            { 1000000029;Label  ;650  ;11650;8850 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ข) เงินปันผล เงินส่วนแบ่งกำไร ฯลฯ ตามมาตรา 40 (4) (ข) ที่จ่ายจาก }
            { 1000000030;Label  ;300  ;18050;10050;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=5. การจ่ายเงินได้ที่ต้องหักภาษี ณ ที่จ่ายตามคำสั่งกรมสรรพากรที่ออกตามมาตรา }
            { 1000000031;Label  ;600  ;18450;9750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=3 เตรส เช่น รางวัล ส่วนลดหรือประโยชน์ใดๆ เนื่องจากการส่งเสริมการขาย }
            { 1000000032;Label  ;600  ;18850;9750 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=รางวัลในการประกวด การแข่งขัน การชิงโชค ค่าแสดงของนักแสดงสาธารณะ }
            { 1000000033;Label  ;600  ;19250;9720 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ค่าจ้างทำของ ค่าโฆษณา ค่าเช่า ค่าขนส่ง ค่าบริการ ค่าเบี้ยประกันวินาศภัย ฯลฯ }
            { 1000000034;Label  ;400  ;850  ;5100 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU="ผู้มีหน้าที่หักภาษี ณ ที่จ่าย : " }
            { 1000000035;Label  ;400  ;1300 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000036;Label  ;400  ;2200 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000037;Label  ;1950 ;9156 ;5100 ;846  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ประเภทเงินได้ที่จ่าย }
            { 1000000038;Shape  ;1700 ;8000 ;1400 ;423   }
            { 1000000039;Label  ;3450 ;8000 ;1150 ;523  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ในแบบ }
            { 1000000040;Shape  ;4900 ;8000 ;450  ;423   }
            { 1000000042;Shape  ;4900 ;8500 ;450  ;423   }
            { 1000000043;Label  ;6050 ;8000 ;1650 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.1ก }
            { 1000000044;Label  ;6050 ;8500 ;1650 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.2ก }
            { 1000000045;Label  ;300  ;25150;1340 ;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หมายเหตุ }
            { 1000000046;Shape  ;8100 ;8000 ;450  ;423   }
            { 1000000047;Shape  ;8100 ;8500 ;450  ;423   }
            { 1000000048;Label  ;6650 ;150  ;5250 ;500  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ตามมาตรา 50 ทวิ แห่งประมวลรัษฎากร }
            { 1000000049;Label  ;10800;9150 ;2400 ;444  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=วัน เดือน }
            { 1000000050;Shape  ;10750;9150 ;30   ;10950;ShapeStyle=VertLine }
            { 1000000051;Shape  ;13290;20605;5960 ;30   ;ShapeStyle=HorzLine }
            { 1000000052;Label  ;150  ;100  ;6500 ;600  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=หนังสือรับรองการหักภาษี ณ ที่จ่าย }
            { 1000000053;Label  ;9200 ;8000 ;2550 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.1ก พิเศษ }
            { 1000000054;Label  ;9200 ;8500 ;2550 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.3ก }
            { 1000000055;Shape  ;150  ;21200;19100;30   ;ShapeStyle=HorzLine }
            { 1000000056;Shape  ;150  ;23100;19100;30   ;ShapeStyle=HorzLine }
            { 1000000057;Label  ;290  ;23100;1650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ผู้จ่ายเงิน }
            { 1000000058;Label  ;5170 ;23150;10550;550  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ขอรับรองว่า ข้อความและตัวเลขดังกล่าวข้างต้นถูกต้องตรงกับความจริงทุกประการ }
            { 1000000059;Label  ;5180 ;23900;860  ;523  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(ลงชื่อ) }
            { 1000000060;Shape  ;12100;8000 ;450  ;423   }
            { 1000000061;Shape  ;12100;8500 ;450  ;423   }
            { 1000000062;Label  ;5170 ;24550;6000 ;473  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................... }
            { 1000000063;Label  ;13200;8000 ;1950 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.2 }
            { 1000000064;Label  ;13250;8500 ;1950 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.53 }
            { 1000000065;Label  ;6020 ;23900;6640 ;523  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.............................................................................................. }
            { 1000000066;Shape  ;13280;9150 ;30   ;11550;ShapeStyle=VertLine }
            { 1000000067;Label  ;13400;9150 ;2650 ;846  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=จำนวนเงินที่จ่าย }
            { 1000000068;Shape  ;500  ;23500;500  ;360   }
            { 1000000069;Shape  ;500  ;23900;500  ;360   }
            { 1000000070;Label  ;1110 ;23500;2960 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=หักภาษี ณ ที่จ่าย }
            { 1000000071;Label  ;1110 ;23900;2990 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ออกภาษีให้ตลอดไป }
            { 1000000072;Shape  ;15450;8000 ;450  ;423   }
            { 1000000073;Label  ;12400;150  ;900  ;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=เล่มที่ }
            { 1000000074;Label  ;16500;8000 ;1450 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=ภ.ง.ด.3 }
            { 1000000075;Label  ;13300;150  ;2200 ;500  ;VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................ }
            { 1000000076;Label  ;10850;1350 ;3500 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000077;Label  ;9350 ;6300 ;3700 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000078;Shape  ;500  ;24300;500  ;360   }
            { 1000000079;Shape  ;500  ;24700;500  ;360   }
            { 1000000080;Label  ;12640;23900;3590 ;523  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=ผู้มีหน้าที่หักภาษี ณ ที่จ่าย }
            { 1000000081;Label  ;11160;24550;4220 ;423  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=วัน เดือน ปี ที่ออกหนังสือรับรอง }
            { 1000000082;Shape  ;16400;9150 ;30   ;11550;ShapeStyle=VertLine }
            { 1000000083;Label  ;1110 ;24300;3400 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ออกภาษีให้ครั้งเดียว }
            { 1000000084;Label  ;1110 ;24700;3450 ;360  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=อื่นๆ ให้ระบุ................ }
            { 1000000085;Shape  ;15023;1400 ;1692 ;423   }
            { 1000000086;TextBox;14450;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[1] }
            { 1000000087;TextBox;15023;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[2] }
            { 1000000088;TextBox;15446;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[3] }
            { 1000000089;Shape  ;15446;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000090;TextBox;15869;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[4] }
            { 1000000091;Shape  ;15869;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000092;Shape  ;15869;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000093;TextBox;16292;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[5] }
            { 1000000094;Shape  ;16292;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000095;TextBox;16865;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[6] }
            { 1000000096;TextBox;17288;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[7] }
            { 1000000097;Shape  ;17288;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000098;TextBox;17711;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[8] }
            { 1000000099;Shape  ;17711;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000100;TextBox;18134;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[9] }
            { 1000000101;Shape  ;18134;1400 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000102;TextBox;18707;1400 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CID[10] }
            { 1000000103;TextBox;13400;20100;2550 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTBaseAmtLCYExcVAT }
            { 1000000104;TextBox;16450;20100;2300 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotWHTAmtLCY }
            { 1000000105;Shape  ;13150;6350 ;423  ;423   }
            { 1000000106;TextBox;13150;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[1] }
            { 1000000107;TextBox;13693;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[2] }
            { 1000000108;TextBox;14116;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[3] }
            { 1000000109;Shape  ;14116;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000110;TextBox;14539;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[4] }
            { 1000000111;Shape  ;14539;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000112;TextBox;14962;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[5] }
            { 1000000113;Shape  ;14962;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000114;TextBox;15505;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[6] }
            { 1000000115;TextBox;15928;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[7] }
            { 1000000116;Shape  ;15928;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000117;Shape  ;16351;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000118;TextBox;16774;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[9] }
            { 1000000119;Shape  ;16774;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000120;TextBox;18707;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[13] }
            { 1000000121;Shape  ;16750;23400;1350 ;1350 ;ShapeStyle=Oval }
            { 1000000122;Label  ;16800;23600;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=ประทับตรา }
            { 1000000123;Label  ;16800;23916;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=นิติบุคคล }
            { 1000000124;Label  ;16800;24200;1300 ;423  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=7;
                                                         CaptionML=ENU=(ถ้ามี) }
            { 1000000125;Label  ;15600;150  ;900  ;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=เลขที่ }
            { 1000000126;Label  ;16500;150  ;2550 ;500  ;VertAlign=Bottom;
                                                         FontName=Helvetica;
                                                         FontSize=7;
                                                         CaptionML=ENU=............................................ }
            { 1000000127;Shape  ;14450;1400 ;423  ;423   }
            { 1000000128;Shape  ;14873;1400 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000129;Shape  ;16715;1400 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000130;Shape  ;16865;1400 ;1692 ;423   }
            { 1000000131;Shape  ;18557;1400 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000132;Shape  ;18707;1400 ;423  ;423   }
            { 1000000133;Label  ;1100 ;1800 ;10050;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000134;Label  ;900  ;1300 ;9900 ;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000135;TextBox;1000 ;1300 ;9800 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000136;Label  ;1150 ;2700 ;14570;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000137;Label  ;1000 ;2200 ;18100;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000138;TextBox;1100 ;2200 ;17550;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address +'  ' + CompanyInfo."Address 2" + '  ' + CompanyInfo."Address 3" + '  ' +  CompanyInfo."Post Code" + '  ' + CompanyInfo."Phone No." }
            { 1000000139;Shape  ;13573;6350 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000140;Shape  ;15385;6350 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000141;Shape  ;18557;6350 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000142;Shape  ;18707;6350 ;423  ;423   }
            { 1000000143;Label  ;350  ;6250 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000144;Label  ;1050 ;6700 ;10100;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000145;Label  ;850  ;6250 ;7900 ;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000146;TextBox;950  ;6250 ;7800 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=Name }
            { 1000000147;Label  ;350  ;7100 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000148;Label  ;900  ;7100 ;18200;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000149;TextBox;1050 ;7100 ;17600;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=Address + '  ' + Address2 + '  ' + City + ' ' + Phone }
            { 1000000150;Label  ;1050 ;7600 ;14710;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000151;Label  ;5500 ;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(1) }
            { 1000000152;Label  ;8650 ;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(2) }
            { 1000000153;Label  ;12700;8000 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(3) }
            { 1000000154;Label  ;16000;8000 ;550  ;450  ;FontName=ms san seriff;
                                                         FontSize=8;
                                                         CaptionML=ENU=(4) }
            { 1000000155;Label  ;5500 ;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(5) }
            { 1000000156;Label  ;8650 ;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(6) }
            { 1000000157;Label  ;12700;8500 ;550  ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         CaptionML=ENU=(7) }
            { 1000000158;Label  ;10800;9550 ;2400 ;450  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=หรือปีภาษี ที่จ่าย }
            { 1000000159;Label  ;16600;9150 ;2200 ;444  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ภาษีที่หัก }
            { 1000000160;Label  ;16600;9594 ;2200 ;450  ;HorzAlign=Center;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=และนำส่งไว้ }
            { 1000000161;Shape  ;16000;10000;30   ;10700;ShapeStyle=VertLine }
            { 1000000162;Shape  ;18800;10000;30   ;10700;ShapeStyle=VertLine }
            { 1000000163;Label  ;900  ;12050;7800 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1) กิจการที่ต้องเสียภาษีเงินได้นิติบุคคลในอัตราดังนี้ }
            { 1000000164;Label  ;1950 ;12450;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.1) อัตราร้อยละ 30 ของกำไรสุทธิ }
            { 1000000165;Label  ;1950 ;12850;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.2) อัตราร้อยละ 25 ของกำไรสุทธิ }
            { 1000000166;Label  ;1960 ;13250;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.3) อัตราร้อยละ 20 ของกำไรสุทธิ }
            { 1000000167;Label  ;1950 ;13650;6650 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(1.4) อัตราอื่นๆ (ระบุ)................... ของกำไรสุทธิ }
            { 1000000168;Shape  ;1400 ;12450;450  ;360   }
            { 1000000169;Shape  ;1400 ;12850;450  ;360   }
            { 1000000170;Shape  ;1400 ;13250;450  ;360   }
            { 1000000171;Shape  ;1400 ;13650;450  ;360   }
            { 1000000172;Label  ;900  ;14050;9800 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2) กิจการที่ได้รับยกเว้นภาษีเงินได้นิติบุคคล ซึ่งผู้รับเงินปันผลไม่ได้รับเครดิตภาษี }
            { 1000000173;Label  ;1350 ;14450;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.1) กำไรสุทธิของกิจการที่ได้รับยกเว้นภาษีเงินได้นิติบุคคล }
            { 1000000174;Label  ;1350 ;14850;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.2) เงินปันผลหรือเงินส่วนแบ่งของกำไรที่ได้รับยกเว้นไม่ต้องนำมารวม }
            { 1000000175;Label  ;290  ;20700;4360 ;500  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=รวมเงินภาษีที่หักนำส่ง (ตัวอักษร) }
            { 1000000176;Label  ;1620 ;25150;14930;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ให้สามารถอ้างอิงหรือสอบยันกันได้ระหว่างลำดับที่ตามหนังสือรับรองฯ กับแบบยื่นรายการภาษีหัก ณ ที่จ่าย }
            { 1000000177;Label  ;320  ;25550;1340 ;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=คำเตือน }
            { 1000000178;TextBox;15550;8000 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTGroup[1] }
            { 1000000179;TextBox;12200;8500 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTGroup[2] }
            { 1000000180;TextBox;600  ;24320;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         OptionCaptionML=ENU=1;
                                                         OptionString=1;
                                                         SourceExpr=WHTTerm[1] }
            { 1000000181;TextBox;600  ;23920;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[2] }
            { 1000000182;TextBox;600  ;23520;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=10;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[3] }
            { 1000000183;TextBox;600  ;24720;400  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=WHTTerm[4] }
            { 1000000184;TextBox;10800;10050;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[1] }
            { 1000000185;TextBox;10800;10450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[2] }
            { 1000000186;TextBox;10800;10850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[3] }
            { 1000000187;TextBox;10800;11250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[4] }
            { 1000000188;TextBox;10800;12450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[5] }
            { 1000000189;TextBox;10800;12850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[6] }
            { 1000000190;TextBox;10800;13250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[7] }
            { 1000000191;TextBox;10800;13650;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[8] }
            { 1000000192;TextBox;10800;14450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[9] }
            { 1000000193;TextBox;10800;14850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[10] }
            { 1000000194;TextBox;10800;15650;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[11] }
            { 1000000195;TextBox;10800;16450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[12] }
            { 1000000196;TextBox;13400;10050;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[1] }
            { 1000000197;TextBox;13400;10450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[2] }
            { 1000000198;TextBox;13400;10850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[3] }
            { 1000000199;TextBox;13400;11250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[4] }
            { 1000000200;TextBox;13400;12450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[5] }
            { 1000000201;TextBox;13400;12850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[6] }
            { 1000000202;TextBox;13400;13250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[7] }
            { 1000000203;TextBox;13400;13650;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[8] }
            { 1000000204;TextBox;13400;14450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[9] }
            { 1000000205;TextBox;13400;14850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[10] }
            { 1000000206;TextBox;13400;15650;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[11] }
            { 1000000207;TextBox;13400;16450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[12] }
            { 1000000208;TextBox;16450;10050;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[1] }
            { 1000000209;TextBox;16450;10450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[2] }
            { 1000000210;TextBox;16450;10850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[3] }
            { 1000000211;TextBox;16450;11250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[4] }
            { 1000000212;TextBox;16450;12450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[5] }
            { 1000000213;TextBox;16450;12850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[6] }
            { 1000000214;TextBox;16450;13250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[7] }
            { 1000000215;TextBox;16450;13650;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[8] }
            { 1000000216;TextBox;16450;14450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[9] }
            { 1000000217;TextBox;16450;14850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[10] }
            { 1000000218;TextBox;16450;15650;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[11] }
            { 1000000219;TextBox;16450;16450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[12] }
            { 1000000220;TextBox;1500 ;12450;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[1] }
            { 1000000221;TextBox;1500 ;12850;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[2] }
            { 1000000222;TextBox;1500 ;13250;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[3] }
            { 1000000223;TextBox;1500 ;13650;450  ;360  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=ExpenseType[4] }
            { 1000000224;TextBox;16600;150  ;2250 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=WHTSlipNo }
            { 1000000225;TextBox;4740 ;20700;13860;500  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=WHTAmtLCYText }
            { 1000000226;TextBox;13400;150  ;2000 ;423  ;HorzAlign=Center;
                                                         FontSize=8;
                                                         SourceExpr=FormBookNo }
            { 1000000227;Label  ;2050 ;19677;8530 ;400  ;VertAlign=Bottom;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=.......................................................................................................................... }
            { 1000000228;TextBox;2150 ;19627;6700 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         SourceExpr=WHTExpenseText }
            { 1000000229;Shape  ;150  ;3250 ;19100;2350 ;ShapeStyle=Rectangle }
            { 1000000230;Label  ;400  ;3300 ;5100 ;450  ;FontName=Ms Sans Serif;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU="กระทำการแทน : " }
            { 1000000231;Label  ;10650;3800 ;3800 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขประจำตัวผู้เสียภาษีอากร }
            { 1000000232;Label  ;900  ;3750 ;9750 ;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=................................................................................................................................................................................................. }
            { 1000000233;TextBox;1000 ;3750 ;9650 ;423  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=ConductName }
            { 1000000234;TextBox;14450;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[1] }
            { 1000000235;TextBox;15023;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[2] }
            { 1000000236;TextBox;15446;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[3] }
            { 1000000237;Shape  ;15446;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000238;TextBox;15869;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[4] }
            { 1000000239;Shape  ;15869;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000240;TextBox;16292;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[5] }
            { 1000000241;Shape  ;16250;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000242;TextBox;16865;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[6] }
            { 1000000243;TextBox;17288;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[7] }
            { 1000000244;Shape  ;17288;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000245;TextBox;17711;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[8] }
            { 1000000246;Shape  ;17711;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000247;TextBox;18134;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[9] }
            { 1000000248;Shape  ;18134;3850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000249;TextBox;18707;3850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=CCID[10] }
            { 1000000250;Shape  ;14873;3850 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000251;Shape  ;16715;3850 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000252;Shape  ;18557;3850 ;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000253;Shape  ;18707;3850 ;423  ;423   }
            { 1000000254;Label  ;400  ;3750 ;500  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ชื่อ }
            { 1000000255;Label  ;1100 ;4250 ;10050;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุว่าเป็น บุคคล นิติบุคคล บริษัท สมาคม หรือคณะบุคคล) }
            { 1000000256;Label  ;400  ;4650 ;600  ;500  ;FontName=Ms Sans Serif;
                                                         FontSize=9;
                                                         CaptionML=ENU=ที่อยู่ }
            { 1000000257;Label  ;1000 ;4650 ;18100;496  ;VertAlign=Bottom;
                                                         CaptionML=ENU=.......................................................................................................................................................................................................................................................... }
            { 1000000258;TextBox;1100 ;4650 ;17600;423  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=ConductAddress }
            { 1000000259;Label  ;1150 ;5150 ;14610;400  ;HorzAlign=General;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=8;
                                                         FontItalic=Yes;
                                                         CaptionML=ENU=(ให้ระบุ ชื่ออาคาร/หมู่บ้าน ห้องเลขที่ ชั้นที่ เลขที่ ตรอก/ซอย หมู่ที่ ถนน ตำบล/แขวง อำเภอ/เขต จังหวัด และโทรศัพท์) }
            { 1000000260;TextBox;6220 ;24500;4600 ;473  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PostingDate }
            { 1000000261;TextBox;17197;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[10] }
            { 1000000262;Shape  ;18703;900  ;423  ;423   }
            { 1000000263;Shape  ;17620;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000264;TextBox;16774;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[9] }
            { 1000000265;Shape  ;16774;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000266;TextBox;15928;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[7] }
            { 1000000267;TextBox;16351;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[8] }
            { 1000000268;Shape  ;16351;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000269;TextBox;15505;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[6] }
            { 1000000270;Shape  ;15928;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000271;TextBox;14962;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[5] }
            { 1000000272;Shape  ;15385;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000273;TextBox;14539;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[4] }
            { 1000000274;Shape  ;14962;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000275;TextBox;14116;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[3] }
            { 1000000276;Shape  ;14539;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000277;Shape  ;14539;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000278;TextBox;13693;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[2] }
            { 1000000279;Shape  ;14116;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000280;Shape  ;13573;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000281;TextBox;13150;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[1] }
            { 1000000282;Label  ;7850 ;850  ;5050 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขที่ประจำตัวผู้เสียภาษีอากร (13 หลัก)* }
            { 1000000283;Shape  ;13290;20685;5960 ;30   ;ShapeStyle=HorzLine }
            { 1000000284;Shape  ;17197;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000285;Shape  ;17740;900  ;846  ;423   }
            { 1000000286;TextBox;17740;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[11] }
            { 1000000287;Shape  ;18583;900  ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000288;Shape  ;18160;900  ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000289;TextBox;18160;900  ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID1[12] }
            { 1000000290;Label  ;7900 ;3300 ;5050 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขที่ประจำตัวผู้เสียภาษีอากร (13 หลัก)* }
            { 1000000291;TextBox;18703;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[13] }
            { 1000000292;Shape  ;17740;3350 ;846  ;423   }
            { 1000000293;Shape  ;18583;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000294;TextBox;18160;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[12] }
            { 1000000295;Shape  ;15505;3350 ;2115 ;423   }
            { 1000000296;TextBox;17197;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[10] }
            { 1000000297;Shape  ;17620;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000298;TextBox;17740;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[11] }
            { 1000000299;Shape  ;18160;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000300;TextBox;16774;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[9] }
            { 1000000301;Shape  ;16774;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000302;TextBox;15928;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[7] }
            { 1000000303;TextBox;16351;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[8] }
            { 1000000304;Shape  ;16351;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000305;Shape  ;17197;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000306;TextBox;15505;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[6] }
            { 1000000307;Shape  ;15928;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000308;Shape  ;13693;3350 ;1692 ;423   }
            { 1000000309;TextBox;14962;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[5] }
            { 1000000310;Shape  ;15385;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000311;TextBox;14539;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[4] }
            { 1000000312;Shape  ;14962;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000313;TextBox;14116;3350 ;420  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[3] }
            { 1000000314;Shape  ;14539;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000315;Shape  ;14539;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000316;TextBox;13693;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[2] }
            { 1000000317;Shape  ;14116;3350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000318;Shape  ;13573;3350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000319;Shape  ;13150;3350 ;423  ;423   }
            { 1000000320;TextBox;13150;3350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID2[1] }
            { 1000000321;Label  ;8100 ;5800 ;4950 ;500  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=เลขที่ประจำตัวผู้เสียภาษีอากร (13 หลัก)* }
            { 1000000322;TextBox;18703;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[13] }
            { 1000000323;Shape  ;17740;5850 ;846  ;423   }
            { 1000000324;Shape  ;18583;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000325;TextBox;18160;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[12] }
            { 1000000326;Shape  ;15505;5850 ;2115 ;423   }
            { 1000000327;TextBox;17197;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[10] }
            { 1000000328;Shape  ;17620;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000329;TextBox;17740;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[11] }
            { 1000000330;Shape  ;18160;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000331;TextBox;16774;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[9] }
            { 1000000332;Shape  ;16774;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000333;TextBox;15928;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[7] }
            { 1000000334;TextBox;16351;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[8] }
            { 1000000335;Shape  ;16351;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000336;Shape  ;17197;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000337;TextBox;15505;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[6] }
            { 1000000338;Shape  ;15928;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000339;Shape  ;13693;5850 ;1692 ;423   }
            { 1000000340;TextBox;14962;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[5] }
            { 1000000341;Shape  ;15385;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000342;TextBox;14539;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[4] }
            { 1000000343;Shape  ;14962;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000344;TextBox;14116;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[3] }
            { 1000000345;Shape  ;14539;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000346;Shape  ;14539;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000347;TextBox;13693;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[2] }
            { 1000000348;Shape  ;14116;5850 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000349;Shape  ;13573;5850 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000350;Shape  ;13150;5850 ;423  ;423   }
            { 1000000351;TextBox;13150;5850 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=ID3[1] }
            { 1000000352;Shape  ;4640 ;23100;30   ;2050 ;ShapeStyle=VertLine }
            { 1000000353;Label  ;270  ;21250;18690;450  ;FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เงินสะสมจ่ายเข้ากองทุนสำรองเลี้ยงชีพใบอนุญาตเลขที่........................................................จำนวนเงิน................................บาท }
            { 1000000354;Shape  ;150  ;21750;19100;30   ;ShapeStyle=HorzLine }
            { 1000000355;Label  ;3300 ;21800;12750;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เงินสมทบจ่ายเข้ากองทุนประกันสังคม จำนวนเงิน.........................................บาท }
            { 1000000356;Label  ;2400 ;22200;4620 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขที่บัญชีนายจ้าง }
            { 1000000357;Label  ;9610 ;22200;7010 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         CaptionML=ENU=เลขที่บัตรประกันสังคม ของผู้ถูกหักภาษี ณ ที่จ่าย }
            { 1000000358;Shape  ;4785 ;22600;1692 ;423   }
            { 1000000359;TextBox;5631 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[8] }
            { 1000000360;Shape  ;2943 ;22600;1692 ;423   }
            { 1000000361;Shape  ;2370 ;22600;423  ;423   }
            { 1000000362;TextBox;2370 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[1] }
            { 1000000363;TextBox;2943 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[2] }
            { 1000000364;TextBox;3366 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[3] }
            { 1000000365;Shape  ;3366 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000366;TextBox;3789 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[4] }
            { 1000000367;Shape  ;3789 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000368;TextBox;4212 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[5] }
            { 1000000369;Shape  ;4212 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000370;TextBox;4785 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[6] }
            { 1000000371;TextBox;5208 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[7] }
            { 1000000372;Shape  ;5208 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000373;Shape  ;5631 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000374;TextBox;6054 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[9] }
            { 1000000375;Shape  ;6054 ;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000376;Shape  ;2793 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000377;Shape  ;4635 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000378;Shape  ;6477 ;22600;150  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000379;TextBox;6627 ;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=EID[10] }
            { 1000000380;Shape  ;15713;22600;423  ;423   }
            { 1000000381;TextBox;15713;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[13] }
            { 1000000382;Shape  ;15593;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000383;Shape  ;14750;22600;846  ;423   }
            { 1000000384;TextBox;15170;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[12] }
            { 1000000385;Shape  ;12515;22600;2115 ;423   }
            { 1000000386;TextBox;14207;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[10] }
            { 1000000387;Shape  ;14630;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000388;TextBox;14750;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[11] }
            { 1000000389;Shape  ;15170;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000390;TextBox;13784;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[9] }
            { 1000000391;Shape  ;14207;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000392;Shape  ;13784;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000393;TextBox;12938;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[7] }
            { 1000000394;TextBox;13361;22600;420  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[8] }
            { 1000000395;Shape  ;13361;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000396;TextBox;12515;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[6] }
            { 1000000397;Shape  ;12938;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000398;Shape  ;10703;22600;1692 ;423   }
            { 1000000399;TextBox;11972;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[5] }
            { 1000000400;Shape  ;12395;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000401;TextBox;11549;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[4] }
            { 1000000402;Shape  ;11972;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000403;TextBox;11126;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[3] }
            { 1000000404;Shape  ;11549;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000405;Shape  ;11549;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000406;TextBox;10703;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[2] }
            { 1000000407;Shape  ;11126;22600;30   ;423  ;ShapeStyle=VertLine }
            { 1000000408;Shape  ;10583;22600;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000409;Shape  ;10160;22600;423  ;423   }
            { 1000000410;TextBox;10160;22600;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=SoID[1] }
            { 1000000411;Label  ;1350 ;17650;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ซึ่งผู้รับเงินปันผลไม่ได้รับเครดิตภาษี }
            { 1000000412;Label  ;900  ;17250;9600 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(3) กำไรเฉพาะส่วนที่ได้รับยกเว้นไม่ต้องนำมารวมคำนวณภาษีเงินได้นิติบุคคล }
            { 1000000413;Label  ;1940 ;15250;8560 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=คำนวณเป็นรายได้เพื่อเสียภาษีเงินได้นิติบุคคล }
            { 1000000414;Label  ;1350 ;15650;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.3) กำไรสุทธิส่วนที่ได้หักผลขาดทุนสุทธิยกมาไม่เกิน 5 ปี }
            { 1000000415;Label  ;1940 ;16050;8560 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=ก่อนรอบระยะเวลาบัญชีปัจจุบัน }
            { 1000000416;Label  ;1380 ;16850;9120 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.5) อื่นๆ (ระบุ)....................................................................................................... }
            { 1000000417;Label  ;1390 ;16450;9150 ;400  ;FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         CaptionML=ENU=(2.4) กำไรที่รับรู้ทางบัญชีโดยวิธีส่วนได้เสีย (equity method) }
            { 1000000418;TextBox;10800;16850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[13] }
            { 1000000419;TextBox;13400;16850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[13] }
            { 1000000420;TextBox;16450;16850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[13] }
            { 1000000421;TextBox;10800;17250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[14] }
            { 1000000422;TextBox;13400;17250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[14] }
            { 1000000423;TextBox;16450;17250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[14] }
            { 1000000424;TextBox;10800;18027;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[15] }
            { 1000000425;TextBox;13400;18027;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[15] }
            { 1000000426;TextBox;16450;18027;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[15] }
            { 1000000427;TextBox;10800;19604;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[19] }
            { 1000000428;TextBox;13400;19604;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[19] }
            { 1000000429;TextBox;16450;19604;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[19] }
            { 1000000430;TextBox;7630 ;21200;5190 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         SourceExpr=PFundNo }
            { 1000000431;TextBox;14530;21200;2760 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=PFundAmt }
            { 1000000432;TextBox;10930;21720;3500 ;400  ;HorzAlign=Left;
                                                         FontName=Ms Sans Serif;
                                                         FontSize=7;
                                                         BlankZero=Yes;
                                                         SourceExpr=SocialAmt }
            { 1000000438;TextBox;10800;18450;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[16] }
            { 1000000439;TextBox;13400;18450;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[16] }
            { 1000000440;TextBox;16450;18450;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[16] }
            { 1000000441;TextBox;10800;18850;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[17] }
            { 1000000442;TextBox;13400;18850;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[17] }
            { 1000000443;TextBox;16450;18850;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[17] }
            { 1000000444;TextBox;10800;19250;2450 ;400  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTPostingDate[18] }
            { 1000000445;TextBox;13400;19250;2550 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTBaseAmtLCYExcVAT[18] }
            { 1000000446;TextBox;16450;19250;2300 ;400  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         BlankZero=Yes;
                                                         SourceExpr=WHTAmtLCY[18] }
            { 1000000434;Shape  ;18160;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000435;Shape  ;17197;6350 ;30   ;423  ;ShapeStyle=VertLine }
            { 1000000436;TextBox;17197;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[10] }
            { 1000000437;Shape  ;17620;6350 ;120  ;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000447;Shape  ;17740;6350 ;846  ;423   }
            { 1000000449;TextBox;17740;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[11] }
            { 1000000450;TextBox;18160;6350 ;423  ;423  ;HorzAlign=Center;
                                                         SourceExpr=VAT[12] }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19450;
            SectionHeight=500;
            OnPreSection=BEGIN
                           CASE Number OF
                             1: Heading := 'ฉบับที่ 1 (สำหรับผู้ถูกหักภาษี ณ ที่จ่าย ใช้แนบพร้อมกับแบบแสดงรายการภาษี)';
                             2: Heading := 'ฉบับที่ 2 (สำหรับผู้ถูกหักภาษี ณ ที่จ่าย เก็บไว้เป็นหลักฐาน)';
                             3: Heading := 'ฉบับที่ 3';
                             4: Heading := 'ฉบับที่ 4';
                           END;
                           CurrReport.SHOWOUTPUT(HeadingPrint);
                         END;

          }
          CONTROLS
          {
            { 1000000003;TextBox;150  ;0    ;16800;500  ;FontName=Ms San Serif;
                                                         FontSize=8;
                                                         SourceExpr=Heading }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=16830;
      Height=9020;
      SaveValues=Yes;
      OnInit=BEGIN
               HeadingPrint := TRUE;
             END;

    }
    CONTROLS
    {
      { 1000000026;TextBox;4180 ;2640 ;7480 ;440  ;ParentControl=1000000013;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=ชื่อผู้กระทำการแทน;
                                                   SourceExpr=ConductName }
      { 1000000027;Label  ;330  ;2640 ;3740 ;440  ;ParentControl=1000000026 }
      { 1000000028;TextBox;4180 ;3190 ;11550;440  ;ParentControl=1000000013;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=ที่อยู่ผู้กระทำการแทน;
                                                   SourceExpr=ConductAddress }
      { 1000000029;Label  ;330  ;3190 ;3740 ;440  ;ParentControl=1000000028 }
      { 1000000030;TextBox;4180 ;3740 ;3630 ;440  ;ParentControl=1000000013;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=เลขประจำตัวผู้เสียภาษี;
                                                   SourceExpr=ConductVATID }
      { 1000000031;Label  ;330  ;3740 ;3740 ;440  ;ParentControl=1000000030 }
      { 1000000032;TextBox;4180 ;4290 ;3630 ;440  ;ParentControl=1000000013;
                                                   InFrame=Yes;
                                                   CaptionML=ENU=เลขที่ประจำตัวประชาชน;
                                                   SourceExpr=ConductID }
      { 1000000033;Label  ;330  ;4290 ;3740 ;440  ;ParentControl=1000000032 }
      { 1000000000;TextBox;4070 ;660  ;1650 ;440  ;CaptionML=ENU=Number of copies;
                                                   SourceExpr=NumberOfCopy }
      { 1000000001;Label  ;220  ;660  ;3740 ;440  ;ParentControl=1000000000 }
      { 1000000002;TextBox;4070 ;110  ;1650 ;440  ;CaptionML=ENU=Form No.;
                                                   SourceExpr=FormBookNo }
      { 1000000003;Label  ;220  ;110  ;3740 ;440  ;ParentControl=1000000002;
                                                   CaptionML=ENU=Print Form 50 BIS Book No. }
      { 1000000004;CheckBox;4070;1210 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=พิมพ์ฉบับที่ (Heading Print);
                                                   SourceExpr=HeadingPrint }
      { 1000000005;Label  ;220  ;1210 ;3740 ;440  ;ParentControl=1000000004 }
      { 1000000008;OptionButton;3190;7920;3740;440;CaptionML=ENU=ออกภาษีให้ครั้งเดียว;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=0 }
      { 1000000009;OptionButton;3190;7480;3740;440;CaptionML=ENU=ออกภาษีให้ตลอดไป;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=1 }
      { 1000000010;OptionButton;3190;7040;3740;440;CaptionML=ENU=หักภาษี ณ ที่จ่าย;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=2 }
      { 1000000011;OptionButton;3190;8360;3740;440;CaptionML=ENU=อื่นๆ ให้ระบุ................;
                                                   SourceExpr=PaymentOption;
                                                   OptionValue=3 }
      { 1000000012;Label  ;330  ;7040 ;2750 ;440  ;CaptionML=ENU=ผู้จ่ายเงิน }
      { 1000000013;Frame  ;110  ;2090 ;15840;2860 ;FontBold=Yes;
                                                   CaptionML=ENU=กระทำการแทนโดย }
      { 1000000014;TextBox;6930 ;5280 ;2530 ;440  ;CaptionML=ENU=เงินสะสมจ่ายเข้ากองทุนสำรองเลี้ยงชีพใบอนุญาตเลขที่;
                                                   SourceExpr=PFundNo }
      { 1000000015;Label  ;330  ;5280 ;6490 ;440  ;ParentControl=1000000014 }
      { 1000000016;TextBox;11440;5280 ;2530 ;440  ;CaptionML=ENU=จำนวนเงิน;
                                                   SourceExpr=PFundAmt }
      { 1000000017;Label  ;9900 ;5280 ;1430 ;440  ;ParentControl=1000000016 }
      { 1000000018;Label  ;14080;5280 ;1650 ;440  ;LeaderDots=No;
                                                   CaptionML=ENU=บาท }
      { 1000000019;TextBox;6930 ;5830 ;2530 ;440  ;CaptionML=ENU=เงินสมทบเข้ากองทุนประกันสังคม จำนวนเงิน;
                                                   SourceExpr=SocialAmt }
      { 1000000020;Label  ;1320 ;5830 ;5500 ;440  ;ParentControl=1000000019 }
      { 1000000021;Label  ;9570 ;5830 ;1650 ;440  ;LeaderDots=No;
                                                   CaptionML=ENU=บาท }
      { 1000000022;Label  ;1320 ;6380 ;2530 ;440  ;ParentControl=1000000023 }
      { 1000000023;TextBox;3960 ;6380 ;2530 ;440  ;CaptionML=ENU=เลขที่บัญชีนายจ้าง;
                                                   SourceExpr=EmployerAccount }
      { 1000000024;TextBox;12650;6380 ;2530 ;440  ;CaptionML=ENU=เลขที่บัตรประกันสังคม ของผู้ถูกหักภาษี ณ ที่จ่าย;
                                                   SourceExpr=SocialID }
      { 1000000025;Label  ;6600 ;6380 ;5940 ;440  ;ParentControl=1000000024 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000020 : Record 79;
      GLSetup@1000000018 : Record 98;
      Vendor@1000000006 : Record 23;
      CashAdvLine@1000000028 : Record 55052;
      PurchSetup@1000000005 : Record 312;
      WHTPostingSetup@1000000047 : Record 28043;
      WHTRevType@1000000042 : Record 28042;
      WHTBusPostingGrp@1000000036 : Record 28040;
      Form50BIS@1000000046 : Report 50003;
      NoSeriesMgt@1000000033 : Codeunit 396;
      ActualVendorNo@1000000026 : Code[20];
      VAT@1000000029 : ARRAY [20] OF Code[1];
      CID@1000000008 : ARRAY [20] OF Code[1];
      CCID@1000000007 : ARRAY [20] OF Code[1];
      FormBookNo@1000000032 : Code[10];
      WHTSlipNo@1000000030 : Code[20];
      Name@1000000004 : Text[150];
      Address@1000000003 : Text[250];
      Address2@1000000002 : Text[250];
      City@1000000001 : Text[30];
      ConductID@1000000009 : Text[20];
      ConductName@1000000022 : Text[250];
      ConductAddress@1000000015 : Text[250];
      ExpenseType@1000000016 : ARRAY [4] OF Text[1];
      WHTGroup@1000000010 : ARRAY [2] OF Text[1];
      WHTTerm@1000000011 : ARRAY [4] OF Text[1];
      WHTAmtLCYText@1000000019 : Text[200];
      WHTExpenseText@1000000025 : Text[30];
      WHTPostingDate@1000000031 : ARRAY [19] OF Date;
      WHTBaseAmt@1000000017 : Decimal;
      WHTBaseAmtLCYExcVAT@1000000013 : ARRAY [19] OF Decimal;
      WHTAmtLCY@1000000014 : ARRAY [19] OF Decimal;
      TotWHTBaseAmtLCYExcVAT@1000000023 : Decimal;
      TotWHTAmtLCY@1000000021 : Decimal;
      NumberOfCopy@1000000024 : Integer;
      NewDocNo@1000000038 : Code[20];
      HeadingPrint@1000000041 : Boolean;
      Heading@1000000000 : Text[100];
      DocNoFilter@1000000027 : Text[250];
      PostingDate@1000000012 : Date;
      PaymentOption@1000000035 : '0,1,2,3';
      i@1000000034 : Integer;
      ConductVATID@1000000054 : Text[20];
      ID1@1000000053 : ARRAY [13] OF Code[1];
      ID2@1000000052 : ARRAY [13] OF Code[1];
      ID3@1000000051 : ARRAY [13] OF Code[1];
      PFundNo@1000000050 : Code[20];
      PFundAmt@1000000049 : Decimal;
      SocialAmt@1000000048 : Decimal;
      EmployerAccount@1000000045 : Code[10];
      SocialID@1000000044 : Code[13];
      SoID@1000000043 : ARRAY [13] OF Code[1];
      EID@1000000040 : ARRAY [10] OF Code[1];
      CompanyPhone@1000000039 : Text[50];
      Phone@1000000037 : Text[50];

    PROCEDURE CalcWHTEntry@1000000001(CashAdvLine@1000000000 : Record 55052) : Boolean;
    BEGIN
      WITH CashAdvLine DO BEGIN
        WHTPostingSetup.GET("WHT Business Posting Group","WHT Product Posting Group");
        IF WHTPostingSetup."WHT %" = 0 THEN
          EXIT(FALSE);

        CASE WHTPostingSetup."WHT Report" OF
          WHTPostingSetup."WHT Report"::"Por Ngor Dor 3":
            WHTGroup[1] := 'P';
          WHTPostingSetup."WHT Report"::"Por Ngor Dor 53":
            WHTGroup[2] := 'P';
        END;

        IF WHTRevType.GET(WHTPostingSetup."Revenue Type") THEN BEGIN
          i := WHTRevType.Sequence;
          IF (i = 99) OR (i = 19) THEN BEGIN  //KKE : #002
            i := 19;
            WHTExpenseText := WHTRevType.Description;
          END;
          WHTPostingDate[i] := "Cash Advance Header"."Posting Date";
          PostingDate := "Cash Advance Header"."Posting Date";

          IF "WHT Absorb Base" <> 0 THEN
            WHTBaseAmt := "WHT Absorb Base"
          ELSE
            WHTBaseAmt := "VAT Base Amount (LCY)";

          WHTAmtLCY[i] := WHTAmtLCY[i] + ROUND(WHTBaseAmt * WHTPostingSetup."WHT %" / 100);
          WHTBaseAmtLCYExcVAT[i] := WHTBaseAmtLCYExcVAT[i] + WHTBaseAmt;
          TotWHTBaseAmtLCYExcVAT := TotWHTBaseAmtLCYExcVAT + WHTBaseAmt;
          TotWHTAmtLCY := TotWHTAmtLCY + ROUND(WHTBaseAmt * WHTPostingSetup."WHT %" / 100);
        END;
      END;
      EXIT(TRUE);
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization Demo TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.08.2006   KKE   WHT Slip for Cash Advance.
      002   04.09.2006   KKE   Update for new format
                               Add 3 sub sequence in 5.
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50095 Payment Voucher - Cash Advance
{
  OBJECT-PROPERTIES
  {
    Date=10/11/07;
    Time=11:58:01 AM;
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
    OnInitReport=BEGIN
                   CompanyInfo.GET;
                   CompanyInfo.CALCFIELDS(Picture);
                 END;

    OnPreReport=BEGIN
                  DebitTotalLCY := 0;
                  CreditTotalLCY := 0;
                END;

    PaperSize=A4 210 x 297 mm;
    HorzGrid=50;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55056;
        DataItemTableView=SORTING(No.);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        CASE TRUE OF
                          Cash: xCash := 'P';
                          Cheque: xCheque := 'P';
                        END;
                      END;

        OnAfterGetRecord=BEGIN
                           DocumentNo := "No.";

                           Vendor.GET("Cash Advance Vendor No.");
                           IF Vendor."Name (Thai)" <> '' THEN
                             VendName := Vendor."No." + '   ' + Vendor."Name (Thai)"
                           ELSE
                             VendName := Vendor."No." + '   ' + Vendor.Name + Vendor."Name 2";

                           CALCFIELDS("Balance Settle","Total WHT (LCY)");
                           TotalAmt := "Balance Settle";

                           VendPostingGroup.GET(Vendor."Vendor Posting Group");
                           DebitAccNo[1] := VendPostingGroup."Payables Account";
                           GLAcc.GET(DebitAccNo[1]);
                           DebitAccName[1] := GLAcc.Name;
                           DebitAmount[1] := -TotalAmt;

                           CASE "Settle Account Type" OF
                             "Settle Account Type"::"Bank Account":
                               BEGIN
                                 BankName := "Settle Account No.";
                                 BankAcc.GET("Settle Account No.");
                                 BankBranch := BankAcc."Bank Branch No.";
                                 BankAccPostingGroup.GET(BankAcc."Bank Acc. Posting Group");
                                 CreditAccNo[1] := BankAccPostingGroup."G/L Bank Account No.";
                                 GLAcc.GET(CreditAccNo[1]);
                                 CreditAccName[1] := GLAcc.Name;
                                 CreditAmount[1] := -TotalAmt;
                               END;
                             "Settle Account Type"::"G/L Account":
                               BEGIN
                                 CreditAccNo[1] := "Settle Account No.";
                                 GLAcc.GET(CreditAccNo[1]);
                                 CreditAccName[1] := GLAcc.Name;
                                 CreditAmount[1] := -TotalAmt;
                               END;
                             "Settle Account Type"::Vendor:
                               BEGIN
                                 Vendor2.GET("Settle Account No.");
                                 VendPostingGroup.GET(Vendor2."Vendor Posting Group");
                                 CreditAccNo[1] := VendPostingGroup."Payables Account";
                                 GLAcc.GET(CreditAccNo[1]);
                                 CreditAccName[1] := GLAcc.Name;
                                 CreditAmount[1] := -TotalAmt;
                               END;
                           END;

                           //CheckReport.InitTextVariable;
                           //CheckReport.FormatNoText(TextAmount,ABS(TotalAmt),"Currency Code");

                           TextAmount[1] := FORMAT(ABS(TotalAmt),0,'<Precision,2:3><Standard Format,0>') + ' (' +
                             Form50BIS.FormatNoThaiText(ABS(TotalAmt)) + ')';

                           CashAdvComtLine.RESET;
                           CashAdvComtLine.SETRANGE("Document Type",CashAdvComtLine."Document Type"::Settle);
                           CashAdvComtLine.SETRANGE("No.","No.");
                           CashAdvComtLine.SETFILTER(Comment,'<>%1','');
                           IF CashAdvComtLine.FIND('-') THEN
                             REPEAT
                               IF STRLEN(Remark + CashAdvComtLine.Comment) < 250 THEN
                                 Remark += CashAdvComtLine.Comment + ' ';
                             UNTIL CashAdvComtLine.NEXT=0;
                         END;

        ReqFilterFields=No.;
        GroupTotalFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19400;
            SectionHeight=4000;
            OnPreSection=BEGIN
                           Line := 0;
                           IF CurrReport.PAGENO > 1 THEN
                             TextPageNo := STRSUBSTNO('Page %1',CurrReport.PAGENO);
                         END;

          }
          CONTROLS
          {
            { 1000000047;Label  ;14600;2850 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=No......................................... }
            { 1000000055;TextBox;15300;2750 ;3600 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         FontBold=Yes;
                                                         SourceExpr=DocumentNo }
            { 1000000060;Label  ;14600;3400 ;4440 ;500  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Date...................................... }
            { 1000000061;TextBox;15650;3400 ;3000 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Posting Date" }
            { 1000000133;TextBox;11400;50   ;7450 ;850  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo.Name }
            { 1000000145;TextBox;11400;1100 ;7450 ;500  ;HorzAlign=Right;
                                                         FontName=CordiaUPC;
                                                         FontSize=13;
                                                         SourceExpr='เลขประจำตัวผู้เสียภาษี ' + CompanyInfo."VAT Registration No." }
            { 1000000136;TextBox;0    ;0    ;9700 ;600  ;HorzAlign=Left;
                                                         FontName=CordiaUPC;
                                                         FontSize=15;
                                                         FontBold=Yes;
                                                         SourceExpr=CompanyInfo."Company Name (Thai)" }
            { 1000000140;TextBox;0    ;600  ;9700 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo.Address + CompanyInfo."Address 2" }
            { 1000000141;TextBox;0    ;1200 ;7550 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr=CompanyInfo."Address 3" + ' ' + CompanyInfo."Post Code" }
            { 1000000135;Label  ;7700 ;1650 ;4900 ;850  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=11;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=PAYMENT VOUCHER }
            { 1000000142;TextBox;0    ;1800 ;7550 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=9;
                                                         SourceExpr='Tel: ' + CompanyInfo."Phone No." + ' Fax: ' + CompanyInfo."Fax No." }
            { 1000000143;TextBox;14800;1900 ;4050 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextPageNo }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19400;
            SectionHeight=4330;
          }
          CONTROLS
          {
            { 1000000096;Shape  ;0    ;0    ;30   ;4330 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000063;Label  ;150  ;150  ;10350;550  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Paid to................................................................................................................... }
            { 1000000147;TextBox;1250 ;100  ;9100 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=VendName }
            { 1000000119;Label  ;13450;850  ;5600 ;550  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Payment Date........................................ }
            { 1000000120;TextBox;15600;800  ;3300 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Posting Date" }
            { 1000000033;Shape  ;19230;0    ;30   ;4330 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000083;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000085;Shape  ;0    ;3600 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000125;Label  ;16100;3650 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000127;Label  ;12800;3650 ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Input VAT }
            { 1000000129;Label  ;10000;3650 ;2320 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Goods/Service }
            { 1000000131;Label  ;1450 ;3650 ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description }
            { 1000000090;Shape  ;0    ;4300 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000110;Shape  ;9500 ;3600 ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000115;Shape  ;12630;3600 ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000116;Shape  ;15850;3600 ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000017;Label  ;10750;150  ;8320 ;550  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Payee Name....................................................................................... }
            { 1000000180;TextBox;12450;100  ;6410 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=PayeeName }
            { 1000000234;Label  ;150  ;850  ;13150;550  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=For Payment of ................................................................................................................................ }
            { 1000000235;TextBox;2450 ;800  ;10500;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Payment Invoice Description" }
            { 1000000000;Label  ;150  ;1500 ;18870;600  ;HorzAlign=Left;
                                                         VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Amount ..................................................................................................................................................................................................... }
            { 1000000004;TextBox;1450 ;1500 ;17480;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextAmount[1] }
            { 1000000069;Label  ;150  ;2300 ;660  ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=By : }
            { 1000000087;Shape  ;900  ;2350 ;450  ;423   }
            { 1000000088;TextBox;960  ;2350 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCash }
            { 1000000068;Label  ;1420 ;2300 ;900  ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CASH }
            { 1000000084;TextBox;2450 ;2350 ;450  ;450  ;VertAlign=Bottom;
                                                         FontName=WingDings 2;
                                                         FontSize=11;
                                                         FontBold=No;
                                                         SourceExpr=xCheque }
            { 1000000086;Shape  ;2350 ;2350 ;450  ;423   }
            { 1000000067;Label  ;2920 ;2300 ;1770 ;600  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Check/ Draft }
            { 1000000095;Label  ;5100 ;2200 ;7000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Bank.......................................................................................... }
            { 1000000100;TextBox;5950 ;2200 ;5550 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=BankName }
            { 1000000097;Label  ;5100 ;2850 ;7000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Branch........................................................................ }
            { 1000000101;TextBox;6200 ;2850 ;5300 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=BankBranch }
            { 1000000122;Label  ;12950;2850 ;6000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Date................................................................. }
            { 1000000124;TextBox;14000;2850 ;2900 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CheckDate }
            { 1000000103;Label  ;12950;2200 ;6000 ;600  ;VertAlign=Bottom;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Check No........................................................ }
            { 1000000121;TextBox;14450;2200 ;4050 ;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CheckNo }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=700;
            OnPreSection=BEGIN
                           CheckReport.InitTextVariable;
                           CheckReport.FormatNoText(TextAmount,ABS(TotalAmt),"Currency Code");

                           IF TextAmount[1] <> '' THEN
                             TextAmount[1] := '(' + TextAmount[1] + ')';
                         END;

          }
          CONTROLS
          {
            { 1000000093;TextBox;12750;100  ;3000 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitTotalLCY }
            { 1000000094;TextBox;16000;100  ;3110 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditTotalLCY }
            { 1000000099;Shape  ;12580;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000102;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000153;Label  ;11300;100  ;1150 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total }
            { 1000000019;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000034;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000036;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000167;TextBox;100  ;50   ;11150;600  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TextAmount[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19400;
            SectionHeight=550;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(FALSE);
                           DebitTotalLCY := 0;
                           CreditTotalLCY := 0;
                         END;

          }
          CONTROLS
          {
            { 1000000161;Label  ;0    ;0    ;5750 ;550  ;HorzAlign=Center;
                                                         ForeColor=255;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=DO NOT DELETE THIS SECTION }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=4580;
          }
          CONTROLS
          {
            { 1000000158;Label  ;150  ;150  ;2075 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Remark }
            { 1000000201;Label  ;6750 ;2650 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000210;Label  ;6750 ;3800 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000078;Label  ;16000;3800 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000050;Shape  ;0    ;0    ;30   ;4550 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000051;Shape  ;19230;0    ;30   ;4550 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000065;Shape  ;0    ;4550 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000107;Shape  ;0    ;2150 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000172;Shape  ;0    ;3350 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000175;Shape  ;9625 ;2150 ;30   ;2400 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000013;Label  ;10200;2650 ;2275 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Acct.Entry By : }
            { 1000000022;Label  ;10200;3800 ;2335 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Approved By : }
            { 1000000025;Label  ;550  ;3800 ;2045 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Received By : }
            { 1000000035;Label  ;550  ;2650 ;2075 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Prepared By : }
            { 1000000042;Label  ;16000;2650 ;750  ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Date }
            { 1000000077;TextBox;850  ;700  ;18000;1400 ;VertAlign=Top;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         MultiLine=Yes;
                                                         SourceExpr=Remark }
            { 1000000037;Shape  ;15   ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55057;
        DataItemTableView=SORTING(Entry No.);
        OnAfterGetRecord=VAR
                           DebitAppliedVATAmtTmp@1000000000 : Decimal;
                           CreditAppliedVATAmtTmp@1000000001 : Decimal;
                         BEGIN
                           VendLedgEntry3.GET("Entry No.");

                           CreditVATAmtTmp := 0;
                           VATEntry.RESET;
                           VATEntry.SETCURRENTKEY("Document No.","Posting Date");
                           VATEntry.SETRANGE("Posting Date",VendLedgEntry3."Posting Date");
                           VATEntry.SETRANGE("Document No.",VendLedgEntry3."Document No.");
                           IF VATEntry.FIND('-') THEN
                             REPEAT
                               IF VATEntry."Remaining Unrealized Amount" <> 0 THEN
                                 BEGIN
                                   CreditVATAmtTmp := CreditVATAmtTmp + VATEntry."Remaining Unrealized Amount";
                                 END;
                               IF VATEntry.Amount <> 0 THEN
                                 BEGIN
                                   CreditVATAmtTmp := CreditVATAmtTmp + VATEntry.Amount;
                                 END;

                             UNTIL VATEntry.NEXT=0;
                           totCreditVATAmtTmp += CreditVATAmtTmp;
                         END;

        TotalFields=Amount (LCY) Incl. VAT,WHT Amount (LCY);
        DataItemLink=Settle Cash Advance No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=TransHeader;
            SectionWidth=19400;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000046;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000062;Label  ;1450 ;50   ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Description }
            { 1000000064;Label  ;10000;50   ;2320 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Goods/Service }
            { 1000000082;Label  ;12800;50   ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Input VAT }
            { 1000000089;Label  ;16100;50   ;2900 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000092;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000132;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000146;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000150;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000151;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000152;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000123;TextBox;400  ;50   ;9050 ;600  ;FontSize=8;
                                                         SourceExpr=VendLedgEntry3.Description + '   #' +VendLedgEntry3."External Document No." }
            { 1000000138;TextBox;9650 ;50   ;2850 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Amount (LCY) Incl. VAT" + "WHT Amount (LCY)" - CreditVATAmtTmp }
            { 1000000074;TextBox;12800;50   ;2900 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATAmtTmp }
            { 1000000076;TextBox;16050;50   ;3050 ;600  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Amount (LCY) Incl. VAT" + "WHT Amount (LCY)" }
            { 1000000149;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000154;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000156;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000157;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000159;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000160;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=VendLEFooter;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=730;
            OnPreSection=BEGIN
                           IF ShowBlank = TRUE THEN
                             CurrReport.SHOWOUTPUT(TRUE)
                           ELSE
                             CurrReport.SHOWOUTPUT(FALSE);
                         END;

          }
          CONTROLS
          {
            { 1000000182;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000183;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000187;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000193;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000197;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000198;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=19400;
            SectionHeight=2180;
          }
          CONTROLS
          {
            { 1000000066;Label  ;150  ;850  ;12900;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Case of Witholding tax.............................Rate........%.....................From.............................. }
            { 1000000071;Label  ;4650 ;0    ;1950 ;650  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Total (Baht) }
            { 1000000091;Label  ;150  ;1450 ;8250 ;550  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=(No. Letter of Witholding tax.......................................) }
            { 1000000126;TextBox;6600 ;0    ;2800 ;650  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Settle Cash Advance Line"."Amount (LCY) Incl. VAT" + "Settle Cash Advance Line"."WHT Amount (LCY)" }
            { 1000000128;TextBox;9650 ;0    ;2850 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Settle Cash Advance Line"."Amount (LCY) Incl. VAT" + "Settle Cash Advance Line"."WHT Amount (LCY)" - totCreditVATAmtTmp }
            { 1000000130;TextBox;12800;0    ;2900 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=totCreditVATAmtTmp }
            { 1000000134;TextBox;16050;0    ;3050 ;650  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-"Settle Cash Advance Line"."Amount (LCY) Incl. VAT" + "Settle Cash Advance Line"."WHT Amount (LCY)" }
            { 1000000137;TextBox;150  ;0    ;4400 ;650  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=TotalItemText }
            { 1000000139;Label  ;13100;850  ;2320 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=WHT Amount }
            { 1000000144;TextBox;16050;750  ;3050 ;550  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr="Settle Cash Advance Line"."WHT Amount (LCY)";
                                                         AutoFormatType=1 }
            { 1000000148;TextBox;16050;1450 ;3050 ;550  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=[ FORMAT(ABS(TotalAmt),0,'<Precision,2:2><Standard Format,0>')] }
            { 1000000162;Label  ;12850;1550 ;2770 ;550  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Net Payment (Baht) }
            { 1000000163;Shape  ;0    ;0    ;30   ;2150 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000165;Shape  ;19230;0    ;30   ;2150 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000185;Shape  ;15850;0    ;30   ;2150 ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000186;Shape  ;12630;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000188;Shape  ;9500 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000189;Shape  ;0    ;2150 ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000190;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000191;Shape  ;15850;1400 ;3400 ;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=19400;
            SectionHeight=730;
          }
          CONTROLS
          {
            { 1000000111;Label  ;16050;50   ;3050 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=CREDIT }
            { 1000000112;Shape  ;15850;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000113;Label  ;12750;50   ;3000 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=DEBIT }
            { 1000000114;Shape  ;12580;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000164;Label  ;3400 ;50   ;5750 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Account Name }
            { 1000000118;Shape  ;3000 ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000109;Label  ;150  ;50   ;2700 ;600  ;HorzAlign=Center;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         CaptionML=ENU=Account Code }
            { 1000000029;Shape  ;0    ;0    ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000031;Shape  ;0    ;700  ;19250;30   ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000008;Shape  ;0    ;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000011;Shape  ;19230;0    ;30   ;700  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=TransFooter;
            SectionWidth=19400;
            SectionHeight=500;
          }
          CONTROLS
          {
            { 1000000155;Label  ;15550;0    ;3600 ;500  ;HorzAlign=General;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         FontBold=No;
                                                         LeaderDots=Yes;
                                                         CaptionML=ENU=Continue Next Page. }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitDetail;
        OnPreDataItem=BEGIN
                        //Clear credit amount less than zero.
                        I := 0;
                        REPEAT
                          I := I + 1;
                          IF CreditAmount[I] < 0 THEN BEGIN
                            MatchAcc := FALSE;
                            J := 0;
                            REPEAT
                              J := J + 1;
                              IF DebitAccNo[J] = '' THEN
                                MatchAcc := TRUE;
                            UNTIL (J>=300) OR MatchAcc;
                            IF MatchAcc THEN BEGIN
                              DebitAccNo[J] := CreditAccNo[I];
                              DebitAccName[J] := CreditAccName[I];
                              DebitAmount[J] := -CreditAmount[I];
                              DebitDimValue[J] := CreditDimValue[I];
                              CreditAmount[I] := 0;
                            END;
                          END;
                        UNTIL (I>=300) OR (CreditAccNo[I] = '');

                        //Clear debit amount less than zero.
                        I := 0;
                        REPEAT
                          I := I + 1;
                          IF DebitAmount[I] < 0 THEN BEGIN
                            MatchAcc := FALSE;
                            J := 0;
                            REPEAT
                              J := J + 1;
                              IF CreditAccNo[J] = '' THEN
                                MatchAcc := TRUE;
                            UNTIL (J>=300) OR MatchAcc;
                            IF MatchAcc THEN BEGIN
                              CreditAccNo[J] := DebitAccNo[I];
                              CreditAccName[J] := DebitAccName[I];
                              CreditAmount[J] := -DebitAmount[I];
                              CreditDimValue[J] := DebitDimValue[I];
                              DebitAmount[I] := 0;
                            END;
                          END;
                        UNTIL (I>=300) OR (DebitAccNo[I] = '');

                        //Check balance debit/credit with same g/l account.
                        I := 0;
                        REPEAT
                          I := I + 1;
                          IF DebitAmount[I] > 0 THEN BEGIN
                            MatchAcc := FALSE;
                            J := 0;
                            REPEAT
                              J := J + 1;
                              IF DebitAccNo[I] = CreditAccNo[J] THEN
                                MatchAcc := TRUE;
                            UNTIL (J>=300) OR MatchAcc;
                            IF MatchAcc THEN BEGIN
                              IF DebitAmount[I] >= CreditAmount[J] THEN BEGIN
                                DebitAmount[I] := DebitAmount[I] - CreditAmount[J];
                                CreditAmount[J] := 0;
                              END ELSE BEGIN
                                CreditAmount[J] := CreditAmount[J] - DebitAmount[I];
                                DebitAmount[I] := 0;
                              END;
                            END;
                          END;
                        UNTIL (I>=300) OR (DebitAccNo[I] = '');
                      END;

        OnAfterGetRecord=BEGIN
                           IF DebitAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                           IF DebitAmount[Number] <= 0 THEN
                             CurrReport.SKIP;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           DebitTotalLCY := DebitTotalLCY + DebitAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000001;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccName[Number] }
            { 1000000002;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000003;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitAccNo[Number] }
            { 1000000005;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000006;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000007;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000009;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000010;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=DebitVATDetail;
        OnAfterGetRecord=BEGIN
                           IF DebitVATNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := DebitVATAmt[Number] <> 0;
                           DebitTotalLCY := DebitTotalLCY + DebitVATAmt[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000030;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVATName[Number] }
            { 1000000038;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVATAmt[Number];
                                                         AutoFormatType=1 }
            { 1000000039;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=DebitVATNo[Number] }
            { 1000000040;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000041;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000045;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000048;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000049;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=CONST(1));
        DataItemVarName=WHTDetail;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(WHTAmt <> 0);
                           IF WHTAmt <> 0 THEN BEGIN
                             Line := Line + 1;
                             DebitTotalLCY := DebitTotalLCY + WHTAmt;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000043;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000044;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAmt;
                                                         AutoFormatType=1 }
            { 1000000075;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000166;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000178;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000179;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000181;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000184;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(CreditWHTAmt > 0);
                           IF CreditWHTAmt > 0 THEN BEGIN
                             Line := Line + 1;
                             DebitTotalLCY := DebitTotalLCY + CreditWHTAmt;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000079;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000080;TextBox;12750;50   ;3000 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditWHTAmt;
                                                         AutoFormatType=1 }
            { 1000000081;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Left;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000098;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000105;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000106;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000108;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000117;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(CreditWHTAmt < 0);
                           IF CreditWHTAmt < 0 THEN BEGIN
                             Line := Line + 1;
                             CreditTotalLCY := CreditTotalLCY - CreditWHTAmt;
                           END;
                         END;

          }
          CONTROLS
          {
            { 1000000052;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountName }
            { 1000000053;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=-CreditWHTAmt;
                                                         AutoFormatType=1 }
            { 1000000104;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=WHTAccountNo }
            { 1000000212;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000213;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000214;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000216;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000218;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditVATDetail;
        OnAfterGetRecord=BEGIN
                           IF CreditVATNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE
                             Line := Line + 1;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := CreditVATAmt[Number] <> 0;
                           CreditTotalLCY := CreditTotalLCY + CreditVATAmt[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000054;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATName[Number] }
            { 1000000056;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATAmt[Number];
                                                         AutoFormatType=1 }
            { 1000000057;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditVATNo[Number] }
            { 1000000058;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000059;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000070;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000072;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000073;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=CreditDetail;
        OnPreDataItem=BEGIN
                        I := 0;
                        MatchAcc := FALSE;
                        REPEAT
                          I := I + 1;
                          IF (CreditAccNo[I] = BankAccNo) AND (CreditAmount[I] <> 0) THEN BEGIN
                            CreditAmount[I] := CreditAmount[I] + CreditWHTAmt;
                            MatchAcc := TRUE;
                          END;
                        UNTIL (I>=300) OR MatchAcc;
                      END;

        OnAfterGetRecord=BEGIN
                           IF Number >= 300 THEN
                             CurrReport.BREAK;

                           IF CreditAmount[Number] <= 0 THEN
                             CurrReport.SKIP;
                           IF CreditAccNo[Number] = '' THEN
                             CurrReport.BREAK
                           ELSE BEGIN
                             IF NOT MatchAcc THEN BEGIN
                               CreditAmount[Number] := CreditAmount[Number] + CreditWHTAmt;
                               MatchAcc := TRUE;
                             END;
                             Line := Line + 1;
                           END;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
            OnPreSection=BEGIN
                           CreditTotalLCY := CreditTotalLCY + CreditAmount[Number];
                         END;

          }
          CONTROLS
          {
            { 1000000012;TextBox;3150 ;50   ;9350 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccName[Number] }
            { 1000000014;TextBox;16100;50   ;2980 ;500  ;FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAmount[Number];
                                                         AutoFormatType=1 }
            { 1000000015;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000016;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000018;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000020;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000027;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000028;TextBox;150  ;50   ;2700 ;500  ;HorzAlign=Right;
                                                         FontName=Tahoma;
                                                         FontSize=8;
                                                         SourceExpr=CreditAccNo[Number] }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number)
                          WHERE(Number=FILTER(1..));
        DataItemVarName=LineLoop;
        OnPreDataItem=BEGIN
                        {GenJnlLine3.COPY("Gen. Journal Line");
                        IF GenJnlLine3.NEXT <> 0 THEN
                        IF (GenJnlLine3."Document No." = GenJnlLine2."Document No.") THEN
                          CurrReport.BREAK;  }
                      END;

        OnAfterGetRecord=BEGIN
                           IF Line + Number > 10 THEN
                             CurrReport.BREAK;
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19400;
            SectionHeight=600;
          }
          CONTROLS
          {
            { 1000000021;Shape  ;19230;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000023;Shape  ;15850;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000024;Shape  ;12580;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000026;Shape  ;3000 ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
            { 1000000032;Shape  ;0    ;0    ;30   ;600  ;BorderWidth=1pt;
                                                         ShapeStyle=VertLine }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=11440;
      Height=2200;
      SaveValues=Yes;
      OnInit=BEGIN
               Cash := FALSE;
               Cheque := TRUE;
             END;

    }
    CONTROLS
    {
      { 1000000000;CheckBox;3410;110  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Cash;
                                                   SourceExpr=Cash;
                                                   OnValidate=BEGIN
                                                                IF Cash THEN
                                                                  Cheque := FALSE;
                                                              END;
                                                               }
      { 1000000001;Label  ;110  ;110  ;3190 ;440  ;ParentControl=1000000000 }
      { 1000000002;Label  ;110  ;660  ;3190 ;440  ;ParentControl=1000000003 }
      { 1000000003;CheckBox;3410;660  ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Cheque;
                                                   SourceExpr=Cheque;
                                                   OnPush=BEGIN
                                                            IF Cheque THEN
                                                              Cash := FALSE;
                                                          END;
                                                           }
      { 1000000004;TextBox;3410 ;1210 ;3300 ;440  ;CaptionML=ENU=Starting Cheque No.;
                                                   SourceExpr=StartingChequeNo }
      { 1000000005;Label  ;110  ;1210 ;3190 ;440  ;ParentControl=1000000004 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CompanyInfo@1000000003 : Record 79;
      Vendor@1000000025 : Record 23;
      Vendor2@1000000073 : Record 23;
      VendPostingGroup@1000000036 : Record 93;
      VendLedgEntry@1000000016 : Record 25;
      VendLedgEntry2@1000000075 : Record 25;
      VendLedgEntry3@1000000061 : Record 25;
      VendLedgerEntrybuffer@1000000028 : Record 25;
      VendLedgerEntry@1000000027 : Record 25;
      CreditMemoVendLedgerEntry@1000000010 : Record 25;
      Customer@1000000026 : Record 18;
      CustPostingGroup@1000000035 : Record 92;
      CustLedgEntry@1000000081 : Record 21;
      GLAcc@1000000022 : Record 15;
      BankAcc@1000000030 : Record 270;
      BankAccPostingGroup@1000000034 : Record 277;
      WHTPostingSetup@1000000085 : Record 28043;
      WHTEntry@1000000015 : Record 28044;
      SalesInvLine@1000000084 : Record 113;
      GenJnlLine@1000000045 : Record 81;
      GenJnlLine2@1000000065 : Record 81;
      GenJnlLine3@1000000042 : Record 81;
      xGenJnlLine@1000000086 : Record 81;
      VATEntry@1000000074 : Record 254;
      VATPostSetup@1000000055 : Record 325;
      CheckReport@1000000004 : Report 1401;
      WHTManagement@1000000005 : Codeunit 28040;
      DebitAccount@1000000054 : Code[20];
      CreditAccount@1000000053 : Code[20];
      DebitAccNo@1000000052 : ARRAY [300] OF Code[20];
      CreditAccNo@1000000051 : ARRAY [300] OF Code[20];
      DebitAccName@1000000050 : ARRAY [300] OF Text[150];
      CreditAccName@1000000049 : ARRAY [300] OF Text[150];
      DebitAmount@1000000021 : ARRAY [300] OF Decimal;
      CreditAmount@1000000020 : ARRAY [300] OF Decimal;
      DebitDimValue@1000000013 : ARRAY [300] OF Code[20];
      CreditDimValue@1000000012 : ARRAY [300] OF Code[20];
      DebitVATDimValue@1000000079 : ARRAY [300] OF Code[20];
      CreditVATDimValue@1000000078 : ARRAY [300] OF Code[20];
      DebitVATNo@1000000067 : ARRAY [300] OF Code[20];
      CreditVATNo@1000000062 : ARRAY [300] OF Code[20];
      DebitVATName@1000000060 : ARRAY [300] OF Text[150];
      CreditVATName@1000000059 : ARRAY [300] OF Text[150];
      DebitVATAmt@1000000040 : ARRAY [300] OF Decimal;
      CreditVATAmt@1000000039 : ARRAY [300] OF Decimal;
      VATAccountNo@1000000007 : Code[20];
      VATAccountName@1000000002 : Text[150];
      WHTAccountNo@1000000018 : Code[20];
      WHTAccountName@1000000011 : Text[150];
      DebitTotalLCY@1000000000 : Decimal;
      CreditTotalLCY@1000000001 : Decimal;
      VendName@1000000038 : Text[150];
      DimentionValue@1000000046 : Code[20];
      TextAmount@1000000063 : ARRAY [2] OF Text[250];
      WHTAmt@1000000024 : Decimal;
      WHTBaseAmt@1000000008 : Decimal;
      CreditWHTAmt@1000000068 : Decimal;
      CreditWHTBaseAmt@1000000009 : Decimal;
      TotalAmt@1000000017 : Decimal;
      Line@1000000066 : Integer;
      DocumentNo@1000000029 : Code[20];
      Cash@1000000072 : Boolean;
      Cheque@1000000071 : Boolean;
      xCash@1000000070 : Text[1];
      xCheque@1000000069 : Text[1];
      BankAccNo@1000000014 : Code[20];
      BankName@1000000031 : Text[50];
      BankBranch@1000000032 : Text[30];
      StartingChequeNo@1000000064 : Code[20];
      CheckNo@1000000023 : Code[20];
      CheckDate@1000000019 : Date;
      PayPer@1000000033 : Decimal;
      DebitAmt@1000000037 : Decimal;
      CreditAmt@1000000041 : Decimal;
      DebitAmt2@1000000044 : Decimal;
      CreditAmt2@1000000043 : Decimal;
      MatchAcc@1000000057 : Boolean;
      I@1000000048 : Integer;
      J@1000000058 : Integer;
      DebitAppliedVATAmt@1000000076 : Decimal;
      CreditAppliedVATAmt@1000000077 : Decimal;
      PayeeName@1000000080 : Text[250];
      PaymentAmount@1000000082 : Decimal;
      ApplyCreditAmount@1000000083 : Decimal;
      ApplyInvoiceAmount@1000000089 : Decimal;
      g_intPatial@1000000093 : Integer;
      g_decRatioPatial@1000000094 : Decimal;
      g_decVATApplCrd@1000000095 : Decimal;
      FlagStatus@1000000096 : Integer;
      VATAccount@1000000098 : Code[20];
      VATAmount@1000000097 : Decimal;
      CreditVATAmtTmp@1000000102 : Decimal;
      CreditAppliedVATAmtTmp@1000000103 : Decimal;
      totCreditVATAmtTmp@1000000104 : Decimal;
      AmounttoApply@1000000105 : Decimal;
      totAmounttoApply@1000000106 : Decimal;
      ShowBlank@1000000109 : Boolean;
      TotalItemText@1000000047 : Text[30];
      Form50BIS@1000000087 : Report 50002;
      CashAdvComtLine@1000000088 : Record 55053;
      Remark@1000000090 : Text[250];
      TextPageNo@1000000006 : Text[30];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.08.2006   KKE   Payment Voucher - Cash Advance
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50096 Suggest Cash Advance Line
{
  OBJECT-PROPERTIES
  {
    Date=02/21/07;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55056;
        DataItemTableView=SORTING(No.);
        OnAfterGetRecord=BEGIN
                           LineNo := 0;
                           SettleCashAdvLine.RESET;
                           SettleCashAdvLine.SETRANGE("Settle Cash Advance No.","No.");
                           IF SettleCashAdvLine.FIND('+') THEN
                             LineNo := SettleCashAdvLine."Line No.";

                           VendLedgEntry.RESET;
                           VendLedgEntry.SETCURRENTKEY("Vendor No.","Posting Date","Currency Code");
                           VendLedgEntry.SETRANGE("Vendor No.","Cash Advance Vendor No.");
                           VendLedgEntry.SETFILTER("Posting Date",'..%1',"Posting Date");
                           VendLedgEntry.SETRANGE("Document Type",VendLedgEntry."Document Type"::Invoice);
                           VendLedgEntry.SETRANGE(Open,TRUE);
                           IF VendLedgEntry.FIND('-') THEN
                             REPEAT
                               VendLedgEntry.CALCFIELDS("Remaining Amt. (LCY)");
                               IF VendLedgEntry."Remaining Amt. (LCY)" <> 0 THEN BEGIN
                                 SettleCashAdvLine.RESET;
                                 SettleCashAdvLine.SETCURRENTKEY("Entry No.");
                                 SettleCashAdvLine.SETRANGE("Entry No.",VendLedgEntry."Entry No.");
                                 IF NOT SettleCashAdvLine.FINDFIRST THEN BEGIN
                                   LineNo += 10000;
                                   SettleCashAdvLine2.INIT;
                                   SettleCashAdvLine2."Settle Cash Advance No." := "No.";
                                   SettleCashAdvLine2."Line No." := LineNo;
                                   SettleCashAdvLine2."Cash Advance Vendor No." := VendLedgEntry."Vendor No.";
                                   SettleCashAdvLine2.VALIDATE("Entry No.",VendLedgEntry."Entry No.");
                                   SettleCashAdvLine2.INSERT;
                                 END;
                               END;
                             UNTIL VendLedgEntry.NEXT=0;
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=12000;
            SectionHeight=846;
          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      VendLedgEntry@1000000000 : Record 25;
      SettleCashAdvLine@1000000001 : Record 55057;
      SettleCashAdvLine2@1000000002 : Record 55057;
      LineNo@1000000003 : Integer;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.08.2006   KKE   -Cash Advance
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50097 Settle Cash Advance - Test
{
  OBJECT-PROPERTIES
  {
    Date=02/21/07;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55056;
        DataItemTableView=SORTING(No.);
        OnAfterGetRecord=BEGIN
                           SETFILTER("Date Filter",'..%1',"Posting Date");
                           CALCFIELDS("Balance Amount","Balance Settle");
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18900;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Settle Petty Cash - Test }
            { 1000000002;TextBox;15600;0    ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;423  ;7500 ;423  ;SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;18300;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;17550;423  ;750  ;423  ;ParentControl=1000000004 }
            { 1000000006;TextBox;16500;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=3384;
          }
          CONTROLS
          {
            { 1000000008;TextBox;3600 ;0    ;2250 ;423  ;HorzAlign=Left;
                                                         FontBold=Yes;
                                                         SourceExpr="No." }
            { 1000000009;Label  ;0    ;0    ;3450 ;423  ;ParentControl=1000000008 }
            { 1000000011;TextBox;3600 ;423  ;2250 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Cash Advance Vendor No." }
            { 1000000012;Label  ;0    ;423  ;3450 ;423  ;ParentControl=1000000011 }
            { 1000000014;TextBox;3600 ;846  ;5550 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Cash Advance Name" }
            { 1000000015;Label  ;0    ;846  ;3450 ;423  ;ParentControl=1000000014 }
            { 1000000017;TextBox;3600 ;1269 ;5550 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Payment Invoice Description" }
            { 1000000018;Label  ;0    ;1269 ;3450 ;423  ;ParentControl=1000000017 }
            { 1000000020;TextBox;3600 ;2115 ;300  ;423  ;HorzAlign=Left;
                                                         SourceExpr="Settle Account Type" }
            { 1000000021;Label  ;0    ;2115 ;3450 ;423  ;ParentControl=1000000020 }
            { 1000000023;TextBox;3600 ;2538 ;1500 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Settle Account No." }
            { 1000000024;Label  ;0    ;2538 ;3450 ;423  ;ParentControl=1000000023 }
            { 1000000026;TextBox;13350;0    ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Posting Date" }
            { 1000000027;Label  ;10200;0    ;3000 ;423  ;ParentControl=1000000026 }
            { 1000000029;TextBox;13350;423  ;1200 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Document Date" }
            { 1000000030;Label  ;10200;423  ;3000 ;423  ;ParentControl=1000000029 }
            { 1000000038;TextBox;13350;1269 ;1800 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Balance Settle" }
            { 1000000039;Label  ;10200;1269 ;3000 ;423  ;ParentControl=1000000038 }
          }
           }
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table55057;
        DataItemTableView=SORTING(Settle Cash Advance No.,Line No.);
        TotalFields=Amount Incl. VAT,Amount (LCY) Incl. VAT,WHT Amount (LCY);
        DataItemLink=Settle Cash Advance No.=FIELD(No.);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18900;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000007;Label  ;0    ;0    ;1050 ;846  ;ParentControl=1000000000;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000013;Label  ;1200 ;0    ;1200 ;846  ;ParentControl=1000000010;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000019;Label  ;2550 ;0    ;750  ;846  ;ParentControl=1000000016;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000025;Label  ;3450 ;0    ;2250 ;846  ;ParentControl=1000000022;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000031;Label  ;5850 ;0    ;4500 ;846  ;ParentControl=1000000028;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000037;Label  ;10500;0    ;1500 ;846  ;ParentControl=1000000034;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000041;Label  ;12150;0    ;2250 ;846  ;ParentControl=1000000040;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000043;Label  ;14550;0    ;2250 ;846  ;ParentControl=1000000042;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000045;Label  ;16950;0    ;1800 ;846  ;ParentControl=1000000044;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18900;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000000;TextBox;0    ;0    ;1050 ;423  ;SourceExpr="Entry No." }
            { 1000000010;TextBox;1200 ;0    ;1200 ;423  ;SourceExpr="Posting Date" }
            { 1000000016;TextBox;2550 ;0    ;750  ;423  ;SourceExpr="Document Type" }
            { 1000000022;TextBox;3450 ;0    ;2250 ;423  ;SourceExpr="Document No." }
            { 1000000028;TextBox;5850 ;0    ;4500 ;423  ;SourceExpr=Description }
            { 1000000034;TextBox;10500;0    ;1500 ;423  ;SourceExpr="Currency Code" }
            { 1000000040;TextBox;12150;0    ;2250 ;423  ;SourceExpr="Amount Incl. VAT" }
            { 1000000042;TextBox;14550;0    ;2250 ;423  ;SourceExpr="Amount (LCY) Incl. VAT" }
            { 1000000044;TextBox;16950;0    ;1800 ;423  ;SourceExpr="WHT Amount (LCY)" }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=18900;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000046;TextBox;16950;0    ;1800 ;423  ;FontBold=Yes;
                                                         SourceExpr="WHT Amount (LCY)" }
            { 1000000047;TextBox;14550;0    ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr="Amount (LCY) Incl. VAT" }
            { 1000000048;TextBox;12150;0    ;2250 ;423  ;FontBold=Yes;
                                                         SourceExpr="Amount Incl. VAT" }
            { 1000000035;Label  ;6450 ;0    ;1950 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Total }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      BalanceSettle@1000000000 : Decimal;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.08.2006   KKE   -Cash Advance
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50098 Check - Cash Advance
{
  OBJECT-PROPERTIES
  {
    Date=02/17/10;
    Time=[ 5:06:48 AM];
    Version List=AVATHA4.40,Burda1.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Check;
               THA=ตรวจสอบ];
    TopMargin=1600;
    BottomMargin=0;
    LeftMargin=5000;
    OnPreReport=BEGIN
                  InitTextVariable;
                  //KKE : #005 +
                  IF ChequeTo = ChequeTo::"Account Payee Only" THEN
                    xxx := 'XXX';
                  //KKE : #005 -
                END;

    Orientation=Landscape;
    PaperSize=Envelope DL 110 x 220mm;
    HorzGrid=100;
    VertGrid=50;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table55056;
        DataItemTableView=SORTING(No.);
        DataItemVarName=VoidSettleCashAdv;
        OnPreDataItem=BEGIN
                        IF CurrReport.PREVIEW THEN
                          ERROR(Text000);

                        //KKE : #002 +
                        IF ManualCheck THEN
                          CurrReport.BREAK;
                        //KKE : #002 -

                        IF UseCheckNo = '' THEN
                          ERROR(Text001);

                        IF TestPrint THEN
                          CurrReport.BREAK;

                        IF NOT ReprintChecks THEN
                          CurrReport.BREAK;
                      END;

        OnAfterGetRecord=BEGIN
                           CheckManagement.VoidCheckCashAdv(VoidSettleCashAdv);
                         END;

        ReqFilterFields=No.;
      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemTable=Table55056;
        DataItemTableView=SORTING(No.);
        DataItemVarName=SettleCashAdv;
        OnPreDataItem=BEGIN
                        SettleCashAdv.COPY(VoidSettleCashAdv);
                        CompanyInfo.GET;
                        IF NOT TestPrint THEN BEGIN
                          FormatAddr.Company(CompanyAddr,CompanyInfo);
                          BankAcc2.GET(BankAcc2."No.");
                          BankAcc2.TESTFIELD(Blocked,FALSE);
                          COPY(VoidSettleCashAdv);
                          //KKE : #002 +
                          IF ManualCheck THEN
                            SETRANGE("Bank Payment Type","Bank Payment Type"::"Manual Check")
                          ELSE BEGIN
                          //KKE : #002 -
                            SETRANGE("Bank Payment Type","Bank Payment Type"::"Computer Check");
                            SETRANGE("Cheque Printed",FALSE);
                          END;
                        END ELSE BEGIN
                          CLEAR(CompanyAddr);
                          FOR i := 1 TO 5 DO
                            CompanyAddr[i] := Text003;
                        END;
                        ChecksPrinted := 0;

                        SETRANGE("Settle Account Type",SettleCashAdv."Settle Account Type"::"Fixed Asset");
                        IF FIND('-') THEN
                          SettleCashAdv.FIELDERROR("Settle Account Type");
                        SETRANGE("Settle Account Type");
                      END;

        OnAfterGetRecord=BEGIN
                           TESTFIELD(Status,Status::Released);

                           IF (SettleCashAdv."Currency Code" <> '') AND
                              (SettleCashAdv."Currency Code" <> Currency.Code)
                           THEN BEGIN
                             Currency.GET(SettleCashAdv."Currency Code");
                             Currency.TESTFIELD("Conv. LCY Rndg. Debit Acc.");
                             Currency.TESTFIELD("Conv. LCY Rndg. Credit Acc.");
                           END;

                           CALCFIELDS("Balance Settle");
                           IF NOT TestPrint THEN BEGIN
                             IF "Balance Settle" = 0 THEN
                               CurrReport.SKIP;

                             TESTFIELD("Settle Account Type","Settle Account Type"::"Bank Account");
                             IF "Settle Account No." <> BankAcc2."No." THEN
                               CurrReport.SKIP;

                             IF "Settle Account No." <> '' THEN BEGIN
                               BalancingType := "Settle Account Type"::Vendor;
                               BalancingNo := "Cash Advance Vendor No.";
                               RemainingAmount := -"Balance Settle";
                               Vend.GET(BalancingNo);
                               IF Vend.Blocked IN [Vend.Blocked::All,Vend.Blocked::Payment] THEN
                                 ERROR(Text064,Vend.FIELDCAPTION(Blocked),Vend.Blocked,Vend.TABLECAPTION,Vend."No.");
                               IF BankAcc2."Currency Code" <> "Currency Code" THEN
                                 ERROR(Text005);
                               IF "Paid to Vendor Name" <> '' THEN
                                 VendorName := "Paid to Vendor Name"
                               ELSE
                                 IF Vend."Name (Thai)" <> '' THEN
                                   VendorName := Vend."Name (Thai)"
                                 ELSE
                                   VendorName := Vend.Name + Vend."Name 2";
                             END ELSE
                               FIELDERROR("Settle Account No.",Text004);

                             CheckDateText := FORMAT("Posting Date",0,4);
                           END ELSE BEGIN
                             IF ChecksPrinted > 0 THEN
                               CurrReport.BREAK;
                             BalancingType := BalancingType::Vendor;
                             BalancingNo := Text010;
                             CheckNoText := Text011;
                             CheckDateText := Text012;
                           END;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=1;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=CheckPages;
        OnPreDataItem=BEGIN
                        FirstPage := TRUE;
                        FoundLast := FALSE;
                        TotalLineAmount := 0;
                        TotalLineDiscount := 0;
                      END;

        OnAfterGetRecord=BEGIN
                           IF FoundLast THEN
                             CurrReport.BREAK;

                           UseCheckNo := INCSTR(UseCheckNo);
                           IF NOT TestPrint THEN
                             CheckNoText := UseCheckNo
                           ELSE
                             CheckNoText := Text011;
                           TotWHTAmount:=0;
                         END;

        OnPostDataItem=BEGIN
                         IF NOT TestPrint THEN BEGIN
                           IF UseCheckNo <> SettleCashAdv."Cheque No." THEN BEGIN
                             SettleCashAdv3.RESET;
                             SettleCashAdv3.SETRANGE("Cheque No.",UseCheckNo);
                             IF SettleCashAdv3.FIND('-') THEN
                               SettleCashAdv3.FIELDERROR("Cheque No.",STRSUBSTNO(Text013,UseCheckNo));
                           END;

                           SettleCashAdv3 := SettleCashAdv;
                           //SettleCashAdv3.TESTFIELD("No. Series",'');

                           SettleCashAdv3."Cheque No." := UseCheckNo;
                           SettleCashAdv3."Cheque Printed" := TRUE;
                           IF NOT ManualCheck THEN
                             SettleCashAdv3.MODIFY;
                         END;

                         IF NOT ManualCheck THEN BEGIN //KKE : #002
                           BankAcc2."Last Check No." := UseCheckNo;
                           BankAcc2.MODIFY;
                         END;

                         COMMIT;
                         CLEAR(CheckManagement);
                       END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        DataItemVarName=PrintSettledLoop;
        OnPreDataItem=BEGIN
                        IF NOT TestPrint THEN
                          FoundLast := TRUE
                        ELSE
                          FoundLast := FALSE;
                      END;

        OnAfterGetRecord=VAR
                           GenJnlLine1@1500000 : Record 81;
                         BEGIN
                           IF NOT TestPrint THEN BEGIN
                             IF RemainingAmount <> 0 THEN BEGIN
                               DocType := Text015;
                               DocNo := '';
                               ExtDocNo := '';
                               LineAmount := RemainingAmount;
                               LineAmount2 := RemainingAmount;
                               LineDiscount := 0;
                               RemainingAmount := 0;
                               LineWHT := 0;
                             END ELSE
                               CurrReport.BREAK;
                             TotalLineAmount := TotalLineAmount + LineAmount2;
                             TotalLineDiscount := TotalLineDiscount + LineDiscount;
                           END ELSE BEGIN
                             IF FoundLast THEN
                               CurrReport.BREAK;
                             FoundLast := TRUE;
                             DocType := Text018;
                             DocNo := Text010;
                             ExtDocNo := Text010;
                             LineAmount := 0;
                             LineDiscount := 0;
                           END;
                         END;

      }
      SECTIONS
      {
      }
       }
    { PROPERTIES
      {
        DataItemIndent=2;
        DataItemTable=Table2000000026;
        DataItemTableView=SORTING(Number);
        MaxIteration=1;
        DataItemVarName=PrintCheck;
        OnAfterGetRecord=BEGIN
                           IF NOT TestPrint THEN BEGIN
                             WITH SettleCashAdv DO BEGIN
                               CheckLedgEntry.INIT;
                               CheckLedgEntry."Bank Account No." := BankAcc2."No.";
                               CheckLedgEntry."Posting Date" := "Cheque Date";  //KKE : #005
                               CheckLedgEntry."Document Type" := CheckLedgEntry."Document Type"::Payment;
                               CheckLedgEntry."Document No." := UseCheckNo;
                               IF "Payment Invoice Description" <> '' THEN
                                 CheckLedgEntry.Description := "Payment Invoice Description"
                               ELSE
                                 CheckLedgEntry.Description := COPYSTR("Paid to Vendor Name",1,50);
                               CheckLedgEntry."Bank Payment Type" := "Bank Payment Type";
                               CheckLedgEntry."Bal. Account Type" := BalancingType;
                               CheckLedgEntry."Bal. Account No." := BalancingNo;
                               CheckLedgEntry."WHT Amount" := TotWHTAmount;
                               CheckLedgEntry."PDC Check No." := "Cheque No.";
                               CheckLedgEntry."Interest Amount" := InterestAmount;
                               IF FoundLast THEN BEGIN
                                 IF TotalLineAmount < 0 THEN
                                   ERROR(
                                     Text020,
                                     UseCheckNo,TotalLineAmount-TotWHTAmount);
                                 CheckLedgEntry."Entry Status" := CheckLedgEntry."Entry Status"::Printed;
                                 CheckLedgEntry.Amount := TotalLineAmount + TotWHTAmount; //KKE
                               END ELSE BEGIN
                                 CheckLedgEntry."Entry Status" := CheckLedgEntry."Entry Status"::Voided;
                                 CheckLedgEntry.Amount := 0;
                               END;
                               CheckLedgEntry."Check Date" := "Cheque Date";  //KKE : #005
                               CheckLedgEntry."Check No." := UseCheckNo;

                               IF NOT ManualCheck THEN  //KKE : #002
                                 CheckManagement.InsertCheck(CheckLedgEntry);

                               IF FoundLast THEN BEGIN
                                 CheckAmountText := FORMAT(CheckLedgEntry.Amount,0);
                                 i := STRPOS(CheckAmountText,'.');
                                 CASE TRUE OF
                                   i = 0:
                                     CheckAmountText := CheckAmountText + '.00';
                                   i = STRLEN(CheckAmountText) - 1:
                                     CheckAmountText := CheckAmountText + '0';
                                   i > STRLEN(CheckAmountText) - 2:
                                     CheckAmountText := COPYSTR(CheckAmountText,1,i + 2);
                                 END;
                                 //KKE : #008 +
                                 IF GLOBALLANGUAGE = 1054 THEN
                                   TextAmount := '**' + Form50BIS.FormatNoThaiText(CheckLedgEntry.Amount) + '**'
                                 ELSE BEGIN
                                 //KKE : #008 -
                                   FormatNoText(DescriptionLine,CheckLedgEntry.Amount,BankAcc2."Currency Code");
                                   TextAmount := '**' + DescriptionLine[1] + '**'; //KKE : #008
                                 END;
                                 //FormatNoText(DescriptionLine,CheckLedgEntry.Amount,BankAcc2."Currency Code");
                                 VoidText := '';
                               END ELSE BEGIN
                                 CLEAR(CheckAmountText);
                                 CLEAR(DescriptionLine);
                                 DescriptionLine[1] := Text021;
                                 DescriptionLine[2] := DescriptionLine[1];
                                 VoidText := Text022;
                               END;
                             END;
                           END ELSE BEGIN
                             WITH SettleCashAdv DO BEGIN
                               CheckLedgEntry.INIT;
                               CheckLedgEntry."Bank Account No." := BankAcc2."No.";
                               CheckLedgEntry."Posting Date" := "Cheque Date";  //KKE : #005
                               CheckLedgEntry."Document No." := UseCheckNo;
                               CheckLedgEntry.Description := Text023;
                               CheckLedgEntry."Bank Payment Type" := "Bank Payment Type"::"Computer Check";
                               CheckLedgEntry."Entry Status" := CheckLedgEntry."Entry Status"::"Test Print";
                               CheckLedgEntry."Check Date" := "Cheque Date";  //KKE : #005
                               CheckLedgEntry."Check No." := UseCheckNo;

                               IF NOT ManualCheck THEN  //KKE : #002
                                 CheckManagement.InsertCheck(CheckLedgEntry);

                               CheckAmountText := Text024;
                               DescriptionLine[1] := Text025;
                               DescriptionLine[2] := DescriptionLine[1];
                               VoidText := Text022;
                             END;
                           END;

                           ChecksPrinted := ChecksPrinted + 1;
                           FirstPage := FALSE;

                           //GKU:005+
                           DocDateText := FORMAT(SettleCashAdv."Cheque Date",0,'<Day,2><Month,2><Year4>');
                           DocDDMMYY[1] := COPYSTR(DocDateText,1,1);
                           DocDDMMYY[2] := COPYSTR(DocDateText,2,1);
                           DocDDMMYY[3] := COPYSTR(DocDateText,3,1);
                           DocDDMMYY[4] := COPYSTR(DocDateText,4,1);
                           DocDDMMYY[5] := COPYSTR(DocDateText,5,1);
                           DocDDMMYY[6] := COPYSTR(DocDateText,6,1);
                           DocDDMMYY[7] := COPYSTR(DocDateText,7,1);
                           DocDDMMYY[8] := COPYSTR(DocDateText,8,1);
                           //GKU:005-
                         END;

      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Bank of Ayudhya";
                         END;

          }
          CONTROLS
          {
            { 1000000000;TextBox;2700 ;1850 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000001;TextBox;10600;2750 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000002;TextBox;6600 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=SettleCashAdv."Cheque Date" }
            { 1000000003;TextBox;2700 ;1050 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000004;Label  ;2300 ;0    ;4300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Siam Commercial Bank }
            { 1000000007;TextBox;15500;1100 ;1300 ;550  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=Helvetica;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=xxx }
            { 1000000022;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000023;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000029;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000030;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000037;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000038;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000040;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000041;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Bangkok Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;2700 ;1900 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000009;TextBox;10600;2900 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000010;TextBox;6300 ;200  ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=SettleCashAdv."Cheque Date" }
            { 1000000011;TextBox;2700 ;1100 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000012;Label  ;2300 ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Bangkok Bank }
            { 1000000015;TextBox;15500;1150 ;1300 ;550  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=Helvetica;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=xxx }
            { 1000000042;TextBox;15800;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000043;TextBox;15200;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000044;TextBox;14600;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000045;TextBox;14000;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000046;TextBox;13400;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000047;TextBox;12800;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000048;TextBox;12200;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000049;TextBox;11600;150  ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Kasikorn Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000005;TextBox;2600 ;2250 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000006;TextBox;10900;3150 ;5700 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000013;TextBox;4900 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=FORMAT(SettleCashAdv."Cheque Date",0,'<Day,2>-<Month Text>-<Year4>') }
            { 1000000014;TextBox;2600 ;1500 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000016;Label  ;0    ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Kasikorn Bank }
            { 1000000050;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000051;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000052;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000053;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000054;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000055;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000056;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000057;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Thai Military Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000024;TextBox;3000 ;1900 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000025;TextBox;10900;2950 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000026;TextBox;6200 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=SettleCashAdv."Cheque Date" }
            { 1000000027;TextBox;3000 ;1100 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000028;Label  ;2300 ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Thai Military Bank }
            { 1000000031;TextBox;15800;1150 ;1300 ;550  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=Helvetica;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=xxx }
            { 1000000058;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000059;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000060;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000061;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000062;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000063;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000064;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000065;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Krung Thai Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000032;TextBox;3100 ;2050 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000033;TextBox;11000;2800 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000034;TextBox;6100 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=SettleCashAdv."Cheque Date" }
            { 1000000035;TextBox;3100 ;1250 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000036;Label  ;2300 ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Krung Thai Bank }
            { 1000000039;TextBox;15900;1250 ;1300 ;550  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=Helvetica;
                                                         FontSize=12;
                                                         FontBold=Yes;
                                                         SourceExpr=xxx }
            { 1000000066;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000067;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000068;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000069;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000070;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000071;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000072;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000073;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
        { PROPERTIES
          {
            SectionType=Footer;
            SectionWidth=20160;
            SectionHeight=6050;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := BankAcc2."Format Cheque" = BankAcc2."Format Cheque"::"Deutsche Bank";
                         END;

          }
          CONTROLS
          {
            { 1000000017;TextBox;1500 ;4250 ;12700;1250 ;Focusable=No;
                                                         HorzAlign=Left;
                                                         VertAlign=Top;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         SourceExpr=TextAmount }
            { 1000000018;TextBox;11000;3250 ;6100 ;650  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=19;
                                                         FontBold=Yes;
                                                         SourceExpr='=' + FORMAT(CheckLedgEntry.Amount,0,'<Precision,2:2><Standard Format,0>') + '=';
                                                         AutoFormatType=1 }
            { 1000000019;TextBox;4500 ;0    ;4200 ;500  ;Visible=No;
                                                         Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=FORMAT(SettleCashAdv."Cheque Date",0,'<Day,2>-<Month Text>-<Year4>') }
            { 1000000020;TextBox;1500 ;2400 ;12700;640  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         SourceExpr=VendorName }
            { 1000000021;Label  ;0    ;0    ;3300 ;650  ;Visible=No;
                                                         FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Deutsche Bank }
            { 1000000074;TextBox;15800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[8] }
            { 1000000075;TextBox;15200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[7] }
            { 1000000076;TextBox;14600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[6] }
            { 1000000077;TextBox;14000;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[5] }
            { 1000000078;TextBox;13400;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[4] }
            { 1000000079;TextBox;12800;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[3] }
            { 1000000080;TextBox;12200;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[2] }
            { 1000000081;TextBox;11600;0    ;400  ;500  ;Focusable=No;
                                                         HorzAlign=Left;
                                                         FontName=AngsanaUPC;
                                                         FontSize=14;
                                                         FontBold=Yes;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr=DocDDMMYY[1] }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=5610;
      Height=4400;
      SaveValues=Yes;
      OnOpenForm=BEGIN
                   //KKE : #002 +
                   ManualCheck := FALSE;
                   RequestOptionsForm."Last Check No.".EDITABLE := NOT ManualCheck;
                   //KKE : #002 -

                   IF BankAcc2."No." <> '' THEN BEGIN
                     IF BankAcc2.GET(BankAcc2."No.") THEN BEGIN
                       IF NOT ManualCheck THEN  //KKE : #002
                         UseCheckNo := BankAcc2."Last Check No."
                     END ELSE BEGIN
                       BankAcc2."No." := '';
                       UseCheckNo := '';
                     END;
                   END;

                   ChequeTo := ChequeTo::"Account Payee Only";  //KKE : #005
                 END;

    }
    CONTROLS
    {
      { 1   ;TextBox      ;3410 ;660  ;2200 ;440  ;CaptionML=[ENU=Bank Account;
                                                              THA=บัญชีธนาคาร];
                                                   SourceExpr=BankAcc2."No.";
                                                   TableRelation="Bank Account";
                                                   OnValidate=BEGIN
                                                                IF BankAcc2."No." <> '' THEN BEGIN
                                                                  BankAcc2.GET(BankAcc2."No.");
                                                                  BankAcc2.TESTFIELD("Last Check No.");
                                                                  UseCheckNo := BankAcc2."Last Check No.";
                                                                END;
                                                              END;
                                                               }
      { 2   ;Label        ;0    ;660  ;3300 ;440  ;ParentControl=1 }
      { 3   ;TextBox      ;3410 ;1320 ;2200 ;440  ;Name=Last Check No.;
                                                   CaptionML=[ENU=Last Check No.;
                                                              THA=หมายเลขเช็คหลังสุด];
                                                   SourceExpr=UseCheckNo }
      { 4   ;Label        ;0    ;1320 ;3300 ;440  ;ParentControl=3 }
      { 5   ;CheckBox     ;3410 ;1980 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Reprint Checks;
                                                              THA=พิมพ์เช็คอีกครั้ง];
                                                   SourceExpr=ReprintChecks }
      { 6   ;Label        ;0    ;1980 ;3300 ;440  ;ParentControl=5 }
      { 9   ;CheckBox     ;3410 ;2530 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Test Print;
                                                              THA=ทดสอบพิมพ์];
                                                   SourceExpr=TestPrint }
      { 10  ;Label        ;0    ;2530 ;3300 ;440  ;ParentControl=9 }
      { 13  ;CheckBox     ;3410 ;3080 ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=[ENU=Preprinted Stub;
                                                              THA=ส่วนย่อยที่พิมพ์ก่อน];
                                                   SourceExpr=PreprintedStub }
      { 14  ;Label        ;0    ;3080 ;3300 ;440  ;ParentControl=13 }
      { 1000000000;CheckBox;3410;0    ;440  ;440  ;ShowCaption=No;
                                                   CaptionML=ENU=Manual Check;
                                                   SourceExpr=ManualCheck;
                                                   OnAfterValidate=BEGIN
                                                                     //KKE : #002 +
                                                                     RequestOptionsForm."Last Check No.".EDITABLE := NOT ManualCheck;
                                                                     IF BankAcc2."No." <> '' THEN BEGIN
                                                                       BankAcc2.GET(BankAcc2."No.");
                                                                       IF NOT ManualCheck THEN BEGIN //#3
                                                                         BankAcc2.TESTFIELD("Last Check No.");
                                                                         UseCheckNo := BankAcc2."Last Check No.";
                                                                       END;
                                                                     END;
                                                                     //KKE : #002
                                                                   END;
                                                                    }
      { 1000000001;Label  ;0    ;0    ;3300 ;440  ;ParentControl=1000000000 }
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Preview is not allowed.;THA=ไม่สามารถดูภาพก่อนพิมพ์ได้';
      Text001@1001 : TextConst 'ENU=Last Check No. must be filled in.;THA=ต้องเติมหมายเลขเช็คหลังสุดด้วย';
      Text002@1002 : TextConst 'ENU=Filters on %1 and %2 are not allowed.;THA=ไม่สามารถใช้ตัวกรองบน %1 และ %2';
      Text003@1003 : TextConst 'ENU=XXXXXXXXXXXXXXXX;THA=XXXXXXXXXXXXXXXX';
      Text004@1004 : TextConst 'ENU=must be entered.;THA=ต้องใส่ข้อมูล';
      Text005@1005 : TextConst 'ENU=The Bank Account and the General Journal Line must have the same currency.;THA=บรรทัดบัญชีธนาคารและสมุดรายวันทั่วไปต้องมีสกุลเงินเหมือนกัน';
      Text006@1006 : TextConst 'ENU=Salesperson;THA=พนักงานขาย';
      Text007@1007 : TextConst 'ENU=Purchaser;THA=ผู้ซื้อ';
      Text008@1008 : TextConst 'ENU=Both Bank Accounts must have the same currency.;THA=บัญชีธนาคารทั้งสองบัญชีต้องมีสกุลเงินเหมือนกัน';
      Text009@1009 : TextConst 'ENU=Our Contact;THA=ผู้ติดต่อของบริษัท';
      Text010@1010 : TextConst 'ENU=XXXXXXXXXX;THA=XXXXXXXXXX';
      Text011@1011 : TextConst 'ENU=XXXX;THA=XXXX';
      Text012@1012 : TextConst 'ENU=XX.XXXXXXXXXX.XXXX;THA=XX.XXXXXXXXXX.XXXX';
      Text013@1013 : TextConst 'ENU=%1 already exists.;THA=มี %1 อยู่แล้ว';
      Text014@1014 : TextConst 'ENU=Check for %1 %2;THA=เช็คสำหรับ %1 %2';
      Text015@1015 : TextConst 'ENU=Payment;THA=การชำระเงิน';
      Text016@1016 : TextConst 'ENU=In the Check report, One Check per Vendor and Document No.\;THA=ในรายงานเช็ค, เช็คหนึ่งฉบับต่อผู้ขายและหมายเลขเอกสาร\';
      Text017@1017 : TextConst 'ENU=must not be activated when Applies-to ID is specified in the journal lines.;THA=ต้องไม่ทำงานเมื่อมีการระบุ ID การใช้ในบรรทัดสมุดรายวัน';
      Text018@1018 : TextConst 'ENU=XXX;THA=XXX';
      Text019@1019 : TextConst 'ENU=Total;THA=ยอดรวม';
      Text020@1020 : TextConst 'ENU=The total amount of check %1 is %2. The amount must be positive.;THA=เช็ค %1 มีจำนวนเงินรวมเป็น %2  จำนวนเงินต้องเป็นค่าบวก';
      Text021@1021 : TextConst 'ENU=VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID;THA=VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID VOID';
      Text022@1022 : TextConst 'ENU=NON-NEGOTIABLE;THA=เจรจาไม่ได้';
      Text023@1023 : TextConst 'ENU=Test print;THA=ทดสอบพิมพ์';
      Text024@1024 : TextConst 'ENU=XXXX.XX;THA=XXXX.XX';
      Text025@1025 : TextConst 'ENU=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX;THA=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX';
      Text026@1026 : TextConst 'ENU=Zero;THA=ศูนย์';
      Text027@1027 : TextConst 'ENU=Hundred;THA=ร้อย';
      Text028@1028 : TextConst 'ENU=And;THA=และ';
      Text029@1029 : TextConst 'ENU=%1 results in a written number that is too long.;THA=%1 เขียนเป็นตัวอักษรแล้วยาวเกินไป';
      Text030@1030 : TextConst 'ENU=" is already applied to %1 %2 for customer %3.";THA=" ได้ใช้กับ %1 %2 สำหรับลูกค้า %3 แล้ว"';
      Text031@1031 : TextConst 'ENU=" is already applied to %1 %2 for vendor %3.";THA=" ได้ใช้กับ %1 %2 สำหรับผู้ขาย %3 แล้ว"';
      Text032@1032 : TextConst 'ENU=One;THA=หนึ่ง';
      Text033@1033 : TextConst 'ENU=Two;THA=สอง';
      Text034@1034 : TextConst 'ENU=Three;THA=สาม';
      Text035@1035 : TextConst 'ENU=Four;THA=สี่';
      Text036@1036 : TextConst 'ENU=Five;THA=ห้า';
      Text037@1037 : TextConst 'ENU=Six;THA=หก';
      Text038@1038 : TextConst 'ENU=Seven;THA=เจ็ด';
      Text039@1039 : TextConst 'ENU=Eight;THA=แปด';
      Text040@1040 : TextConst 'ENU=Nine;THA=เก้า';
      Text041@1041 : TextConst 'ENU=Ten;THA=สิบ';
      Text042@1042 : TextConst 'ENU=Eleven;THA=สิบเอ็ด';
      Text043@1043 : TextConst 'ENU=Twelve;THA=สิบสอง';
      Text044@1044 : TextConst 'ENU=Thirteen;THA=สิบสาม';
      Text045@1045 : TextConst 'ENU=Fourteen;THA=สิบสี่';
      Text046@1046 : TextConst 'ENU=Fifteen;THA=สิบห้า';
      Text047@1047 : TextConst 'ENU=Sixteen;THA=สิบหก';
      Text048@1048 : TextConst 'ENU=Seventeen;THA=สิบเจ็ด';
      Text049@1049 : TextConst 'ENU=Eighteen;THA=สิบแปด';
      Text050@1050 : TextConst 'ENU=Nineteen;THA=สิบเก้า';
      Text051@1051 : TextConst 'ENU=Twenty;THA=ยี่สิบ';
      Text052@1052 : TextConst 'ENU=Thirty;THA=สามสิบ';
      Text053@1053 : TextConst 'ENU=Forty;THA=FORTY';
      Text054@1054 : TextConst 'ENU=Fifty;THA=ห้าสิบ';
      Text055@1055 : TextConst 'ENU=Sixty;THA=หกสิบ';
      Text056@1056 : TextConst 'ENU=Seventy;THA=เจ็ดสิบ';
      Text057@1057 : TextConst 'ENU=Eighty;THA=แปดสิบ';
      Text058@1058 : TextConst 'ENU=Ninety;THA=เก้าสิบ';
      Text059@1059 : TextConst 'ENU=Thousand;THA=พัน';
      Text060@1060 : TextConst 'ENU=Million;THA=ล้าน';
      Text061@1061 : TextConst 'ENU=Billion;THA=พันล้าน';
      CompanyInfo@1062 : Record 79;
      CompanyInfo1@1000000009 : Record 79;
      GenJnlLine2@1064 : Record 81;
      SettleCashAdv3@1065 : Record 55056;
      Cust@1066 : Record 18;
      CustLedgEntry@1067 : Record 21;
      Vend@1068 : Record 23;
      VendLedgEntry@1069 : Record 25;
      BankAcc@1070 : Record 270;
      BankAcc2@1071 : Record 270;
      CheckLedgEntry@1072 : Record 272;
      Currency@1073 : Record 4;
      FormatAddr@1074 : Codeunit 365;
      CheckManagement@1075 : Codeunit 367;
      CompanyAddr@1076 : ARRAY [8] OF Text[50];
      OnesText@1078 : ARRAY [20] OF Text[30];
      TensText@1079 : ARRAY [10] OF Text[30];
      ExponentText@1080 : ARRAY [5] OF Text[30];
      BalancingType@1081 : 'G/L Account,Customer,Vendor,Bank Account';
      BalancingNo@1082 : Code[20];
      CheckNoText@1084 : Text[30];
      CheckDateText@1085 : Text[30];
      CheckAmountText@1086 : Text[30];
      DescriptionLine@1087 : ARRAY [2] OF Text[80];
      DocType@1088 : Text[30];
      DocNo@1089 : Text[30];
      ExtDocNo@1119 : Text[30];
      VoidText@1090 : Text[30];
      LineAmount@1091 : Decimal;
      LineDiscount@1092 : Decimal;
      TotalLineAmount@1093 : Decimal;
      TotalLineDiscount@1094 : Decimal;
      RemainingAmount@1095 : Decimal;
      CurrentLineAmount@1096 : Decimal;
      UseCheckNo@1097 : Code[20];
      FoundLast@1098 : Boolean;
      ReprintChecks@1099 : Boolean;
      TestPrint@1100 : Boolean;
      FirstPage@1101 : Boolean;
      OneCheckPrVendor@1102 : Boolean;
      FoundNegative@1103 : Boolean;
      ApplyMethod@1104 : 'Payment,OneLineOneEntry,OneLineID,MoreLinesOneEntry';
      ChecksPrinted@1105 : Integer;
      PreprintedStub@1107 : Boolean;
      TotalText@1108 : Text[10];
      DocDate@1109 : Date;
      i@1110 : Integer;
      Text062@1111 : TextConst 'ENU=G/L Account,Customer,Vendor,Bank Account;THA=บัญชี G/L,ลูกค้า,ผู้ขาย,บัญชีธนาคาร';
      CurrencyCode2@1112 : Code[10];
      NetAmount@1114 : Text[30];
      CurrencyExchangeRate@1115 : Record 330;
      LineAmount2@1116 : Decimal;
      Text063@1117 : TextConst 'ENU=Net Amount %1;THA=จำนวนสุทธิ %1';
      GLSetup@1118 : Record 98;
      Text064@1113 : TextConst 'ENU=%1 must not be %2 for %3 %4.;THA=%1 ต้องไม่เป็น %2 สำหรับ %3 %4';
      WHTSkip@1500005 : Boolean;
      InterestAmountLCY@1500004 : Decimal;
      InterestAmount@1500003 : Decimal;
      LineWHT@1500002 : Decimal;
      TotWHTAmount@1500001 : Decimal;
      WHTManagement@1500000 : Codeunit 28040;
      VendorName@1000000002 : Text[150];
      ManualCheck@1000000001 : Boolean;
      xGenJnlLine2@1000000000 : Record 81;
      UserSetup@1000000007 : Record 91;
      Form50BIS@1000000004 : Report 50002;
      TextAmount@1000000003 : Text[250];
      ChequeTo@1000000006 : 'Account Payee Only,&CO';
      xxx@1000000005 : Text[30];
      Text50000@1000000008 : TextConst 'ENU=You do not have permission to change cheque to.;THA=คุณไม่ได้รับสิทธิในการเปลี่ยนแปลง &CO ได้';
      DocDateText@1000000011 : Text[30];
      DocDDMMYY@1000000010 : ARRAY [8] OF Text[30];

    PROCEDURE FormatNoText@1(VAR NoText@1000 : ARRAY [2] OF Text[80];No@1001 : Decimal;CurrencyCode@1002 : Code[10]);
    VAR
      PrintExponent@1003 : Boolean;
      Ones@1004 : Integer;
      Tens@1005 : Integer;
      Hundreds@1006 : Integer;
      Exponent@1007 : Integer;
      NoTextIndex@1008 : Integer;
    BEGIN
      CLEAR(NoText);
      NoTextIndex := 1;
      //NoText[1] := '****';
      //KKE : #001 +
      //IF CurrencyCode = '' THEN
      //  NoText[1] := 'Baht'
      //ELSE
        NoText[1] := '';
      //KKE : #001 -

      IF No < 1 THEN
        AddToNoText(NoText,NoTextIndex,PrintExponent,Text026)
      ELSE BEGIN
        FOR Exponent := 4 DOWNTO 1 DO BEGIN
          PrintExponent := FALSE;
          Ones := No DIV POWER(1000,Exponent - 1);
          Hundreds := Ones DIV 100;
          Tens := (Ones MOD 100) DIV 10;
          Ones := Ones MOD 10;
          IF Hundreds > 0 THEN BEGIN
            AddToNoText(NoText,NoTextIndex,PrintExponent,OnesText[Hundreds]);
            AddToNoText(NoText,NoTextIndex,PrintExponent,Text027);
          END;
          IF Tens >= 2 THEN BEGIN
            AddToNoText(NoText,NoTextIndex,PrintExponent,TensText[Tens]);
            IF Ones > 0 THEN
              AddToNoText(NoText,NoTextIndex,PrintExponent,OnesText[Ones]);
          END ELSE
            IF (Tens * 10 + Ones) > 0 THEN
              AddToNoText(NoText,NoTextIndex,PrintExponent,OnesText[Tens * 10 + Ones]);
          IF PrintExponent AND (Exponent > 1) THEN
            AddToNoText(NoText,NoTextIndex,PrintExponent,ExponentText[Exponent]);
          No := No - (Hundreds * 100 + Tens * 10 + Ones) * POWER(1000,Exponent - 1);
        END;
      END;

      //AddToNoText(NoText,NoTextIndex,PrintExponent,Text028);
      //AddToNoText(NoText,NoTextIndex,PrintExponent,FORMAT(No * 100) + '/100');

      //KKE : #001 +
      IF No * 100 <= 0 THEN BEGIN
        IF CurrencyCode = '' THEN
          AddToNoText(NoText,NoTextIndex,PrintExponent,'Baht Only')
        ELSE
          AddToNoText(NoText,NoTextIndex,PrintExponent,'Only');
      END ELSE BEGIN
        AddToNoText(NoText,NoTextIndex,PrintExponent,Text028);
        AddToNoText(NoText,NoTextIndex,PrintExponent,FORMAT(ROUND(No * 100,1)) + '/100');
      END;
      //KKE : #001 -

      IF CurrencyCode <> '' THEN
        AddToNoText(NoText,NoTextIndex,PrintExponent,CurrencyCode);
    END;

    LOCAL PROCEDURE AddToNoText@2(VAR NoText@1000 : ARRAY [2] OF Text[80];VAR NoTextIndex@1001 : Integer;VAR PrintExponent@1002 : Boolean;AddText@1003 : Text[30]);
    BEGIN
      PrintExponent := TRUE;

      WHILE STRLEN(NoText[NoTextIndex] + ' ' + AddText) > MAXSTRLEN(NoText[1]) DO BEGIN
        NoTextIndex := NoTextIndex + 1;
        IF NoTextIndex > ARRAYLEN(NoText) THEN
          ERROR(Text029,AddText);
      END;

      NoText[NoTextIndex] := DELCHR(NoText[NoTextIndex] + ' ' + AddText,'<');
    END;

    PROCEDURE InitTextVariable@5();
    BEGIN
      OnesText[1] := Text032;
      OnesText[2] := Text033;
      OnesText[3] := Text034;
      OnesText[4] := Text035;
      OnesText[5] := Text036;
      OnesText[6] := Text037;
      OnesText[7] := Text038;
      OnesText[8] := Text039;
      OnesText[9] := Text040;
      OnesText[10] := Text041;
      OnesText[11] := Text042;
      OnesText[12] := Text043;
      OnesText[13] := Text044;
      OnesText[14] := Text045;
      OnesText[15] := Text046;
      OnesText[16] := Text047;
      OnesText[17] := Text048;
      OnesText[18] := Text049;
      OnesText[19] := Text050;

      TensText[1] := '';
      TensText[2] := Text051;
      TensText[3] := Text052;
      TensText[4] := Text053;
      TensText[5] := Text054;
      TensText[6] := Text055;
      TensText[7] := Text056;
      TensText[8] := Text057;
      TensText[9] := Text058;

      ExponentText[1] := '';
      ExponentText[2] := Text059;
      ExponentText[3] := Text060;
      ExponentText[4] := Text061;
    END;

    PROCEDURE InitializeRequest@6(BankAcc@1000 : Code[20];LastCheckNo@1001 : Code[20];NewOneCheckPrVend@1002 : Boolean;NewReprintChecks@1003 : Boolean;NewTestPrint@1004 : Boolean;NewPreprintedStub@1005 : Boolean);
    BEGIN
      IF BankAcc <> '' THEN
        IF BankAcc2.GET(BankAcc) THEN BEGIN
          UseCheckNo := LastCheckNo;
          OneCheckPrVendor := NewOneCheckPrVend;
          ReprintChecks := NewReprintChecks;
          TestPrint := NewTestPrint;
          PreprintedStub := NewPreprintedStub;
        END;
    END;

    PROCEDURE ExchangeAmt@7(PostingDate@1000 : Date;CurrencyCode@1001 : Code[10];CurrencyCode2@1003 : Code[10];Amount@1002 : Decimal) Amount2 : Decimal;
    BEGIN
      IF (CurrencyCode <> '')  AND (CurrencyCode2 = '') THEN
         Amount2 :=
           CurrencyExchangeRate.ExchangeAmtLCYToFCY(
             PostingDate,CurrencyCode,Amount,CurrencyExchangeRate.ExchangeRate(PostingDate,CurrencyCode))
      ELSE IF (CurrencyCode = '') AND (CurrencyCode2 <> '') THEN
        Amount2 :=
          CurrencyExchangeRate.ExchangeAmtFCYToLCY(
            PostingDate,CurrencyCode2,Amount,CurrencyExchangeRate.ExchangeRate(PostingDate,CurrencyCode2))
      ELSE IF (CurrencyCode <> '') AND (CurrencyCode2 <> '') AND (CurrencyCode <> CurrencyCode2) THEN
        Amount2 := CurrencyExchangeRate.ExchangeAmtFCYToFCY(PostingDate,CurrencyCode2,CurrencyCode,Amount)
      ELSE
        Amount2 := Amount;
    END;

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   11.04.2005   KKE   -Fixed and update WHT.
                               -Correct One Check per Vendor per Document No.
                               -After cheque is printed, document no. field will be replaced by cheque no., system has to move
                                then previously assigned document no. info external document no.
                               -Rounding Satang in amount in word into 2 digit.
      002   11.04.2005   KKE   -If Manual check, system must not replaced document no. by cheque no.
      003   15.02.2006   KKE   -Paper size 9cmX18cm
      004   23.08.2006   KKE   -Cash Advance
      005   16.02.2010   GKU   -Split "Document Date"
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50099 Cash Advance Detail
{
  OBJECT-PROPERTIES
  {
    Date=02/21/07;
    Time=[ 6:00:00 PM];
    Version List=AVATHA4.40;
  }
  PROPERTIES
  {
    TopMargin=1500;
    BottomMargin=1000;
    LeftMargin=1000;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table25;
        DataItemTableView=SORTING(Vendor No.,Posting Date,Currency Code);
        NewPagePerGroup=Yes;
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("Vendor No.");

                        SourceCodeSetup.GET;
                        SourceCodeSetup.TESTFIELD("Cash Advance");

                        SETFILTER("Source Code",SourceCodeSetup."Cash Advance");
                      END;

        ReqFilterFields=Vendor No.,Posting Date;
        TotalFields=Amount (LCY),WHT Amount (LCY);
        GroupTotalFields=Vendor No.;
        CalcFields=Amount (LCY),WHT Amount (LCY);
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;Label  ;0    ;0    ;7500 ;423  ;FontSize=9;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Cash Advance Detail }
            { 1000000002;TextBox;16050;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000003;TextBox;0    ;423  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000004;TextBox;18450;423  ;750  ;423  ;FontSize=8;
                                                         CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000005;Label  ;17700;423  ;750  ;423  ;ParentControl=1000000004;
                                                         FontSize=8 }
            { 1000000006;TextBox;16950;846  ;2250 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=19350;
            SectionHeight=1269;
          }
          CONTROLS
          {
            { 1000000012;Label  ;150  ;0    ;1500 ;846  ;ParentControl=1000000011;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000015;Label  ;2400 ;0    ;2400 ;846  ;ParentControl=1000000014;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000018;Label  ;4950 ;0    ;5250 ;846  ;ParentControl=1000000017;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000021;Label  ;10350;0    ;2400 ;846  ;ParentControl=1000000020;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000024;Label  ;12900;0    ;2100 ;846  ;ParentControl=1000000023;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000027;Label  ;17400;0    ;1800 ;846  ;ParentControl=1000000026;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000007;Label  ;15150;0    ;2100 ;846  ;ParentControl=1000000000;
                                                         HorzAlign=Right;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
            { 1000000016;Label  ;1800 ;0    ;450  ;846  ;ParentControl=1000000010;
                                                         VertAlign=Bottom;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         MultiLine=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT := FooterPrinted;
                           FooterPrinted := FALSE;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Vendor Ledger Entry".FIELDNO("Vendor No.");
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;3150 ;0    ;2400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Vendor No." }
            { 1000000009;Label  ;0    ;0    ;3000 ;423  ;ParentControl=1000000008;
                                                         FontSize=8;
                                                         FontBold=Yes }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = LastFieldNo;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=19350;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000011;TextBox;150  ;0    ;1500 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Posting Date" }
            { 1000000014;TextBox;2400 ;0    ;2400 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Document No." }
            { 1000000017;TextBox;4950 ;0    ;5250 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr=Description }
            { 1000000020;TextBox;10350;0    ;2400 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         CaptionML=ENU=Amount (LCY) incl. VAT;
                                                         SourceExpr="Amount (LCY)" - "WHT Amount (LCY)" }
            { 1000000023;TextBox;12900;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr="WHT Amount (LCY)" }
            { 1000000026;TextBox;17400;0    ;1800 ;423  ;HorzAlign=Left;
                                                         FontSize=8;
                                                         SourceExpr="Global Dimension 1 Code" }
            { 1000000000;TextBox;15150;0    ;2100 ;423  ;FontSize=8;
                                                         CaptionML=ENU=Amount after WHT;
                                                         SourceExpr="Amount (LCY)" }
            { 1000000010;TextBox;1800 ;0    ;450  ;423  ;FontSize=8;
                                                         SourceExpr="Document Type" }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=423;
            OnPreSection=BEGIN
                           IF NOT FooterPrinted THEN
                             LastFieldNo := CurrReport.TOTALSCAUSEDBY;
                           CurrReport.SHOWOUTPUT := NOT FooterPrinted;
                           FooterPrinted := TRUE;
                         END;

          }
          CONTROLS
          {
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=19350;
            SectionHeight=846;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = "Vendor Ledger Entry".FIELDNO("Vendor No.");
                         END;

          }
          CONTROLS
          {
            { 1000000028;TextBox;0    ;0    ;9000 ;423  ;FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr=TotalFor + FIELDCAPTION("Vendor No.") }
            { 1000000029;TextBox;10050;0    ;2700 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Amount (LCY)" - "WHT Amount (LCY)" }
            { 1000000030;TextBox;12900;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="WHT Amount (LCY)" }
            { 1000000013;TextBox;15150;0    ;2100 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         FontBold=Yes;
                                                         SourceExpr="Amount (LCY)" }
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SourceCodeSetup@1000000003 : Record 242;
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      TotalFor@1000000002 : TextConst 'ENU="Total for "';

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Localization TH
      KKE : Kanoknard Ketnut

      No.   Date         Sign  Description
      ----------------------------------------
      001   30.08.2006   KKE   -Cash Advance
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 50100 Complaint
{
  OBJECT-PROPERTIES
  {
    Date=07/02/08;
    Time=[ 5:16:16 PM];
    Version List=;
  }
  PROPERTIES
  {
    HorzGrid=30;
    VertGrid=30;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50057;
        DataItemTableView=SORTING(Complaint Date,Complaint No.);
        OnPreDataItem=BEGIN
                        LastFieldNo := FIELDNO("Complaint Date");
                        ComplaintFilter := Complaint.GETFILTER("Complaint Date");
                      END;

        OnAfterGetRecord=BEGIN
                           IF (ComDate = 0D) OR (ComDate <> Complaint."Complaint Date") THEN BEGIN
                             Cnt := 0;
                             ComDate := Complaint."Complaint Date";
                           END;
                           Cnt += 1;
                         END;

        ReqFilterFields=Complaint Date;
        GroupTotalFields=Complaint Date;
      }
      SECTIONS
      {
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=1692;
          }
          CONTROLS
          {
            { 1000000001;TextBox;0    ;846  ;7500 ;423  ;FontSize=8;
                                                         SourceExpr=COMPANYNAME }
            { 1000000002;Label  ;0    ;0    ;7500 ;846  ;FontSize=10;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Complaint Report }
            { 1000000003;TextBox;15000;1269 ;3150 ;423  ;HorzAlign=Right;
                                                         SourceExpr=STRSUBSTNO('Report ID: %1',REPORT::Complaint) }
            { 1000000004;TextBox;15000;0    ;3150 ;423  ;HorzAlign=Right;
                                                         FontSize=8;
                                                         SourceExpr=FORMAT(TODAY,0,4) }
            { 1000000005;TextBox;17700;423  ;450  ;423  ;CaptionML=ENU=Page;
                                                         SourceExpr=CurrReport.PAGENO }
            { 1000000006;Label  ;16950;423  ;750  ;423  ;ParentControl=1000000005 }
            { 1000000025;TextBox;15900;846  ;2250 ;423  ;HorzAlign=Right;
                                                         SourceExpr=USERID }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            PrintOnEveryPage=Yes;
            SectionWidth=18150;
            SectionHeight=423;
          }
          CONTROLS
          {
            { 1000000046;TextBox;0    ;0    ;18150;423  ;SourceExpr='Complaint Date : ' + ComplaintFilter }
          }
           }
        { PROPERTIES
          {
            SectionType=Header;
            SectionWidth=18150;
            SectionHeight=2115;
          }
          CONTROLS
          {
            { 1000000028;Label  ;4200 ;423  ;2700 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Subscriber No. }
            { 1000000031;Label  ;1350 ;423  ;2700 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Document No. }
            { 1000000034;Label  ;7050 ;423  ;6900 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Name }
            { 1000000037;Label  ;14100;423  ;4050 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Tel. No. }
            { 1000000038;Label  ;5250 ;846  ;2700 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=End Time }
            { 1000000039;Label  ;8100 ;846  ;3600 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Duration (Min.) }
            { 1000000040;Label  ;11850;846  ;5100 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Received by }
            { 1000000041;Label  ;2400 ;846  ;2700 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Start Time }
            { 1000000042;Label  ;3450 ;1269 ;2700 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=Description }
            { 1000000043;Label  ;120  ;423  ;1080 ;423  ;VertAlign=Bottom;
                                                         FontBold=Yes;
                                                         MultiLine=Yes;
                                                         CaptionML=ENU=No. }
            { 1000000044;Shape  ;0    ;0    ;18150;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
            { 1000000045;Shape  ;0    ;1692 ;18150;423  ;BorderWidth=1pt;
                                                         ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupHeader;
            SectionWidth=18150;
            SectionHeight=603;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT :=
                             CurrReport.TOTALSCAUSEDBY = Complaint.FIELDNO("Complaint Date");
                         END;

          }
          CONTROLS
          {
            { 1000000008;TextBox;2400 ;180  ;4800 ;423  ;HorzAlign=Left;
                                                         FontSize=7;
                                                         SourceExpr="Complaint Date" }
            { 1000000009;Label  ;0    ;180  ;2370 ;423  ;ParentControl=1000000008;
                                                         FontSize=7;
                                                         FontBold=Yes;
                                                         CaptionML=ENU=Complaint Date }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=846;
          }
          CONTROLS
          {
            { 1000000047;TextBox;4200 ;0    ;2700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Subscriber No." }
            { 1000000048;TextBox;1350 ;0    ;2700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Complaint No." }
            { 1000000049;TextBox;7050 ;0    ;6900 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Subscriber Name" }
            { 1000000050;TextBox;14100;0    ;4050 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Phone No." }
            { 1000000051;TextBox;2400 ;423  ;2700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Start Time" }
            { 1000000052;TextBox;5250 ;423  ;2700 ;423  ;HorzAlign=Left;
                                                         SourceExpr="End Time" }
            { 1000000053;TextBox;8100 ;423  ;3600 ;423  ;HorzAlign=Left;
                                                         DecimalPlaces=0:0;
                                                         SourceExpr="Usage Time" }
            { 1000000054;TextBox;11850;423  ;5100 ;423  ;HorzAlign=Left;
                                                         SourceExpr="Last Update by" }
            { 1000000056;TextBox;120  ;0    ;1080 ;423  ;HorzAlign=Left;
                                                         SourceExpr=Cnt }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Complaint."Message-1" <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000010;TextBox;3450 ;0    ;8280 ;423  ;HorzAlign=Left;
                                                         FontSize=7;
                                                         SourceExpr="Message-1" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Complaint."Message-2" <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000013;TextBox;3450 ;0    ;8280 ;423  ;HorzAlign=Left;
                                                         FontSize=7;
                                                         SourceExpr="Message-2" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=423;
            OnPreSection=BEGIN
                           CurrReport.SHOWOUTPUT(Complaint."Message-3" <> '');
                         END;

          }
          CONTROLS
          {
            { 1000000016;TextBox;3450 ;0    ;8280 ;423  ;HorzAlign=Left;
                                                         FontSize=7;
                                                         SourceExpr="Message-3" }
          }
           }
        { PROPERTIES
          {
            SectionType=Body;
            SectionWidth=18150;
            SectionHeight=30;
          }
          CONTROLS
          {
            { 1000000058;Shape  ;0    ;0    ;18090;30   ;ShapeStyle=HorzLine }
          }
           }
        { PROPERTIES
          {
            SectionType=GroupFooter;
            SectionWidth=18150;
            SectionHeight=240;
            OnPreSection=BEGIN
                           IF NOT FooterPrinted THEN
                             LastFieldNo := CurrReport.TOTALSCAUSEDBY;
                           CurrReport.SHOWOUTPUT := NOT FooterPrinted;
                           FooterPrinted := TRUE;
                         END;

          }
          CONTROLS
          {
          }
           }
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Cnt@1000000002 : Integer;
      LastFieldNo@1000000000 : Integer;
      FooterPrinted@1000000001 : Boolean;
      ComDate@1000000003 : Date;
      ComplaintFilter@1000000004 : Text[255];

    BEGIN
    {
      Microsoft Business Solutions Navision
      ----------------------------------------
      Project: Burda (Thailand) Co., Ltd
      PTH : Phitsanu Thoranasoonthorn

      No.   Date         Sign  Description
      ----------------------------------------
      001   02.07.2008   PTH   Complaint
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 80010 Create Subscriber LE
{
  OBJECT-PROPERTIES
  {
    Date=03/13/12;
    Time=11:08:09 PM;
    Version List=;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
  }
  DATAITEMS
  {
    { PROPERTIES
      {
        DataItemTable=Table50005;
        DataItemTableView=SORTING(No.);
        OnAfterGetRecord=BEGIN
                           IF "Contract Status" = "Contract Status"::Open THEN
                             ConfirmContract;
                           TESTFIELD("Contract Status","Contract Status"::Confirm);
                           IF "Promotion Net Price" + "Credit Charge Amount (Cust.)" <> "Receipt Amount" + "Credit Card Amount" + "Check Amount" THEN
                             ERROR(Text005);
                           IF "Contract Type" <> "Contract Type"::Complimentary THEN BEGIN  //KKE : #003
                             TESTFIELD("Promotion Net Price");
                             TESTFIELD("Contract Quantity");
                             TESTFIELD("Contract Net Price");
                             TESTFIELD("Payment Method Code");
                           END;  //KKE : #003

                           MagazineVolumeIssue.SETPERMISSIONFILTER;
                           MagazineVolumeIssue.RESET;
                           MagazineVolumeIssue.SETRANGE("Magazine Code","Magazine Code");
                           MagazineVolumeIssue.SETRANGE("Magazine Item No.","Starting Magazine Item No.","Ending Magazine Item No.");
                           MagazineVolumeIssue.SETRANGE("Volume No.","Starting Volume No.","Ending Volume No.");
                           //MagazineVolumeIssue.SETRANGE("Issue No.","Starting Issue No.","Ending Issue No.");
                           MagazineVolumeIssue.SETRANGE("Create as Item",TRUE);
                           IF NOT MagazineVolumeIssue.FIND('-') THEN BEGIN
                             CurrReport.SKIP;
                           END;

                           REPEAT
                             SSContractLE.INIT;
                             SSContractLE."Subscriber Contract No." := "No.";
                             SSContractLE."Subscriber No." := "Subscriber No.";
                             SSContractLE."Magazine Code" := MagazineVolumeIssue."Magazine Code";
                             SSContractLE."Volume No." := MagazineVolumeIssue."Volume No.";
                             SSContractLE."Issue No." := MagazineVolumeIssue."Issue No.";
                             SSContractLE."Issue Date" := MagazineVolumeIssue."Issue Date";
                             SSContractLE."Magazine Item No." := MagazineVolumeIssue."Magazine Item No.";
                             SSContractLE.Quantity := 1;
                             IF "Contract Quantity" <> 0 THEN  //KKE : #003
                             SSContractLE."Unit Price" := "Contract Net Price" / "Contract Quantity";
                             SSContractLE."Shipping Agent Code" := "Shipping Agent Code";
                             SSContractLE."System-Created Entry" := TRUE;
                             IF SSContractLE.INSERT THEN;

                           UNTIL MagazineVolumeIssue.NEXT=0;
                         END;

        ReqFilterFields=Magazine Code,No.;
      }
      SECTIONS
      {
      }
       }
  }
  REQUESTFORM
  {
    PROPERTIES
    {
      Width=9020;
      Height=3410;
    }
    CONTROLS
    {
    }
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      Text005@1000000000 : TextConst 'ENU=Balance amount must be zero.';
      SSContractLE@1000000002 : Record 50006;
      MagazineVolumeIssue@1000000001 : Record 50012;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

